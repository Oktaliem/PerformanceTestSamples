<?xml version="1.0" encoding="utf-8"?>
<HTTPSnapshot xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" id="15">
  <HTTPTask id="16" hostname="192.168.1.66" path="/web/content/438-44561e6/web.assets_backend.js" url="http://192.168.1.66/web/content/438-44561e6/web.assets_backend.js" ip="192.168.1.66" port="80" client_ip="192.168.1.112" client_port="22612" connectionId="2424" origin="Primary" encodingType="ANSI" startDateTime="2020-01-19T11:40:17.506+08:00" startTime="4032" endTime="4856" blockedTime="0" dnsTime="0" connectTime="0" sendTime="0" waitTime="0" receiveTime="0" sslNegotiateTime="0" responseBodySize="0">
    <HTTPRequest method="GET">
      <HTTPHeaders>
        <HTTPHeaderEntity name="Referer" index="0">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>aHR0cDovLzE5Mi4xNjguMS42Ni93ZWI=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="User-Agent" index="1">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>TW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NCkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzc5LjAuMzk0NS4xMTcgU2FmYXJpLzUzNy4zNg==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Accept-Encoding" index="2">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Z3ppcCwgZGVmbGF0ZQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Accept-Language" index="3">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>ZW4tVVMsZW47cT0wLjk=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Accept" index="4">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Ki8q</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Connection" index="5">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>S2VlcC1BbGl2ZQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Host" index="6">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>MTkyLjE2OC4xLjY2</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Cookie" index="7">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>c2Vzc2lvbl9pZD02YjU4MzE2NjQxOWYxZWUxZGVlZTg3YTE2ZjAwMzRkNjJiMTNhYjVi</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPAllHeaders>
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>R0VUIC93ZWIvY29udGVudC80MzgtNDQ1NjFlNi93ZWIuYXNzZXRzX2JhY2tlbmQuanMgSFRUUC8xLjENClJlZmVyZXI6IGh0dHA6Ly8xOTIuMTY4LjEuNjYvd2ViDQpVc2VyLUFnZW50OiBNb3ppbGxhLzUuMCAoV2luZG93cyBOVCAxMC4wOyBXaW42NDsgeDY0KSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvNzkuMC4zOTQ1LjExNyBTYWZhcmkvNTM3LjM2DQpBY2NlcHQtRW5jb2Rpbmc6IGd6aXAsIGRlZmxhdGUNCkFjY2VwdC1MYW5ndWFnZTogZW4tVVMsZW47cT0wLjkNCkFjY2VwdDogKi8qDQpDb25uZWN0aW9uOiBLZWVwLUFsaXZlDQpIb3N0OiAxOTIuMTY4LjEuNjYNCkNvb2tpZTogc2Vzc2lvbl9pZD02YjU4MzE2NjQxOWYxZWUxZGVlZTg3YTE2ZjAwMzRkNjJiMTNhYjViDQoNCg==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPAllHeaders>
        <HTTPCookies>
          <HTTPHeaderEntity name="session_id" index="0">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>NmI1ODMxNjY0MTlmMWVlMWRlZWU4N2ExNmYwMDM0ZDYyYjEzYWI1Yg==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
        </HTTPCookies>
      </HTTPHeaders>
    </HTTPRequest>
    <HTTPResponse>
      <contentLenght>1015985</contentLenght>
      <HTTPHeaders>
        <HTTPHeaderEntity name="Content-Type" index="0">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>YXBwbGljYXRpb24vamF2YXNjcmlwdA==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="X-Content-Type-Options" index="1">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>bm9zbmlmZg==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="ETag" index="2">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>OTE5YTkwN2U3MGQ1NDQ2MzcwNGY0NmU2NDBlNGFlYmYzOTYxNGFlOA==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Cache-Control" index="3">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>bWF4LWFnZT0zMTUzNjAwMA==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Content-Length" index="4">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>MTAxNTk4NQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Set-Cookie" index="5">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>c2Vzc2lvbl9pZD02YjU4MzE2NjQxOWYxZWUxZGVlZTg3YTE2ZjAwMzRkNjJiMTNhYjViOyBFeHBpcmVzPVdlZCwgMTUtQXByLTIwMjAgMDE6MzQ6MTkgR01UOyBNYXgtQWdlPTc3NzYwMDA7IEh0dHBPbmx5OyBQYXRoPS8=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Server" index="6">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>V2Vya3pldWcvMC4xNC4xIFB5dGhvbi8zLjYuOQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Date" index="7">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>VGh1LCAxNiBKYW4gMjAyMCAwMTozNDoxOSBHTVQ=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPAllHeaders>
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>SFRUUC8xLjAgMjAwIE9LDQpDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2phdmFzY3JpcHQNClgtQ29udGVudC1UeXBlLU9wdGlvbnM6IG5vc25pZmYNCkVUYWc6IDkxOWE5MDdlNzBkNTQ0NjM3MDRmNDZlNjQwZTRhZWJmMzk2MTRhZTgNCkNhY2hlLUNvbnRyb2w6IG1heC1hZ2U9MzE1MzYwMDANCkNvbnRlbnQtTGVuZ3RoOiAxMDE1OTg1DQpTZXQtQ29va2llOiBzZXNzaW9uX2lkPTZiNTgzMTY2NDE5ZjFlZTFkZWVlODdhMTZmMDAzNGQ2MmIxM2FiNWI7IEV4cGlyZXM9V2VkLCAxNS1BcHItMjAyMCAwMTozNDoxOSBHTVQ7IE1heC1BZ2U9Nzc3NjAwMDsgSHR0cE9ubHk7IFBhdGg9Lw0KU2VydmVyOiBXZXJremV1Zy8wLjE0LjEgUHl0aG9uLzMuNi45DQpEYXRlOiBUaHUsIDE2IEphbiAyMDIwIDAxOjM0OjE5IEdNVA0KDQo=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPAllHeaders>
      </HTTPHeaders>
      <HTTPBody>
        <HTTPDataSet>
          <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
            <ActualData>Ci8qIC9iYXNlL3N0YXRpYy9zcmMvanMvcmVzX2NvbmZpZ19zZXR0aW5ncy5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwpvZG9vLmRlZmluZSgnYmFzZS5zZXR0aW5ncycsZnVuY3Rpb24ocmVxdWlyZSl7InVzZSBzdHJpY3QiO3ZhciBCYXNpY01vZGVsPXJlcXVpcmUoJ3dlYi5CYXNpY01vZGVsJyk7dmFyIGNvcmU9cmVxdWlyZSgnd2ViLmNvcmUnKTt2YXIgY29uZmlnPXJlcXVpcmUoJ3dlYi5jb25maWcnKTt2YXIgRm9ybVZpZXc9cmVxdWlyZSgnd2ViLkZvcm1WaWV3Jyk7dmFyIEZvcm1Db250cm9sbGVyPXJlcXVpcmUoJ3dlYi5Gb3JtQ29udHJvbGxlcicpO3ZhciBGb3JtUmVuZGVyZXI9cmVxdWlyZSgnd2ViLkZvcm1SZW5kZXJlcicpO3ZhciB2aWV3X3JlZ2lzdHJ5PXJlcXVpcmUoJ3dlYi52aWV3X3JlZ2lzdHJ5Jyk7dmFyIFFXZWI9Y29yZS5xd2ViO3ZhciBfdD1jb3JlLl90O3ZhciBCYXNlU2V0dGluZ1JlbmRlcmVyPUZvcm1SZW5kZXJlci5leHRlbmQoe2V2ZW50czpfLmV4dGVuZCh7fSxGb3JtUmVuZGVyZXIucHJvdG90eXBlLmV2ZW50cyx7J2NsaWNrIC50YWInOidfb25TZXR0aW5nVGFiQ2xpY2snLCdrZXl1cCAuc2VhcmNoSW5wdXQnOidfb25LZXlVcFNlYXJjaCcsfSksaW5pdDpmdW5jdGlvbigpe3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLmFjdGl2ZVZpZXc9ZmFsc2U7dGhpcy5hY3RpdmVUYWI9ZmFsc2U7fSxzdGFydDpmdW5jdGlvbigpe3ZhciBwcm9tPXRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtpZihjb25maWcuZGV2aWNlLmlzTW9iaWxlKXtjb3JlLmJ1cy5vbigiRE9NX3VwZGF0ZWQiLHRoaXMsZnVuY3Rpb24oKXt0aGlzLl9tb3ZlVG9UYWIodGhpcy5jdXJyZW50SW5kZXh8fHRoaXMuX2N1cnJlbnRBcHBJbmRleCgpKTt9KTt9CnJldHVybiBwcm9tO30sY29uZmlybUNoYW5nZTpmdW5jdGlvbigpe3ZhciBzZWxmPXRoaXM7cmV0dXJuIHRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKS50aGVuKGZ1bmN0aW9uKCl7aWYoIXNlbGYuJCgiLm9fZGlydHlfd2FybmluZyIpLmxlbmd0aCl7c2VsZi4kKCcub19zdGF0dXNiYXJfYnV0dG9ucycpLmFwcGVuZCgkKCc8c3Bhbi8+Jyx7dGV4dDpfdCgiVW5zYXZlZCBjaGFuZ2VzIiksY2xhc3M6J3RleHQtbXV0ZWQgbWwtMiBvX2RpcnR5X3dhcm5pbmcnfSkpfX0pO30sb25fYXR0YWNoX2NhbGxiYWNrOmZ1bmN0aW9uKCl7dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3RoaXMuc2VhcmNoSW5wdXQuZm9jdXMoKTt9LF9pbml0TW9kdWxlczpmdW5jdGlvbigpe3ZhciBzZWxmPXRoaXM7dGhpcy5tb2R1bGVzPVtdO18uZWFjaCh0aGlzLiQoJy5hcHBfc2V0dGluZ3NfYmxvY2snKSxmdW5jdGlvbihzZXR0aW5nVmlldyxpbmRleCl7dmFyIGdyb3VwPSEkKHNldHRpbmdWaWV3KS5oYXNDbGFzcygnb19pbnZpc2libGVfbW9kaWZpZXInKTt2YXIgaXNOb3RBcHA9JChzZXR0aW5nVmlldykuaGFzQ2xhc3MoJ29fbm90X2FwcCcpO2lmKGdyb3VwJiYhaXNOb3RBcHApe3ZhciBkYXRhPSQoc2V0dGluZ1ZpZXcpLmRhdGEoKTtkYXRhLnN0cmluZz0kKHNldHRpbmdWaWV3KS5hdHRyKCdzdHJpbmcnKXx8ZGF0YS5zdHJpbmc7c2VsZi5tb2R1bGVzLnB1c2goe2tleTpkYXRhLmtleSxzdHJpbmc6ZGF0YS5zdHJpbmcsaW1ndXJsOnNlbGYuX2dldEFwcEljb25VcmwoZGF0YS5rZXkpLH0pO31lbHNleyQoc2V0dGluZ1ZpZXcpLnJlbW92ZSgpO319KTt9LF9pbml0U2VhcmNoOmZ1bmN0aW9uKCl7dGhpcy5zZWFyY2hJbnB1dD10aGlzLiQoJy5zZWFyY2hJbnB1dCcpO2lmKHRoaXMuc2VhcmNoVGV4dCl7dGhpcy5zZWFyY2hJbnB1dC52YWwodGhpcy5zZWFyY2hUZXh0KTt0aGlzLl9vbktleVVwU2VhcmNoKCk7fWVsc2V7dGhpcy5zZWFyY2hUZXh0PSIiO319LF9hY3RpdmF0ZVNldHRpbmdNb2JpbGVUYWI6ZnVuY3Rpb24oY3VycmVudFRhYil7dmFyIHNlbGY9dGhpczt2YXIgbW92ZVRvPWN1cnJlbnRUYWI7dmFyIG5leHQ9bW92ZVRvKzE7dmFyIHByZXZpb3VzPW1vdmVUby0xO3RoaXMuJCgiLnNldHRpbmdzIC5hcHBfc2V0dGluZ3NfYmxvY2siKS5yZW1vdmVDbGFzcygicHJldmlvdXMgbmV4dCBjdXJyZW50IGJlZm9yZSBhZnRlciIpO3RoaXMuJCgiLnNldHRpbmdzX3RhYiAudGFiIikucmVtb3ZlQ2xhc3MoInByZXZpb3VzIG5leHQgY3VycmVudCBiZWZvcmUgYWZ0ZXIiKTtfLmVhY2godGhpcy5tb2R1bGVzLGZ1bmN0aW9uKG1vZHVsZSxpbmRleCl7dmFyIHRhYj1zZWxmLiQoIi50YWJbZGF0YS1rZXk9JyIrbW9kdWxlLmtleSsiJ10iKTt2YXIgdmlldz1tb2R1bGUuc2V0dGluZ1ZpZXc7aWYoaW5kZXg9PT1wcmV2aW91cyl7dGFiLmFkZENsYXNzKCJwcmV2aW91cyIpO3RhYi5jc3MoIm1hcmdpbi1sZWZ0IiwiMHB4Iik7dmlldy5hZGRDbGFzcygicHJldmlvdXMiKTt9ZWxzZSBpZihpbmRleD09PW5leHQpe3RhYi5hZGRDbGFzcygibmV4dCIpO3RhYi5jc3MoIm1hcmdpbi1sZWZ0IiwiLSIrdGFiLm91dGVyV2lkdGgoKSsicHgiKTt2aWV3LmFkZENsYXNzKCJuZXh0Iik7fWVsc2UgaWYoaW5kZXg8bW92ZVRvKXt0YWIuYWRkQ2xhc3MoImJlZm9yZSIpO3RhYi5jc3MoIm1hcmdpbi1sZWZ0IiwiLSIrdGFiLm91dGVyV2lkdGgoKSsicHgiKTt2aWV3LmFkZENsYXNzKCJiZWZvcmUiKTt9ZWxzZSBpZihpbmRleD09PW1vdmVUbyl7dmFyIG1hcmdpbkxlZnQ9dGFiLm91dGVyV2lkdGgoKS8yO3RhYi5jc3MoIm1hcmdpbi1sZWZ0IiwiLSIrbWFyZ2luTGVmdCsicHgiKTt0YWIuYWRkQ2xhc3MoImN1cnJlbnQiKTt2aWV3LmFkZENsYXNzKCJjdXJyZW50Iik7fWVsc2UgaWYoaW5kZXg+bW92ZVRvKXt0YWIuYWRkQ2xhc3MoImFmdGVyIik7dGFiLmNzcygibWFyZ2luLWxlZnQiLCIwIik7dmlldy5hZGRDbGFzcygiYWZ0ZXIiKTt9fSk7fSxfY3VycmVudEFwcEluZGV4OmZ1bmN0aW9uKCl7dmFyIHNlbGY9dGhpczt2YXIgaW5kZXg9Xy5maW5kSW5kZXgodGhpcy5tb2R1bGVzLGZ1bmN0aW9uKG1vZHVsZSl7cmV0dXJuIG1vZHVsZS5rZXk9PT1zZWxmLmFjdGl2ZVNldHRpbmdUYWI7fSk7cmV0dXJuIGluZGV4O30sX2VuYWJsZVN3aXBlOmZ1bmN0aW9uKCl7dmFyIHNlbGY9dGhpczt0aGlzLiQoJy5zZXR0aW5ncycpLnN3aXBlKHtzd2lwZUxlZnQ6ZnVuY3Rpb24oKXtzZWxmLl9tb3ZlVG9UYWIoc2VsZi5jdXJyZW50SW5kZXgrMSk7fSxzd2lwZVJpZ2h0OmZ1bmN0aW9uKCl7c2VsZi5fbW92ZVRvVGFiKHNlbGYuY3VycmVudEluZGV4LTEpO319KTt9LF9nZXRBcHBJY29uVXJsOmZ1bmN0aW9uKG1vZHVsZSl7cmV0dXJuIG1vZHVsZT09PSJnZW5lcmFsX3NldHRpbmdzIj8iL2Jhc2Uvc3RhdGljL2Rlc2NyaXB0aW9uL3NldHRpbmdzLnBuZyI6Ii8iK21vZHVsZSsiL3N0YXRpYy9kZXNjcmlwdGlvbi9pY29uLnBuZyI7fSxfZ2V0U2VhcmNoSGVhZGVyOmZ1bmN0aW9uKGltZ3VybCxzdHJpbmcpe3JldHVybiAkKFFXZWIucmVuZGVyKCdCYXNlU2V0dGluZy5TZWFyY2hIZWFkZXInLHtpbWd1cmw6aW1ndXJsLHN0cmluZzpzdHJpbmd9KSk7fSxfbW92ZVRvVGFiOmZ1bmN0aW9uKGluZGV4KXt0aGlzLmN1cnJlbnRJbmRleD0haW5kZXh8fGluZGV4PT09LTE/MDooaW5kZXg9PT10aGlzLm1vZHVsZXMubGVuZ3RoP2luZGV4LTE6aW5kZXgpO2lmKHRoaXMuY3VycmVudEluZGV4IT09LTEpe2lmKHRoaXMuYWN0aXZlVmlldyl7dGhpcy5hY3RpdmVWaWV3LmFkZENsYXNzKCJvX2hpZGRlbiIpO30KaWYodGhpcy5hY3RpdmVUYWIpe3RoaXMuYWN0aXZlVGFiLnJlbW92ZUNsYXNzKCJzZWxlY3RlZCIpO30KdmFyIHZpZXc9dGhpcy5tb2R1bGVzW3RoaXMuY3VycmVudEluZGV4XS5zZXR0aW5nVmlldzt2YXIgdGFiPXRoaXMuJCgiLnRhYltkYXRhLWtleT0nIit0aGlzLm1vZHVsZXNbdGhpcy5jdXJyZW50SW5kZXhdLmtleSsiJ10iKTt2aWV3LnJlbW92ZUNsYXNzKCJvX2hpZGRlbiIpO3RoaXMuYWN0aXZlVmlldz12aWV3O3RoaXMuYWN0aXZlVGFiPXRhYjtpZihjb25maWcuZGV2aWNlLmlzTW9iaWxlKXt0aGlzLl9hY3RpdmF0ZVNldHRpbmdNb2JpbGVUYWIodGhpcy5jdXJyZW50SW5kZXgpO31lbHNle3RhYi5hZGRDbGFzcygic2VsZWN0ZWQiKTt9fX0sX29uU2V0dGluZ1RhYkNsaWNrOmZ1bmN0aW9uKGV2ZW50KXt0aGlzLnNlYXJjaElucHV0LmZvY3VzKCk7aWYodGhpcy5zZWFyY2hUZXh0Lmxlbmd0aD4wKXt0aGlzLnNlYXJjaElucHV0LnZhbCgnJyk7dGhpcy5zZWFyY2hUZXh0PSIiO3RoaXMuX3NlYXJjaFNldHRpbmcoKTt9CnZhciBzZXR0aW5nS2V5PXRoaXMuJChldmVudC5jdXJyZW50VGFyZ2V0KS5kYXRhKCdrZXknKTt0aGlzLl9tb3ZlVG9UYWIoXy5maW5kSW5kZXgodGhpcy5tb2R1bGVzLGZ1bmN0aW9uKG0pe3JldHVybiBtLmtleT09PXNldHRpbmdLZXk7fSkpO30sX29uS2V5VXBTZWFyY2g6ZnVuY3Rpb24oZXZlbnQpe3RoaXMuc2VhcmNoVGV4dD10aGlzLnNlYXJjaElucHV0LnZhbCgpO3RoaXMuYWN0aXZlVGFiLnJlbW92ZUNsYXNzKCdzZWxlY3RlZCcpO2lmKGNvbmZpZy5kZXZpY2UuaXNNb2JpbGUpe3RoaXMuJCgnLnNldHRpbmdzX3RhYicpLmFkZENsYXNzKCdvX2hpZGRlbicpO3RoaXMuJCgnLnNldHRpbmdzJykuYWRkQ2xhc3MoJ2QtYmxvY2snKTt9CnRoaXMuX3NlYXJjaFNldHRpbmcoKTt9LF9yZXNldFNlYXJjaDpmdW5jdGlvbigpe3RoaXMuc2VhcmNoSW5wdXQudmFsKCIiKTtfLmVhY2godGhpcy5tb2R1bGVzLGZ1bmN0aW9uKG1vZHVsZSl7bW9kdWxlLnNldHRpbmdWaWV3LmFkZENsYXNzKCdvX2hpZGRlbicpO21vZHVsZS5zZXR0aW5nVmlldy5maW5kKCcub19zZXR0aW5nX2JveCcpLnJlbW92ZUNsYXNzKCdvX2hpZGRlbicpO21vZHVsZS5zZXR0aW5nVmlldy5maW5kKCdoMicpLnJlbW92ZUNsYXNzKCdvX2hpZGRlbicpO21vZHVsZS5zZXR0aW5nVmlldy5maW5kKCcuc2V0dGluZ1NlYXJjaEhlYWRlcicpLmFkZENsYXNzKCdvX2hpZGRlbicpO21vZHVsZS5zZXR0aW5nVmlldy5maW5kKCcub19zZXR0aW5nc19jb250YWluZXInKS5hZGRDbGFzcygnbXQxNicpO30pO3RoaXMuYWN0aXZlVGFiLnJlbW92ZUNsYXNzKCdvX2hpZGRlbicpLmFkZENsYXNzKCdzZWxlY3RlZCcpO3RoaXMuYWN0aXZlVmlldy5yZW1vdmVDbGFzcygnb19oaWRkZW4nKTtpZihjb25maWcuZGV2aWNlLmlzTW9iaWxlKXt0aGlzLiQoJy5zZXR0aW5nc190YWInKS5yZW1vdmVDbGFzcygnb19oaWRkZW4nKTt0aGlzLiQoJy5zZXR0aW5ncycpLnJlbW92ZUNsYXNzKCdkLWJsb2NrJyk7fX0sX3JlbmRlcjpmdW5jdGlvbigpe3ZhciBzZWxmPXRoaXM7cmV0dXJuIHRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKS50aGVuKGZ1bmN0aW9uKCl7c2VsZi5faW5pdE1vZHVsZXMoKTtzZWxmLl9yZW5kZXJMZWZ0UGFuZWwoKTtzZWxmLl9pbml0U2VhcmNoKCk7aWYoY29uZmlnLmRldmljZS5pc01vYmlsZSl7c2VsZi5fZW5hYmxlU3dpcGUoKTt9fSk7fSxfcmVuZGVyTGVmdFBhbmVsOmZ1bmN0aW9uKCl7dmFyIHNlbGY9dGhpcztfLmVhY2godGhpcy5tb2R1bGVzLGZ1bmN0aW9uKG1vZHVsZSl7bW9kdWxlLnNldHRpbmdWaWV3PXNlbGYuJCgnLmFwcF9zZXR0aW5nc19ibG9ja1tkYXRhLWtleT0iJyttb2R1bGUua2V5KyciXScpO21vZHVsZS5zZXR0aW5nVmlldy5hZGRDbGFzcygib19oaWRkZW4iKTttb2R1bGUuc2V0dGluZ1ZpZXcucHJlcGVuZChzZWxmLl9nZXRTZWFyY2hIZWFkZXIobW9kdWxlLmltZ3VybCxtb2R1bGUuc3RyaW5nKSk7fSk7dGhpcy5fcmVuZGVyVGFicygpO3RoaXMuX21vdmVUb1RhYih0aGlzLmN1cnJlbnRJbmRleHx8dGhpcy5fY3VycmVudEFwcEluZGV4KCkpO30sX3JlbmRlclRhYnM6ZnVuY3Rpb24oKXt2YXIgdGFicz0kKFFXZWIucmVuZGVyKCdCYXNlU2V0dGluZy5UYWJzJyx7dGFiSXRlbXM6dGhpcy5tb2R1bGVzfSkpO3RhYnMuYXBwZW5kVG8odGhpcy4kKCIuc2V0dGluZ3NfdGFiIikpO30sX3NlYXJjaFNldHRpbmc6ZnVuY3Rpb24oKXt2YXIgc2VsZj10aGlzO3RoaXMuY291bnQ9MDtfLmVhY2godGhpcy5tb2R1bGVzLGZ1bmN0aW9uKG1vZHVsZSl7c2VsZi5pblZpc2libGVDb3VudD0wO21vZHVsZS5zZXR0aW5nVmlldy5maW5kKCcub19zZXR0aW5nX2JveCcpLmFkZENsYXNzKCdvX2hpZGRlbicpO21vZHVsZS5zZXR0aW5nVmlldy5maW5kKCdoMicpLmFkZENsYXNzKCdvX2hpZGRlbicpO21vZHVsZS5zZXR0aW5nVmlldy5maW5kKCcuc2V0dGluZ1NlYXJjaEhlYWRlcicpLmFkZENsYXNzKCdvX2hpZGRlbicpO21vZHVsZS5zZXR0aW5nVmlldy5maW5kKCcub19zZXR0aW5nc19jb250YWluZXInKS5yZW1vdmVDbGFzcygnbXQxNicpO3ZhciByZXN1bHRTZXR0aW5nPW1vZHVsZS5zZXR0aW5nVmlldy5maW5kKCIub19mb3JtX2xhYmVsOmNvbnRhaW5zVGV4dExpa2UoJyIrc2VsZi5zZWFyY2hUZXh0KyInKSIpO2lmKHJlc3VsdFNldHRpbmcubGVuZ3RoPjApe3Jlc3VsdFNldHRpbmcuZWFjaChmdW5jdGlvbigpe3ZhciBzZXR0aW5nQm94PSQodGhpcykuY2xvc2VzdCgnLm9fc2V0dGluZ19ib3gnKTtpZighc2V0dGluZ0JveC5oYXNDbGFzcygnb19pbnZpc2libGVfbW9kaWZpZXInKSl7c2V0dGluZ0JveC5yZW1vdmVDbGFzcygnb19oaWRkZW4nKTskKHRoaXMpLmh0bWwoc2VsZi5fd29yZEhpZ2hsaWdodGVyKCQodGhpcykuaHRtbCgpLHNlbGYuc2VhcmNoVGV4dCkpO31lbHNle3NlbGYuaW5WaXNpYmxlQ291bnQrKzt9fSk7aWYoc2VsZi5pblZpc2libGVDb3VudCE9PXJlc3VsdFNldHRpbmcubGVuZ3RoKXttb2R1bGUuc2V0dGluZ1ZpZXcuZmluZCgnLnNldHRpbmdTZWFyY2hIZWFkZXInKS5yZW1vdmVDbGFzcygnb19oaWRkZW4nKTttb2R1bGUuc2V0dGluZ1ZpZXcucmVtb3ZlQ2xhc3MoJ29faGlkZGVuJyk7fX1lbHNleysrc2VsZi5jb3VudDt9fSk7dGhpcy5jb3VudD09PV8uc2l6ZSh0aGlzLm1vZHVsZXMpP3RoaXMuJCgnLm5vdEZvdW5kJykucmVtb3ZlQ2xhc3MoJ29faGlkZGVuJyk6dGhpcy4kKCcubm90Rm91bmQnKS5hZGRDbGFzcygnb19oaWRkZW4nKTtpZih0aGlzLnNlYXJjaFRleHQubGVuZ3RoPT09MCl7dGhpcy5fcmVzZXRTZWFyY2goKTt9fSxfd29yZEhpZ2hsaWdodGVyOmZ1bmN0aW9uKHRleHQsd29yZCl7aWYodGV4dC5pbmRleE9mKCdoaWdobGlnaHRlcicpIT09LTEpe3RleHQ9dGV4dC5yZXBsYWNlKCc8c3BhbiBjbGFzcz0iaGlnaGxpZ2h0ZXIiPicsIiIpO3RleHQ9dGV4dC5yZXBsYWNlKCI8L3NwYW4+IiwiIik7fQp2YXIgbWF0Y2g9dGV4dC5zZWFyY2gobmV3IFJlZ0V4cCh3b3JkLCJpIikpO3dvcmQ9dGV4dC5zdWJzdHJpbmcobWF0Y2gsbWF0Y2grd29yZC5sZW5ndGgpO3ZhciBoaWdobGlnaHRlZFdvcmQ9IjxzcGFuIGNsYXNzPSdoaWdobGlnaHRlcic+Iit3b3JkKyc8L3NwYW4+JztyZXR1cm4gdGV4dC5yZXBsYWNlKHdvcmQsaGlnaGxpZ2h0ZWRXb3JkKTt9LH0pO3ZhciBCYXNlU2V0dGluZ0NvbnRyb2xsZXI9Rm9ybUNvbnRyb2xsZXIuZXh0ZW5kKHtjdXN0b21fZXZlbnRzOl8uZXh0ZW5kKHt9LEZvcm1Db250cm9sbGVyLnByb3RvdHlwZS5jdXN0b21fZXZlbnRzLHtidXR0b25fY2xpY2tlZDonX29uQnV0dG9uQ2xpY2tlZCcsfSksaW5pdDpmdW5jdGlvbigpe3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLmRpc2FibGVBdXRvZm9jdXM9dHJ1ZTt0aGlzLnJlbmRlcmVyLmFjdGl2ZVNldHRpbmdUYWI9dGhpcy5pbml0aWFsU3RhdGUuY29udGV4dC5tb2R1bGU7fSx3aWxsUmVzdG9yZTpmdW5jdGlvbigpe3RoaXMubW9kZT0nZWRpdCc7fSxfb25CdXR0b25DbGlja2VkOmZ1bmN0aW9uKGV2KXt2YXIgc2VsZj10aGlzO2lmKGV2LmRhdGEuYXR0cnMubmFtZSE9PSdleGVjdXRlJyYmZXYuZGF0YS5hdHRycy5uYW1lIT09J2NhbmNlbCcpe3ZhciByZWNvcmRJRD1ldi5kYXRhLnJlY29yZElEO3ZhciBfc3VwZXI9dGhpcy5fc3VwZXI7dmFyIGFyZ3M9YXJndW1lbnRzO3RoaXMuX2Rpc2NhcmRDaGFuZ2VzKHJlY29yZElEKS50aGVuKGZ1bmN0aW9uKCl7X3N1cGVyLmFwcGx5KHNlbGYsYXJncyk7fSk7fWVsc2V7dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO319LH0pO3ZhciBCYXNlU2V0dGluZ3NNb2RlbD1CYXNpY01vZGVsLmV4dGVuZCh7c2F2ZTpmdW5jdGlvbihyZWNvcmRJRCl7dmFyIHNlbGY9dGhpcztyZXR1cm4gdGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KXtkZWxldGUgc2VsZi5sb2NhbERhdGFbcmVjb3JkSURdLnJlc19pZDtyZXR1cm4gcmVzdWx0O30pO30sfSk7dmFyIEJhc2VTZXR0aW5nVmlldz1Gb3JtVmlldy5leHRlbmQoe2pzTGliczpbXSxjb25maWc6Xy5leHRlbmQoe30sRm9ybVZpZXcucHJvdG90eXBlLmNvbmZpZyx7TW9kZWw6QmFzZVNldHRpbmdzTW9kZWwsUmVuZGVyZXI6QmFzZVNldHRpbmdSZW5kZXJlcixDb250cm9sbGVyOkJhc2VTZXR0aW5nQ29udHJvbGxlcix9KSxpbml0OmZ1bmN0aW9uKCl7aWYoY29uZmlnLmRldmljZS5pc01vYmlsZSl7dGhpcy5qc0xpYnMucHVzaCgnL3dlYi9zdGF0aWMvbGliL2pxdWVyeS50b3VjaFN3aXBlL2pxdWVyeS50b3VjaFN3aXBlLmpzJyk7fQp0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fSx9KTt2aWV3X3JlZ2lzdHJ5LmFkZCgnYmFzZV9zZXR0aW5ncycsQmFzZVNldHRpbmdWaWV3KTtyZXR1cm57TW9kZWw6QmFzZVNldHRpbmdzTW9kZWwsUmVuZGVyZXI6QmFzZVNldHRpbmdSZW5kZXJlcixDb250cm9sbGVyOkJhc2VTZXR0aW5nQ29udHJvbGxlcix9O30pOzsKCi8qIC93ZWIvc3RhdGljL2xpYi9qcXVlcnkuc2Nyb2xsVG8vanF1ZXJ5LnNjcm9sbFRvLmpzIGRlZmluZWQgaW4gYnVuZGxlICd3ZWIuYXNzZXRzX2JhY2tlbmQnICovCjsoZnVuY3Rpb24oZGVmaW5lKXsndXNlIHN0cmljdCc7ZGVmaW5lKFsnanF1ZXJ5J10sZnVuY3Rpb24oJCl7dmFyICRzY3JvbGxUbz0kLnNjcm9sbFRvPWZ1bmN0aW9uKHRhcmdldCxkdXJhdGlvbixzZXR0aW5ncyl7cmV0dXJuICQod2luZG93KS5zY3JvbGxUbyh0YXJnZXQsZHVyYXRpb24sc2V0dGluZ3MpO307JHNjcm9sbFRvLmRlZmF1bHRzPXtheGlzOid4eScsZHVyYXRpb246MCxsaW1pdDp0cnVlfTskc2Nyb2xsVG8ud2luZG93PWZ1bmN0aW9uKHNjb3BlKXtyZXR1cm4gJCh3aW5kb3cpLl9zY3JvbGxhYmxlKCk7fTskLmZuLl9zY3JvbGxhYmxlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubWFwKGZ1bmN0aW9uKCl7dmFyIGVsZW09dGhpcyxpc1dpbj0hZWxlbS5ub2RlTmFtZXx8JC5pbkFycmF5KGVsZW0ubm9kZU5hbWUudG9Mb3dlckNhc2UoKSxbJ2lmcmFtZScsJyNkb2N1bWVudCcsJ2h0bWwnLCdib2R5J10pIT0tMTtpZighaXNXaW4pCnJldHVybiBlbGVtO3ZhciBkb2M9KGVsZW0uY29udGVudFdpbmRvd3x8ZWxlbSkuZG9jdW1lbnR8fGVsZW0ub3duZXJEb2N1bWVudHx8ZWxlbTtyZXR1cm4vd2Via2l0L2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KXx8ZG9jLmNvbXBhdE1vZGU9PSdCYWNrQ29tcGF0Jz9kb2MuYm9keTpkb2MuZG9jdW1lbnRFbGVtZW50O30pO307JC5mbi5zY3JvbGxUbz1mdW5jdGlvbih0YXJnZXQsZHVyYXRpb24sc2V0dGluZ3Mpe2lmKHR5cGVvZiBkdXJhdGlvbj09J29iamVjdCcpe3NldHRpbmdzPWR1cmF0aW9uO2R1cmF0aW9uPTA7fQppZih0eXBlb2Ygc2V0dGluZ3M9PSdmdW5jdGlvbicpCnNldHRpbmdzPXtvbkFmdGVyOnNldHRpbmdzfTtpZih0YXJnZXQ9PSdtYXgnKQp0YXJnZXQ9OWU5O3NldHRpbmdzPSQuZXh0ZW5kKHt9LCRzY3JvbGxUby5kZWZhdWx0cyxzZXR0aW5ncyk7ZHVyYXRpb249ZHVyYXRpb258fHNldHRpbmdzLmR1cmF0aW9uO3NldHRpbmdzLnF1ZXVlPXNldHRpbmdzLnF1ZXVlJiZzZXR0aW5ncy5heGlzLmxlbmd0aD4xO2lmKHNldHRpbmdzLnF1ZXVlKQpkdXJhdGlvbi89MjtzZXR0aW5ncy5vZmZzZXQ9Ym90aChzZXR0aW5ncy5vZmZzZXQpO3NldHRpbmdzLm92ZXI9Ym90aChzZXR0aW5ncy5vdmVyKTtyZXR1cm4gdGhpcy5fc2Nyb2xsYWJsZSgpLmVhY2goZnVuY3Rpb24oKXtpZih0YXJnZXQ9PW51bGwpcmV0dXJuO3ZhciBlbGVtPXRoaXMsJGVsZW09JChlbGVtKSx0YXJnPXRhcmdldCx0b2ZmLGF0dHI9e30sd2luPSRlbGVtLmlzKCdodG1sLGJvZHknKTtzd2l0Y2godHlwZW9mIHRhcmcpe2Nhc2UnbnVtYmVyJzpjYXNlJ3N0cmluZyc6aWYoL14oWystXT0/KT9cZCsoXC5cZCspPyhweHwlKT8kLy50ZXN0KHRhcmcpKXt0YXJnPWJvdGgodGFyZyk7YnJlYWs7fQp0YXJnPXdpbj8kKHRhcmcpOiQodGFyZyx0aGlzKTtpZighdGFyZy5sZW5ndGgpcmV0dXJuO2Nhc2Unb2JqZWN0JzppZih0YXJnLmlzfHx0YXJnLnN0eWxlKQp0b2ZmPSh0YXJnPSQodGFyZykpLm9mZnNldCgpO30KdmFyIG9mZnNldD0kLmlzRnVuY3Rpb24oc2V0dGluZ3Mub2Zmc2V0KSYmc2V0dGluZ3Mub2Zmc2V0KGVsZW0sdGFyZyl8fHNldHRpbmdzLm9mZnNldDskLmVhY2goc2V0dGluZ3MuYXhpcy5zcGxpdCgnJyksZnVuY3Rpb24oaSxheGlzKXt2YXIgUG9zPWF4aXM9PSd4Jz8nTGVmdCc6J1RvcCcscG9zPVBvcy50b0xvd2VyQ2FzZSgpLGtleT0nc2Nyb2xsJytQb3Msb2xkPWVsZW1ba2V5XSxtYXg9JHNjcm9sbFRvLm1heChlbGVtLGF4aXMpO2lmKHRvZmYpe2F0dHJba2V5XT10b2ZmW3Bvc10rKHdpbj8wOm9sZC0kZWxlbS5vZmZzZXQoKVtwb3NdKTtpZihzZXR0aW5ncy5tYXJnaW4pe2F0dHJba2V5XS09cGFyc2VJbnQodGFyZy5jc3MoJ21hcmdpbicrUG9zKSl8fDA7YXR0cltrZXldLT1wYXJzZUludCh0YXJnLmNzcygnYm9yZGVyJytQb3MrJ1dpZHRoJykpfHwwO30KYXR0cltrZXldKz1vZmZzZXRbcG9zXXx8MDtpZihzZXR0aW5ncy5vdmVyW3Bvc10pCmF0dHJba2V5XSs9dGFyZ1theGlzPT0neCc/J3dpZHRoJzonaGVpZ2h0J10oKSpzZXR0aW5ncy5vdmVyW3Bvc107fWVsc2V7dmFyIHZhbD10YXJnW3Bvc107YXR0cltrZXldPXZhbC5zbGljZSYmdmFsLnNsaWNlKC0xKT09JyUnP3BhcnNlRmxvYXQodmFsKS8xMDAqbWF4OnZhbDt9CmlmKHNldHRpbmdzLmxpbWl0JiYvXlxkKyQvLnRlc3QoYXR0cltrZXldKSkKYXR0cltrZXldPWF0dHJba2V5XTw9MD8wOk1hdGgubWluKGF0dHJba2V5XSxtYXgpO2lmKCFpJiZzZXR0aW5ncy5xdWV1ZSl7aWYob2xkIT1hdHRyW2tleV0pCmFuaW1hdGUoc2V0dGluZ3Mub25BZnRlckZpcnN0KTtkZWxldGUgYXR0cltrZXldO319KTthbmltYXRlKHNldHRpbmdzLm9uQWZ0ZXIpO2Z1bmN0aW9uIGFuaW1hdGUoY2FsbGJhY2speyRlbGVtLmFuaW1hdGUoYXR0cixkdXJhdGlvbixzZXR0aW5ncy5lYXNpbmcsY2FsbGJhY2smJmZ1bmN0aW9uKCl7Y2FsbGJhY2suY2FsbCh0aGlzLHRhcmcsc2V0dGluZ3MpO30pO319KS5lbmQoKTt9OyRzY3JvbGxUby5tYXg9ZnVuY3Rpb24oZWxlbSxheGlzKXt2YXIgRGltPWF4aXM9PSd4Jz8nV2lkdGgnOidIZWlnaHQnLHNjcm9sbD0nc2Nyb2xsJytEaW07aWYoISQoZWxlbSkuaXMoJ2h0bWwsYm9keScpKQpyZXR1cm4gZWxlbVtzY3JvbGxdLSQoZWxlbSlbRGltLnRvTG93ZXJDYXNlKCldKCk7dmFyIHNpemU9J2NsaWVudCcrRGltLGh0bWw9ZWxlbS5vd25lckRvY3VtZW50LmRvY3VtZW50RWxlbWVudCxib2R5PWVsZW0ub3duZXJEb2N1bWVudC5ib2R5O3JldHVybiBNYXRoLm1heChodG1sW3Njcm9sbF0sYm9keVtzY3JvbGxdKS1NYXRoLm1pbihodG1sW3NpemVdLGJvZHlbc2l6ZV0pO307ZnVuY3Rpb24gYm90aCh2YWwpe3JldHVybiAkLmlzRnVuY3Rpb24odmFsKXx8JC5pc1BsYWluT2JqZWN0KHZhbCk/dmFsOnt0b3A6dmFsLGxlZnQ6dmFsfTt9CnJldHVybiAkc2Nyb2xsVG87fSl9KHR5cGVvZiBkZWZpbmU9PT0nZnVuY3Rpb24nJiZkZWZpbmUuYW1kP2RlZmluZTpmdW5jdGlvbihkZXBzLGZhY3Rvcnkpe2lmKHR5cGVvZiBtb2R1bGUhPT0ndW5kZWZpbmVkJyYmbW9kdWxlLmV4cG9ydHMpe21vZHVsZS5leHBvcnRzPWZhY3RvcnkocmVxdWlyZSgnanF1ZXJ5JykpO31lbHNle2ZhY3RvcnkoalF1ZXJ5KTt9fSkpOzsKCi8qIC93ZWIvc3RhdGljL2xpYi9mdXp6eS1tYXN0ZXIvZnV6enkuanMgZGVmaW5lZCBpbiBidW5kbGUgJ3dlYi5hc3NldHNfYmFja2VuZCcgKi8KKGZ1bmN0aW9uKCl7dmFyIHJvb3Q9dGhpczt2YXIgZnV6enk9e307aWYodHlwZW9mIGV4cG9ydHMhPT0ndW5kZWZpbmVkJyl7bW9kdWxlLmV4cG9ydHM9ZnV6enk7fWVsc2V7cm9vdC5mdXp6eT1mdXp6eTt9CmZ1enp5LnNpbXBsZUZpbHRlcj1mdW5jdGlvbihwYXR0ZXJuLGFycmF5KXtyZXR1cm4gYXJyYXkuZmlsdGVyKGZ1bmN0aW9uKHN0cmluZyl7cmV0dXJuIGZ1enp5LnRlc3QocGF0dGVybixzdHJpbmcpO30pO307ZnV6enkudGVzdD1mdW5jdGlvbihwYXR0ZXJuLHN0cmluZyl7cmV0dXJuIGZ1enp5Lm1hdGNoKHBhdHRlcm4sc3RyaW5nKSE9PW51bGw7fTtmdXp6eS5tYXRjaD1mdW5jdGlvbihwYXR0ZXJuLHN0cmluZyxvcHRzKXtvcHRzPW9wdHN8fHt9O3ZhciBwYXR0ZXJuSWR4PTAscmVzdWx0PVtdLGxlbj1zdHJpbmcubGVuZ3RoLHRvdGFsU2NvcmU9MCxjdXJyU2NvcmU9MCxwcmU9b3B0cy5wcmV8fCcnLHBvc3Q9b3B0cy5wb3N0fHwnJyxjb21wYXJlU3RyaW5nPW9wdHMuY2FzZVNlbnNpdGl2ZSYmc3RyaW5nfHxzdHJpbmcudG9Mb3dlckNhc2UoKSxjaCxjb21wYXJlQ2hhcjtwYXR0ZXJuPW9wdHMuY2FzZVNlbnNpdGl2ZSYmcGF0dGVybnx8cGF0dGVybi50b0xvd2VyQ2FzZSgpO2Zvcih2YXIgaWR4PTA7aWR4PGxlbjtpZHgrKyl7Y2g9c3RyaW5nW2lkeF07aWYoY29tcGFyZVN0cmluZ1tpZHhdPT09cGF0dGVybltwYXR0ZXJuSWR4XSl7aWYocGF0dGVybltwYXR0ZXJuSWR4XT09PScgJyl7Y3VyclNjb3JlPTEtaWR4LzIwMDt9ZWxzZXtjdXJyU2NvcmUrPTErY3VyclNjb3JlLWlkeC8yMDA7fQpjaD1wcmUrY2grcG9zdDtwYXR0ZXJuSWR4Kz0xO31lbHNle2N1cnJTY29yZT0wO30KdG90YWxTY29yZSs9Y3VyclNjb3JlO2lmKGNvbXBhcmVTdHJpbmdbaWR4XT09PScgJyl7Y3VyclNjb3JlPTA7fQpyZXN1bHRbcmVzdWx0Lmxlbmd0aF09Y2g7fQppZihwYXR0ZXJuSWR4PT09cGF0dGVybi5sZW5ndGgpe3JldHVybntyZW5kZXJlZDpyZXN1bHQuam9pbignJyksc2NvcmU6dG90YWxTY29yZX07fQpyZXR1cm4gbnVsbDt9O2Z1enp5LmZpbHRlcj1mdW5jdGlvbihwYXR0ZXJuLGFycixvcHRzKXtpZighYXJyfHxhcnIubGVuZ3RoPT09MCl7cmV0dXJuW119CmlmKHR5cGVvZiBwYXR0ZXJuIT09J3N0cmluZycpe3JldHVybiBhcnJ9Cm9wdHM9b3B0c3x8e307cmV0dXJuIGFyci5yZWR1Y2UoZnVuY3Rpb24ocHJldixlbGVtZW50LGlkeCxhcnIpe3ZhciBzdHI9ZWxlbWVudDtpZihvcHRzLmV4dHJhY3Qpe3N0cj1vcHRzLmV4dHJhY3QoZWxlbWVudCk7fQp2YXIgcmVuZGVyZWQ9ZnV6enkubWF0Y2gocGF0dGVybixzdHIsb3B0cyk7aWYocmVuZGVyZWQhPW51bGwpe3ByZXZbcHJldi5sZW5ndGhdPXtzdHJpbmc6cmVuZGVyZWQucmVuZGVyZWQsc2NvcmU6cmVuZGVyZWQuc2NvcmUsaW5kZXg6aWR4LG9yaWdpbmFsOmVsZW1lbnR9O30KcmV0dXJuIHByZXY7fSxbXSkuc29ydChmdW5jdGlvbihhLGIpe3ZhciBjb21wYXJlPWIuc2NvcmUtYS5zY29yZTtpZihjb21wYXJlKXJldHVybiBjb21wYXJlO3JldHVybiBhLmluZGV4LWIuaW5kZXg7fSk7fTt9KCkpOzsKCi8qIDxpbmxpbmUgYXNzZXQ+IGRlZmluZWQgaW4gYnVuZGxlICd3ZWIuYXNzZXRzX2JhY2tlbmQnICovCm9kb28uX21vZHVsZXM9WyJiYXNlIiwid2ViIiwiYmFzZV9pbXBvcnQiLCJ3ZWJfZGlhZ3JhbSIsIndlYl9lZGl0b3IiLCJ3ZWJfa2FuYmFuX2dhdWdlIiwid2ViX3RvdXIiXTs7CgovKiAvd2ViL3N0YXRpYy9saWIvcHkuanMvbGliL3B5LmpzIGRlZmluZWQgaW4gYnVuZGxlICd3ZWIuYXNzZXRzX2JhY2tlbmQnICovCnZhciBweT17fTsoZnVuY3Rpb24ocHkpe3ZhciBjcmVhdGU9ZnVuY3Rpb24obyxwcm9wcyl7ZnVuY3Rpb24gRigpe30KRi5wcm90b3R5cGU9bzt2YXIgaW5zdD1uZXcgRjtpZihwcm9wcyl7Zm9yKHZhciBuYW1lIGluIHByb3BzKXtpZighcHJvcHMuaGFzT3duUHJvcGVydHkobmFtZSkpe2NvbnRpbnVlO30KaW5zdFtuYW1lXT1wcm9wc1tuYW1lXTt9fQpyZXR1cm4gaW5zdDt9O3ZhciBzeW1ib2xzPXt9O3ZhciBjb21wYXJhdG9ycz17fTt2YXIgQmFzZT17bnVkOmZ1bmN0aW9uKCl7dGhyb3cgbmV3IEVycm9yKHRoaXMuaWQrIiB1bmRlZmluZWQgYXMgcHJlZml4Iik7fSxsZWQ6ZnVuY3Rpb24obGVkKXt0aHJvdyBuZXcgRXJyb3IodGhpcy5pZCsiIHVuZGVmaW5lZCBhcyBpbmZpeCIpO30sdG9TdHJpbmc6ZnVuY3Rpb24oKXtpZih0aGlzLmlkPT09Jyhjb25zdGFudCknfHx0aGlzLmlkPT09JyhudW1iZXIpJ3x8dGhpcy5pZD09PScobmFtZSknfHx0aGlzLmlkPT09JyhzdHJpbmcpJyl7cmV0dXJuW3RoaXMuaWQuc2xpY2UoMCx0aGlzLmlkLmxlbmd0aC0xKSwnICcsdGhpcy52YWx1ZSwnKSddLmpvaW4oJycpO31lbHNlIGlmKHRoaXMuaWQ9PT0nKGVuZCknKXtyZXR1cm4nKGVuZCknO31lbHNlIGlmKHRoaXMuaWQ9PT0nKGNvbXBhcmF0b3IpJyl7dmFyIHJlcHI9WycoY29tcGFyYXRvcicsdGhpcy5leHByZXNzaW9uc1swXV07Zm9yKHZhciBpPTA7aTx0aGlzLm9wZXJhdG9ycy5sZW5ndGg7KytpKXtyZXByLnB1c2godGhpcy5vcGVyYXRvcnNbaV0sdGhpcy5leHByZXNzaW9uc1tpKzFdKTt9CnJldHVybiByZXByLmpvaW4oJyAnKSsnKSc7fQp2YXIgb3V0PVt0aGlzLmlkLHRoaXMuZmlyc3QsdGhpcy5zZWNvbmQsdGhpcy50aGlyZF0uZmlsdGVyKGZ1bmN0aW9uKHIpe3JldHVybiByfSkuam9pbignICcpO3JldHVybicoJytvdXQrJyknO319O2Z1bmN0aW9uIHN5bWJvbChpZCxicCl7YnA9YnB8fDA7dmFyIHM9c3ltYm9sc1tpZF07aWYocyl7aWYoYnA+cy5sYnApe3MubGJwPWJwO30KcmV0dXJuIHM7fQpyZXR1cm4gc3ltYm9sc1tpZF09Y3JlYXRlKEJhc2Use2lkOmlkLGxicDpicH0pO30KZnVuY3Rpb24gY29uc3RhbnQoaWQpe3ZhciBzPXN5bWJvbChpZCk7cy5pZD0nKGNvbnN0YW50KSc7cy52YWx1ZT1pZDtzLm51ZD1mdW5jdGlvbigpe3JldHVybiB0aGlzO307fQpmdW5jdGlvbiBwcmVmaXgoaWQsYnAsbnVkKXtzeW1ib2woaWQpLm51ZD1udWR8fGZ1bmN0aW9uKCl7dGhpcy5maXJzdD1leHByZXNzaW9uKGJwKTtyZXR1cm4gdGhpc319CmZ1bmN0aW9uIGluZml4KGlkLGJwLGxlZCl7c3ltYm9sKGlkLGJwKS5sZWQ9bGVkfHxmdW5jdGlvbihsZWZ0KXt0aGlzLmZpcnN0PWxlZnQ7dGhpcy5zZWNvbmQ9ZXhwcmVzc2lvbihicCk7cmV0dXJuIHRoaXM7fX0KZnVuY3Rpb24gaW5maXhyKGlkLGJwKXtzeW1ib2woaWQsYnApLmxlZD1mdW5jdGlvbihsZWZ0KXt0aGlzLmZpcnN0PWxlZnQ7dGhpcy5zZWNvbmQ9ZXhwcmVzc2lvbihicC0xKTtyZXR1cm4gdGhpczt9fQpmdW5jdGlvbiBjb21wYXJhdG9yKGlkKXtjb21wYXJhdG9yc1tpZF09dHJ1ZTt2YXIgYnA9NjA7aW5maXgoaWQsYnAsZnVuY3Rpb24obGVmdCl7dGhpcy5pZD0nKGNvbXBhcmF0b3IpJzt0aGlzLm9wZXJhdG9ycz1baWRdO3RoaXMuZXhwcmVzc2lvbnM9W2xlZnQsZXhwcmVzc2lvbihicCldO3doaWxlKHRva2VuLmlkIGluIGNvbXBhcmF0b3JzKXt0aGlzLm9wZXJhdG9ycy5wdXNoKHRva2VuLmlkKTthZHZhbmNlKCk7dGhpcy5leHByZXNzaW9ucy5wdXNoKGV4cHJlc3Npb24oYnApKTt9CnJldHVybiB0aGlzO30pO30KY29uc3RhbnQoJ05vbmUnKTtjb25zdGFudCgnRmFsc2UnKTtjb25zdGFudCgnVHJ1ZScpO3N5bWJvbCgnKG51bWJlciknKS5udWQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpczt9O3N5bWJvbCgnKG5hbWUpJykubnVkPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXM7fTtzeW1ib2woJyhzdHJpbmcpJykubnVkPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXM7fTtzeW1ib2woJyhlbmQpJyk7c3ltYm9sKCc6Jyk7c3ltYm9sKCcpJyk7c3ltYm9sKCddJyk7c3ltYm9sKCd9Jyk7c3ltYm9sKCcsJyk7c3ltYm9sKCdlbHNlJyk7aW5maXgoJz0nLDEwLGZ1bmN0aW9uKGxlZnQpe2lmKGxlZnQuaWQhPT0nKG5hbWUpJyl7dGhyb3cgbmV3IEVycm9yKCJFeHBlY3RlZCBrZXl3b3JkIGFyZ3VtZW50IG5hbWUsIGdvdCAiK3Rva2VuLmlkKTt9CnRoaXMuZmlyc3Q9bGVmdDt0aGlzLnNlY29uZD1leHByZXNzaW9uKCk7cmV0dXJuIHRoaXM7fSk7c3ltYm9sKCdsYW1iZGEnLDIwKS5udWQ9ZnVuY3Rpb24oKXt0aGlzLmZpcnN0PVtdO2lmKHRva2VuLmlkIT09JzonKXtmb3IoOzspe2lmKHRva2VuLmlkIT09JyhuYW1lKScpe3Rocm93IG5ldyBFcnJvcignRXhjZXB0ZWQgYW4gYXJndW1lbnQgbmFtZScpO30KdGhpcy5maXJzdC5wdXNoKHRva2VuKTthZHZhbmNlKCk7aWYodG9rZW4uaWQhPT0nLCcpe2JyZWFrO30KYWR2YW5jZSgnLCcpO319CmFkdmFuY2UoJzonKTt0aGlzLnNlY29uZD1leHByZXNzaW9uKCk7cmV0dXJuIHRoaXM7fTtpbmZpeCgnaWYnLDIwLGZ1bmN0aW9uKGxlZnQpe3RoaXMuZmlyc3Q9bGVmdDt0aGlzLnNlY29uZD1leHByZXNzaW9uKCk7YWR2YW5jZSgnZWxzZScpO3RoaXMudGhpcmQ9ZXhwcmVzc2lvbigpO3JldHVybiB0aGlzO30pO2luZml4cignb3InLDMwKTtpbmZpeHIoJ2FuZCcsNDApO3ByZWZpeCgnbm90Jyw1MCk7Y29tcGFyYXRvcignaW4nKTtjb21wYXJhdG9yKCdub3QgaW4nKTtjb21wYXJhdG9yKCdpcycpO2NvbXBhcmF0b3IoJ2lzIG5vdCcpO2NvbXBhcmF0b3IoJzwnKTtjb21wYXJhdG9yKCc8PScpO2NvbXBhcmF0b3IoJz4nKTtjb21wYXJhdG9yKCc+PScpO2NvbXBhcmF0b3IoJzw+Jyk7Y29tcGFyYXRvcignIT0nKTtjb21wYXJhdG9yKCc9PScpO2luZml4KCd8Jyw3MCk7aW5maXgoJ14nLDgwKTtpbmZpeCgnJicsOTApO2luZml4KCc8PCcsMTAwKTtpbmZpeCgnPj4nLDEwMCk7aW5maXgoJysnLDExMCk7aW5maXgoJy0nLDExMCk7aW5maXgoJyonLDEyMCk7aW5maXgoJy8nLDEyMCk7aW5maXgoJy8vJywxMjApO2luZml4KCclJywxMjApO3ByZWZpeCgnLScsMTMwKTtwcmVmaXgoJysnLDEzMCk7cHJlZml4KCd+JywxMzApO2luZml4cignKionLDE0MCk7aW5maXgoJy4nLDE1MCxmdW5jdGlvbihsZWZ0KXtpZih0b2tlbi5pZCE9PScobmFtZSknKXt0aHJvdyBuZXcgRXJyb3IoJ0V4cGVjdGVkIGF0dHJpYnV0ZSBuYW1lLCBnb3QgJyt0b2tlbi5pZCk7fQp0aGlzLmZpcnN0PWxlZnQ7dGhpcy5zZWNvbmQ9dG9rZW47YWR2YW5jZSgpO3JldHVybiB0aGlzO30pO3N5bWJvbCgnKCcsMTUwKS5udWQ9ZnVuY3Rpb24oKXt0aGlzLmZpcnN0PVtdO3ZhciBjb21tYT1mYWxzZTtpZih0b2tlbi5pZCE9PScpJyl7d2hpbGUodHJ1ZSl7aWYodG9rZW4uaWQ9PT0nKScpe2JyZWFrO30KdGhpcy5maXJzdC5wdXNoKGV4cHJlc3Npb24oKSk7aWYodG9rZW4uaWQhPT0nLCcpe2JyZWFrO30KY29tbWE9dHJ1ZTthZHZhbmNlKCcsJyk7fX0KYWR2YW5jZSgnKScpO2lmKCF0aGlzLmZpcnN0Lmxlbmd0aHx8Y29tbWEpe3JldHVybiB0aGlzO31lbHNle3JldHVybiB0aGlzLmZpcnN0WzBdO319O3N5bWJvbCgnKCcpLmxlZD1mdW5jdGlvbihsZWZ0KXt0aGlzLmZpcnN0PWxlZnQ7dGhpcy5zZWNvbmQ9W107aWYodG9rZW4uaWQhPT0iKSIpe2Zvcig7Oyl7dGhpcy5zZWNvbmQucHVzaChleHByZXNzaW9uKCkpO2lmKHRva2VuLmlkIT09JywnKXticmVhazt9CmFkdmFuY2UoJywnKTt9fQphZHZhbmNlKCIpIik7cmV0dXJuIHRoaXM7fTtpbmZpeCgnWycsMTUwLGZ1bmN0aW9uKGxlZnQpe3RoaXMuZmlyc3Q9bGVmdDt0aGlzLnNlY29uZD1leHByZXNzaW9uKCk7YWR2YW5jZSgiXSIpO3JldHVybiB0aGlzO30pO3N5bWJvbCgnWycpLm51ZD1mdW5jdGlvbigpe3RoaXMuZmlyc3Q9W107aWYodG9rZW4uaWQhPT0nXScpe2Zvcig7Oyl7aWYodG9rZW4uaWQ9PT0nXScpe2JyZWFrO30KdGhpcy5maXJzdC5wdXNoKGV4cHJlc3Npb24oKSk7aWYodG9rZW4uaWQhPT0nLCcpe2JyZWFrO30KYWR2YW5jZSgnLCcpO319CmFkdmFuY2UoJ10nKTtyZXR1cm4gdGhpczt9O3N5bWJvbCgneycpLm51ZD1mdW5jdGlvbigpe3RoaXMuZmlyc3Q9W107aWYodG9rZW4uaWQhPT0nfScpe2Zvcig7Oyl7aWYodG9rZW4uaWQ9PT0nfScpe2JyZWFrO30KdmFyIGtleT1leHByZXNzaW9uKCk7YWR2YW5jZSgnOicpO3ZhciB2YWx1ZT1leHByZXNzaW9uKCk7dGhpcy5maXJzdC5wdXNoKFtrZXksdmFsdWVdKTtpZih0b2tlbi5pZCE9PScsJyl7YnJlYWs7fQphZHZhbmNlKCcsJyk7fX0KYWR2YW5jZSgnfScpO3JldHVybiB0aGlzO307cHkudG9rZW5pemU9KGZ1bmN0aW9uKCl7ZnVuY3Rpb24gZ3JvdXAoKXtyZXR1cm4nKCcrQXJyYXkucHJvdG90eXBlLmpvaW4uY2FsbChhcmd1bWVudHMsJ3wnKSsnKSc7fQp2YXIgV2hpdGVzcGFjZT0nWyBcXGZcXHRdKic7dmFyIE5hbWU9J1thLXpBLVpfXVxcdyonO3ZhciBEZWNOdW1iZXI9J1xcZCsoTHxsKT8nO3ZhciBJbnROdW1iZXI9RGVjTnVtYmVyO3ZhciBQb2ludEZsb2F0PWdyb3VwKCdcXGQrXFwuXFxkKicsJ1xcLlxcZCsnKTt2YXIgRmxvYXROdW1iZXI9UG9pbnRGbG9hdDt2YXIgTnVtYmVyPWdyb3VwKEZsb2F0TnVtYmVyLEludE51bWJlcik7dmFyIE9wZXJhdG9yPWdyb3VwKCJcXCpcXCo9PyIsIj4+PT8iLCI8PD0/IiwiPD4iLCIhPSIsIi8vPT8iLCJbK1xcLSovJSZ8Xj08Pl09PyIsIn4iKTt2YXIgQnJhY2tldD0nW1xcW1xcXVxcKFxcKVxce1xcfV0nO3ZhciBTcGVjaWFsPSdbOjsuLGBAXSc7dmFyIEZ1bm55PWdyb3VwKE9wZXJhdG9yLEJyYWNrZXQsU3BlY2lhbCk7dmFyIENvbnRTdHI9Z3JvdXAoIihbdVVdKT8nKFteXG4nXFxcXF0qKD86XFxcXC5bXlxuJ1xcXFxdKikqKSciLCcoW3VVXSk/IihbXlxuIlxcXFxdKig/OlxcXFwuW15cbiJcXFxcXSopKikiJyk7dmFyIFBzZXVkb1Rva2VuPVdoaXRlc3BhY2UrZ3JvdXAoTnVtYmVyLEZ1bm55LENvbnRTdHIsTmFtZSk7dmFyIG51bWJlcl9wYXR0ZXJuPW5ldyBSZWdFeHAoJ14nK051bWJlcisnJCcpO3ZhciBzdHJpbmdfcGF0dGVybj1uZXcgUmVnRXhwKCdeJytDb250U3RyKyckJyk7dmFyIG5hbWVfcGF0dGVybj1uZXcgUmVnRXhwKCdeJytOYW1lKyckJyk7dmFyIHN0cmlwPW5ldyBSZWdFeHAoJ14nK1doaXRlc3BhY2UpO3JldHVybiBmdW5jdGlvbiB0b2tlbml6ZShzKXt2YXIgbWF4PXMubGVuZ3RoLHRva2Vucz1bXSxzdGFydCxlbmQ7dmFyIHBzZXVkb3Byb2c9bmV3IFJlZ0V4cChQc2V1ZG9Ub2tlbiwnZycpO3doaWxlKHBzZXVkb3Byb2cubGFzdEluZGV4PG1heCl7dmFyIHBzZXVkb21hdGNoPXBzZXVkb3Byb2cuZXhlYyhzKTtpZighcHNldWRvbWF0Y2gpe2lmKC9eXHMrJC8udGVzdChzLnNsaWNlKGVuZCkpKXticmVhazt9CnRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIHRva2VuaXplIDw8JytzCisnPj4gYXQgaW5kZXggJysoZW5kfHwwKQorJzsgcGFyc2VkIHNvIGZhcjogJyt0b2tlbnMpO30Kc3RhcnQ9cHNldWRvbWF0Y2guaW5kZXg7ZW5kPXBzZXVkb3Byb2cubGFzdEluZGV4O3ZhciB0b2tlbj1zLnNsaWNlKHN0YXJ0LGVuZCkucmVwbGFjZShzdHJpcCwnJyk7aWYobnVtYmVyX3BhdHRlcm4udGVzdCh0b2tlbikpe3Rva2Vucy5wdXNoKGNyZWF0ZShzeW1ib2xzWycobnVtYmVyKSddLHt2YWx1ZTpwYXJzZUZsb2F0KHRva2VuKX0pKTt9ZWxzZSBpZihzdHJpbmdfcGF0dGVybi50ZXN0KHRva2VuKSl7dmFyIG09c3RyaW5nX3BhdHRlcm4uZXhlYyh0b2tlbik7dmFyIHZhbHVlPShtWzNdIT09dW5kZWZpbmVkP21bM106bVs1XSk7dG9rZW5zLnB1c2goY3JlYXRlKHN5bWJvbHNbJyhzdHJpbmcpJ10se3VuaWNvZGU6ISEobVsyXXx8bVs0XSksdmFsdWU6dmFsdWV9KSk7fWVsc2UgaWYodG9rZW4gaW4gc3ltYm9scyl7dmFyIHN5bWJvbDtpZih0b2tlbj09PSdpbicmJnRva2Vucy5sZW5ndGg+MSYmdG9rZW5zW3Rva2Vucy5sZW5ndGgtMV0uaWQ9PT0nbm90Jyl7c3ltYm9sPXN5bWJvbHNbJ25vdCBpbiddO3Rva2Vucy5wb3AoKTt9ZWxzZSBpZih0b2tlbj09PSdub3QnJiZ0b2tlbnMubGVuZ3RoPjEmJnRva2Vuc1t0b2tlbnMubGVuZ3RoLTFdLmlkPT09J2lzJyl7c3ltYm9sPXN5bWJvbHNbJ2lzIG5vdCddO3Rva2Vucy5wb3AoKTt9ZWxzZXtzeW1ib2w9c3ltYm9sc1t0b2tlbl07fQp0b2tlbnMucHVzaChjcmVhdGUoc3ltYm9sKSk7fWVsc2UgaWYobmFtZV9wYXR0ZXJuLnRlc3QodG9rZW4pKXt0b2tlbnMucHVzaChjcmVhdGUoc3ltYm9sc1snKG5hbWUpJ10se3ZhbHVlOnRva2VufSkpO31lbHNle3Rocm93IG5ldyBFcnJvcigiVG9rZW5pemluZyBmYWlsdXJlIG9mIDw8IitzKyI+PiBhdCBpbmRleCAiK3N0YXJ0CisiIGZvciB0b2tlbiBbWyIrdG9rZW4rIl1dIgorIjsgcGFyc2VkIHNvIGZhcjogIit0b2tlbnMpO319CnRva2Vucy5wdXNoKGNyZWF0ZShzeW1ib2xzWycoZW5kKSddKSk7cmV0dXJuIHRva2Vuczt9fSkoKTt2YXIgdG9rZW4sbmV4dDtmdW5jdGlvbiBleHByZXNzaW9uKHJicCl7cmJwPXJicHx8MDt2YXIgdD10b2tlbjt0b2tlbj1uZXh0KCk7dmFyIGxlZnQ9dC5udWQoKTt3aGlsZShyYnA8dG9rZW4ubGJwKXt0PXRva2VuO3Rva2VuPW5leHQoKTtsZWZ0PXQubGVkKGxlZnQpO30KcmV0dXJuIGxlZnQ7fQpmdW5jdGlvbiBhZHZhbmNlKGlkKXtpZihpZCYmdG9rZW4uaWQhPT1pZCl7dGhyb3cgbmV3IEVycm9yKCdFeHBlY3RlZCAiJytpZCsnIiwgZ290ICInK3Rva2VuLmlkKyciJyk7fQp0b2tlbj1uZXh0KCk7fQpmdW5jdGlvbiBQWV9lbnN1cmVweSh2YWwsbmFtZSl7c3dpdGNoKHZhbCl7Y2FzZSB1bmRlZmluZWQ6dGhyb3cgbmV3IEVycm9yKCJOYW1lRXJyb3I6IG5hbWUgJyIrbmFtZSsiJyBpcyBub3QgZGVmaW5lZCIpO2Nhc2UgbnVsbDpyZXR1cm4gcHkuTm9uZTtjYXNlIHRydWU6cmV0dXJuIHB5LlRydWU7Y2FzZSBmYWxzZTpyZXR1cm4gcHkuRmFsc2U7fQp2YXIgZm49ZnVuY3Rpb24oKXt9O2ZuLnByb3RvdHlwZT1weS5vYmplY3Q7aWYocHkuUFlfaXNJbnN0YW5jZSh2YWwscHkub2JqZWN0KXx8cHkuUFlfaXNTdWJjbGFzcyh2YWwscHkub2JqZWN0KSl7cmV0dXJuIHZhbDt9CnN3aXRjaCh0eXBlb2YgdmFsKXtjYXNlJ251bWJlcic6cmV0dXJuIHB5LmZsb2F0LmZyb21KU09OKHZhbCk7Y2FzZSdzdHJpbmcnOnJldHVybiBweS5zdHIuZnJvbUpTT04odmFsKTtjYXNlJ2Z1bmN0aW9uJzpyZXR1cm4gcHkuUFlfZGVmLmZyb21KU09OKHZhbCk7fQpzd2l0Y2godmFsLmNvbnN0cnVjdG9yKXtjYXNlIE9iamVjdDp2YXIgbz1weS5QWV9jYWxsKHB5Lm9iamVjdCk7Zm9yKHZhciBwcm9wIGluIHZhbCl7aWYodmFsLmhhc093blByb3BlcnR5KHByb3ApKXtvW3Byb3BdPXZhbFtwcm9wXTt9fQpyZXR1cm4gbztjYXNlIEFycmF5OnJldHVybiBweS5saXN0LmZyb21KU09OKHZhbCk7fQp0aHJvdyBuZXcgRXJyb3IoIkNvdWxkIG5vdCBjb252ZXJ0ICIrdmFsKyIgdG8gYSBweXZhbCIpO30KdmFyIHR5cGVuYW1lPWZ1bmN0aW9uKG9iail7aWYob2JqLl9fY2xhc3NfXyl7cmV0dXJuIG9iai5fX2NsYXNzX18uX19uYW1lX187fWVsc2UgaWYodHlwZW9mIG9iaiE9PSdvYmplY3QnKXtyZXR1cm4gdHlwZW9mIG9iajt9ZWxzZXtyZXR1cm4gb2JqLmNvbnN0cnVjdG9yLm5hbWU7fX07cHkucHk9e307cHkuUFlfcGFyc2VBcmdzPWZ1bmN0aW9uIFBZX3BhcnNlQXJncyhhcmd1bWVudCxmb3JtYXQpe3ZhciBvdXQ9e307dmFyIGFyZ3M9YXJndW1lbnRbMF07dmFyIGt3YXJncz17fTtmb3IodmFyIGsgaW4gYXJndW1lbnRbMV0pe2lmKCFhcmd1bWVudFsxXS5oYXNPd25Qcm9wZXJ0eShrKSl7Y29udGludWU7fQprd2FyZ3Nba109YXJndW1lbnRbMV1ba107fQppZih0eXBlb2YgZm9ybWF0PT09J3N0cmluZycpe2Zvcm1hdD1mb3JtYXQuc3BsaXQoL1xzKy8pO30KdmFyIG5hbWU9ZnVuY3Rpb24oc3BlYyl7aWYodHlwZW9mIHNwZWM9PT0nc3RyaW5nJyl7cmV0dXJuIHNwZWM7fWVsc2UgaWYoc3BlYyBpbnN0YW5jZW9mIEFycmF5JiZzcGVjLmxlbmd0aD09PTIpe3JldHVybiBzcGVjWzBdO30KdGhyb3cgbmV3IEVycm9yKCJUeXBlRXJyb3I6IHVua25vd24gZm9ybWF0IHNwZWNpZmljYXRpb24gIisKSlNPTi5zdHJpbmdpZnkoc3BlYykpO307dmFyIHNwZWM7Zm9yKHZhciBpPTA7aTxhcmdzLmxlbmd0aDsrK2kpe3NwZWM9Zm9ybWF0W2ldO2lmKCFzcGVjfHxzcGVjPT09JyonKXt0aHJvdyBuZXcgRXJyb3IoIlR5cGVFcnJvcjogZnVuY3Rpb24gdGFrZXMgZXhhY3RseSAiKyhpLTEpKyIgcG9zaXRpb25hbCBhcmd1bWVudHMgKCIrYXJncy5sZW5ndGgrIiBnaXZlbiIpfWVsc2UgaWYoL15cKlx3Ly50ZXN0KHNwZWMpKXtvdXRbbmFtZShzcGVjLnNsaWNlKDEpKV09YXJncy5zbGljZShpKTticmVhazt9Cm91dFtuYW1lKHNwZWMpXT1hcmdzW2ldO30KZm9yKHZhciBqPWk7ajxmb3JtYXQubGVuZ3RoOysrail7c3BlYz1mb3JtYXRbal07dmFyIG49bmFtZShzcGVjKTtpZihuIGluIG91dCl7dGhyb3cgbmV3IEVycm9yKCJUeXBlRXJyb3I6IGZ1bmN0aW9uIGdvdCBtdWx0aXBsZSB2YWx1ZXMgIisiZm9yIGtleXdvcmQgYXJndW1lbnQgJyIra3dhcmcrIiciKTt9CmlmKC9eXCpcKlx3Ly50ZXN0KG4pKXtvdXRbbi5zbGljZSgyKV09a3dhcmdzO2t3YXJncz17fTticmVhazt9CmlmKG4gaW4ga3dhcmdzKXtvdXRbbl09a3dhcmdzW25dO2RlbGV0ZSBrd2FyZ3Nbbl07fX0KZm9yKHZhciBrZXkgaW4ga3dhcmdzKXt0aHJvdyBuZXcgRXJyb3IoIlR5cGVFcnJvcjogZnVuY3Rpb24gZ290IGFuIHVuZXhwZWN0ZWQga2V5d29yZCBhcmd1bWVudCAnIgora2V5KyInIik7fQp2YXIga3dvbmx5PTA7Zm9yKHZhciBrPTA7azxmb3JtYXQubGVuZ3RoOysrayl7aWYoL15cKi8udGVzdChmb3JtYXRba10pKXtrd29ubHk9MTticmVhazt9fQpmb3IodmFyIGs9MDtrPGZvcm1hdC5sZW5ndGg7KytrKXtzcGVjPWZvcm1hdFtrXTt2YXIgbj1uYW1lKHNwZWMpO2lmKC9eXCovLnRlc3Qobil8fG4gaW4gb3V0KXtjb250aW51ZTt9CmlmKCEoc3BlYyBpbnN0YW5jZW9mIEFycmF5KSl7dGhyb3cgbmV3IEVycm9yKCJUeXBlRXJyb3I6IGZ1bmN0aW9uIHRha2VzIGV4YWN0bHkgIisoZm9ybWF0Lmxlbmd0aC1rd29ubHkpCisiIGFyZ3VtZW50cyIpO30Kb3V0W25dPXNwZWNbMV07fQpyZXR1cm4gb3V0O307cHkuUFlfaGFzQXR0cj1mdW5jdGlvbihvLGF0dHJfbmFtZSl7dHJ5e3B5LlBZX2dldEF0dHIobyxhdHRyX25hbWUpO3JldHVybiB0cnVlO31jYXRjaChlKXtyZXR1cm4gZmFsc2U7fX07cHkuUFlfZ2V0QXR0cj1mdW5jdGlvbihvLGF0dHJfbmFtZSl7cmV0dXJuIFBZX2Vuc3VyZXB5KG8uX19nZXRhdHRyaWJ1dGVfXyhhdHRyX25hbWUpKTt9O3B5LlBZX3N0cj1mdW5jdGlvbihvKXt2YXIgdj1vLl9fc3RyX18oKTtpZihweS5QWV9pc0luc3RhbmNlKHYscHkuc3RyKSl7cmV0dXJuIHY7fQp0aHJvdyBuZXcgRXJyb3IoJ1R5cGVFcnJvcjogX19zdHJfXyByZXR1cm5lZCBub24tc3RyaW5nICh0eXBlICcKK3R5cGVuYW1lKHYpCisnKScpO307cHkuUFlfaXNJbnN0YW5jZT1mdW5jdGlvbihpbnN0LGNscyl7dmFyIGZuPWZ1bmN0aW9uKCl7fTtmbi5wcm90b3R5cGU9Y2xzO3JldHVybiBpbnN0IGluc3RhbmNlb2YgZm47fTtweS5QWV9pc1N1YmNsYXNzPWZ1bmN0aW9uKGRlcml2ZWQsY2xzKXt2YXIgZm49ZnVuY3Rpb24oKXt9O2ZuLnByb3RvdHlwZT1jbHM7cmV0dXJuIGRlcml2ZWQ9PT1jbHN8fGRlcml2ZWQgaW5zdGFuY2VvZiBmbjt9O3B5LlBZX2NhbGw9ZnVuY3Rpb24oY2FsbGFibGUsYXJncyxrd2FyZ3Mpe2lmKCFhcmdzKXthcmdzPVtdO30KaWYodHlwZW9mIGFyZ3M9PT0nb2JqZWN0JyYmIShhcmdzIGluc3RhbmNlb2YgQXJyYXkpKXtrd2FyZ3M9YXJnczthcmdzPVtdO30KaWYoIWt3YXJncyl7a3dhcmdzPXt9O30KaWYoY2FsbGFibGUuX19pc190eXBlKXt2YXIgaW5zdGFuY2U9Y2FsbGFibGUuX19uZXdfXy5jYWxsKGNhbGxhYmxlLGFyZ3Msa3dhcmdzKTt2YXIgdHlwPWZ1bmN0aW9uKCl7fTt0eXAucHJvdG90eXBlPWNhbGxhYmxlO2lmKGluc3RhbmNlIGluc3RhbmNlb2YgdHlwKXtpbnN0YW5jZS5fX2luaXRfXy5jYWxsKGluc3RhbmNlLGFyZ3Msa3dhcmdzKTt9CnJldHVybiBpbnN0YW5jZX0KcmV0dXJuIGNhbGxhYmxlLl9fY2FsbF9fKGFyZ3Msa3dhcmdzKTt9O3B5LlBZX2lzVHJ1ZT1mdW5jdGlvbihvKXt2YXIgcmVzPW8uX19ub256ZXJvX18oKTtpZihyZXM9PT1weS5UcnVlKXtyZXR1cm4gdHJ1ZTt9CmlmKHJlcz09PXB5LkZhbHNlKXtyZXR1cm4gZmFsc2U7fQp0aHJvdyBuZXcgRXJyb3IoIlR5cGVFcnJvcjogX19ub256ZXJvX18gc2hvdWxkIHJldHVybiBib29sLCByZXR1cm5lZCAiCit0eXBlbmFtZShyZXMpKTt9O3B5LlBZX25vdD1mdW5jdGlvbihvKXtyZXR1cm4hcHkuUFlfaXNUcnVlKG8pO307cHkuUFlfc2l6ZT1mdW5jdGlvbihvKXtpZighby5fX2xlbl9fKXt0aHJvdyBuZXcgRXJyb3IoIlR5cGVFcnJvcjogb2JqZWN0IG9mIHR5cGUgJyIrCnR5cGVuYW1lKG8pKyInIGhhcyBubyBsZW4oKSIpO30KdmFyIHY9by5fX2xlbl9fKCk7aWYodHlwZW9mIHYhPT0nbnVtYmVyJyl7dGhyb3cgbmV3IEVycm9yKCJUeXBlRXJyb3I6IGEgbnVtYmVyIGlzIHJlcXVpcmVkIik7fQpyZXR1cm4gdjt9O3B5LlBZX2dldEl0ZW09ZnVuY3Rpb24obyxrZXkpe2lmKCEoJ19fZ2V0aXRlbV9fJ2luIG8pKXt0aHJvdyBuZXcgRXJyb3IoIlR5cGVFcnJvcjogJyIrdHlwZW5hbWUobykrIicgb2JqZWN0IGlzIHVuc3Vic2NyaXB0YWJsZSIpfQppZighcHkuUFlfaXNJbnN0YW5jZShrZXkscHkub2JqZWN0KSl7dGhyb3cgbmV3IEVycm9yKCJUeXBlRXJyb3I6ICciK3R5cGVuYW1lKGtleSkrIicgaXMgbm90IGEgcHkuanMgb2JqZWN0Iik7fQp2YXIgcmVzPW8uX19nZXRpdGVtX18oa2V5KTtpZighcHkuUFlfaXNJbnN0YW5jZShrZXkscHkub2JqZWN0KSl7dGhyb3cgbmV3IEVycm9yKCJUeXBlRXJyb3I6IF9fZ2V0aXRlbV9fIG11c3QgcmV0dXJuIGEgcHkuanMgb2JqZWN0LCBnb3QgIgordHlwZW5hbWUocmVzKSk7fQpyZXR1cm4gcmVzO307cHkuUFlfc2V0SXRlbT1mdW5jdGlvbihvLGtleSx2KXtpZighKCdfX3NldGl0ZW1fXydpbiBvKSl7dGhyb3cgbmV3IEVycm9yKCJUeXBlRXJyb3I6ICciK3R5cGVuYW1lKG8pKyInIG9iamVjdCBkb2VzIG5vdCBzdXBwb3J0IGl0ZW0gYXNzaWdubWVudCIpO30KaWYoIXB5LlBZX2lzSW5zdGFuY2Uoa2V5LHB5Lm9iamVjdCkpe3Rocm93IG5ldyBFcnJvcigiVHlwZUVycm9yOiAnIit0eXBlbmFtZShrZXkpKyInIGlzIG5vdCBhIHB5LmpzIG9iamVjdCIpO30KaWYoIXB5LlBZX2lzSW5zdGFuY2UodixweS5vYmplY3QpKXt0aHJvdyBuZXcgRXJyb3IoIlR5cGVFcnJvcjogJyIrdHlwZW5hbWUodikrIicgaXMgbm90IGEgcHkuanMgb2JqZWN0Iik7fQpvLl9fc2V0aXRlbV9fKGtleSx2KTt9O3B5LlBZX2FkZD1mdW5jdGlvbihvMSxvMil7cmV0dXJuIFBZX29wKG8xLG8yLCcrJyk7fTtweS5QWV9zdWJ0cmFjdD1mdW5jdGlvbihvMSxvMil7cmV0dXJuIFBZX29wKG8xLG8yLCctJyk7fTtweS5QWV9tdWx0aXBseT1mdW5jdGlvbihvMSxvMil7cmV0dXJuIFBZX29wKG8xLG8yLCcqJyk7fTtweS5QWV9kaXZpZGU9ZnVuY3Rpb24obzEsbzIpe3JldHVybiBQWV9vcChvMSxvMiwnLycpO307cHkuUFlfbmVnYXRpdmU9ZnVuY3Rpb24obyl7aWYoIW8uX19uZWdfXyl7dGhyb3cgbmV3IEVycm9yKCJUeXBlRXJyb3I6IGJhZCBvcGVyYW5kIGZvciB1bmFyeSAtOiAnIgordHlwZW5hbWUobykKKyInIik7fQpyZXR1cm4gby5fX25lZ19fKCk7fTtweS5QWV9wb3NpdGl2ZT1mdW5jdGlvbihvKXtpZighby5fX3Bvc19fKXt0aHJvdyBuZXcgRXJyb3IoIlR5cGVFcnJvcjogYmFkIG9wZXJhbmQgZm9yIHVuYXJ5ICs6ICciCit0eXBlbmFtZShvKQorIiciKTt9CnJldHVybiBvLl9fcG9zX18oKTt9O3B5LnR5cGU9ZnVuY3Rpb24gdHlwZShuYW1lLGJhc2VzLGRpY3Qpe2lmKHR5cGVvZiBuYW1lIT09J3N0cmluZycpe3Rocm93IG5ldyBFcnJvcigiVmFsdWVFcnJvcjogYSBjbGFzcyBuYW1lIHNob3VsZCBiZSBhIHN0cmluZyIpO30KaWYoIWJhc2VzfHxiYXNlcy5sZW5ndGg9PT0wKXtiYXNlcz1bcHkub2JqZWN0XTt9ZWxzZSBpZihiYXNlcy5sZW5ndGg+MSl7dGhyb3cgbmV3IEVycm9yKCJWYWx1ZUVycm9yOiBjYW4ndCBwcm92aWRlIG11bHRpcGxlIGJhc2VzIGZvciBhICIKKyJuZXcgdHlwZSIpO30KdmFyIGJhc2U9YmFzZXNbMF07dmFyIENsYXNzT2JqPWNyZWF0ZShiYXNlKTtpZihkaWN0KXtmb3IodmFyIGsgaW4gZGljdCl7aWYoIWRpY3QuaGFzT3duUHJvcGVydHkoaykpe2NvbnRpbnVlO30KQ2xhc3NPYmpba109ZGljdFtrXTt9fQpDbGFzc09iai5fX2NsYXNzX189Q2xhc3NPYmo7Q2xhc3NPYmouX19uYW1lX189bmFtZTtDbGFzc09iai5fX2Jhc2VzX189YmFzZXM7Q2xhc3NPYmouX19pc190eXBlPXRydWU7cmV0dXJuIENsYXNzT2JqO307cHkudHlwZS5fX2NhbGxfXz1mdW5jdGlvbigpe3ZhciBhcmdzPXB5LlBZX3BhcnNlQXJncyhhcmd1bWVudHMsWydvYmplY3QnXSk7cmV0dXJuIGFyZ3Mub2JqZWN0Ll9fY2xhc3NfXzt9O3ZhciBoYXNoX2NvdW50ZXI9MDtweS5vYmplY3Q9cHkudHlwZSgnb2JqZWN0Jyxbe31dLHtfX25ld19fOmZ1bmN0aW9uKCl7dmFyIGluc3Q9Y3JlYXRlKHRoaXMpO2luc3QuX19pc190eXBlPWZhbHNlO3JldHVybiBpbnN0O30sX19pbml0X186ZnVuY3Rpb24oKXt9LF9faGFzaF9fOmZ1bmN0aW9uKCl7aWYodGhpcy5faGFzaCl7cmV0dXJuIHRoaXMuX2hhc2g7fQpyZXR1cm4gdGhpcy5faGFzaD0nXDBcMFwwJytTdHJpbmcoaGFzaF9jb3VudGVyKyspO30sX19lcV9fOmZ1bmN0aW9uKG90aGVyKXtyZXR1cm4odGhpcz09PW90aGVyKT9weS5UcnVlOnB5LkZhbHNlO30sX19uZV9fOmZ1bmN0aW9uKG90aGVyKXtpZihweS5QWV9pc1RydWUodGhpcy5fX2VxX18ob3RoZXIpKSl7cmV0dXJuIHB5LkZhbHNlO31lbHNle3JldHVybiBweS5UcnVlO319LF9fbHRfXzpmdW5jdGlvbigpe3JldHVybiBweS5Ob3RJbXBsZW1lbnRlZDt9LF9fbGVfXzpmdW5jdGlvbigpe3JldHVybiBweS5Ob3RJbXBsZW1lbnRlZDt9LF9fZ2VfXzpmdW5jdGlvbigpe3JldHVybiBweS5Ob3RJbXBsZW1lbnRlZDt9LF9fZ3RfXzpmdW5jdGlvbigpe3JldHVybiBweS5Ob3RJbXBsZW1lbnRlZDt9LF9fc3RyX186ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fX3VuaWNvZGVfXygpO30sX191bmljb2RlX186ZnVuY3Rpb24oKXtyZXR1cm4gcHkuc3RyLmZyb21KU09OKCc8Jyt0eXBlbmFtZSh0aGlzKSsnIG9iamVjdD4nKTt9LF9fbm9uemVyb19fOmZ1bmN0aW9uKCl7cmV0dXJuIHB5LlRydWU7fSxfX2dldGF0dHJpYnV0ZV9fOmZ1bmN0aW9uKG5hbWUpe2lmKG5hbWUgaW4gdGhpcyl7dmFyIHZhbD10aGlzW25hbWVdO2lmKHR5cGVvZiB2YWw9PT0nb2JqZWN0JyYmJ19fZ2V0X18naW4gdmFsKXtyZXR1cm4gdmFsLl9fZ2V0X18odGhpcyxweS5QWV9jYWxsKHB5LnR5cGUsW3RoaXNdKSk7fQppZih0eXBlb2YgdmFsPT09J2Z1bmN0aW9uJyYmIXRoaXMuaGFzT3duUHJvcGVydHkobmFtZSkpe3JldHVybiBQWV9pbnN0YW5jZW1ldGhvZC5mcm9tSlNPTih2YWwsdGhpcyk7fQpyZXR1cm4gdmFsO30KaWYoJ19fZ2V0YXR0cl9fJ2luIHRoaXMpe3JldHVybiB0aGlzLl9fZ2V0YXR0cl9fKG5hbWUpO30KdGhyb3cgbmV3IEVycm9yKCJBdHRyaWJ1dGVFcnJvcjogb2JqZWN0IGhhcyBubyBhdHRyaWJ1dGUgJyIrbmFtZSsiJyIpO30sX19zZXRhdHRyX186ZnVuY3Rpb24obmFtZSx2YWx1ZSl7aWYobmFtZSBpbiB0aGlzJiYnX19zZXRfXydpbiB0aGlzW25hbWVdKXt0aGlzW25hbWVdLl9fc2V0X18odGhpcyx2YWx1ZSk7fQp0aGlzW25hbWVdPXZhbHVlO30sdG9KU09OOmZ1bmN0aW9uKCl7dGhyb3cgbmV3IEVycm9yKHRoaXMuY29uc3RydWN0b3IubmFtZSsnIGNhbiBub3QgYmUgY29udmVydGVkIHRvIEpTT04nKTt9fSk7dmFyIE5vbmVUeXBlPXB5LnR5cGUoJ05vbmVUeXBlJyxudWxsLHtfX25vbnplcm9fXzpmdW5jdGlvbigpe3JldHVybiBweS5GYWxzZTt9LHRvSlNPTjpmdW5jdGlvbigpe3JldHVybiBudWxsO319KTtweS5Ob25lPXB5LlBZX2NhbGwoTm9uZVR5cGUpO3ZhciBOb3RJbXBsZW1lbnRlZFR5cGU9cHkudHlwZSgnTm90SW1wbGVtZW50ZWRUeXBlJyxudWxsLHt9KTtweS5Ob3RJbXBsZW1lbnRlZD1weS5QWV9jYWxsKE5vdEltcGxlbWVudGVkVHlwZSk7dmFyIGJvb2xlYW5zX2luaXRpYWxpemVkPWZhbHNlO3B5LmJvb2w9cHkudHlwZSgnYm9vbCcsbnVsbCx7X19uZXdfXzpmdW5jdGlvbigpe2lmKCFib29sZWFuc19pbml0aWFsaXplZCl7cmV0dXJuIHB5Lm9iamVjdC5fX25ld19fLmFwcGx5KHRoaXMpO30KdmFyIHBoPXt9O3ZhciBhcmdzPXB5LlBZX3BhcnNlQXJncyhhcmd1bWVudHMsW1sndmFsdWUnLHBoXV0pO2lmKGFyZ3MudmFsdWU9PT1waCl7cmV0dXJuIHB5LkZhbHNlO30KcmV0dXJuIHB5LlBZX2lzVHJ1ZShhcmdzLnZhbHVlKT9weS5UcnVlOnB5LkZhbHNlO30sX19zdHJfXzpmdW5jdGlvbigpe3JldHVybiBweS5zdHIuZnJvbUpTT04oKHRoaXM9PT1weS5UcnVlKT8iVHJ1ZSI6IkZhbHNlIik7fSxfX25vbnplcm9fXzpmdW5jdGlvbigpe3JldHVybiB0aGlzO30sZnJvbUpTT046ZnVuY3Rpb24odmFsKXtyZXR1cm4gdmFsP3B5LlRydWU6cHkuRmFsc2V9LHRvSlNPTjpmdW5jdGlvbigpe3JldHVybiB0aGlzPT09cHkuVHJ1ZTt9fSk7cHkuVHJ1ZT1weS5QWV9jYWxsKHB5LmJvb2wpO3B5LkZhbHNlPXB5LlBZX2NhbGwocHkuYm9vbCk7Ym9vbGVhbnNfaW5pdGlhbGl6ZWQ9dHJ1ZTtweS5mbG9hdD1weS50eXBlKCdmbG9hdCcsbnVsbCx7X19pbml0X186ZnVuY3Rpb24oKXt2YXIgcGxhY2Vob2xkZXI9e307dmFyIGFyZ3M9cHkuUFlfcGFyc2VBcmdzKGFyZ3VtZW50cyxbWyd2YWx1ZScscGxhY2Vob2xkZXJdXSk7dmFyIHZhbHVlPWFyZ3MudmFsdWU7aWYodmFsdWU9PT1wbGFjZWhvbGRlcil7dGhpcy5fdmFsdWU9MDtyZXR1cm47fQppZihweS5QWV9pc0luc3RhbmNlKHZhbHVlLHB5LmZsb2F0KSl7dGhpcy5fdmFsdWU9dmFsdWUuX3ZhbHVlO30KaWYocHkuUFlfaXNJbnN0YW5jZSh2YWx1ZSxweS5vYmplY3QpJiYnX19mbG9hdF9fJ2luIHZhbHVlKXt2YXIgcmVzPXZhbHVlLl9fZmxvYXRfXygpO2lmKHB5LlBZX2lzSW5zdGFuY2UocmVzLHB5LmZsb2F0KSl7dGhpcy5fdmFsdWU9cmVzLl92YWx1ZTtyZXR1cm47fQp0aHJvdyBuZXcgRXJyb3IoJ1R5cGVFcnJvcjogX19mbG9hdF9fIHJldHVybmVkIG5vbi1mbG9hdCAodHlwZSAnKwp0eXBlbmFtZShyZXMpKycpJyk7fQp0aHJvdyBuZXcgRXJyb3IoJ1R5cGVFcnJvcjogZmxvYXQoKSBhcmd1bWVudCBtdXN0IGJlIGEgc3RyaW5nIG9yIGEgbnVtYmVyJyk7fSxfX3N0cl9fOmZ1bmN0aW9uKCl7cmV0dXJuIHB5LnN0ci5mcm9tSlNPTihTdHJpbmcodGhpcy5fdmFsdWUpKTt9LF9fZXFfXzpmdW5jdGlvbihvdGhlcil7cmV0dXJuIHRoaXMuX3ZhbHVlPT09b3RoZXIuX3ZhbHVlP3B5LlRydWU6cHkuRmFsc2U7fSxfX2x0X186ZnVuY3Rpb24ob3RoZXIpe2lmKCFweS5QWV9pc0luc3RhbmNlKG90aGVyLHB5LmZsb2F0KSl7cmV0dXJuIHB5Lk5vdEltcGxlbWVudGVkO30KcmV0dXJuIHRoaXMuX3ZhbHVlPG90aGVyLl92YWx1ZT9weS5UcnVlOnB5LkZhbHNlO30sX19sZV9fOmZ1bmN0aW9uKG90aGVyKXtpZighcHkuUFlfaXNJbnN0YW5jZShvdGhlcixweS5mbG9hdCkpe3JldHVybiBweS5Ob3RJbXBsZW1lbnRlZDt9CnJldHVybiB0aGlzLl92YWx1ZTw9b3RoZXIuX3ZhbHVlP3B5LlRydWU6cHkuRmFsc2U7fSxfX2d0X186ZnVuY3Rpb24ob3RoZXIpe2lmKCFweS5QWV9pc0luc3RhbmNlKG90aGVyLHB5LmZsb2F0KSl7cmV0dXJuIHB5Lk5vdEltcGxlbWVudGVkO30KcmV0dXJuIHRoaXMuX3ZhbHVlPm90aGVyLl92YWx1ZT9weS5UcnVlOnB5LkZhbHNlO30sX19nZV9fOmZ1bmN0aW9uKG90aGVyKXtpZighcHkuUFlfaXNJbnN0YW5jZShvdGhlcixweS5mbG9hdCkpe3JldHVybiBweS5Ob3RJbXBsZW1lbnRlZDt9CnJldHVybiB0aGlzLl92YWx1ZT49b3RoZXIuX3ZhbHVlP3B5LlRydWU6cHkuRmFsc2U7fSxfX2Fic19fOmZ1bmN0aW9uKCl7cmV0dXJuIHB5LmZsb2F0LmZyb21KU09OKE1hdGguYWJzKHRoaXMuX3ZhbHVlKSk7fSxfX2FkZF9fOmZ1bmN0aW9uKG90aGVyKXtpZighcHkuUFlfaXNJbnN0YW5jZShvdGhlcixweS5mbG9hdCkpe3JldHVybiBweS5Ob3RJbXBsZW1lbnRlZDt9CnJldHVybiBweS5mbG9hdC5mcm9tSlNPTih0aGlzLl92YWx1ZStvdGhlci5fdmFsdWUpO30sX19tb2RfXzpmdW5jdGlvbihvdGhlcil7aWYoIXB5LlBZX2lzSW5zdGFuY2Uob3RoZXIscHkuZmxvYXQpKXtyZXR1cm4gcHkuTm90SW1wbGVtZW50ZWQ7fQpyZXR1cm4gcHkuZmxvYXQuZnJvbUpTT04odGhpcy5fdmFsdWUlb3RoZXIuX3ZhbHVlKTt9LF9fbmVnX186ZnVuY3Rpb24oKXtyZXR1cm4gcHkuZmxvYXQuZnJvbUpTT04oLXRoaXMuX3ZhbHVlKTt9LF9fc3ViX186ZnVuY3Rpb24ob3RoZXIpe2lmKCFweS5QWV9pc0luc3RhbmNlKG90aGVyLHB5LmZsb2F0KSl7cmV0dXJuIHB5Lk5vdEltcGxlbWVudGVkO30KcmV0dXJuIHB5LmZsb2F0LmZyb21KU09OKHRoaXMuX3ZhbHVlLW90aGVyLl92YWx1ZSk7fSxfX211bF9fOmZ1bmN0aW9uKG90aGVyKXtpZighcHkuUFlfaXNJbnN0YW5jZShvdGhlcixweS5mbG9hdCkpe3JldHVybiBweS5Ob3RJbXBsZW1lbnRlZDt9CnJldHVybiBweS5mbG9hdC5mcm9tSlNPTih0aGlzLl92YWx1ZSpvdGhlci5fdmFsdWUpO30sX19wb3dfXzpmdW5jdGlvbihvdGhlcil7aWYoIXB5LlBZX2lzSW5zdGFuY2Uob3RoZXIscHkuZmxvYXQpKXtyZXR1cm4gcHkuTm90SW1wbGVtZW50ZWQ7fQpyZXR1cm4gcHkuZmxvYXQuZnJvbUpTT04odGhpcy5fdmFsdWUqKm90aGVyLl92YWx1ZSk7fSxfX2Rpdl9fOmZ1bmN0aW9uKG90aGVyKXtpZighcHkuUFlfaXNJbnN0YW5jZShvdGhlcixweS5mbG9hdCkpe3JldHVybiBweS5Ob3RJbXBsZW1lbnRlZDt9CnJldHVybiBweS5mbG9hdC5mcm9tSlNPTih0aGlzLl92YWx1ZS9vdGhlci5fdmFsdWUpO30sX19ub256ZXJvX186ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fdmFsdWU/cHkuVHJ1ZTpweS5GYWxzZTt9LGZyb21KU09OOmZ1bmN0aW9uKHYpe2lmKCEodHlwZW9mIHY9PT0nbnVtYmVyJykpe3Rocm93IG5ldyBFcnJvcigncHkuZmxvYXQuZnJvbUpTT04gY2FuIG9ubHkgdGFrZSBudW1iZXJzJyk7fQp2YXIgaW5zdGFuY2U9cHkuUFlfY2FsbChweS5mbG9hdCk7aW5zdGFuY2UuX3ZhbHVlPXY7cmV0dXJuIGluc3RhbmNlO30sdG9KU09OOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3ZhbHVlO319KTtweS5zdHI9cHkudHlwZSgnc3RyJyxudWxsLHtfX2luaXRfXzpmdW5jdGlvbigpe3ZhciBwbGFjZWhvbGRlcj17fTt2YXIgYXJncz1weS5QWV9wYXJzZUFyZ3MoYXJndW1lbnRzLFtbJ3ZhbHVlJyxwbGFjZWhvbGRlcl1dKTt2YXIgcz1hcmdzLnZhbHVlO2lmKHM9PT1wbGFjZWhvbGRlcil7dGhpcy5fdmFsdWU9Jyc7cmV0dXJuO30KdGhpcy5fdmFsdWU9cHkuUFlfc3RyKHMpLl92YWx1ZTt9LF9faGFzaF9fOmZ1bmN0aW9uKCl7cmV0dXJuJ1wxXDBcMScrdGhpcy5fdmFsdWU7fSxfX3N0cl9fOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXM7fSxfX2VxX186ZnVuY3Rpb24ob3RoZXIpe2lmKHB5LlBZX2lzSW5zdGFuY2Uob3RoZXIscHkuc3RyKSYmdGhpcy5fdmFsdWU9PT1vdGhlci5fdmFsdWUpe3JldHVybiBweS5UcnVlO30KcmV0dXJuIHB5LkZhbHNlO30sX19sdF9fOmZ1bmN0aW9uKG90aGVyKXtpZihweS5QWV9ub3QocHkuUFlfY2FsbChweS5pc2luc3RhbmNlLFtvdGhlcixweS5zdHJdKSkpe3JldHVybiBweS5Ob3RJbXBsZW1lbnRlZDt9CnJldHVybiB0aGlzLl92YWx1ZTxvdGhlci5fdmFsdWU/cHkuVHJ1ZTpweS5GYWxzZTt9LF9fbGVfXzpmdW5jdGlvbihvdGhlcil7aWYoIXB5LlBZX2lzSW5zdGFuY2Uob3RoZXIscHkuc3RyKSl7cmV0dXJuIHB5Lk5vdEltcGxlbWVudGVkO30KcmV0dXJuIHRoaXMuX3ZhbHVlPD1vdGhlci5fdmFsdWU/cHkuVHJ1ZTpweS5GYWxzZTt9LF9fZ3RfXzpmdW5jdGlvbihvdGhlcil7aWYoIXB5LlBZX2lzSW5zdGFuY2Uob3RoZXIscHkuc3RyKSl7cmV0dXJuIHB5Lk5vdEltcGxlbWVudGVkO30KcmV0dXJuIHRoaXMuX3ZhbHVlPm90aGVyLl92YWx1ZT9weS5UcnVlOnB5LkZhbHNlO30sX19nZV9fOmZ1bmN0aW9uKG90aGVyKXtpZighcHkuUFlfaXNJbnN0YW5jZShvdGhlcixweS5zdHIpKXtyZXR1cm4gcHkuTm90SW1wbGVtZW50ZWQ7fQpyZXR1cm4gdGhpcy5fdmFsdWU+PW90aGVyLl92YWx1ZT9weS5UcnVlOnB5LkZhbHNlO30sX19hZGRfXzpmdW5jdGlvbihvdGhlcil7aWYoIXB5LlBZX2lzSW5zdGFuY2Uob3RoZXIscHkuc3RyKSl7cmV0dXJuIHB5Lk5vdEltcGxlbWVudGVkO30KcmV0dXJuIHB5LnN0ci5mcm9tSlNPTih0aGlzLl92YWx1ZStvdGhlci5fdmFsdWUpO30sX19ub256ZXJvX186ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fdmFsdWUubGVuZ3RoP3B5LlRydWU6cHkuRmFsc2U7fSxfX2NvbnRhaW5zX186ZnVuY3Rpb24ocyl7cmV0dXJuKHRoaXMuX3ZhbHVlLmluZGV4T2Yocy5fdmFsdWUpIT09LTEpP3B5LlRydWU6cHkuRmFsc2U7fSxmcm9tSlNPTjpmdW5jdGlvbihzKXtpZih0eXBlb2Ygcz09PSdzdHJpbmcnKXt2YXIgaW5zdGFuY2U9cHkuUFlfY2FsbChweS5zdHIpO2luc3RhbmNlLl92YWx1ZT1zO3JldHVybiBpbnN0YW5jZTt9CnRocm93IG5ldyBFcnJvcigic3RyLmZyb21KU09OIGNhbiBvbmx5IHRha2Ugc3RyaW5ncyIpO30sdG9KU09OOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3ZhbHVlO319KTtweS50dXBsZT1weS50eXBlKCd0dXBsZScsbnVsbCx7X19pbml0X186ZnVuY3Rpb24oKXt0aGlzLl92YWx1ZXM9W107fSxfX2xlbl9fOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3ZhbHVlcy5sZW5ndGg7fSxfX25vbnplcm9fXzpmdW5jdGlvbigpe3JldHVybiBweS5QWV9zaXplKHRoaXMpPjA/cHkuVHJ1ZTpweS5GYWxzZTt9LF9fY29udGFpbnNfXzpmdW5jdGlvbih2YWx1ZSl7Zm9yKHZhciBpPTAsbGVuPXRoaXMuX3ZhbHVlcy5sZW5ndGg7aTxsZW47KytpKXtpZihweS5QWV9pc1RydWUodGhpcy5fdmFsdWVzW2ldLl9fZXFfXyh2YWx1ZSkpKXtyZXR1cm4gcHkuVHJ1ZTt9fQpyZXR1cm4gcHkuRmFsc2U7fSxfX2dldGl0ZW1fXzpmdW5jdGlvbihpbmRleCl7cmV0dXJuIHRoaXMuX3ZhbHVlc1tpbmRleC50b0pTT04oKV07fSx0b0pTT046ZnVuY3Rpb24oKXt2YXIgb3V0PVtdO2Zvcih2YXIgaT0wO2k8dGhpcy5fdmFsdWVzLmxlbmd0aDsrK2kpe291dC5wdXNoKHRoaXMuX3ZhbHVlc1tpXS50b0pTT04oKSk7fQpyZXR1cm4gb3V0O30sZnJvbUpTT046ZnVuY3Rpb24oYXIpe2lmKCEoYXIgaW5zdGFuY2VvZiBBcnJheSkpe3Rocm93IG5ldyBFcnJvcigiQ2FuIG9ubHkgY3JlYXRlIGEgcHkudHVwbGUgZnJvbSBhbiBBcnJheSIpO30KdmFyIHQ9cHkuUFlfY2FsbChweS50dXBsZSk7Zm9yKHZhciBpPTA7aTxhci5sZW5ndGg7KytpKXt0Ll92YWx1ZXMucHVzaChQWV9lbnN1cmVweShhcltpXSkpO30KcmV0dXJuIHQ7fX0pO3B5Lmxpc3Q9cHkudHlwZSgnbGlzdCcsbnVsbCx7X19ub256ZXJvX186ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fX2xlbl9fPjA/cHkuVHJ1ZTpweS5GYWxzZTt9LH0pO18uZGVmYXVsdHMocHkubGlzdCxweS50dXBsZSkKcHkuZGljdD1weS50eXBlKCdkaWN0JyxudWxsLHtfX2luaXRfXzpmdW5jdGlvbigpe3RoaXMuX3N0b3JlPXt9O30sX19nZXRpdGVtX186ZnVuY3Rpb24oa2V5KXt2YXIgaD1rZXkuX19oYXNoX18oKTtpZighKGggaW4gdGhpcy5fc3RvcmUpKXt0aHJvdyBuZXcgRXJyb3IoIktleUVycm9yOiAnIitrZXkudG9KU09OKCkrIiciKTt9CnJldHVybiB0aGlzLl9zdG9yZVtoXVsxXTt9LF9fc2V0aXRlbV9fOmZ1bmN0aW9uKGtleSx2YWx1ZSl7dGhpcy5fc3RvcmVba2V5Ll9faGFzaF9fKCldPVtrZXksdmFsdWVdO30sX19sZW5fXzpmdW5jdGlvbigpe3JldHVybiBPYmplY3Qua2V5cyh0aGlzLl9zdG9yZSkubGVuZ3RofSxfX25vbnplcm9fXzpmdW5jdGlvbigpe3JldHVybiBweS5QWV9zaXplKHRoaXMpPjA/cHkuVHJ1ZTpweS5GYWxzZTt9LGdldDpmdW5jdGlvbigpe3ZhciBhcmdzPXB5LlBZX3BhcnNlQXJncyhhcmd1bWVudHMsWydrJyxbJ2QnLHB5Lk5vbmVdXSk7dmFyIGg9YXJncy5rLl9faGFzaF9fKCk7aWYoIShoIGluIHRoaXMuX3N0b3JlKSl7cmV0dXJuIGFyZ3MuZDt9CnJldHVybiB0aGlzLl9zdG9yZVtoXVsxXTt9LGZyb21KU09OOmZ1bmN0aW9uKGQpe3ZhciBpbnN0YW5jZT1weS5QWV9jYWxsKHB5LmRpY3QpO2Zvcih2YXIgayBpbihkfHx7fSkpe2lmKCFkLmhhc093blByb3BlcnR5KGspKXtjb250aW51ZTt9Cmluc3RhbmNlLl9fc2V0aXRlbV9fKHB5LnN0ci5mcm9tSlNPTihrKSxQWV9lbnN1cmVweShkW2tdKSk7fQpyZXR1cm4gaW5zdGFuY2U7fSx0b0pTT046ZnVuY3Rpb24oKXt2YXIgb3V0PXt9O2Zvcih2YXIgayBpbiB0aGlzLl9zdG9yZSl7dmFyIGl0ZW09dGhpcy5fc3RvcmVba107b3V0W2l0ZW1bMF0udG9KU09OKCldPWl0ZW1bMV0udG9KU09OKCk7fQpyZXR1cm4gb3V0O319KTtweS5QWV9kZWY9cHkudHlwZSgnZnVuY3Rpb24nLG51bGwse19fY2FsbF9fOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2Z1bmMuYXBwbHkodGhpcy5faW5zdCxhcmd1bWVudHMpO30sZnJvbUpTT046ZnVuY3Rpb24obmF0aXZlZnVuYyl7dmFyIGluc3RhbmNlPXB5LlBZX2NhbGwocHkuUFlfZGVmKTtpbnN0YW5jZS5faW5zdD1udWxsO2luc3RhbmNlLl9mdW5jPW5hdGl2ZWZ1bmM7cmV0dXJuIGluc3RhbmNlO30sdG9KU09OOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2Z1bmM7fX0pO3B5LmNsYXNzbWV0aG9kPXB5LnR5cGUoJ2NsYXNzbWV0aG9kJyxudWxsLHtfX2luaXRfXzpmdW5jdGlvbigpe3ZhciBhcmdzPXB5LlBZX3BhcnNlQXJncyhhcmd1bWVudHMsJ2Z1bmN0aW9uJyk7dGhpcy5fZnVuYz1hcmdzWydmdW5jdGlvbiddO30sX19nZXRfXzpmdW5jdGlvbihvYmosdHlwZSl7cmV0dXJuIFBZX2luc3RhbmNlbWV0aG9kLmZyb21KU09OKHRoaXMuX2Z1bmMsdHlwZSk7fSxmcm9tSlNPTjpmdW5jdGlvbihmdW5jKXtyZXR1cm4gcHkuUFlfY2FsbChweS5jbGFzc21ldGhvZCxbZnVuY10pO319KTt2YXIgUFlfaW5zdGFuY2VtZXRob2Q9cHkudHlwZSgnaW5zdGFuY2VtZXRob2QnLFtweS5QWV9kZWZdLHtmcm9tSlNPTjpmdW5jdGlvbihuYXRpdmVmdW5jLGluc3RhbmNlKXt2YXIgaW5zdD1weS5QWV9jYWxsKFBZX2luc3RhbmNlbWV0aG9kKTtpbnN0Ll9pbnN0PWluc3RhbmNlO2luc3QuX2Z1bmM9bmF0aXZlZnVuYztyZXR1cm4gaW5zdDt9fSk7cHkuYWJzPW5ldyBweS5QWV9kZWYuZnJvbUpTT04oZnVuY3Rpb24gYWJzKCl7dmFyIGFyZ3M9cHkuUFlfcGFyc2VBcmdzKGFyZ3VtZW50cyxbJ251bWJlciddKTtpZighYXJncy5udW1iZXIuX19hYnNfXyl7dGhyb3cgbmV3IEVycm9yKCJUeXBlRXJyb3I6IGJhZCBvcGVyYW5kIHR5cGUgZm9yIGFicygpOiAnIgordHlwZW5hbWUoYXJncy5udW1iZXIpCisiJyIpO30KcmV0dXJuIGFyZ3MubnVtYmVyLl9fYWJzX18oKTt9KTtweS5sZW49bmV3IHB5LlBZX2RlZi5mcm9tSlNPTihmdW5jdGlvbiBsZW4oKXt2YXIgYXJncz1weS5QWV9wYXJzZUFyZ3MoYXJndW1lbnRzLFsnb2JqZWN0J10pO3JldHVybiBweS5mbG9hdC5mcm9tSlNPTihweS5QWV9zaXplKGFyZ3Mub2JqZWN0KSk7fSk7cHkuaXNpbnN0YW5jZT1uZXcgcHkuUFlfZGVmLmZyb21KU09OKGZ1bmN0aW9uIGlzaW5zdGFuY2UoKXt2YXIgYXJncz1weS5QWV9wYXJzZUFyZ3MoYXJndW1lbnRzLFsnb2JqZWN0JywnY2xhc3MnXSk7cmV0dXJuIHB5LlBZX2lzSW5zdGFuY2UoYXJncy5vYmplY3QsYXJnc1snY2xhc3MnXSk/cHkuVHJ1ZTpweS5GYWxzZTt9KTtweS5pc3N1YmNsYXNzPW5ldyBweS5QWV9kZWYuZnJvbUpTT04oZnVuY3Rpb24gaXNzdWJjbGFzcygpe3ZhciBhcmdzPXB5LlBZX3BhcnNlQXJncyhhcmd1bWVudHMsWydDJywnQiddKTtyZXR1cm4gcHkuUFlfaXNTdWJjbGFzcyhhcmdzLkMsYXJncy5CKT9weS5UcnVlOnB5LkZhbHNlO30pO3ZhciBQWV9kZWNvZGVfc3RyaW5nX2xpdGVyYWw9ZnVuY3Rpb24oc3RyLHVuaWNvZGUpe3ZhciBvdXQ9W10sY29kZTt2YXIgZGlyZWN0X21hcD17J1xcJzonXFwnLCciJzonIicsIiciOiInIiwnYSc6J1x4MDcnLCdiJzonXHgwOCcsJ2YnOidceDBjJywnbic6J1xuJywncic6J1xyJywndCc6J1x0Jywndic6J1x2J307Zm9yKHZhciBpPTA7aTxzdHIubGVuZ3RoOysraSl7aWYoc3RyW2ldIT09J1xcJyl7b3V0LnB1c2goc3RyW2ldKTtjb250aW51ZTt9CnZhciBlc2NhcGU9c3RyW2krMV07aWYoZXNjYXBlIGluIGRpcmVjdF9tYXApe291dC5wdXNoKGRpcmVjdF9tYXBbZXNjYXBlXSk7KytpO2NvbnRpbnVlO30Kc3dpdGNoKGVzY2FwZSl7Y2FzZSdcbic6KytpO2NvbnRpbnVlO2Nhc2UnTic6aWYoIXVuaWNvZGUpe2JyZWFrO30KdGhyb3cgRXJyb3IoIlN5bnRheEVycm9yOiBcXE57fSBlc2NhcGUgbm90IGltcGxlbWVudGVkIik7Y2FzZSd1JzppZighdW5pY29kZSl7YnJlYWs7fQp2YXIgdW5pPXN0ci5zbGljZShpKzIsaSs2KTtpZighL1swLTlhLWZdezR9L2kudGVzdCh1bmkpKXt0aHJvdyBuZXcgRXJyb3IoWyJTeW50YXhFcnJvcjogKHVuaWNvZGUgZXJyb3IpICd1bmljb2RlZXNjYXBlJyBjb2RlYyIsIiBjYW4ndCBkZWNvZGUgYnl0ZXMgaW4gcG9zaXRpb24gIixpLCItIixpKzQsIjogdHJ1bmNhdGVkIFxcdVhYWFggZXNjYXBlIl0uam9pbignJykpO30KY29kZT1wYXJzZUludCh1bmksMTYpO291dC5wdXNoKFN0cmluZy5mcm9tQ2hhckNvZGUoY29kZSkpO2krPTU7Y29udGludWU7Y2FzZSdVJzppZighdW5pY29kZSl7YnJlYWs7fQp0aHJvdyBFcnJvcigiU3ludGF4RXJyb3I6IFxcVSBlc2NhcGUgbm90IGltcGxlbWVudGVkIik7Y2FzZSd4Jzp2YXIgaGV4PXN0ci5zbGljZShpKzIsaSs0KTtpZighL1swLTlhLWZdezJ9L2kudGVzdChoZXgpKXtpZighdW5pY29kZSl7dGhyb3cgbmV3IEVycm9yKCdWYWx1ZUVycm9yOiBpbnZhbGlkIFxceCBlc2NhcGUnKTt9CnRocm93IG5ldyBFcnJvcihbIlN5bnRheEVycm9yOiAodW5pY29kZSBlcnJvcikgJ3VuaWNvZGVlc2NhcGUnIiwiIGNvZGVjIGNhbid0IGRlY29kZSBieXRlcyBpbiBwb3NpdGlvbiAiLGksJy0nLGkrMiwiOiB0cnVuY2F0ZWQgXFx4WFggZXNjYXBlIl0uam9pbignJykpfQpjb2RlPXBhcnNlSW50KGhleCwxNik7b3V0LnB1c2goU3RyaW5nLmZyb21DaGFyQ29kZShjb2RlKSk7aSs9Mztjb250aW51ZTtkZWZhdWx0OmlmKCEvWzAtOF0vLnRlc3QoZXNjYXBlKSl7YnJlYWs7fQp2YXIgcj0vWzAtOF17MSwzfS9nO3IubGFzdEluZGV4PWkrMTt2YXIgbT1yLmV4ZWMoc3RyKTt2YXIgb2N0PW1bMF07Y29kZT1wYXJzZUludChvY3QsOCk7b3V0LnB1c2goU3RyaW5nLmZyb21DaGFyQ29kZShjb2RlKSk7aSs9b2N0Lmxlbmd0aDtjb250aW51ZTt9Cm91dC5wdXNoKCdcXCcpO30KcmV0dXJuIG91dC5qb2luKCcnKTt9O3ZhciBQWV9vcGVyYXRvcnM9eyc9PSc6WydlcScsJ2VxJyxmdW5jdGlvbihhLGIpe3JldHVybiBhPT09Yjt9XSwnIT0nOlsnbmUnLCduZScsZnVuY3Rpb24oYSxiKXtyZXR1cm4gYSE9PWI7fV0sJzw+JzpbJ25lJywnbmUnLGZ1bmN0aW9uKGEsYil7cmV0dXJuIGEhPT1iO31dLCc8JzpbJ2x0JywnZ3QnLGZ1bmN0aW9uKGEsYil7cmV0dXJuIGEuX19jbGFzc19fLl9fbmFtZV9fPGIuX19jbGFzc19fLl9fbmFtZV9fO31dLCc8PSc6WydsZScsJ2dlJyxmdW5jdGlvbihhLGIpe3JldHVybiBhLl9fY2xhc3NfXy5fX25hbWVfXzw9Yi5fX2NsYXNzX18uX19uYW1lX187fV0sJz4nOlsnZ3QnLCdsdCcsZnVuY3Rpb24oYSxiKXtyZXR1cm4gYS5fX2NsYXNzX18uX19uYW1lX18+Yi5fX2NsYXNzX18uX19uYW1lX187fV0sJz49JzpbJ2dlJywnbGUnLGZ1bmN0aW9uKGEsYil7cmV0dXJuIGEuX19jbGFzc19fLl9fbmFtZV9fPj1iLl9fY2xhc3NfXy5fX25hbWVfXzt9XSwnKyc6WydhZGQnLCdyYWRkJ10sJy0nOlsnc3ViJywncnN1YiddLCcqJzpbJ211bCcsJ3JtdWwnXSwnLyc6WydkaXYnLCdyZGl2J10sJy8vJzpbJ2Zsb29yZGl2JywncmZsb29yZGl2J10sJyUnOlsnbW9kJywncm1vZCddLCcqKic6Wydwb3cnLCdycG93J10sJzw8JzpbJ2xzaGlmdCcsJ3Jsc2hpZnQnXSwnPj4nOlsncnNoaWZ0JywncnJzaGlmdCddLCcmJzpbJ2FuZCcsJ3JhbmQnXSwnXic6Wyd4b3InLCdyeG9yJ10sJ3wnOlsnb3InLCdyb3InXX07dmFyIFBZX29wPWZ1bmN0aW9uKG8xLG8yLG9wKXt2YXIgcjt2YXIgbWV0aG9kcz1QWV9vcGVyYXRvcnNbb3BdO3ZhciBmb3J3YXJkPSdfXycrbWV0aG9kc1swXSsnX18nLHJldmVyc2U9J19fJyttZXRob2RzWzFdKydfXyc7dmFyIG90aGVyd2lzZT1tZXRob2RzWzJdO2lmKGZvcndhcmQgaW4gbzEmJihyPW8xW2ZvcndhcmRdKG8yKSkhPT1weS5Ob3RJbXBsZW1lbnRlZCl7cmV0dXJuIHI7fQppZihyZXZlcnNlIGluIG8yJiYocj1vMltyZXZlcnNlXShvMSkpIT09cHkuTm90SW1wbGVtZW50ZWQpe3JldHVybiByO30KaWYob3RoZXJ3aXNlKXtyZXR1cm4gUFlfZW5zdXJlcHkob3RoZXJ3aXNlKG8xLG8yKSk7fQp0aHJvdyBuZXcgRXJyb3IoIlR5cGVFcnJvcjogdW5zdXBwb3J0ZWQgb3BlcmFuZCB0eXBlKHMpIGZvciAiK29wKyI6ICciCit0eXBlbmFtZShvMSkrIicgYW5kICciK3R5cGVuYW1lKG8yKSsiJyIpO307dmFyIFBZX2J1aWx0aW5zPXt0eXBlOnB5LnR5cGUsTm9uZTpweS5Ob25lLFRydWU6cHkuVHJ1ZSxGYWxzZTpweS5GYWxzZSxOb3RJbXBsZW1lbnRlZDpweS5Ob3RJbXBsZW1lbnRlZCxvYmplY3Q6cHkub2JqZWN0LGJvb2w6cHkuYm9vbCxmbG9hdDpweS5mbG9hdCxzdHI6cHkuc3RyLHVuaWNvZGU6cHkudW5pY29kZSx0dXBsZTpweS50dXBsZSxsaXN0OnB5Lmxpc3QsZGljdDpweS5kaWN0LGFiczpweS5hYnMsbGVuOnB5Lmxlbixpc2luc3RhbmNlOnB5LmlzaW5zdGFuY2UsaXNzdWJjbGFzczpweS5pc3N1YmNsYXNzLGNsYXNzbWV0aG9kOnB5LmNsYXNzbWV0aG9kLH07cHkucGFyc2U9ZnVuY3Rpb24odG9rcyl7dmFyIGluZGV4PTA7dG9rZW49dG9rc1swXTtuZXh0PWZ1bmN0aW9uKCl7cmV0dXJuIHRva3NbKytpbmRleF07fTtyZXR1cm4gZXhwcmVzc2lvbigpO307dmFyIGV2YWx1YXRlX29wZXJhdG9yPWZ1bmN0aW9uKG9wZXJhdG9yLGEsYil7c3dpdGNoKG9wZXJhdG9yKXtjYXNlJ2lzJzpyZXR1cm4gYT09PWI/cHkuVHJ1ZTpweS5GYWxzZTtjYXNlJ2lzIG5vdCc6cmV0dXJuIGEhPT1iP3B5LlRydWU6cHkuRmFsc2U7Y2FzZSdpbic6cmV0dXJuIGIuX19jb250YWluc19fKGEpO2Nhc2Unbm90IGluJzpyZXR1cm4gcHkuUFlfaXNUcnVlKGIuX19jb250YWluc19fKGEpKT9weS5GYWxzZTpweS5UcnVlO2Nhc2UnPT0nOmNhc2UnIT0nOmNhc2UnPD4nOmNhc2UnPCc6Y2FzZSc8PSc6Y2FzZSc+JzpjYXNlJz49JzpyZXR1cm4gUFlfb3AoYSxiLG9wZXJhdG9yKTt9CnRocm93IG5ldyBFcnJvcignU3ludGF4RXJyb3I6IHVua25vd24gY29tcGFyYXRvciBbWycrb3BlcmF0b3IrJ11dJyk7fTtweS5ldmFsdWF0ZT1mdW5jdGlvbihleHByLGNvbnRleHQpe2NvbnRleHQ9Y29udGV4dHx8e307c3dpdGNoKGV4cHIuaWQpe2Nhc2UnKG5hbWUpJzp2YXIgdmFsPWNvbnRleHRbZXhwci52YWx1ZV07aWYodmFsPT09dW5kZWZpbmVkJiZleHByLnZhbHVlIGluIFBZX2J1aWx0aW5zKXtyZXR1cm4gUFlfYnVpbHRpbnNbZXhwci52YWx1ZV07fQpyZXR1cm4gUFlfZW5zdXJlcHkodmFsLGV4cHIudmFsdWUpO2Nhc2UnKHN0cmluZyknOnJldHVybiBweS5zdHIuZnJvbUpTT04oUFlfZGVjb2RlX3N0cmluZ19saXRlcmFsKGV4cHIudmFsdWUsZXhwci51bmljb2RlKSk7Y2FzZScobnVtYmVyKSc6cmV0dXJuIHB5LmZsb2F0LmZyb21KU09OKGV4cHIudmFsdWUpO2Nhc2UnKGNvbnN0YW50KSc6c3dpdGNoKGV4cHIudmFsdWUpe2Nhc2UnTm9uZSc6cmV0dXJuIHB5Lk5vbmU7Y2FzZSdGYWxzZSc6cmV0dXJuIHB5LkZhbHNlO2Nhc2UnVHJ1ZSc6cmV0dXJuIHB5LlRydWU7fQp0aHJvdyBuZXcgRXJyb3IoIlN5bnRheEVycm9yOiB1bmtub3duIGNvbnN0YW50ICciK2V4cHIudmFsdWUrIiciKTtjYXNlJyhjb21wYXJhdG9yKSc6dmFyIHJlc3VsdCxsZWZ0PXB5LmV2YWx1YXRlKGV4cHIuZXhwcmVzc2lvbnNbMF0sY29udGV4dCk7Zm9yKHZhciBpPTA7aTxleHByLm9wZXJhdG9ycy5sZW5ndGg7KytpKXtyZXN1bHQ9ZXZhbHVhdGVfb3BlcmF0b3IoZXhwci5vcGVyYXRvcnNbaV0sbGVmdCxsZWZ0PXB5LmV2YWx1YXRlKGV4cHIuZXhwcmVzc2lvbnNbaSsxXSxjb250ZXh0KSk7aWYocHkuUFlfbm90KHJlc3VsdCkpe3JldHVybiBweS5GYWxzZTt9fQpyZXR1cm4gcHkuVHJ1ZTtjYXNlJ25vdCc6cmV0dXJuIHB5LlBZX2lzVHJ1ZShweS5ldmFsdWF0ZShleHByLmZpcnN0LGNvbnRleHQpKT9weS5GYWxzZTpweS5UcnVlO2Nhc2UnYW5kJzp2YXIgYW5kX2ZpcnN0PXB5LmV2YWx1YXRlKGV4cHIuZmlyc3QsY29udGV4dCk7aWYocHkuUFlfaXNUcnVlKGFuZF9maXJzdC5fX25vbnplcm9fXygpKSl7cmV0dXJuIHB5LmV2YWx1YXRlKGV4cHIuc2Vjb25kLGNvbnRleHQpO30KcmV0dXJuIGFuZF9maXJzdDtjYXNlJ29yJzp2YXIgb3JfZmlyc3Q9cHkuZXZhbHVhdGUoZXhwci5maXJzdCxjb250ZXh0KTtpZihweS5QWV9pc1RydWUob3JfZmlyc3QuX19ub256ZXJvX18oKSkpe3JldHVybiBvcl9maXJzdH0KcmV0dXJuIHB5LmV2YWx1YXRlKGV4cHIuc2Vjb25kLGNvbnRleHQpO2Nhc2UnKCc6aWYoZXhwci5zZWNvbmQpe3ZhciBjYWxsYWJsZT1weS5ldmFsdWF0ZShleHByLmZpcnN0LGNvbnRleHQpO3ZhciBhcmdzPVtdLGt3YXJncz17fTtmb3IodmFyIGpqPTA7amo8ZXhwci5zZWNvbmQubGVuZ3RoOysramope3ZhciBhcmc9ZXhwci5zZWNvbmRbampdO2lmKGFyZy5pZCE9PSc9Jyl7YXJncy5wdXNoKHB5LmV2YWx1YXRlKGFyZyxjb250ZXh0KSk7fWVsc2V7a3dhcmdzW2FyZy5maXJzdC52YWx1ZV09cHkuZXZhbHVhdGUoYXJnLnNlY29uZCxjb250ZXh0KTt9fQpyZXR1cm4gcHkuUFlfY2FsbChjYWxsYWJsZSxhcmdzLGt3YXJncyk7fQp2YXIgdHVwbGVfZXhwcnM9ZXhwci5maXJzdCx0dXBsZV92YWx1ZXM9W107Zm9yKHZhciBqPTAsbGVuPXR1cGxlX2V4cHJzLmxlbmd0aDtqPGxlbjsrK2ope3R1cGxlX3ZhbHVlcy5wdXNoKHB5LmV2YWx1YXRlKHR1cGxlX2V4cHJzW2pdLGNvbnRleHQpKTt9CnJldHVybiBweS50dXBsZS5mcm9tSlNPTih0dXBsZV92YWx1ZXMpO2Nhc2UnWyc6aWYoZXhwci5zZWNvbmQpe3JldHVybiBweS5QWV9nZXRJdGVtKHB5LmV2YWx1YXRlKGV4cHIuZmlyc3QsY29udGV4dCkscHkuZXZhbHVhdGUoZXhwci5zZWNvbmQsY29udGV4dCkpO30KdmFyIGxpc3RfZXhwcnM9ZXhwci5maXJzdCxsaXN0X3ZhbHVlcz1bXTtmb3IodmFyIGs9MDtrPGxpc3RfZXhwcnMubGVuZ3RoOysrayl7bGlzdF92YWx1ZXMucHVzaChweS5ldmFsdWF0ZShsaXN0X2V4cHJzW2tdLGNvbnRleHQpKTt9CnJldHVybiBweS5saXN0LmZyb21KU09OKGxpc3RfdmFsdWVzKTtjYXNlJ3snOnZhciBkaWN0X2V4cHJzPWV4cHIuZmlyc3QsZGljdD1weS5QWV9jYWxsKHB5LmRpY3QpO2Zvcih2YXIgbD0wO2w8ZGljdF9leHBycy5sZW5ndGg7KytsKXtweS5QWV9zZXRJdGVtKGRpY3QscHkuZXZhbHVhdGUoZGljdF9leHByc1tsXVswXSxjb250ZXh0KSxweS5ldmFsdWF0ZShkaWN0X2V4cHJzW2xdWzFdLGNvbnRleHQpKTt9CnJldHVybiBkaWN0O2Nhc2UnLic6aWYoZXhwci5zZWNvbmQuaWQhPT0nKG5hbWUpJyl7dGhyb3cgbmV3IEVycm9yKCdTeW50YXhFcnJvcjogJytleHByKTt9CnJldHVybiBweS5QWV9nZXRBdHRyKHB5LmV2YWx1YXRlKGV4cHIuZmlyc3QsY29udGV4dCksZXhwci5zZWNvbmQudmFsdWUpO2Nhc2Unfic6cmV0dXJuKHB5LmV2YWx1YXRlKGV4cHIuZmlyc3QsY29udGV4dCkpLl9faW52ZXJ0X18oKTtjYXNlJysnOmlmKCFleHByLnNlY29uZCl7cmV0dXJuIHB5LlBZX3Bvc2l0aXZlKHB5LmV2YWx1YXRlKGV4cHIuZmlyc3QsY29udGV4dCkpO30KY2FzZSctJzppZighZXhwci5zZWNvbmQpe3JldHVybiBweS5QWV9uZWdhdGl2ZShweS5ldmFsdWF0ZShleHByLmZpcnN0LGNvbnRleHQpKTt9CmNhc2UnKic6Y2FzZScvJzpjYXNlJy8vJzpjYXNlJyUnOmNhc2UnKionOmNhc2UnPDwnOmNhc2UnPj4nOmNhc2UnJic6Y2FzZSdeJzpjYXNlJ3wnOnJldHVybiBQWV9vcChweS5ldmFsdWF0ZShleHByLmZpcnN0LGNvbnRleHQpLHB5LmV2YWx1YXRlKGV4cHIuc2Vjb25kLGNvbnRleHQpLGV4cHIuaWQpO2RlZmF1bHQ6dGhyb3cgbmV3IEVycm9yKCdTeW50YXhFcnJvcjogVW5rbm93biBub2RlIFtbJytleHByLmlkKyddXScpO319O3B5LmV2YWw9ZnVuY3Rpb24oc3RyLGNvbnRleHQpe3JldHVybiBweS5ldmFsdWF0ZShweS5wYXJzZShweS50b2tlbml6ZShzdHIpKSxjb250ZXh0KS50b0pTT04oKTt9fSkodHlwZW9mIGV4cG9ydHM9PT0ndW5kZWZpbmVkJz9weTpleHBvcnRzKTs7CgovKiAvd2ViL3N0YXRpYy9saWIvcHkuanMvbGliL3B5X2V4dHJhcy5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwooZnVuY3Rpb24ocHkpeyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiBkaXZtb2QoYSxiLGZuKXt2YXIgbW9kPWElYjtpZihtb2Q+MCYmYjwwfHxtb2Q8MCYmYj4wKXttb2QrPWI7fQpyZXR1cm4gZm4oTWF0aC5mbG9vcihhL2IpLG1vZCk7fQpmdW5jdGlvbiBtb2RmKHgsZm4pe3ZhciBtb2Q9eCUxO2lmKG1vZDwwKXttb2QrPTE7fQpyZXR1cm4gZm4obW9kLE1hdGguZmxvb3IoeCkpO30KZnVuY3Rpb24gYXNzZXJ0KGJvb2wpe2lmKCFib29sKXt0aHJvdyBuZXcgRXJyb3IoIkFzc2VydGlvbkVycm9yIik7fX0KdmFyIG9iaj1mdW5jdGlvbigpe307b2JqLnByb3RvdHlwZT1weS5vYmplY3Q7dmFyIGFzSlM9ZnVuY3Rpb24oYXJnKXtpZihhcmcgaW5zdGFuY2VvZiBvYmope3JldHVybiBhcmcudG9KU09OKCk7fQpyZXR1cm4gYXJnO307dmFyIGRhdGV0aW1lPXB5LlBZX2NhbGwocHkub2JqZWN0KTt2YXIgemVybz1weS5mbG9hdC5mcm9tSlNPTigwKTt2YXIgREFZU19JTl9NT05USD1bbnVsbCwzMSwyOCwzMSwzMCwzMSwzMCwzMSwzMSwzMCwzMSwzMCwzMV07dmFyIERBWVNfQkVGT1JFX01PTlRIPVtudWxsXTt2YXIgZGJtPTA7Zm9yKHZhciBpPTE7aTxEQVlTX0lOX01PTlRILmxlbmd0aDsrK2kpe0RBWVNfQkVGT1JFX01PTlRILnB1c2goZGJtKTtkYm0rPURBWVNfSU5fTU9OVEhbaV07fQpmdW5jdGlvbiBpc19sZWFwKHllYXIpe3JldHVybiB5ZWFyJTQ9PT0wJiYoeWVhciUxMDAhPT0wfHx5ZWFyJTQwMD09PTApO30KZnVuY3Rpb24gZGF5c19iZWZvcmVfeWVhcih5ZWFyKXt2YXIgeT15ZWFyLTE7cmV0dXJuIHkqMzY1K01hdGguZmxvb3IoeS80KS1NYXRoLmZsb29yKHkvMTAwKStNYXRoLmZsb29yKHkvNDAwKTt9CmZ1bmN0aW9uIGRheXNfaW5fbW9udGgoeWVhcixtb250aCl7aWYobW9udGg9PT0yJiZpc19sZWFwKHllYXIpKXtyZXR1cm4gMjk7fQpyZXR1cm4gREFZU19JTl9NT05USFttb250aF07fQpmdW5jdGlvbiBkYXlzX2JlZm9yZV9tb250aCh5ZWFyLG1vbnRoKXt2YXIgcG9zdF9sZWFwX2ZlYj1tb250aD4yJiZpc19sZWFwKHllYXIpO3JldHVybiBEQVlTX0JFRk9SRV9NT05USFttb250aF0rKHBvc3RfbGVhcF9mZWI/MTowKTt9CmZ1bmN0aW9uIHltZDJvcmQoeWVhcixtb250aCxkYXkpe3ZhciBkaW09ZGF5c19pbl9tb250aCh5ZWFyLG1vbnRoKTtpZighKDE8PWRheSYmZGF5PD1kaW0pKXt0aHJvdyBuZXcgRXJyb3IoIlZhbHVlRXJyb3I6IGRheSBtdXN0IGJlIGluIDEuLiIrZGltKTt9CnJldHVybiBkYXlzX2JlZm9yZV95ZWFyKHllYXIpKwpkYXlzX2JlZm9yZV9tb250aCh5ZWFyLG1vbnRoKSsKZGF5O30KZnVuY3Rpb24gZ2V0X3F1YXJ0ZXJfbnVtYmVyKG1vbnRoKXtyZXR1cm4gTWF0aC5jZWlsKG1vbnRoLzMpO30KZnVuY3Rpb24gZ2V0X3F1YXJ0ZXIoeWVhcixtb250aCl7dmFyIHF1YXJ0ZXJfbnVtYmVyPWdldF9xdWFydGVyX251bWJlcihtb250aCk7dmFyIG1vbnRoX2Zyb209KChxdWFydGVyX251bWJlci0xKSozKSsxCnZhciBkYXRlX2Zyb209e3llYXI6eWVhcixtb250aDptb250aF9mcm9tLGRheToxfQp2YXIgZGF0ZV90bz17eWVhcjp5ZWFyLG1vbnRoOm1vbnRoX2Zyb20rMixkYXk6ZGF5c19pbl9tb250aCh5ZWFyLG1vbnRoKX0KcmV0dXJuW2RhdGVfZnJvbSxkYXRlX3RvXTt9CmZ1bmN0aW9uIGdldF9kYXlfb2Zfd2Vlayh5ZWFyLG1vbnRoLGRheSl7dmFyIGQ9bmV3IERhdGUoeWVhcixtb250aC0xLGRheSk7cmV0dXJuKGQuZ2V0RGF5KCkrNiklNzt9CnZhciBESTQwMFk9ZGF5c19iZWZvcmVfeWVhcig0MDEpO3ZhciBESTEwMFk9ZGF5c19iZWZvcmVfeWVhcigxMDEpO3ZhciBESTRZPWRheXNfYmVmb3JlX3llYXIoNSk7ZnVuY3Rpb24gb3JkMnltZChuKXstLW47dmFyIG40MDAsbjEwMCxuNCxuMSxuMDtkaXZtb2QobixESTQwMFksZnVuY3Rpb24oX240MDAsbil7bjQwMD1fbjQwMDtkaXZtb2QobixESTEwMFksZnVuY3Rpb24oX24xMDAsbil7bjEwMD1fbjEwMDtkaXZtb2QobixESTRZLGZ1bmN0aW9uKF9uNCxuKXtuND1fbjQ7ZGl2bW9kKG4sMzY1LGZ1bmN0aW9uKF9uMSxuKXtuMT1fbjE7bjA9bjt9KTt9KTt9KTt9KTtuPW4wO3ZhciB5ZWFyPW40MDAqNDAwKzErbjEwMCoxMDArbjQqNCtuMTtpZihuMT09NHx8bjEwMD09MTAwKXthc3NlcnQobjA9PT0wKTtyZXR1cm57eWVhcjp5ZWFyLTEsbW9udGg6MTIsZGF5OjMxfTt9CnZhciBsZWFweWVhcj1uMT09PTMmJihuNCE9PTI0fHxuMTAwPT0zKTthc3NlcnQobGVhcHllYXI9PWlzX2xlYXAoeWVhcikpO3ZhciBtb250aD0obis1MCk+PjU7dmFyIHByZWNlZGluZz1EQVlTX0JFRk9SRV9NT05USFttb250aF0rKChtb250aD4yJiZsZWFweWVhcik/MTowKTtpZihwcmVjZWRpbmc+bil7LS1tb250aDtwcmVjZWRpbmctPURBWVNfSU5fTU9OVEhbbW9udGhdKygobW9udGg9PT0yJiZsZWFweWVhcik/MTowKTt9Cm4tPXByZWNlZGluZztyZXR1cm57eWVhcjp5ZWFyLG1vbnRoOm1vbnRoLGRheTpuKzF9O30KZnVuY3Rpb24gdG14eHgoeWVhcixtb250aCxkYXksaG91cixtaW51dGUsc2Vjb25kLG1pY3Jvc2Vjb25kKXtob3VyPWhvdXJ8fDA7bWludXRlPW1pbnV0ZXx8MDtzZWNvbmQ9c2Vjb25kfHwwO21pY3Jvc2Vjb25kPW1pY3Jvc2Vjb25kfHwwO2lmKG1pY3Jvc2Vjb25kPDB8fG1pY3Jvc2Vjb25kPjk5OTk5OSl7ZGl2bW9kKG1pY3Jvc2Vjb25kLDEwMDAwMDAsZnVuY3Rpb24oY2FycnksbXMpe21pY3Jvc2Vjb25kPW1zO3NlY29uZCs9Y2Fycnk7fSk7fQppZihzZWNvbmQ8MHx8c2Vjb25kPjU5KXtkaXZtb2Qoc2Vjb25kLDYwLGZ1bmN0aW9uKGNhcnJ5LHMpe3NlY29uZD1zO21pbnV0ZSs9Y2Fycnk7fSk7fQppZihtaW51dGU8MHx8bWludXRlPjU5KXtkaXZtb2QobWludXRlLDYwLGZ1bmN0aW9uKGNhcnJ5LG0pe21pbnV0ZT1tO2hvdXIrPWNhcnJ5O30pO30KaWYoaG91cjwwfHxob3VyPjIzKXtkaXZtb2QoaG91ciwyNCxmdW5jdGlvbihjYXJyeSxoKXtob3VyPWg7ZGF5Kz1jYXJyeTt9KTt9CmlmKG1vbnRoPDF8fG1vbnRoPjEyKXtkaXZtb2QobW9udGgtMSwxMixmdW5jdGlvbihjYXJyeSxtKXttb250aD1tKzE7eWVhcis9Y2Fycnk7fSk7fQp2YXIgZGltPWRheXNfaW5fbW9udGgoeWVhcixtb250aCk7aWYoZGF5PDF8fGRheT5kaW0pe2lmKGRheT09PTApey0tbW9udGg7aWYobW9udGg+MCl7ZGF5PWRheXNfaW5fbW9udGgoeWVhcixtb250aCk7fWVsc2V7LS15ZWFyO21vbnRoPTEyO2RheT0zMTt9fWVsc2UgaWYoZGF5PT1kaW0rMSl7Kyttb250aDtkYXk9MTtpZihtb250aD4xMil7bW9udGg9MTsrK3llYXI7fX1lbHNle3ZhciByPW9yZDJ5bWQoeW1kMm9yZCh5ZWFyLG1vbnRoLDEpKyhkYXktMSkpO3llYXI9ci55ZWFyO21vbnRoPXIubW9udGg7ZGF5PXIuZGF5O319CnJldHVybnt5ZWFyOnllYXIsbW9udGg6bW9udGgsZGF5OmRheSxob3VyOmhvdXIsbWludXRlOm1pbnV0ZSxzZWNvbmQ6c2Vjb25kLG1pY3Jvc2Vjb25kOm1pY3Jvc2Vjb25kfTt9CmRhdGV0aW1lLnRpbWVkZWx0YT1weS50eXBlKCd0aW1lZGVsdGEnLG51bGwse19faW5pdF9fOmZ1bmN0aW9uKCl7dmFyIGFyZ3M9cHkuUFlfcGFyc2VBcmdzKGFyZ3VtZW50cyxbWydkYXlzJyx6ZXJvXSxbJ3NlY29uZHMnLHplcm9dLFsnbWljcm9zZWNvbmRzJyx6ZXJvXSxbJ21pbGxpc2Vjb25kcycsemVyb10sWydtaW51dGVzJyx6ZXJvXSxbJ2hvdXJzJyx6ZXJvXSxbJ3dlZWtzJyx6ZXJvXV0pO3ZhciBkPTAscz0wLG09MDt2YXIgZGF5cz1hcmdzLmRheXMudG9KU09OKCkrYXJncy53ZWVrcy50b0pTT04oKSo3O3ZhciBzZWNvbmRzPWFyZ3Muc2Vjb25kcy50b0pTT04oKQorYXJncy5taW51dGVzLnRvSlNPTigpKjYwCithcmdzLmhvdXJzLnRvSlNPTigpKjM2MDA7dmFyIG1pY3Jvc2Vjb25kcz1hcmdzLm1pY3Jvc2Vjb25kcy50b0pTT04oKQorYXJncy5taWxsaXNlY29uZHMudG9KU09OKCkqMTAwMDt2YXIgZGF5c2Vjb25kc2ZyYWM9bW9kZihkYXlzLGZ1bmN0aW9uKGRheWZyYWMsZGF5cyl7ZD1kYXlzO2lmKGRheWZyYWMpe3JldHVybiBtb2RmKGRheWZyYWMqMjQqMzYwMCxmdW5jdGlvbihkc2YsZHN3KXtzPWRzdztyZXR1cm4gZHNmO30pO30KcmV0dXJuIDA7fSk7dmFyIHNlY29uZHNmcmFjPW1vZGYoc2Vjb25kcyxmdW5jdGlvbihzZixzKXtzZWNvbmRzPXM7cmV0dXJuIHNmK2RheXNlY29uZHNmcmFjO30pO2Rpdm1vZChzZWNvbmRzLDI0KjM2MDAsZnVuY3Rpb24oZGF5cyxzZWNvbmRzKXtkKz1kYXlzO3MrPXNlY29uZHM7fSk7bWljcm9zZWNvbmRzKz1zZWNvbmRzZnJhYyoxZTY7ZGl2bW9kKG1pY3Jvc2Vjb25kcywxMDAwMDAwLGZ1bmN0aW9uKHNlY29uZHMsbWljcm9zZWNvbmRzKXtkaXZtb2Qoc2Vjb25kcywyNCozNjAwLGZ1bmN0aW9uKGRheXMsc2Vjb25kcyl7ZCs9ZGF5cztzKz1zZWNvbmRzO20rPU1hdGgucm91bmQobWljcm9zZWNvbmRzKTt9KTt9KTt0aGlzLmRheXM9ZDt0aGlzLnNlY29uZHM9czt0aGlzLm1pY3Jvc2Vjb25kcz1tO30sX19zdHJfXzpmdW5jdGlvbigpe3ZhciBoaCxtbSxzcztkaXZtb2QodGhpcy5zZWNvbmRzLDYwLGZ1bmN0aW9uKG0scyl7ZGl2bW9kKG0sNjAsZnVuY3Rpb24oaCxtKXtoaD1oO21tPW07c3M9czt9KTt9KTt2YXIgcz1fLnN0ci5zcHJpbnRmKCIlZDolMDJkOiUwMmQiLGhoLG1tLHNzKTtpZih0aGlzLmRheXMpe3M9Xy5zdHIuc3ByaW50ZigiJWQgZGF5JXMsICVzIix0aGlzLmRheXMsKHRoaXMuZGF5cyE9MSYmdGhpcy5kYXlzIT0tMSk/J3MnOicnLHMpO30KaWYodGhpcy5taWNyb3NlY29uZHMpe3M9Xy5zdHIuc3ByaW50ZigiJXMuJTA2ZCIscyx0aGlzLm1pY3Jvc2Vjb25kcyk7fQpyZXR1cm4gcHkuc3RyLmZyb21KU09OKHMpO30sX19lcV9fOmZ1bmN0aW9uKG90aGVyKXtpZighcHkuUFlfaXNJbnN0YW5jZShvdGhlcixkYXRldGltZS50aW1lZGVsdGEpKXtyZXR1cm4gcHkuRmFsc2U7fQpyZXR1cm4odGhpcy5kYXlzPT09b3RoZXIuZGF5cyYmdGhpcy5zZWNvbmRzPT09b3RoZXIuc2Vjb25kcyYmdGhpcy5taWNyb3NlY29uZHM9PT1vdGhlci5taWNyb3NlY29uZHMpP3B5LlRydWU6cHkuRmFsc2U7fSxfX2FkZF9fOmZ1bmN0aW9uKG90aGVyKXtpZighcHkuUFlfaXNJbnN0YW5jZShvdGhlcixkYXRldGltZS50aW1lZGVsdGEpKXtyZXR1cm4gcHkuTm90SW1wbGVtZW50ZWQ7fQpyZXR1cm4gcHkuUFlfY2FsbChkYXRldGltZS50aW1lZGVsdGEsW3B5LmZsb2F0LmZyb21KU09OKHRoaXMuZGF5cytvdGhlci5kYXlzKSxweS5mbG9hdC5mcm9tSlNPTih0aGlzLnNlY29uZHMrb3RoZXIuc2Vjb25kcykscHkuZmxvYXQuZnJvbUpTT04odGhpcy5taWNyb3NlY29uZHMrb3RoZXIubWljcm9zZWNvbmRzKV0pO30sX19yYWRkX186ZnVuY3Rpb24ob3RoZXIpe3JldHVybiB0aGlzLl9fYWRkX18ob3RoZXIpO30sX19zdWJfXzpmdW5jdGlvbihvdGhlcil7aWYoIXB5LlBZX2lzSW5zdGFuY2Uob3RoZXIsZGF0ZXRpbWUudGltZWRlbHRhKSl7cmV0dXJuIHB5Lk5vdEltcGxlbWVudGVkO30KcmV0dXJuIHB5LlBZX2NhbGwoZGF0ZXRpbWUudGltZWRlbHRhLFtweS5mbG9hdC5mcm9tSlNPTih0aGlzLmRheXMtb3RoZXIuZGF5cykscHkuZmxvYXQuZnJvbUpTT04odGhpcy5zZWNvbmRzLW90aGVyLnNlY29uZHMpLHB5LmZsb2F0LmZyb21KU09OKHRoaXMubWljcm9zZWNvbmRzLW90aGVyLm1pY3Jvc2Vjb25kcyldKTt9LF9fcnN1Yl9fOmZ1bmN0aW9uKG90aGVyKXtpZighcHkuUFlfaXNJbnN0YW5jZShvdGhlcixkYXRldGltZS50aW1lZGVsdGEpKXtyZXR1cm4gcHkuTm90SW1wbGVtZW50ZWQ7fQpyZXR1cm4gdGhpcy5fX25lZ19fKCkuX19hZGRfXyhvdGhlcik7fSxfX25lZ19fOmZ1bmN0aW9uKCl7cmV0dXJuIHB5LlBZX2NhbGwoZGF0ZXRpbWUudGltZWRlbHRhLFtweS5mbG9hdC5mcm9tSlNPTigtdGhpcy5kYXlzKSxweS5mbG9hdC5mcm9tSlNPTigtdGhpcy5zZWNvbmRzKSxweS5mbG9hdC5mcm9tSlNPTigtdGhpcy5taWNyb3NlY29uZHMpXSk7fSxfX3Bvc19fOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXM7fSxfX211bF9fOmZ1bmN0aW9uKG90aGVyKXtpZighcHkuUFlfaXNJbnN0YW5jZShvdGhlcixweS5mbG9hdCkpe3JldHVybiBweS5Ob3RJbXBsZW1lbnRlZDt9CnZhciBuPW90aGVyLnRvSlNPTigpO3JldHVybiBweS5QWV9jYWxsKGRhdGV0aW1lLnRpbWVkZWx0YSxbcHkuZmxvYXQuZnJvbUpTT04odGhpcy5kYXlzKm4pLHB5LmZsb2F0LmZyb21KU09OKHRoaXMuc2Vjb25kcypuKSxweS5mbG9hdC5mcm9tSlNPTih0aGlzLm1pY3Jvc2Vjb25kcypuKV0pO30sX19ybXVsX186ZnVuY3Rpb24ob3RoZXIpe3JldHVybiB0aGlzLl9fbXVsX18ob3RoZXIpO30sX19kaXZfXzpmdW5jdGlvbihvdGhlcil7aWYoIXB5LlBZX2lzSW5zdGFuY2Uob3RoZXIscHkuZmxvYXQpKXtyZXR1cm4gcHkuTm90SW1wbGVtZW50ZWQ7fQp2YXIgdXNlYz0oKHRoaXMuZGF5cyoyNCozNjAwKSt0aGlzLnNlY29uZHMpKjEwMDAwMDAKK3RoaXMubWljcm9zZWNvbmRzO3JldHVybiBweS5QWV9jYWxsKGRhdGV0aW1lLnRpbWVkZWx0YSxbemVybyx6ZXJvLHB5LmZsb2F0LmZyb21KU09OKHVzZWMvb3RoZXIudG9KU09OKCkpXSk7fSxfX2Zsb29yZGl2X186ZnVuY3Rpb24ob3RoZXIpe3JldHVybiB0aGlzLl9fZGl2X18ob3RoZXIpO30sdG90YWxfc2Vjb25kczpmdW5jdGlvbigpe3JldHVybiBweS5mbG9hdC5mcm9tSlNPTih0aGlzLmRheXMqODY0MDAKK3RoaXMuc2Vjb25kcwordGhpcy5taWNyb3NlY29uZHMvMTAwMDAwMCk7fSxfX25vbnplcm9fXzpmdW5jdGlvbigpe3JldHVybighIXRoaXMuZGF5c3x8ISF0aGlzLnNlY29uZHN8fCEhdGhpcy5taWNyb3NlY29uZHMpP3B5LlRydWU6cHkuRmFsc2U7fX0pO2RhdGV0aW1lLmRhdGV0aW1lPXB5LnR5cGUoJ2RhdGV0aW1lJyxudWxsLHtfX2luaXRfXzpmdW5jdGlvbigpe3ZhciB6ZXJvPXB5LmZsb2F0LmZyb21KU09OKDApO3ZhciBhcmdzPXB5LlBZX3BhcnNlQXJncyhhcmd1bWVudHMsWyd5ZWFyJywnbW9udGgnLCdkYXknLFsnaG91cicsemVyb10sWydtaW51dGUnLHplcm9dLFsnc2Vjb25kJyx6ZXJvXSxbJ21pY3Jvc2Vjb25kJyx6ZXJvXSxbJ3R6aW5mbycscHkuTm9uZV1dKTtmb3IodmFyIGtleSBpbiBhcmdzKXtpZighYXJncy5oYXNPd25Qcm9wZXJ0eShrZXkpKXtjb250aW51ZTt9CnRoaXNba2V5XT1hc0pTKGFyZ3Nba2V5XSk7fX0sX19lcV9fOmZ1bmN0aW9uKG90aGVyKXtyZXR1cm4odGhpcy55ZWFyPT09b3RoZXIueWVhciYmdGhpcy5tb250aD09PW90aGVyLm1vbnRoJiZ0aGlzLmRheT09PW90aGVyLmRheSYmdGhpcy5ob3VyPT09b3RoZXIuaG91ciYmdGhpcy5taW51dGU9PT1vdGhlci5taW51dGUmJnRoaXMuc2Vjb25kPT09b3RoZXIuc2Vjb25kJiZ0aGlzLm1pY3Jvc2Vjb25kPT09b3RoZXIubWljcm9zZWNvbmQmJnRoaXMudHppbmZvPT09b3RoZXIudHppbmZvKT9weS5UcnVlOnB5LkZhbHNlO30scmVwbGFjZTpmdW5jdGlvbigpe3ZhciBhcmdzPXB5LlBZX3BhcnNlQXJncyhhcmd1bWVudHMsW1sneWVhcicscHkuTm9uZV0sWydtb250aCcscHkuTm9uZV0sWydkYXknLHB5Lk5vbmVdLFsnaG91cicscHkuTm9uZV0sWydtaW51dGUnLHB5Lk5vbmVdLFsnc2Vjb25kJyxweS5Ob25lXSxbJ21pY3Jvc2Vjb25kJyxweS5Ob25lXV0pO3ZhciBwYXJhbXM9e307Zm9yKHZhciBrZXkgaW4gYXJncyl7aWYoIWFyZ3MuaGFzT3duUHJvcGVydHkoa2V5KSl7Y29udGludWU7fQp2YXIgYXJnPWFyZ3Nba2V5XTtwYXJhbXNba2V5XT0oYXJnPT09cHkuTm9uZT90aGlzW2tleV06YXNKUyhhcmcpKTt9CnJldHVybiBweS5QWV9jYWxsKGRhdGV0aW1lLmRhdGV0aW1lLHBhcmFtcyk7fSxzdGFydF9vZjpmdW5jdGlvbigpe3ZhciBhcmdzPXB5LlBZX3BhcnNlQXJncyhhcmd1bWVudHMsJ2dyYW51bGFyaXR5Jyk7dmFyIGdyYW51bGFyaXR5PWFyZ3MuZ3JhbnVsYXJpdHkudG9KU09OKCk7aWYoZ3JhbnVsYXJpdHk9PT0neWVhcicpe3JldHVybiBweS5QWV9jYWxsKGRhdGV0aW1lLmRhdGV0aW1lLFt0aGlzLnllYXIsMSwxXSk7fWVsc2UgaWYoZ3JhbnVsYXJpdHk9PT0ncXVhcnRlcicpe3ZhciBxdWFydGVyPWdldF9xdWFydGVyKHRoaXMueWVhcix0aGlzLm1vbnRoKVswXTtyZXR1cm4gcHkuUFlfY2FsbChkYXRldGltZS5kYXRldGltZSxbcXVhcnRlci55ZWFyLHF1YXJ0ZXIubW9udGgscXVhcnRlci5kYXldKTt9ZWxzZSBpZihncmFudWxhcml0eT09PSdtb250aCcpe3JldHVybiBweS5QWV9jYWxsKGRhdGV0aW1lLmRhdGV0aW1lLFt0aGlzLnllYXIsdGhpcy5tb250aCwxXSk7fWVsc2UgaWYoZ3JhbnVsYXJpdHk9PT0nd2Vlaycpe3ZhciBkb3c9Z2V0X2RheV9vZl93ZWVrKHRoaXMueWVhcix0aGlzLm1vbnRoLHRoaXMuZGF5KTtyZXR1cm4gcHkuUFlfY2FsbChkYXRldGltZS5kYXRldGltZSxbdGhpcy55ZWFyLHRoaXMubW9udGgsdGhpcy5kYXktZG93XSk7fWVsc2UgaWYoZ3JhbnVsYXJpdHk9PT0nZGF5Jyl7cmV0dXJuIHB5LlBZX2NhbGwoZGF0ZXRpbWUuZGF0ZXRpbWUsW3RoaXMueWVhcix0aGlzLm1vbnRoLHRoaXMuZGF5XSk7fWVsc2UgaWYoZ3JhbnVsYXJpdHk9PT0naG91cicpe3JldHVybiBweS5QWV9jYWxsKGRhdGV0aW1lLmRhdGV0aW1lLFt0aGlzLnllYXIsdGhpcy5tb250aCx0aGlzLmRheSx0aGlzLmhvdXJdKTt9ZWxzZXt0aHJvdyBuZXcgRXJyb3IoJ1ZhbHVlRXJyb3I6ICcrZ3JhbnVsYXJpdHkrJyBpcyBub3QgYSBzdXBwb3J0ZWQgZ3JhbnVsYXJpdHksIHN1cHBvcnRlZCAnKycgZ3JhbnVsYXJpdGllcyBhcmU6IHllYXIsIHF1YXJ0ZXIsIG1vbnRoLCB3ZWVrLCBkYXkgYW5kIGhvdXIuJyl9fSxlbmRfb2Y6ZnVuY3Rpb24oKXt2YXIgYXJncz1weS5QWV9wYXJzZUFyZ3MoYXJndW1lbnRzLCdncmFudWxhcml0eScpO3ZhciBncmFudWxhcml0eT1hcmdzLmdyYW51bGFyaXR5LnRvSlNPTigpO3ZhciBtaW49WzIzLDU5LDU5XTtpZihncmFudWxhcml0eT09PSd5ZWFyJyl7cmV0dXJuIHB5LlBZX2NhbGwoZGF0ZXRpbWUuZGF0ZXRpbWUsW3RoaXMueWVhciwxMiwzMV0uY29uY2F0KG1pbikpO31lbHNlIGlmKGdyYW51bGFyaXR5PT09J3F1YXJ0ZXInKXt2YXIgcXVhcnRlcj1nZXRfcXVhcnRlcih0aGlzLnllYXIsdGhpcy5tb250aClbMV07cmV0dXJuIHB5LlBZX2NhbGwoZGF0ZXRpbWUuZGF0ZXRpbWUsW3F1YXJ0ZXIueWVhcixxdWFydGVyLm1vbnRoLHF1YXJ0ZXIuZGF5XS5jb25jYXQobWluKSk7fWVsc2UgaWYoZ3JhbnVsYXJpdHk9PT0nbW9udGgnKXt2YXIgZG9tPWRheXNfaW5fbW9udGgodGhpcy55ZWFyLHRoaXMubW9udGgpO3JldHVybiBweS5QWV9jYWxsKGRhdGV0aW1lLmRhdGV0aW1lLFt0aGlzLnllYXIsdGhpcy5tb250aCxkb21dLmNvbmNhdChtaW4pKTt9ZWxzZSBpZihncmFudWxhcml0eT09PSd3ZWVrJyl7dmFyIGRvdz1nZXRfZGF5X29mX3dlZWsodGhpcy55ZWFyLHRoaXMubW9udGgsdGhpcy5kYXkpO3JldHVybiBweS5QWV9jYWxsKGRhdGV0aW1lLmRhdGV0aW1lLFt0aGlzLnllYXIsdGhpcy5tb250aCx0aGlzLmRheSsoNi1kb3cpXS5jb25jYXQobWluKSk7fWVsc2UgaWYoZ3JhbnVsYXJpdHk9PT0nZGF5Jyl7cmV0dXJuIHB5LlBZX2NhbGwoZGF0ZXRpbWUuZGF0ZXRpbWUsW3RoaXMueWVhcix0aGlzLm1vbnRoLHRoaXMuZGF5XS5jb25jYXQobWluKSk7fWVsc2UgaWYoZ3JhbnVsYXJpdHk9PT0naG91cicpe3JldHVybiBweS5QWV9jYWxsKGRhdGV0aW1lLmRhdGV0aW1lLFt0aGlzLnllYXIsdGhpcy5tb250aCx0aGlzLmRheSx0aGlzLmhvdXIsNTksNTldKTt9ZWxzZXt0aHJvdyBuZXcgRXJyb3IoJ1ZhbHVlRXJyb3I6ICcrZ3JhbnVsYXJpdHkrJyBpcyBub3QgYSBzdXBwb3J0ZWQgZ3JhbnVsYXJpdHksIHN1cHBvcnRlZCAnKycgZ3JhbnVsYXJpdGllcyBhcmU6IHllYXIsIHF1YXJ0ZXIsIG1vbnRoLCB3ZWVrLCBkYXkgYW5kIGhvdXIuJyl9fSxhZGQ6ZnVuY3Rpb24oKXt2YXIgYXJncz1weS5QWV9wYXJzZUFyZ3MoYXJndW1lbnRzLFtbJ3llYXJzJyxweS5Ob25lXSxbJ21vbnRocycscHkuTm9uZV0sWydkYXlzJyxweS5Ob25lXSxbJ2hvdXJzJyxweS5Ob25lXSxbJ21pbnV0ZXMnLHB5Lk5vbmVdLFsnc2Vjb25kcycscHkuTm9uZV0sXSk7cmV0dXJuIHB5LlBZX2FkZCh0aGlzLHB5LlBZX2NhbGwocmVsYXRpdmVkZWx0YSx7J3llYXJzJzphcmdzLnllYXJzLCdtb250aHMnOmFyZ3MubW9udGhzLCdkYXlzJzphcmdzLmRheXMsJ2hvdXJzJzphcmdzLmhvdXJzLCdtaW51dGVzJzphcmdzLm1pbnV0ZXMsJ3NlY29uZHMnOmFyZ3Muc2Vjb25kcyx9KSk7fSxzdWJ0cmFjdDpmdW5jdGlvbigpe3ZhciBhcmdzPXB5LlBZX3BhcnNlQXJncyhhcmd1bWVudHMsW1sneWVhcnMnLHB5Lk5vbmVdLFsnbW9udGhzJyxweS5Ob25lXSxbJ2RheXMnLHB5Lk5vbmVdLFsnaG91cnMnLHB5Lk5vbmVdLFsnbWludXRlcycscHkuTm9uZV0sWydzZWNvbmRzJyxweS5Ob25lXSxdKTt2YXIgcGFyYW1zPXt9O2Zvcih2YXIga2V5IGluIGFyZ3Mpe3BhcmFtc1trZXldPShhcmdzW2tleV09PT1weS5Ob25lP2FyZ3Nba2V5XTpweS5mbG9hdC5mcm9tSlNPTigtYXNKUyhhcmdzW2tleV0pKSk7fQpyZXR1cm4gcHkuUFlfYWRkKHRoaXMscHkuUFlfY2FsbChyZWxhdGl2ZWRlbHRhLHBhcmFtcykpO30sc3RyZnRpbWU6ZnVuY3Rpb24oKXt2YXIgc2VsZj10aGlzO3ZhciBhcmdzPXB5LlBZX3BhcnNlQXJncyhhcmd1bWVudHMsJ2Zvcm1hdCcpO3JldHVybiBweS5zdHIuZnJvbUpTT04oYXJncy5mb3JtYXQudG9KU09OKCkucmVwbGFjZSgvJShbQS1aYS16XSkvZyxmdW5jdGlvbihtLGMpe3N3aXRjaChjKXtjYXNlJ1knOnJldHVybiBfLnN0ci5zcHJpbnRmKCclMDRkJyxzZWxmLnllYXIpO2Nhc2UnbSc6cmV0dXJuIF8uc3RyLnNwcmludGYoJyUwMmQnLHNlbGYubW9udGgpO2Nhc2UnZCc6cmV0dXJuIF8uc3RyLnNwcmludGYoJyUwMmQnLHNlbGYuZGF5KTtjYXNlJ0gnOnJldHVybiBfLnN0ci5zcHJpbnRmKCclMDJkJyxzZWxmLmhvdXIpO2Nhc2UnTSc6cmV0dXJuIF8uc3RyLnNwcmludGYoJyUwMmQnLHNlbGYubWludXRlKTtjYXNlJ1MnOnJldHVybiBfLnN0ci5zcHJpbnRmKCclMDJkJyxzZWxmLnNlY29uZCk7fQp0aHJvdyBuZXcgRXJyb3IoJ1ZhbHVlRXJyb3I6IE5vIGtub3duIGNvbnZlcnNpb24gZm9yICcrbSk7fSkpO30sdG9fdXRjOmZ1bmN0aW9uKCl7dmFyIGQ9bmV3IERhdGUodGhpcy55ZWFyLHRoaXMubW9udGgsdGhpcy5kYXksdGhpcy5ob3VyLHRoaXMubWludXRlLHRoaXMuc2Vjb25kKTt2YXIgb2Zmc2V0PWQuZ2V0VGltZXpvbmVPZmZzZXQoKTt2YXIga3dhcmdzPXttaW51dGVzOnB5LmZsb2F0LmZyb21KU09OKG9mZnNldCl9O3ZhciB0aW1lZGVsdGE9cHkuUFlfY2FsbChweS5leHRyYXMuZGF0ZXRpbWUudGltZWRlbHRhLFtdLGt3YXJncyk7dmFyIHM9dG14eHgodGhpcy55ZWFyLHRoaXMubW9udGgsdGhpcy5kYXkrdGltZWRlbHRhLmRheXMsdGhpcy5ob3VyLHRoaXMubWludXRlLHRoaXMuc2Vjb25kK3RpbWVkZWx0YS5zZWNvbmRzKTtyZXR1cm4gZGF0ZXRpbWUuZGF0ZXRpbWUuZnJvbUpTT04ocy55ZWFyLHMubW9udGgscy5kYXkscy5ob3VyLHMubWludXRlLHMuc2Vjb25kKTt9LG5vdzpweS5jbGFzc21ldGhvZC5mcm9tSlNPTihmdW5jdGlvbigpe3ZhciBkPW5ldyBEYXRlKCk7cmV0dXJuIHB5LlBZX2NhbGwoZGF0ZXRpbWUuZGF0ZXRpbWUsW2QuZ2V0RnVsbFllYXIoKSxkLmdldE1vbnRoKCkrMSxkLmdldERhdGUoKSxkLmdldEhvdXJzKCksZC5nZXRNaW51dGVzKCksZC5nZXRTZWNvbmRzKCksZC5nZXRNaWxsaXNlY29uZHMoKSoxMDAwXSk7fSksdG9kYXk6cHkuY2xhc3NtZXRob2QuZnJvbUpTT04oZnVuY3Rpb24oKXt2YXIgZHRfY2xhc3M9cHkuUFlfZ2V0QXR0cihkYXRldGltZSwnZGF0ZXRpbWUnKTtyZXR1cm4gcHkuUFlfY2FsbChweS5QWV9nZXRBdHRyKGR0X2NsYXNzLCdub3cnKSk7fSksdXRjbm93OnB5LmNsYXNzbWV0aG9kLmZyb21KU09OKGZ1bmN0aW9uKCl7dmFyIGQ9bmV3IERhdGUoKTtyZXR1cm4gcHkuUFlfY2FsbChkYXRldGltZS5kYXRldGltZSxbZC5nZXRVVENGdWxsWWVhcigpLGQuZ2V0VVRDTW9udGgoKSsxLGQuZ2V0VVRDRGF0ZSgpLGQuZ2V0VVRDSG91cnMoKSxkLmdldFVUQ01pbnV0ZXMoKSxkLmdldFVUQ1NlY29uZHMoKSxkLmdldFVUQ01pbGxpc2Vjb25kcygpKjEwMDBdKTt9KSxjb21iaW5lOnB5LmNsYXNzbWV0aG9kLmZyb21KU09OKGZ1bmN0aW9uKCl7dmFyIGFyZ3M9cHkuUFlfcGFyc2VBcmdzKGFyZ3VtZW50cywnZGF0ZSB0aW1lJyk7cmV0dXJuIHB5LlBZX2NhbGwoZGF0ZXRpbWUuZGF0ZXRpbWUsW3B5LlBZX2dldEF0dHIoYXJncy5kYXRlLCd5ZWFyJykscHkuUFlfZ2V0QXR0cihhcmdzLmRhdGUsJ21vbnRoJykscHkuUFlfZ2V0QXR0cihhcmdzLmRhdGUsJ2RheScpLHB5LlBZX2dldEF0dHIoYXJncy50aW1lLCdob3VyJykscHkuUFlfZ2V0QXR0cihhcmdzLnRpbWUsJ21pbnV0ZScpLHB5LlBZX2dldEF0dHIoYXJncy50aW1lLCdzZWNvbmQnKV0pO30pLHRvSlNPTjpmdW5jdGlvbigpe3JldHVybiBuZXcgRGF0ZSh0aGlzLnllYXIsdGhpcy5tb250aC0xLHRoaXMuZGF5LHRoaXMuaG91cix0aGlzLm1pbnV0ZSx0aGlzLnNlY29uZCx0aGlzLm1pY3Jvc2Vjb25kLzEwMDApO30sX19hZGRfXzpmdW5jdGlvbihvdGhlcil7aWYoIXB5LlBZX2lzSW5zdGFuY2Uob3RoZXIsZGF0ZXRpbWUudGltZWRlbHRhKSl7cmV0dXJuIHB5Lk5vdEltcGxlbWVudGVkO30KdmFyIHM9dG14eHgodGhpcy55ZWFyLHRoaXMubW9udGgsdGhpcy5kYXkrb3RoZXIuZGF5cyx0aGlzLmhvdXIsdGhpcy5taW51dGUsdGhpcy5zZWNvbmQrb3RoZXIuc2Vjb25kcyk7cmV0dXJuIGRhdGV0aW1lLmRhdGV0aW1lLmZyb21KU09OKHMueWVhcixzLm1vbnRoLHMuZGF5LHMuaG91cixzLm1pbnV0ZSxzLnNlY29uZCk7fSxfX3N1Yl9fOmZ1bmN0aW9uKG90aGVyKXtpZihweS5QWV9pc0luc3RhbmNlKG90aGVyLGRhdGV0aW1lLnRpbWVkZWx0YSkpe3JldHVybiBweS5QWV9hZGQodGhpcyxweS5QWV9uZWdhdGl2ZShvdGhlcikpO30KcmV0dXJuIHB5Lk5vdEltcGxlbWVudGVkO30sZnJvbUpTT046ZnVuY3Rpb24oeWVhcixtb250aCxkYXksaG91cixtaW51dGUsc2Vjb25kKXtyZXR1cm4gcHkuUFlfY2FsbChkYXRldGltZS5kYXRldGltZSxbeWVhcixtb250aCxkYXksaG91cixtaW51dGUsc2Vjb25kXSk7fSx9KTtkYXRldGltZS5kYXRlPXB5LnR5cGUoJ2RhdGUnLG51bGwse19faW5pdF9fOmZ1bmN0aW9uKCl7dmFyIGFyZ3M9cHkuUFlfcGFyc2VBcmdzKGFyZ3VtZW50cywneWVhciBtb250aCBkYXknKTt0aGlzLnllYXI9YXNKUyhhcmdzLnllYXIpO3RoaXMubW9udGg9YXNKUyhhcmdzLm1vbnRoKTt0aGlzLmRheT1hc0pTKGFyZ3MuZGF5KTt9LHN0cmZ0aW1lOmZ1bmN0aW9uKCl7dmFyIHNlbGY9dGhpczt2YXIgYXJncz1weS5QWV9wYXJzZUFyZ3MoYXJndW1lbnRzLCdmb3JtYXQnKTtyZXR1cm4gcHkuc3RyLmZyb21KU09OKGFyZ3MuZm9ybWF0LnRvSlNPTigpLnJlcGxhY2UoLyUoW0EtWmEtel0pL2csZnVuY3Rpb24obSxjKXtzd2l0Y2goYyl7Y2FzZSdZJzpyZXR1cm4gc2VsZi55ZWFyO2Nhc2UnbSc6cmV0dXJuIF8uc3RyLnNwcmludGYoJyUwMmQnLHNlbGYubW9udGgpO2Nhc2UnZCc6cmV0dXJuIF8uc3RyLnNwcmludGYoJyUwMmQnLHNlbGYuZGF5KTt9CnRocm93IG5ldyBFcnJvcignVmFsdWVFcnJvcjogTm8ga25vd24gY29udmVyc2lvbiBmb3IgJyttKTt9KSk7fSxfX2VxX186ZnVuY3Rpb24ob3RoZXIpe3JldHVybih0aGlzLnllYXI9PT1vdGhlci55ZWFyJiZ0aGlzLm1vbnRoPT09b3RoZXIubW9udGgmJnRoaXMuZGF5PT09b3RoZXIuZGF5KT9weS5UcnVlOnB5LkZhbHNlO30scmVwbGFjZTpmdW5jdGlvbigpe3ZhciBhcmdzPXB5LlBZX3BhcnNlQXJncyhhcmd1bWVudHMsW1sneWVhcicscHkuTm9uZV0sWydtb250aCcscHkuTm9uZV0sWydkYXknLHB5Lk5vbmVdXSk7dmFyIHBhcmFtcz17fTtmb3IodmFyIGtleSBpbiBhcmdzKXtpZighYXJncy5oYXNPd25Qcm9wZXJ0eShrZXkpKXtjb250aW51ZTt9CnZhciBhcmc9YXJnc1trZXldO3BhcmFtc1trZXldPShhcmc9PT1weS5Ob25lP3RoaXNba2V5XTphc0pTKGFyZykpO30KcmV0dXJuIHB5LlBZX2NhbGwoZGF0ZXRpbWUuZGF0ZSxwYXJhbXMpO30sc3RhcnRfb2Y6ZnVuY3Rpb24oKXt2YXIgYXJncz1weS5QWV9wYXJzZUFyZ3MoYXJndW1lbnRzLCdncmFudWxhcml0eScpO3ZhciBncmFudWxhcml0eT1hcmdzLmdyYW51bGFyaXR5LnRvSlNPTigpO2lmKGdyYW51bGFyaXR5PT09J3llYXInKXtyZXR1cm4gcHkuUFlfY2FsbChkYXRldGltZS5kYXRlLFt0aGlzLnllYXIsMSwxXSk7fWVsc2UgaWYoZ3JhbnVsYXJpdHk9PT0ncXVhcnRlcicpe3ZhciBxdWFydGVyPWdldF9xdWFydGVyKHRoaXMueWVhcix0aGlzLm1vbnRoKVswXTtyZXR1cm4gcHkuUFlfY2FsbChkYXRldGltZS5kYXRlLFtxdWFydGVyLnllYXIscXVhcnRlci5tb250aCxxdWFydGVyLmRheV0pO31lbHNlIGlmKGdyYW51bGFyaXR5PT09J21vbnRoJyl7cmV0dXJuIHB5LlBZX2NhbGwoZGF0ZXRpbWUuZGF0ZSxbdGhpcy55ZWFyLHRoaXMubW9udGgsMV0pO31lbHNlIGlmKGdyYW51bGFyaXR5PT09J3dlZWsnKXt2YXIgZG93PWdldF9kYXlfb2Zfd2Vlayh0aGlzLnllYXIsdGhpcy5tb250aCx0aGlzLmRheSk7cmV0dXJuIHB5LlBZX2NhbGwoZGF0ZXRpbWUuZGF0ZSxbdGhpcy55ZWFyLHRoaXMubW9udGgsdGhpcy5kYXktZG93XSk7fWVsc2UgaWYoZ3JhbnVsYXJpdHk9PT0nZGF5Jyl7cmV0dXJuIHB5LlBZX2NhbGwoZGF0ZXRpbWUuZGF0ZSxbdGhpcy55ZWFyLHRoaXMubW9udGgsdGhpcy5kYXldKTt9ZWxzZXt0aHJvdyBuZXcgRXJyb3IoJ1ZhbHVlRXJyb3I6ICcrZ3JhbnVsYXJpdHkrJyBpcyBub3QgYSBzdXBwb3J0ZWQgZ3JhbnVsYXJpdHksIHN1cHBvcnRlZCAnKycgZ3JhbnVsYXJpdGllcyBhcmU6IHllYXIsIHF1YXJ0ZXIsIG1vbnRoLCB3ZWVrIGFuZCBkYXkuJyl9fSxlbmRfb2Y6ZnVuY3Rpb24oKXt2YXIgYXJncz1weS5QWV9wYXJzZUFyZ3MoYXJndW1lbnRzLCdncmFudWxhcml0eScpO3ZhciBncmFudWxhcml0eT1hcmdzLmdyYW51bGFyaXR5LnRvSlNPTigpO2lmKGdyYW51bGFyaXR5PT09J3llYXInKXtyZXR1cm4gcHkuUFlfY2FsbChkYXRldGltZS5kYXRlLFt0aGlzLnllYXIsMTIsMzFdKTt9ZWxzZSBpZihncmFudWxhcml0eT09PSdxdWFydGVyJyl7dmFyIHF1YXJ0ZXI9Z2V0X3F1YXJ0ZXIodGhpcy55ZWFyLHRoaXMubW9udGgpWzFdO3JldHVybiBweS5QWV9jYWxsKGRhdGV0aW1lLmRhdGUsW3F1YXJ0ZXIueWVhcixxdWFydGVyLm1vbnRoLHF1YXJ0ZXIuZGF5XSk7fWVsc2UgaWYoZ3JhbnVsYXJpdHk9PT0nbW9udGgnKXt2YXIgZG9tPWRheXNfaW5fbW9udGgodGhpcy55ZWFyLHRoaXMubW9udGgpO3JldHVybiBweS5QWV9jYWxsKGRhdGV0aW1lLmRhdGUsW3RoaXMueWVhcix0aGlzLm1vbnRoLGRvbV0pO31lbHNlIGlmKGdyYW51bGFyaXR5PT09J3dlZWsnKXt2YXIgZG93PWdldF9kYXlfb2Zfd2Vlayh0aGlzLnllYXIsdGhpcy5tb250aCx0aGlzLmRheSk7cmV0dXJuIHB5LlBZX2NhbGwoZGF0ZXRpbWUuZGF0ZSxbdGhpcy55ZWFyLHRoaXMubW9udGgsdGhpcy5kYXkrKDYtZG93KV0pO31lbHNlIGlmKGdyYW51bGFyaXR5PT09J2RheScpe3JldHVybiBweS5QWV9jYWxsKGRhdGV0aW1lLmRhdGUsW3RoaXMueWVhcix0aGlzLm1vbnRoLHRoaXMuZGF5XSk7fWVsc2V7dGhyb3cgbmV3IEVycm9yKCdWYWx1ZUVycm9yOiAnK2dyYW51bGFyaXR5KycgaXMgbm90IGEgc3VwcG9ydGVkIGdyYW51bGFyaXR5LCBzdXBwb3J0ZWQgJysnIGdyYW51bGFyaXRpZXMgYXJlOiB5ZWFyLCBxdWFydGVyLCBtb250aCwgd2VlayBhbmQgZGF5LicpfX0sYWRkOmZ1bmN0aW9uKCl7dmFyIGFyZ3M9cHkuUFlfcGFyc2VBcmdzKGFyZ3VtZW50cyxbWyd5ZWFycycscHkuTm9uZV0sWydtb250aHMnLHB5Lk5vbmVdLFsnZGF5cycscHkuTm9uZV0sXSk7cmV0dXJuIHB5LlBZX2FkZCh0aGlzLHB5LlBZX2NhbGwocmVsYXRpdmVkZWx0YSx7J3llYXJzJzphcmdzLnllYXJzLCdtb250aHMnOmFyZ3MubW9udGhzLCdkYXlzJzphcmdzLmRheXMsfSkpO30sc3VidHJhY3Q6ZnVuY3Rpb24oKXt2YXIgYXJncz1weS5QWV9wYXJzZUFyZ3MoYXJndW1lbnRzLFtbJ3llYXJzJyxweS5Ob25lXSxbJ21vbnRocycscHkuTm9uZV0sWydkYXlzJyxweS5Ob25lXSxdKTt2YXIgcGFyYW1zPXt9O2Zvcih2YXIga2V5IGluIGFyZ3Mpe3BhcmFtc1trZXldPShhcmdzW2tleV09PT1weS5Ob25lP2FyZ3Nba2V5XTpweS5mbG9hdC5mcm9tSlNPTigtYXNKUyhhcmdzW2tleV0pKSk7fQpyZXR1cm4gcHkuUFlfYWRkKHRoaXMscHkuUFlfY2FsbChyZWxhdGl2ZWRlbHRhLHBhcmFtcykpO30sX19hZGRfXzpmdW5jdGlvbihvdGhlcil7aWYoIXB5LlBZX2lzSW5zdGFuY2Uob3RoZXIsZGF0ZXRpbWUudGltZWRlbHRhKSl7cmV0dXJuIHB5Lk5vdEltcGxlbWVudGVkO30KdmFyIHM9dG14eHgodGhpcy55ZWFyLHRoaXMubW9udGgsdGhpcy5kYXkrb3RoZXIuZGF5cyk7cmV0dXJuIGRhdGV0aW1lLmRhdGUuZnJvbUpTT04ocy55ZWFyLHMubW9udGgscy5kYXkpO30sX19yYWRkX186ZnVuY3Rpb24ob3RoZXIpe3JldHVybiB0aGlzLl9fYWRkX18ob3RoZXIpO30sX19zdWJfXzpmdW5jdGlvbihvdGhlcil7aWYocHkuUFlfaXNJbnN0YW5jZShvdGhlcixkYXRldGltZS50aW1lZGVsdGEpKXtyZXR1cm4gcHkuUFlfYWRkKHRoaXMscHkuUFlfbmVnYXRpdmUob3RoZXIpKTt9CmlmKHB5LlBZX2lzSW5zdGFuY2Uob3RoZXIsZGF0ZXRpbWUuZGF0ZSkpe3JldHVybiBweS5QWV9jYWxsKGRhdGV0aW1lLnRpbWVkZWx0YSxbcHkuUFlfc3VidHJhY3QocHkuUFlfY2FsbChweS5QWV9nZXRBdHRyKHRoaXMsJ3Rvb3JkaW5hbCcpKSxweS5QWV9jYWxsKHB5LlBZX2dldEF0dHIob3RoZXIsJ3Rvb3JkaW5hbCcpKSldKTt9CnJldHVybiBweS5Ob3RJbXBsZW1lbnRlZDt9LHRvb3JkaW5hbDpmdW5jdGlvbigpe3JldHVybiBweS5mbG9hdC5mcm9tSlNPTih5bWQyb3JkKHRoaXMueWVhcix0aGlzLm1vbnRoLHRoaXMuZGF5KSk7fSx3ZWVrZGF5OmZ1bmN0aW9uKCl7cmV0dXJuIHB5LmZsb2F0LmZyb21KU09OKCh0aGlzLnRvb3JkaW5hbCgpLnRvSlNPTigpKzYpJTcpO30sZnJvbUpTT046ZnVuY3Rpb24oeWVhcixtb250aCxkYXkpe3JldHVybiBweS5QWV9jYWxsKGRhdGV0aW1lLmRhdGUsW3llYXIsbW9udGgsZGF5XSk7fSx0b2RheTpweS5jbGFzc21ldGhvZC5mcm9tSlNPTihmdW5jdGlvbigpe3ZhciBkPW5ldyBEYXRlKCk7cmV0dXJuIHB5LlBZX2NhbGwoZGF0ZXRpbWUuZGF0ZSxbZC5nZXRGdWxsWWVhcigpLGQuZ2V0TW9udGgoKSsxLGQuZ2V0RGF0ZSgpXSk7fSksfSk7ZGF0ZXRpbWUudGltZT1weS50eXBlKCd0aW1lJyxudWxsLHtfX2luaXRfXzpmdW5jdGlvbigpe3ZhciB6ZXJvPXB5LmZsb2F0LmZyb21KU09OKDApO3ZhciBhcmdzPXB5LlBZX3BhcnNlQXJncyhhcmd1bWVudHMsW1snaG91cicsemVyb10sWydtaW51dGUnLHplcm9dLFsnc2Vjb25kJyx6ZXJvXSxbJ21pY3Jvc2Vjb25kJyx6ZXJvXSxbJ3R6aW5mbycscHkuTm9uZV1dKTtmb3IodmFyIGsgaW4gYXJncyl7aWYoIWFyZ3MuaGFzT3duUHJvcGVydHkoaykpe2NvbnRpbnVlO30KdGhpc1trXT1hc0pTKGFyZ3Nba10pO319fSk7dmFyIHRpbWU9cHkuUFlfY2FsbChweS5vYmplY3QpO3RpbWUuc3RyZnRpbWU9cHkuUFlfZGVmLmZyb21KU09OKGZ1bmN0aW9uKCl7dmFyIGFyZ3M9cHkuUFlfcGFyc2VBcmdzKGFyZ3VtZW50cywnZm9ybWF0Jyk7dmFyIGR0X2NsYXNzPXB5LlBZX2dldEF0dHIoZGF0ZXRpbWUsJ2RhdGV0aW1lJyk7dmFyIGQ9cHkuUFlfY2FsbChweS5QWV9nZXRBdHRyKGR0X2NsYXNzLCd1dGNub3cnKSk7cmV0dXJuIHB5LlBZX2NhbGwocHkuUFlfZ2V0QXR0cihkLCdzdHJmdGltZScpLFthcmdzLmZvcm1hdF0pO30pO3ZhciBhcmdzPV8ubWFwKCgneWVhciBtb250aCBkYXkgaG91ciBtaW51dGUgc2Vjb25kICcKKyd5ZWFycyBtb250aHMgd2Vla3MgZGF5cyBob3VycyBtaW51dGVzIHNlY29uZHMgJworJ3dlZWtkYXkgbGVhcGRheXMgeWVhcmRheSBubHllYXJkYXknKS5zcGxpdCgnICcpLGZ1bmN0aW9uKGFyZyl7c3dpdGNoKGFyZyl7Y2FzZSd5ZWFycyc6Y2FzZSdtb250aHMnOmNhc2UnZGF5cyc6Y2FzZSdsZWFwZGF5cyc6Y2FzZSd3ZWVrcyc6Y2FzZSdob3Vycyc6Y2FzZSdtaW51dGVzJzpjYXNlJ3NlY29uZHMnOnJldHVyblthcmcsemVyb107Y2FzZSd5ZWFyJzpjYXNlJ21vbnRoJzpjYXNlJ2RheSc6Y2FzZSd3ZWVrZGF5JzpjYXNlJ2hvdXInOmNhc2UnbWludXRlJzpjYXNlJ3NlY29uZCc6Y2FzZSd5ZWFyZGF5JzpjYXNlJ25seWVhcmRheSc6cmV0dXJuW2FyZyxudWxsXTtkZWZhdWx0OnRocm93IG5ldyBFcnJvcigiVW5rbm93biByZWxhdGl2ZWRlbHRhIGFyZ3VtZW50ICIrYXJnKTt9fSk7YXJncy51bnNoaWZ0KCcqJyk7dmFyIF91dGlscz17bW9udGhyYW5nZTpmdW5jdGlvbih5ZWFyLG1vbnRoKXtpZihtb250aDwxfHxtb250aD4xMil7dGhyb3cgbmV3IEVycm9yKCJJbGxlZ2FsIG1vbnRoICIrbW9udGgpO30KdmFyIGRheTE9dGhpcy53ZWVrZGF5KHllYXIsbW9udGgsMSk7dmFyIG5kYXlzPXRoaXMubWRheXNbbW9udGhdKyhtb250aD09dGhpcy5GZWJydWFyeSYmdGhpcy5pc2xlYXAoeWVhcikpO3JldHVybltkYXkxLG5kYXlzXTt9LHdlZWtkYXk6ZnVuY3Rpb24oeWVhcixtb250aCxkYXkpe3ZhciBkYXRlPXB5LlBZX2NhbGwoZGF0ZXRpbWUuZGF0ZSxbeWVhcixtb250aCxkYXldKTtyZXR1cm4gcHkuUFlfY2FsbChweS5QWV9nZXRBdHRyKGRhdGUsJ3dlZWtkYXknKSk7fSxpc2xlYXA6ZnVuY3Rpb24oeWVhcil7cmV0dXJuIHllYXIlND09PTAmJih5ZWFyJTEwMCE9PTB8fHllYXIlNDAwPT09MCk7fSxtZGF5czpbMCwzMSwyOCwzMSwzMCwzMSwzMCwzMSwzMSwzMCwzMSwzMCwzMV0sSmFudWFyeToxLEZlYnJ1YXJ5OjJ9O3ZhciByZWxhdGl2ZWRlbHRhPXB5LnR5cGUoJ3JlbGF0aXZlZGVsdGEnLG51bGwse19faW5pdF9fOmZ1bmN0aW9uKCl7dGhpcy5vcHM9cHkuUFlfcGFyc2VBcmdzKGFyZ3VtZW50cyxhcmdzKTt0aGlzLm9wcy5kYXlzPXB5LmZsb2F0LmZyb21KU09OKGFzSlModGhpcy5vcHMuZGF5cykrYXNKUyh0aGlzLm9wcy53ZWVrcykqNyk7dmFyIHlkYXk9emVybztpZih0aGlzLm9wcy5ubHllYXJkYXkpe3lkYXk9dGhpcy5vcHMubmx5ZWFyZGF5O31lbHNlIGlmKHRoaXMub3BzLnllYXJkYXkpe3lkYXk9dGhpcy5vcHMueWVhcmRheTtpZihhc0pTKHRoaXMub3BzLnllYXJkYXkpPjU5KXt0aGlzLm9wcy5sZWFwZGF5cz1weS5mbG9hdC5mcm9tSlMoLTEpO319CmlmKHB5LlBZX2lzVHJ1ZSh5ZGF5KSl7dmFyIHlkYXlpZHg9WzMxLDU5LDkwLDEyMCwxNTEsMTgxLDIxMiwyNDMsMjczLDMwNCwzMzQsMzY2XTtmb3IodmFyIGlkeD0wO2lkeDx5ZGF5aWR4Lmxlbmd0aDsrK2lkeCl7dmFyIHlkYXlzPXlkYXlpZHhbaWR4XTtpZihhc0pTKHlkYXkpPD15ZGF5cyl7dGhpcy5vcHMubW9udGg9cHkuZmxvYXQuZnJvbUpTT04oaWR4KzEpO2lmKCFpZHgpe3RoaXMub3BzLmRheT15ZGF5O31lbHNle3RoaXMub3BzLmRheT1weS5QWV9zdWJ0cmFjdCh5ZGF5LHB5LmZsb2F0LmZyb21KU09OKHlkYXlpZHhbaWR4LTFdKSk7fQpicmVhazt9fQppZihpZHg9PT15ZGF5aWR4Lmxlbmd0aCl7dGhyb3cgbmV3IEVycm9yKCJJbnZhbGlkIHllYXIgZGF5ICgiK2FzSlMoeWRheSkrIikiKTt9fQp0aGlzLl9maXgoKTt9LF9maXg6ZnVuY3Rpb24oKXt2YXIgc2VsZj10aGlzO3ZhciBtb250aHM9YXNKUyh0aGlzLm9wcy5tb250aHMpO2lmKE1hdGguYWJzKG1vbnRocyk+MTEpe3ZhciBzPW1vbnRocz4wPzE6LTE7ZGl2bW9kKG1vbnRocypzLDEyLGZ1bmN0aW9uKHllYXJzLG1vbnRocyl7c2VsZi5vcHMubW9udGhzPXB5LmZsb2F0LmZyb21KU09OKG1vbnRocypzKTtzZWxmLm9wcy55ZWFycz1weS5mbG9hdC5mcm9tSlNPTihhc0pTKHNlbGYub3BzLnllYXJzKSt5ZWFycypzKTt9KTt9CnRoaXMuX2hhc190aW1lPTA7fSxfX2FkZF9fOmZ1bmN0aW9uKG90aGVyKXtpZighKHB5LlBZX2lzSW5zdGFuY2Uob3RoZXIsZGF0ZXRpbWUuZGF0ZSl8fHB5LlBZX2lzSW5zdGFuY2Uob3RoZXIsZGF0ZXRpbWUuZGF0ZXRpbWUpKSl7cmV0dXJuIHB5Lk5vdEltcGxlbWVudGVkO30KdmFyIHllYXI9KGFzSlModGhpcy5vcHMueWVhcil8fGFzSlMob3RoZXIueWVhcikpK2FzSlModGhpcy5vcHMueWVhcnMpO3ZhciBtb250aD1hc0pTKHRoaXMub3BzLm1vbnRoKXx8YXNKUyhvdGhlci5tb250aCk7dmFyIG1vbnRocztpZihtb250aHM9YXNKUyh0aGlzLm9wcy5tb250aHMpKXtpZihNYXRoLmFicyhtb250aHMpPDF8fE1hdGguYWJzKG1vbnRocyk+MTIpe3Rocm93IG5ldyBFcnJvcigiQ2FuIG9ubHkgdXNlIHJlbGF0aXZlIG1vbnRocyBiZXR3ZWVuIC0xMiBhbmQgKzEyIik7fQptb250aCs9bW9udGhzO2lmKG1vbnRoPjEyKXt5ZWFyKz0xO21vbnRoLT0xMjt9CmlmKG1vbnRoPDEpe3llYXItPTE7bW9udGgrPTEyO319CnZhciBkYXk9TWF0aC5taW4oX3V0aWxzLm1vbnRocmFuZ2UoeWVhcixtb250aClbMV0sYXNKUyh0aGlzLm9wcy5kYXkpfHxhc0pTKG90aGVyLmRheSkpO3ZhciByZXBsPXt5ZWFyOnB5LmZsb2F0LmZyb21KU09OKHllYXIpLG1vbnRoOnB5LmZsb2F0LmZyb21KU09OKG1vbnRoKSxkYXk6cHkuZmxvYXQuZnJvbUpTT04oZGF5KX07aWYocHkuUFlfaXNJbnN0YW5jZShvdGhlcixkYXRldGltZS5kYXRldGltZSkpe3JlcGwuaG91cj1weS5mbG9hdC5mcm9tSlNPTihhc0pTKHRoaXMub3BzLmhvdXIpfHxhc0pTKG90aGVyLmhvdXIpKTtyZXBsLm1pbnV0ZT1weS5mbG9hdC5mcm9tSlNPTihhc0pTKHRoaXMub3BzLm1pbnV0ZSl8fGFzSlMob3RoZXIubWludXRlKSk7cmVwbC5zZWNvbmQ9cHkuZmxvYXQuZnJvbUpTT04oYXNKUyh0aGlzLm9wcy5zZWNvbmQpfHxhc0pTKG90aGVyLnNlY29uZCkpO30KdmFyIGRheXM9YXNKUyh0aGlzLm9wcy5kYXlzKTtpZihweS5QWV9pc1RydWUodGhpcy5vcHMubGVhcGRheXMpJiZtb250aD4yJiZfdXRpbHMuaXNsZWFwKHllYXIpKXtkYXlzKz1hc0pTKHRoaXMub3BzLmxlYXBkYXlzKTt9CnZhciByZXQ9cHkuUFlfYWRkKHB5LlBZX2NhbGwocHkuUFlfZ2V0QXR0cihvdGhlciwncmVwbGFjZScpLHJlcGwpLHB5LlBZX2NhbGwoZGF0ZXRpbWUudGltZWRlbHRhLHtkYXlzOnB5LmZsb2F0LmZyb21KU09OKGRheXMpLGhvdXJzOnB5LmZsb2F0LmZyb21KU09OKGFzSlModGhpcy5vcHMuaG91cnMpKSxtaW51dGVzOnB5LmZsb2F0LmZyb21KU09OKGFzSlModGhpcy5vcHMubWludXRlcykpLHNlY29uZHM6cHkuZmxvYXQuZnJvbUpTT04oYXNKUyh0aGlzLm9wcy5zZWNvbmRzKSl9KSk7aWYodGhpcy5vcHMud2Vla2RheSl7dmFyIHdlZWtkYXk9YXNKUyh0aGlzLm9wcy53ZWVrZGF5KSxudGg9MTt2YXIganVtcGRheXM9KE1hdGguYWJzKG50aCktMSkqNzt2YXIgcmV0X3dlZWtkYXk9YXNKUyhweS5QWV9jYWxsKHB5LlBZX2dldEF0dHIocmV0LCd3ZWVrZGF5JykpKTtpZihudGg+MCl7anVtcGRheXMrPSg3LXJldF93ZWVrZGF5K3dlZWtkYXkpJTc7fWVsc2V7anVtcGRheXMrPShyZXRfd2Vla2RheS13ZWVrZGF5KSU3O2p1bXBkYXlzKj0tMTt9CnJldD1weS5QWV9hZGQocmV0LHB5LlBZX2NhbGwoZGF0ZXRpbWUudGltZWRlbHRhLHtkYXlzOnB5LmZsb2F0LmZyb21KU09OKGp1bXBkYXlzKX0pKTt9CnJldHVybiByZXQ7fSxfX3JhZGRfXzpmdW5jdGlvbihvdGhlcil7cmV0dXJuIHRoaXMuX19hZGRfXyhvdGhlcik7fSxfX3JzdWJfXzpmdW5jdGlvbihvdGhlcil7cmV0dXJuIHRoaXMuX19uZWdfXygpLl9fcmFkZF9fKG90aGVyKTt9LF9fbmVnX186ZnVuY3Rpb24oKXtyZXR1cm4gcHkuUFlfY2FsbChyZWxhdGl2ZWRlbHRhLHt5ZWFyczpweS5QWV9uZWdhdGl2ZSh0aGlzLm9wcy55ZWFycyksbW9udGhzOnB5LlBZX25lZ2F0aXZlKHRoaXMub3BzLm1vbnRocyksZGF5czpweS5QWV9uZWdhdGl2ZSh0aGlzLm9wcy5kYXlzKSxsZWFwZGF5czp0aGlzLm9wcy5sZWFwZGF5cyxob3VyczpweS5QWV9uZWdhdGl2ZSh0aGlzLm9wcy5ob3VycyksbWludXRlczpweS5QWV9uZWdhdGl2ZSh0aGlzLm9wcy5taW51dGVzKSxzZWNvbmRzOnB5LlBZX25lZ2F0aXZlKHRoaXMub3BzLnNlY29uZHMpLHllYXI6dGhpcy5vcHMueWVhcixtb250aDp0aGlzLm9wcy5tb250aCxkYXk6dGhpcy5vcHMuZGF5LHdlZWtkYXk6dGhpcy5vcHMud2Vla2RheSxob3VyOnRoaXMub3BzLmhvdXIsbWludXRlOnRoaXMub3BzLm1pbnV0ZSxzZWNvbmQ6dGhpcy5vcHMuc2Vjb25kfSk7fX0pO3B5LmV4dHJhcz17ZGF0ZXRpbWU6ZGF0ZXRpbWUsdGltZTp0aW1lLHJlbGF0aXZlZGVsdGE6cmVsYXRpdmVkZWx0YSx9O30pKHR5cGVvZiBleHBvcnRzPT09J3VuZGVmaW5lZCc/cHk6ZXhwb3J0cyk7OwoKLyogL3dlYi9zdGF0aWMvbGliL2pxdWVyeS5iYS1iYnEvanF1ZXJ5LmJhLWJicS5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwooZnVuY3Rpb24oJCx3aW5kb3cpeyckOm5vbXVuZ2UnO3ZhciB1bmRlZmluZWQsYXBzPUFycmF5LnByb3RvdHlwZS5zbGljZSxkZWNvZGU9ZGVjb2RlVVJJQ29tcG9uZW50LGpxX3BhcmFtPSQucGFyYW0sanFfcGFyYW1fc29ydGVkLGpxX3BhcmFtX2ZyYWdtZW50LGpxX2RlcGFyYW0sanFfZGVwYXJhbV9mcmFnbWVudCxqcV9iYnE9JC5iYnE9JC5iYnF8fHt9LGpxX2JicV9wdXNoU3RhdGUsanFfYmJxX2dldFN0YXRlLGpxX2VsZW1VcmxBdHRyLHNwZWNpYWw9JC5ldmVudC5zcGVjaWFsLHN0cl9oYXNoY2hhbmdlPSdoYXNoY2hhbmdlJyxzdHJfcXVlcnlzdHJpbmc9J3F1ZXJ5c3RyaW5nJyxzdHJfZnJhZ21lbnQ9J2ZyYWdtZW50JyxzdHJfZWxlbVVybEF0dHI9J2VsZW1VcmxBdHRyJyxzdHJfaHJlZj0naHJlZicsc3RyX3NyYz0nc3JjJyxyZV9wYXJhbXNfcXVlcnlzdHJpbmc9L14uKlw/fCMuKiQvZyxyZV9wYXJhbXNfZnJhZ21lbnQscmVfZnJhZ21lbnQscmVfbm9fZXNjYXBlLGFqYXhfY3Jhd2xhYmxlLGZyYWdtZW50X3ByZWZpeCxlbGVtVXJsQXR0cl9jYWNoZT17fTtmdW5jdGlvbiBpc19zdHJpbmcoYXJnKXtyZXR1cm4gdHlwZW9mIGFyZz09PSdzdHJpbmcnO307ZnVuY3Rpb24gY3VycnkoZnVuYyl7dmFyIGFyZ3M9YXBzLmNhbGwoYXJndW1lbnRzLDEpO3JldHVybiBmdW5jdGlvbigpe3JldHVybiBmdW5jLmFwcGx5KHRoaXMsYXJncy5jb25jYXQoYXBzLmNhbGwoYXJndW1lbnRzKSkpO307fTtmdW5jdGlvbiBnZXRfZnJhZ21lbnQodXJsKXtyZXR1cm4gdXJsLnJlcGxhY2UocmVfZnJhZ21lbnQsJyQyJyk7fTtmdW5jdGlvbiBnZXRfcXVlcnlzdHJpbmcodXJsKXtyZXR1cm4gdXJsLnJlcGxhY2UoLyg/Ol5bXj8jXSpcPyhbXiNdKikuKiQpPy4qLywnJDEnKTt9O2Z1bmN0aW9uIGpxX3BhcmFtX3N1Yihpc19mcmFnbWVudCxnZXRfZnVuYyx1cmwscGFyYW1zLG1lcmdlX21vZGUpe3ZhciByZXN1bHQscXMsbWF0Y2hlcyx1cmxfcGFyYW1zLGhhc2g7aWYocGFyYW1zIT09dW5kZWZpbmVkKXttYXRjaGVzPXVybC5tYXRjaChpc19mcmFnbWVudD9yZV9mcmFnbWVudDovXihbXiM/XSopXD8/KFteI10qKSgjPy4qKS8pO2hhc2g9bWF0Y2hlc1szXXx8Jyc7aWYobWVyZ2VfbW9kZT09PTImJmlzX3N0cmluZyhwYXJhbXMpKXtxcz1wYXJhbXMucmVwbGFjZShpc19mcmFnbWVudD9yZV9wYXJhbXNfZnJhZ21lbnQ6cmVfcGFyYW1zX3F1ZXJ5c3RyaW5nLCcnKTt9ZWxzZXt1cmxfcGFyYW1zPWpxX2RlcGFyYW0obWF0Y2hlc1syXSk7cGFyYW1zPWlzX3N0cmluZyhwYXJhbXMpP2pxX2RlcGFyYW1baXNfZnJhZ21lbnQ/c3RyX2ZyYWdtZW50OnN0cl9xdWVyeXN0cmluZ10ocGFyYW1zKTpwYXJhbXM7cXM9bWVyZ2VfbW9kZT09PTI/cGFyYW1zOm1lcmdlX21vZGU9PT0xPyQuZXh0ZW5kKHt9LHBhcmFtcyx1cmxfcGFyYW1zKTokLmV4dGVuZCh7fSx1cmxfcGFyYW1zLHBhcmFtcyk7cXM9anFfcGFyYW1fc29ydGVkKHFzKTtpZihpc19mcmFnbWVudCl7cXM9cXMucmVwbGFjZShyZV9ub19lc2NhcGUsZGVjb2RlKTt9fQpyZXN1bHQ9bWF0Y2hlc1sxXSsoaXNfZnJhZ21lbnQ/ZnJhZ21lbnRfcHJlZml4OnFzfHwhbWF0Y2hlc1sxXT8nPyc6JycpK3FzK2hhc2g7fWVsc2V7cmVzdWx0PWdldF9mdW5jKHVybCE9PXVuZGVmaW5lZD91cmw6bG9jYXRpb24uaHJlZik7fQpyZXR1cm4gcmVzdWx0O307anFfcGFyYW1bc3RyX3F1ZXJ5c3RyaW5nXT1jdXJyeShqcV9wYXJhbV9zdWIsMCxnZXRfcXVlcnlzdHJpbmcpO2pxX3BhcmFtW3N0cl9mcmFnbWVudF09anFfcGFyYW1fZnJhZ21lbnQ9Y3VycnkoanFfcGFyYW1fc3ViLDEsZ2V0X2ZyYWdtZW50KTtqcV9wYXJhbS5zb3J0ZWQ9anFfcGFyYW1fc29ydGVkPWZ1bmN0aW9uKGEsdHJhZGl0aW9uYWwpe3ZhciBhcnI9W10sb2JqPXt9OyQuZWFjaChqcV9wYXJhbShhLHRyYWRpdGlvbmFsKS5zcGxpdCgnJicpLGZ1bmN0aW9uKGksdil7dmFyIGtleT12LnJlcGxhY2UoLyg/OiU1Qnw9KS4qJC8sJycpLGtleV9vYmo9b2JqW2tleV07aWYoIWtleV9vYmope2tleV9vYmo9b2JqW2tleV09W107YXJyLnB1c2goa2V5KTt9CmtleV9vYmoucHVzaCh2KTt9KTtyZXR1cm4gJC5tYXAoYXJyLnNvcnQoKSxmdW5jdGlvbih2KXtyZXR1cm4gb2JqW3ZdO30pLmpvaW4oJyYnKTt9O2pxX3BhcmFtX2ZyYWdtZW50Lm5vRXNjYXBlPWZ1bmN0aW9uKGNoYXJzKXtjaGFycz1jaGFyc3x8Jyc7dmFyIGFycj0kLm1hcChjaGFycy5zcGxpdCgnJyksZW5jb2RlVVJJQ29tcG9uZW50KTtyZV9ub19lc2NhcGU9bmV3IFJlZ0V4cChhcnIuam9pbignfCcpLCdnJyk7fTtqcV9wYXJhbV9mcmFnbWVudC5ub0VzY2FwZSgnLC8nKTtqcV9wYXJhbV9mcmFnbWVudC5hamF4Q3Jhd2xhYmxlPWZ1bmN0aW9uKHN0YXRlKXtpZihzdGF0ZSE9PXVuZGVmaW5lZCl7aWYoc3RhdGUpe3JlX3BhcmFtc19mcmFnbWVudD0vXi4qKD86IyF8IykvO3JlX2ZyYWdtZW50PS9eKFteI10qKSg/OiMhfCMpPyguKikkLztmcmFnbWVudF9wcmVmaXg9JyMhJzt9ZWxzZXtyZV9wYXJhbXNfZnJhZ21lbnQ9L14uKiMvO3JlX2ZyYWdtZW50PS9eKFteI10qKSM/KC4qKSQvO2ZyYWdtZW50X3ByZWZpeD0nIyc7fQphamF4X2NyYXdsYWJsZT0hIXN0YXRlO30KcmV0dXJuIGFqYXhfY3Jhd2xhYmxlO307anFfcGFyYW1fZnJhZ21lbnQuYWpheENyYXdsYWJsZSgwKTskLmRlcGFyYW09anFfZGVwYXJhbT1mdW5jdGlvbihwYXJhbXMsY29lcmNlKXt2YXIgb2JqPXt9LGNvZXJjZV90eXBlcz17J3RydWUnOiEwLCdmYWxzZSc6ITEsJ251bGwnOm51bGx9OyQuZWFjaChwYXJhbXMucmVwbGFjZSgvXCsvZywnICcpLnNwbGl0KCcmJyksZnVuY3Rpb24oaix2KXt2YXIgcGFyYW09di5zcGxpdCgnPScpLGtleT1kZWNvZGUocGFyYW1bMF0pLHZhbCxjdXI9b2JqLGk9MCxrZXlzPWtleS5zcGxpdCgnXVsnKSxrZXlzX2xhc3Q9a2V5cy5sZW5ndGgtMTtpZigvXFsvLnRlc3Qoa2V5c1swXSkmJi9cXSQvLnRlc3Qoa2V5c1trZXlzX2xhc3RdKSl7a2V5c1trZXlzX2xhc3RdPWtleXNba2V5c19sYXN0XS5yZXBsYWNlKC9cXSQvLCcnKTtrZXlzPWtleXMuc2hpZnQoKS5zcGxpdCgnWycpLmNvbmNhdChrZXlzKTtrZXlzX2xhc3Q9a2V5cy5sZW5ndGgtMTt9ZWxzZXtrZXlzX2xhc3Q9MDt9CmlmKHBhcmFtLmxlbmd0aD09PTIpe3ZhbD1kZWNvZGUocGFyYW1bMV0pO2lmKGNvZXJjZSl7dmFsPXZhbCYmIWlzTmFOKHZhbCk/K3ZhbDp2YWw9PT0ndW5kZWZpbmVkJz91bmRlZmluZWQ6Y29lcmNlX3R5cGVzW3ZhbF0hPT11bmRlZmluZWQ/Y29lcmNlX3R5cGVzW3ZhbF06dmFsO30KaWYoa2V5c19sYXN0KXtmb3IoO2k8PWtleXNfbGFzdDtpKyspe2tleT1rZXlzW2ldPT09Jyc/Y3VyLmxlbmd0aDprZXlzW2ldO2N1cj1jdXJba2V5XT1pPGtleXNfbGFzdD9jdXJba2V5XXx8KGtleXNbaSsxXSYmaXNOYU4oa2V5c1tpKzFdKT97fTpbXSk6dmFsO319ZWxzZXtpZigkLmlzQXJyYXkob2JqW2tleV0pKXtvYmpba2V5XS5wdXNoKHZhbCk7fWVsc2UgaWYob2JqW2tleV0hPT11bmRlZmluZWQpe29ialtrZXldPVtvYmpba2V5XSx2YWxdO31lbHNle29ialtrZXldPXZhbDt9fX1lbHNlIGlmKGtleSl7b2JqW2tleV09Y29lcmNlP3VuZGVmaW5lZDonJzt9fSk7cmV0dXJuIG9iajt9O2Z1bmN0aW9uIGpxX2RlcGFyYW1fc3ViKGlzX2ZyYWdtZW50LHVybF9vcl9wYXJhbXMsY29lcmNlKXtpZih1cmxfb3JfcGFyYW1zPT09dW5kZWZpbmVkfHx0eXBlb2YgdXJsX29yX3BhcmFtcz09PSdib29sZWFuJyl7Y29lcmNlPXVybF9vcl9wYXJhbXM7dXJsX29yX3BhcmFtcz1qcV9wYXJhbVtpc19mcmFnbWVudD9zdHJfZnJhZ21lbnQ6c3RyX3F1ZXJ5c3RyaW5nXSgpO31lbHNle3VybF9vcl9wYXJhbXM9aXNfc3RyaW5nKHVybF9vcl9wYXJhbXMpP3VybF9vcl9wYXJhbXMucmVwbGFjZShpc19mcmFnbWVudD9yZV9wYXJhbXNfZnJhZ21lbnQ6cmVfcGFyYW1zX3F1ZXJ5c3RyaW5nLCcnKTp1cmxfb3JfcGFyYW1zO30KcmV0dXJuIGpxX2RlcGFyYW0odXJsX29yX3BhcmFtcyxjb2VyY2UpO307anFfZGVwYXJhbVtzdHJfcXVlcnlzdHJpbmddPWN1cnJ5KGpxX2RlcGFyYW1fc3ViLDApO2pxX2RlcGFyYW1bc3RyX2ZyYWdtZW50XT1qcV9kZXBhcmFtX2ZyYWdtZW50PWN1cnJ5KGpxX2RlcGFyYW1fc3ViLDEpOyRbc3RyX2VsZW1VcmxBdHRyXXx8KCRbc3RyX2VsZW1VcmxBdHRyXT1mdW5jdGlvbihvYmope3JldHVybiAkLmV4dGVuZChlbGVtVXJsQXR0cl9jYWNoZSxvYmopO30pKHthOnN0cl9ocmVmLGJhc2U6c3RyX2hyZWYsaWZyYW1lOnN0cl9zcmMsaW1nOnN0cl9zcmMsaW5wdXQ6c3RyX3NyYyxmb3JtOidhY3Rpb24nLGxpbms6c3RyX2hyZWYsc2NyaXB0OnN0cl9zcmN9KTtqcV9lbGVtVXJsQXR0cj0kW3N0cl9lbGVtVXJsQXR0cl07ZnVuY3Rpb24ganFfZm5fc3ViKG1vZGUsZm9yY2VfYXR0cixwYXJhbXMsbWVyZ2VfbW9kZSl7aWYoIWlzX3N0cmluZyhwYXJhbXMpJiZ0eXBlb2YgcGFyYW1zIT09J29iamVjdCcpe21lcmdlX21vZGU9cGFyYW1zO3BhcmFtcz1mb3JjZV9hdHRyO2ZvcmNlX2F0dHI9dW5kZWZpbmVkO30KcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe3ZhciB0aGF0PSQodGhpcyksYXR0cj1mb3JjZV9hdHRyfHxqcV9lbGVtVXJsQXR0cigpWyh0aGlzLm5vZGVOYW1lfHwnJykudG9Mb3dlckNhc2UoKV18fCcnLHVybD1hdHRyJiZ0aGF0LmF0dHIoYXR0cil8fCcnO3RoYXQuYXR0cihhdHRyLGpxX3BhcmFtW21vZGVdKHVybCxwYXJhbXMsbWVyZ2VfbW9kZSkpO30pO307JC5mbltzdHJfcXVlcnlzdHJpbmddPWN1cnJ5KGpxX2ZuX3N1YixzdHJfcXVlcnlzdHJpbmcpOyQuZm5bc3RyX2ZyYWdtZW50XT1jdXJyeShqcV9mbl9zdWIsc3RyX2ZyYWdtZW50KTtqcV9iYnEucHVzaFN0YXRlPWpxX2JicV9wdXNoU3RhdGU9ZnVuY3Rpb24ocGFyYW1zLG1lcmdlX21vZGUpe2lmKGlzX3N0cmluZyhwYXJhbXMpJiYvXiMvLnRlc3QocGFyYW1zKSYmbWVyZ2VfbW9kZT09PXVuZGVmaW5lZCl7bWVyZ2VfbW9kZT0yO30KdmFyIGhhc19hcmdzPXBhcmFtcyE9PXVuZGVmaW5lZCx1cmw9anFfcGFyYW1fZnJhZ21lbnQobG9jYXRpb24uaHJlZixoYXNfYXJncz9wYXJhbXM6e30saGFzX2FyZ3M/bWVyZ2VfbW9kZToyKTtsb2NhdGlvbi5ocmVmPXVybDt9O2pxX2JicS5nZXRTdGF0ZT1qcV9iYnFfZ2V0U3RhdGU9ZnVuY3Rpb24oa2V5LGNvZXJjZSl7cmV0dXJuIGtleT09PXVuZGVmaW5lZHx8dHlwZW9mIGtleT09PSdib29sZWFuJz9qcV9kZXBhcmFtX2ZyYWdtZW50KGtleSk6anFfZGVwYXJhbV9mcmFnbWVudChjb2VyY2UpW2tleV07fTtqcV9iYnEucmVtb3ZlU3RhdGU9ZnVuY3Rpb24oYXJyKXt2YXIgc3RhdGU9e307aWYoYXJyIT09dW5kZWZpbmVkKXtzdGF0ZT1qcV9iYnFfZ2V0U3RhdGUoKTskLmVhY2goJC5pc0FycmF5KGFycik/YXJyOmFyZ3VtZW50cyxmdW5jdGlvbihpLHYpe2RlbGV0ZSBzdGF0ZVt2XTt9KTt9CmpxX2JicV9wdXNoU3RhdGUoc3RhdGUsMik7fTtzcGVjaWFsW3N0cl9oYXNoY2hhbmdlXT0kLmV4dGVuZChzcGVjaWFsW3N0cl9oYXNoY2hhbmdlXSx7YWRkOmZ1bmN0aW9uKGhhbmRsZU9iail7dmFyIG9sZF9oYW5kbGVyO2Z1bmN0aW9uIG5ld19oYW5kbGVyKGUpe3ZhciBoYXNoPWVbc3RyX2ZyYWdtZW50XT1qcV9wYXJhbV9mcmFnbWVudCgpO2UuZ2V0U3RhdGU9ZnVuY3Rpb24oa2V5LGNvZXJjZSl7cmV0dXJuIGtleT09PXVuZGVmaW5lZHx8dHlwZW9mIGtleT09PSdib29sZWFuJz9qcV9kZXBhcmFtKGhhc2gsa2V5KTpqcV9kZXBhcmFtKGhhc2gsY29lcmNlKVtrZXldO307b2xkX2hhbmRsZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO307aWYoJC5pc0Z1bmN0aW9uKGhhbmRsZU9iaikpe29sZF9oYW5kbGVyPWhhbmRsZU9iajtyZXR1cm4gbmV3X2hhbmRsZXI7fWVsc2V7b2xkX2hhbmRsZXI9aGFuZGxlT2JqLmhhbmRsZXI7aGFuZGxlT2JqLmhhbmRsZXI9bmV3X2hhbmRsZXI7fX19KTt9KShqUXVlcnksdGhpcyk7KGZ1bmN0aW9uKCQsd2luZG93LHVuZGVmaW5lZCl7JyQ6bm9tdW5nZSc7dmFyIHN0cl9oYXNoY2hhbmdlPSdoYXNoY2hhbmdlJyxkb2M9ZG9jdW1lbnQsZmFrZV9vbmhhc2hjaGFuZ2Usc3BlY2lhbD0kLmV2ZW50LnNwZWNpYWwsZG9jX21vZGU9ZG9jLmRvY3VtZW50TW9kZSxzdXBwb3J0c19vbmhhc2hjaGFuZ2U9J29uJytzdHJfaGFzaGNoYW5nZSBpbiB3aW5kb3cmJihkb2NfbW9kZT09PXVuZGVmaW5lZHx8ZG9jX21vZGU+Nyk7ZnVuY3Rpb24gZ2V0X2ZyYWdtZW50KHVybCl7dXJsPXVybHx8bG9jYXRpb24uaHJlZjtyZXR1cm4nIycrdXJsLnJlcGxhY2UoL15bXiNdKiM/KC4qKSQvLCckMScpO307JC5mbltzdHJfaGFzaGNoYW5nZV09ZnVuY3Rpb24oZm4pe3JldHVybiBmbj90aGlzLmJpbmQoc3RyX2hhc2hjaGFuZ2UsZm4pOnRoaXMudHJpZ2dlcihzdHJfaGFzaGNoYW5nZSk7fTskLmZuW3N0cl9oYXNoY2hhbmdlXS5kZWxheT01MDtzcGVjaWFsW3N0cl9oYXNoY2hhbmdlXT0kLmV4dGVuZChzcGVjaWFsW3N0cl9oYXNoY2hhbmdlXSx7c2V0dXA6ZnVuY3Rpb24oKXtpZihzdXBwb3J0c19vbmhhc2hjaGFuZ2Upe3JldHVybiBmYWxzZTt9CiQoZmFrZV9vbmhhc2hjaGFuZ2Uuc3RhcnQpO30sdGVhcmRvd246ZnVuY3Rpb24oKXtpZihzdXBwb3J0c19vbmhhc2hjaGFuZ2Upe3JldHVybiBmYWxzZTt9CiQoZmFrZV9vbmhhc2hjaGFuZ2Uuc3RvcCk7fX0pO2Zha2Vfb25oYXNoY2hhbmdlPShmdW5jdGlvbigpe3ZhciBzZWxmPXt9LHRpbWVvdXRfaWQsbGFzdF9oYXNoPWdldF9mcmFnbWVudCgpLGZuX3JldHZhbD1mdW5jdGlvbih2YWwpe3JldHVybiB2YWw7fSxoaXN0b3J5X3NldD1mbl9yZXR2YWwsaGlzdG9yeV9nZXQ9Zm5fcmV0dmFsO3NlbGYuc3RhcnQ9ZnVuY3Rpb24oKXt0aW1lb3V0X2lkfHxwb2xsKCk7fTtzZWxmLnN0b3A9ZnVuY3Rpb24oKXt0aW1lb3V0X2lkJiZjbGVhclRpbWVvdXQodGltZW91dF9pZCk7dGltZW91dF9pZD11bmRlZmluZWQ7fTtmdW5jdGlvbiBwb2xsKCl7dmFyIGhhc2g9Z2V0X2ZyYWdtZW50KCksaGlzdG9yeV9oYXNoPWhpc3RvcnlfZ2V0KGxhc3RfaGFzaCk7aWYoaGFzaCE9PWxhc3RfaGFzaCl7aGlzdG9yeV9zZXQobGFzdF9oYXNoPWhhc2gsaGlzdG9yeV9oYXNoKTskKHdpbmRvdykudHJpZ2dlcihzdHJfaGFzaGNoYW5nZSk7fWVsc2UgaWYoaGlzdG9yeV9oYXNoIT09bGFzdF9oYXNoKXtsb2NhdGlvbi5ocmVmPWxvY2F0aW9uLmhyZWYucmVwbGFjZSgvIy4qLywnJykraGlzdG9yeV9oYXNoO30KdGltZW91dF9pZD1zZXRUaW1lb3V0KHBvbGwsJC5mbltzdHJfaGFzaGNoYW5nZV0uZGVsYXkpO307JC5icm93c2VyLm1zaWUmJiFzdXBwb3J0c19vbmhhc2hjaGFuZ2UmJihmdW5jdGlvbigpe3ZhciBpZnJhbWUsaWZyYW1lX3NyYztzZWxmLnN0YXJ0PWZ1bmN0aW9uKCl7aWYoIWlmcmFtZSl7aWZyYW1lX3NyYz0kLmZuW3N0cl9oYXNoY2hhbmdlXS5zcmM7aWZyYW1lX3NyYz1pZnJhbWVfc3JjJiZpZnJhbWVfc3JjK2dldF9mcmFnbWVudCgpO2lmcmFtZT0kKCc8aWZyYW1lIHRhYmluZGV4PSItMSIgdGl0bGU9ImVtcHR5Ii8+JykuaGlkZSgpLm9uZSgnbG9hZCcsZnVuY3Rpb24oKXtpZnJhbWVfc3JjfHxoaXN0b3J5X3NldChnZXRfZnJhZ21lbnQoKSk7cG9sbCgpO30pLmF0dHIoJ3NyYycsaWZyYW1lX3NyY3x8J2phdmFzY3JpcHQ6MCcpLmluc2VydEFmdGVyKCdib2R5JylbMF0uY29udGVudFdpbmRvdztkb2Mub25wcm9wZXJ0eWNoYW5nZT1mdW5jdGlvbigpe3RyeXtpZihldmVudC5wcm9wZXJ0eU5hbWU9PT0ndGl0bGUnKXtpZnJhbWUuZG9jdW1lbnQudGl0bGU9ZG9jLnRpdGxlO319Y2F0Y2goZSl7fX07fX07c2VsZi5zdG9wPWZuX3JldHZhbDtoaXN0b3J5X2dldD1mdW5jdGlvbigpe3JldHVybiBnZXRfZnJhZ21lbnQoaWZyYW1lLmxvY2F0aW9uLmhyZWYpO307aGlzdG9yeV9zZXQ9ZnVuY3Rpb24oaGFzaCxoaXN0b3J5X2hhc2gpe3ZhciBpZnJhbWVfZG9jPWlmcmFtZS5kb2N1bWVudCxkb21haW49JC5mbltzdHJfaGFzaGNoYW5nZV0uZG9tYWluO2lmKGhhc2ghPT1oaXN0b3J5X2hhc2gpe2lmcmFtZV9kb2MudGl0bGU9ZG9jLnRpdGxlO2lmcmFtZV9kb2Mub3BlbigpO2RvbWFpbiYmaWZyYW1lX2RvYy53cml0ZSgnPHNjcmlwdD5kb2N1bWVudC5kb21haW49IicrZG9tYWluKyciPC9zY3JpcHQ+Jyk7aWZyYW1lX2RvYy5jbG9zZSgpO2lmcmFtZS5sb2NhdGlvbi5oYXNoPWhhc2g7fX07fSkoKTtyZXR1cm4gc2VsZjt9KSgpO30pKGpRdWVyeSx0aGlzKTs7CgovKiAvd2ViL3N0YXRpYy9zcmMvanMvY29yZS9kb21haW4uanMgZGVmaW5lZCBpbiBidW5kbGUgJ3dlYi5hc3NldHNfYmFja2VuZCcgKi8Kb2Rvby5kZWZpbmUoIndlYi5Eb21haW4iLGZ1bmN0aW9uKHJlcXVpcmUpeyJ1c2Ugc3RyaWN0Ijt2YXIgY29sbGVjdGlvbnM9cmVxdWlyZSgid2ViLmNvbGxlY3Rpb25zIik7dmFyIHB5VXRpbHM9cmVxdWlyZSgid2ViLnB5X3V0aWxzIik7dmFyIHB5PXdpbmRvdy5weTt2YXIgRG9tYWluPWNvbGxlY3Rpb25zLlRyZWUuZXh0ZW5kKHtpbml0OmZ1bmN0aW9uKGRvbWFpbixldmFsQ29udGV4dCl7dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO2lmKF8uaXNBcnJheShkb21haW4pfHxfLmlzU3RyaW5nKGRvbWFpbikpe3RoaXMuX3BhcnNlKHRoaXMubm9ybWFsaXplQXJyYXkoXy5jbG9uZSh0aGlzLnN0cmluZ1RvQXJyYXkoZG9tYWluLGV2YWxDb250ZXh0KSkpKTt9ZWxzZXt0aGlzLl9kYXRhPSEhZG9tYWluO319LGNvbXB1dGU6ZnVuY3Rpb24odmFsdWVzKXtpZih0aGlzLl9kYXRhPT09dHJ1ZXx8dGhpcy5fZGF0YT09PWZhbHNlKXtyZXR1cm4gdGhpcy5fZGF0YTt9ZWxzZSBpZihfLmlzQXJyYXkodGhpcy5fZGF0YSkpe3ZhciBpc1BhcmVudEZpZWxkPWZhbHNlO3ZhciBmaWVsZE5hbWU9dGhpcy5fZGF0YVswXTt2YXIgcGFyZW50RmllbGQ9dGhpcy5fZGF0YVswXS5zcGxpdCgnLicpO2lmKCdwYXJlbnQnaW4gdmFsdWVzJiZwYXJlbnRGaWVsZC5sZW5ndGg9PT0yKXtmaWVsZE5hbWU9cGFyZW50RmllbGRbMV07aXNQYXJlbnRGaWVsZD1wYXJlbnRGaWVsZFswXT09PSdwYXJlbnQnJiZmaWVsZE5hbWUgaW4gdmFsdWVzLnBhcmVudDt9CmlmKCEodGhpcy5fZGF0YVswXWluIHZhbHVlcykmJiEoaXNQYXJlbnRGaWVsZCkpe3Rocm93IG5ldyBFcnJvcihfLnN0ci5zcHJpbnRmKCJVbmtub3duIGZpZWxkICVzIGluIGRvbWFpbiIsdGhpcy5fZGF0YVswXSkpO30KdmFyIGZpZWxkVmFsdWU7aWYoIWlzUGFyZW50RmllbGQpe2ZpZWxkVmFsdWU9dmFsdWVzW2ZpZWxkTmFtZV07fWVsc2V7ZmllbGRWYWx1ZT12YWx1ZXMucGFyZW50W2ZpZWxkTmFtZV07fQpzd2l0Y2godGhpcy5fZGF0YVsxXSl7Y2FzZSI9IjpjYXNlIj09IjpyZXR1cm4gXy5pc0VxdWFsKGZpZWxkVmFsdWUsdGhpcy5fZGF0YVsyXSk7Y2FzZSIhPSI6Y2FzZSI8PiI6cmV0dXJuIV8uaXNFcXVhbChmaWVsZFZhbHVlLHRoaXMuX2RhdGFbMl0pO2Nhc2UiPCI6cmV0dXJuKGZpZWxkVmFsdWU8dGhpcy5fZGF0YVsyXSk7Y2FzZSI+IjpyZXR1cm4oZmllbGRWYWx1ZT50aGlzLl9kYXRhWzJdKTtjYXNlIjw9IjpyZXR1cm4oZmllbGRWYWx1ZTw9dGhpcy5fZGF0YVsyXSk7Y2FzZSI+PSI6cmV0dXJuKGZpZWxkVmFsdWU+PXRoaXMuX2RhdGFbMl0pO2Nhc2UiaW4iOnJldHVybiBfLmNvbnRhaW5zKF8uaXNBcnJheSh0aGlzLl9kYXRhWzJdKT90aGlzLl9kYXRhWzJdOlt0aGlzLl9kYXRhWzJdXSxmaWVsZFZhbHVlKTtjYXNlIm5vdCBpbiI6cmV0dXJuIV8uY29udGFpbnMoXy5pc0FycmF5KHRoaXMuX2RhdGFbMl0pP3RoaXMuX2RhdGFbMl06W3RoaXMuX2RhdGFbMl1dLGZpZWxkVmFsdWUpO2Nhc2UibGlrZSI6cmV0dXJuKGZpZWxkVmFsdWUudG9Mb3dlckNhc2UoKS5pbmRleE9mKHRoaXMuX2RhdGFbMl0udG9Mb3dlckNhc2UoKSk+PTApO2Nhc2UiPWxpa2UiOnZhciByZWdFeHA9bmV3IFJlZ0V4cCh0aGlzLl9kYXRhWzJdLnRvTG93ZXJDYXNlKCkucmVwbGFjZSgvKFsuXFtcXVx7XH1cK1wqXSkvZywnXFxcJDEnKS5yZXBsYWNlKC8lL2csJy4qJykpO3JldHVybiByZWdFeHAudGVzdChmaWVsZFZhbHVlLnRvTG93ZXJDYXNlKCkpO2Nhc2UiaWxpa2UiOnJldHVybihmaWVsZFZhbHVlLmluZGV4T2YodGhpcy5fZGF0YVsyXSk+PTApO2Nhc2UiPWlsaWtlIjpyZXR1cm4gbmV3IFJlZ0V4cCh0aGlzLl9kYXRhWzJdLnJlcGxhY2UoLyUvZywnLionKSwnaScpLnRlc3QoZmllbGRWYWx1ZSk7ZGVmYXVsdDp0aHJvdyBuZXcgRXJyb3IoXy5zdHIuc3ByaW50ZigiRG9tYWluICVzIHVzZXMgYW4gdW5zdXBwb3J0ZWQgb3BlcmF0b3IiLHRoaXMuX2RhdGEpKTt9fWVsc2V7c3dpdGNoKHRoaXMuX2RhdGEpe2Nhc2UiJiI6cmV0dXJuIF8uZXZlcnkodGhpcy5fY2hpbGRyZW4sZnVuY3Rpb24oY2hpbGQpe3JldHVybiBjaGlsZC5jb21wdXRlKHZhbHVlcyk7fSk7Y2FzZSJ8IjpyZXR1cm4gXy5zb21lKHRoaXMuX2NoaWxkcmVuLGZ1bmN0aW9uKGNoaWxkKXtyZXR1cm4gY2hpbGQuY29tcHV0ZSh2YWx1ZXMpO30pO2Nhc2UiISI6cmV0dXJuIXRoaXMuX2NoaWxkcmVuWzBdLmNvbXB1dGUodmFsdWVzKTt9fX0sdG9BcnJheTpmdW5jdGlvbigpe2lmKHRoaXMuX2RhdGE9PT1mYWxzZSl7dGhyb3cgbmV3IEVycm9yKCInZmFsc2UnIGRvbWFpbiBjYW5ub3QgYmUgY29udmVydGVkIHRvIGFycmF5Iik7fWVsc2UgaWYodGhpcy5fZGF0YT09PXRydWUpe3JldHVybltdO31lbHNle3ZhciBhcnI9W3RoaXMuX2RhdGFdO3JldHVybiBhcnIuY29uY2F0LmFwcGx5KGFycixfLm1hcCh0aGlzLl9jaGlsZHJlbixmdW5jdGlvbihjaGlsZCl7cmV0dXJuIGNoaWxkLnRvQXJyYXkoKTt9KSk7fX0sdG9TdHJpbmc6ZnVuY3Rpb24oKXtyZXR1cm4gRG9tYWluLnByb3RvdHlwZS5hcnJheVRvU3RyaW5nKHRoaXMudG9BcnJheSgpKTt9LF9wYXJzZTpmdW5jdGlvbihkb21haW4pe3RoaXMuX2RhdGE9KGRvbWFpbi5sZW5ndGg9PT0wP3RydWU6ZG9tYWluWzBdKTtpZihkb21haW4ubGVuZ3RoPD0xKXJldHVybjt2YXIgZXhwZWN0ZWQ9MTtmb3IodmFyIGk9MTtpPGRvbWFpbi5sZW5ndGg7aSsrKXtpZihkb21haW5baV09PT0iJiJ8fGRvbWFpbltpXT09PSJ8Iil7ZXhwZWN0ZWQrKzt9ZWxzZSBpZihkb21haW5baV0hPT0iISIpe2V4cGVjdGVkLS07fQppZighZXhwZWN0ZWQpe2krKzt0aGlzLl9hZGRTdWJkb21haW4oZG9tYWluLnNsaWNlKDEsaSkpO3RoaXMuX2FkZFN1YmRvbWFpbihkb21haW4uc2xpY2UoaSkpO2JyZWFrO319fSxfYWRkU3ViZG9tYWluOmZ1bmN0aW9uKGRvbWFpbil7aWYoIWRvbWFpbi5sZW5ndGgpcmV0dXJuO3ZhciBzdWJkb21haW49bmV3IERvbWFpbihkb21haW4pO2lmKCFzdWJkb21haW4uX2NoaWxkcmVuLmxlbmd0aHx8c3ViZG9tYWluLl9kYXRhIT09dGhpcy5fZGF0YSl7dGhpcy5fY2hpbGRyZW4ucHVzaChzdWJkb21haW4pO31lbHNle3ZhciBzZWxmPXRoaXM7Xy5lYWNoKHN1YmRvbWFpbi5fY2hpbGRyZW4sZnVuY3Rpb24oY2hpbGREb21haW4pe3NlbGYuX2NoaWxkcmVuLnB1c2goY2hpbGREb21haW4pO30pO319LGFycmF5VG9TdHJpbmc6ZnVuY3Rpb24oZG9tYWluKXtpZihfLmlzU3RyaW5nKGRvbWFpbikpcmV0dXJuIGRvbWFpbjtyZXR1cm4gSlNPTi5zdHJpbmdpZnkoZG9tYWlufHxbXSkucmVwbGFjZSgvbnVsbC9nLCJOb25lIikucmVwbGFjZSgvZmFsc2UvZywiRmFsc2UiKS5yZXBsYWNlKC90cnVlL2csIlRydWUiKTt9LGNvbnN0cnVjdERvbWFpbjpmdW5jdGlvbihmaWVsZE5hbWUscGVyaW9kLHR5cGUsY29tcGFyaXNvblBlcmlvZCl7dmFyIGxlZnRCb3VuZGFyeVBhcmFtcyxyaWdodEJvdW5kYXJ5UGFyYW1zO3ZhciBvZmZzZXRQZXJpb2RQYXJhbXM7ZnVuY3Rpb24gbWFrZUludGVydmFsKCl7c3dpdGNoKGNvbXBhcmlzb25QZXJpb2Qpe2Nhc2UncHJldmlvdXNfcGVyaW9kJzpfLmVhY2gob2Zmc2V0UGVyaW9kUGFyYW1zLGZ1bmN0aW9uKHZhbHVlLGtleSl7aWYoIWxlZnRCb3VuZGFyeVBhcmFtc1trZXldfHxfLmlzTnVtYmVyKGxlZnRCb3VuZGFyeVBhcmFtc1trZXldKSl7bGVmdEJvdW5kYXJ5UGFyYW1zW2tleV09dmFsdWUrKGxlZnRCb3VuZGFyeVBhcmFtc1trZXldfHwwKTt9ZWxzZXtsZWZ0Qm91bmRhcnlQYXJhbXNba2V5XT12YWx1ZSsnICsgJytsZWZ0Qm91bmRhcnlQYXJhbXNba2V5XTt9CmlmKCFyaWdodEJvdW5kYXJ5UGFyYW1zW2tleV18fF8uaXNOdW1iZXIocmlnaHRCb3VuZGFyeVBhcmFtc1trZXldKSl7cmlnaHRCb3VuZGFyeVBhcmFtc1trZXldPXZhbHVlKyhyaWdodEJvdW5kYXJ5UGFyYW1zW2tleV18fDApO31lbHNle3JpZ2h0Qm91bmRhcnlQYXJhbXNba2V5XT12YWx1ZSsnICsgJytyaWdodEJvdW5kYXJ5UGFyYW1zW2tleV07fX0pO2JyZWFrO2Nhc2UncHJldmlvdXNfeWVhcic6bGVmdEJvdW5kYXJ5UGFyYW1zLnllYXJzPWxlZnRCb3VuZGFyeVBhcmFtcy55ZWFycz9sZWZ0Qm91bmRhcnlQYXJhbXMueWVhcnMtMTotMTtyaWdodEJvdW5kYXJ5UGFyYW1zLnllYXJzPXJpZ2h0Qm91bmRhcnlQYXJhbXMueWVhcnM/cmlnaHRCb3VuZGFyeVBhcmFtcy55ZWFycy0xOi0xO2JyZWFrO30KdmFyIHN0cmluZ2lmeVBhcmFtcz1mdW5jdGlvbih2YWx1ZSxrZXkpe3JldHVybiBrZXkrJz0nK3ZhbHVlO307dmFyIGxlZnRCb3VuZGFyeVN0cmluZ2lmeVBhcmFtcz1fLm1hcChsZWZ0Qm91bmRhcnlQYXJhbXMsc3RyaW5naWZ5UGFyYW1zKS5qb2luKCcsICcpO3ZhciByaWdodEJvdW5kYXJ5U3RyaW5naWZ5UGFyYW1zPV8ubWFwKHJpZ2h0Qm91bmRhcnlQYXJhbXMsc3RyaW5naWZ5UGFyYW1zKS5qb2luKCcsICcpO2lmKHR5cGU9PT0nZGF0ZScpe3JldHVybiJbJyYnLCIrIignIitmaWVsZE5hbWUrIicsICc+PScsIChjb250ZXh0X3RvZGF5KCkgKyByZWxhdGl2ZWRlbHRhKCIrbGVmdEJvdW5kYXJ5U3RyaW5naWZ5UGFyYW1zKyIpKS5zdHJmdGltZSgnJVktJW0tJWQnKSksIisiKCciK2ZpZWxkTmFtZSsiJywgJzwnLCAoY29udGV4dF90b2RheSgpICsgcmVsYXRpdmVkZWx0YSgiK3JpZ2h0Qm91bmRhcnlTdHJpbmdpZnlQYXJhbXMrIikpLnN0cmZ0aW1lKCclWS0lbS0lZCcpKSIrIl0iO30KZWxzZXtyZXR1cm4iWycmJywiKyIoJyIrZmllbGROYW1lKyInLCAnPj0nLCAiKyIoZGF0ZXRpbWUuZGF0ZXRpbWUuY29tYmluZShjb250ZXh0X3RvZGF5KCkgKyByZWxhdGl2ZWRlbHRhKCIrbGVmdEJvdW5kYXJ5U3RyaW5naWZ5UGFyYW1zKyIpLCBkYXRldGltZS50aW1lKDAsMCwwKSkudG9fdXRjKCkpLnN0cmZ0aW1lKCclWS0lbS0lZCAlSDolTTolUycpKSwiKyIoJyIrZmllbGROYW1lKyInLCAnPCcsICIrIihkYXRldGltZS5kYXRldGltZS5jb21iaW5lKGNvbnRleHRfdG9kYXkoKSArIHJlbGF0aXZlZGVsdGEoIityaWdodEJvdW5kYXJ5U3RyaW5naWZ5UGFyYW1zKyIpLCBkYXRldGltZS50aW1lKDAsMCwwKSkudG9fdXRjKCkpLnN0cmZ0aW1lKCclWS0lbS0lZCAlSDolTTolUycpKSIrIl0iO319CnN3aXRjaChwZXJpb2Qpe2Nhc2UndG9kYXknOmxlZnRCb3VuZGFyeVBhcmFtcz17fTtyaWdodEJvdW5kYXJ5UGFyYW1zPXtkYXlzOjF9O29mZnNldFBlcmlvZFBhcmFtcz17ZGF5czotMX07cmV0dXJuIG1ha2VJbnRlcnZhbCgpO2Nhc2UndGhpc193ZWVrJzpsZWZ0Qm91bmRhcnlQYXJhbXM9e3dlZWtzOi0xLGRheXM6MSx3ZWVrZGF5OjB9O3JpZ2h0Qm91bmRhcnlQYXJhbXM9e2RheXM6MSx3ZWVrZGF5OjB9O29mZnNldFBlcmlvZFBhcmFtcz17d2Vla3M6LTF9O3JldHVybiBtYWtlSW50ZXJ2YWwoKTtjYXNlJ3RoaXNfbW9udGgnOmxlZnRCb3VuZGFyeVBhcmFtcz17ZGF5OjF9O3JpZ2h0Qm91bmRhcnlQYXJhbXM9e2RheToxLG1vbnRoczoxfTtvZmZzZXRQZXJpb2RQYXJhbXM9e21vbnRoczotMX07cmV0dXJuIG1ha2VJbnRlcnZhbCgpO2Nhc2UndGhpc19xdWFydGVyJzpsZWZ0Qm91bmRhcnlQYXJhbXM9e21vbnRoczonLSAoY29udGV4dF90b2RheSgpLm1vbnRoIC0gMSkgJSAzJyxkYXk6MX07cmlnaHRCb3VuZGFyeVBhcmFtcz17bW9udGhzOiczIC0gKGNvbnRleHRfdG9kYXkoKS5tb250aCAtIDEpICUgMycsZGF5OjF9O29mZnNldFBlcmlvZFBhcmFtcz17bW9udGhzOi0zfTtyZXR1cm4gbWFrZUludGVydmFsKCk7Y2FzZSd0aGlzX3llYXInOmxlZnRCb3VuZGFyeVBhcmFtcz17bW9udGg6MSxkYXk6MX07cmlnaHRCb3VuZGFyeVBhcmFtcz17bW9udGg6MSxkYXk6MSx5ZWFyczoxfTtvZmZzZXRQZXJpb2RQYXJhbXM9e3llYXJzOi0xfTtyZXR1cm4gbWFrZUludGVydmFsKCk7Y2FzZSd5ZXN0ZXJkYXknOmxlZnRCb3VuZGFyeVBhcmFtcz17ZGF5czotMX07cmlnaHRCb3VuZGFyeVBhcmFtcz17fTtvZmZzZXRQZXJpb2RQYXJhbXM9e2RheXM6LTF9O3JldHVybiBtYWtlSW50ZXJ2YWwoKTtjYXNlJ2xhc3Rfd2Vlayc6bGVmdEJvdW5kYXJ5UGFyYW1zPXt3ZWVrczotMixkYXlzOjEsd2Vla2RheTowfTtyaWdodEJvdW5kYXJ5UGFyYW1zPXt3ZWVrczotMSxkYXlzOjEsd2Vla2RheTowfTtvZmZzZXRQZXJpb2RQYXJhbXM9e3dlZWtzOi0xfTtyZXR1cm4gbWFrZUludGVydmFsKCk7Y2FzZSdsYXN0X21vbnRoJzpsZWZ0Qm91bmRhcnlQYXJhbXM9e21vbnRoczotMSxkYXk6MX07cmlnaHRCb3VuZGFyeVBhcmFtcz17ZGF5OjF9O29mZnNldFBlcmlvZFBhcmFtcz17bW9udGhzOi0xfTtyZXR1cm4gbWFrZUludGVydmFsKCk7Y2FzZSdsYXN0X3F1YXJ0ZXInOmxlZnRCb3VuZGFyeVBhcmFtcz17bW9udGhzOictIDMgLSAoY29udGV4dF90b2RheSgpLm1vbnRoIC0gMSkgJSAzJyxkYXk6MX07cmlnaHRCb3VuZGFyeVBhcmFtcz17bW9udGhzOictIChjb250ZXh0X3RvZGF5KCkubW9udGggLSAxKSAlIDMnLGRheToxfTtvZmZzZXRQZXJpb2RQYXJhbXM9e21vbnRoczotM307cmV0dXJuIG1ha2VJbnRlcnZhbCgpO2Nhc2UnbGFzdF95ZWFyJzpsZWZ0Qm91bmRhcnlQYXJhbXM9e21vbnRoOjEsZGF5OjEseWVhcnM6LTF9O3JpZ2h0Qm91bmRhcnlQYXJhbXM9e21vbnRoOjEsZGF5OjF9O29mZnNldFBlcmlvZFBhcmFtcz17eWVhcnM6LTF9O3JldHVybiBtYWtlSW50ZXJ2YWwoKTtjYXNlJ2xhc3RfN19kYXlzJzpsZWZ0Qm91bmRhcnlQYXJhbXM9e2RheXM6LTd9O3JpZ2h0Qm91bmRhcnlQYXJhbXM9e307b2Zmc2V0UGVyaW9kUGFyYW1zPXtkYXlzOi03fTtyZXR1cm4gbWFrZUludGVydmFsKCk7Y2FzZSdsYXN0XzMwX2RheXMnOmxlZnRCb3VuZGFyeVBhcmFtcz17ZGF5czotMzB9O3JpZ2h0Qm91bmRhcnlQYXJhbXM9e307b2Zmc2V0UGVyaW9kUGFyYW1zPXtkYXlzOi0zMH07cmV0dXJuIG1ha2VJbnRlcnZhbCgpO2Nhc2UnbGFzdF8zNjVfZGF5cyc6bGVmdEJvdW5kYXJ5UGFyYW1zPXtkYXlzOi0zNjV9O3JpZ2h0Qm91bmRhcnlQYXJhbXM9e307b2Zmc2V0UGVyaW9kUGFyYW1zPXtkYXlzOi0zNjV9O3JldHVybiBtYWtlSW50ZXJ2YWwoKTtjYXNlJ2xhc3RfNV95ZWFycyc6bGVmdEJvdW5kYXJ5UGFyYW1zPXt5ZWFyczotNX07cmlnaHRCb3VuZGFyeVBhcmFtcz17fTtvZmZzZXRQZXJpb2RQYXJhbXM9e3llYXJzOi01fTtyZXR1cm4gbWFrZUludGVydmFsKCk7fX0sc3RyaW5nVG9BcnJheTpmdW5jdGlvbihkb21haW4sZXZhbENvbnRleHQpe2lmKCFfLmlzU3RyaW5nKGRvbWFpbikpcmV0dXJuIF8uY2xvbmUoZG9tYWluKTtyZXR1cm4gcHlVdGlscy5ldmFsKCJkb21haW4iLGRvbWFpbj9kb21haW4ucmVwbGFjZSgvJSUvZywnJScpOiJbXSIsZXZhbENvbnRleHQpO30sbm9ybWFsaXplQXJyYXk6ZnVuY3Rpb24oZG9tYWluKXt2YXIgZXhwZWN0ZWQ9MTtfLmVhY2goZG9tYWluLGZ1bmN0aW9uKGl0ZW0pe2lmKGl0ZW09PT0iJiJ8fGl0ZW09PT0ifCIpe2V4cGVjdGVkKys7fWVsc2UgaWYoaXRlbSE9PSIhIil7ZXhwZWN0ZWQtLTt9fSk7aWYoZXhwZWN0ZWQ8MCl7ZG9tYWluLnVuc2hpZnQuYXBwbHkoZG9tYWluLF8udGltZXMoTWF0aC5hYnMoZXhwZWN0ZWQpLF8uY29uc3RhbnQoIiYiKSkpO30KcmV0dXJuIGRvbWFpbjt9LGRvbWFpblRvQ29uZGl0aW9uOmZ1bmN0aW9uKGRvbWFpbil7aWYoIWRvbWFpbi5sZW5ndGgpe3JldHVybidUcnVlJzt9CnZhciBzZWxmPXRoaXM7ZnVuY3Rpb24gY29uc3VtZShzdGFjayl7dmFyIGxlbj1zdGFjay5sZW5ndGg7aWYobGVuPD0xKXtyZXR1cm4gc3RhY2s7fWVsc2UgaWYoc3RhY2tbbGVuLTFdPT09J3wnfHxzdGFja1tsZW4tMV09PT0nJid8fHN0YWNrW2xlbi0yXT09PSd8J3x8c3RhY2tbbGVuLTJdPT09JyYnKXtyZXR1cm4gc3RhY2s7fWVsc2UgaWYobGVuPT0yKXtzdGFjay5zcGxpY2UoLTIsMixzdGFja1tsZW4tMl0rJyBhbmQgJytzdGFja1tsZW4tMV0pO31lbHNlIGlmKHN0YWNrW2xlbi0zXT09J3wnKXtpZihsZW49PT0zKXtzdGFjay5zcGxpY2UoLTMsMyxzdGFja1tsZW4tMl0rJyBvciAnK3N0YWNrW2xlbi0xXSk7fWVsc2V7c3RhY2suc3BsaWNlKC0zLDMsJygnK3N0YWNrW2xlbi0yXSsnIG9yICcrc3RhY2tbbGVuLTFdKycpJyk7fX1lbHNle3N0YWNrLnNwbGljZSgtMywzLHN0YWNrW2xlbi0yXSsnIGFuZCAnK3N0YWNrW2xlbi0xXSk7fQpjb25zdW1lKHN0YWNrKTt9CnZhciBzdGFjaz1bXTtfLmVhY2goZG9tYWluLGZ1bmN0aW9uKGRvbSl7aWYoZG9tPT09J3wnfHxkb209PT0nJicpe3N0YWNrLnB1c2goZG9tKTt9ZWxzZXt2YXIgb3BlcmF0b3I9ZG9tWzFdPT09Jz0nPyc9PSc6ZG9tWzFdO2lmKCFvcGVyYXRvcil7dGhyb3cgbmV3IEVycm9yKCdXcm9uZyBvcGVyYXRvciBmb3IgdGhpcyBkb21haW4nKTt9CmlmKG9wZXJhdG9yPT09JyE9JyYmZG9tWzJdPT09ZmFsc2Upe3N0YWNrLnB1c2goZG9tWzBdKTt9ZWxzZSBpZihkb21bMl09PT1udWxsfHxkb21bMl09PT10cnVlfHxkb21bMl09PT1mYWxzZSl7c3RhY2sucHVzaChkb21bMF0rJyAnKyhvcGVyYXRvcj09PSchPSc/J2lzIG5vdCAnOidpcyAnKSsoZG9tWzJdPT09bnVsbD8nTm9uZSc6KGRvbVsyXT8nVHJ1ZSc6J0ZhbHNlJykpKTt9ZWxzZXtzdGFjay5wdXNoKGRvbVswXSsnICcrb3BlcmF0b3IrJyAnK0pTT04uc3RyaW5naWZ5KGRvbVsyXSkpO30KY29uc3VtZShzdGFjayk7fX0pO2lmKHN0YWNrLmxlbmd0aCE9PTEpe3Rocm93IG5ldyBFcnJvcignV3JvbmcgZG9tYWluJyk7fQpyZXR1cm4gc3RhY2tbMF07fSxjb25kaXRpb25Ub0RvbWFpbjpmdW5jdGlvbihjb25kaXRpb24pe2lmKCFjb25kaXRpb258fGNvbmRpdGlvbi5tYXRjaCgvXlxzKihUcnVlKT9ccyokLykpe3JldHVybltdO30KdmFyIGFzdD1weS5wYXJzZShweS50b2tlbml6ZShjb25kaXRpb24pKTtmdW5jdGlvbiBhc3RUb1N0YWNrVmFsdWUobm9kZSl7c3dpdGNoKG5vZGUuaWQpe2Nhc2UnKG5hbWUpJzpyZXR1cm4gbm9kZS52YWx1ZTtjYXNlJy4nOnJldHVybiBhc3RUb1N0YWNrVmFsdWUobm9kZS5maXJzdCkrJy4nK2FzdFRvU3RhY2tWYWx1ZShub2RlLnNlY29uZCk7Y2FzZScoc3RyaW5nKSc6cmV0dXJuIG5vZGUudmFsdWU7Y2FzZScobnVtYmVyKSc6cmV0dXJuIG5vZGUudmFsdWU7Y2FzZScoY29uc3RhbnQpJzpyZXR1cm4gbm9kZS52YWx1ZT09PSdOb25lJz9udWxsOm5vZGUudmFsdWU9PT0nVHJ1ZSc/dHJ1ZTpmYWxzZTtjYXNlJ1snOnJldHVybiBfLm1hcChub2RlLmZpcnN0LGZ1bmN0aW9uKG5vZGUpe3JldHVybiBhc3RUb1N0YWNrVmFsdWUobm9kZSk7fSk7fX0KZnVuY3Rpb24gYXN0VG9TdGFjayhub2RlKXtzd2l0Y2gobm9kZS5pZCl7Y2FzZScobmFtZSknOnJldHVybltbYXN0VG9TdGFja1ZhbHVlKG5vZGUpLCchPScsZmFsc2VdXTtjYXNlJy4nOnJldHVybltbYXN0VG9TdGFja1ZhbHVlKG5vZGUuZmlyc3QpKycuJythc3RUb1N0YWNrVmFsdWUobm9kZS5zZWNvbmQpLCchPScsZmFsc2VdXTtjYXNlJ25vdCc6cmV0dXJuW1thc3RUb1N0YWNrVmFsdWUobm9kZS5maXJzdCksJz0nLGZhbHNlXV07Y2FzZSdvcic6cmV0dXJuWyd8J10uY29uY2F0KGFzdFRvU3RhY2sobm9kZS5maXJzdCkpLmNvbmNhdChhc3RUb1N0YWNrKG5vZGUuc2Vjb25kKSk7Y2FzZSdhbmQnOnJldHVyblsnJiddLmNvbmNhdChhc3RUb1N0YWNrKG5vZGUuZmlyc3QpKS5jb25jYXQoYXN0VG9TdGFjayhub2RlLnNlY29uZCkpO2Nhc2UnKGNvbXBhcmF0b3IpJzppZihub2RlLm9wZXJhdG9ycy5sZW5ndGghPT0xKXt0aHJvdyBuZXcgRXJyb3IoJ1dyb25nIGNvbmRpdGlvbiB0byBjb252ZXJ0IGluIGRvbWFpbicpO30KdmFyIHJpZ2h0PWFzdFRvU3RhY2tWYWx1ZShub2RlLmV4cHJlc3Npb25zWzBdKTt2YXIgbGVmdD1hc3RUb1N0YWNrVmFsdWUobm9kZS5leHByZXNzaW9uc1sxXSk7dmFyIG9wZXJhdG9yPW5vZGUub3BlcmF0b3JzWzBdO3N3aXRjaChvcGVyYXRvcil7Y2FzZSdpcyc6b3BlcmF0b3I9Jz0nO2JyZWFrO2Nhc2UnaXMgbm90JzpvcGVyYXRvcj0nIT0nO2JyZWFrO2Nhc2UnPT0nOm9wZXJhdG9yPSc9JzticmVhazt9CnJldHVybltbcmlnaHQsb3BlcmF0b3IsbGVmdF1dO2RlZmF1bHQ6dGhyb3ciQ29uZGl0aW9uIGNhbm5vdCBiZSB0cmFuc2Zvcm1lZCBpbnRvIGRvbWFpbiI7fX0KcmV0dXJuIGFzdFRvU3RhY2soYXN0KTt9LH0pO3JldHVybiBEb21haW47fSk7OwoKLyogL3dlYi9zdGF0aWMvc3JjL2pzL2NvcmUvbXZjLmpzIGRlZmluZWQgaW4gYnVuZGxlICd3ZWIuYXNzZXRzX2JhY2tlbmQnICovCm9kb28uZGVmaW5lKCd3ZWIubXZjJyxmdW5jdGlvbihyZXF1aXJlKXsidXNlIHN0cmljdCI7dmFyIGFqYXg9cmVxdWlyZSgnd2ViLmFqYXgnKTt2YXIgQ2xhc3M9cmVxdWlyZSgnd2ViLkNsYXNzJyk7dmFyIG1peGlucz1yZXF1aXJlKCd3ZWIubWl4aW5zJyk7dmFyIFNlcnZpY2VzTWl4aW49cmVxdWlyZSgnd2ViLlNlcnZpY2VzTWl4aW4nKTt2YXIgV2lkZ2V0PXJlcXVpcmUoJ3dlYi5XaWRnZXQnKTt2YXIgTW9kZWw9Q2xhc3MuZXh0ZW5kKG1peGlucy5FdmVudERpc3BhdGNoZXJNaXhpbixTZXJ2aWNlc01peGluLHtpbml0OmZ1bmN0aW9uKHBhcmVudCxwYXJhbXMpe21peGlucy5FdmVudERpc3BhdGNoZXJNaXhpbi5pbml0LmNhbGwodGhpcyk7dGhpcy5zZXRQYXJlbnQocGFyZW50KTt9LGdldDpmdW5jdGlvbigpe30sbG9hZDpmdW5jdGlvbigpe3JldHVybiBQcm9taXNlLnJlc29sdmUoKTt9LH0pO3ZhciBSZW5kZXJlcj1XaWRnZXQuZXh0ZW5kKHtpbml0OmZ1bmN0aW9uKHBhcmVudCxzdGF0ZSxwYXJhbXMpe3RoaXMuX3N1cGVyKHBhcmVudCk7dGhpcy5zdGF0ZT1zdGF0ZTt9LH0pO3ZhciBDb250cm9sbGVyPVdpZGdldC5leHRlbmQoe2luaXQ6ZnVuY3Rpb24ocGFyZW50LG1vZGVsLHJlbmRlcmVyLHBhcmFtcyl7dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3RoaXMubW9kZWw9bW9kZWw7dGhpcy5yZW5kZXJlcj1yZW5kZXJlcjt9LHN0YXJ0OmZ1bmN0aW9uKCl7cmV0dXJuIFByb21pc2UuYWxsKFt0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyksdGhpcy5fc3RhcnRSZW5kZXJlcigpXSk7fSxfc3RhcnRSZW5kZXJlcjpmdW5jdGlvbigpe3JldHVybiB0aGlzLnJlbmRlcmVyLmFwcGVuZFRvKHRoaXMuJGVsKTt9LH0pO3ZhciBGYWN0b3J5PUNsYXNzLmV4dGVuZCh7Y29uZmlnOntNb2RlbDpNb2RlbCxSZW5kZXJlcjpSZW5kZXJlcixDb250cm9sbGVyOkNvbnRyb2xsZXIsfSxpbml0OmZ1bmN0aW9uKCl7dGhpcy5yZW5kZXJlclBhcmFtcz17fTt0aGlzLmNvbnRyb2xsZXJQYXJhbXM9e307dGhpcy5tb2RlbFBhcmFtcz17fTt0aGlzLmxvYWRQYXJhbXM9e307fSxnZXRDb250cm9sbGVyOmZ1bmN0aW9uKHBhcmVudCl7dmFyIHNlbGY9dGhpczt2YXIgbW9kZWw9dGhpcy5nZXRNb2RlbChwYXJlbnQpO3JldHVybiBQcm9taXNlLmFsbChbdGhpcy5fbG9hZERhdGEobW9kZWwpLGFqYXgubG9hZExpYnModGhpcyldKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCl7dmFyIHN0YXRlPXJlc3VsdFswXTt2YXIgcmVuZGVyZXI9c2VsZi5nZXRSZW5kZXJlcihwYXJlbnQsc3RhdGUpO3ZhciBDb250cm9sbGVyPXNlbGYuQ29udHJvbGxlcnx8c2VsZi5jb25maWcuQ29udHJvbGxlcjt2YXIgY29udHJvbGxlclBhcmFtcz1fLmV4dGVuZCh7aW5pdGlhbFN0YXRlOnN0YXRlLH0sc2VsZi5jb250cm9sbGVyUGFyYW1zKTt2YXIgY29udHJvbGxlcj1uZXcgQ29udHJvbGxlcihwYXJlbnQsbW9kZWwscmVuZGVyZXIsY29udHJvbGxlclBhcmFtcyk7bW9kZWwuc2V0UGFyZW50KGNvbnRyb2xsZXIpO3JlbmRlcmVyLnNldFBhcmVudChjb250cm9sbGVyKTtyZXR1cm4gY29udHJvbGxlcjt9KTt9LGdldE1vZGVsOmZ1bmN0aW9uKHBhcmVudCl7dmFyIE1vZGVsPXRoaXMuY29uZmlnLk1vZGVsO3JldHVybiBuZXcgTW9kZWwocGFyZW50LHRoaXMubW9kZWxQYXJhbXMpO30sZ2V0UmVuZGVyZXI6ZnVuY3Rpb24ocGFyZW50LHN0YXRlKXt2YXIgUmVuZGVyZXI9dGhpcy5jb25maWcuUmVuZGVyZXI7cmV0dXJuIG5ldyBSZW5kZXJlcihwYXJlbnQsc3RhdGUsdGhpcy5yZW5kZXJlclBhcmFtcyk7fSxfbG9hZERhdGE6ZnVuY3Rpb24obW9kZWwpe3JldHVybiBtb2RlbC5sb2FkKHRoaXMubG9hZFBhcmFtcykudGhlbihmdW5jdGlvbigpe3JldHVybiBtb2RlbC5nZXQuYXBwbHkobW9kZWwsYXJndW1lbnRzKTt9KTt9LH0pO3JldHVybntGYWN0b3J5OkZhY3RvcnksTW9kZWw6TW9kZWwsUmVuZGVyZXI6UmVuZGVyZXIsQ29udHJvbGxlcjpDb250cm9sbGVyLH07fSk7OwoKLyogL3dlYi9zdGF0aWMvc3JjL2pzL2NvcmUvcHlfdXRpbHMuanMgZGVmaW5lZCBpbiBidW5kbGUgJ3dlYi5hc3NldHNfYmFja2VuZCcgKi8Kb2Rvby5kZWZpbmUoJ3dlYi5weV91dGlscycsZnVuY3Rpb24ocmVxdWlyZSl7InVzZSBzdHJpY3QiO3ZhciBjb3JlPXJlcXVpcmUoJ3dlYi5jb3JlJyk7dmFyIF90PWNvcmUuX3Q7dmFyIHB5PXdpbmRvdy5weTtmdW5jdGlvbiB3cmFwKHZhbHVlKXtpZih2YWx1ZT09PW51bGwpe3JldHVybiBweS5Ob25lO30Kc3dpdGNoKHR5cGVvZiB2YWx1ZSl7Y2FzZSd1bmRlZmluZWQnOnRocm93IG5ldyBFcnJvcigiTm8gY29udmVyc2lvbiBmb3IgdW5kZWZpbmVkIik7Y2FzZSdib29sZWFuJzpyZXR1cm4gcHkuYm9vbC5mcm9tSlNPTih2YWx1ZSk7Y2FzZSdudW1iZXInOnJldHVybiBweS5mbG9hdC5mcm9tSlNPTih2YWx1ZSk7Y2FzZSdzdHJpbmcnOnJldHVybiBweS5zdHIuZnJvbUpTT04odmFsdWUpO30Kc3dpdGNoKHZhbHVlLmNvbnN0cnVjdG9yKXtjYXNlIE9iamVjdDpyZXR1cm4gd3JhcHBpbmdfZGljdC5mcm9tSlNPTih2YWx1ZSk7Y2FzZSBBcnJheTpyZXR1cm4gd3JhcHBpbmdfbGlzdC5mcm9tSlNPTih2YWx1ZSk7fQp0aHJvdyBuZXcgRXJyb3IoIlZhbHVlRXJyb3I6IHVuYWJsZSB0byB3cmFwICIrdmFsdWUpO30KdmFyIHdyYXBwaW5nX2RpY3Q9cHkudHlwZSgnd3JhcHBpbmdfZGljdCcsbnVsbCx7X19pbml0X186ZnVuY3Rpb24oKXt0aGlzLl9zdG9yZT17fTt9LF9fZ2V0aXRlbV9fOmZ1bmN0aW9uKGtleSl7dmFyIGs9a2V5LnRvSlNPTigpO2lmKCEoayBpbiB0aGlzLl9zdG9yZSkpe3Rocm93IG5ldyBFcnJvcigiS2V5RXJyb3I6ICciK2srIiciKTt9CnJldHVybiB3cmFwKHRoaXMuX3N0b3JlW2tdKTt9LF9fZ2V0YXR0cl9fOmZ1bmN0aW9uKGtleSl7cmV0dXJuIHRoaXMuX19nZXRpdGVtX18ocHkuc3RyLmZyb21KU09OKGtleSkpO30sX19sZW5fXzpmdW5jdGlvbigpe3JldHVybiBPYmplY3Qua2V5cyh0aGlzLl9zdG9yZSkubGVuZ3RoO30sX19ub256ZXJvX186ZnVuY3Rpb24oKXtyZXR1cm4gcHkuUFlfc2l6ZSh0aGlzKT4wP3B5LlRydWU6cHkuRmFsc2U7fSxnZXQ6ZnVuY3Rpb24oKXt2YXIgYXJncz1weS5QWV9wYXJzZUFyZ3MoYXJndW1lbnRzLFsnaycsWydkJyxweS5Ob25lXV0pO2lmKCEoYXJncy5rLnRvSlNPTigpaW4gdGhpcy5fc3RvcmUpKXtyZXR1cm4gYXJncy5kO30KcmV0dXJuIHRoaXMuX19nZXRpdGVtX18oYXJncy5rKTt9LGZyb21KU09OOmZ1bmN0aW9uKGQpe3ZhciBpbnN0YW5jZT1weS5QWV9jYWxsKHdyYXBwaW5nX2RpY3QpO2luc3RhbmNlLl9zdG9yZT1kO3JldHVybiBpbnN0YW5jZTt9LHRvSlNPTjpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9zdG9yZTt9LH0pO3ZhciB3cmFwcGluZ19saXN0PXB5LnR5cGUoJ3dyYXBwaW5nX2xpc3QnLG51bGwse19faW5pdF9fOmZ1bmN0aW9uKCl7dGhpcy5fc3RvcmU9W107fSxfX2dldGl0ZW1fXzpmdW5jdGlvbihpbmRleCl7cmV0dXJuIHdyYXAodGhpcy5fc3RvcmVbaW5kZXgudG9KU09OKCldKTt9LF9fbGVuX186ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fc3RvcmUubGVuZ3RoO30sX19ub256ZXJvX186ZnVuY3Rpb24oKXtyZXR1cm4gcHkuUFlfc2l6ZSh0aGlzKT4wP3B5LlRydWU6cHkuRmFsc2U7fSxmcm9tSlNPTjpmdW5jdGlvbihhcil7dmFyIGluc3RhbmNlPXB5LlBZX2NhbGwod3JhcHBpbmdfbGlzdCk7aW5zdGFuY2UuX3N0b3JlPWFyO3JldHVybiBpbnN0YW5jZTt9LHRvSlNPTjpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9zdG9yZTt9LH0pO2Z1bmN0aW9uIHdyYXBfY29udGV4dChjb250ZXh0KXtmb3IodmFyIGsgaW4gY29udGV4dCl7aWYoIWNvbnRleHQuaGFzT3duUHJvcGVydHkoaykpe2NvbnRpbnVlO30KdmFyIHZhbD1jb250ZXh0W2tdO2lmKHZhbD09PW51bGwpe2NvbnRpbnVlO30KaWYodmFsLmNvbnN0cnVjdG9yPT09QXJyYXkpe2NvbnRleHRba109d3JhcHBpbmdfbGlzdC5mcm9tSlNPTih2YWwpO31lbHNlIGlmKHZhbC5jb25zdHJ1Y3Rvcj09PU9iamVjdCYmIXB5LlBZX2lzSW5zdGFuY2UodmFsLHB5Lm9iamVjdCkpe2NvbnRleHRba109d3JhcHBpbmdfZGljdC5mcm9tSlNPTih2YWwpO319CnJldHVybiBjb250ZXh0O30KZnVuY3Rpb24gZXZhbF9jb250ZXh0cyhjb250ZXh0cyxldmFsdWF0aW9uX2NvbnRleHQpe2V2YWx1YXRpb25fY29udGV4dD1fLmV4dGVuZChweWNvbnRleHQoKSxldmFsdWF0aW9uX2NvbnRleHR8fHt9KTtyZXR1cm4gXyhjb250ZXh0cykucmVkdWNlKGZ1bmN0aW9uKHJlc3VsdF9jb250ZXh0LGN0eCl7aWYoXy5pc0VtcHR5KGN0eCkpe3JldHVybiByZXN1bHRfY29udGV4dDt9CmlmKF8uaXNTdHJpbmcoY3R4KSl7Y3R4PXtfX3JlZjonY29udGV4dCcsX19kZWJ1ZzpjdHh9O30KdmFyIGV2YWx1YXRlZD1jdHg7c3dpdGNoKGN0eC5fX3JlZil7Y2FzZSdjb250ZXh0JzpldmFsdWF0aW9uX2NvbnRleHQuY29udGV4dD1ldmFsdWF0aW9uX2NvbnRleHQ7ZXZhbHVhdGVkPXB5LmV2YWwoY3R4Ll9fZGVidWcsd3JhcF9jb250ZXh0KGV2YWx1YXRpb25fY29udGV4dCkpO2JyZWFrO2Nhc2UnY29tcG91bmRfY29udGV4dCc6dmFyIGV2YWxfY29udGV4dD1ldmFsX2NvbnRleHRzKFtjdHguX19ldmFsX2NvbnRleHRdKTtldmFsdWF0ZWQ9ZXZhbF9jb250ZXh0cyhjdHguX19jb250ZXh0cyxfLmV4dGVuZCh7fSxldmFsdWF0aW9uX2NvbnRleHQsZXZhbF9jb250ZXh0KSk7YnJlYWs7fQpfLmV4dGVuZChldmFsdWF0aW9uX2NvbnRleHQsZXZhbHVhdGVkKTtyZXR1cm4gXy5leHRlbmQocmVzdWx0X2NvbnRleHQsZXZhbHVhdGVkKTt9LHt9KTt9CmZ1bmN0aW9uIGV2YWxfZG9tYWlucyhkb21haW5zLGV2YWx1YXRpb25fY29udGV4dCl7ZXZhbHVhdGlvbl9jb250ZXh0PV8uZXh0ZW5kKHB5Y29udGV4dCgpLGV2YWx1YXRpb25fY29udGV4dHx8e30pO3ZhciByZXN1bHRfZG9tYWluPVtdO3ZhciBuZWVkX25vcm1hbGl6YXRpb249KGRvbWFpbnMmJmRvbWFpbnMubGVuZ3RoPjAmJmRvbWFpbnNbMF0ubGVuZ3RoPT09MSYmKGRvbWFpbnNbMF1bMF09PT0ifCJ8fGRvbWFpbnNbMF1bMF09PT0iISIpKTtfKGRvbWFpbnMpLmVhY2goZnVuY3Rpb24oZG9tYWluKXtpZihfLmlzU3RyaW5nKGRvbWFpbikpe2RvbWFpbj17X19yZWY6J2RvbWFpbicsX19kZWJ1Zzpkb21haW59O30KdmFyIGRvbWFpbl9hcnJheV90b19jb21iaW5lO3N3aXRjaChkb21haW4uX19yZWYpe2Nhc2UnZG9tYWluJzpldmFsdWF0aW9uX2NvbnRleHQuY29udGV4dD1ldmFsdWF0aW9uX2NvbnRleHQ7ZG9tYWluX2FycmF5X3RvX2NvbWJpbmU9cHkuZXZhbChkb21haW4uX19kZWJ1Zyx3cmFwX2NvbnRleHQoZXZhbHVhdGlvbl9jb250ZXh0KSk7YnJlYWs7ZGVmYXVsdDpkb21haW5fYXJyYXlfdG9fY29tYmluZT1kb21haW47fQppZihuZWVkX25vcm1hbGl6YXRpb24pe2RvbWFpbl9hcnJheV90b19jb21iaW5lPWdldF9ub3JtYWxpemVkX2RvbWFpbihkb21haW5fYXJyYXlfdG9fY29tYmluZSk7fQpyZXN1bHRfZG9tYWluLnB1c2guYXBwbHkocmVzdWx0X2RvbWFpbixkb21haW5fYXJyYXlfdG9fY29tYmluZSk7fSk7cmV0dXJuIHJlc3VsdF9kb21haW47fQpmdW5jdGlvbiBnZXRfbm9ybWFsaXplZF9kb21haW4oZG9tYWluX2FycmF5KXt2YXIgZXhwZWN0ZWQ9MTtfLmVhY2goZG9tYWluX2FycmF5LGZ1bmN0aW9uKGl0ZW0pe2lmKGl0ZW09PT0iJiJ8fGl0ZW09PT0ifCIpe2V4cGVjdGVkKys7fWVsc2UgaWYoaXRlbSE9PSIhIil7ZXhwZWN0ZWQtLTt9fSk7dmFyIG5ld19leHBsaWNpdF9hbmRzPV8udGltZXMoLWV4cGVjdGVkLF8uY29uc3RhbnQoIiYiKSk7cmV0dXJuIG5ld19leHBsaWNpdF9hbmRzLmNvbmNhdChkb21haW5fYXJyYXkpO30KZnVuY3Rpb24gZXZhbF9ncm91cGJ5cyhjb250ZXh0cyxldmFsdWF0aW9uX2NvbnRleHQpe2V2YWx1YXRpb25fY29udGV4dD1fLmV4dGVuZChweWNvbnRleHQoKSxldmFsdWF0aW9uX2NvbnRleHR8fHt9KTt2YXIgcmVzdWx0X2dyb3VwPVtdO18oY29udGV4dHMpLmVhY2goZnVuY3Rpb24oY3R4KXtpZihfLmlzU3RyaW5nKGN0eCkpe2N0eD17X19yZWY6J2NvbnRleHQnLF9fZGVidWc6Y3R4fTt9CnZhciBncm91cDt2YXIgZXZhbHVhdGVkPWN0eDtzd2l0Y2goY3R4Ll9fcmVmKXtjYXNlJ2NvbnRleHQnOmV2YWx1YXRpb25fY29udGV4dC5jb250ZXh0PWV2YWx1YXRpb25fY29udGV4dDtldmFsdWF0ZWQ9cHkuZXZhbChjdHguX19kZWJ1Zyx3cmFwX2NvbnRleHQoZXZhbHVhdGlvbl9jb250ZXh0KSk7YnJlYWs7Y2FzZSdjb21wb3VuZF9jb250ZXh0Jzp2YXIgZXZhbF9jb250ZXh0PWV2YWxfY29udGV4dHMoW2N0eC5fX2V2YWxfY29udGV4dF0pO2V2YWx1YXRlZD1ldmFsX2NvbnRleHRzKGN0eC5fX2NvbnRleHRzLF8uZXh0ZW5kKHt9LGV2YWx1YXRpb25fY29udGV4dCxldmFsX2NvbnRleHQpKTticmVhazt9Cmdyb3VwPWV2YWx1YXRlZC5ncm91cF9ieTtpZighZ3JvdXApe3JldHVybjt9CmlmKHR5cGVvZiBncm91cD09PSdzdHJpbmcnKXtyZXN1bHRfZ3JvdXAucHVzaChncm91cCk7fWVsc2UgaWYoZ3JvdXAgaW5zdGFuY2VvZiBBcnJheSl7cmVzdWx0X2dyb3VwLnB1c2guYXBwbHkocmVzdWx0X2dyb3VwLGdyb3VwKTt9ZWxzZXt0aHJvdyBuZXcgRXJyb3IoJ0dvdCBpbnZhbGlkIGdyb3VwYnkge3snCitKU09OLnN0cmluZ2lmeShncm91cCkrJ319Jyk7fQpfLmV4dGVuZChldmFsdWF0aW9uX2NvbnRleHQsZXZhbHVhdGVkKTt9KTtyZXR1cm4gcmVzdWx0X2dyb3VwO30KZnVuY3Rpb24gY29udGV4dF90b2RheSgpe3ZhciBkPW5ldyBEYXRlKCk7cmV0dXJuIHB5LlBZX2NhbGwocHkuZXh0cmFzLmRhdGV0aW1lLmRhdGUsW2QuZ2V0RnVsbFllYXIoKSxkLmdldE1vbnRoKCkrMSxkLmdldERhdGUoKV0pO30KZnVuY3Rpb24gdHpfb2Zmc2V0KCl7dmFyIG9mZnNldD1uZXcgRGF0ZSgpLmdldFRpbWV6b25lT2Zmc2V0KCk7dmFyIGt3YXJncz17bWludXRlczpweS5mbG9hdC5mcm9tSlNPTihvZmZzZXQpfTtyZXR1cm4gcHkuUFlfY2FsbChweS5leHRyYXMuZGF0ZXRpbWUudGltZWRlbHRhLFtdLGt3YXJncyk7fQpmdW5jdGlvbiBweWNvbnRleHQoKXtyZXR1cm57ZGF0ZXRpbWU6cHkuZXh0cmFzLmRhdGV0aW1lLGNvbnRleHRfdG9kYXk6Y29udGV4dF90b2RheSx0aW1lOnB5LmV4dHJhcy50aW1lLHJlbGF0aXZlZGVsdGE6cHkuZXh0cmFzLnJlbGF0aXZlZGVsdGEsY3VycmVudF9kYXRlOnB5LlBZX2NhbGwocHkuZXh0cmFzLnRpbWUuc3RyZnRpbWUsW3B5LnN0ci5mcm9tSlNPTignJVktJW0tJWQnKV0pLHR6X29mZnNldDp0el9vZmZzZXQsfTt9CmZ1bmN0aW9uIHB5ZXZhbCh0eXBlLG9iamVjdCxjb250ZXh0KXtjb250ZXh0PV8uZXh0ZW5kKHB5Y29udGV4dCgpLGNvbnRleHR8fHt9KTtzd2l0Y2godHlwZSl7Y2FzZSdjb250ZXh0JzpjYXNlJ2NvbnRleHRzJzppZih0eXBlPT09J2NvbnRleHQnKXtvYmplY3Q9W29iamVjdF07fQpyZXR1cm4gZXZhbF9jb250ZXh0cyhvYmplY3QsY29udGV4dCk7Y2FzZSdkb21haW4nOmNhc2UnZG9tYWlucyc6aWYodHlwZT09PSdkb21haW4nKQpvYmplY3Q9W29iamVjdF07cmV0dXJuIGV2YWxfZG9tYWlucyhvYmplY3QsY29udGV4dCk7Y2FzZSdncm91cGJ5cyc6cmV0dXJuIGV2YWxfZ3JvdXBieXMob2JqZWN0LGNvbnRleHQpO30KdGhyb3cgbmV3IEVycm9yKCJVbmtub3cgZXZhbHVhdGlvbiB0eXBlICIrdHlwZSk7fQpmdW5jdGlvbiBldmFsX2FyZyhhcmcpe2lmKHR5cGVvZiBhcmchPT0nb2JqZWN0J3x8IWFyZy5fX3JlZil7cmV0dXJuIGFyZzt9CnN3aXRjaChhcmcuX19yZWYpe2Nhc2UnZG9tYWluJzpyZXR1cm4gcHlldmFsKCdkb21haW5zJyxbYXJnXSk7Y2FzZSdjb250ZXh0JzpjYXNlJ2NvbXBvdW5kX2NvbnRleHQnOnJldHVybiBweWV2YWwoJ2NvbnRleHRzJyxbYXJnXSk7ZGVmYXVsdDp0aHJvdyBuZXcgRXJyb3IoX3QoIlVua25vd24gbm9ubGl0ZXJhbCB0eXBlICIpKycgJythcmcuX19yZWYpO319CmZ1bmN0aW9uIGVuc3VyZV9ldmFsdWF0ZWQoYXJncyxrd2FyZ3Mpe2Zvcih2YXIgaT0wO2k8YXJncy5sZW5ndGg7KytpKXthcmdzW2ldPWV2YWxfYXJnKGFyZ3NbaV0pO30KZm9yKHZhciBrIGluIGt3YXJncyl7aWYoIWt3YXJncy5oYXNPd25Qcm9wZXJ0eShrKSl7Y29udGludWU7fQprd2FyZ3Nba109ZXZhbF9hcmcoa3dhcmdzW2tdKTt9fQpmdW5jdGlvbiBldmFsX2RvbWFpbnNfYW5kX2NvbnRleHRzKHNvdXJjZSl7cmV0dXJue2NvbnRleHQ6cHlldmFsKCdjb250ZXh0cycsc291cmNlLmNvbnRleHRzfHxbXSxzb3VyY2UuZXZhbF9jb250ZXh0KSxkb21haW46cHlldmFsKCdkb21haW5zJyxzb3VyY2UuZG9tYWlucyxzb3VyY2UuZXZhbF9jb250ZXh0KSxncm91cF9ieTpweWV2YWwoJ2dyb3VwYnlzJyxzb3VyY2UuZ3JvdXBfYnlfc2VxfHxbXSxzb3VyY2UuZXZhbF9jb250ZXh0KSx9O30KZnVuY3Rpb24gcHlfZXZhbChleHByLGNvbnRleHQpe3JldHVybiBweS5ldmFsKGV4cHIsXy5leHRlbmQoe30sY29udGV4dHx8e30seyJ0cnVlIjp0cnVlLCJmYWxzZSI6ZmFsc2UsIm51bGwiOm51bGx9KSk7fQpmdW5jdGlvbiBhc3NlbWJsZURvbWFpbnMoZG9tYWlucyxvcGVyYXRvcil7dmFyIEFTVHM9ZG9tYWlucy5tYXAoX2dldFB5SlNBU1QpO2lmKG9wZXJhdG9yPT09Ik9SIil7b3BlcmF0b3I9cHkudG9rZW5pemUoIid8JyIpWzBdO31lbHNle29wZXJhdG9yPXB5LnRva2VuaXplKCInJiciKVswXTt9CnZhciByZXN1bHQ9X2dldFB5SlNBU1QoIltdIik7dmFyIG5vcm1hbGl6ZWREb21haW5zPUFTVHMuZmlsdGVyKGZ1bmN0aW9uKEFTVCl7cmV0dXJuIEFTVC5maXJzdC5sZW5ndGg+MDt9KS5tYXAoX25vcm1hbGl6ZURvbWFpbkFTVCk7aWYobm9ybWFsaXplZERvbWFpbnMubGVuZ3RoPjApe3Jlc3VsdC5maXJzdD1ub3JtYWxpemVkRG9tYWlucy5yZWR1Y2UoZnVuY3Rpb24oYWNjLGFzdCl7cmV0dXJuIGFjYy5jb25jYXQoYXN0LmZpcnN0KTt9LF8udGltZXMobm9ybWFsaXplZERvbWFpbnMubGVuZ3RoLTEsXy5jb25zdGFudChvcGVyYXRvcikpKTt9CnJldHVybiBfZm9ybWF0QVNUKHJlc3VsdCk7fQpmdW5jdGlvbiBub3JtYWxpemVEb21haW4oZG9tYWluKXtyZXR1cm4gX2Zvcm1hdEFTVChfbm9ybWFsaXplRG9tYWluQVNUKF9nZXRQeUpTQVNUKGRvbWFpbikpKTt9CnZhciBCSU5ESU5HX1BPV0VSUz17b3I6MzAsYW5kOjQwLG5vdDo1MCx9O2Z1bmN0aW9uIF9mb3JtYXRBU1QoYXN0LGxicCl7bGJwPWxicHx8MDtzd2l0Y2goYXN0LmlkKXtjYXNlIihudW1iZXIpIjpyZXR1cm4gU3RyaW5nKGFzdC52YWx1ZSk7Y2FzZSIoc3RyaW5nKSI6cmV0dXJuIEpTT04uc3RyaW5naWZ5KGFzdC52YWx1ZS5yZXBsYWNlKC8oXFwoWyciXFxdKSkvZywiXCQyIikpO2Nhc2UiKGNvbnN0YW50KSI6cmV0dXJuIGFzdC52YWx1ZTtjYXNlIihuYW1lKSI6cmV0dXJuIGFzdC52YWx1ZTtjYXNlIlsiOmlmKGFzdC5zZWNvbmQpe3JldHVybiBfZm9ybWF0QVNUKGFzdC5maXJzdCkrJ1snK19mb3JtYXRBU1QoYXN0LnNlY29uZCkrJ10nO31lbHNle3ZhciB2YWx1ZXM9YXN0LmZpcnN0Lm1hcChfZm9ybWF0QVNUKTtyZXR1cm4nWycrdmFsdWVzLmpvaW4oJywgJykrJ10nO30KY2FzZSJ7Ijp2YXIga2V5VmFsdWVzPWFzdC5maXJzdC5tYXAoZnVuY3Rpb24oa3Ype3JldHVybiBfZm9ybWF0QVNUKGt2WzBdKSsnOiAnK19mb3JtYXRBU1Qoa3ZbMV0pO30pO3JldHVybid7JytrZXlWYWx1ZXMuam9pbignLCAnKSsnfSc7Y2FzZSI9IjpyZXR1cm4gX2Zvcm1hdEFTVChhc3QuZmlyc3QpKycgJythc3QuaWQrJyAnK19mb3JtYXRBU1QoYXN0LnNlY29uZCk7Y2FzZSItIjpjYXNlIisiOmNhc2UifiI6Y2FzZSIqIjpjYXNlIioqIjpjYXNlIiUiOmNhc2UiLy8iOmNhc2UiYW5kIjpjYXNlIm9yIjppZihhc3Quc2Vjb25kKXt2YXIgcj1fZm9ybWF0QVNUKGFzdC5maXJzdCxhc3QubGJwKSsnICcrYXN0LmlkKycgJytfZm9ybWF0QVNUKGFzdC5zZWNvbmQsYXN0LmxicCk7aWYoYXN0LmxicDxsYnApe3I9JygnK3IrJyknO30KcmV0dXJuIHI7fQp2YXIgYWN0dWFsQlA9QklORElOR19QT1dFUlNbYXN0LmlkXXx8MTMwO3JldHVybiBhc3QuaWQrX2Zvcm1hdEFTVChhc3QuZmlyc3QsYWN0dWFsQlApO2Nhc2UiLiI6cmV0dXJuIF9mb3JtYXRBU1QoYXN0LmZpcnN0LGFzdC5sYnApKycuJytfZm9ybWF0QVNUKGFzdC5zZWNvbmQpO2Nhc2Uibm90IjpyZXR1cm4ibm90ICIrX2Zvcm1hdEFTVChhc3QuZmlyc3QpO2Nhc2UiKGNvbXBhcmF0b3IpIjp2YXIgb3BlcmF0b3I9YXN0Lm9wZXJhdG9yc1swXTtyZXR1cm4gX2Zvcm1hdEFTVChhc3QuZXhwcmVzc2lvbnNbMF0pKycgJytvcGVyYXRvcisnICcrX2Zvcm1hdEFTVChhc3QuZXhwcmVzc2lvbnNbMV0pO2Nhc2UiKCI6aWYoYXN0LnNlY29uZCl7cmV0dXJuIF9mb3JtYXRBU1QoYXN0LmZpcnN0KSsnKCcrYXN0LnNlY29uZC5tYXAoX2Zvcm1hdEFTVCkuam9pbignLCAnKSsnKSc7fWVsc2V7cmV0dXJuJygnK2FzdC5maXJzdC5tYXAoX2Zvcm1hdEFTVCkuam9pbignLCAnKSsnKSc7fX0KdGhyb3cgbmV3IEVycm9yKCJVbmltcGxlbWVudGVkIHB5dGhvbiBjb25zdHJ1Y3QiKTt9CmZ1bmN0aW9uIF9nZXRQeUpTQVNUKGRvbWFpbil7cmV0dXJuIHB5LnBhcnNlKHB5LnRva2VuaXplKGRvbWFpbikpO30KZnVuY3Rpb24gX25vcm1hbGl6ZURvbWFpbkFTVChkb21haW4pe3ZhciBleHBlY3RlZD0xO2Zvcih2YXIgaT0wO2k8ZG9tYWluLmZpcnN0Lmxlbmd0aDtpKyspe3ZhciB2YWx1ZT1kb21haW4uZmlyc3RbaV0udmFsdWU7aWYodmFsdWU9PT0nJid8fHZhbHVlPT09J3wnKXtleHBlY3RlZCsrO31lbHNlIGlmKHZhbHVlIT09JyEnKXtleHBlY3RlZC0tO319CnZhciBhbmRPcGVyYXRvcj1weS50b2tlbml6ZSgiJyYnIilbMF07aWYoZXhwZWN0ZWQ8MCl7ZG9tYWluLmZpcnN0LnVuc2hpZnQuYXBwbHkoZG9tYWluLmZpcnN0LF8udGltZXMoTWF0aC5hYnMoZXhwZWN0ZWQpLF8uY29uc3RhbnQoYW5kT3BlcmF0b3IpKSk7fQpyZXR1cm4gZG9tYWluO30KcmV0dXJue2NvbnRleHQ6cHljb250ZXh0LGVuc3VyZV9ldmFsdWF0ZWQ6ZW5zdXJlX2V2YWx1YXRlZCxldmFsOnB5ZXZhbCxldmFsX2RvbWFpbnNfYW5kX2NvbnRleHRzOmV2YWxfZG9tYWluc19hbmRfY29udGV4dHMscHlfZXZhbDpweV9ldmFsLG5vcm1hbGl6ZURvbWFpbjpub3JtYWxpemVEb21haW4sYXNzZW1ibGVEb21haW5zOmFzc2VtYmxlRG9tYWlucyxfZ2V0UHlKU0FTVDpfZ2V0UHlKU0FTVCxfZm9ybWF0QVNUOl9mb3JtYXRBU1QsX25vcm1hbGl6ZURvbWFpbkFTVDpfbm9ybWFsaXplRG9tYWluQVNULH07fSk7OwoKLyogL3dlYi9zdGF0aWMvc3JjL2pzL2Nocm9tZS9hYnN0cmFjdF9hY3Rpb24uanMgZGVmaW5lZCBpbiBidW5kbGUgJ3dlYi5hc3NldHNfYmFja2VuZCcgKi8Kb2Rvby5kZWZpbmUoJ3dlYi5BYnN0cmFjdEFjdGlvbicsZnVuY3Rpb24ocmVxdWlyZSl7InVzZSBzdHJpY3QiO3ZhciBBY3Rpb25NaXhpbj1yZXF1aXJlKCd3ZWIuQWN0aW9uTWl4aW4nKTt2YXIgQ29udHJvbFBhbmVsVmlldz1yZXF1aXJlKCd3ZWIuQ29udHJvbFBhbmVsVmlldycpO3ZhciBXaWRnZXQ9cmVxdWlyZSgnd2ViLldpZGdldCcpO3ZhciBBYnN0cmFjdEFjdGlvbj1XaWRnZXQuZXh0ZW5kKEFjdGlvbk1peGluLHtjb25maWc6e0NvbnRyb2xQYW5lbFZpZXc6Q29udHJvbFBhbmVsVmlldyx9LGhhc0NvbnRyb2xQYW5lbDpmYWxzZSxsb2FkQ29udHJvbFBhbmVsOmZhbHNlLHdpdGhTZWFyY2hCYXI6ZmFsc2Usc2VhcmNoTWVudVR5cGVzOltdLGluaXQ6ZnVuY3Rpb24ocGFyZW50LGFjdGlvbixvcHRpb25zKXt0aGlzLl9zdXBlcihwYXJlbnQpO3RoaXMuX3RpdGxlPWFjdGlvbi5kaXNwbGF5X25hbWV8fGFjdGlvbi5uYW1lO3RoaXMuY29udHJvbFBhbmVsUGFyYW1zPXthY3Rpb25JZDphY3Rpb24uaWQsY29udGV4dDphY3Rpb24uY29udGV4dCxicmVhZGNydW1iczpvcHRpb25zJiZvcHRpb25zLmJyZWFkY3J1bWJzfHxbXSx0aXRsZTp0aGlzLmdldFRpdGxlKCksdmlld0lkOmFjdGlvbi5zZWFyY2hfdmlld19pZCYmYWN0aW9uLnNlYXJjaF92aWV3X2lkWzBdLHdpdGhTZWFyY2hCYXI6dGhpcy53aXRoU2VhcmNoQmFyLHNlYXJjaE1lbnVUeXBlczp0aGlzLnNlYXJjaE1lbnVUeXBlcyx9O30sd2lsbFN0YXJ0OmZ1bmN0aW9uKCl7dmFyIHNlbGY9dGhpczt2YXIgcHJvbXM9W3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKV07aWYodGhpcy5oYXNDb250cm9sUGFuZWwpe3ZhciBwYXJhbXM9dGhpcy5jb250cm9sUGFuZWxQYXJhbXM7aWYodGhpcy5sb2FkQ29udHJvbFBhbmVsKXtwcm9tcy5wdXNoKHRoaXMubG9hZEZpZWxkVmlldyhwYXJhbXMubW9kZWxOYW1lLHBhcmFtcy5jb250ZXh0fHx7fSxwYXJhbXMudmlld0lkLCdzZWFyY2gnKS50aGVuKGZ1bmN0aW9uKGZpZWxkc1ZpZXcpe3BhcmFtcy52aWV3SW5mbz17YXJjaDpmaWVsZHNWaWV3LmFyY2gsZmllbGRzOmZpZWxkc1ZpZXcuZmllbGRzLH07fSkpO30KcmV0dXJuIFByb21pc2UuYWxsKHByb21zKS50aGVuKGZ1bmN0aW9uKCl7dmFyIGNvbnRyb2xQYW5lbFZpZXc9bmV3IHNlbGYuY29uZmlnLkNvbnRyb2xQYW5lbFZpZXcocGFyYW1zKTtyZXR1cm4gY29udHJvbFBhbmVsVmlldy5nZXRDb250cm9sbGVyKHNlbGYpLnRoZW4oZnVuY3Rpb24oY29udHJvbFBhbmVsKXtzZWxmLl9jb250cm9sUGFuZWw9Y29udHJvbFBhbmVsO3JldHVybiBzZWxmLl9jb250cm9sUGFuZWwuYXBwZW5kVG8oZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpKTt9KTt9KTt9CnJldHVybiBQcm9taXNlLmFsbChwcm9tcyk7fSxzdGFydDpmdW5jdGlvbigpe2lmKHRoaXMuX2NvbnRyb2xQYW5lbCl7dGhpcy5fY29udHJvbFBhbmVsLiRlbC5wcmVwZW5kVG8odGhpcy4kZWwpO30KcmV0dXJuIHRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9LH0pO3JldHVybiBBYnN0cmFjdEFjdGlvbjt9KTs7CgovKiAvd2ViL3N0YXRpYy9zcmMvanMvY2hyb21lL2FjdGlvbl9tYW5hZ2VyLmpzIGRlZmluZWQgaW4gYnVuZGxlICd3ZWIuYXNzZXRzX2JhY2tlbmQnICovCm9kb28uZGVmaW5lKCd3ZWIuQWN0aW9uTWFuYWdlcicsZnVuY3Rpb24ocmVxdWlyZSl7InVzZSBzdHJpY3QiO3ZhciBBYnN0cmFjdEFjdGlvbj1yZXF1aXJlKCd3ZWIuQWJzdHJhY3RBY3Rpb24nKTt2YXIgY29uY3VycmVuY3k9cmVxdWlyZSgnd2ViLmNvbmN1cnJlbmN5Jyk7dmFyIENvbnRleHQ9cmVxdWlyZSgnd2ViLkNvbnRleHQnKTt2YXIgY29yZT1yZXF1aXJlKCd3ZWIuY29yZScpO3ZhciBEaWFsb2c9cmVxdWlyZSgnd2ViLkRpYWxvZycpO3ZhciBkb209cmVxdWlyZSgnd2ViLmRvbScpO3ZhciBmcmFtZXdvcms9cmVxdWlyZSgnd2ViLmZyYW1ld29yaycpO3ZhciBweVV0aWxzPXJlcXVpcmUoJ3dlYi5weV91dGlscycpO3ZhciBXaWRnZXQ9cmVxdWlyZSgnd2ViLldpZGdldCcpO3ZhciBfdD1jb3JlLl90O3ZhciBBY3Rpb25NYW5hZ2VyPVdpZGdldC5leHRlbmQoe2NsYXNzTmFtZTonb19hY3Rpb25fbWFuYWdlcicsY3VzdG9tX2V2ZW50czp7YnJlYWRjcnVtYl9jbGlja2VkOidfb25CcmVhZGNydW1iQ2xpY2tlZCcsaGlzdG9yeV9iYWNrOidfb25IaXN0b3J5QmFjaycscHVzaF9zdGF0ZTonX29uUHVzaFN0YXRlJyxyZWRpcmVjdDonX29uUmVkaXJlY3QnLH0saW5pdDpmdW5jdGlvbihwYXJlbnQsdXNlckNvbnRleHQpe3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLnVzZXJDb250ZXh0PXVzZXJDb250ZXh0fHx7fTt0aGlzLmRwPW5ldyBjb25jdXJyZW5jeS5Ecm9wUHJldmlvdXMoKTt0aGlzLmFjdGlvbnM9e307dGhpcy5jb250cm9sbGVycz17fTt0aGlzLmNvbnRyb2xsZXJTdGFjaz1bXTt0aGlzLmN1cnJlbnREaWFsb2dDb250cm9sbGVyPW51bGw7fSxvbl9hdHRhY2hfY2FsbGJhY2s6ZnVuY3Rpb24oKXt0aGlzLmlzSW5ET009dHJ1ZTt2YXIgY3VycmVudENvbnRyb2xsZXI9dGhpcy5nZXRDdXJyZW50Q29udHJvbGxlcigpO2lmKGN1cnJlbnRDb250cm9sbGVyKXtjdXJyZW50Q29udHJvbGxlci53aWRnZXQub25fYXR0YWNoX2NhbGxiYWNrKCk7fX0sb25fZGV0YWNoX2NhbGxiYWNrOmZ1bmN0aW9uKCl7dGhpcy5pc0luRE9NPWZhbHNlO3ZhciBjdXJyZW50Q29udHJvbGxlcj10aGlzLmdldEN1cnJlbnRDb250cm9sbGVyKCk7aWYoY3VycmVudENvbnRyb2xsZXIpe2N1cnJlbnRDb250cm9sbGVyLndpZGdldC5vbl9kZXRhY2hfY2FsbGJhY2soKTt9fSxjbGVhclVuY29tbWl0dGVkQ2hhbmdlczpmdW5jdGlvbigpe3ZhciBjdXJyZW50Q29udHJvbGxlcj10aGlzLmdldEN1cnJlbnRDb250cm9sbGVyKCk7aWYoY3VycmVudENvbnRyb2xsZXIpe3JldHVybiBjdXJyZW50Q29udHJvbGxlci53aWRnZXQuY2FuQmVSZW1vdmVkKCk7fQpyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7fSxkb0FjdGlvbjpmdW5jdGlvbihhY3Rpb24sb3B0aW9ucyl7dmFyIHNlbGY9dGhpcztvcHRpb25zPV8uZGVmYXVsdHMoe30sb3B0aW9ucyx7YWRkaXRpb25hbF9jb250ZXh0Ont9LGNsZWFyX2JyZWFkY3J1bWJzOmZhbHNlLG9uX2Nsb3NlOmZ1bmN0aW9uKCl7fSxvbl9yZXZlcnNlX2JyZWFkY3J1bWI6ZnVuY3Rpb24oKXt9LHB1c2hTdGF0ZTp0cnVlLHJlcGxhY2VfbGFzdF9hY3Rpb246ZmFsc2UsfSk7dmFyIGRlZjtpZihfLmlzU3RyaW5nKGFjdGlvbikmJmNvcmUuYWN0aW9uX3JlZ2lzdHJ5LmNvbnRhaW5zKGFjdGlvbikpe2FjdGlvbj17dHlwZTonaXIuYWN0aW9ucy5jbGllbnQnLHRhZzphY3Rpb259O31lbHNlIGlmKF8uaXNOdW1iZXIoYWN0aW9uKXx8Xy5pc1N0cmluZyhhY3Rpb24pKXtkZWY9dGhpcy5fbG9hZEFjdGlvbihhY3Rpb24se2FjdGl2ZV9pZDpvcHRpb25zLmFkZGl0aW9uYWxfY29udGV4dC5hY3RpdmVfaWQsYWN0aXZlX2lkczpvcHRpb25zLmFkZGl0aW9uYWxfY29udGV4dC5hY3RpdmVfaWRzLGFjdGl2ZV9tb2RlbDpvcHRpb25zLmFkZGl0aW9uYWxfY29udGV4dC5hY3RpdmVfbW9kZWwsfSkudGhlbihmdW5jdGlvbihyZXN1bHQpe2FjdGlvbj1yZXN1bHQ7fSk7fQpyZXR1cm4gdGhpcy5kcC5hZGQoUHJvbWlzZS5yZXNvbHZlKGRlZikpLnRoZW4oZnVuY3Rpb24oKXtvcHRpb25zLmNsZWFyX2JyZWFkY3J1bWJzPWFjdGlvbi50YXJnZXQ9PT0nbWFpbid8fG9wdGlvbnMuY2xlYXJfYnJlYWRjcnVtYnM7c2VsZi5fcHJlcHJvY2Vzc0FjdGlvbihhY3Rpb24sb3B0aW9ucyk7cmV0dXJuIHNlbGYuX2hhbmRsZUFjdGlvbihhY3Rpb24sb3B0aW9ucykudGhlbihmdW5jdGlvbigpe2FjdGlvbi5wdXNoU3RhdGU9dHJ1ZTtyZXR1cm4gYWN0aW9uO30pO30pO30sZG9fcHVzaF9zdGF0ZTpmdW5jdGlvbihzdGF0ZSl7dGhpcy50cmlnZ2VyX3VwKCdwdXNoX3N0YXRlJyx7c3RhdGU6c3RhdGV9KTt9LGdldEN1cnJlbnRBY3Rpb246ZnVuY3Rpb24oKXt2YXIgY29udHJvbGxlcj10aGlzLmdldEN1cnJlbnRDb250cm9sbGVyKCk7cmV0dXJuIGNvbnRyb2xsZXI/dGhpcy5hY3Rpb25zW2NvbnRyb2xsZXIuYWN0aW9uSURdOm51bGw7fSxnZXRDdXJyZW50Q29udHJvbGxlcjpmdW5jdGlvbigpe3ZhciBjdXJyZW50Q29udHJvbGxlcklEPV8ubGFzdCh0aGlzLmNvbnRyb2xsZXJTdGFjayk7cmV0dXJuIGN1cnJlbnRDb250cm9sbGVySUQ/dGhpcy5jb250cm9sbGVyc1tjdXJyZW50Q29udHJvbGxlcklEXTpudWxsO30sbG9hZFN0YXRlOmZ1bmN0aW9uKHN0YXRlKXt2YXIgYWN0aW9uO2lmKCFzdGF0ZS5hY3Rpb24pe3JldHVybiBQcm9taXNlLnJlc29sdmUoKTt9CmlmKF8uaXNTdHJpbmcoc3RhdGUuYWN0aW9uKSYmY29yZS5hY3Rpb25fcmVnaXN0cnkuY29udGFpbnMoc3RhdGUuYWN0aW9uKSl7YWN0aW9uPXtwYXJhbXM6c3RhdGUsdGFnOnN0YXRlLmFjdGlvbix0eXBlOidpci5hY3Rpb25zLmNsaWVudCcsfTt9ZWxzZXthY3Rpb249c3RhdGUuYWN0aW9uO30KcmV0dXJuIHRoaXMuZG9BY3Rpb24oYWN0aW9uLHtjbGVhcl9icmVhZGNydW1iczp0cnVlLHB1c2hTdGF0ZTpmYWxzZSx9KTt9LF9hcHBlbmRDb250cm9sbGVyOmZ1bmN0aW9uKGNvbnRyb2xsZXIpe2RvbS5hcHBlbmQodGhpcy4kZWwsY29udHJvbGxlci53aWRnZXQuJGVsLHtpbl9ET006dGhpcy5pc0luRE9NLGNhbGxiYWNrczpbe3dpZGdldDpjb250cm9sbGVyLndpZGdldH1dLH0pO2lmKGNvbnRyb2xsZXIuc2Nyb2xsUG9zaXRpb24pe3RoaXMudHJpZ2dlcl91cCgnc2Nyb2xsVG8nLGNvbnRyb2xsZXIuc2Nyb2xsUG9zaXRpb24pO319LF9jbG9zZURpYWxvZzpmdW5jdGlvbihvcHRpb25zKXtpZih0aGlzLmN1cnJlbnREaWFsb2dDb250cm9sbGVyKXt0aGlzLmN1cnJlbnREaWFsb2dDb250cm9sbGVyLmRpYWxvZy5kZXN0cm95KG9wdGlvbnMpO319LF9kZXRhY2hDdXJyZW50Q29udHJvbGxlcjpmdW5jdGlvbigpe3ZhciBjdXJyZW50Q29udHJvbGxlcj10aGlzLmdldEN1cnJlbnRDb250cm9sbGVyKCk7aWYoY3VycmVudENvbnRyb2xsZXIpe2N1cnJlbnRDb250cm9sbGVyLnNjcm9sbFBvc2l0aW9uPXRoaXMuX2dldFNjcm9sbFBvc2l0aW9uKCk7ZG9tLmRldGFjaChbe3dpZGdldDpjdXJyZW50Q29udHJvbGxlci53aWRnZXR9XSk7fX0sX2V4ZWN1dGVBY3Rpb246ZnVuY3Rpb24oYWN0aW9uLG9wdGlvbnMpe3ZhciBzZWxmPXRoaXM7dGhpcy5hY3Rpb25zW2FjdGlvbi5qc0lEXT1hY3Rpb247aWYoYWN0aW9uLnRhcmdldD09PSduZXcnKXtyZXR1cm4gdGhpcy5fZXhlY3V0ZUFjdGlvbkluRGlhbG9nKGFjdGlvbixvcHRpb25zKTt9CnZhciBjb250cm9sbGVyPXNlbGYuY29udHJvbGxlcnNbYWN0aW9uLmNvbnRyb2xsZXJJRF07cmV0dXJuIHRoaXMuY2xlYXJVbmNvbW1pdHRlZENoYW5nZXMoKS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIHNlbGYuZHAuYWRkKHNlbGYuX3N0YXJ0Q29udHJvbGxlcihjb250cm9sbGVyKSk7fSkudGhlbihmdW5jdGlvbigpe2lmKHNlbGYuY3VycmVudERpYWxvZ0NvbnRyb2xsZXIpe3NlbGYuX2Nsb3NlRGlhbG9nKHtzaWxlbnQ6dHJ1ZX0pO30KaWYob3B0aW9ucy5vbl9yZXZlcnNlX2JyZWFkY3J1bWIpe3ZhciBjdXJyZW50QWN0aW9uPXNlbGYuZ2V0Q3VycmVudEFjdGlvbigpO2lmKGN1cnJlbnRBY3Rpb24pe2N1cnJlbnRBY3Rpb24ub25fcmV2ZXJzZV9icmVhZGNydW1iPW9wdGlvbnMub25fcmV2ZXJzZV9icmVhZGNydW1iO319CnNlbGYuX3B1c2hDb250cm9sbGVyKGNvbnRyb2xsZXIpO3NlbGYuY2FsbCgnc2Vzc2lvbl9zdG9yYWdlJywnc2V0SXRlbScsJ2N1cnJlbnRfYWN0aW9uJyxhY3Rpb24uX29yaWdpbmFsQWN0aW9uKTtyZXR1cm4gYWN0aW9uO30pLmd1YXJkZWRDYXRjaChmdW5jdGlvbigpe3NlbGYuX3JlbW92ZUFjdGlvbihhY3Rpb24uanNJRCk7fSk7fSxfZXhlY3V0ZUFjdGlvbkluRGlhbG9nOmZ1bmN0aW9uKGFjdGlvbixvcHRpb25zKXt2YXIgc2VsZj10aGlzO3ZhciBjb250cm9sbGVyPXRoaXMuY29udHJvbGxlcnNbYWN0aW9uLmNvbnRyb2xsZXJJRF07dmFyIHdpZGdldD1jb250cm9sbGVyLndpZGdldDtyZXR1cm4gdGhpcy5fc3RhcnRDb250cm9sbGVyKGNvbnRyb2xsZXIpLnRoZW4oZnVuY3Rpb24oY29udHJvbGxlcil7dmFyIHByZXZEaWFsb2dPbkNsb3NlO2lmKHNlbGYuY3VycmVudERpYWxvZ0NvbnRyb2xsZXIpe3ByZXZEaWFsb2dPbkNsb3NlPXNlbGYuY3VycmVudERpYWxvZ0NvbnRyb2xsZXIub25DbG9zZTtzZWxmLl9jbG9zZURpYWxvZyh7c2lsZW50OnRydWV9KTt9CmNvbnRyb2xsZXIub25DbG9zZT1wcmV2RGlhbG9nT25DbG9zZXx8b3B0aW9ucy5vbl9jbG9zZTt2YXIgZGlhbG9nPW5ldyBEaWFsb2coc2VsZixfLmRlZmF1bHRzKHt9LG9wdGlvbnMse2J1dHRvbnM6W10sZGlhbG9nQ2xhc3M6Y29udHJvbGxlci5jbGFzc05hbWUsdGl0bGU6YWN0aW9uLm5hbWUsc2l6ZTphY3Rpb24uY29udGV4dC5kaWFsb2dfc2l6ZSx9KSk7ZGlhbG9nLm9uKCdjbG9zZWQnLHNlbGYsZnVuY3Rpb24ob3B0aW9ucyl7b3B0aW9ucz1vcHRpb25zfHx7fTtzZWxmLl9yZW1vdmVBY3Rpb24oYWN0aW9uLmpzSUQpO3NlbGYuY3VycmVudERpYWxvZ0NvbnRyb2xsZXI9bnVsbDtpZihvcHRpb25zLnNpbGVudCE9PXRydWUpe2NvbnRyb2xsZXIub25DbG9zZShvcHRpb25zLmluZm9zKTt9fSk7Y29udHJvbGxlci5kaWFsb2c9ZGlhbG9nO3JldHVybiBkaWFsb2cub3BlbigpLm9wZW5lZChmdW5jdGlvbigpe3NlbGYuY3VycmVudERpYWxvZ0NvbnRyb2xsZXI9Y29udHJvbGxlcjtkb20uYXBwZW5kKGRpYWxvZy4kZWwsd2lkZ2V0LiRlbCx7aW5fRE9NOnRydWUsY2FsbGJhY2tzOlt7d2lkZ2V0OmRpYWxvZ30se3dpZGdldDpjb250cm9sbGVyLndpZGdldH1dLH0pO3dpZGdldC5yZW5kZXJCdXR0b25zKGRpYWxvZy4kZm9vdGVyKTtkaWFsb2cucmViaW5kQnV0dG9uQmVoYXZpb3IoKTtyZXR1cm4gYWN0aW9uO30pO30pLmd1YXJkZWRDYXRjaChmdW5jdGlvbigpe3NlbGYuX3JlbW92ZUFjdGlvbihhY3Rpb24uanNJRCk7fSk7fSxfZXhlY3V0ZUNsaWVudEFjdGlvbjpmdW5jdGlvbihhY3Rpb24sb3B0aW9ucyl7dmFyIHNlbGY9dGhpczt2YXIgQ2xpZW50QWN0aW9uPWNvcmUuYWN0aW9uX3JlZ2lzdHJ5LmdldChhY3Rpb24udGFnKTtpZighQ2xpZW50QWN0aW9uKXtjb25zb2xlLmVycm9yKCJDb3VsZCBub3QgZmluZCBjbGllbnQgYWN0aW9uICIrYWN0aW9uLnRhZyxhY3Rpb24pO3JldHVybiBQcm9taXNlLnJlamVjdCgpO30KaWYoIShDbGllbnRBY3Rpb24ucHJvdG90eXBlIGluc3RhbmNlb2YgQWJzdHJhY3RBY3Rpb24pKXtjb25zb2xlLndhcm4oJ1RoZSBjbGllbnQgYWN0aW9uICcrYWN0aW9uLnRhZysnIHNob3VsZCBiZSBhbiBpbnN0YW5jZSBvZiBBYnN0cmFjdEFjdGlvbiEnKTt9CmlmKCEoQ2xpZW50QWN0aW9uLnByb3RvdHlwZSBpbnN0YW5jZW9mIFdpZGdldCkpe3ZhciBuZXh0PUNsaWVudEFjdGlvbih0aGlzLGFjdGlvbik7aWYobmV4dCl7cmV0dXJuIHRoaXMuZG9BY3Rpb24obmV4dCxvcHRpb25zKTt9CnJldHVybiBQcm9taXNlLnJlc29sdmUoKTt9CnZhciBjb250cm9sbGVySUQ9Xy51bmlxdWVJZCgnY29udHJvbGxlcl8nKTt2YXIgaW5kZXg9dGhpcy5fZ2V0Q29udHJvbGxlclN0YWNrSW5kZXgob3B0aW9ucyk7b3B0aW9ucy5icmVhZGNydW1icz10aGlzLl9nZXRCcmVhZGNydW1icyh0aGlzLmNvbnRyb2xsZXJTdGFjay5zbGljZSgwLGluZGV4KSk7b3B0aW9ucy5jb250cm9sbGVySUQ9Y29udHJvbGxlcklEO3ZhciB3aWRnZXQ9bmV3IENsaWVudEFjdGlvbih0aGlzLGFjdGlvbixvcHRpb25zKTt2YXIgY29udHJvbGxlcj17YWN0aW9uSUQ6YWN0aW9uLmpzSUQsaW5kZXg6aW5kZXgsanNJRDpjb250cm9sbGVySUQsdGl0bGU6d2lkZ2V0LmdldFRpdGxlKCksd2lkZ2V0OndpZGdldCx9O3RoaXMuY29udHJvbGxlcnNbY29udHJvbGxlcklEXT1jb250cm9sbGVyO2FjdGlvbi5jb250cm9sbGVySUQ9Y29udHJvbGxlcklEO3ZhciBwcm9tPXRoaXMuX2V4ZWN1dGVBY3Rpb24oYWN0aW9uLG9wdGlvbnMpO3Byb20udGhlbihmdW5jdGlvbigpe3NlbGYuX3B1c2hTdGF0ZShjb250cm9sbGVySUQse30pO30pO3JldHVybiBwcm9tO30sX2V4ZWN1dGVDbG9zZUFjdGlvbjpmdW5jdGlvbihhY3Rpb24sb3B0aW9ucyl7dmFyIHJlc3VsdDtpZighdGhpcy5jdXJyZW50RGlhbG9nQ29udHJvbGxlcil7cmVzdWx0PW9wdGlvbnMub25fY2xvc2UoYWN0aW9uLmluZm9zKTt9CnRoaXMuX2Nsb3NlRGlhbG9nKHtpbmZvczphY3Rpb24uaW5mb3N9KTtpZihhY3Rpb24uZWZmZWN0KXt0aGlzLnRyaWdnZXJfdXAoJ3Nob3dfZWZmZWN0JyxhY3Rpb24uZWZmZWN0KTt9CnJldHVybiBQcm9taXNlLnJlc29sdmUocmVzdWx0KTt9LF9leGVjdXRlU2VydmVyQWN0aW9uOmZ1bmN0aW9uKGFjdGlvbixvcHRpb25zKXt2YXIgc2VsZj10aGlzO3ZhciBydW5EZWY9dGhpcy5fcnBjKHtyb3V0ZTonL3dlYi9hY3Rpb24vcnVuJyxwYXJhbXM6e2FjdGlvbl9pZDphY3Rpb24uaWQsY29udGV4dDphY3Rpb24uY29udGV4dHx8e30sfSx9KTtyZXR1cm4gdGhpcy5kcC5hZGQocnVuRGVmKS50aGVuKGZ1bmN0aW9uKGFjdGlvbil7YWN0aW9uPWFjdGlvbnx8e3R5cGU6J2lyLmFjdGlvbnMuYWN0X3dpbmRvd19jbG9zZSd9O3JldHVybiBzZWxmLmRvQWN0aW9uKGFjdGlvbixvcHRpb25zKTt9KTt9LF9leGVjdXRlVVJMQWN0aW9uOmZ1bmN0aW9uKGFjdGlvbixvcHRpb25zKXt2YXIgdXJsPWFjdGlvbi51cmw7aWYoYWN0aW9uLnRhcmdldD09PSdzZWxmJyl7ZnJhbWV3b3JrLnJlZGlyZWN0KHVybCk7cmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO31lbHNle3ZhciB3PXdpbmRvdy5vcGVuKHVybCwnX2JsYW5rJyk7aWYoIXd8fHcuY2xvc2VkfHx0eXBlb2Ygdy5jbG9zZWQ9PT0ndW5kZWZpbmVkJyl7dmFyIG1lc3NhZ2U9X3QoJ0EgcG9wdXAgd2luZG93IGhhcyBiZWVuIGJsb2NrZWQuIFlvdSAnKydtYXkgbmVlZCB0byBjaGFuZ2UgeW91ciBicm93c2VyIHNldHRpbmdzIHRvIGFsbG93ICcrJ3BvcHVwIHdpbmRvd3MgZm9yIHRoaXMgcGFnZS4nKTt0aGlzLmRvX3dhcm4oX3QoJ1dhcm5pbmcnKSxtZXNzYWdlLHRydWUpO319Cm9wdGlvbnMub25fY2xvc2UoKTtyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7fSxfZ2V0QnJlYWRjcnVtYnM6ZnVuY3Rpb24oY29udHJvbGxlclN0YWNrKXt2YXIgc2VsZj10aGlzO3JldHVybiBfLm1hcChjb250cm9sbGVyU3RhY2ssZnVuY3Rpb24oY29udHJvbGxlcklEKXtyZXR1cm57Y29udHJvbGxlcklEOmNvbnRyb2xsZXJJRCx0aXRsZTpzZWxmLmNvbnRyb2xsZXJzW2NvbnRyb2xsZXJJRF0udGl0bGUsfTt9KTt9LF9nZXRDb250cm9sbGVyU3RhY2tJbmRleDpmdW5jdGlvbihvcHRpb25zKXt2YXIgaW5kZXg7aWYoJ2luZGV4J2luIG9wdGlvbnMpe2luZGV4PW9wdGlvbnMuaW5kZXg7fWVsc2UgaWYob3B0aW9ucy5jbGVhcl9icmVhZGNydW1icyl7aW5kZXg9MDt9ZWxzZSBpZihvcHRpb25zLnJlcGxhY2VfbGFzdF9hY3Rpb24pe2luZGV4PXRoaXMuY29udHJvbGxlclN0YWNrLmxlbmd0aC0xO31lbHNle2luZGV4PXRoaXMuY29udHJvbGxlclN0YWNrLmxlbmd0aDt9CnJldHVybiBpbmRleDt9LF9nZXRDb250cm9sbGVyU3RhdGU6ZnVuY3Rpb24oY29udHJvbGxlcklEKXt2YXIgY29udHJvbGxlcj10aGlzLmNvbnRyb2xsZXJzW2NvbnRyb2xsZXJJRF07dmFyIGFjdGlvbj10aGlzLmFjdGlvbnNbY29udHJvbGxlci5hY3Rpb25JRF07dmFyIHN0YXRlPXt0aXRsZTpjb250cm9sbGVyLndpZGdldC5nZXRUaXRsZSgpLH07aWYoYWN0aW9uLmlkKXtzdGF0ZS5hY3Rpb249YWN0aW9uLmlkO31lbHNlIGlmKGFjdGlvbi50eXBlPT09J2lyLmFjdGlvbnMuY2xpZW50Jyl7c3RhdGUuYWN0aW9uPWFjdGlvbi50YWc7dmFyIHBhcmFtcz1fLnBpY2soYWN0aW9uLnBhcmFtcyxmdW5jdGlvbih2KXtyZXR1cm4gXy5pc1N0cmluZyh2KXx8Xy5pc051bWJlcih2KTt9KTtzdGF0ZT1fLmV4dGVuZChwYXJhbXN8fHt9LHN0YXRlKTt9CmlmKGFjdGlvbi5jb250ZXh0KXt2YXIgYWN0aXZlX2lkPWFjdGlvbi5jb250ZXh0LmFjdGl2ZV9pZDtpZihhY3RpdmVfaWQpe3N0YXRlLmFjdGl2ZV9pZD1hY3RpdmVfaWQ7fQp2YXIgYWN0aXZlX2lkcz1hY3Rpb24uY29udGV4dC5hY3RpdmVfaWRzO2lmKGFjdGl2ZV9pZHMmJiEoYWN0aXZlX2lkcy5sZW5ndGg9PT0xJiZhY3RpdmVfaWRzWzBdPT09YWN0aXZlX2lkKSl7c3RhdGUuYWN0aXZlX2lkcz1hY3Rpb24uY29udGV4dC5hY3RpdmVfaWRzLmpvaW4oJywnKTt9fQpyZXR1cm4gc3RhdGU7fSxfZ2V0U2Nyb2xsUG9zaXRpb246ZnVuY3Rpb24oKXt2YXIgc2Nyb2xsUG9zaXRpb247dGhpcy50cmlnZ2VyX3VwKCdnZXRTY3JvbGxQb3NpdGlvbicse2NhbGxiYWNrOmZ1bmN0aW9uKF9zY3JvbGxQb3NpdGlvbil7c2Nyb2xsUG9zaXRpb249X3Njcm9sbFBvc2l0aW9uO319KTtyZXR1cm4gc2Nyb2xsUG9zaXRpb247fSxfaGFuZGxlQWN0aW9uOmZ1bmN0aW9uKGFjdGlvbixvcHRpb25zKXtpZighYWN0aW9uLnR5cGUpe2NvbnNvbGUuZXJyb3IoIk5vIHR5cGUgZm9yIGFjdGlvbiIsYWN0aW9uKTtyZXR1cm4gUHJvbWlzZS5yZWplY3QoKTt9CnN3aXRjaChhY3Rpb24udHlwZSl7Y2FzZSdpci5hY3Rpb25zLmFjdF91cmwnOnJldHVybiB0aGlzLl9leGVjdXRlVVJMQWN0aW9uKGFjdGlvbixvcHRpb25zKTtjYXNlJ2lyLmFjdGlvbnMuYWN0X3dpbmRvd19jbG9zZSc6cmV0dXJuIHRoaXMuX2V4ZWN1dGVDbG9zZUFjdGlvbihhY3Rpb24sb3B0aW9ucyk7Y2FzZSdpci5hY3Rpb25zLmNsaWVudCc6cmV0dXJuIHRoaXMuX2V4ZWN1dGVDbGllbnRBY3Rpb24oYWN0aW9uLG9wdGlvbnMpO2Nhc2UnaXIuYWN0aW9ucy5zZXJ2ZXInOnJldHVybiB0aGlzLl9leGVjdXRlU2VydmVyQWN0aW9uKGFjdGlvbixvcHRpb25zKTtkZWZhdWx0OmNvbnNvbGUuZXJyb3IoIlRoZSBBY3Rpb25NYW5hZ2VyIGNhbid0IGhhbmRsZSBhY3Rpb25zIG9mIHR5cGUgIisKYWN0aW9uLnR5cGUsYWN0aW9uKTtyZXR1cm4gUHJvbWlzZS5yZWplY3QoKTt9fSxfcHVzaENvbnRyb2xsZXI6ZnVuY3Rpb24oY29udHJvbGxlcil7dmFyIHNlbGY9dGhpczt0aGlzLl9kZXRhY2hDdXJyZW50Q29udHJvbGxlcigpO3ZhciB0b0Rlc3Ryb3k9dGhpcy5jb250cm9sbGVyU3RhY2suc2xpY2UoY29udHJvbGxlci5pbmRleCk7dG9EZXN0cm95PV8ucmVqZWN0KHRvRGVzdHJveSxmdW5jdGlvbihjb250cm9sbGVySUQpe3JldHVybiBjb250cm9sbGVySUQ9PT1jb250cm9sbGVyLmpzSUR8fHNlbGYuY29udHJvbGxlcnNbY29udHJvbGxlcklEXS5hY3Rpb25JRD09PWNvbnRyb2xsZXIuYWN0aW9uSUQ7fSk7dGhpcy5fcmVtb3ZlQ29udHJvbGxlcnModG9EZXN0cm95KTt0aGlzLmNvbnRyb2xsZXJTdGFjaz10aGlzLmNvbnRyb2xsZXJTdGFjay5zbGljZSgwLGNvbnRyb2xsZXIuaW5kZXgpO3RoaXMuY29udHJvbGxlclN0YWNrLnB1c2goY29udHJvbGxlci5qc0lEKTt0aGlzLl9hcHBlbmRDb250cm9sbGVyKGNvbnRyb2xsZXIpO3RoaXMudHJpZ2dlcl91cCgnY3VycmVudF9hY3Rpb25fdXBkYXRlZCcse2FjdGlvbjp0aGlzLmdldEN1cnJlbnRBY3Rpb24oKSxjb250cm9sbGVyOmNvbnRyb2xsZXIsfSk7Y29yZS5idXMudHJpZ2dlcignY2xvc2VfZGlhbG9ncycpO3RoaXMuX3RvZ2dsZUZ1bGxzY3JlZW4oKTt9LF9wdXNoU3RhdGU6ZnVuY3Rpb24oY29udHJvbGxlcklELHN0YXRlKXt2YXIgY29udHJvbGxlcj10aGlzLmNvbnRyb2xsZXJzW2NvbnRyb2xsZXJJRF07aWYoY29udHJvbGxlcil7dmFyIGFjdGlvbj10aGlzLmFjdGlvbnNbY29udHJvbGxlci5hY3Rpb25JRF07aWYoYWN0aW9uLnRhcmdldD09PSduZXcnfHxhY3Rpb24ucHVzaFN0YXRlPT09ZmFsc2Upe3JldHVybjt9CnN0YXRlPV8uZXh0ZW5kKHt9LHN0YXRlLHRoaXMuX2dldENvbnRyb2xsZXJTdGF0ZShjb250cm9sbGVyLmpzSUQpKTt0aGlzLnRyaWdnZXJfdXAoJ3B1c2hfc3RhdGUnLHtzdGF0ZTpzdGF0ZX0pO319LF9sb2FkQWN0aW9uOmZ1bmN0aW9uKGFjdGlvbklELGNvbnRleHQpe3ZhciBzZWxmPXRoaXM7cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUscmVqZWN0KXtzZWxmLnRyaWdnZXJfdXAoJ2xvYWRfYWN0aW9uJyx7YWN0aW9uSUQ6YWN0aW9uSUQsY29udGV4dDpjb250ZXh0LG9uX3N1Y2Nlc3M6cmVzb2x2ZSx9KTt9KTt9LF9wcmVwcm9jZXNzQWN0aW9uOmZ1bmN0aW9uKGFjdGlvbixvcHRpb25zKXt2YXIgY29udGV4dD1uZXcgQ29udGV4dCh0aGlzLnVzZXJDb250ZXh0LG9wdGlvbnMuYWRkaXRpb25hbF9jb250ZXh0LGFjdGlvbi5jb250ZXh0KTthY3Rpb24uY29udGV4dD1weVV0aWxzLmV2YWwoJ2NvbnRleHQnLGNvbnRleHQpO2lmKGFjdGlvbi5kb21haW4pe2FjdGlvbi5kb21haW49cHlVdGlscy5ldmFsKCdkb21haW4nLGFjdGlvbi5kb21haW4sYWN0aW9uLmNvbnRleHQpO30KYWN0aW9uLl9vcmlnaW5hbEFjdGlvbj1KU09OLnN0cmluZ2lmeShhY3Rpb24pO2FjdGlvbi5qc0lEPV8udW5pcXVlSWQoJ2FjdGlvbl8nKTthY3Rpb24ucHVzaFN0YXRlPW9wdGlvbnMucHVzaFN0YXRlO30sX3JlbW92ZUFjdGlvbjpmdW5jdGlvbihhY3Rpb25JRCl7dmFyIGFjdGlvbj10aGlzLmFjdGlvbnNbYWN0aW9uSURdO3ZhciBjb250cm9sbGVyPXRoaXMuY29udHJvbGxlcnNbYWN0aW9uLmNvbnRyb2xsZXJJRF07ZGVsZXRlIHRoaXMuYWN0aW9uc1thY3Rpb24uanNJRF07ZGVsZXRlIHRoaXMuY29udHJvbGxlcnNbYWN0aW9uLmNvbnRyb2xsZXJJRF07Y29udHJvbGxlci53aWRnZXQuZGVzdHJveSgpO30sX3JlbW92ZUNvbnRyb2xsZXJzOmZ1bmN0aW9uKGNvbnRyb2xsZXJJRHMpe3ZhciBzZWxmPXRoaXM7dmFyIGFjdGlvbnNUb1JlbW92ZT1fLm1hcChjb250cm9sbGVySURzLGZ1bmN0aW9uKGNvbnRyb2xsZXJJRCl7cmV0dXJuIHNlbGYuY29udHJvbGxlcnNbY29udHJvbGxlcklEXS5hY3Rpb25JRDt9KTtfLmVhY2goXy51bmlxKGFjdGlvbnNUb1JlbW92ZSksdGhpcy5fcmVtb3ZlQWN0aW9uLmJpbmQodGhpcykpO30sX3Jlc3RvcmVDb250cm9sbGVyOmZ1bmN0aW9uKGNvbnRyb2xsZXJJRCl7dmFyIHNlbGY9dGhpczt2YXIgY29udHJvbGxlcj10aGlzLmNvbnRyb2xsZXJzW2NvbnRyb2xsZXJJRF07dmFyIGFjdGlvbj10aGlzLmFjdGlvbnNbY29udHJvbGxlci5hY3Rpb25JRF07dmFyIGRlZjtpZihhY3Rpb24ub25fcmV2ZXJzZV9icmVhZGNydW1iKXtkZWY9YWN0aW9uLm9uX3JldmVyc2VfYnJlYWRjcnVtYigpO30KcmV0dXJuIFByb21pc2UucmVzb2x2ZShkZWYpLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGNvbnRyb2xsZXIud2lkZ2V0LmRvX3Nob3coKSkudGhlbihmdW5jdGlvbigpe3ZhciBpbmRleD1fLmluZGV4T2Yoc2VsZi5jb250cm9sbGVyU3RhY2ssY29udHJvbGxlcklEKTtzZWxmLl9wdXNoQ29udHJvbGxlcihjb250cm9sbGVyLGluZGV4KTt9KTt9KTt9LF9zdGFydENvbnRyb2xsZXI6ZnVuY3Rpb24oY29udHJvbGxlcil7dmFyIGZyYWdtZW50PWRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtyZXR1cm4gY29udHJvbGxlci53aWRnZXQuYXBwZW5kVG8oZnJhZ21lbnQpLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gY29udHJvbGxlcjt9KTt9LF90b2dnbGVGdWxsc2NyZWVuOmZ1bmN0aW9uKCl7dmFyIHNlbGY9dGhpczt2YXIgZnVsbHNjcmVlbj1fLnNvbWUodGhpcy5jb250cm9sbGVyU3RhY2ssZnVuY3Rpb24oY29udHJvbGxlcklEKXt2YXIgY29udHJvbGxlcj1zZWxmLmNvbnRyb2xsZXJzW2NvbnRyb2xsZXJJRF07cmV0dXJuIHNlbGYuYWN0aW9uc1tjb250cm9sbGVyLmFjdGlvbklEXS50YXJnZXQ9PT0nZnVsbHNjcmVlbic7fSk7dGhpcy50cmlnZ2VyX3VwKCd0b2dnbGVfZnVsbHNjcmVlbicse2Z1bGxzY3JlZW46ZnVsbHNjcmVlbn0pO30sX29uQnJlYWRjcnVtYkNsaWNrZWQ6ZnVuY3Rpb24oZXYpe2V2LnN0b3BQcm9wYWdhdGlvbigpO3RoaXMuX3Jlc3RvcmVDb250cm9sbGVyKGV2LmRhdGEuY29udHJvbGxlcklEKTt9LF9vbkhpc3RvcnlCYWNrOmZ1bmN0aW9uKCl7aWYodGhpcy5jdXJyZW50RGlhbG9nQ29udHJvbGxlcil7dGhpcy5fY2xvc2VEaWFsb2coKTt9ZWxzZXt2YXIgbGVuZ3RoPXRoaXMuY29udHJvbGxlclN0YWNrLmxlbmd0aDtpZihsZW5ndGg+MSl7dGhpcy5fcmVzdG9yZUNvbnRyb2xsZXIodGhpcy5jb250cm9sbGVyU3RhY2tbbGVuZ3RoLTJdKTt9fX0sX29uUHVzaFN0YXRlOmZ1bmN0aW9uKGV2KXtpZihldi50YXJnZXQhPT10aGlzKXtldi5zdG9wUHJvcGFnYXRpb24oKTt0aGlzLl9wdXNoU3RhdGUoZXYuZGF0YS5jb250cm9sbGVySUQsZXYuZGF0YS5zdGF0ZSk7fX0sX29uUmVkaXJlY3Q6ZnVuY3Rpb24oZXYpe3RoaXMuZG9fYWN0aW9uKHt0eXBlOidpci5hY3Rpb25zLmFjdF93aW5kb3cnLHZpZXdfbW9kZTonZm9ybScscmVzX21vZGVsOmV2LmRhdGEucmVzX21vZGVsLHZpZXdzOltbZmFsc2UsJ2Zvcm0nXV0scmVzX2lkOmV2LmRhdGEucmVzX2lkLH0pO30sfSk7cmV0dXJuIEFjdGlvbk1hbmFnZXI7fSk7OwoKLyogL3dlYi9zdGF0aWMvc3JjL2pzL2Nocm9tZS9hY3Rpb25fbWFuYWdlcl9hY3Rfd2luZG93LmpzIGRlZmluZWQgaW4gYnVuZGxlICd3ZWIuYXNzZXRzX2JhY2tlbmQnICovCm9kb28uZGVmaW5lKCd3ZWIuQWN0V2luZG93QWN0aW9uTWFuYWdlcicsZnVuY3Rpb24ocmVxdWlyZSl7InVzZSBzdHJpY3QiO3ZhciBBY3Rpb25NYW5hZ2VyPXJlcXVpcmUoJ3dlYi5BY3Rpb25NYW5hZ2VyJyk7dmFyIGNvbmZpZz1yZXF1aXJlKCd3ZWIuY29uZmlnJyk7dmFyIENvbnRleHQ9cmVxdWlyZSgnd2ViLkNvbnRleHQnKTt2YXIgY29yZT1yZXF1aXJlKCd3ZWIuY29yZScpO3ZhciBweVV0aWxzPXJlcXVpcmUoJ3dlYi5weV91dGlscycpO3ZhciB2aWV3X3JlZ2lzdHJ5PXJlcXVpcmUoJ3dlYi52aWV3X3JlZ2lzdHJ5Jyk7QWN0aW9uTWFuYWdlci5pbmNsdWRlKHtjdXN0b21fZXZlbnRzOl8uZXh0ZW5kKHt9LEFjdGlvbk1hbmFnZXIucHJvdG90eXBlLmN1c3RvbV9ldmVudHMse2V4ZWN1dGVfYWN0aW9uOidfb25FeGVjdXRlQWN0aW9uJyxzd2l0Y2hfdmlldzonX29uU3dpdGNoVmlldycsfSksZ2V0Q3VycmVudENvbnRyb2xsZXI6ZnVuY3Rpb24oKXt2YXIgY3VycmVudENvbnRyb2xsZXI9dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3ZhciBhY3Rpb249Y3VycmVudENvbnRyb2xsZXImJnRoaXMuYWN0aW9uc1tjdXJyZW50Q29udHJvbGxlci5hY3Rpb25JRF07aWYoYWN0aW9uJiZhY3Rpb24udHlwZT09PSdpci5hY3Rpb25zLmFjdF93aW5kb3cnJiYhY3VycmVudENvbnRyb2xsZXIud2lkZ2V0KXt2YXIgbGFzdENvbnRyb2xsZXJJRD10aGlzLmNvbnRyb2xsZXJTdGFjay5wb3AoKTtjdXJyZW50Q29udHJvbGxlcj10aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy5jb250cm9sbGVyU3RhY2sucHVzaChsYXN0Q29udHJvbGxlcklEKTt9CnJldHVybiBjdXJyZW50Q29udHJvbGxlcjt9LGxvYWRTdGF0ZTpmdW5jdGlvbihzdGF0ZSl7dmFyIGNhbGxlcnNBcmd1bWVudHM9YXJndW1lbnRzO3ZhciBfc3VwZXI9dGhpcy5fc3VwZXIuYmluZCh0aGlzKTt2YXIgc2VsZj10aGlzO3ZhciBhY3Rpb247dmFyIGRlZjt2YXIgb3B0aW9ucz17Y2xlYXJfYnJlYWRjcnVtYnM6dHJ1ZSxwdXNoU3RhdGU6ZmFsc2UsfTtpZihzdGF0ZS5hY3Rpb24pe3ZhciBjdXJyZW50Q29udHJvbGxlcj10aGlzLmdldEN1cnJlbnRDb250cm9sbGVyKCk7dmFyIGN1cnJlbnRBY3Rpb249Y3VycmVudENvbnRyb2xsZXImJnRoaXMuYWN0aW9uc1tjdXJyZW50Q29udHJvbGxlci5hY3Rpb25JRF07aWYoY3VycmVudEFjdGlvbiYmY3VycmVudEFjdGlvbi5pZD09PXN0YXRlLmFjdGlvbiYmY3VycmVudEFjdGlvbi50eXBlPT09J2lyLmFjdGlvbnMuYWN0X3dpbmRvdycpe3RoaXMuX2Nsb3NlRGlhbG9nKHRydWUpO3ZhciB2aWV3T3B0aW9ucz17Y3VycmVudElkOnN0YXRlLmlkfTt2YXIgdmlld1R5cGU9c3RhdGUudmlld190eXBlfHxjdXJyZW50Q29udHJvbGxlci52aWV3VHlwZTtyZXR1cm4gdGhpcy5fc3dpdGNoQ29udHJvbGxlcihjdXJyZW50QWN0aW9uLHZpZXdUeXBlLHZpZXdPcHRpb25zKTt9ZWxzZSBpZighY29yZS5hY3Rpb25fcmVnaXN0cnkuY29udGFpbnMoc3RhdGUuYWN0aW9uKSl7dmFyIGNvbnRleHQ9e307aWYoc3RhdGUuYWN0aXZlX2lkKXtjb250ZXh0LmFjdGl2ZV9pZD1zdGF0ZS5hY3RpdmVfaWQ7fQppZihzdGF0ZS5hY3RpdmVfaWRzKXtjb250ZXh0LmFjdGl2ZV9pZHM9c3RhdGUuYWN0aXZlX2lkcy5zcGxpdCgnLCcpLm1hcChmdW5jdGlvbihpZCl7cmV0dXJuIHBhcnNlSW50KGlkLDEwKXx8aWQ7fSk7fWVsc2UgaWYoc3RhdGUuYWN0aXZlX2lkKXtjb250ZXh0LmFjdGl2ZV9pZHM9W3N0YXRlLmFjdGl2ZV9pZF07fQpjb250ZXh0LnBhcmFtcz1zdGF0ZTthY3Rpb249c3RhdGUuYWN0aW9uO29wdGlvbnM9Xy5leHRlbmQob3B0aW9ucyx7YWRkaXRpb25hbF9jb250ZXh0OmNvbnRleHQscmVzSUQ6c3RhdGUuaWR8fHVuZGVmaW5lZCx2aWV3VHlwZTpzdGF0ZS52aWV3X3R5cGUsfSk7fX1lbHNlIGlmKHN0YXRlLm1vZGVsJiZzdGF0ZS5pZCl7YWN0aW9uPXtyZXNfbW9kZWw6c3RhdGUubW9kZWwscmVzX2lkOnN0YXRlLmlkLHR5cGU6J2lyLmFjdGlvbnMuYWN0X3dpbmRvdycsdmlld3M6W1tzdGF0ZS52aWV3X2lkfHxmYWxzZSwnZm9ybSddXSx9O31lbHNlIGlmKHN0YXRlLm1vZGVsJiZzdGF0ZS52aWV3X3R5cGUpe3ZhciBzdG9yZWRBY3Rpb249dGhpcy5jYWxsKCdzZXNzaW9uX3N0b3JhZ2UnLCdnZXRJdGVtJywnY3VycmVudF9hY3Rpb24nKTt2YXIgbGFzdEFjdGlvbj1KU09OLnBhcnNlKHN0b3JlZEFjdGlvbnx8J3t9Jyk7aWYobGFzdEFjdGlvbi5yZXNfbW9kZWw9PT1zdGF0ZS5tb2RlbCl7YWN0aW9uPWxhc3RBY3Rpb247b3B0aW9ucy52aWV3VHlwZT1zdGF0ZS52aWV3X3R5cGU7fX1lbHNlIGlmKHN0YXRlLnNhKXtkZWY9dGhpcy5fcnBjKHtyb3V0ZTonL3dlYi9zZXNzaW9uL2dldF9zZXNzaW9uX2FjdGlvbicscGFyYW1zOntrZXk6c3RhdGUuc2F9LH0pLnRoZW4oZnVuY3Rpb24oc2Vzc2lvbkFjdGlvbil7YWN0aW9uPXNlc3Npb25BY3Rpb247fSk7fQpyZXR1cm4gUHJvbWlzZS5hbGwoW2RlZl0pLnRoZW4oZnVuY3Rpb24oKXtpZihhY3Rpb24pe3JldHVybiBzZWxmLmRvQWN0aW9uKGFjdGlvbixvcHRpb25zKTt9CnJldHVybiBfc3VwZXIuYXBwbHkoc2VsZixjYWxsZXJzQXJndW1lbnRzKTt9KTt9LF9jcmVhdGVWaWV3Q29udHJvbGxlcjpmdW5jdGlvbihhY3Rpb24sdmlld1R5cGUsdmlld09wdGlvbnMsb3B0aW9ucyl7dmFyIHNlbGY9dGhpczt2YXIgdmlld0Rlc2NyPV8uZmluZFdoZXJlKGFjdGlvbi52aWV3cyx7dHlwZTp2aWV3VHlwZX0pO2lmKCF2aWV3RGVzY3Ipe3JldHVybiBQcm9taXNlLnJlamVjdCgpO30Kb3B0aW9ucz1vcHRpb25zfHx7fTt2YXIgaW5kZXg9b3B0aW9ucy5pbmRleHx8MDt2YXIgY29udHJvbGxlcklEPW9wdGlvbnMuY29udHJvbGxlcklEfHxfLnVuaXF1ZUlkKCdjb250cm9sbGVyXycpO3ZhciBjb250cm9sbGVyPXthY3Rpb25JRDphY3Rpb24uanNJRCxjbGFzc05hbWU6J29fYWN0X3dpbmRvdycsaW5kZXg6aW5kZXgsanNJRDpjb250cm9sbGVySUQsdmlld1R5cGU6dmlld1R5cGUsfTtPYmplY3QuZGVmaW5lUHJvcGVydHkoY29udHJvbGxlciwndGl0bGUnLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gY29udHJvbGxlci53aWRnZXQ/Y29udHJvbGxlci53aWRnZXQuZ2V0VGl0bGUoKTooYWN0aW9uLmRpc3BsYXlfbmFtZXx8YWN0aW9uLm5hbWUpO30sfSk7dGhpcy5jb250cm9sbGVyc1tjb250cm9sbGVySURdPWNvbnRyb2xsZXI7aWYoIW9wdGlvbnMubGF6eSl7dmFyIGZsYWdzPWFjdGlvbi5mbGFnc3x8e307dmlld09wdGlvbnM9Xy5leHRlbmQoe30sZmxhZ3MsZmxhZ3Nbdmlld1R5cGVdLHZpZXdPcHRpb25zLHthY3Rpb246YWN0aW9uLGJyZWFkY3J1bWJzOnRoaXMuX2dldEJyZWFkY3J1bWJzKHRoaXMuY29udHJvbGxlclN0YWNrLnNsaWNlKDAsaW5kZXgpKSxjb250cm9sbGVySUQ6Y29udHJvbGxlcklELH0pO3ZhciByZWplY3Rpb247dmFyIHZpZXc9bmV3IHZpZXdEZXNjci5XaWRnZXQodmlld0Rlc2NyLmZpZWxkc1ZpZXcsdmlld09wdGlvbnMpO3ZhciBkZWY9bmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSxyZWplY3Qpe3JlamVjdGlvbj1yZWplY3Q7dmlldy5nZXRDb250cm9sbGVyKHNlbGYpLnRoZW4oZnVuY3Rpb24od2lkZ2V0KXtpZihkZWYucmVqZWN0ZWQpe3dpZGdldC5kZXN0cm95KCk7fWVsc2V7Y29udHJvbGxlci53aWRnZXQ9d2lkZ2V0O3Jlc29sdmUoY29udHJvbGxlcik7fX0pLmd1YXJkZWRDYXRjaChyZWplY3QpO30pO2RlZi5yZWplY3Q9cmVqZWN0aW9uO2RlZi5ndWFyZGVkQ2F0Y2goZnVuY3Rpb24oKXtkZWYucmVqZWN0ZWQ9dHJ1ZTtkZWxldGUgc2VsZi5jb250cm9sbGVyc1tjb250cm9sbGVySURdO30pO2FjdGlvbi5jb250cm9sbGVyc1t2aWV3VHlwZV09ZGVmO31lbHNle2FjdGlvbi5jb250cm9sbGVyc1t2aWV3VHlwZV09UHJvbWlzZS5yZXNvbHZlKGNvbnRyb2xsZXIpO30KcmV0dXJuIGFjdGlvbi5jb250cm9sbGVyc1t2aWV3VHlwZV07fSxfZGVzdHJveVdpbmRvd0FjdGlvbjpmdW5jdGlvbihhY3Rpb24pe3ZhciBzZWxmPXRoaXM7Zm9yKHZhciBjIGluIGFjdGlvbi5jb250cm9sbGVycyl7dmFyIGNvbnRyb2xsZXJEZWY9YWN0aW9uLmNvbnRyb2xsZXJzW2NdO2NvbnRyb2xsZXJEZWYudGhlbihmdW5jdGlvbihjb250cm9sbGVyKXtkZWxldGUgc2VsZi5jb250cm9sbGVyc1tjb250cm9sbGVyLmpzSURdO2lmKGNvbnRyb2xsZXIud2lkZ2V0KXtjb250cm9sbGVyLndpZGdldC5kZXN0cm95KCk7fX0pO2lmKGNvbnRyb2xsZXJEZWYucmVqZWN0KXtjb250cm9sbGVyRGVmLnJlamVjdCgpO319fSxfZXhlY3V0ZVdpbmRvd0FjdGlvbjpmdW5jdGlvbihhY3Rpb24sb3B0aW9ucyl7dmFyIHNlbGY9dGhpcztyZXR1cm4gdGhpcy5kcC5hZGQodGhpcy5fbG9hZFZpZXdzKGFjdGlvbikpLnRoZW4oZnVuY3Rpb24oZmllbGRzVmlld3Mpe3ZhciB2aWV3cz1zZWxmLl9nZW5lcmF0ZUFjdGlvblZpZXdzKGFjdGlvbixmaWVsZHNWaWV3cyk7YWN0aW9uLl92aWV3cz1hY3Rpb24udmlld3M7YWN0aW9uLnZpZXdzPXZpZXdzO2FjdGlvbi5jb250cm9sUGFuZWxGaWVsZHNWaWV3PWZpZWxkc1ZpZXdzLnNlYXJjaDthY3Rpb24uY29udHJvbGxlcnM9e307dmFyIGN1clZpZXc9b3B0aW9ucy52aWV3VHlwZSYmXy5maW5kV2hlcmUodmlld3Mse3R5cGU6b3B0aW9ucy52aWV3VHlwZX0pO3ZhciBsYXp5VmlldztpZihjdXJWaWV3KXtpZighY3VyVmlldy5tdWx0aVJlY29yZCYmdmlld3NbMF0ubXVsdGlSZWNvcmQpe2xhenlWaWV3PXZpZXdzWzBdO319ZWxzZXtjdXJWaWV3PXZpZXdzWzBdO30KaWYoY29uZmlnLmRldmljZS5pc01vYmlsZSl7aWYoIWN1clZpZXcuaXNNb2JpbGVGcmllbmRseSl7Y3VyVmlldz1zZWxmLl9maW5kTW9iaWxlVmlldyh2aWV3cyxjdXJWaWV3Lm11bHRpUmVjb3JkKXx8Y3VyVmlldzt9CmlmKGxhenlWaWV3JiYhbGF6eVZpZXcuaXNNb2JpbGVGcmllbmRseSl7bGF6eVZpZXc9c2VsZi5fZmluZE1vYmlsZVZpZXcodmlld3MsbGF6eVZpZXcubXVsdGlSZWNvcmQpfHxsYXp5Vmlldzt9fQp2YXIgbGF6eVZpZXdEZWY7dmFyIGxhenlDb250cm9sbGVySUQ7aWYobGF6eVZpZXcpe29wdGlvbnMuY2xlYXJfYnJlYWRjcnVtYnM9ZmFsc2U7bGF6eVZpZXdEZWY9c2VsZi5fY3JlYXRlVmlld0NvbnRyb2xsZXIoYWN0aW9uLGxhenlWaWV3LnR5cGUse30se2xhenk6dHJ1ZX0pLnRoZW4oZnVuY3Rpb24obGF6eUxvYWRlZENvbnRyb2xsZXIpe2xhenlDb250cm9sbGVySUQ9bGF6eUxvYWRlZENvbnRyb2xsZXIuanNJRDtzZWxmLmNvbnRyb2xsZXJTdGFjay5wdXNoKGxhenlMb2FkZWRDb250cm9sbGVyLmpzSUQpO30pO30KcmV0dXJuIHNlbGYuZHAuYWRkKFByb21pc2UucmVzb2x2ZShsYXp5Vmlld0RlZikpLnRoZW4oZnVuY3Rpb24oKXt2YXIgdmlld09wdGlvbnM9e2NvbnRyb2xsZXJTdGF0ZTpvcHRpb25zLmNvbnRyb2xsZXJTdGF0ZSxjdXJyZW50SWQ6b3B0aW9ucy5yZXNJRCx9O3ZhciBjdXJWaWV3RGVmPXNlbGYuX2NyZWF0ZVZpZXdDb250cm9sbGVyKGFjdGlvbixjdXJWaWV3LnR5cGUsdmlld09wdGlvbnMse2luZGV4OnNlbGYuX2dldENvbnRyb2xsZXJTdGFja0luZGV4KG9wdGlvbnMpLH0pO3JldHVybiBzZWxmLmRwLmFkZChjdXJWaWV3RGVmKTt9KS50aGVuKGZ1bmN0aW9uKGNvbnRyb2xsZXIpe2FjdGlvbi5jb250cm9sbGVySUQ9Y29udHJvbGxlci5qc0lEO3JldHVybiBzZWxmLl9leGVjdXRlQWN0aW9uKGFjdGlvbixvcHRpb25zKTt9KS5ndWFyZGVkQ2F0Y2goZnVuY3Rpb24oKXtpZihsYXp5Q29udHJvbGxlcklEKXt2YXIgaW5kZXg9c2VsZi5jb250cm9sbGVyU3RhY2suaW5kZXhPZihsYXp5Q29udHJvbGxlcklEKTtzZWxmLmNvbnRyb2xsZXJTdGFjaz1zZWxmLmNvbnRyb2xsZXJTdGFjay5zbGljZSgwLGluZGV4KTt9CnNlbGYuX2Rlc3Ryb3lXaW5kb3dBY3Rpb24oYWN0aW9uKTt9KTt9KTt9LF9maW5kTW9iaWxlVmlldzpmdW5jdGlvbih2aWV3cyxtdWx0aVJlY29yZCl7cmV0dXJuIF8uZmluZFdoZXJlKHZpZXdzLHtpc01vYmlsZUZyaWVuZGx5OnRydWUsbXVsdGlSZWNvcmQ6bXVsdGlSZWNvcmQsfSk7fSxfZ2VuZXJhdGVBY3Rpb25WaWV3czpmdW5jdGlvbihhY3Rpb24sZmllbGRzVmlld3Mpe3ZhciB2aWV3cz1bXTtfLmVhY2goYWN0aW9uLnZpZXdzLGZ1bmN0aW9uKHZpZXcpe3ZhciB2aWV3VHlwZT12aWV3WzFdO3ZhciBmaWVsZHNWaWV3PWZpZWxkc1ZpZXdzW3ZpZXdUeXBlXTt2YXIgcGFyc2VkWE1MPW5ldyBET01QYXJzZXIoKS5wYXJzZUZyb21TdHJpbmcoZmllbGRzVmlldy5hcmNoLCJ0ZXh0L3htbCIpO3ZhciBrZXk9cGFyc2VkWE1MLmRvY3VtZW50RWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2pzX2NsYXNzJyk7dmFyIFZpZXc9dmlld19yZWdpc3RyeS5nZXQoa2V5fHx2aWV3VHlwZSk7aWYoVmlldyl7dmlld3MucHVzaCh7YWNjZXNzS2V5OlZpZXcucHJvdG90eXBlLmFjY2Vzc0tleXx8Vmlldy5wcm90b3R5cGUuYWNjZXNza2V5LGRpc3BsYXlOYW1lOlZpZXcucHJvdG90eXBlLmRpc3BsYXlfbmFtZSxmaWVsZHNWaWV3OmZpZWxkc1ZpZXcsaWNvbjpWaWV3LnByb3RvdHlwZS5pY29uLGlzTW9iaWxlRnJpZW5kbHk6Vmlldy5wcm90b3R5cGUubW9iaWxlX2ZyaWVuZGx5LG11bHRpUmVjb3JkOlZpZXcucHJvdG90eXBlLm11bHRpX3JlY29yZCx0eXBlOnZpZXdUeXBlLHZpZXdJRDp2aWV3WzBdLFdpZGdldDpWaWV3LH0pO31lbHNlIGlmKGNvbmZpZy5pc0RlYnVnKCdhc3NldHMnKSl7Y29uc29sZS5sb2coIlZpZXcgdHlwZSAnIit2aWV3VHlwZSsiJyBpcyBub3QgcHJlc2VudCBpbiB0aGUgdmlldyByZWdpc3RyeS4iKTt9fSk7cmV0dXJuIHZpZXdzO30sX2dldENvbnRyb2xsZXJTdGF0ZTpmdW5jdGlvbihjb250cm9sbGVySUQpe3ZhciBzdGF0ZT10aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dmFyIGNvbnRyb2xsZXI9dGhpcy5jb250cm9sbGVyc1tjb250cm9sbGVySURdO3ZhciBhY3Rpb249dGhpcy5hY3Rpb25zW2NvbnRyb2xsZXIuYWN0aW9uSURdO2lmKGFjdGlvbi50eXBlPT09J2lyLmFjdGlvbnMuYWN0X3dpbmRvdycpe3N0YXRlLm1vZGVsPWFjdGlvbi5yZXNfbW9kZWw7c3RhdGUudmlld190eXBlPWNvbnRyb2xsZXIudmlld1R5cGU7fQpyZXR1cm4gc3RhdGU7fSxfaGFuZGxlQWN0aW9uOmZ1bmN0aW9uKGFjdGlvbixvcHRpb25zKXtpZihhY3Rpb24udHlwZT09PSdpci5hY3Rpb25zLmFjdF93aW5kb3cnKXtyZXR1cm4gdGhpcy5fZXhlY3V0ZVdpbmRvd0FjdGlvbihhY3Rpb24sb3B0aW9ucyk7fQpyZXR1cm4gdGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO30sX2xvYWRWaWV3czpmdW5jdGlvbihhY3Rpb24pe3ZhciBpbkRpYWxvZz1hY3Rpb24udGFyZ2V0PT09J25ldyc7dmFyIGlubGluZT1hY3Rpb24udGFyZ2V0PT09J2lubGluZSc7dmFyIG9wdGlvbnM9e2FjdGlvbl9pZDphY3Rpb24uaWQsdG9vbGJhcjohaW5EaWFsb2cmJiFpbmxpbmUsfTt2YXIgdmlld3M9YWN0aW9uLnZpZXdzLnNsaWNlKCk7aWYoIWlubGluZSYmIShpbkRpYWxvZyYmYWN0aW9uLnZpZXdzWzBdWzFdPT09J2Zvcm0nKSl7b3B0aW9ucy5sb2FkX2ZpbHRlcnM9dHJ1ZTt2YXIgc2VhcmNodmlld0lEPWFjdGlvbi5zZWFyY2hfdmlld19pZCYmYWN0aW9uLnNlYXJjaF92aWV3X2lkWzBdO3ZpZXdzLnB1c2goW3NlYXJjaHZpZXdJRHx8ZmFsc2UsJ3NlYXJjaCddKTt9CnJldHVybiB0aGlzLmxvYWRWaWV3cyhhY3Rpb24ucmVzX21vZGVsLGFjdGlvbi5jb250ZXh0LHZpZXdzLG9wdGlvbnMpO30sX3JlbW92ZUFjdGlvbjpmdW5jdGlvbihhY3Rpb25JRCl7dmFyIGFjdGlvbj10aGlzLmFjdGlvbnNbYWN0aW9uSURdO2lmKGFjdGlvbi50eXBlPT09J2lyLmFjdGlvbnMuYWN0X3dpbmRvdycpe2RlbGV0ZSB0aGlzLmFjdGlvbnNbYWN0aW9uLmpzSURdO3RoaXMuX2Rlc3Ryb3lXaW5kb3dBY3Rpb24oYWN0aW9uKTt9ZWxzZXt0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fX0sX3Jlc3RvcmVDb250cm9sbGVyOmZ1bmN0aW9uKGNvbnRyb2xsZXJJRCl7dmFyIHNlbGY9dGhpczt2YXIgY29udHJvbGxlcj10aGlzLmNvbnRyb2xsZXJzW2NvbnRyb2xsZXJJRF07dmFyIGFjdGlvbj10aGlzLmFjdGlvbnNbY29udHJvbGxlci5hY3Rpb25JRF07aWYoYWN0aW9uLnR5cGU9PT0naXIuYWN0aW9ucy5hY3Rfd2luZG93Jyl7cmV0dXJuIHRoaXMuY2xlYXJVbmNvbW1pdHRlZENoYW5nZXMoKS50aGVuKGZ1bmN0aW9uKCl7dmFyIGRlZj1Qcm9taXNlLnJlc29sdmUoKTtpZihhY3Rpb24ub25fcmV2ZXJzZV9icmVhZGNydW1iKXtkZWY9YWN0aW9uLm9uX3JldmVyc2VfYnJlYWRjcnVtYigpO30KcmV0dXJuIFByb21pc2UucmVzb2x2ZShkZWYpLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gc2VsZi5fc3dpdGNoQ29udHJvbGxlcihhY3Rpb24sY29udHJvbGxlci52aWV3VHlwZSk7fSk7fSk7fQpyZXR1cm4gdGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO30sX3N3aXRjaENvbnRyb2xsZXI6ZnVuY3Rpb24oYWN0aW9uLHZpZXdUeXBlLHZpZXdPcHRpb25zKXt2YXIgc2VsZj10aGlzO3ZhciB2aWV3PV8uZmluZFdoZXJlKGFjdGlvbi52aWV3cyx7dHlwZTp2aWV3VHlwZX0pO2lmKCF2aWV3KXtyZXR1cm4gUHJvbWlzZS5yZWplY3QoKTt9CnZhciBjdXJyZW50Q29udHJvbGxlcj10aGlzLmdldEN1cnJlbnRDb250cm9sbGVyKCk7dmFyIGluZGV4O2lmKGN1cnJlbnRDb250cm9sbGVyLmFjdGlvbklEIT09YWN0aW9uLmpzSUQpe3ZhciBjb250cm9sbGVyPV8uZmluZFdoZXJlKHRoaXMuY29udHJvbGxlcnMse2FjdGlvbklEOmFjdGlvbi5qc0lELHZpZXdUeXBlOnZpZXdUeXBlLH0pO2luZGV4PV8uaW5kZXhPZih0aGlzLmNvbnRyb2xsZXJTdGFjayxjb250cm9sbGVyLmpzSUQpO31lbHNle2lmKHZpZXcubXVsdGlSZWNvcmQpe2luZGV4PV8uZmluZEluZGV4KHRoaXMuY29udHJvbGxlclN0YWNrLGZ1bmN0aW9uKGNvbnRyb2xsZXJJRCl7cmV0dXJuIHNlbGYuY29udHJvbGxlcnNbY29udHJvbGxlcklEXS5hY3Rpb25JRD09PWFjdGlvbi5qc0lEO30pO31lbHNlIGlmKCFfLmZpbmRXaGVyZShhY3Rpb24udmlld3Mse3R5cGU6Y3VycmVudENvbnRyb2xsZXIudmlld1R5cGV9KS5tdWx0aVJlY29yZCl7aW5kZXg9dGhpcy5jb250cm9sbGVyU3RhY2subGVuZ3RoLTE7fWVsc2V7aW5kZXg9dGhpcy5jb250cm9sbGVyU3RhY2subGVuZ3RoO319CnZhciBuZXdDb250cm9sbGVyPWZ1bmN0aW9uKGNvbnRyb2xsZXJJRCl7dmFyIG9wdGlvbnM9e2NvbnRyb2xsZXJJRDpjb250cm9sbGVySUQsaW5kZXg6aW5kZXgsfTtyZXR1cm4gc2VsZi5fY3JlYXRlVmlld0NvbnRyb2xsZXIoYWN0aW9uLHZpZXdUeXBlLHZpZXdPcHRpb25zLG9wdGlvbnMpLnRoZW4oZnVuY3Rpb24oY29udHJvbGxlcil7cmV0dXJuIHNlbGYuX3N0YXJ0Q29udHJvbGxlcihjb250cm9sbGVyKTt9KTt9O3ZhciBjb250cm9sbGVyRGVmPWFjdGlvbi5jb250cm9sbGVyc1t2aWV3VHlwZV07aWYoY29udHJvbGxlckRlZil7Y29udHJvbGxlckRlZj1jb250cm9sbGVyRGVmLnRoZW4oZnVuY3Rpb24oY29udHJvbGxlcil7aWYoIWNvbnRyb2xsZXIud2lkZ2V0KXtyZXR1cm4gbmV3Q29udHJvbGxlcihjb250cm9sbGVyLmpzSUQpO31lbHNle3JldHVybiBQcm9taXNlLnJlc29sdmUoY29udHJvbGxlci53aWRnZXQud2lsbFJlc3RvcmUoKSkudGhlbihmdW5jdGlvbigpe3ZpZXdPcHRpb25zPV8uZXh0ZW5kKHt9LHZpZXdPcHRpb25zLHticmVhZGNydW1iczpzZWxmLl9nZXRCcmVhZGNydW1icyhzZWxmLmNvbnRyb2xsZXJTdGFjay5zbGljZSgwLGluZGV4KSksfSk7cmV0dXJuIGNvbnRyb2xsZXIud2lkZ2V0LnJlbG9hZCh2aWV3T3B0aW9ucykudGhlbihmdW5jdGlvbigpe3JldHVybiBjb250cm9sbGVyO30pO30pO319LGZ1bmN0aW9uKCl7cmV0dXJuIG5ld0NvbnRyb2xsZXIoKTt9KTt9ZWxzZXtjb250cm9sbGVyRGVmPW5ld0NvbnRyb2xsZXIoKTt9CnJldHVybiB0aGlzLmRwLmFkZChjb250cm9sbGVyRGVmKS50aGVuKGZ1bmN0aW9uKGNvbnRyb2xsZXIpe3JldHVybiBzZWxmLl9wdXNoQ29udHJvbGxlcihjb250cm9sbGVyKTt9KTt9LF9vbkV4ZWN1dGVBY3Rpb246ZnVuY3Rpb24oZXYpe2V2LnN0b3BQcm9wYWdhdGlvbigpO3ZhciBzZWxmPXRoaXM7dmFyIGFjdGlvbkRhdGE9ZXYuZGF0YS5hY3Rpb25fZGF0YTt2YXIgZW52PWV2LmRhdGEuZW52O3ZhciBjb250ZXh0PW5ldyBDb250ZXh0KGVudi5jb250ZXh0LGFjdGlvbkRhdGEuY29udGV4dHx8e30pO3ZhciByZWNvcmRJRD1lbnYuY3VycmVudElEfHxudWxsO3ZhciBkZWY7aWYoYWN0aW9uRGF0YS5zcGVjaWFsKXtkZWY9UHJvbWlzZS5yZXNvbHZlKHt0eXBlOidpci5hY3Rpb25zLmFjdF93aW5kb3dfY2xvc2UnLGluZm9zOntzcGVjaWFsOnRydWV9LH0pO31lbHNlIGlmKGFjdGlvbkRhdGEudHlwZT09PSdvYmplY3QnKXt2YXIgYXJncz1yZWNvcmRJRD9bW3JlY29yZElEXV06W2Vudi5yZXNJRHNdO2lmKGFjdGlvbkRhdGEuYXJncyl7dHJ5e3ZhciBhZGRpdGlvbmFsQXJncz1KU09OLnBhcnNlKGFjdGlvbkRhdGEuYXJncy5yZXBsYWNlKC8nL2csJyInKSk7YXJncz1hcmdzLmNvbmNhdChhZGRpdGlvbmFsQXJncyk7fWNhdGNoKGUpe2NvbnNvbGUuZXJyb3IoIkNvdWxkIG5vdCBKU09OLnBhcnNlIGFyZ3VtZW50cyIsYWN0aW9uRGF0YS5hcmdzKTt9fQpkZWY9dGhpcy5fcnBjKHtyb3V0ZTonL3dlYi9kYXRhc2V0L2NhbGxfYnV0dG9uJyxwYXJhbXM6e2FyZ3M6YXJncyxrd2FyZ3M6e2NvbnRleHQ6Y29udGV4dC5ldmFsKCl9LG1ldGhvZDphY3Rpb25EYXRhLm5hbWUsbW9kZWw6ZW52Lm1vZGVsLH0sfSk7fWVsc2UgaWYoYWN0aW9uRGF0YS50eXBlPT09J2FjdGlvbicpe2RlZj10aGlzLl9sb2FkQWN0aW9uKGFjdGlvbkRhdGEubmFtZSxfLmV4dGVuZChweVV0aWxzLmV2YWwoJ2NvbnRleHQnLGNvbnRleHQpLHthY3RpdmVfbW9kZWw6ZW52Lm1vZGVsLGFjdGl2ZV9pZHM6ZW52LnJlc0lEcyxhY3RpdmVfaWQ6cmVjb3JkSUQsfSkpO31lbHNle2RlZj1Qcm9taXNlLnJlamVjdCgpO30KZGVmLmd1YXJkZWRDYXRjaChldi5kYXRhLm9uX2ZhaWwpO3RoaXMuZHAuYWRkKGRlZikudGhlbihmdW5jdGlvbihhY3Rpb24pe3ZhciBlZmZlY3Q9ZmFsc2U7aWYoYWN0aW9uRGF0YS5lZmZlY3Qpe2VmZmVjdD1weVV0aWxzLnB5X2V2YWwoYWN0aW9uRGF0YS5lZmZlY3QpO30KaWYoYWN0aW9uJiZhY3Rpb24uY29uc3RydWN0b3I9PT1PYmplY3Qpe3ZhciBjdHg9bmV3IENvbnRleHQoXy5vYmplY3QoXy5yZWplY3QoXy5wYWlycyhlbnYuY29udGV4dCksZnVuY3Rpb24ocGFpcil7cmV0dXJuIHBhaXJbMF0ubWF0Y2goJ14oPzooPzpkZWZhdWx0X3xzZWFyY2hfZGVmYXVsdF98c2hvd18pLit8JysnLitfdmlld19yZWZ8Z3JvdXBfYnl8Z3JvdXBfYnlfbm9fbGVhZnxhY3RpdmVfaWR8JysnYWN0aXZlX2lkc3xvcmRlcmVkQnkpJCcpIT09bnVsbDt9KSkpO2N0eC5hZGQoYWN0aW9uRGF0YS5jb250ZXh0fHx7fSk7Y3R4LmFkZCh7YWN0aXZlX21vZGVsOmVudi5tb2RlbH0pO2lmKHJlY29yZElEKXtjdHguYWRkKHthY3RpdmVfaWQ6cmVjb3JkSUQsYWN0aXZlX2lkczpbcmVjb3JkSURdLH0pO30KY3R4LmFkZChhY3Rpb24uY29udGV4dHx8e30pO2FjdGlvbi5jb250ZXh0PWN0eDthY3Rpb24uZWZmZWN0PWVmZmVjdHx8YWN0aW9uLmVmZmVjdDt9ZWxzZXthY3Rpb249e2VmZmVjdDplZmZlY3QsdHlwZTonaXIuYWN0aW9ucy5hY3Rfd2luZG93X2Nsb3NlJyx9O30KdmFyIG9wdGlvbnM9e29uX2Nsb3NlOmV2LmRhdGEub25fY2xvc2VkfTthY3Rpb24uZmxhZ3M9Xy5leHRlbmQoe30sYWN0aW9uLmZsYWdzLHtzZWFyY2hQYW5lbERlZmF1bHROb0ZpbHRlcjp0cnVlfSk7cmV0dXJuIHNlbGYuZG9BY3Rpb24oYWN0aW9uLG9wdGlvbnMpLnRoZW4oZXYuZGF0YS5vbl9zdWNjZXNzLGV2LmRhdGEub25fZmFpbCk7fSk7fSxfb25Td2l0Y2hWaWV3OmZ1bmN0aW9uKGV2KXtldi5zdG9wUHJvcGFnYXRpb24oKTt2YXIgdmlld1R5cGU9ZXYuZGF0YS52aWV3X3R5cGU7dmFyIGN1cnJlbnRDb250cm9sbGVyPXRoaXMuZ2V0Q3VycmVudENvbnRyb2xsZXIoKTtpZihjdXJyZW50Q29udHJvbGxlci5qc0lEPT09ZXYuZGF0YS5jb250cm9sbGVySUQpe3ZhciBhY3Rpb249dGhpcy5hY3Rpb25zW2N1cnJlbnRDb250cm9sbGVyLmFjdGlvbklEXTt2YXIgY3VycmVudENvbnRyb2xsZXJTdGF0ZT1jdXJyZW50Q29udHJvbGxlci53aWRnZXQuZXhwb3J0U3RhdGUoKTthY3Rpb24uY29udHJvbGxlclN0YXRlPV8uZXh0ZW5kKHt9LGFjdGlvbi5jb250cm9sbGVyU3RhdGUsY3VycmVudENvbnRyb2xsZXJTdGF0ZSk7dmFyIG9wdGlvbnM9e2NvbnRyb2xsZXJTdGF0ZTphY3Rpb24uY29udHJvbGxlclN0YXRlLGN1cnJlbnRJZDpldi5kYXRhLnJlc19pZCx9O2lmKGV2LmRhdGEubW9kZSl7b3B0aW9ucy5tb2RlPWV2LmRhdGEubW9kZTt9CnRoaXMuX3N3aXRjaENvbnRyb2xsZXIoYWN0aW9uLHZpZXdUeXBlLG9wdGlvbnMpO319LH0pO30pOzsKCi8qIC93ZWIvc3RhdGljL3NyYy9qcy9jaHJvbWUvYWN0aW9uX21hbmFnZXJfcmVwb3J0LmpzIGRlZmluZWQgaW4gYnVuZGxlICd3ZWIuYXNzZXRzX2JhY2tlbmQnICovCm9kb28uZGVmaW5lKCd3ZWIuUmVwb3J0QWN0aW9uTWFuYWdlcicsZnVuY3Rpb24ocmVxdWlyZSl7InVzZSBzdHJpY3QiO3ZhciBBY3Rpb25NYW5hZ2VyPXJlcXVpcmUoJ3dlYi5BY3Rpb25NYW5hZ2VyJyk7dmFyIGNvcmU9cmVxdWlyZSgnd2ViLmNvcmUnKTt2YXIgZnJhbWV3b3JrPXJlcXVpcmUoJ3dlYi5mcmFtZXdvcmsnKTt2YXIgc2Vzc2lvbj1yZXF1aXJlKCd3ZWIuc2Vzc2lvbicpO3ZhciBfdD1jb3JlLl90O3ZhciBfbHQ9Y29yZS5fbHQ7dmFyIGxpbms9Jzxicj48YnI+PGEgaHJlZj0iaHR0cDovL3draHRtbHRvcGRmLm9yZy8iIHRhcmdldD0iX2JsYW5rIj53a2h0bWx0b3BkZi5vcmc8L2E+Jzt2YXIgV0tIVE1MVE9QREZfTUVTU0FHRVM9e2Jyb2tlbjpfbHQoJ1lvdXIgaW5zdGFsbGF0aW9uIG9mIFdraHRtbHRvcGRmIHNlZW1zIHRvIGJlIGJyb2tlbi4gVGhlIHJlcG9ydCB3aWxsIGJlIHNob3duICcrJ2luIGh0bWwuJykrbGluayxpbnN0YWxsOl9sdCgnVW5hYmxlIHRvIGZpbmQgV2todG1sdG9wZGYgb24gdGhpcyBzeXN0ZW0uIFRoZSByZXBvcnQgd2lsbCBiZSBzaG93biBpbiAnKydodG1sLicpK2xpbmssdXBncmFkZTpfbHQoJ1lvdSBzaG91bGQgdXBncmFkZSB5b3VyIHZlcnNpb24gb2YgV2todG1sdG9wZGYgdG8gYXQgbGVhc3QgMC4xMi4wIGluIG9yZGVyIHRvICcrJ2dldCBhIGNvcnJlY3QgZGlzcGxheSBvZiBoZWFkZXJzIGFuZCBmb290ZXJzIGFzIHdlbGwgYXMgc3VwcG9ydCBmb3IgJysndGFibGUtYnJlYWtpbmcgYmV0d2VlbiBwYWdlcy4nKStsaW5rLHdvcmtlcnM6X2x0KCdZb3UgbmVlZCB0byBzdGFydCBPZG9vIHdpdGggYXQgbGVhc3QgdHdvIHdvcmtlcnMgdG8gcHJpbnQgYSBwZGYgdmVyc2lvbiBvZiAnKyd0aGUgcmVwb3J0cy4nKSx9O0FjdGlvbk1hbmFnZXIuaW5jbHVkZSh7X2Rvd25sb2FkUmVwb3J0OmZ1bmN0aW9uKHVybCl7dmFyIHNlbGY9dGhpcztmcmFtZXdvcmsuYmxvY2tVSSgpO3JldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLHJlamVjdCl7dmFyIHR5cGU9J3F3ZWItJyt1cmwuc3BsaXQoJy8nKVsyXTt2YXIgYmxvY2tlZD0hc2Vzc2lvbi5nZXRfZmlsZSh7dXJsOicvcmVwb3J0L2Rvd25sb2FkJyxkYXRhOntkYXRhOkpTT04uc3RyaW5naWZ5KFt1cmwsdHlwZV0pLGNvbnRleHQ6SlNPTi5zdHJpbmdpZnkoc2Vzc2lvbi51c2VyX2NvbnRleHQpLH0sc3VjY2VzczpyZXNvbHZlLGVycm9yOihlcnJvcik9PntzZWxmLmNhbGwoJ2NyYXNoX21hbmFnZXInLCdycGNfZXJyb3InLGVycm9yKTtyZWplY3QoKTt9LGNvbXBsZXRlOmZyYW1ld29yay51bmJsb2NrVUksfSk7aWYoYmxvY2tlZCl7dmFyIG1lc3NhZ2U9X3QoJ0EgcG9wdXAgd2luZG93IHdpdGggeW91ciByZXBvcnQgd2FzIGJsb2NrZWQuIFlvdSAnKydtYXkgbmVlZCB0byBjaGFuZ2UgeW91ciBicm93c2VyIHNldHRpbmdzIHRvIGFsbG93ICcrJ3BvcHVwIHdpbmRvd3MgZm9yIHRoaXMgcGFnZS4nKTtzZWxmLmRvX3dhcm4oX3QoJ1dhcm5pbmcnKSxtZXNzYWdlLHRydWUpO319KTt9LF90cmlnZ2VyRG93bmxvYWQ6ZnVuY3Rpb24oYWN0aW9uLG9wdGlvbnMsdHlwZSl7dmFyIHNlbGY9dGhpczt2YXIgcmVwb3J0VXJscz10aGlzLl9tYWtlUmVwb3J0VXJscyhhY3Rpb24pO3JldHVybiB0aGlzLl9kb3dubG9hZFJlcG9ydChyZXBvcnRVcmxzW3R5cGVdKS50aGVuKGZ1bmN0aW9uKCl7aWYoYWN0aW9uLmNsb3NlX29uX3JlcG9ydF9kb3dubG9hZCl7dmFyIGNsb3NlQWN0aW9uPXt0eXBlOidpci5hY3Rpb25zLmFjdF93aW5kb3dfY2xvc2UnfTtyZXR1cm4gc2VsZi5kb0FjdGlvbihjbG9zZUFjdGlvbixfLnBpY2sob3B0aW9ucywnb25fY2xvc2UnKSk7fWVsc2V7cmV0dXJuIG9wdGlvbnMub25fY2xvc2UoKTt9fSk7fSxfZXhlY3V0ZVJlcG9ydEFjdGlvbjpmdW5jdGlvbihhY3Rpb24sb3B0aW9ucyl7dmFyIHNlbGY9dGhpcztpZihhY3Rpb24ucmVwb3J0X3R5cGU9PT0ncXdlYi1odG1sJyl7cmV0dXJuIHRoaXMuX2V4ZWN1dGVSZXBvcnRDbGllbnRBY3Rpb24oYWN0aW9uLG9wdGlvbnMpO31lbHNlIGlmKGFjdGlvbi5yZXBvcnRfdHlwZT09PSdxd2ViLXBkZicpe3JldHVybiB0aGlzLmNhbGwoJ3JlcG9ydCcsJ2NoZWNrV2todG1sdG9wZGYnKS50aGVuKGZ1bmN0aW9uKHN0YXRlKXtpZihzdGF0ZSBpbiBXS0hUTUxUT1BERl9NRVNTQUdFUyl7c2VsZi5kb19ub3RpZnkoX3QoJ1JlcG9ydCcpLFdLSFRNTFRPUERGX01FU1NBR0VTW3N0YXRlXSx0cnVlKTt9CmlmKHN0YXRlPT09J3VwZ3JhZGUnfHxzdGF0ZT09PSdvaycpe3JldHVybiBzZWxmLl90cmlnZ2VyRG93bmxvYWQoYWN0aW9uLG9wdGlvbnMsJ3BkZicpO31lbHNle3JldHVybiBzZWxmLl9leGVjdXRlUmVwb3J0Q2xpZW50QWN0aW9uKGFjdGlvbixvcHRpb25zKTt9fSk7fWVsc2UgaWYoYWN0aW9uLnJlcG9ydF90eXBlPT09J3F3ZWItdGV4dCcpe3JldHVybiBzZWxmLl90cmlnZ2VyRG93bmxvYWQoYWN0aW9uLG9wdGlvbnMsJ3RleHQnKTt9ZWxzZXtjb25zb2xlLmVycm9yKCJUaGUgQWN0aW9uTWFuYWdlciBjYW4ndCBoYW5kbGUgcmVwb3J0cyBvZiB0eXBlICIrCmFjdGlvbi5yZXBvcnRfdHlwZSxhY3Rpb24pO3JldHVybiBQcm9taXNlLnJlamVjdCgpO319LF9leGVjdXRlUmVwb3J0Q2xpZW50QWN0aW9uOmZ1bmN0aW9uKGFjdGlvbixvcHRpb25zKXt2YXIgdXJscz10aGlzLl9tYWtlUmVwb3J0VXJscyhhY3Rpb24pO3ZhciBjbGllbnRBY3Rpb25PcHRpb25zPV8uZXh0ZW5kKHt9LG9wdGlvbnMse2NvbnRleHQ6YWN0aW9uLmNvbnRleHQsZGF0YTphY3Rpb24uZGF0YSxkaXNwbGF5X25hbWU6YWN0aW9uLmRpc3BsYXlfbmFtZSxuYW1lOmFjdGlvbi5uYW1lLHJlcG9ydF9maWxlOmFjdGlvbi5yZXBvcnRfZmlsZSxyZXBvcnRfbmFtZTphY3Rpb24ucmVwb3J0X25hbWUscmVwb3J0X3VybDp1cmxzLmh0bWwsfSk7cmV0dXJuIHRoaXMuZG9BY3Rpb24oJ3JlcG9ydC5jbGllbnRfYWN0aW9uJyxjbGllbnRBY3Rpb25PcHRpb25zKTt9LF9oYW5kbGVBY3Rpb246ZnVuY3Rpb24oYWN0aW9uLG9wdGlvbnMpe2lmKGFjdGlvbi50eXBlPT09J2lyLmFjdGlvbnMucmVwb3J0Jyl7cmV0dXJuIHRoaXMuX2V4ZWN1dGVSZXBvcnRBY3Rpb24oYWN0aW9uLG9wdGlvbnMpO30KcmV0dXJuIHRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9LF9tYWtlUmVwb3J0VXJsczpmdW5jdGlvbihhY3Rpb24pe3ZhciByZXBvcnRVcmxzPXtodG1sOicvcmVwb3J0L2h0bWwvJythY3Rpb24ucmVwb3J0X25hbWUscGRmOicvcmVwb3J0L3BkZi8nK2FjdGlvbi5yZXBvcnRfbmFtZSx0ZXh0OicvcmVwb3J0L3RleHQvJythY3Rpb24ucmVwb3J0X25hbWUsfTtpZihfLmlzVW5kZWZpbmVkKGFjdGlvbi5kYXRhKXx8Xy5pc051bGwoYWN0aW9uLmRhdGEpfHwoXy5pc09iamVjdChhY3Rpb24uZGF0YSkmJl8uaXNFbXB0eShhY3Rpb24uZGF0YSkpKXtpZihhY3Rpb24uY29udGV4dC5hY3RpdmVfaWRzKXt2YXIgYWN0aXZlSURzUGF0aD0nLycrYWN0aW9uLmNvbnRleHQuYWN0aXZlX2lkcy5qb2luKCcsJyk7cmVwb3J0VXJscz1fLm1hcE9iamVjdChyZXBvcnRVcmxzLGZ1bmN0aW9uKHZhbHVlKXtyZXR1cm4gdmFsdWUrPWFjdGl2ZUlEc1BhdGg7fSk7fX1lbHNle3ZhciBzZXJpYWxpemVkT3B0aW9uc1BhdGg9Jz9vcHRpb25zPScrZW5jb2RlVVJJQ29tcG9uZW50KEpTT04uc3RyaW5naWZ5KGFjdGlvbi5kYXRhKSk7c2VyaWFsaXplZE9wdGlvbnNQYXRoKz0nJmNvbnRleHQ9JytlbmNvZGVVUklDb21wb25lbnQoSlNPTi5zdHJpbmdpZnkoYWN0aW9uLmNvbnRleHQpKTtyZXBvcnRVcmxzPV8ubWFwT2JqZWN0KHJlcG9ydFVybHMsZnVuY3Rpb24odmFsdWUpe3JldHVybiB2YWx1ZSs9c2VyaWFsaXplZE9wdGlvbnNQYXRoO30pO30KcmV0dXJuIHJlcG9ydFVybHM7fSx9KTt9KTs7CgovKiAvd2ViL3N0YXRpYy9zcmMvanMvY2hyb21lL2FjdGlvbl9taXhpbi5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwpvZG9vLmRlZmluZSgnd2ViLkFjdGlvbk1peGluJyxmdW5jdGlvbihyZXF1aXJlKXsidXNlIHN0cmljdCI7dmFyIGNvcmU9cmVxdWlyZSgnd2ViLmNvcmUnKTt2YXIgQWN0aW9uTWl4aW49e3RlbXBsYXRlOidBY3Rpb24nLGNvbnRlbnRUZW1wbGF0ZTpudWxsLF9jb250cm9sUGFuZWw6bnVsbCxfdGl0bGU6JycscmVuZGVyRWxlbWVudDpmdW5jdGlvbigpe3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtpZih0aGlzLmNvbnRlbnRUZW1wbGF0ZSl7dmFyIGNvbnRlbnQ9Y29yZS5xd2ViLnJlbmRlcih0aGlzLmNvbnRlbnRUZW1wbGF0ZSx7d2lkZ2V0OnRoaXN9KTt0aGlzLiQoJy5vX2NvbnRlbnQnKS5hcHBlbmQoY29udGVudCk7fX0sb25fYXR0YWNoX2NhbGxiYWNrOmZ1bmN0aW9uKCl7fSxvbl9kZXRhY2hfY2FsbGJhY2s6ZnVuY3Rpb24oKXt9LHdpbGxSZXN0b3JlOmZ1bmN0aW9uKCl7fSxjYW5CZVJlbW92ZWQ6ZnVuY3Rpb24oKXtyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7fSxnZXRPd25lZFF1ZXJ5UGFyYW1zOmZ1bmN0aW9uKCl7cmV0dXJue307fSxnZXRUaXRsZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl90aXRsZTt9LGdpdmVGb2N1czpmdW5jdGlvbigpe30scmVuZGVyQnV0dG9uczpmdW5jdGlvbigkbm9kZSl7fSx1cGRhdGVDb250cm9sUGFuZWw6ZnVuY3Rpb24oc3RhdHVzLG9wdGlvbnMpe2lmKHRoaXMuX2NvbnRyb2xQYW5lbCl7c3RhdHVzPXN0YXR1c3x8e307c3RhdHVzLnRpdGxlPXN0YXR1cy50aXRsZXx8dGhpcy5nZXRUaXRsZSgpO3RoaXMuX2NvbnRyb2xQYW5lbC51cGRhdGVDb250ZW50cyhzdGF0dXMsb3B0aW9uc3x8e30pO319LF9zZXRUaXRsZTpmdW5jdGlvbih0aXRsZSl7dGhpcy5fdGl0bGU9dGl0bGU7dGhpcy51cGRhdGVDb250cm9sUGFuZWwoe3RpdGxlOnRoaXMuX3RpdGxlfSx7Y2xlYXI6ZmFsc2V9KTt9LH07cmV0dXJuIEFjdGlvbk1peGluO30pOzsKCi8qIC93ZWIvc3RhdGljL3NyYy9qcy9jb3JlL2Jyb3dzZXJfZGV0ZWN0aW9uLmpzIGRlZmluZWQgaW4gYnVuZGxlICd3ZWIuYXNzZXRzX2JhY2tlbmQnICovCm9kb28uZGVmaW5lKCd3ZWIuQnJvd3NlckRldGVjdGlvbicsZnVuY3Rpb24ocmVxdWlyZSl7InVzZSBzdHJpY3QiO3ZhciBDbGFzcz1yZXF1aXJlKCd3ZWIuQ2xhc3MnKTt2YXIgQnJvd3NlckRldGVjdGlvbj1DbGFzcy5leHRlbmQoe2luaXQ6ZnVuY3Rpb24oKXt9LGlzT3NNYWM6ZnVuY3Rpb24oKXtyZXR1cm4gbmF2aWdhdG9yLnBsYXRmb3JtLnRvTG93ZXJDYXNlKCkuaW5kZXhPZignbWFjJykhPT0tMTt9LGlzQnJvd3NlckNocm9tZTpmdW5jdGlvbigpe3JldHVybiAkLmJyb3dzZXIuY2hyb21lJiZuYXZpZ2F0b3IudXNlckFnZW50LnRvTG9jYWxlTG93ZXJDYXNlKCkuaW5kZXhPZignZWRnZScpPT09LTE7fX0pO3JldHVybiBCcm93c2VyRGV0ZWN0aW9uO30pOzsKCi8qIC93ZWIvc3RhdGljL3NyYy9qcy9jaHJvbWUva2V5Ym9hcmRfbmF2aWdhdGlvbl9taXhpbi5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwpvZG9vLmRlZmluZSgnd2ViLktleWJvYXJkTmF2aWdhdGlvbk1peGluJyxmdW5jdGlvbihyZXF1aXJlKXsidXNlIHN0cmljdCI7dmFyIEJyb3dzZXJEZXRlY3Rpb249cmVxdWlyZSgnd2ViLkJyb3dzZXJEZXRlY3Rpb24nKTt2YXIga25vd25VbnVzYWJsZUFjY2Vzc0tleXM9WycgJywnQScsJ0InLCdDJywnSCcsJ0onLCdLJywnTCcsJ04nLCdQJywnUycsJ1EnLCdFJywnRicsJ0QnLCcwJywnMScsJzInLCczJywnNCcsJzUnLCc2JywnNycsJzgnLCc5J107dmFyIEtleWJvYXJkTmF2aWdhdGlvbk1peGluPXtldmVudHM6eydrZXlkb3duJzonX29uS2V5RG93bicsJ2tleXVwJzonX29uS2V5VXAnLH0saW5pdDpmdW5jdGlvbigpe3RoaXMuX2FyZUFjY2Vzc0tleVZpc2libGU9ZmFsc2U7dGhpcy5Ccm93c2VyRGV0ZWN0aW9uPW5ldyBCcm93c2VyRGV0ZWN0aW9uKCk7fSxfYWRkQWNjZXNzS2V5T3ZlcmxheXM6ZnVuY3Rpb24oKXt2YXIgYWNjZXNza2V5RWxlbWVudHM9JChkb2N1bWVudCkuZmluZCgnW2FjY2Vzc2tleV0nKS5maWx0ZXIoJzp2aXNpYmxlJyk7Xy5lYWNoKGFjY2Vzc2tleUVsZW1lbnRzLGZ1bmN0aW9uKGVsZW0pe3ZhciBvdmVybGF5PSQoXy5zdHIuc3ByaW50ZigiPGRpdiBjbGFzcz0nb193ZWJfYWNjZXNza2V5X292ZXJsYXknPiVzPC9kaXY+IiwkKGVsZW0pLmF0dHIoJ2FjY2Vzc2tleScpLnRvVXBwZXJDYXNlKCkpKTt2YXIgJG92ZXJsYXlQYXJlbnQ7aWYoZWxlbS50YWdOYW1lLnRvVXBwZXJDYXNlKCk9PT0iSU5QVVQiKXskb3ZlcmxheVBhcmVudD0kKGVsZW0pLnBhcmVudCgpO31lbHNleyRvdmVybGF5UGFyZW50PSQoZWxlbSk7fQppZigkb3ZlcmxheVBhcmVudC5jc3MoJ3Bvc2l0aW9uJykhPT0nYWJzb2x1dGUnKXskb3ZlcmxheVBhcmVudC5jc3MoJ3Bvc2l0aW9uJywncmVsYXRpdmUnKTt9Cm92ZXJsYXkuYXBwZW5kVG8oJG92ZXJsYXlQYXJlbnQpO30pO30sX2dldEFsbFVzZWRBY2Nlc3NLZXlzOmZ1bmN0aW9uKCl7dmFyIHVzZWRBY2Nlc3NLZXlzPWtub3duVW51c2FibGVBY2Nlc3NLZXlzLnNsaWNlKCk7dGhpcy4kZWwuZmluZCgnW2FjY2Vzc2tleV0nKS5lYWNoKGZ1bmN0aW9uKF8sZWxlbSl7dXNlZEFjY2Vzc0tleXMucHVzaChlbGVtLmFjY2Vzc0tleS50b1VwcGVyQ2FzZSgpKTt9KTtyZXR1cm4gdXNlZEFjY2Vzc0tleXM7fSxfaGlkZUFjY2Vzc0tleU92ZXJsYXk6ZnVuY3Rpb24oKXt0aGlzLl9hcmVBY2Nlc3NLZXlWaXNpYmxlPWZhbHNlO3ZhciBvdmVybGF5cz10aGlzLiRlbC5maW5kKCcub193ZWJfYWNjZXNza2V5X292ZXJsYXknKTtpZihvdmVybGF5cy5sZW5ndGgpe3JldHVybiBvdmVybGF5cy5yZW1vdmUoKTt9fSxfc2V0QWNjZXNzS2V5T25Ub3BOYXZpZ2F0aW9uOmZ1bmN0aW9uKCl7dGhpcy4kZWwuZmluZCgnLm9fbWVudV9zZWN0aW9ucz5saT5hJykuZWFjaChmdW5jdGlvbihudW1iZXIsaXRlbSl7aXRlbS5hY2Nlc3NLZXk9bnVtYmVyKzE7fSk7fSxfb25LZXlEb3duOmZ1bmN0aW9uKGtleURvd25FdmVudCl7aWYoJCgnYm9keS5vX3VpX2Jsb2NrZWQnKS5sZW5ndGgmJihrZXlEb3duRXZlbnQuYWx0S2V5fHxrZXlEb3duRXZlbnQua2V5PT09J0FsdCcpJiYha2V5RG93bkV2ZW50LmN0cmxLZXkpe2lmKGtleURvd25FdmVudC5wcmV2ZW50RGVmYXVsdClrZXlEb3duRXZlbnQucHJldmVudERlZmF1bHQoKTtlbHNlIGtleURvd25FdmVudC5yZXR1cm5WYWx1ZT1mYWxzZTtpZihrZXlEb3duRXZlbnQuc3RvcFByb3BhZ2F0aW9uKWtleURvd25FdmVudC5zdG9wUHJvcGFnYXRpb24oKTtpZihrZXlEb3duRXZlbnQuY2FuY2VsQnViYmxlKWtleURvd25FdmVudC5jYW5jZWxCdWJibGU9dHJ1ZTtyZXR1cm4gZmFsc2U7fQppZighdGhpcy5fYXJlQWNjZXNzS2V5VmlzaWJsZSYmKGtleURvd25FdmVudC5hbHRLZXl8fGtleURvd25FdmVudC5rZXk9PT0nQWx0JykmJiFrZXlEb3duRXZlbnQuY3RybEtleSl7dGhpcy5fYXJlQWNjZXNzS2V5VmlzaWJsZT10cnVlO3RoaXMuX3NldEFjY2Vzc0tleU9uVG9wTmF2aWdhdGlvbigpO3ZhciB1c2VkQWNjZXNzS2V5PXRoaXMuX2dldEFsbFVzZWRBY2Nlc3NLZXlzKCk7dmFyIGJ1dHRvbnNXaXRob3V0QWNjZXNzS2V5PXRoaXMuJGVsLmZpbmQoJ2J1dHRvbi5idG46dmlzaWJsZScpLm5vdCgnW2FjY2Vzc2tleV0nKS5ub3QoJ1tkaXNhYmxlZF0nKS5ub3QoJ1t0YWJpbmRleD0iLTEiXScpO18uZWFjaChidXR0b25zV2l0aG91dEFjY2Vzc0tleSxmdW5jdGlvbihlbGVtKXt2YXIgYnV0dG9uU3RyaW5nPVtlbGVtLmlubmVyVGV4dCxlbGVtLnRpdGxlLCJBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWiJdLmpvaW4oJycpO2Zvcih2YXIgbGV0dGVySW5kZXg9MDtsZXR0ZXJJbmRleDxidXR0b25TdHJpbmcubGVuZ3RoO2xldHRlckluZGV4Kyspe3ZhciBjYW5kaWRhdGVBY2Nlc3NLZXk9YnV0dG9uU3RyaW5nW2xldHRlckluZGV4XS50b1VwcGVyQ2FzZSgpO2lmKGNhbmRpZGF0ZUFjY2Vzc0tleT49J0EnJiZjYW5kaWRhdGVBY2Nlc3NLZXk8PSdaJyYmIV8uaW5jbHVkZXModXNlZEFjY2Vzc0tleSxjYW5kaWRhdGVBY2Nlc3NLZXkpKXtlbGVtLmFjY2Vzc0tleT1jYW5kaWRhdGVBY2Nlc3NLZXk7dXNlZEFjY2Vzc0tleS5wdXNoKGNhbmRpZGF0ZUFjY2Vzc0tleSk7YnJlYWs7fX19KTt2YXIgZWxlbWVudHNXaXRob3V0QXJpYUtleXNob3J0Y3V0PXRoaXMuJGVsLmZpbmQoJ1thY2Nlc3NrZXldJykubm90KCdbYXJpYS1rZXlzaG9ydGN1dHNdJyk7Xy5lYWNoKGVsZW1lbnRzV2l0aG91dEFyaWFLZXlzaG9ydGN1dCxmdW5jdGlvbihlbGVtKXtlbGVtLnNldEF0dHJpYnV0ZSgnYXJpYS1rZXlzaG9ydGN1dHMnLCdBbHQrU2hpZnQrJytlbGVtLmFjY2Vzc0tleSk7fSk7dGhpcy5fYWRkQWNjZXNzS2V5T3ZlcmxheXMoKTt9CmlmKHRoaXMuQnJvd3NlckRldGVjdGlvbi5pc09zTWFjKCkpCnJldHVybjtpZihrZXlEb3duRXZlbnQuYWx0S2V5JiYha2V5RG93bkV2ZW50LmN0cmxLZXkmJmtleURvd25FdmVudC5rZXkubGVuZ3RoPT09MSl7dmFyIGVsZW1lbnRXaXRoQWNjZXNzS2V5PVtdO2lmKGtleURvd25FdmVudC5rZXlDb2RlPj02NSYma2V5RG93bkV2ZW50LmtleUNvZGU8PTkwfHxrZXlEb3duRXZlbnQua2V5Q29kZT49OTcmJmtleURvd25FdmVudC5rZXlDb2RlPD0xMjIpe2VsZW1lbnRXaXRoQWNjZXNzS2V5PWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ1thY2Nlc3NrZXk9IicrU3RyaW5nLmZyb21DaGFyQ29kZShrZXlEb3duRXZlbnQua2V5Q29kZSkudG9Mb3dlckNhc2UoKSsnIl0sIFthY2Nlc3NrZXk9IicrU3RyaW5nLmZyb21DaGFyQ29kZShrZXlEb3duRXZlbnQua2V5Q29kZSkudG9VcHBlckNhc2UoKSsnIl0nKTtpZihlbGVtZW50V2l0aEFjY2Vzc0tleS5sZW5ndGgpe2lmKHRoaXMuQnJvd3NlckRldGVjdGlvbi5pc09zTWFjKCl8fCF0aGlzLkJyb3dzZXJEZXRlY3Rpb24uaXNCcm93c2VyQ2hyb21lKCkpe2VsZW1lbnRXaXRoQWNjZXNzS2V5WzBdLmZvY3VzKCk7ZWxlbWVudFdpdGhBY2Nlc3NLZXlbMF0uY2xpY2soKTtpZihrZXlEb3duRXZlbnQucHJldmVudERlZmF1bHQpa2V5RG93bkV2ZW50LnByZXZlbnREZWZhdWx0KCk7ZWxzZSBrZXlEb3duRXZlbnQucmV0dXJuVmFsdWU9ZmFsc2U7aWYoa2V5RG93bkV2ZW50LnN0b3BQcm9wYWdhdGlvbilrZXlEb3duRXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7aWYoa2V5RG93bkV2ZW50LmNhbmNlbEJ1YmJsZSlrZXlEb3duRXZlbnQuY2FuY2VsQnViYmxlPXRydWU7cmV0dXJuIGZhbHNlO319fQplbHNle3ZhciBudW1iZXJLZXk7aWYoa2V5RG93bkV2ZW50Lm9yaWdpbmFsRXZlbnQuY29kZSYma2V5RG93bkV2ZW50Lm9yaWdpbmFsRXZlbnQuY29kZS5pbmRleE9mKCdEaWdpdCcpPT09MCl7bnVtYmVyS2V5PWtleURvd25FdmVudC5vcmlnaW5hbEV2ZW50LmNvZGVba2V5RG93bkV2ZW50Lm9yaWdpbmFsRXZlbnQuY29kZS5sZW5ndGgtMV07fWVsc2UgaWYoa2V5RG93bkV2ZW50Lm9yaWdpbmFsRXZlbnQua2V5JiZrZXlEb3duRXZlbnQub3JpZ2luYWxFdmVudC5rZXkubGVuZ3RoPT09MSYma2V5RG93bkV2ZW50Lm9yaWdpbmFsRXZlbnQua2V5Pj0nMCcmJmtleURvd25FdmVudC5vcmlnaW5hbEV2ZW50LmtleTw9JzknKXtudW1iZXJLZXk9a2V5RG93bkV2ZW50Lm9yaWdpbmFsRXZlbnQua2V5O31lbHNlIGlmKGtleURvd25FdmVudC5rZXlDb2RlPj00OCYma2V5RG93bkV2ZW50LmtleUNvZGU8PTU3KXtudW1iZXJLZXk9a2V5RG93bkV2ZW50LmtleUNvZGUtNDg7fQppZihudW1iZXJLZXk+PScwJyYmbnVtYmVyS2V5PD0nOScpe2VsZW1lbnRXaXRoQWNjZXNzS2V5PWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ1thY2Nlc3NrZXk9IicrbnVtYmVyS2V5KyciXScpO2lmKGVsZW1lbnRXaXRoQWNjZXNzS2V5Lmxlbmd0aCl7ZWxlbWVudFdpdGhBY2Nlc3NLZXlbMF0uY2xpY2soKTtpZihrZXlEb3duRXZlbnQucHJldmVudERlZmF1bHQpa2V5RG93bkV2ZW50LnByZXZlbnREZWZhdWx0KCk7ZWxzZSBrZXlEb3duRXZlbnQucmV0dXJuVmFsdWU9ZmFsc2U7aWYoa2V5RG93bkV2ZW50LnN0b3BQcm9wYWdhdGlvbilrZXlEb3duRXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7aWYoa2V5RG93bkV2ZW50LmNhbmNlbEJ1YmJsZSlrZXlEb3duRXZlbnQuY2FuY2VsQnViYmxlPXRydWU7cmV0dXJuIGZhbHNlO319fX19LF9vbktleVVwOmZ1bmN0aW9uKGtleVVwRXZlbnQpe2lmKChrZXlVcEV2ZW50LmFsdEtleXx8a2V5VXBFdmVudC5rZXk9PT0nQWx0JykmJiFrZXlVcEV2ZW50LmN0cmxLZXkpe3RoaXMuX2hpZGVBY2Nlc3NLZXlPdmVybGF5KCk7aWYoa2V5VXBFdmVudC5wcmV2ZW50RGVmYXVsdClrZXlVcEV2ZW50LnByZXZlbnREZWZhdWx0KCk7ZWxzZSBrZXlVcEV2ZW50LnJldHVyblZhbHVlPWZhbHNlO2lmKGtleVVwRXZlbnQuc3RvcFByb3BhZ2F0aW9uKWtleVVwRXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7aWYoa2V5VXBFdmVudC5jYW5jZWxCdWJibGUpa2V5VXBFdmVudC5jYW5jZWxCdWJibGU9dHJ1ZTtyZXR1cm4gZmFsc2U7fX0sfTtyZXR1cm4gS2V5Ym9hcmROYXZpZ2F0aW9uTWl4aW47fSk7OwoKLyogL3dlYi9zdGF0aWMvc3JjL2pzL2Nocm9tZS9hYnN0cmFjdF93ZWJfY2xpZW50LmpzIGRlZmluZWQgaW4gYnVuZGxlICd3ZWIuYXNzZXRzX2JhY2tlbmQnICovCm9kb28uZGVmaW5lKCd3ZWIuQWJzdHJhY3RXZWJDbGllbnQnLGZ1bmN0aW9uKHJlcXVpcmUpeyJ1c2Ugc3RyaWN0Ijt2YXIgQWN0aW9uTWFuYWdlcj1yZXF1aXJlKCd3ZWIuQWN0aW9uTWFuYWdlcicpO3ZhciBjb25jdXJyZW5jeT1yZXF1aXJlKCd3ZWIuY29uY3VycmVuY3knKTt2YXIgY29yZT1yZXF1aXJlKCd3ZWIuY29yZScpO3ZhciBjb25maWc9cmVxdWlyZSgnd2ViLmNvbmZpZycpO3ZhciBXYXJuaW5nRGlhbG9nPXJlcXVpcmUoJ3dlYi5DcmFzaE1hbmFnZXInKS5XYXJuaW5nRGlhbG9nO3ZhciBkYXRhX21hbmFnZXI9cmVxdWlyZSgnd2ViLmRhdGFfbWFuYWdlcicpO3ZhciBkb209cmVxdWlyZSgnd2ViLmRvbScpO3ZhciBLZXlib2FyZE5hdmlnYXRpb25NaXhpbj1yZXF1aXJlKCd3ZWIuS2V5Ym9hcmROYXZpZ2F0aW9uTWl4aW4nKTt2YXIgTG9hZGluZz1yZXF1aXJlKCd3ZWIuTG9hZGluZycpO3ZhciBsb2NhbF9zdG9yYWdlPXJlcXVpcmUoJ3dlYi5sb2NhbF9zdG9yYWdlJyk7dmFyIFJhaW5ib3dNYW49cmVxdWlyZSgnd2ViLlJhaW5ib3dNYW4nKTt2YXIgU2VydmljZVByb3ZpZGVyTWl4aW49cmVxdWlyZSgnd2ViLlNlcnZpY2VQcm92aWRlck1peGluJyk7dmFyIHNlc3Npb249cmVxdWlyZSgnd2ViLnNlc3Npb24nKTt2YXIgdXRpbHM9cmVxdWlyZSgnd2ViLnV0aWxzJyk7dmFyIFdpZGdldD1yZXF1aXJlKCd3ZWIuV2lkZ2V0Jyk7dmFyIF90PWNvcmUuX3Q7dmFyIEFic3RyYWN0V2ViQ2xpZW50PVdpZGdldC5leHRlbmQoU2VydmljZVByb3ZpZGVyTWl4aW4sS2V5Ym9hcmROYXZpZ2F0aW9uTWl4aW4se2RlcGVuZGVuY2llczpbJ25vdGlmaWNhdGlvbiddLGV2ZW50czpfLmV4dGVuZCh7fSxLZXlib2FyZE5hdmlnYXRpb25NaXhpbi5ldmVudHMseydjbGljayAub19zZWFyY2hfb3B0aW9ucyAuZHJvcGRvd24tbWVudSc6J19vbkNsaWNrRHJvcERvd25NZW51Jyx9KSxjdXN0b21fZXZlbnRzOntjbGVhcl91bmNvbW1pdHRlZF9jaGFuZ2VzOmZ1bmN0aW9uKGUpe3RoaXMuY2xlYXJfdW5jb21taXR0ZWRfY2hhbmdlcygpLnRoZW4oZS5kYXRhLmNhbGxiYWNrKTt9LHRvZ2dsZV9mdWxsc2NyZWVuOmZ1bmN0aW9uKGV2ZW50KXt0aGlzLnRvZ2dsZV9mdWxsc2NyZWVuKGV2ZW50LmRhdGEuZnVsbHNjcmVlbik7fSxjdXJyZW50X2FjdGlvbl91cGRhdGVkOmZ1bmN0aW9uKGV2KXt0aGlzLmN1cnJlbnRfYWN0aW9uX3VwZGF0ZWQoZXYuZGF0YS5hY3Rpb24sZXYuZGF0YS5jb250cm9sbGVyKTt9LHdhcm5pbmc6J19vbkRpc3BsYXlXYXJuaW5nJyxsb2FkX2FjdGlvbjonX29uTG9hZEFjdGlvbicsbG9hZF92aWV3czpmdW5jdGlvbihldmVudCl7dmFyIHBhcmFtcz17bW9kZWw6ZXZlbnQuZGF0YS5tb2RlbE5hbWUsY29udGV4dDpldmVudC5kYXRhLmNvbnRleHQsdmlld3NfZGVzY3I6ZXZlbnQuZGF0YS52aWV3cyx9O3JldHVybiBkYXRhX21hbmFnZXIubG9hZF92aWV3cyhwYXJhbXMsZXZlbnQuZGF0YS5vcHRpb25zfHx7fSkudGhlbihldmVudC5kYXRhLm9uX3N1Y2Nlc3MpO30sbG9hZF9maWx0ZXJzOmZ1bmN0aW9uKGV2ZW50KXtyZXR1cm4gZGF0YV9tYW5hZ2VyLmxvYWRfZmlsdGVycyhldmVudC5kYXRhKS50aGVuKGV2ZW50LmRhdGEub25fc3VjY2Vzcyk7fSxjcmVhdGVfZmlsdGVyOidfb25DcmVhdGVGaWx0ZXInLGRlbGV0ZV9maWx0ZXI6J19vbkRlbGV0ZUZpbHRlcicscHVzaF9zdGF0ZTonX29uUHVzaFN0YXRlJyxzaG93X2VmZmVjdDonX29uU2hvd0VmZmVjdCcsZ2V0X3Nlc3Npb246ZnVuY3Rpb24oZXZlbnQpe2lmKGV2ZW50LmRhdGEuY2FsbGJhY2spe2V2ZW50LmRhdGEuY2FsbGJhY2soc2Vzc2lvbik7fX0sZG9fYWN0aW9uOmZ1bmN0aW9uKGV2ZW50KXt0aGlzLmRvX2FjdGlvbihldmVudC5kYXRhLmFjdGlvbixldmVudC5kYXRhLm9wdGlvbnN8fHt9KS50aGVuKGZ1bmN0aW9uKHJlc3VsdCl7aWYoZXZlbnQuZGF0YS5vbl9zdWNjZXNzKXtldmVudC5kYXRhLm9uX3N1Y2Nlc3MocmVzdWx0KTt9fSkuZ3VhcmRlZENhdGNoKGZ1bmN0aW9uKHJlc3VsdCl7aWYoZXZlbnQuZGF0YS5vbl9mYWlsKXtldmVudC5kYXRhLm9uX2ZhaWwocmVzdWx0KTt9fSk7fSxnZXRTY3JvbGxQb3NpdGlvbjonX29uR2V0U2Nyb2xsUG9zaXRpb24nLHNjcm9sbFRvOidfb25TY3JvbGxUbycsc2V0X3RpdGxlX3BhcnQ6J19vblNldFRpdGxlUGFydCcsfSxpbml0OmZ1bmN0aW9uKHBhcmVudCl7b2Rvby5pc1JlYWR5PWZhbHNlO3RoaXMuY2xpZW50X29wdGlvbnM9e307dGhpcy5fc3VwZXIocGFyZW50KTtTZXJ2aWNlUHJvdmlkZXJNaXhpbi5pbml0LmNhbGwodGhpcyk7S2V5Ym9hcmROYXZpZ2F0aW9uTWl4aW4uaW5pdC5jYWxsKHRoaXMpO3RoaXMub3JpZ2luPXVuZGVmaW5lZDt0aGlzLl9jdXJyZW50X3N0YXRlPW51bGw7dGhpcy5tZW51X2RwPW5ldyBjb25jdXJyZW5jeS5Ecm9wUHJldmlvdXMoKTt0aGlzLmFjdGlvbl9tdXRleD1uZXcgY29uY3VycmVuY3kuTXV0ZXgoKTt0aGlzLnNldCgndGl0bGVfcGFydCcseyJ6b3BlbmVycCI6Ik9kb28ifSk7fSxzdGFydDpmdW5jdGlvbigpe3ZhciBzZWxmPXRoaXM7dGhpcy4kZWwudG9nZ2xlQ2xhc3MoJ29fdG91Y2hfZGV2aWNlJyxjb25maWcuZGV2aWNlLnRvdWNoKTt0aGlzLm9uKCJjaGFuZ2U6dGl0bGVfcGFydCIsdGhpcyx0aGlzLl90aXRsZV9jaGFuZ2VkKTt0aGlzLl90aXRsZV9jaGFuZ2VkKCk7dmFyIHN0YXRlPSQuYmJxLmdldFN0YXRlKCk7dmFyIGN1cnJlbnRfY29tcGFueV9pZD1zZXNzaW9uLnVzZXJfY29tcGFuaWVzLmN1cnJlbnRfY29tcGFueVswXQppZighc3RhdGUuY2lkcyl7c3RhdGUuY2lkcz11dGlscy5nZXRfY29va2llKCdjaWRzJykhPT1udWxsP3V0aWxzLmdldF9jb29raWUoJ2NpZHMnKTpTdHJpbmcoY3VycmVudF9jb21wYW55X2lkKTt9CnZhciBzdGF0ZUNvbXBhbnlJRFM9Xy5tYXAoc3RhdGUuY2lkcy5zcGxpdCgnLCcpLGZ1bmN0aW9uKGNpZCl7cmV0dXJuIHBhcnNlSW50KGNpZCl9KTt2YXIgdXNlckNvbXBhbnlJRFM9Xy5tYXAoc2Vzc2lvbi51c2VyX2NvbXBhbmllcy5hbGxvd2VkX2NvbXBhbmllcyxmdW5jdGlvbihjb21wYW55KXtyZXR1cm4gY29tcGFueVswXX0pO2lmKCFfLmlzRW1wdHkoXy5kaWZmZXJlbmNlKHN0YXRlQ29tcGFueUlEUyx1c2VyQ29tcGFueUlEUykpKXtzdGF0ZS5jaWRzPVN0cmluZyhjdXJyZW50X2NvbXBhbnlfaWQpO3N0YXRlQ29tcGFueUlEUz1bY3VycmVudF9jb21wYW55X2lkXX0Kc2Vzc2lvbi51c2VyX2NvbnRleHQuYWxsb3dlZF9jb21wYW55X2lkcz1zdGF0ZUNvbXBhbnlJRFM7JC5iYnEucHVzaFN0YXRlKHN0YXRlKTskKCJsaW5rW3R5cGU9J2ltYWdlL3gtaWNvbiddIikuYXR0cignaHJlZicsJy93ZWIvaW1hZ2UvcmVzLmNvbXBhbnkvJytTdHJpbmcoc3RhdGVDb21wYW55SURTWzBdKSsnL2Zhdmljb24vJykKcmV0dXJuIHNlc3Npb24uaXNfYm91bmQudGhlbihmdW5jdGlvbigpe3NlbGYuJGVsLnRvZ2dsZUNsYXNzKCdvX3J0bCcsX3QuZGF0YWJhc2UucGFyYW1ldGVycy5kaXJlY3Rpb249PT0icnRsIik7c2VsZi5iaW5kX2V2ZW50cygpO3JldHVybiBQcm9taXNlLmFsbChbc2VsZi5zZXRfYWN0aW9uX21hbmFnZXIoKSxzZWxmLnNldF9sb2FkaW5nKCldKTt9KS50aGVuKGZ1bmN0aW9uKCl7aWYoc2Vzc2lvbi5zZXNzaW9uX2lzX3ZhbGlkKCkpe3JldHVybiBzZWxmLnNob3dfYXBwbGljYXRpb24oKTt9ZWxzZXtyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7fX0pLnRoZW4oZnVuY3Rpb24oKXtzZWxmLmFjdGlvbl9tYW5hZ2VyLiRlbC5vbignc2Nyb2xsJyxjb3JlLmJ1cy50cmlnZ2VyLmJpbmQoY29yZS5idXMsJ3Njcm9sbCcpKTtjb3JlLmJ1cy50cmlnZ2VyKCd3ZWJfY2xpZW50X3JlYWR5Jyk7b2Rvby5pc1JlYWR5PXRydWU7aWYoc2Vzc2lvbi51aWQ9PT0xKXtzZWxmLiRlbC5hZGRDbGFzcygnb19pc19zdXBlcnVzZXInKTt9fSk7fSxiaW5kX2V2ZW50czpmdW5jdGlvbigpe3ZhciBzZWxmPXRoaXM7JCgnLm9lX3N5c3RyYXknKS5zaG93KCk7dGhpcy4kZWwub24oJ21vdXNlZW50ZXInLCcub2Vfc3lzdHJheSA+IGRpdjpub3QoW2RhdGEtdG9nZ2xlPXRvb2x0aXBdKScsZnVuY3Rpb24oKXskKHRoaXMpLmF0dHIoJ2RhdGEtdG9nZ2xlJywndG9vbHRpcCcpLnRvb2x0aXAoKS50cmlnZ2VyKCdtb3VzZWVudGVyJyk7fSk7dGhpcy4kZWwub24oJ2NsaWNrJywnLm9lX2Ryb3Bkb3duX3RvZ2dsZScsZnVuY3Rpb24oZXYpe2V2LnByZXZlbnREZWZhdWx0KCk7dmFyICR0b2dnbGU9JCh0aGlzKTt2YXIgZG9jX3dpZHRoPSQoZG9jdW1lbnQpLndpZHRoKCk7dmFyICRtZW51PSR0b2dnbGUuc2libGluZ3MoJy5vZV9kcm9wZG93bl9tZW51Jyk7JG1lbnU9JG1lbnUubGVuZ3RoPj0xPyRtZW51OiR0b2dnbGUuZmluZCgnLm9lX2Ryb3Bkb3duX21lbnUnKTt2YXIgc3RhdGU9JG1lbnUuaXMoJy5vZV9vcGVuZWQnKTtzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7JHRvZ2dsZS5hZGQoJG1lbnUpLnRvZ2dsZUNsYXNzKCdvZV9vcGVuZWQnLCFzdGF0ZSk7aWYoIXN0YXRlKXt2YXIgb2Zmc2V0PSRtZW51Lm9mZnNldCgpO3ZhciBtZW51X3dpZHRoPSRtZW51LndpZHRoKCk7dmFyIHg9ZG9jX3dpZHRoLW9mZnNldC5sZWZ0LW1lbnVfd2lkdGgtMjtpZih4PDApeyRtZW51Lm9mZnNldCh7bGVmdDpvZmZzZXQubGVmdCt4fSkud2lkdGgobWVudV93aWR0aCk7fX19LDApO30pO3dpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdibHVyJyxmdW5jdGlvbihlKXtzZWxmLl9oaWRlQWNjZXNzS2V5T3ZlcmxheSgpO30pO2NvcmUuYnVzLm9uKCdjbGljaycsdGhpcyxmdW5jdGlvbihldil7JCgnLnRvb2x0aXAnKS5yZW1vdmUoKTtpZighJChldi50YXJnZXQpLmlzKCdpbnB1dFt0eXBlPWZpbGVdJykpeyQodGhpcy5lbC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdvZV9kcm9wZG93bl9tZW51IG9lX29wZW5lZCcpKS5yZW1vdmVDbGFzcygnb2Vfb3BlbmVkJyk7JCh0aGlzLmVsLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ29lX2Ryb3Bkb3duX3RvZ2dsZSBvZV9vcGVuZWQnKSkucmVtb3ZlQ2xhc3MoJ29lX29wZW5lZCcpO30KdGhpcy5faGlkZUFjY2Vzc0tleU92ZXJsYXkoKTt9KTtjb3JlLmJ1cy5vbignY29ubmVjdGlvbl9sb3N0Jyx0aGlzLHRoaXMuX29uQ29ubmVjdGlvbkxvc3QpO2NvcmUuYnVzLm9uKCdjb25uZWN0aW9uX3Jlc3RvcmVkJyx0aGlzLHRoaXMuX29uQ29ubmVjdGlvblJlc3RvcmVkKTt9LHNldF9hY3Rpb25fbWFuYWdlcjpmdW5jdGlvbigpe3ZhciBzZWxmPXRoaXM7dGhpcy5hY3Rpb25fbWFuYWdlcj1uZXcgQWN0aW9uTWFuYWdlcih0aGlzLHNlc3Npb24udXNlcl9jb250ZXh0KTt2YXIgZnJhZ21lbnQ9ZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO3JldHVybiB0aGlzLmFjdGlvbl9tYW5hZ2VyLmFwcGVuZFRvKGZyYWdtZW50KS50aGVuKGZ1bmN0aW9uKCl7ZG9tLmFwcGVuZChzZWxmLiRlbCxmcmFnbWVudCx7aW5fRE9NOnRydWUsY2FsbGJhY2tzOlt7d2lkZ2V0OnNlbGYuYWN0aW9uX21hbmFnZXJ9XSx9KTt9KTt9LHNldF9sb2FkaW5nOmZ1bmN0aW9uKCl7dGhpcy5sb2FkaW5nPW5ldyBMb2FkaW5nKHRoaXMpO3JldHVybiB0aGlzLmxvYWRpbmcuYXBwZW5kVG8odGhpcy4kZWwpO30sc2hvd19hcHBsaWNhdGlvbjpmdW5jdGlvbigpe30sY2xlYXJfdW5jb21taXR0ZWRfY2hhbmdlczpmdW5jdGlvbigpe3JldHVybiB0aGlzLmFjdGlvbl9tYW5hZ2VyLmNsZWFyVW5jb21taXR0ZWRDaGFuZ2VzKCk7fSxkZXN0cm95X2NvbnRlbnQ6ZnVuY3Rpb24oKXtfLmVhY2goXy5jbG9uZSh0aGlzLmdldENoaWxkcmVuKCkpLGZ1bmN0aW9uKGVsKXtlbC5kZXN0cm95KCk7fSk7dGhpcy4kZWwuY2hpbGRyZW4oKS5yZW1vdmUoKTt9LHNldF90aXRsZTpmdW5jdGlvbih0aXRsZSl7dGhpcy5zZXRfdGl0bGVfcGFydCgiYWN0aW9uIix0aXRsZSk7fSxzZXRfdGl0bGVfcGFydDpmdW5jdGlvbihwYXJ0LHRpdGxlKXt2YXIgdG1wPV8uY2xvbmUodGhpcy5nZXQoInRpdGxlX3BhcnQiKSk7dG1wW3BhcnRdPXRpdGxlO3RoaXMuc2V0KCJ0aXRsZV9wYXJ0Iix0bXApO30sX3RpdGxlX2NoYW5nZWQ6ZnVuY3Rpb24oKXt2YXIgcGFydHM9Xy5zb3J0QnkoXy5rZXlzKHRoaXMuZ2V0KCJ0aXRsZV9wYXJ0IikpLGZ1bmN0aW9uKHgpe3JldHVybiB4O30pO3ZhciB0bXA9IiI7Xy5lYWNoKHBhcnRzLGZ1bmN0aW9uKHBhcnQpe3ZhciBzdHI9dGhpcy5nZXQoInRpdGxlX3BhcnQiKVtwYXJ0XTtpZihzdHIpe3RtcD10bXA/dG1wKyIgLSAiK3N0cjpzdHI7fX0sdGhpcyk7ZG9jdW1lbnQudGl0bGU9dG1wO30sZG9fYWN0aW9uOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYWN0aW9uX21hbmFnZXIuZG9BY3Rpb24uYXBwbHkodGhpcy5hY3Rpb25fbWFuYWdlcixhcmd1bWVudHMpO30sZG9fcmVsb2FkOmZ1bmN0aW9uKCl7dmFyIHNlbGY9dGhpcztyZXR1cm4gc2Vzc2lvbi5zZXNzaW9uX3JlbG9hZCgpLnRoZW4oZnVuY3Rpb24oKXtzZXNzaW9uLmxvYWRfbW9kdWxlcyh0cnVlKS50aGVuKHNlbGYubWVudS5wcm94eSgnZG9fcmVsb2FkJykpO30pO30sZG9fcHVzaF9zdGF0ZTpmdW5jdGlvbihzdGF0ZSl7aWYoIXN0YXRlLm1lbnVfaWQmJnRoaXMubWVudSl7c3RhdGUubWVudV9pZD10aGlzLm1lbnUuZ2V0Q3VycmVudFByaW1hcnlNZW51KCk7fQppZigndGl0bGUnaW4gc3RhdGUpe3RoaXMuc2V0X3RpdGxlKHN0YXRlLnRpdGxlKTtkZWxldGUgc3RhdGUudGl0bGU7fQp2YXIgdXJsPScjJyskLnBhcmFtKHN0YXRlKTt0aGlzLl9jdXJyZW50X3N0YXRlPSQuZGVwYXJhbSgkLnBhcmFtKHN0YXRlKSxmYWxzZSk7JC5iYnEucHVzaFN0YXRlKHVybCk7dGhpcy50cmlnZ2VyKCdzdGF0ZV9wdXNoZWQnLHN0YXRlKTt9LGN1cnJlbnRfYWN0aW9uX3VwZGF0ZWQ6ZnVuY3Rpb24oYWN0aW9uLGNvbnRyb2xsZXIpe30sdG9nZ2xlX2Z1bGxzY3JlZW46ZnVuY3Rpb24oZnVsbHNjcmVlbil7dGhpcy4kZWwudG9nZ2xlQ2xhc3MoJ29fZnVsbHNjcmVlbicsZnVsbHNjcmVlbik7fSxfb25DbGlja0Ryb3BEb3duTWVudTpmdW5jdGlvbihldil7ZXYuc3RvcFByb3BhZ2F0aW9uKCk7fSxfb25Db25uZWN0aW9uTG9zdDpmdW5jdGlvbigpe3RoaXMuY29ubmVjdGlvbk5vdGlmaWNhdGlvbklEPXRoaXMuZGlzcGxheU5vdGlmaWNhdGlvbih7dGl0bGU6X3QoJ0Nvbm5lY3Rpb24gbG9zdCcpLG1lc3NhZ2U6X3QoJ1RyeWluZyB0byByZWNvbm5lY3QuLi4nKSxzdGlja3k6dHJ1ZX0pO30sX29uQ29ubmVjdGlvblJlc3RvcmVkOmZ1bmN0aW9uKCl7aWYodGhpcy5jb25uZWN0aW9uTm90aWZpY2F0aW9uSUQpe3RoaXMuY2FsbCgnbm90aWZpY2F0aW9uJywnY2xvc2UnLHRoaXMuY29ubmVjdGlvbk5vdGlmaWNhdGlvbklEKTt0aGlzLmRpc3BsYXlOb3RpZmljYXRpb24oe3R5cGU6J2luZm8nLHRpdGxlOl90KCdDb25uZWN0aW9uIHJlc3RvcmVkJyksbWVzc2FnZTpfdCgnWW91IGFyZSBiYWNrIG9ubGluZScpLHN0aWNreTpmYWxzZX0pO3RoaXMuY29ubmVjdGlvbk5vdGlmaWNhdGlvbklEPWZhbHNlO319LF9vbkNyZWF0ZUZpbHRlcjpmdW5jdGlvbihlKXtkYXRhX21hbmFnZXIuY3JlYXRlX2ZpbHRlcihlLmRhdGEuZmlsdGVyKS50aGVuKGUuZGF0YS5vbl9zdWNjZXNzKTt9LF9vbkRlbGV0ZUZpbHRlcjpmdW5jdGlvbihlKXtkYXRhX21hbmFnZXIuZGVsZXRlX2ZpbHRlcihlLmRhdGEuZmlsdGVySWQpLnRoZW4oZS5kYXRhLm9uX3N1Y2Nlc3MpO30sX29uRGlzcGxheVdhcm5pbmc6ZnVuY3Rpb24oZSl7dmFyIGRhdGE9ZS5kYXRhO2lmKGRhdGEudHlwZT09PSdkaWFsb2cnKXtuZXcgV2FybmluZ0RpYWxvZyh0aGlzLHt0aXRsZTpkYXRhLnRpdGxlLH0sZGF0YSkub3BlbigpO31lbHNle2RhdGEudHlwZT0nd2FybmluZyc7dGhpcy5jYWxsKCdub3RpZmljYXRpb24nLCdub3RpZnknLGRhdGEpO319LF9vbkdldFNjcm9sbFBvc2l0aW9uOmZ1bmN0aW9uKGV2KXt9LF9vbkxvYWRBY3Rpb246ZnVuY3Rpb24oZXZlbnQpe2RhdGFfbWFuYWdlci5sb2FkX2FjdGlvbihldmVudC5kYXRhLmFjdGlvbklELGV2ZW50LmRhdGEuY29udGV4dCkudGhlbihldmVudC5kYXRhLm9uX3N1Y2Nlc3MpO30sX29uUHVzaFN0YXRlOmZ1bmN0aW9uKGUpe3RoaXMuZG9fcHVzaF9zdGF0ZShfLmV4dGVuZChlLmRhdGEuc3RhdGUseydjaWRzJzokLmJicS5nZXRTdGF0ZSgpLmNpZHN9KSk7fSxfb25TY3JvbGxUbzpmdW5jdGlvbihldil7fSxfb25TZXRUaXRsZVBhcnQ6ZnVuY3Rpb24oZXYpe3ZhciBwYXJ0PWV2LmRhdGEucGFydDt2YXIgdGl0bGU9ZXYuZGF0YS50aXRsZTt0aGlzLnNldF90aXRsZV9wYXJ0KHBhcnQsdGl0bGUpO30sX29uU2hvd0VmZmVjdDpmdW5jdGlvbihlKXt2YXIgZGF0YT1lLmRhdGF8fHt9O3ZhciB0eXBlPWRhdGEudHlwZXx8J3JhaW5ib3dfbWFuJztpZih0eXBlPT09J3JhaW5ib3dfbWFuJyl7aWYoc2Vzc2lvbi5zaG93X2VmZmVjdCl7bmV3IFJhaW5ib3dNYW4oZGF0YSkuYXBwZW5kVG8odGhpcy4kZWwpO31lbHNle3RoaXMuY2FsbCgnbm90aWZpY2F0aW9uJywnbm90aWZ5Jyx7dGl0bGU6IiIsbWVzc2FnZTpkYXRhLm1lc3NhZ2Usc3RpY2t5OmZhbHNlfSk7fX1lbHNle3Rocm93IG5ldyBFcnJvcignVW5rbm93biBlZmZlY3QgdHlwZTogJyt0eXBlKTt9fSx9KTtyZXR1cm4gQWJzdHJhY3RXZWJDbGllbnQ7fSk7OwoKLyogL3dlYi9zdGF0aWMvc3JjL2pzL2Nocm9tZS93ZWJfY2xpZW50LmpzIGRlZmluZWQgaW4gYnVuZGxlICd3ZWIuYXNzZXRzX2JhY2tlbmQnICovCm9kb28uZGVmaW5lKCd3ZWIuV2ViQ2xpZW50JyxmdW5jdGlvbihyZXF1aXJlKXsidXNlIHN0cmljdCI7dmFyIEFic3RyYWN0V2ViQ2xpZW50PXJlcXVpcmUoJ3dlYi5BYnN0cmFjdFdlYkNsaWVudCcpO3ZhciBjb25maWc9cmVxdWlyZSgnd2ViLmNvbmZpZycpO3ZhciBjb3JlPXJlcXVpcmUoJ3dlYi5jb3JlJyk7dmFyIGRhdGFfbWFuYWdlcj1yZXF1aXJlKCd3ZWIuZGF0YV9tYW5hZ2VyJyk7dmFyIGRvbT1yZXF1aXJlKCd3ZWIuZG9tJyk7dmFyIE1lbnU9cmVxdWlyZSgnd2ViLk1lbnUnKTt2YXIgc2Vzc2lvbj1yZXF1aXJlKCd3ZWIuc2Vzc2lvbicpO3JldHVybiBBYnN0cmFjdFdlYkNsaWVudC5leHRlbmQoe2N1c3RvbV9ldmVudHM6Xy5leHRlbmQoe30sQWJzdHJhY3RXZWJDbGllbnQucHJvdG90eXBlLmN1c3RvbV9ldmVudHMse2FwcF9jbGlja2VkOidvbl9hcHBfY2xpY2tlZCcsbWVudV9jbGlja2VkOidvbl9tZW51X2NsaWNrZWQnLH0pLHN0YXJ0OmZ1bmN0aW9uKCl7Y29yZS5idXMub24oJ2NoYW5nZV9tZW51X3NlY3Rpb24nLHRoaXMsZnVuY3Rpb24obWVudUlEKXt0aGlzLmRvX3B1c2hfc3RhdGUoXy5leHRlbmQoJC5iYnEuZ2V0U3RhdGUoKSx7bWVudV9pZDptZW51SUQsfSkpO30pO3JldHVybiB0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fSxiaW5kX2V2ZW50czpmdW5jdGlvbigpe3ZhciBzZWxmPXRoaXM7dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3RoaXMuJGVsLm9uKCdjbGljaycsJ2EnLGZ1bmN0aW9uKGV2KXt2YXIgZGlzYWJsZV9hbmNob3I9ZXYudGFyZ2V0LmF0dHJpYnV0ZXMuZGlzYWJsZV9hbmNob3I7aWYoZGlzYWJsZV9hbmNob3ImJmRpc2FibGVfYW5jaG9yLnZhbHVlPT09InRydWUiKXtyZXR1cm47fQp2YXIgaHJlZj1ldi50YXJnZXQuYXR0cmlidXRlcy5ocmVmO2lmKGhyZWYpe2lmKGhyZWYudmFsdWVbMF09PT0nIycmJmhyZWYudmFsdWUubGVuZ3RoPjEpe2lmKHNlbGYuJCgiW2lkPSciK2hyZWYudmFsdWUuc3Vic3RyKDEpKyInXSIpLmxlbmd0aCl7ZXYucHJldmVudERlZmF1bHQoKTtzZWxmLnRyaWdnZXJfdXAoJ3Njcm9sbFRvJyx7J3NlbGVjdG9yJzpocmVmLnZhbHVlfSk7fX19fSk7fSxsb2FkX21lbnVzOmZ1bmN0aW9uKCl7cmV0dXJuKG9kb28ubG9hZE1lbnVzUHJvbWlzZXx8b2Rvby5yZWxvYWRNZW51cygpKS50aGVuKGZ1bmN0aW9uKG1lbnVEYXRhKXtmb3IodmFyIGk9MDtpPG1lbnVEYXRhLmNoaWxkcmVuLmxlbmd0aDtpKyspe3ZhciBjaGlsZD1tZW51RGF0YS5jaGlsZHJlbltpXTtpZihjaGlsZC5hY3Rpb249PT1mYWxzZSl7d2hpbGUoY2hpbGQuY2hpbGRyZW4mJmNoaWxkLmNoaWxkcmVuLmxlbmd0aCl7Y2hpbGQ9Y2hpbGQuY2hpbGRyZW5bMF07aWYoY2hpbGQuYWN0aW9uKXttZW51RGF0YS5jaGlsZHJlbltpXS5hY3Rpb249Y2hpbGQuYWN0aW9uO2JyZWFrO319fX0Kb2Rvby5sb2FkTWVudXNQcm9taXNlPW51bGw7cmV0dXJuIG1lbnVEYXRhO30pO30sc2hvd19hcHBsaWNhdGlvbjpmdW5jdGlvbigpe3ZhciBzZWxmPXRoaXM7dGhpcy5zZXRfdGl0bGUoKTtyZXR1cm4gdGhpcy5tZW51X2RwLmFkZCh0aGlzLmluc3RhbmNpYXRlX21lbnVfd2lkZ2V0cygpKS50aGVuKGZ1bmN0aW9uKCl7JCh3aW5kb3cpLmJpbmQoJ2hhc2hjaGFuZ2UnLHNlbGYub25faGFzaGNoYW5nZSk7dmFyIHN0YXRlPSQuYmJxLmdldFN0YXRlKHRydWUpO2lmKF8ua2V5cyhzdGF0ZSkubGVuZ3RoPT09MSYmXy5rZXlzKHN0YXRlKVswXT09PSJjaWRzIil7cmV0dXJuIHNlbGYubWVudV9kcC5hZGQoc2VsZi5fcnBjKHttb2RlbDoncmVzLnVzZXJzJyxtZXRob2Q6J3JlYWQnLGFyZ3M6W3Nlc3Npb24udWlkLFsiYWN0aW9uX2lkIl1dLH0pKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCl7dmFyIGRhdGE9cmVzdWx0WzBdO2lmKGRhdGEuYWN0aW9uX2lkKXtyZXR1cm4gc2VsZi5kb19hY3Rpb24oZGF0YS5hY3Rpb25faWRbMF0pLnRoZW4oZnVuY3Rpb24oKXtzZWxmLm1lbnUuY2hhbmdlX21lbnVfc2VjdGlvbihzZWxmLm1lbnUuYWN0aW9uX2lkX3RvX3ByaW1hcnlfbWVudV9pZChkYXRhLmFjdGlvbl9pZFswXSkpO30pO31lbHNle3NlbGYubWVudS5vcGVuRmlyc3RBcHAoKTt9fSk7fWVsc2V7cmV0dXJuIHNlbGYub25faGFzaGNoYW5nZSgpO319KTt9LGluc3RhbmNpYXRlX21lbnVfd2lkZ2V0czpmdW5jdGlvbigpe3ZhciBzZWxmPXRoaXM7dmFyIHByb21zPVtdO3JldHVybiB0aGlzLmxvYWRfbWVudXMoKS50aGVuKGZ1bmN0aW9uKG1lbnVEYXRhKXtzZWxmLm1lbnVfZGF0YT1tZW51RGF0YTtpZihzZWxmLm1lbnUpe3NlbGYubWVudS5kZXN0cm95KCk7fQpzZWxmLm1lbnU9bmV3IE1lbnUoc2VsZixtZW51RGF0YSk7cHJvbXMucHVzaChzZWxmLm1lbnUucHJlcGVuZFRvKHNlbGYuJGVsKSk7cmV0dXJuIFByb21pc2UuYWxsKHByb21zKTt9KTt9LG9uX2hhc2hjaGFuZ2U6ZnVuY3Rpb24oZXZlbnQpe2lmKHRoaXMuX2lnbm9yZV9oYXNoY2hhbmdlKXt0aGlzLl9pZ25vcmVfaGFzaGNoYW5nZT1mYWxzZTtyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7fQp2YXIgc2VsZj10aGlzO3JldHVybiB0aGlzLmNsZWFyX3VuY29tbWl0dGVkX2NoYW5nZXMoKS50aGVuKGZ1bmN0aW9uKCl7dmFyIHN0cmluZ3N0YXRlPSQuYmJxLmdldFN0YXRlKGZhbHNlKTtpZighXy5pc0VxdWFsKHNlbGYuX2N1cnJlbnRfc3RhdGUsc3RyaW5nc3RhdGUpKXt2YXIgc3RhdGU9JC5iYnEuZ2V0U3RhdGUodHJ1ZSk7aWYoc3RhdGUuYWN0aW9ufHwoc3RhdGUubW9kZWwmJihzdGF0ZS52aWV3X3R5cGV8fHN0YXRlLmlkKSkpe3JldHVybiBzZWxmLm1lbnVfZHAuYWRkKHNlbGYuYWN0aW9uX21hbmFnZXIubG9hZFN0YXRlKHN0YXRlLCEhc2VsZi5fY3VycmVudF9zdGF0ZSkpLnRoZW4oZnVuY3Rpb24oKXtpZihzdGF0ZS5tZW51X2lkKXtpZihzdGF0ZS5tZW51X2lkIT09c2VsZi5tZW51LmN1cnJlbnRfcHJpbWFyeV9tZW51KXtjb3JlLmJ1cy50cmlnZ2VyKCdjaGFuZ2VfbWVudV9zZWN0aW9uJyxzdGF0ZS5tZW51X2lkKTt9fWVsc2V7dmFyIGFjdGlvbj1zZWxmLmFjdGlvbl9tYW5hZ2VyLmdldEN1cnJlbnRBY3Rpb24oKTtpZihhY3Rpb24pe3ZhciBtZW51X2lkPXNlbGYubWVudS5hY3Rpb25faWRfdG9fcHJpbWFyeV9tZW51X2lkKGFjdGlvbi5pZCk7Y29yZS5idXMudHJpZ2dlcignY2hhbmdlX21lbnVfc2VjdGlvbicsbWVudV9pZCk7fX19KTt9ZWxzZSBpZihzdGF0ZS5tZW51X2lkKXt2YXIgYWN0aW9uX2lkPXNlbGYubWVudS5tZW51X2lkX3RvX2FjdGlvbl9pZChzdGF0ZS5tZW51X2lkKTtyZXR1cm4gc2VsZi5tZW51X2RwLmFkZChzZWxmLmRvX2FjdGlvbihhY3Rpb25faWQse2NsZWFyX2JyZWFkY3J1bWJzOnRydWV9KSkudGhlbihmdW5jdGlvbigpe2NvcmUuYnVzLnRyaWdnZXIoJ2NoYW5nZV9tZW51X3NlY3Rpb24nLHN0YXRlLm1lbnVfaWQpO30pO31lbHNle3NlbGYubWVudS5vcGVuRmlyc3RBcHAoKTt9fQpzZWxmLl9jdXJyZW50X3N0YXRlPXN0cmluZ3N0YXRlO30sZnVuY3Rpb24oKXtpZihldmVudCl7c2VsZi5faWdub3JlX2hhc2hjaGFuZ2U9dHJ1ZTt3aW5kb3cubG9jYXRpb249ZXZlbnQub3JpZ2luYWxFdmVudC5vbGRVUkw7fX0pO30sb25fYXBwX2NsaWNrZWQ6ZnVuY3Rpb24oZXYpe3ZhciBzZWxmPXRoaXM7cmV0dXJuIHRoaXMubWVudV9kcC5hZGQoZGF0YV9tYW5hZ2VyLmxvYWRfYWN0aW9uKGV2LmRhdGEuYWN0aW9uX2lkKSkudGhlbihmdW5jdGlvbihyZXN1bHQpe3JldHVybiBzZWxmLmFjdGlvbl9tdXRleC5leGVjKGZ1bmN0aW9uKCl7dmFyIGNvbXBsZXRlZD1uZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLHJlamVjdCl7dmFyIG9wdGlvbnM9Xy5leHRlbmQoe30sZXYuZGF0YS5vcHRpb25zLHtjbGVhcl9icmVhZGNydW1iczp0cnVlLGFjdGlvbl9tZW51X2lkOmV2LmRhdGEubWVudV9pZCx9KTtQcm9taXNlLnJlc29sdmUoc2VsZi5fb3Blbk1lbnUocmVzdWx0LG9wdGlvbnMpKS50aGVuKGZ1bmN0aW9uKCl7c2VsZi5fb25fYXBwX2NsaWNrZWRfZG9uZShldikudGhlbihyZXNvbHZlKS5ndWFyZGVkQ2F0Y2gocmVqZWN0KTt9KS5ndWFyZGVkQ2F0Y2goZnVuY3Rpb24oKXtyZXNvbHZlKCk7fSk7c2V0VGltZW91dChmdW5jdGlvbigpe3Jlc29sdmUoKTt9LDIwMDApO30pO3JldHVybiBjb21wbGV0ZWQ7fSk7fSk7fSxfb25fYXBwX2NsaWNrZWRfZG9uZTpmdW5jdGlvbihldil7Y29yZS5idXMudHJpZ2dlcignY2hhbmdlX21lbnVfc2VjdGlvbicsZXYuZGF0YS5tZW51X2lkKTtyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7fSxvbl9tZW51X2NsaWNrZWQ6ZnVuY3Rpb24oZXYpe3ZhciBzZWxmPXRoaXM7cmV0dXJuIHRoaXMubWVudV9kcC5hZGQoZGF0YV9tYW5hZ2VyLmxvYWRfYWN0aW9uKGV2LmRhdGEuYWN0aW9uX2lkKSkudGhlbihmdW5jdGlvbihyZXN1bHQpe3NlbGYuJGVsLnJlbW92ZUNsYXNzKCdvX21vYmlsZV9tZW51X29wZW5lZCcpO3JldHVybiBzZWxmLmFjdGlvbl9tdXRleC5leGVjKGZ1bmN0aW9uKCl7dmFyIGNvbXBsZXRlZD1uZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLHJlamVjdCl7UHJvbWlzZS5yZXNvbHZlKHNlbGYuX29wZW5NZW51KHJlc3VsdCx7Y2xlYXJfYnJlYWRjcnVtYnM6dHJ1ZSx9KSkudGhlbihyZXNvbHZlKS5ndWFyZGVkQ2F0Y2gocmVqZWN0KTtzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7cmVzb2x2ZSgpO30sMjAwMCk7fSk7cmV0dXJuIGNvbXBsZXRlZDt9KTt9KS5ndWFyZGVkQ2F0Y2goZnVuY3Rpb24oKXtzZWxmLiRlbC5yZW1vdmVDbGFzcygnb19tb2JpbGVfbWVudV9vcGVuZWQnKTt9KTt9LF9vcGVuTWVudTpmdW5jdGlvbihhY3Rpb24sb3B0aW9ucyl7cmV0dXJuIHRoaXMuZG9fYWN0aW9uKGFjdGlvbixvcHRpb25zKTt9LGdldFNjcm9sbFBvc2l0aW9uOmZ1bmN0aW9uKCl7cmV0dXJue2xlZnQ6dGhpcy5hY3Rpb25fbWFuYWdlci5lbC5zY3JvbGxMZWZ0LHRvcDp0aGlzLmFjdGlvbl9tYW5hZ2VyLmVsLnNjcm9sbFRvcCx9O30sX29uR2V0U2Nyb2xsUG9zaXRpb246ZnVuY3Rpb24oZXYpe2V2LmRhdGEuY2FsbGJhY2sodGhpcy5nZXRTY3JvbGxQb3NpdGlvbigpKTt9LF9vblNjcm9sbFRvOmZ1bmN0aW9uKGV2KXt2YXIgb2Zmc2V0PXt0b3A6ZXYuZGF0YS50b3AsbGVmdDpldi5kYXRhLmxlZnR8fDB9O2lmKCFvZmZzZXQudG9wKXtvZmZzZXQ9ZG9tLmdldFBvc2l0aW9uKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZXYuZGF0YS5zZWxlY3RvcikpO29mZnNldC50b3AtPWRvbS5nZXRQb3NpdGlvbih0aGlzLmFjdGlvbl9tYW5hZ2VyLmVsKS50b3A7fQp0aGlzLmFjdGlvbl9tYW5hZ2VyLmVsLnNjcm9sbFRvcD1vZmZzZXQudG9wO3RoaXMuYWN0aW9uX21hbmFnZXIuZWwuc2Nyb2xsTGVmdD1vZmZzZXQubGVmdDt9LH0pO30pOzsKCi8qIC93ZWIvc3RhdGljL3NyYy9qcy9jaHJvbWUvcm9vdF93aWRnZXQuanMgZGVmaW5lZCBpbiBidW5kbGUgJ3dlYi5hc3NldHNfYmFja2VuZCcgKi8Kb2Rvby5kZWZpbmUoJ3Jvb3Qud2lkZ2V0JyxmdW5jdGlvbihyZXF1aXJlKXsidXNlIHN0cmljdCI7dmFyIHdlYkNsaWVudD1yZXF1aXJlKCd3ZWIud2ViX2NsaWVudCcpO3JldHVybiB3ZWJDbGllbnQ7fSk7OwoKLyogL3dlYi9zdGF0aWMvc3JjL2pzL19kZXByZWNhdGVkL2RhdGEuanMgZGVmaW5lZCBpbiBidW5kbGUgJ3dlYi5hc3NldHNfYmFja2VuZCcgKi8Kb2Rvby5kZWZpbmUoJ3dlYi5kYXRhJyxmdW5jdGlvbihyZXF1aXJlKXsidXNlIHN0cmljdCI7dmFyIENsYXNzPXJlcXVpcmUoJ3dlYi5DbGFzcycpO3ZhciBDb250ZXh0PXJlcXVpcmUoJ3dlYi5Db250ZXh0Jyk7dmFyIGNvbmN1cnJlbmN5PXJlcXVpcmUoJ3dlYi5jb25jdXJyZW5jeScpO3ZhciBtaXhpbnM9cmVxdWlyZSgnd2ViLm1peGlucycpO3ZhciBzZXNzaW9uPXJlcXVpcmUoJ3dlYi5zZXNzaW9uJyk7dmFyIHRyYW5zbGF0aW9uPXJlcXVpcmUoJ3dlYi50cmFuc2xhdGlvbicpO3ZhciBweVV0aWxzPXJlcXVpcmUoJ3dlYi5weV91dGlscycpO3ZhciBfdD10cmFuc2xhdGlvbi5fdDtmdW5jdGlvbiBzZXJpYWxpemVfc29ydChjcml0ZXJpb24pe3JldHVybiBfLm1hcChjcml0ZXJpb24sZnVuY3Rpb24oY3JpdGVyaWEpe2lmKGNyaXRlcmlhWzBdPT09Jy0nKXtyZXR1cm4gY3JpdGVyaWEuc2xpY2UoMSkrJyBERVNDJzt9CnJldHVybiBjcml0ZXJpYSsnIEFTQyc7fSkuam9pbignLCAnKTt9CmZ1bmN0aW9uIGRlc2VyaWFsaXplX3NvcnQoY3JpdGVyaW9uKXtyZXR1cm4gXy5tYXAoY3JpdGVyaW9uLGZ1bmN0aW9uKGNyaXRlcmlhKXt2YXIgc3BsaXQ9Xy53aXRob3V0KGNyaXRlcmlhLnNwbGl0KCcgJyksJycpO3JldHVybihzcGxpdFsxXSYmc3BsaXRbMV0udG9Mb3dlckNhc2UoKT09PSdkZXNjJz8nLSc6JycpK3NwbGl0WzBdO30pO30KdmFyIFF1ZXJ5PUNsYXNzLmV4dGVuZCh7aW5pdDpmdW5jdGlvbihtb2RlbCxmaWVsZHMpe3RoaXMuX21vZGVsPW1vZGVsO3RoaXMuX2ZpZWxkcz1maWVsZHM7dGhpcy5fZmlsdGVyPVtdO3RoaXMuX2NvbnRleHQ9e307dGhpcy5fbGF6eT10cnVlO3RoaXMuX2xpbWl0PWZhbHNlO3RoaXMuX29mZnNldD0wO3RoaXMuX29yZGVyX2J5PVtdO30sY2xvbmU6ZnVuY3Rpb24odG9fc2V0KXt0b19zZXQ9dG9fc2V0fHx7fTt2YXIgcT1uZXcgUXVlcnkodGhpcy5fbW9kZWwsdGhpcy5fZmllbGRzKTtxLl9jb250ZXh0PXRoaXMuX2NvbnRleHQ7cS5fZmlsdGVyPXRoaXMuX2ZpbHRlcjtxLl9sYXp5PXRoaXMuX2xhenk7cS5fbGltaXQ9dGhpcy5fbGltaXQ7cS5fb2Zmc2V0PXRoaXMuX29mZnNldDtxLl9vcmRlcl9ieT10aGlzLl9vcmRlcl9ieTtmb3IodmFyIGtleSBpbiB0b19zZXQpe2lmKCF0b19zZXQuaGFzT3duUHJvcGVydHkoa2V5KSl7Y29udGludWU7fQpzd2l0Y2goa2V5KXtjYXNlJ2ZpbHRlcic6cS5fZmlsdGVyPShxLl9maWx0ZXJ8fFtdKS5jb25jYXQodG9fc2V0LmZpbHRlcnx8W10pO2JyZWFrO2Nhc2UnY29udGV4dCc6cS5fY29udGV4dD1uZXcgQ29udGV4dChxLl9jb250ZXh0LHRvX3NldC5jb250ZXh0KTticmVhaztjYXNlJ2xhenknOmNhc2UnbGltaXQnOmNhc2Unb2Zmc2V0JzpjYXNlJ29yZGVyX2J5JzpxWydfJytrZXldPXRvX3NldFtrZXldO319CnJldHVybiBxO30sX2V4ZWN1dGU6ZnVuY3Rpb24ob3B0aW9ucyl7dmFyIHNlbGY9dGhpcztvcHRpb25zPW9wdGlvbnN8fHt9O3JldHVybiBzZXNzaW9uLnJwYygnL3dlYi9kYXRhc2V0L3NlYXJjaF9yZWFkJyx7bW9kZWw6dGhpcy5fbW9kZWwubmFtZSxmaWVsZHM6dGhpcy5fZmllbGRzfHxmYWxzZSxkb21haW46cHlVdGlscy5ldmFsKCdkb21haW5zJyxbdGhpcy5fbW9kZWwuZG9tYWluKHRoaXMuX2ZpbHRlcildKSxjb250ZXh0OnB5VXRpbHMuZXZhbCgnY29udGV4dHMnLFt0aGlzLl9tb2RlbC5jb250ZXh0KHRoaXMuX2NvbnRleHQpXSksb2Zmc2V0OnRoaXMuX29mZnNldCxsaW1pdDp0aGlzLl9saW1pdCxzb3J0OnNlcmlhbGl6ZV9zb3J0KHRoaXMuX29yZGVyX2J5KX0sb3B0aW9ucykudGhlbihmdW5jdGlvbihyZXN1bHRzKXtzZWxmLl9jb3VudD1yZXN1bHRzLmxlbmd0aDtyZXR1cm4gcmVzdWx0cy5yZWNvcmRzO30sbnVsbCk7fSxmaXJzdDpmdW5jdGlvbihvcHRpb25zKXt2YXIgc2VsZj10aGlzO3JldHVybiB0aGlzLmNsb25lKHtsaW1pdDoxfSkuX2V4ZWN1dGUob3B0aW9ucykudGhlbihmdW5jdGlvbihyZWNvcmRzKXtkZWxldGUgc2VsZi5fY291bnQ7aWYocmVjb3Jkcy5sZW5ndGgpe3JldHVybiByZWNvcmRzWzBdO30KcmV0dXJuIG51bGw7fSk7fSxhbGw6ZnVuY3Rpb24ob3B0aW9ucyl7cmV0dXJuIHRoaXMuX2V4ZWN1dGUob3B0aW9ucyk7fSxjb3VudDpmdW5jdGlvbigpe2lmKHRoaXMuX2NvdW50IT09dW5kZWZpbmVkKXtyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHRoaXMuX2NvdW50KTt9CnJldHVybiB0aGlzLl9tb2RlbC5jYWxsKCdzZWFyY2hfY291bnQnLFt0aGlzLl9maWx0ZXJdLHtjb250ZXh0OnRoaXMuX21vZGVsLmNvbnRleHQodGhpcy5fY29udGV4dCl9KTt9LGdyb3VwX2J5OmZ1bmN0aW9uKGdyb3VwaW5nKXt2YXIgY3R4PXB5VXRpbHMuZXZhbCgnY29udGV4dCcsdGhpcy5fbW9kZWwuY29udGV4dCh0aGlzLl9jb250ZXh0KSk7aWYoXy5pc1VuZGVmaW5lZChncm91cGluZykpe2dyb3VwaW5nPVtdO30KaWYoIShncm91cGluZyBpbnN0YW5jZW9mIEFycmF5KSl7Z3JvdXBpbmc9Xy50b0FycmF5KGFyZ3VtZW50cyk7fQppZihfLmlzRW1wdHkoZ3JvdXBpbmcpJiYhY3R4Lmdyb3VwX2J5X25vX2xlYWYpe3JldHVybiBudWxsO30KdmFyIHJhd19maWVsZHM9Xy5tYXAoZ3JvdXBpbmcuY29uY2F0KHRoaXMuX2ZpZWxkc3x8W10pLGZ1bmN0aW9uKGZpZWxkKXtyZXR1cm4gZmllbGQuc3BsaXQoJzonKVswXTt9KTt2YXIgc2VsZj10aGlzO3JldHVybiB0aGlzLl9tb2RlbC5jYWxsKCdyZWFkX2dyb3VwJyx7Z3JvdXBieTpncm91cGluZyxmaWVsZHM6Xy51bmlxKHJhd19maWVsZHMpLGRvbWFpbjp0aGlzLl9tb2RlbC5kb21haW4odGhpcy5fZmlsdGVyKSxjb250ZXh0OmN0eCxvZmZzZXQ6dGhpcy5fb2Zmc2V0LGxhenk6dGhpcy5fbGF6eSxsaW1pdDp0aGlzLl9saW1pdCxvcmRlcmJ5OnNlcmlhbGl6ZV9zb3J0KHRoaXMuX29yZGVyX2J5KXx8ZmFsc2V9KS50aGVuKGZ1bmN0aW9uKHJlc3VsdHMpe3JldHVybiBfKHJlc3VsdHMpLm1hcChmdW5jdGlvbihyZXN1bHQpe3Jlc3VsdC5fX2NvbnRleHQ9cmVzdWx0Ll9fY29udGV4dHx8e307cmVzdWx0Ll9fY29udGV4dC5ncm91cF9ieT1yZXN1bHQuX19jb250ZXh0Lmdyb3VwX2J5fHxbXTtfLmRlZmF1bHRzKHJlc3VsdC5fX2NvbnRleHQsY3R4KTt2YXIgZ3JvdXBpbmdfZmllbGRzPXNlbGYuX2xhenk/W2dyb3VwaW5nWzBdXTpncm91cGluZztyZXR1cm4gbmV3IFF1ZXJ5R3JvdXAoc2VsZi5fbW9kZWwubmFtZSxncm91cGluZ19maWVsZHMscmVzdWx0KTt9KTt9KTt9LGNvbnRleHQ6ZnVuY3Rpb24oY29udGV4dCl7aWYoIWNvbnRleHQpe3JldHVybiB0aGlzO30KcmV0dXJuIHRoaXMuY2xvbmUoe2NvbnRleHQ6Y29udGV4dH0pO30sZmlsdGVyOmZ1bmN0aW9uKGRvbWFpbil7aWYoIWRvbWFpbil7cmV0dXJuIHRoaXM7fQpyZXR1cm4gdGhpcy5jbG9uZSh7ZmlsdGVyOmRvbWFpbn0pO30sbGF6eTpmdW5jdGlvbihsYXp5KXtyZXR1cm4gdGhpcy5jbG9uZSh7bGF6eTpsYXp5fSk7fSxsaW1pdDpmdW5jdGlvbihsaW1pdCl7cmV0dXJuIHRoaXMuY2xvbmUoe2xpbWl0OmxpbWl0fSk7fSxvZmZzZXQ6ZnVuY3Rpb24ob2Zmc2V0KXtyZXR1cm4gdGhpcy5jbG9uZSh7b2Zmc2V0Om9mZnNldH0pO30sb3JkZXJfYnk6ZnVuY3Rpb24oZmllbGRzKXtpZihmaWVsZHM9PT11bmRlZmluZWQpe3JldHVybiB0aGlzO30KaWYoIShmaWVsZHMgaW5zdGFuY2VvZiBBcnJheSkpe2ZpZWxkcz1fLnRvQXJyYXkoYXJndW1lbnRzKTt9CmlmKF8uaXNFbXB0eShmaWVsZHMpKXtyZXR1cm4gdGhpczt9CnJldHVybiB0aGlzLmNsb25lKHtvcmRlcl9ieTpmaWVsZHN9KTt9fSk7dmFyIFF1ZXJ5R3JvdXA9Q2xhc3MuZXh0ZW5kKHtpbml0OmZ1bmN0aW9uKG1vZGVsLGdyb3VwaW5nX2ZpZWxkcyxyZWFkX2dyb3VwX2dyb3VwKXt2YXIgZml4ZWRfZ3JvdXA9Xy5leHRlbmQoe19fY29udGV4dDp7Z3JvdXBfYnk6W119LF9fZG9tYWluOltdfSxyZWFkX2dyb3VwX2dyb3VwKTt2YXIgY291bnRfa2V5PShncm91cGluZ19maWVsZHNbMF0mJmdyb3VwaW5nX2ZpZWxkc1swXS5zcGxpdCgnOicpWzBdKSsnX2NvdW50Jzt2YXIgYWdncmVnYXRlcz17fTtmb3IodmFyIGtleSBpbiBmaXhlZF9ncm91cCl7aWYoZml4ZWRfZ3JvdXAuaGFzT3duUHJvcGVydHkoa2V5KSl7aWYoIShrZXkuaW5kZXhPZignX18nKT09PTB8fF8uY29udGFpbnMoZ3JvdXBpbmdfZmllbGRzLGtleSl8fChrZXk9PT1jb3VudF9rZXkpKSl7YWdncmVnYXRlc1trZXldPWZpeGVkX2dyb3VwW2tleV18fDA7fX19CnRoaXMubW9kZWw9bmV3IE1vZGVsKG1vZGVsLGZpeGVkX2dyb3VwLl9fY29udGV4dCxmaXhlZF9ncm91cC5fX2RvbWFpbik7dmFyIGdyb3VwX3NpemU9Zml4ZWRfZ3JvdXBbY291bnRfa2V5XXx8Zml4ZWRfZ3JvdXAuX19jb3VudHx8MDt2YXIgbGVhZl9ncm91cD1maXhlZF9ncm91cC5fX2NvbnRleHQuZ3JvdXBfYnkubGVuZ3RoPT09MDt2YXIgdmFsdWU9KGdyb3VwaW5nX2ZpZWxkcy5sZW5ndGg9PT0xKT9maXhlZF9ncm91cFtncm91cGluZ19maWVsZHNbMF1dOl8ubWFwKGdyb3VwaW5nX2ZpZWxkcyxmdW5jdGlvbihmaWVsZCl7cmV0dXJuIGZpeGVkX2dyb3VwW2ZpZWxkXTt9KTt2YXIgZ3JvdXBlZF9vbj0oZ3JvdXBpbmdfZmllbGRzLmxlbmd0aD09PTEpP2dyb3VwaW5nX2ZpZWxkc1swXTpncm91cGluZ19maWVsZHM7dGhpcy5hdHRyaWJ1dGVzPXtmb2xkZWQ6ISEoZml4ZWRfZ3JvdXAuX19mb2xkKSxncm91cGVkX29uOmdyb3VwZWRfb24sbGVuZ3RoOmdyb3VwX3NpemUsdmFsdWU6dmFsdWUsaGFzX2NoaWxkcmVuOiEobGVhZl9ncm91cCYmZml4ZWRfZ3JvdXAuX19jb250ZXh0Lmdyb3VwX2J5X25vX2xlYWYpLGFnZ3JlZ2F0ZXM6YWdncmVnYXRlc307fSxnZXQ6ZnVuY3Rpb24oa2V5KXtyZXR1cm4gdGhpcy5hdHRyaWJ1dGVzW2tleV07fSxzdWJncm91cHM6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tb2RlbC5xdWVyeSgpLmdyb3VwX2J5KHRoaXMubW9kZWwuY29udGV4dCgpLmdyb3VwX2J5KTt9LHF1ZXJ5OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubW9kZWwucXVlcnkuYXBwbHkodGhpcy5tb2RlbCxhcmd1bWVudHMpO319KTt2YXIgRGF0YVNldD1DbGFzcy5leHRlbmQobWl4aW5zLlByb3BlcnRpZXNNaXhpbix7aW5pdDpmdW5jdGlvbihwYXJlbnQsbW9kZWwsY29udGV4dCl7bWl4aW5zLlByb3BlcnRpZXNNaXhpbi5pbml0LmNhbGwodGhpcyk7dGhpcy5zZXRQYXJlbnQocGFyZW50KTt0aGlzLm1vZGVsPW1vZGVsO3RoaXMuY29udGV4dD1jb250ZXh0fHx7fTt0aGlzLmluZGV4PW51bGw7dGhpcy5fc29ydD1bXTt0aGlzLl9tb2RlbD1uZXcgTW9kZWwobW9kZWwsY29udGV4dCk7dGhpcy5vcmRlcmVyPW5ldyBjb25jdXJyZW5jeS5Ecm9wTWlzb3JkZXJlZCgpO30scHJldmlvdXM6ZnVuY3Rpb24oKXt0aGlzLmluZGV4LT0xO2lmKCF0aGlzLmlkcy5sZW5ndGgpe3RoaXMuaW5kZXg9bnVsbDt9ZWxzZSBpZih0aGlzLmluZGV4PDApe3RoaXMuaW5kZXg9dGhpcy5pZHMubGVuZ3RoLTE7fQpyZXR1cm4gdGhpczt9LG5leHQ6ZnVuY3Rpb24oKXt0aGlzLmluZGV4Kz0xO2lmKCF0aGlzLmlkcy5sZW5ndGgpe3RoaXMuaW5kZXg9bnVsbDt9ZWxzZSBpZih0aGlzLmluZGV4Pj10aGlzLmlkcy5sZW5ndGgpe3RoaXMuaW5kZXg9MDt9CnJldHVybiB0aGlzO30sc2VsZWN0X2lkOmZ1bmN0aW9uKGlkKXt2YXIgaWR4PXRoaXMuZ2V0X2lkX2luZGV4KGlkKTtpZihpZHg9PT1udWxsKXtyZXR1cm4gZmFsc2U7fWVsc2V7dGhpcy5pbmRleD1pZHg7cmV0dXJuIHRydWU7fX0sZ2V0X2lkX2luZGV4OmZ1bmN0aW9uKGlkKXtmb3IodmFyIGk9MCxpaT10aGlzLmlkcy5sZW5ndGg7aTxpaTtpKyspe2lmKGlkPT10aGlzLmlkc1tpXSl7cmV0dXJuIGk7fX0KcmV0dXJuIG51bGw7fSxyZWFkX2lkczpmdW5jdGlvbihpZHMsZmllbGRzLG9wdGlvbnMpe2lmKF8uaXNFbXB0eShpZHMpKXtyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKFtdKTt9Cm9wdGlvbnM9b3B0aW9uc3x8e307dmFyIG1ldGhvZD0ncmVhZCc7dmFyIGlkc19hcmc9aWRzO3ZhciBjb250ZXh0PXRoaXMuZ2V0X2NvbnRleHQob3B0aW9ucy5jb250ZXh0KTtpZihvcHRpb25zLmNoZWNrX2FjY2Vzc19ydWxlPT09dHJ1ZSl7bWV0aG9kPSdzZWFyY2hfcmVhZCc7aWRzX2FyZz1bWydpZCcsJ2luJyxpZHNdXTtjb250ZXh0PW5ldyBDb250ZXh0KGNvbnRleHQse2FjdGl2ZV90ZXN0OmZhbHNlfSk7fQpyZXR1cm4gdGhpcy5fbW9kZWwuY2FsbChtZXRob2QsW2lkc19hcmcsZmllbGRzfHxmYWxzZV0se2NvbnRleHQ6Y29udGV4dH0pLnRoZW4oZnVuY3Rpb24ocmVjb3Jkcyl7aWYocmVjb3Jkcy5sZW5ndGg8PTEpe3JldHVybiByZWNvcmRzO30KdmFyIGluZGV4ZXM9e307Zm9yKHZhciBpPTA7aTxpZHMubGVuZ3RoO2krKyl7aW5kZXhlc1tpZHNbaV1dPWk7fQpyZWNvcmRzLnNvcnQoZnVuY3Rpb24oYSxiKXtyZXR1cm4gaW5kZXhlc1thLmlkXS1pbmRleGVzW2IuaWRdO30pO3JldHVybiByZWNvcmRzO30pO30scmVhZF9zbGljZTpmdW5jdGlvbihmaWVsZHMsb3B0aW9ucyl7dmFyIHNlbGY9dGhpcztvcHRpb25zPW9wdGlvbnN8fHt9O3ZhciBxdWVyeT10aGlzLl9tb2RlbC5xdWVyeShmaWVsZHMpLmxpbWl0KG9wdGlvbnMubGltaXR8fGZhbHNlKS5vZmZzZXQob3B0aW9ucy5vZmZzZXR8fDApLmFsbCgpO3ZhciBwcm9tPXRoaXMub3JkZXJlci5hZGQocXVlcnkpO3Byb20udGhlbihmdW5jdGlvbihyZWNvcmRzKXtzZWxmLmlkcz1fKHJlY29yZHMpLnBsdWNrKCdpZCcpO30pO3JldHVybiBwcm9tO30scmVhZF9pbmRleDpmdW5jdGlvbihmaWVsZHMsb3B0aW9ucyl7b3B0aW9ucz1vcHRpb25zfHx7fTtyZXR1cm4gdGhpcy5yZWFkX2lkcyhbdGhpcy5pZHNbdGhpcy5pbmRleF1dLGZpZWxkcyxvcHRpb25zKS50aGVuKGZ1bmN0aW9uKHJlY29yZHMpe2lmKF8uaXNFbXB0eShyZWNvcmRzKSl7cmV0dXJuIFByb21pc2UucmVqZWN0KCk7fQpyZXR1cm4gcmVjb3Jkc1swXTt9KTt9LGRlZmF1bHRfZ2V0OmZ1bmN0aW9uKGZpZWxkcyxvcHRpb25zKXtvcHRpb25zPW9wdGlvbnN8fHt9O3JldHVybiB0aGlzLl9tb2RlbC5jYWxsKCdkZWZhdWx0X2dldCcsW2ZpZWxkc10se2NvbnRleHQ6dGhpcy5nZXRfY29udGV4dChvcHRpb25zLmNvbnRleHQpfSk7fSxjcmVhdGU6ZnVuY3Rpb24oZGF0YSxvcHRpb25zKXt2YXIgc2VsZj10aGlzO3ZhciBwcm9tPXRoaXMuX21vZGVsLmNhbGwoJ2NyZWF0ZScsW2RhdGFdLHtjb250ZXh0OnRoaXMuZ2V0X2NvbnRleHQoKX0pO3Byb20udGhlbihmdW5jdGlvbigpe3NlbGYudHJpZ2dlcignZGF0YXNldF9jaGFuZ2VkJyxkYXRhLG9wdGlvbnMpO30pO3JldHVybiBwcm9tO30sd3JpdGU6ZnVuY3Rpb24oaWQsZGF0YSxvcHRpb25zKXtvcHRpb25zPW9wdGlvbnN8fHt9O3ZhciBzZWxmPXRoaXM7dmFyIHByb209dGhpcy5fbW9kZWwuY2FsbCgnd3JpdGUnLFtbaWRdLGRhdGFdLHtjb250ZXh0OnRoaXMuZ2V0X2NvbnRleHQob3B0aW9ucy5jb250ZXh0KX0pO3Byb20udGhlbihmdW5jdGlvbigpe3NlbGYudHJpZ2dlcignZGF0YXNldF9jaGFuZ2VkJyxpZCxkYXRhLG9wdGlvbnMpO30pO3JldHVybiBwcm9tO30sdW5saW5rOmZ1bmN0aW9uKGlkcyl7dmFyIHNlbGY9dGhpczt2YXIgcHJvbT10aGlzLl9tb2RlbC5jYWxsKCd1bmxpbmsnLFtpZHNdLHtjb250ZXh0OnRoaXMuZ2V0X2NvbnRleHQoKX0pO3Byb20udGhlbihmdW5jdGlvbigpe3NlbGYudHJpZ2dlcignZGF0YXNldF9jaGFuZ2VkJyxpZHMpO30pO3JldHVybiBwcm9tO30sY2FsbDpmdW5jdGlvbihtZXRob2QsYXJncyl7cmV0dXJuIHRoaXMuX21vZGVsLmNhbGwobWV0aG9kLGFyZ3MpO30sY2FsbF9idXR0b246ZnVuY3Rpb24obWV0aG9kLGFyZ3Mpe3JldHVybiB0aGlzLl9tb2RlbC5jYWxsX2J1dHRvbihtZXRob2QsYXJncyk7fSxuYW1lX2dldDpmdW5jdGlvbihpZHMpe3JldHVybiB0aGlzLl9tb2RlbC5jYWxsKCduYW1lX2dldCcsW2lkc10se2NvbnRleHQ6dGhpcy5nZXRfY29udGV4dCgpfSk7fSxuYW1lX3NlYXJjaDpmdW5jdGlvbihuYW1lLGRvbWFpbixvcGVyYXRvcixsaW1pdCl7cmV0dXJuIHRoaXMuX21vZGVsLmNhbGwoJ25hbWVfc2VhcmNoJyx7bmFtZTpuYW1lfHwnJyxhcmdzOmRvbWFpbnx8ZmFsc2Usb3BlcmF0b3I6b3BlcmF0b3J8fCdpbGlrZScsY29udGV4dDp0aGlzLl9tb2RlbC5jb250ZXh0KCksbGltaXQ6bGltaXR8fDB9KTt9LG5hbWVfY3JlYXRlOmZ1bmN0aW9uKG5hbWUsY29udGV4dCl7cmV0dXJuIHRoaXMuX21vZGVsLmNhbGwoJ25hbWVfY3JlYXRlJyxbbmFtZV0se2NvbnRleHQ6dGhpcy5nZXRfY29udGV4dChjb250ZXh0KX0pO30sZ2V0X2NvbnRleHQ6ZnVuY3Rpb24ocmVxdWVzdF9jb250ZXh0KXtyZXR1cm4gdGhpcy5fbW9kZWwuY29udGV4dChyZXF1ZXN0X2NvbnRleHQpO30sc29ydDpmdW5jdGlvbihmaWVsZCxmb3JjZV9yZXZlcnNlKXtpZighZmllbGQpe3JldHVybiBzZXJpYWxpemVfc29ydCh0aGlzLl9zb3J0KTt9CnZhciByZXZlcnNlPWZvcmNlX3JldmVyc2V8fCh0aGlzLl9zb3J0WzBdPT09ZmllbGQpO3RoaXMuX3NvcnQuc3BsaWNlLmFwcGx5KHRoaXMuX3NvcnQsWzAsdGhpcy5fc29ydC5sZW5ndGhdLmNvbmNhdChfLndpdGhvdXQodGhpcy5fc29ydCxmaWVsZCwnLScrZmllbGQpKSk7dGhpcy5fc29ydC51bnNoaWZ0KChyZXZlcnNlPyctJzonJykrZmllbGQpO3JldHVybiB1bmRlZmluZWQ7fSxzZXRfc29ydDpmdW5jdGlvbihmaWVsZHNfbGlzdCl7dGhpcy5fc29ydD1kZXNlcmlhbGl6ZV9zb3J0KGZpZWxkc19saXN0KTt9LHNpemU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pZHMubGVuZ3RoO30sYWx0ZXJfaWRzOmZ1bmN0aW9uKG5faWRzKXt0aGlzLmlkcz1uX2lkczt9LHJlbW92ZV9pZHM6ZnVuY3Rpb24oaWRzKXt0aGlzLmFsdGVyX2lkcyhfKHRoaXMuaWRzKS5kaWZmZXJlbmNlKGlkcykpO30sYWRkX2lkczpmdW5jdGlvbihpZHMsYXQpe3ZhciBhcmdzPVthdCwwXS5jb25jYXQoXy5kaWZmZXJlbmNlKGlkcyx0aGlzLmlkcykpO3RoaXMuaWRzLnNwbGljZS5hcHBseSh0aGlzLmlkcyxhcmdzKTt9LHJlc2VxdWVuY2U6ZnVuY3Rpb24oaWRzLG9wdGlvbnMpe29wdGlvbnM9b3B0aW9uc3x8e307cmV0dXJuIHNlc3Npb24ucnBjKCcvd2ViL2RhdGFzZXQvcmVzZXF1ZW5jZScse21vZGVsOnRoaXMubW9kZWwsaWRzOmlkcyxjb250ZXh0OnB5VXRpbHMuZXZhbCgnY29udGV4dCcsdGhpcy5nZXRfY29udGV4dChvcHRpb25zLmNvbnRleHQpKSx9KS50aGVuKGZ1bmN0aW9uKHJlc3VsdHMpe3JldHVybiByZXN1bHRzO30pO30sfSk7dmFyIERhdGFTZXRTdGF0aWM9RGF0YVNldC5leHRlbmQoe2luaXQ6ZnVuY3Rpb24ocGFyZW50LG1vZGVsLGNvbnRleHQsaWRzKXt0aGlzLl9zdXBlcihwYXJlbnQsbW9kZWwsY29udGV4dCk7dGhpcy5pZHM9aWRzfHxbXTt9LHJlYWRfc2xpY2U6ZnVuY3Rpb24oZmllbGRzLG9wdGlvbnMpe29wdGlvbnM9b3B0aW9uc3x8e307ZmllbGRzPWZpZWxkc3x8e307dmFyIG9mZnNldD1vcHRpb25zLm9mZnNldHx8MCxsaW1pdD1vcHRpb25zLmxpbWl0fHxmYWxzZTt2YXIgZW5kX3Bvcz1saW1pdCYmbGltaXQhPT0tMT9vZmZzZXQrbGltaXQ6dGhpcy5pZHMubGVuZ3RoO3JldHVybiB0aGlzLnJlYWRfaWRzKHRoaXMuaWRzLnNsaWNlKG9mZnNldCxlbmRfcG9zKSxmaWVsZHMsb3B0aW9ucyk7fSxzZXRfaWRzOmZ1bmN0aW9uKGlkcyl7dGhpcy5pZHM9aWRzO2lmKGlkcy5sZW5ndGg9PT0wKXt0aGlzLmluZGV4PW51bGw7fWVsc2UgaWYodGhpcy5pbmRleD49aWRzLmxlbmd0aC0xKXt0aGlzLmluZGV4PWlkcy5sZW5ndGgtMTt9fSx1bmxpbms6ZnVuY3Rpb24oaWRzKXt0aGlzLnNldF9pZHMoXy53aXRob3V0LmFwcGx5KG51bGwsW3RoaXMuaWRzXS5jb25jYXQoaWRzKSkpO3RoaXMudHJpZ2dlcigndW5saW5rJyxpZHMpO3JldHVybiBQcm9taXNlLnJlc29sdmUoe3Jlc3VsdDp0cnVlfSk7fSx9KTt2YXIgRGF0YVNldFNlYXJjaD1EYXRhU2V0LmV4dGVuZCh7aW5pdDpmdW5jdGlvbihwYXJlbnQsbW9kZWwsY29udGV4dCxkb21haW4pe3RoaXMuX3N1cGVyKHBhcmVudCxtb2RlbCxjb250ZXh0KTt0aGlzLmRvbWFpbj1kb21haW58fFtdO3RoaXMuX2xlbmd0aD1udWxsO3RoaXMuaWRzPVtdO3RoaXMuX21vZGVsPW5ldyBNb2RlbChtb2RlbCxjb250ZXh0LGRvbWFpbik7fSxyZWFkX3NsaWNlOmZ1bmN0aW9uKGZpZWxkcyxvcHRpb25zKXtvcHRpb25zPW9wdGlvbnN8fHt9O3ZhciBzZWxmPXRoaXM7dmFyIHE9dGhpcy5fbW9kZWwucXVlcnkoZmllbGRzfHxmYWxzZSkuZmlsdGVyKG9wdGlvbnMuZG9tYWluKS5jb250ZXh0KG9wdGlvbnMuY29udGV4dCkub2Zmc2V0KG9wdGlvbnMub2Zmc2V0fHwwKS5saW1pdChvcHRpb25zLmxpbWl0fHxmYWxzZSk7cT1xLm9yZGVyX2J5LmFwcGx5KHEsdGhpcy5fc29ydCk7dmFyIHByb209dGhpcy5vcmRlcmVyLmFkZChxLmFsbCgpKTtwcm9tLnRoZW4oZnVuY3Rpb24ocmVjb3Jkcyl7cS5jb3VudCgpLnRoZW4oZnVuY3Rpb24oY291bnQpe3NlbGYuX2xlbmd0aD1jb3VudDt9KTtzZWxmLmlkcz1fKHJlY29yZHMpLnBsdWNrKCdpZCcpO30pO3JldHVybiBwcm9tO30sZ2V0X2RvbWFpbjpmdW5jdGlvbihvdGhlcl9kb21haW4pe3JldHVybiB0aGlzLl9tb2RlbC5kb21haW4ob3RoZXJfZG9tYWluKTt9LGFsdGVyX2lkczpmdW5jdGlvbihpZHMpe3RoaXMuX3N1cGVyKGlkcyk7aWYodGhpcy5pbmRleCE9PW51bGwmJnRoaXMuaW5kZXg+PXRoaXMuaWRzLmxlbmd0aCl7dGhpcy5pbmRleD10aGlzLmlkcy5sZW5ndGg+MD90aGlzLmlkcy5sZW5ndGgtMTowO319LHJlbW92ZV9pZHM6ZnVuY3Rpb24oaWRzKXt2YXIgYmVmb3JlPXRoaXMuaWRzLmxlbmd0aDt0aGlzLl9zdXBlcihpZHMpO2lmKHRoaXMuX2xlbmd0aCl7dGhpcy5fbGVuZ3RoLT0oYmVmb3JlLXRoaXMuaWRzLmxlbmd0aCk7fX0sYWRkX2lkczpmdW5jdGlvbihpZHMsYXQpe3ZhciBiZWZvcmU9dGhpcy5pZHMubGVuZ3RoO3RoaXMuX3N1cGVyKGlkcyxhdCk7aWYodGhpcy5fbGVuZ3RoKXt0aGlzLl9sZW5ndGgrPSh0aGlzLmlkcy5sZW5ndGgtYmVmb3JlKTt9fSx1bmxpbms6ZnVuY3Rpb24oaWRzLGNhbGxiYWNrLGVycm9yX2NhbGxiYWNrKXt2YXIgc2VsZj10aGlzO3ZhciBwcm9tPXRoaXMuX3N1cGVyKGlkcyk7cHJvbS50aGVuKGZ1bmN0aW9uKCl7c2VsZi5yZW1vdmVfaWRzKGlkcyk7c2VsZi50cmlnZ2VyKCJkYXRhc2V0X2NoYW5nZWQiLGlkcyxjYWxsYmFjayxlcnJvcl9jYWxsYmFjayk7fSk7cmV0dXJuIHByb207fSxzaXplOmZ1bmN0aW9uKCl7aWYodGhpcy5fbGVuZ3RoIT09bnVsbCl7cmV0dXJuIHRoaXMuX2xlbmd0aDt9CnJldHVybiB0aGlzLl9zdXBlcigpO319KTt2YXIgZGF0YT17UXVlcnk6UXVlcnksRGF0YVNldDpEYXRhU2V0LERhdGFTZXRTdGF0aWM6RGF0YVNldFN0YXRpYyxEYXRhU2V0U2VhcmNoOkRhdGFTZXRTZWFyY2gsbm9EaXNwbGF5Q29udGVudDoiPGVtIGNsYXNzPVwidGV4dC13YXJuaW5nXCI+IitfdCgiVW5uYW1lZCIpKyI8L2VtPiIsfTt2YXIgTW9kZWw9Q2xhc3MuZXh0ZW5kKHtpbml0OmZ1bmN0aW9uKG5hbWUsY29udGV4dCxkb21haW4pe3RoaXMubmFtZT1uYW1lO3RoaXMuX2NvbnRleHQ9Y29udGV4dHx8e307dGhpcy5fZG9tYWluPWRvbWFpbnx8W107fSxnZXRfZnVuYzpmdW5jdGlvbihtZXRob2RfbmFtZSl7dmFyIHNlbGY9dGhpcztyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gc2VsZi5jYWxsKG1ldGhvZF9uYW1lLF8udG9BcnJheShhcmd1bWVudHMpKTt9O30scXVlcnk6ZnVuY3Rpb24oZmllbGRzKXtyZXR1cm4gbmV3IGRhdGEuUXVlcnkodGhpcyxmaWVsZHMpO30sZG9tYWluOmZ1bmN0aW9uKGRvbWFpbil7aWYoIWRvbWFpbil7cmV0dXJuIHRoaXMuX2RvbWFpbjt9CnJldHVybiB0aGlzLl9kb21haW4uY29uY2F0KGRvbWFpbik7fSxjb250ZXh0OmZ1bmN0aW9uKGNvbnRleHQpe3JldHVybiBuZXcgQ29udGV4dChzZXNzaW9uLnVzZXJfY29udGV4dCx0aGlzLl9jb250ZXh0LGNvbnRleHR8fHt9KTt9LGNhbGw6ZnVuY3Rpb24obWV0aG9kLGFyZ3Msa3dhcmdzLG9wdGlvbnMpe2FyZ3M9YXJnc3x8W107a3dhcmdzPWt3YXJnc3x8e307aWYoIV8uaXNBcnJheShhcmdzKSl7a3dhcmdzPWFyZ3M7YXJncz1bXTt9CnB5VXRpbHMuZW5zdXJlX2V2YWx1YXRlZChhcmdzLGt3YXJncyk7dmFyIGNhbGxfa3c9Jy93ZWIvZGF0YXNldC9jYWxsX2t3LycrdGhpcy5uYW1lKycvJyttZXRob2Q7cmV0dXJuIHNlc3Npb24ucnBjKGNhbGxfa3cse21vZGVsOnRoaXMubmFtZSxtZXRob2Q6bWV0aG9kLGFyZ3M6YXJncyxrd2FyZ3M6a3dhcmdzfSxvcHRpb25zKTt9LGNhbGxfYnV0dG9uOmZ1bmN0aW9uKG1ldGhvZCxhcmdzKXtweVV0aWxzLmVuc3VyZV9ldmFsdWF0ZWQoYXJncyx7fSk7dmFyIGNvbnRleHQ9KGFyZ3N8fFtdKS5sZW5ndGg+MD9hcmdzLnBvcCgpOnt9O3JldHVybiBzZXNzaW9uLnJwYygnL3dlYi9kYXRhc2V0L2NhbGxfYnV0dG9uJyx7bW9kZWw6dGhpcy5uYW1lLG1ldGhvZDptZXRob2QsYXJnczphcmdzfHxbXSxrd2FyZ3M6e2NvbnRleHQ6Y29udGV4dH0sfSk7fSx9KTtyZXR1cm4gZGF0YTt9KTs7CgovKiAvd2ViL3N0YXRpYy9zcmMvanMvY29yZS9jb250ZXh0LmpzIGRlZmluZWQgaW4gYnVuZGxlICd3ZWIuYXNzZXRzX2JhY2tlbmQnICovCm9kb28uZGVmaW5lKCd3ZWIuQ29udGV4dCcsZnVuY3Rpb24ocmVxdWlyZSl7InVzZSBzdHJpY3QiO3ZhciBDbGFzcz1yZXF1aXJlKCd3ZWIuQ2xhc3MnKTt2YXIgcHlVdGlscz1yZXF1aXJlKCd3ZWIucHlfdXRpbHMnKTt2YXIgQ29udGV4dD1DbGFzcy5leHRlbmQoe2luaXQ6ZnVuY3Rpb24oKXt0aGlzLl9fcmVmPSJjb21wb3VuZF9jb250ZXh0Ijt0aGlzLl9fY29udGV4dHM9W107dGhpcy5fX2V2YWxfY29udGV4dD1udWxsO3ZhciBzZWxmPXRoaXM7Xy5lYWNoKGFyZ3VtZW50cyxmdW5jdGlvbih4KXtzZWxmLmFkZCh4KTt9KTt9LGFkZDpmdW5jdGlvbihjb250ZXh0KXt0aGlzLl9fY29udGV4dHMucHVzaChjb250ZXh0KTtyZXR1cm4gdGhpczt9LGV2YWw6ZnVuY3Rpb24oKXtyZXR1cm4gcHlVdGlscy5ldmFsKCdjb250ZXh0Jyx0aGlzKTt9LHNldF9ldmFsX2NvbnRleHQ6ZnVuY3Rpb24oZXZhbENvbnRleHQpe2Zvcih2YXIga2V5IGluIGV2YWxDb250ZXh0KXtpZihldmFsQ29udGV4dFtrZXldaW5zdGFuY2VvZiBtb21lbnQpe2V2YWxDb250ZXh0W2tleV09ZXZhbENvbnRleHRba2V5XS50b0pTT04oKTt9fQp0aGlzLl9fZXZhbF9jb250ZXh0PWV2YWxDb250ZXh0O3JldHVybiB0aGlzO30sfSk7cmV0dXJuIENvbnRleHQ7fSk7OwoKLyogL3dlYi9zdGF0aWMvc3JjL2pzL2NvcmUvZGF0YV9jb21wYXJpc29uX3V0aWxzLmpzIGRlZmluZWQgaW4gYnVuZGxlICd3ZWIuYXNzZXRzX2JhY2tlbmQnICovCm9kb28uZGVmaW5lKCd3ZWIuZGF0YUNvbXBhcmlzb25VdGlscycsZnVuY3Rpb24ocmVxdWlyZSl7InVzZSBzdHJpY3QiO3ZhciBmaWVsZFV0aWxzPXJlcXVpcmUoJ3dlYi5maWVsZF91dGlscycpO3ZhciBDbGFzcz1yZXF1aXJlKCd3ZWIuQ2xhc3MnKTt2YXIgRGF0ZUNsYXNzZXM9Q2xhc3MuZXh0ZW5kKHtpbml0OmZ1bmN0aW9uKGRhdGVTZXRzKXt0aGlzLmRhdGVTZXRzPWRhdGVTZXRzO3RoaXMucmVmZXJlbmNlSW5kZXg9bnVsbDtmb3IodmFyIGk9MDtpPGRhdGVTZXRzLmxlbmd0aDtpKyspe3ZhciBkYXRlU2V0PWRhdGVTZXRzW2ldO2lmKGRhdGVTZXQubGVuZ3RoJiZ0aGlzLnJlZmVyZW5jZUluZGV4PT09bnVsbCl7dGhpcy5yZWZlcmVuY2VJbmRleD1pO319fSxkYXRlQ2xhc3M6ZnVuY3Rpb24oZGF0ZXNldEluZGV4LGRhdGUpe3JldHVybiB0aGlzLmRhdGVTZXRzW2RhdGVzZXRJbmRleF0uaW5kZXhPZihkYXRlKTt9LGRhdGVDbGFzc01lbWJlcnM6ZnVuY3Rpb24oZGF0ZUNsYXNzKXtyZXR1cm4gXy51bmlxKF8uY29tcGFjdCh0aGlzLmRhdGVTZXRzLm1hcChmdW5jdGlvbihkYXRlU2V0KXtyZXR1cm4gZGF0ZVNldFtkYXRlQ2xhc3NdO30pKSk7fSxyZXByZXNlbnRhdGl2ZTpmdW5jdGlvbihkYXRlQ2xhc3MsaW5kZXgpe2luZGV4PWluZGV4PT09dW5kZWZpbmVkP3RoaXMucmVmZXJlbmNlSW5kZXg6aW5kZXg7cmV0dXJuIHRoaXMuZGF0ZVNldHNbaW5kZXhdW2RhdGVDbGFzc107fSx9KTtmdW5jdGlvbiBjb21wdXRlVmFyaWF0aW9uKHZhbHVlLGNvbXBhcmlzb25WYWx1ZSl7aWYoaXNOYU4odmFsdWUpfHxpc05hTihjb21wYXJpc29uVmFsdWUpKXtyZXR1cm4gTmFOO30KaWYoY29tcGFyaXNvblZhbHVlPT09MCl7aWYodmFsdWU9PT0wKXtyZXR1cm4gMDt9ZWxzZSBpZih2YWx1ZT4wKXtyZXR1cm4gMTt9ZWxzZXtyZXR1cm4tMTt9fQpyZXR1cm4odmFsdWUtY29tcGFyaXNvblZhbHVlKS9NYXRoLmFicyhjb21wYXJpc29uVmFsdWUpO30KZnVuY3Rpb24gcmVuZGVyVmFyaWF0aW9uKHZhcmlhdGlvbixmaWVsZCxvcHRpb25zKXt2YXIgY2xhc3NOYW1lPSdvX3ZhcmlhdGlvbic7dmFyIHZhbHVlO2lmKCFpc05hTih2YXJpYXRpb24pKXtpZih2YXJpYXRpb24+MCl7Y2xhc3NOYW1lKz0nIG9fcG9zaXRpdmUnO31lbHNlIGlmKHZhcmlhdGlvbjwwKXtjbGFzc05hbWUrPScgb19uZWdhdGl2ZSc7fWVsc2V7Y2xhc3NOYW1lKz0nIG9fbnVsbCc7fQp2YWx1ZT1maWVsZFV0aWxzLmZvcm1hdC5wZXJjZW50YWdlKHZhcmlhdGlvbixmaWVsZCxvcHRpb25zKTt9ZWxzZXt2YWx1ZT0nLSc7fQpyZXR1cm4gJCgnPGRpdj4nLHtjbGFzczpjbGFzc05hbWUsaHRtbDp2YWx1ZX0pO30KZnVuY3Rpb24gcmVuZGVyQ29tcGFyaXNvbigkbm9kZSx2YWx1ZSxjb21wYXJpc29uVmFsdWUsdmFyaWF0aW9uLGZvcm1hdHRlcixmaWVsZCxvcHRpb25zKXt2YXIgJHZhcmlhdGlvbj1yZW5kZXJWYXJpYXRpb24odmFyaWF0aW9uLGZpZWxkLG9wdGlvbnMpOyRub2RlLmFwcGVuZCgkdmFyaWF0aW9uKTtpZighaXNOYU4odmFyaWF0aW9uKSl7JG5vZGUuYXBwZW5kKCQoJzxkaXY+Jyx7Y2xhc3M6J29fY29tcGFyaXNvbid9KS5odG1sKGZvcm1hdHRlcih2YWx1ZSxmaWVsZCxvcHRpb25zKSsnIDxzcGFuPnZzPC9zcGFuPiAnK2Zvcm1hdHRlcihjb21wYXJpc29uVmFsdWUsZmllbGQsb3B0aW9ucykpKTt9fQpyZXR1cm57Y29tcHV0ZVZhcmlhdGlvbjpjb21wdXRlVmFyaWF0aW9uLERhdGVDbGFzc2VzOkRhdGVDbGFzc2VzLHJlbmRlckNvbXBhcmlzb246cmVuZGVyQ29tcGFyaXNvbixyZW5kZXJWYXJpYXRpb246cmVuZGVyVmFyaWF0aW9uLH07fSk7OwoKLyogL3dlYi9zdGF0aWMvc3JjL2pzL2NvcmUvbWF0aF91dGlscy5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwpvZG9vLmRlZmluZSgnd2ViLm1hdGhVdGlscycsZnVuY3Rpb24oKXsidXNlIHN0cmljdCI7ZnVuY3Rpb24gX2NhcnRlc2lhbigpe3ZhciBhcmdzPUFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cyk7aWYoYXJncy5sZW5ndGg9PT0wKXtyZXR1cm5bdW5kZWZpbmVkXTt9CnZhciBmaXJzdEFycmF5PWFyZ3NbMF0ubWFwKGZ1bmN0aW9uKGVsZW0pe3JldHVybltlbGVtXTt9KTtpZihhcmdzLmxlbmd0aD09PTEpe3JldHVybiBmaXJzdEFycmF5O30KdmFyIHByb2R1Y3RPZk90aGVyQXJyYXlzPV9jYXJ0ZXNpYW4uYXBwbHkobnVsbCxhcmdzLnNsaWNlKDEpKTt2YXIgcmVzdWx0PWZpcnN0QXJyYXkucmVkdWNlKGZ1bmN0aW9uKGFjYyxlbGVtKXtyZXR1cm4gYWNjLmNvbmNhdChwcm9kdWN0T2ZPdGhlckFycmF5cy5tYXAoZnVuY3Rpb24odHVwbGUpe3JldHVybiBlbGVtLmNvbmNhdCh0dXBsZSk7fSkpO30sW10pO3JldHVybiByZXN1bHQ7fQpmdW5jdGlvbiBjYXJ0ZXNpYW4oKXt2YXIgYXJncz1BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMpO2lmKGFyZ3MubGVuZ3RoPT09MCl7cmV0dXJuW3VuZGVmaW5lZF07fWVsc2UgaWYoYXJncy5sZW5ndGg9PT0xKXtyZXR1cm4gYXJnc1swXTt9ZWxzZXtyZXR1cm4gX2NhcnRlc2lhbi5hcHBseShudWxsLGFyZ3MpO319CmZ1bmN0aW9uIHNlY3Rpb25zKGFycmF5KXt2YXIgc2VjdGlvbnM9W107Zm9yKHZhciBpPTA7aTxhcnJheS5sZW5ndGgrMTtpKyspe3NlY3Rpb25zLnB1c2goYXJyYXkuc2xpY2UoMCxpKSk7fQpyZXR1cm4gc2VjdGlvbnM7fQpyZXR1cm57Y2FydGVzaWFuOmNhcnRlc2lhbixzZWN0aW9uczpzZWN0aW9ucyx9O30pOzsKCi8qIC93ZWIvc3RhdGljL3NyYy9qcy9jb3JlL21pc2MuanMgZGVmaW5lZCBpbiBidW5kbGUgJ3dlYi5hc3NldHNfYmFja2VuZCcgKi8Kb2Rvby5kZWZpbmUoJ3dlYi5mcmFtZXdvcmsnLGZ1bmN0aW9uKHJlcXVpcmUpeyJ1c2Ugc3RyaWN0Ijt2YXIgY29yZT1yZXF1aXJlKCd3ZWIuY29yZScpO3ZhciBhamF4PXJlcXVpcmUoJ3dlYi5hamF4Jyk7dmFyIFdpZGdldD1yZXF1aXJlKCd3ZWIuV2lkZ2V0Jyk7dmFyIGRpc2FibGVDcmFzaE1hbmFnZXI9cmVxdWlyZSgnd2ViLkNyYXNoTWFuYWdlcicpLmRpc2FibGU7dmFyIF90PWNvcmUuX3Q7dmFyIG1lc3NhZ2VzX2J5X3NlY29uZHM9ZnVuY3Rpb24oKXtyZXR1cm5bWzAsX3QoIkxvYWRpbmcuLi4iKV0sWzIwLF90KCJTdGlsbCBsb2FkaW5nLi4uIildLFs2MCxfdCgiU3RpbGwgbG9hZGluZy4uLjxiciAvPlBsZWFzZSBiZSBwYXRpZW50LiIpXSxbMTIwLF90KCJEb24ndCBsZWF2ZSB5ZXQsPGJyIC8+aXQncyBzdGlsbCBsb2FkaW5nLi4uIildLFszMDAsX3QoIllvdSBtYXkgbm90IGJlbGlldmUgaXQsPGJyIC8+YnV0IHRoZSBhcHBsaWNhdGlvbiBpcyBhY3R1YWxseSBsb2FkaW5nLi4uIildLFs0MjAsX3QoIlRha2UgYSBtaW51dGUgdG8gZ2V0IGEgY29mZmVlLDxiciAvPmJlY2F1c2UgaXQncyBsb2FkaW5nLi4uIildLFszNjAwLF90KCJNYXliZSB5b3Ugc2hvdWxkIGNvbnNpZGVyIHJlbG9hZGluZyB0aGUgYXBwbGljYXRpb24gYnkgcHJlc3NpbmcgRjUuLi4iKV1dO307dmFyIFRocm9iYmVyPVdpZGdldC5leHRlbmQoe3RlbXBsYXRlOiJUaHJvYmJlciIsc3RhcnQ6ZnVuY3Rpb24oKXt0aGlzLnN0YXJ0X3RpbWU9bmV3IERhdGUoKS5nZXRUaW1lKCk7dGhpcy5hY3RfbWVzc2FnZSgpO30sYWN0X21lc3NhZ2U6ZnVuY3Rpb24oKXt2YXIgc2VsZj10aGlzO3NldFRpbWVvdXQoZnVuY3Rpb24oKXtpZihzZWxmLmlzRGVzdHJveWVkKCkpCnJldHVybjt2YXIgc2Vjb25kcz0obmV3IERhdGUoKS5nZXRUaW1lKCktc2VsZi5zdGFydF90aW1lKS8xMDAwO3ZhciBtZXM7Xy5lYWNoKG1lc3NhZ2VzX2J5X3NlY29uZHMoKSxmdW5jdGlvbihlbCl7aWYoc2Vjb25kcz49ZWxbMF0pCm1lcz1lbFsxXTt9KTtzZWxmLiQoIi5vZV90aHJvYmJlcl9tZXNzYWdlIikuaHRtbChtZXMpO3NlbGYuYWN0X21lc3NhZ2UoKTt9LDEwMDApO30sfSk7aWYoJC5ibG9ja1VJKXskLmJsb2NrVUkuZGVmYXVsdHMuYmFzZVo9MTEwMDskLmJsb2NrVUkuZGVmYXVsdHMubWVzc2FnZT0nPGRpdiBjbGFzcz0ib3BlbmVycCBvZV9ibG9ja3VpX3NwaW5fY29udGFpbmVyIiBzdHlsZT0iYmFja2dyb3VuZC1jb2xvcjogdHJhbnNwYXJlbnQ7Ij4nOyQuYmxvY2tVSS5kZWZhdWx0cy5jc3MuYm9yZGVyPScwJzskLmJsb2NrVUkuZGVmYXVsdHMuY3NzWyJiYWNrZ3JvdW5kLWNvbG9yIl09Jyc7fQpmdW5jdGlvbiBibG9ja0FjY2Vzc0tleXMoKXt2YXIgZWxlbWVudFdpdGhBY2Nlc3NLZXk9W107ZWxlbWVudFdpdGhBY2Nlc3NLZXk9ZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnW2FjY2Vzc2tleV0nKTtfLmVhY2goZWxlbWVudFdpdGhBY2Nlc3NLZXksZnVuY3Rpb24oZWxlbSl7ZWxlbS5zZXRBdHRyaWJ1dGUoImRhdGEtYWNjZXNza2V5IixlbGVtLmdldEF0dHJpYnV0ZSgnYWNjZXNza2V5JykpO2VsZW0ucmVtb3ZlQXR0cmlidXRlKCdhY2Nlc3NrZXknKTt9KTt9CmZ1bmN0aW9uIHVuYmxvY2tBY2Nlc3NLZXlzKCl7dmFyIGVsZW1lbnRXaXRoRGF0YUFjY2Vzc0tleT1bXTtlbGVtZW50V2l0aERhdGFBY2Nlc3NLZXk9ZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnW2RhdGEtYWNjZXNza2V5XScpO18uZWFjaChlbGVtZW50V2l0aERhdGFBY2Nlc3NLZXksZnVuY3Rpb24oZWxlbSl7ZWxlbS5zZXRBdHRyaWJ1dGUoJ2FjY2Vzc2tleScsZWxlbS5nZXRBdHRyaWJ1dGUoJ2RhdGEtYWNjZXNza2V5JykpO2VsZW0ucmVtb3ZlQXR0cmlidXRlKCdkYXRhLWFjY2Vzc2tleScpO30pO30KdmFyIHRocm9iYmVycz1bXTtmdW5jdGlvbiBibG9ja1VJKCl7dmFyIHRtcD0kLmJsb2NrVUkuYXBwbHkoJCxhcmd1bWVudHMpO3ZhciB0aHJvYmJlcj1uZXcgVGhyb2JiZXIoKTt0aHJvYmJlcnMucHVzaCh0aHJvYmJlcik7dGhyb2JiZXIuYXBwZW5kVG8oJCgiLm9lX2Jsb2NrdWlfc3Bpbl9jb250YWluZXIiKSk7JChkb2N1bWVudC5ib2R5KS5hZGRDbGFzcygnb191aV9ibG9ja2VkJyk7YmxvY2tBY2Nlc3NLZXlzKCk7cmV0dXJuIHRtcDt9CmZ1bmN0aW9uIHVuYmxvY2tVSSgpe18uaW52b2tlKHRocm9iYmVycywnZGVzdHJveScpO3Rocm9iYmVycz1bXTskKGRvY3VtZW50LmJvZHkpLnJlbW92ZUNsYXNzKCdvX3VpX2Jsb2NrZWQnKTt1bmJsb2NrQWNjZXNzS2V5cygpO3JldHVybiAkLnVuYmxvY2tVSS5hcHBseSgkLGFyZ3VtZW50cyk7fQpmdW5jdGlvbiByZWRpcmVjdCh1cmwsd2FpdCl7ZGlzYWJsZUNyYXNoTWFuYWdlcigpO3ZhciBsb2FkPWZ1bmN0aW9uKCl7dmFyIG9sZD0iIit3aW5kb3cubG9jYXRpb247dmFyIG9sZF9ub19oYXNoPW9sZC5zcGxpdCgiIyIpWzBdO3ZhciB1cmxfbm9faGFzaD11cmwuc3BsaXQoIiMiKVswXTtsb2NhdGlvbi5hc3NpZ24odXJsKTtpZihvbGRfbm9faGFzaD09PXVybF9ub19oYXNoKXtsb2NhdGlvbi5yZWxvYWQodHJ1ZSk7fX07dmFyIHdhaXRfc2VydmVyPWZ1bmN0aW9uKCl7YWpheC5ycGMoIi93ZWIvd2ViY2xpZW50L3ZlcnNpb25faW5mbyIse30pLnRoZW4obG9hZCkuZ3VhcmRlZENhdGNoKGZ1bmN0aW9uKCl7c2V0VGltZW91dCh3YWl0X3NlcnZlciwyNTApO30pO307aWYod2FpdCl7c2V0VGltZW91dCh3YWl0X3NlcnZlciwxMDAwKTt9ZWxzZXtsb2FkKCk7fX0KZnVuY3Rpb24gUmVsb2FkKHBhcmVudCxhY3Rpb24pe3ZhciBwYXJhbXM9YWN0aW9uLnBhcmFtc3x8e307dmFyIG1lbnVfaWQ9cGFyYW1zLm1lbnVfaWR8fGZhbHNlO3ZhciBsPXdpbmRvdy5sb2NhdGlvbjt2YXIgc29iaj0kLmRlcGFyYW0obC5zZWFyY2guc3Vic3RyKDEpKTtpZihwYXJhbXMudXJsX3NlYXJjaCl7c29iaj1fLmV4dGVuZChzb2JqLHBhcmFtcy51cmxfc2VhcmNoKTt9CnZhciBzZWFyY2g9Jz8nKyQucGFyYW0oc29iaik7dmFyIGhhc2g9bC5oYXNoO2lmKG1lbnVfaWQpe2hhc2g9IiNtZW51X2lkPSIrbWVudV9pZDt9CnZhciB1cmw9bC5wcm90b2NvbCsiLy8iK2wuaG9zdCtsLnBhdGhuYW1lK3NlYXJjaCtoYXNoO2NvcmUuYnVzLnRyaWdnZXIoJ2NsZWFyX2NhY2hlJyk7cmVkaXJlY3QodXJsLHBhcmFtcy53YWl0KTt9CmNvcmUuYWN0aW9uX3JlZ2lzdHJ5LmFkZCgicmVsb2FkIixSZWxvYWQpO2Z1bmN0aW9uIEhvbWUocGFyZW50LGFjdGlvbil7dmFyIHVybD0nLycrKHdpbmRvdy5sb2NhdGlvbi5zZWFyY2h8fCcnKTtyZWRpcmVjdCh1cmwsYWN0aW9uJiZhY3Rpb24ucGFyYW1zJiZhY3Rpb24ucGFyYW1zLndhaXQpO30KY29yZS5hY3Rpb25fcmVnaXN0cnkuYWRkKCJob21lIixIb21lKTtmdW5jdGlvbiBsb2dpbigpe3JlZGlyZWN0KCcvd2ViL2xvZ2luJyk7fQpjb3JlLmFjdGlvbl9yZWdpc3RyeS5hZGQoImxvZ2luIixsb2dpbik7ZnVuY3Rpb24gbG9nb3V0KCl7cmVkaXJlY3QoJy93ZWIvc2Vzc2lvbi9sb2dvdXQnKTtyZXR1cm4gbmV3IFByb21pc2UoKTt9CmNvcmUuYWN0aW9uX3JlZ2lzdHJ5LmFkZCgibG9nb3V0Iixsb2dvdXQpO2Z1bmN0aW9uIFJlbG9hZENvbnRleHQocGFyZW50LGFjdGlvbil7YWpheC5ycGMoIi93ZWIvc2Vzc2lvbi9nZXRfc2Vzc2lvbl9pbmZvIix7fSkudGhlbihmdW5jdGlvbigpe1JlbG9hZChwYXJlbnQsYWN0aW9uKTt9KTt9CmNvcmUuYWN0aW9uX3JlZ2lzdHJ5LmFkZCgicmVsb2FkX2NvbnRleHQiLFJlbG9hZENvbnRleHQpO2lmKCFkb2N1bWVudC5jb250YWlucyl7ZG9jdW1lbnQuY29udGFpbnM9ZnVuY3Rpb24gY29udGFpbnMobm9kZSl7aWYoISgwIGluIGFyZ3VtZW50cykpe3Rocm93IG5ldyBUeXBlRXJyb3IoJzEgYXJndW1lbnQgaXMgcmVxdWlyZWQnKTt9CmRve2lmKHRoaXM9PT1ub2RlKXtyZXR1cm4gdHJ1ZTt9fXdoaWxlKG5vZGU9bm9kZSYmbm9kZS5wYXJlbnROb2RlKTtyZXR1cm4gZmFsc2U7fTt9CnJldHVybntibG9ja1VJOmJsb2NrVUksdW5ibG9ja1VJOnVuYmxvY2tVSSxyZWRpcmVjdDpyZWRpcmVjdCx9O30pOzsKCi8qIC93ZWIvc3RhdGljL3NyYy9qcy9zZXJ2aWNlcy9jcmFzaF9tYW5hZ2VyX3NlcnZpY2UuanMgZGVmaW5lZCBpbiBidW5kbGUgJ3dlYi5hc3NldHNfYmFja2VuZCcgKi8Kb2Rvby5kZWZpbmUoJ2NyYXNoX21hbmFnZXIuc2VydmljZScsZnVuY3Rpb24ocmVxdWlyZSl7J3VzZSBzdHJpY3QnO2NvbnN0IGNvcmU9cmVxdWlyZSgnd2ViLmNvcmUnKTtjb25zdCBDcmFzaE1hbmFnZXI9cmVxdWlyZSgnd2ViLkNyYXNoTWFuYWdlcicpLkNyYXNoTWFuYWdlcjtjb3JlLnNlcnZpY2VSZWdpc3RyeS5hZGQoJ2NyYXNoX21hbmFnZXInLENyYXNoTWFuYWdlcik7fSk7OwoKLyogL3dlYi9zdGF0aWMvc3JjL2pzL3NlcnZpY2VzL2RhdGFfbWFuYWdlci5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwpvZG9vLmRlZmluZSgnd2ViLkRhdGFNYW5hZ2VyJyxmdW5jdGlvbihyZXF1aXJlKXsidXNlIHN0cmljdCI7dmFyIGNvbmZpZz1yZXF1aXJlKCd3ZWIuY29uZmlnJyk7dmFyIGNvcmU9cmVxdWlyZSgnd2ViLmNvcmUnKTt2YXIgcnBjPXJlcXVpcmUoJ3dlYi5ycGMnKTt2YXIgc2Vzc2lvbj1yZXF1aXJlKCd3ZWIuc2Vzc2lvbicpO3ZhciB1dGlscz1yZXF1aXJlKCd3ZWIudXRpbHMnKTtyZXR1cm4gY29yZS5DbGFzcy5leHRlbmQoe2luaXQ6ZnVuY3Rpb24oKXt0aGlzLl9pbml0X2NhY2hlKCk7Y29yZS5idXMub24oJ2NsZWFyX2NhY2hlJyx0aGlzLHRoaXMuaW52YWxpZGF0ZS5iaW5kKHRoaXMpKTt9LF9pbml0X2NhY2hlOmZ1bmN0aW9uKCl7dGhpcy5fY2FjaGU9e2FjdGlvbnM6e30sZmllbGRzX3ZpZXdzOnt9LGZpbHRlcnM6e30sdmlld3M6e30sfTt9LGludmFsaWRhdGU6ZnVuY3Rpb24oKXtzZXNzaW9uLmludmFsaWRhdGVDYWNoZUtleSgnbG9hZF9tZW51cycpO3RoaXMuX2luaXRfY2FjaGUoKTt9LGxvYWRfYWN0aW9uOmZ1bmN0aW9uKGFjdGlvbl9pZCxhZGRpdGlvbmFsX2NvbnRleHQpe3ZhciBzZWxmPXRoaXM7dmFyIGtleT10aGlzLl9nZW5fa2V5KGFjdGlvbl9pZCxhZGRpdGlvbmFsX2NvbnRleHR8fHt9KTtpZihjb25maWcuaXNEZWJ1ZygnYXNzZXRzJyl8fCF0aGlzLl9jYWNoZS5hY3Rpb25zW2tleV0pe3RoaXMuX2NhY2hlLmFjdGlvbnNba2V5XT1ycGMucXVlcnkoe3JvdXRlOiIvd2ViL2FjdGlvbi9sb2FkIixwYXJhbXM6e2FjdGlvbl9pZDphY3Rpb25faWQsYWRkaXRpb25hbF9jb250ZXh0OmFkZGl0aW9uYWxfY29udGV4dCx9LH0pLnRoZW4oZnVuY3Rpb24oYWN0aW9uKXtzZWxmLl9jYWNoZS5hY3Rpb25zW2tleV09YWN0aW9uLm5vX2NhY2hlP251bGw6c2VsZi5fY2FjaGUuYWN0aW9uc1trZXldO3JldHVybiBhY3Rpb247fSx0aGlzLl9pbnZhbGlkYXRlLmJpbmQodGhpcyx0aGlzLl9jYWNoZS5hY3Rpb25zLGtleSkpO30KcmV0dXJuIHRoaXMuX2NhY2hlLmFjdGlvbnNba2V5XS50aGVuKGZ1bmN0aW9uKGFjdGlvbil7cmV0dXJuICQuZXh0ZW5kKHRydWUse30sYWN0aW9uKTt9KTt9LGxvYWRfdmlld3M6ZnVuY3Rpb24ocGFyYW1zLG9wdGlvbnMpe3ZhciBzZWxmPXRoaXM7dmFyIG1vZGVsPXBhcmFtcy5tb2RlbDt2YXIgY29udGV4dD1wYXJhbXMuY29udGV4dDt2YXIgdmlld3NfZGVzY3I9cGFyYW1zLnZpZXdzX2Rlc2NyO3ZhciBrZXk9dGhpcy5fZ2VuX2tleShtb2RlbCx2aWV3c19kZXNjcixvcHRpb25zfHx7fSxjb250ZXh0KTtpZihjb25maWcuaXNEZWJ1ZygnYXNzZXRzJyl8fCF0aGlzLl9jYWNoZS52aWV3c1trZXldKXt2YXIgZmlsdGVyc19rZXk7aWYob3B0aW9ucy5sb2FkX2ZpbHRlcnMpe2ZpbHRlcnNfa2V5PXRoaXMuX2dlbl9rZXkobW9kZWwsb3B0aW9ucy5hY3Rpb25faWQpO29wdGlvbnMubG9hZF9maWx0ZXJzPSF0aGlzLl9jYWNoZS5maWx0ZXJzW2ZpbHRlcnNfa2V5XTt9CnRoaXMuX2NhY2hlLnZpZXdzW2tleV09cnBjLnF1ZXJ5KHthcmdzOltdLGt3YXJnczp7dmlld3M6dmlld3NfZGVzY3Isb3B0aW9uczpvcHRpb25zLGNvbnRleHQ6Y29udGV4dCx9LG1vZGVsOm1vZGVsLG1ldGhvZDonbG9hZF92aWV3cycsfSkudGhlbihmdW5jdGlvbihyZXN1bHQpe3V0aWxzLmRlZXBGcmVlemUocmVzdWx0LmZpZWxkcyk7Xy5lYWNoKHZpZXdzX2Rlc2NyLGZ1bmN0aW9uKHZpZXdfZGVzY3Ipe3ZhciB0b29sYmFyPW9wdGlvbnMudG9vbGJhciYmdmlld19kZXNjclsxXSE9PSdzZWFyY2gnO3ZhciBmdl9rZXk9c2VsZi5fZ2VuX2tleShtb2RlbCx2aWV3X2Rlc2NyWzBdLHZpZXdfZGVzY3JbMV0sdG9vbGJhcixjb250ZXh0KTt2YXIgZnZnPXJlc3VsdC5maWVsZHNfdmlld3Nbdmlld19kZXNjclsxXV07ZnZnLnZpZXdGaWVsZHM9ZnZnLmZpZWxkcztmdmcuZmllbGRzPXJlc3VsdC5maWVsZHM7c2VsZi5fY2FjaGUuZmllbGRzX3ZpZXdzW2Z2X2tleV09UHJvbWlzZS5yZXNvbHZlKGZ2Zyk7fSk7aWYocmVzdWx0LmZpbHRlcnMpe3NlbGYuX2NhY2hlLmZpbHRlcnNbZmlsdGVyc19rZXldPVByb21pc2UucmVzb2x2ZShyZXN1bHQuZmlsdGVycyk7fQpyZXR1cm4gcmVzdWx0LmZpZWxkc192aWV3czt9LHRoaXMuX2ludmFsaWRhdGUuYmluZCh0aGlzLHRoaXMuX2NhY2hlLnZpZXdzLGtleSkpO30KcmV0dXJuIHRoaXMuX2NhY2hlLnZpZXdzW2tleV07fSxsb2FkX2ZpbHRlcnM6ZnVuY3Rpb24ocGFyYW1zKXt2YXIga2V5PXRoaXMuX2dlbl9rZXkocGFyYW1zLm1vZGVsTmFtZSxwYXJhbXMuYWN0aW9uSWQpO2lmKGNvbmZpZy5pc0RlYnVnKCdhc3NldHMnKXx8IXRoaXMuX2NhY2hlLmZpbHRlcnNba2V5XSl7dGhpcy5fY2FjaGUuZmlsdGVyc1trZXldPXJwYy5xdWVyeSh7YXJnczpbcGFyYW1zLm1vZGVsTmFtZSxwYXJhbXMuYWN0aW9uSWRdLGt3YXJnczp7Y29udGV4dDpwYXJhbXMuY29udGV4dHx8e30sfSxtb2RlbDonaXIuZmlsdGVycycsbWV0aG9kOidnZXRfZmlsdGVycycsfSkuZ3VhcmRlZENhdGNoKHRoaXMuX2ludmFsaWRhdGUuYmluZCh0aGlzLHRoaXMuX2NhY2hlLmZpbHRlcnMsa2V5KSk7fQpyZXR1cm4gdGhpcy5fY2FjaGUuZmlsdGVyc1trZXldO30sY3JlYXRlX2ZpbHRlcjpmdW5jdGlvbihmaWx0ZXIpe3ZhciBzZWxmPXRoaXM7cmV0dXJuIHJwYy5xdWVyeSh7YXJnczpbZmlsdGVyXSxtb2RlbDonaXIuZmlsdGVycycsbWV0aG9kOidjcmVhdGVfb3JfcmVwbGFjZScsfSkudGhlbihmdW5jdGlvbihmaWx0ZXJJZCl7dmFyIGtleT1bZmlsdGVyLm1vZGVsX2lkLGZpbHRlci5hY3Rpb25faWR8fGZhbHNlLF0uam9pbignLCcpO3NlbGYuX2ludmFsaWRhdGUoc2VsZi5fY2FjaGUuZmlsdGVycyxrZXkpO3JldHVybiBmaWx0ZXJJZDt9KTt9LGRlbGV0ZV9maWx0ZXI6ZnVuY3Rpb24oZmlsdGVySWQpe3ZhciBzZWxmPXRoaXM7cmV0dXJuIHJwYy5xdWVyeSh7YXJnczpbZmlsdGVySWRdLG1vZGVsOidpci5maWx0ZXJzJyxtZXRob2Q6J3VubGluaycsfSkudGhlbihmdW5jdGlvbigpe3NlbGYuX2NhY2hlLmZpbHRlcnM9e307fSk7fSxfZ2VuX2tleTpmdW5jdGlvbigpe3JldHVybiBfLm1hcChBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMpLGZ1bmN0aW9uKGFyZyl7aWYoIWFyZyl7cmV0dXJuIGZhbHNlO30KcmV0dXJuIF8uaXNPYmplY3QoYXJnKT9KU09OLnN0cmluZ2lmeShhcmcpOmFyZzt9KS5qb2luKCcsJyk7fSxfaW52YWxpZGF0ZTpmdW5jdGlvbihjYWNoZSxrZXkpe2RlbGV0ZSBjYWNoZVtrZXldO30sfSk7fSk7b2Rvby5kZWZpbmUoJ3dlYi5kYXRhX21hbmFnZXInLGZ1bmN0aW9uKHJlcXVpcmUpeyJ1c2Ugc3RyaWN0Ijt2YXIgRGF0YU1hbmFnZXI9cmVxdWlyZSgnd2ViLkRhdGFNYW5hZ2VyJyk7dmFyIGRhdGFfbWFuYWdlcj1uZXcgRGF0YU1hbmFnZXIoKTtyZXR1cm4gZGF0YV9tYW5hZ2VyO30pOzsKCi8qIC93ZWIvc3RhdGljL3NyYy9qcy9zZXJ2aWNlcy9yZXBvcnRfc2VydmljZS5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwpvZG9vLmRlZmluZSgnd2ViLlJlcG9ydFNlcnZpY2UnLGZ1bmN0aW9uKHJlcXVpcmUpeyJ1c2Ugc3RyaWN0Ijt2YXIgQWJzdHJhY3RTZXJ2aWNlPXJlcXVpcmUoJ3dlYi5BYnN0cmFjdFNlcnZpY2UnKTt2YXIgY29yZT1yZXF1aXJlKCd3ZWIuY29yZScpO3ZhciBSZXBvcnRTZXJ2aWNlPUFic3RyYWN0U2VydmljZS5leHRlbmQoe2RlcGVuZGVuY2llczpbJ2FqYXgnXSxjaGVja1draHRtbHRvcGRmOmZ1bmN0aW9uKCl7aWYoIXRoaXMud2todG1sdG9wZGZTdGF0ZSl7dGhpcy53a2h0bWx0b3BkZlN0YXRlPXRoaXMuX3JwYyh7cm91dGU6Jy9yZXBvcnQvY2hlY2tfd2todG1sdG9wZGYnfSk7fQpyZXR1cm4gdGhpcy53a2h0bWx0b3BkZlN0YXRlO30sfSk7Y29yZS5zZXJ2aWNlUmVnaXN0cnkuYWRkKCdyZXBvcnQnLFJlcG9ydFNlcnZpY2UpO3JldHVybiBSZXBvcnRTZXJ2aWNlO30pOzsKCi8qIC93ZWIvc3RhdGljL3NyYy9qcy9zZXJ2aWNlcy9zZXNzaW9uLmpzIGRlZmluZWQgaW4gYnVuZGxlICd3ZWIuYXNzZXRzX2JhY2tlbmQnICovCm9kb28uZGVmaW5lKCd3ZWIuc2Vzc2lvbicsZnVuY3Rpb24ocmVxdWlyZSl7InVzZSBzdHJpY3QiO3ZhciBTZXNzaW9uPXJlcXVpcmUoJ3dlYi5TZXNzaW9uJyk7dmFyIG1vZHVsZXM9b2Rvby5fbW9kdWxlczt2YXIgc2Vzc2lvbj1uZXcgU2Vzc2lvbih1bmRlZmluZWQsdW5kZWZpbmVkLHttb2R1bGVzOm1vZHVsZXMsdXNlX2NvcnM6ZmFsc2V9KTtzZXNzaW9uLmlzX2JvdW5kPXNlc3Npb24uc2Vzc2lvbl9iaW5kKCk7cmV0dXJuIHNlc3Npb247fSk7OwoKLyogL3dlYi9zdGF0aWMvc3JjL2pzL3dpZGdldHMvYXV0b19jb21wbGV0ZS5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwpvZG9vLmRlZmluZSgnd2ViLkF1dG9Db21wbGV0ZScsZnVuY3Rpb24ocmVxdWlyZSl7InVzZSBzdHJpY3QiO3ZhciBXaWRnZXQ9cmVxdWlyZSgnd2ViLldpZGdldCcpO3JldHVybiBXaWRnZXQuZXh0ZW5kKHt0ZW1wbGF0ZToiU2VhcmNoVmlldy5hdXRvY29tcGxldGUiLGluaXQ6ZnVuY3Rpb24ocGFyZW50LG9wdGlvbnMpe3RoaXMuX3N1cGVyKHBhcmVudCk7dGhpcy4kaW5wdXQ9b3B0aW9ucy4kaW5wdXQ7dGhpcy5zb3VyY2U9b3B0aW9ucy5zb3VyY2U7dGhpcy5zZWxlY3Q9b3B0aW9ucy5zZWxlY3Q7dGhpcy5nZXRfc2VhcmNoX3N0cmluZz1vcHRpb25zLmdldF9zZWFyY2hfc3RyaW5nO3RoaXMuY3VycmVudF9yZXN1bHQ9bnVsbDt0aGlzLnNlYXJjaGluZz10cnVlO3RoaXMuc2VhcmNoX3N0cmluZz0nJzt0aGlzLmN1cnJlbnRfc2VhcmNoPW51bGw7dGhpcy5faXNJbnB1dENvbXBvc2luZz1mYWxzZTt9LHN0YXJ0OmZ1bmN0aW9uKCl7dmFyIHNlbGY9dGhpczt0aGlzLiRpbnB1dC5vbignY29tcG9zaXRpb25lbmQnLGZ1bmN0aW9uKGV2KXtzZWxmLl9pc0lucHV0Q29tcG9zaW5nPWZhbHNlO30pO3RoaXMuJGlucHV0Lm9uKCdjb21wb3NpdGlvbnN0YXJ0JyxmdW5jdGlvbihldil7c2VsZi5faXNJbnB1dENvbXBvc2luZz10cnVlO30pO3RoaXMuJGlucHV0Lm9uKCdrZXl1cCcsZnVuY3Rpb24oZXYpe2lmKGV2LndoaWNoPT09JC51aS5rZXlDb2RlLlJJR0hUJiYhc2VsZi5faXNJbnB1dENvbXBvc2luZyl7c2VsZi5zZWFyY2hpbmc9dHJ1ZTtldi5wcmV2ZW50RGVmYXVsdCgpO3JldHVybjt9CmlmKGV2LndoaWNoPT09JC51aS5rZXlDb2RlLkVOVEVSJiYhc2VsZi5faXNJbnB1dENvbXBvc2luZyl7aWYoc2VsZi5zZWFyY2hfc3RyaW5nLmxlbmd0aCl7c2VsZi5zZWxlY3RfaXRlbShldik7fQpyZXR1cm47fQp2YXIgc2VhcmNoX3N0cmluZz1zZWxmLmdldF9zZWFyY2hfc3RyaW5nKCk7aWYoc2VsZi5zZWFyY2hfc3RyaW5nIT09c2VhcmNoX3N0cmluZyl7aWYoc2VhcmNoX3N0cmluZy5sZW5ndGgpe3NlbGYuc2VhcmNoX3N0cmluZz1zZWFyY2hfc3RyaW5nO3NlbGYuaW5pdGlhdGVfc2VhcmNoKHNlYXJjaF9zdHJpbmcpO31lbHNle3NlbGYuY2xvc2UoKTt9fX0pO3RoaXMuJGlucHV0Lm9uKCdrZXlwcmVzcycsZnVuY3Rpb24oZXYpe2lmKGV2LndoaWNoPjMxJiZldi53aGljaCE9PTEyNyl7c2VsZi5zZWFyY2hfc3RyaW5nPXNlbGYuc2VhcmNoX3N0cmluZytTdHJpbmcuZnJvbUNoYXJDb2RlKGV2LndoaWNoKTt9CmlmKHNlbGYuc2VhcmNoX3N0cmluZy5sZW5ndGgpe3NlbGYuc2VhcmNoaW5nPXRydWU7dmFyIHNlYXJjaF9zdHJpbmc9c2VsZi5zZWFyY2hfc3RyaW5nO3NlbGYuaW5pdGlhdGVfc2VhcmNoKHNlYXJjaF9zdHJpbmcpO31lbHNle3NlbGYuY2xvc2UoKTt9fSk7dGhpcy4kaW5wdXQub24oJ2tleWRvd24nLGZ1bmN0aW9uKGV2KXtpZihzZWxmLl9pc0lucHV0Q29tcG9zaW5nKXtyZXR1cm47fQpzd2l0Y2goZXYud2hpY2gpe2Nhc2UgJC51aS5rZXlDb2RlLkVOVEVSOmNhc2UgJC51aS5rZXlDb2RlLlRBQjppZihzZWxmLnNlYXJjaF9zdHJpbmcubGVuZ3RoKXtzZWxmLnNlbGVjdF9pdGVtKGV2KTt9CmJyZWFrO2Nhc2UgJC51aS5rZXlDb2RlLkRPV046c2VsZi5tb3ZlKCdkb3duJyk7c2VsZi5zZWFyY2hpbmc9ZmFsc2U7ZXYucHJldmVudERlZmF1bHQoKTticmVhaztjYXNlICQudWkua2V5Q29kZS5VUDpzZWxmLm1vdmUoJ3VwJyk7c2VsZi5zZWFyY2hpbmc9ZmFsc2U7ZXYucHJldmVudERlZmF1bHQoKTticmVhaztjYXNlICQudWkua2V5Q29kZS5SSUdIVDppZihzZWxmLiRpbnB1dFswXS5zZWxlY3Rpb25TdGFydDxzZWxmLnNlYXJjaF9zdHJpbmcubGVuZ3RoKXtldi5zdG9wUHJvcGFnYXRpb24oKTtyZXR1cm47fQpzZWxmLnNlYXJjaGluZz1mYWxzZTt2YXIgY3VycmVudD1zZWxmLmN1cnJlbnRfcmVzdWx0O2lmKGN1cnJlbnQmJmN1cnJlbnQuZXhwYW5kJiYhY3VycmVudC5leHBhbmRlZCl7c2VsZi5leHBhbmQoKTtzZWxmLnNlYXJjaGluZz10cnVlO2V2LnN0b3BQcm9wYWdhdGlvbigpO30KZXYucHJldmVudERlZmF1bHQoKTticmVhaztjYXNlICQudWkua2V5Q29kZS5MRUZUOmlmKHNlbGYuJGlucHV0WzBdLnNlbGVjdGlvblN0YXJ0PjApe2V2LnN0b3BQcm9wYWdhdGlvbigpO30KYnJlYWs7Y2FzZSAkLnVpLmtleUNvZGUuRVNDQVBFOnNlbGYuY2xvc2UoKTtzZWxmLnNlYXJjaGluZz1mYWxzZTticmVhazt9fSk7fSxpbml0aWF0ZV9zZWFyY2g6ZnVuY3Rpb24ocXVlcnkpe2lmKHF1ZXJ5PT09dGhpcy5zZWFyY2hfc3RyaW5nJiZxdWVyeSE9PXRoaXMuY3VycmVudF9zZWFyY2gpe3RoaXMuc2VhcmNoKHF1ZXJ5KTt9fSxzZWFyY2g6ZnVuY3Rpb24ocXVlcnkpe3ZhciBzZWxmPXRoaXM7dGhpcy5jdXJyZW50X3NlYXJjaD1xdWVyeTt0aGlzLnNvdXJjZSh7dGVybTpxdWVyeX0sZnVuY3Rpb24ocmVzdWx0cyl7aWYocmVzdWx0cy5sZW5ndGgpe3NlbGYucmVuZGVyX3NlYXJjaF9yZXN1bHRzKHJlc3VsdHMpO3NlbGYuZm9jdXNfZWxlbWVudChzZWxmLiQoJ2xpOmZpcnN0LWNoaWxkJykpO31lbHNle3NlbGYuY2xvc2UoKTt9fSk7fSxyZW5kZXJfc2VhcmNoX3Jlc3VsdHM6ZnVuY3Rpb24ocmVzdWx0cyl7dmFyIHNlbGY9dGhpczt2YXIgJGxpc3Q9dGhpcy4kZWw7JGxpc3QuZW1wdHkoKTtyZXN1bHRzLmZvckVhY2goZnVuY3Rpb24ocmVzdWx0KXt2YXIgJGl0ZW09c2VsZi5tYWtlX2xpc3RfaXRlbShyZXN1bHQpLmFwcGVuZFRvKCRsaXN0KTtyZXN1bHQuJGVsPSRpdGVtO30pO3RoaXMuZWwub25tb3VzZW1vdmU9ZnVuY3Rpb24oZXYpe3NlbGYuJCgnbGknKS5lYWNoKGZ1bmN0aW9uKGluZGV4LGxpKXtsaS5vbm1vdXNlZW50ZXI9c2VsZi5mb2N1c19lbGVtZW50LmJpbmQoc2VsZiwkKGxpKSk7fSk7dmFyIHRhcmdldEZvY3VzPWV2LnRhcmdldC50YWdOYW1lPT09J0xJJz9ldi50YXJnZXQ6ZXYudGFyZ2V0LmNsb3Nlc3QoJ2xpJyk7c2VsZi5mb2N1c19lbGVtZW50KCQodGFyZ2V0Rm9jdXMpKTtzZWxmLmVsLm9ubW91c2Vtb3ZlPW51bGw7fTt0aGlzLnNob3coKTt9LG1ha2VfbGlzdF9pdGVtOmZ1bmN0aW9uKHJlc3VsdCl7dmFyIHNlbGY9dGhpczt2YXIgJGxpPSQoJzxsaT4nKS5tb3VzZWRvd24oZnVuY3Rpb24oZXYpe2lmKGV2LmJ1dHRvbj09PTApe3NlbGYuc2VsZWN0KGV2LHtpdGVtOntmYWNldDpyZXN1bHQuZmFjZXR9fSk7c2VsZi5jbG9zZSgpO319KS5kYXRhKCdyZXN1bHQnLHJlc3VsdCk7aWYocmVzdWx0LmV4cGFuZCl7dmFyICRleHBhbmQ9JCgnPGEgY2xhc3M9Im8tZXhwYW5kIiBocmVmPSIjIj4nKS5hcHBlbmRUbygkbGkpOyRleHBhbmQubW91c2Vkb3duKGZ1bmN0aW9uKGV2KXtldi5zdG9wUHJvcGFnYXRpb24oKTtldi5wcmV2ZW50RGVmYXVsdCgpO2lmKHJlc3VsdC5leHBhbmRlZCl7c2VsZi5mb2xkKCk7fWVsc2V7c2VsZi5leHBhbmQoKTt9fSk7JGV4cGFuZC5jbGljayhmdW5jdGlvbihldil7ZXYucHJldmVudERlZmF1bHQoKTt9KTtyZXN1bHQuZXhwYW5kZWQ9ZmFsc2U7fQppZihyZXN1bHQuaW5kZW50KSRsaS5hZGRDbGFzcygnby1pbmRlbnQnKTskbGkuYXBwZW5kKCQoJzxhIGhyZWY9IiMiPicpLmh0bWwocmVzdWx0LmxhYmVsKSk7cmV0dXJuICRsaTt9LGV4cGFuZDpmdW5jdGlvbigpe3ZhciBzZWxmPXRoaXM7dmFyIGN1cnJlbnRfcmVzdWx0PXRoaXMuY3VycmVudF9yZXN1bHQ7Y3VycmVudF9yZXN1bHQuZXhwYW5kKHRoaXMuZ2V0X3NlYXJjaF9zdHJpbmcoKSkudGhlbihmdW5jdGlvbihyZXN1bHRzKXsocmVzdWx0c3x8W3tsYWJlbDonKG5vIHJlc3VsdCknfV0pLnJldmVyc2UoKS5mb3JFYWNoKGZ1bmN0aW9uKHJlc3VsdCl7cmVzdWx0LmluZGVudD10cnVlO3ZhciAkbGk9c2VsZi5tYWtlX2xpc3RfaXRlbShyZXN1bHQpO2N1cnJlbnRfcmVzdWx0LiRlbC5hZnRlcigkbGkpO30pO3NlbGYuY3VycmVudF9yZXN1bHQuZXhwYW5kZWQ9dHJ1ZTtzZWxmLmN1cnJlbnRfcmVzdWx0LiRlbC5maW5kKCdhLm8tZXhwYW5kJykucmVtb3ZlQ2xhc3MoJ28tZXhwYW5kJykuYWRkQ2xhc3MoJ28tZXhwYW5kZWQnKTt9KTt9LGZvbGQ6ZnVuY3Rpb24oKXt2YXIgJG5leHQ9dGhpcy5jdXJyZW50X3Jlc3VsdC4kZWwubmV4dCgpO3doaWxlKCRuZXh0Lmhhc0NsYXNzKCdvLWluZGVudCcpKXskbmV4dC5yZW1vdmUoKTskbmV4dD10aGlzLmN1cnJlbnRfcmVzdWx0LiRlbC5uZXh0KCk7fQp0aGlzLmN1cnJlbnRfcmVzdWx0LmV4cGFuZGVkPWZhbHNlO3RoaXMuY3VycmVudF9yZXN1bHQuJGVsLmZpbmQoJ2Euby1leHBhbmRlZCcpLnJlbW92ZUNsYXNzKCdvLWV4cGFuZGVkJykuYWRkQ2xhc3MoJ28tZXhwYW5kJyk7fSxmb2N1c19lbGVtZW50OmZ1bmN0aW9uKCRsaSl7dGhpcy4kKCdsaScpLnJlbW92ZUNsYXNzKCdvLXNlbGVjdGlvbi1mb2N1cycpOyRsaS5hZGRDbGFzcygnby1zZWxlY3Rpb24tZm9jdXMnKTt0aGlzLmN1cnJlbnRfcmVzdWx0PSRsaS5kYXRhKCdyZXN1bHQnKTt9LHNlbGVjdF9pdGVtOmZ1bmN0aW9uKGV2KXt0aGlzLnNlbGVjdChldix7aXRlbTp7ZmFjZXQ6dGhpcy5jdXJyZW50X3Jlc3VsdC5mYWNldH19KTt0aGlzLmNsb3NlKCk7fSxzaG93OmZ1bmN0aW9uKCl7dGhpcy4kZWwuc2hvdygpO30sY2xvc2U6ZnVuY3Rpb24oKXt0aGlzLmN1cnJlbnRfc2VhcmNoPW51bGw7dGhpcy5zZWFyY2hfc3RyaW5nPScnO3RoaXMuc2VhcmNoaW5nPXRydWU7dGhpcy4kZWwuaGlkZSgpO30sbW92ZTpmdW5jdGlvbihkaXJlY3Rpb24pe3ZhciAkbmV4dDtpZihkaXJlY3Rpb249PT0nZG93bicpeyRuZXh0PXRoaXMuJCgnbGkuby1zZWxlY3Rpb24tZm9jdXMnKS5uZXh0KCk7aWYoISRuZXh0Lmxlbmd0aCkkbmV4dD10aGlzLiQoJ2xpJykuZmlyc3QoKTt9ZWxzZXskbmV4dD10aGlzLiQoJ2xpLm8tc2VsZWN0aW9uLWZvY3VzJykucHJldigpO2lmKCEkbmV4dC5sZW5ndGgpJG5leHQ9dGhpcy4kKCdsaScpLmxhc3QoKTt9CnRoaXMuZm9jdXNfZWxlbWVudCgkbmV4dCk7fSxpc19leHBhbmRhYmxlOmZ1bmN0aW9uKCl7cmV0dXJuISF0aGlzLiQoJy5vLXNlbGVjdGlvbi1mb2N1cyAuby1leHBhbmQnKS5sZW5ndGg7fSxpc19leHBhbmRlZDpmdW5jdGlvbigpe3JldHVybiB0aGlzLiRlbFswXS5zdHlsZS5kaXNwbGF5PT09ImJsb2NrIjt9fSk7fSk7OwoKLyogL3dlYi9zdGF0aWMvc3JjL2pzL3dpZGdldHMvY2hhbmdlX3Bhc3N3b3JkLmpzIGRlZmluZWQgaW4gYnVuZGxlICd3ZWIuYXNzZXRzX2JhY2tlbmQnICovCm9kb28uZGVmaW5lKCd3ZWIuQ2hhbmdlUGFzc3dvcmQnLGZ1bmN0aW9uKHJlcXVpcmUpeyJ1c2Ugc3RyaWN0Ijt2YXIgQWJzdHJhY3RBY3Rpb249cmVxdWlyZSgnd2ViLkFic3RyYWN0QWN0aW9uJyk7dmFyIGNvcmU9cmVxdWlyZSgnd2ViLmNvcmUnKTt2YXIgRGlhbG9nPXJlcXVpcmUoJ3dlYi5EaWFsb2cnKTt2YXIgd2ViX2NsaWVudD1yZXF1aXJlKCd3ZWIud2ViX2NsaWVudCcpO3ZhciBfdD1jb3JlLl90O3ZhciBDaGFuZ2VQYXNzd29yZD1BYnN0cmFjdEFjdGlvbi5leHRlbmQoe3RlbXBsYXRlOiJDaGFuZ2VQYXNzd29yZCIsc3RhcnQ6ZnVuY3Rpb24oKXt2YXIgc2VsZj10aGlzO3dlYl9jbGllbnQuc2V0X3RpdGxlKF90KCJDaGFuZ2UgUGFzc3dvcmQiKSk7dmFyICRidXR0b249c2VsZi4kKCcub2VfZm9ybV9idXR0b24nKTskYnV0dG9uLmFwcGVuZFRvKHRoaXMuZ2V0UGFyZW50KCkuJGZvb3Rlcik7JGJ1dHRvbi5lcSgxKS5jbGljayhmdW5jdGlvbigpe3NlbGYuJGVsLnBhcmVudHMoJy5tb2RhbCcpLm1vZGFsKCdoaWRlJyk7fSk7JGJ1dHRvbi5lcSgwKS5jbGljayhmdW5jdGlvbigpe3NlbGYuX3JwYyh7cm91dGU6Jy93ZWIvc2Vzc2lvbi9jaGFuZ2VfcGFzc3dvcmQnLHBhcmFtczp7ZmllbGRzOiQoJ2Zvcm1bbmFtZT1jaGFuZ2VfcGFzc3dvcmRfZm9ybV0nKS5zZXJpYWxpemVBcnJheSgpfX0pLnRoZW4oZnVuY3Rpb24ocmVzdWx0KXtpZihyZXN1bHQuZXJyb3Ipe3NlbGYuX2Rpc3BsYXlfZXJyb3IocmVzdWx0KTt9ZWxzZXtzZWxmLmRvX2FjdGlvbignbG9nb3V0Jyk7fX0pO30pO30sX2Rpc3BsYXlfZXJyb3I6ZnVuY3Rpb24oZXJyb3Ipe3JldHVybiBuZXcgRGlhbG9nKHRoaXMse3NpemU6J21lZGl1bScsdGl0bGU6ZXJyb3IudGl0bGUsJGNvbnRlbnQ6JCgnPGRpdj4nKS5odG1sKGVycm9yLmVycm9yKX0pLm9wZW4oKTt9LH0pO2NvcmUuYWN0aW9uX3JlZ2lzdHJ5LmFkZCgiY2hhbmdlX3Bhc3N3b3JkIixDaGFuZ2VQYXNzd29yZCk7cmV0dXJuIENoYW5nZVBhc3N3b3JkO30pOzsKCi8qIC93ZWIvc3RhdGljL3NyYy9qcy90b29scy90ZXN0X21lbnVzX2xvYWRlci5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwpvZG9vLmRlZmluZSgnd2ViLmNsaWNrRXZlcnl3aGVyZScsZnVuY3Rpb24ocmVxdWlyZSl7InVzZSBzdHJpY3QiO3ZhciBhamF4PXJlcXVpcmUoJ3dlYi5hamF4Jyk7ZnVuY3Rpb24gc3RhcnRDbGlja0V2ZXJ5d2hlcmUoKXthamF4LmxvYWRKUygnd2ViL3N0YXRpYy9zcmMvanMvdG9vbHMvdGVzdF9tZW51cy5qcycpLnRoZW4oZnVuY3Rpb24oKXtjbGlja0V2ZXJ5d2hlcmUoKTt9KTt9CnJldHVybiBzdGFydENsaWNrRXZlcnl3aGVyZTt9KTs7CgovKiAvd2ViL3N0YXRpYy9zcmMvanMvdG9vbHMvZGVidWdfbWFuYWdlcl9iYWNrZW5kLmpzIGRlZmluZWQgaW4gYnVuZGxlICd3ZWIuYXNzZXRzX2JhY2tlbmQnICovCm9kb28uZGVmaW5lKCd3ZWIuRGVidWdNYW5hZ2VyLkJhY2tlbmQnLGZ1bmN0aW9uKHJlcXVpcmUpeyJ1c2Ugc3RyaWN0Ijt2YXIgQWN0aW9uTWFuYWdlcj1yZXF1aXJlKCd3ZWIuQWN0aW9uTWFuYWdlcicpO3ZhciBEZWJ1Z01hbmFnZXI9cmVxdWlyZSgnd2ViLkRlYnVnTWFuYWdlcicpO3ZhciBkaWFsb2dzPXJlcXVpcmUoJ3dlYi52aWV3X2RpYWxvZ3MnKTt2YXIgc3RhcnRDbGlja0V2ZXJ5d2hlcmU9cmVxdWlyZSgnd2ViLmNsaWNrRXZlcnl3aGVyZScpO3ZhciBjb25maWc9cmVxdWlyZSgnd2ViLmNvbmZpZycpO3ZhciBjb3JlPXJlcXVpcmUoJ3dlYi5jb3JlJyk7dmFyIERpYWxvZz1yZXF1aXJlKCd3ZWIuRGlhbG9nJyk7dmFyIGZpZWxkX3V0aWxzPXJlcXVpcmUoJ3dlYi5maWVsZF91dGlscycpO3ZhciBTeXN0cmF5TWVudT1yZXF1aXJlKCd3ZWIuU3lzdHJheU1lbnUnKTt2YXIgdXRpbHM9cmVxdWlyZSgnd2ViLnV0aWxzJyk7dmFyIFdlYkNsaWVudD1yZXF1aXJlKCd3ZWIuV2ViQ2xpZW50Jyk7dmFyIFdpZGdldD1yZXF1aXJlKCd3ZWIuV2lkZ2V0Jyk7dmFyIFFXZWI9Y29yZS5xd2ViO3ZhciBfdD1jb3JlLl90O0RlYnVnTWFuYWdlci5pbmNsdWRlKHtyZXF1ZXN0c19jbGVhcjpmdW5jdGlvbigpe2lmKCF0aGlzLl9ldmVudHMpe3JldHVybjt9CnRoaXMuX2V2ZW50cz1bXTt0aGlzLnRyaWdnZXIoJ3VwZGF0ZS1zdGF0cycsdGhpcy5fZXZlbnRzKTt9LHNob3dfdGltZWxpbmVzOmZ1bmN0aW9uKCl7aWYodGhpcy5fb3ZlcmxheSl7dGhpcy5fb3ZlcmxheS5kZXN0cm95KCk7dGhpcy5fb3ZlcmxheT1udWxsO3JldHVybjt9CnRoaXMuX292ZXJsYXk9bmV3IFJlcXVlc3RzT3ZlcmxheSh0aGlzKTt0aGlzLl9vdmVybGF5LmFwcGVuZFRvKGRvY3VtZW50LmJvZHkpO30sdXBkYXRlOmZ1bmN0aW9uKHRhZyxkZXNjcmlwdG9yKXtyZXR1cm4gdGhpcy5fc3VwZXIoKS50aGVuKGZ1bmN0aW9uKCl7dGhpcy4kZHJvcGRvd24uZmluZCgiLm9fZGVidWdfc3BsaXRfYXNzZXRzIikuYmVmb3JlKFFXZWIucmVuZGVyKCdXZWJDbGllbnQuRGVidWdNYW5hZ2VyLkJhY2tlbmQnLHttYW5hZ2VyOnRoaXMsfSkpO30uYmluZCh0aGlzKSk7fSxzZWxlY3RfdmlldzpmdW5jdGlvbigpe3ZhciBzZWxmPXRoaXM7bmV3IGRpYWxvZ3MuU2VsZWN0Q3JlYXRlRGlhbG9nKHRoaXMse3Jlc19tb2RlbDonaXIudWkudmlldycsdGl0bGU6X3QoJ1NlbGVjdCBhIHZpZXcnKSxkaXNhYmxlX211bHRpcGxlX3NlbGVjdGlvbjp0cnVlLGRvbWFpbjpbWyd0eXBlJywnIT0nLCdxd2ViJ10sWyd0eXBlJywnIT0nLCdzZWFyY2gnXV0sb25fc2VsZWN0ZWQ6ZnVuY3Rpb24ocmVjb3Jkcyl7c2VsZi5fcnBjKHttb2RlbDonaXIudWkudmlldycsbWV0aG9kOidzZWFyY2hfcmVhZCcsZG9tYWluOltbJ2lkJywnPScscmVjb3Jkc1swXS5pZF1dLGZpZWxkczpbJ25hbWUnLCdtb2RlbCcsJ3R5cGUnXSxsaW1pdDoxLH0pLnRoZW4oZnVuY3Rpb24odmlld3Mpe3ZhciB2aWV3PXZpZXdzWzBdO3ZpZXcudHlwZT12aWV3LnR5cGU9PT0ndHJlZSc/J2xpc3QnOnZpZXcudHlwZTtzZWxmLmRvX2FjdGlvbih7dHlwZTonaXIuYWN0aW9ucy5hY3Rfd2luZG93JyxuYW1lOnZpZXcubmFtZSxyZXNfbW9kZWw6dmlldy5tb2RlbCx2aWV3czpbW3ZpZXcuaWQsdmlldy50eXBlXV19KTt9KTt9fSkub3BlbigpO30scGVyZm9ybV9qc190ZXN0czpmdW5jdGlvbigpe3RoaXMuZG9fYWN0aW9uKHtuYW1lOl90KCJKUyBUZXN0cyIpLHRhcmdldDonbmV3Jyx0eXBlOidpci5hY3Rpb25zLmFjdF91cmwnLHVybDonL3dlYi90ZXN0cz9tb2Q9Kid9KTt9LHBlcmZvcm1fanNfbW9iaWxlX3Rlc3RzOmZ1bmN0aW9uKCl7dGhpcy5kb19hY3Rpb24oe25hbWU6X3QoIkpTIE1vYmlsZSBUZXN0cyIpLHRhcmdldDonbmV3Jyx0eXBlOidpci5hY3Rpb25zLmFjdF91cmwnLHVybDonL3dlYi90ZXN0cy9tb2JpbGU/bW9kPSonfSk7fSxwZXJmb3JtX2NsaWNrX2V2ZXJ5d2hlcmVfdGVzdDpmdW5jdGlvbigpe3ZhciAkaG9tZU1lbnU9JCgibmF2Lm9fbWFpbl9uYXZiYXIgPiBhLm9fbWVudV90b2dnbGUuZmEtdGgiKTskaG9tZU1lbnUuY2xpY2soKTtzdGFydENsaWNrRXZlcnl3aGVyZSgpO30sfSk7RGVidWdNYW5hZ2VyLmluY2x1ZGUoe3VwZGF0ZTpmdW5jdGlvbih0YWcsZGVzY3JpcHRvcil7aWYodGFnPT09J2FjdGlvbicpe3RoaXMuX2FjdGlvbj1kZXNjcmlwdG9yO30KcmV0dXJuIHRoaXMuX3N1cGVyKCkudGhlbihmdW5jdGlvbigpe3RoaXMuJGRyb3Bkb3duLmZpbmQoIi5vX2RlYnVnX2xlYXZlX3NlY3Rpb24iKS5iZWZvcmUoUVdlYi5yZW5kZXIoJ1dlYkNsaWVudC5EZWJ1Z01hbmFnZXIuQWN0aW9uJyx7bWFuYWdlcjp0aGlzLGFjdGlvbjp0aGlzLl9hY3Rpb259KSk7fS5iaW5kKHRoaXMpKTt9LGVkaXQ6ZnVuY3Rpb24ocGFyYW1zLGV2dCl7dGhpcy5kb19hY3Rpb24oe3Jlc19tb2RlbDpwYXJhbXMubW9kZWwscmVzX2lkOnBhcmFtcy5pZCxuYW1lOmV2dC50YXJnZXQudGV4dCx0eXBlOidpci5hY3Rpb25zLmFjdF93aW5kb3cnLHZpZXdzOltbZmFsc2UsJ2Zvcm0nXV0sdmlld19tb2RlOidmb3JtJyx0YXJnZXQ6J25ldycsZmxhZ3M6e2FjdGlvbl9idXR0b25zOnRydWUsaGVhZGxlc3M6dHJ1ZX19KTt9LGdldF92aWV3X2ZpZWxkczpmdW5jdGlvbigpe3ZhciBtb2RlbD10aGlzLl9hY3Rpb24ucmVzX21vZGVsLHNlbGY9dGhpczt0aGlzLl9ycGMoe21vZGVsOidpci5tb2RlbCcsbWV0aG9kOidzZWFyY2gnLGFyZ3M6W1tbJ21vZGVsJywnPScsbW9kZWxdXV19KS50aGVuKGZ1bmN0aW9uKGlkcyl7c2VsZi5kb19hY3Rpb24oe3Jlc19tb2RlbDonaXIubW9kZWwuZmllbGRzJyxuYW1lOl90KCdWaWV3IEZpZWxkcycpLHZpZXdzOltbZmFsc2UsJ2xpc3QnXSxbZmFsc2UsJ2Zvcm0nXV0sZG9tYWluOltbJ21vZGVsX2lkJywnPScsbW9kZWxdXSx0eXBlOidpci5hY3Rpb25zLmFjdF93aW5kb3cnLGNvbnRleHQ6eydkZWZhdWx0X21vZGVsX2lkJzppZHNbMF19fSk7fSk7fSxtYW5hZ2VfZmlsdGVyczpmdW5jdGlvbigpe3RoaXMuZG9fYWN0aW9uKHtyZXNfbW9kZWw6J2lyLmZpbHRlcnMnLG5hbWU6X3QoJ01hbmFnZSBGaWx0ZXJzJyksdmlld3M6W1tmYWxzZSwnbGlzdCddLFtmYWxzZSwnZm9ybSddXSx0eXBlOidpci5hY3Rpb25zLmFjdF93aW5kb3cnLGNvbnRleHQ6e3NlYXJjaF9kZWZhdWx0X215X2ZpbHRlcnM6dHJ1ZSxzZWFyY2hfZGVmYXVsdF9tb2RlbF9pZDp0aGlzLl9hY3Rpb24ucmVzX21vZGVsfX0pO30sdHJhbnNsYXRlOmZ1bmN0aW9uKCl7dGhpcy5fcnBjKHttb2RlbDonaXIudHJhbnNsYXRpb24nLG1ldGhvZDonZ2V0X3RlY2huaWNhbF90cmFuc2xhdGlvbnMnLGFyZ3M6W3RoaXMuX2FjdGlvbi5yZXNfbW9kZWxdLH0pLnRoZW4odGhpcy5kb19hY3Rpb24pO319KTtEZWJ1Z01hbmFnZXIuaW5jbHVkZSh7c3RhcnQ6ZnVuY3Rpb24oKXt0aGlzLl9jYW5fZWRpdF92aWV3cz1mYWxzZTtyZXR1cm4gUHJvbWlzZS5hbGwoW3RoaXMuX3N1cGVyKCksdGhpcy5fcnBjKHttb2RlbDonaXIudWkudmlldycsbWV0aG9kOidjaGVja19hY2Nlc3NfcmlnaHRzJyxrd2FyZ3M6e29wZXJhdGlvbjond3JpdGUnLHJhaXNlX2V4Y2VwdGlvbjpmYWxzZX0sfSkudGhlbihmdW5jdGlvbihhcil7dGhpcy5fY2FuX2VkaXRfdmlld3M9YXI7fS5iaW5kKHRoaXMpKV0pO30sdXBkYXRlOmZ1bmN0aW9uKHRhZyxkZXNjcmlwdG9yLHdpZGdldCl7aWYodGFnPT09J2FjdGlvbid8fHRhZz09PSd2aWV3Jyl7dGhpcy5fY29udHJvbGxlcj13aWRnZXQ7fQpyZXR1cm4gdGhpcy5fc3VwZXIodGFnLGRlc2NyaXB0b3IpLnRoZW4oZnVuY3Rpb24oKXt0aGlzLiRkcm9wZG93bi5maW5kKCIub19kZWJ1Z19sZWF2ZV9zZWN0aW9uIikuYmVmb3JlKFFXZWIucmVuZGVyKCdXZWJDbGllbnQuRGVidWdNYW5hZ2VyLlZpZXcnLHthY3Rpb246dGhpcy5fYWN0aW9uLGNhbl9lZGl0OnRoaXMuX2Nhbl9lZGl0X3ZpZXdzLGNvbnRyb2xsZXI6dGhpcy5fY29udHJvbGxlcixjb250cm9sUGFuZWxWaWV3OnRoaXMuX2NvbnRyb2xsZXImJnRoaXMuX2NvbnRyb2xsZXIuX2NvbnRyb2xQYW5lbCxtYW5hZ2VyOnRoaXMsdmlldzp0aGlzLl9jb250cm9sbGVyJiZfLmZpbmRXaGVyZSh0aGlzLl9hY3Rpb24udmlld3Mse3R5cGU6dGhpcy5fY29udHJvbGxlci52aWV3VHlwZSx9KSx9KSk7fS5iaW5kKHRoaXMpKTt9LGdldF9hdHRhY2htZW50czpmdW5jdGlvbigpe3ZhciBzZWxlY3RlZElEcz10aGlzLl9jb250cm9sbGVyLmdldFNlbGVjdGVkSWRzKCk7aWYoIXNlbGVjdGVkSURzLmxlbmd0aCl7Y29uc29sZS53YXJuKF90KCJObyBhdHRhY2htZW50IGF2YWlsYWJsZSIpKTtyZXR1cm47fQp0aGlzLmRvX2FjdGlvbih7cmVzX21vZGVsOidpci5hdHRhY2htZW50JyxuYW1lOl90KCdNYW5hZ2UgQXR0YWNobWVudHMnKSx2aWV3czpbW2ZhbHNlLCdsaXN0J10sW2ZhbHNlLCdmb3JtJ11dLHR5cGU6J2lyLmFjdGlvbnMuYWN0X3dpbmRvdycsZG9tYWluOltbJ3Jlc19tb2RlbCcsJz0nLHRoaXMuX2FjdGlvbi5yZXNfbW9kZWxdLFsncmVzX2lkJywnPScsc2VsZWN0ZWRJRHNbMF1dXSxjb250ZXh0OntkZWZhdWx0X3Jlc19tb2RlbDp0aGlzLl9hY3Rpb24ucmVzX21vZGVsLGRlZmF1bHRfcmVzX2lkOnNlbGVjdGVkSURzWzBdLH0sfSk7fSxnZXRfbWV0YWRhdGE6ZnVuY3Rpb24oKXt2YXIgc2VsZj10aGlzO3ZhciBzZWxlY3RlZElEcz10aGlzLl9jb250cm9sbGVyLmdldFNlbGVjdGVkSWRzKCk7aWYoIXNlbGVjdGVkSURzLmxlbmd0aCl7Y29uc29sZS53YXJuKF90KCJObyBtZXRhZGF0YSBhdmFpbGFibGUiKSk7cmV0dXJuO30KdGhpcy5fcnBjKHttb2RlbDp0aGlzLl9hY3Rpb24ucmVzX21vZGVsLG1ldGhvZDonZ2V0X21ldGFkYXRhJyxhcmdzOltzZWxlY3RlZElEc10sfSkudGhlbihmdW5jdGlvbihyZXN1bHQpe3ZhciBtZXRhZGF0YT1yZXN1bHRbMF07bWV0YWRhdGEuY3JlYXRvcj1maWVsZF91dGlscy5mb3JtYXQubWFueTJvbmUobWV0YWRhdGEuY3JlYXRlX3VpZCk7bWV0YWRhdGEubGFzdE1vZGlmaWVkQnk9ZmllbGRfdXRpbHMuZm9ybWF0Lm1hbnkyb25lKG1ldGFkYXRhLndyaXRlX3VpZCk7dmFyIGNyZWF0ZURhdGU9ZmllbGRfdXRpbHMucGFyc2UuZGF0ZXRpbWUobWV0YWRhdGEuY3JlYXRlX2RhdGUpO21ldGFkYXRhLmNyZWF0ZV9kYXRlPWZpZWxkX3V0aWxzLmZvcm1hdC5kYXRldGltZShjcmVhdGVEYXRlKTt2YXIgbW9kaWZpY2F0aW9uRGF0ZT1maWVsZF91dGlscy5wYXJzZS5kYXRldGltZShtZXRhZGF0YS53cml0ZV9kYXRlKTttZXRhZGF0YS53cml0ZV9kYXRlPWZpZWxkX3V0aWxzLmZvcm1hdC5kYXRldGltZShtb2RpZmljYXRpb25EYXRlKTt2YXIgZGlhbG9nPW5ldyBEaWFsb2codGhpcyx7dGl0bGU6Xy5zdHIuc3ByaW50ZihfdCgiTWV0YWRhdGEgKCVzKSIpLHNlbGYuX2FjdGlvbi5yZXNfbW9kZWwpLHNpemU6J21lZGl1bScsJGNvbnRlbnQ6UVdlYi5yZW5kZXIoJ1dlYkNsaWVudC5EZWJ1Z1ZpZXdMb2cnLHtwZXJtOm1ldGFkYXRhLH0pfSk7ZGlhbG9nLm9wZW4oKS5vcGVuZWQoZnVuY3Rpb24oKXtkaWFsb2cuJGVsLm9uKCdjbGljaycsJ2FbZGF0YS1hY3Rpb249InRvZ2dsZV9ub3VwZGF0ZSJdJyxmdW5jdGlvbihldil7ZXYucHJldmVudERlZmF1bHQoKTtzZWxmLl9ycGMoe21vZGVsOidpci5tb2RlbC5kYXRhJyxtZXRob2Q6J3RvZ2dsZV9ub3VwZGF0ZScsYXJnczpbc2VsZi5fYWN0aW9uLnJlc19tb2RlbCxtZXRhZGF0YS5pZF19KS50aGVuKGZ1bmN0aW9uKHJlcyl7ZGlhbG9nLmNsb3NlKCk7c2VsZi5nZXRfbWV0YWRhdGEoKTt9KX0pO30pfSk7fSxzZXRfZGVmYXVsdHM6ZnVuY3Rpb24oKXt2YXIgc2VsZj10aGlzO3ZhciBkaXNwbGF5PWZ1bmN0aW9uKGZpZWxkSW5mbyx2YWx1ZSl7dmFyIGRpc3BsYXllZD12YWx1ZTtpZih2YWx1ZSYmZmllbGRJbmZvLnR5cGU9PT0nbWFueTJvbmUnKXtkaXNwbGF5ZWQ9dmFsdWUuZGF0YS5kaXNwbGF5X25hbWU7dmFsdWU9dmFsdWUuZGF0YS5pZDt9ZWxzZSBpZih2YWx1ZSYmZmllbGRJbmZvLnR5cGU9PT0nc2VsZWN0aW9uJyl7ZGlzcGxheWVkPV8uZmluZChmaWVsZEluZm8uc2VsZWN0aW9uLGZ1bmN0aW9uKG9wdGlvbil7cmV0dXJuIG9wdGlvblswXT09PXZhbHVlO30pWzFdO30KcmV0dXJuW3ZhbHVlLGRpc3BsYXllZF07fTt2YXIgcmVuZGVyZXI9dGhpcy5fY29udHJvbGxlci5yZW5kZXJlcjt2YXIgc3RhdGU9cmVuZGVyZXIuc3RhdGU7dmFyIGZpZWxkcz1zdGF0ZS5maWVsZHM7dmFyIGZpZWxkc0luZm89c3RhdGUuZmllbGRzSW5mby5mb3JtO3ZhciBmaWVsZE5hbWVzSW5WaWV3PXN0YXRlLmdldEZpZWxkTmFtZXMoKTt2YXIgZmllbGROYW1lc09ubHlPblZpZXc9WydtZXNzYWdlX2F0dGFjaG1lbnRfY291bnQnXTt2YXIgZmllbGRzVmFsdWVzPXN0YXRlLmRhdGE7dmFyIG1vZGlmaWVyRGF0YXM9e307Xy5lYWNoKGZpZWxkTmFtZXNJblZpZXcsZnVuY3Rpb24oZmllbGROYW1lKXttb2RpZmllckRhdGFzW2ZpZWxkTmFtZV09Xy5maW5kKHJlbmRlcmVyLmFsbE1vZGlmaWVyc0RhdGEsZnVuY3Rpb24obW9kaWZpZXJkYXRhKXtyZXR1cm4gbW9kaWZpZXJkYXRhLm5vZGUuYXR0cnMubmFtZT09PWZpZWxkTmFtZTt9KTt9KTt0aGlzLmZpZWxkcz1fLmNoYWluKGZpZWxkTmFtZXNJblZpZXcpLmRpZmZlcmVuY2UoZmllbGROYW1lc09ubHlPblZpZXcpLm1hcChmdW5jdGlvbihmaWVsZE5hbWUpe3ZhciBtb2RpZmllckRhdGE9bW9kaWZpZXJEYXRhc1tmaWVsZE5hbWVdO3ZhciBpbnZpc2libGVPclJlYWRPbmx5O2lmKG1vZGlmaWVyRGF0YSl7dmFyIGV2YWx1YXRlZE1vZGlmaWVycz1tb2RpZmllckRhdGEuZXZhbHVhdGVkTW9kaWZpZXJzW3N0YXRlLmlkXTtpbnZpc2libGVPclJlYWRPbmx5PWV2YWx1YXRlZE1vZGlmaWVycy5pbnZpc2libGV8fGV2YWx1YXRlZE1vZGlmaWVycy5yZWFkb25seTt9CnZhciBmaWVsZEluZm89ZmllbGRzW2ZpZWxkTmFtZV07dmFyIHZhbHVlRGlzcGxheWVkPWRpc3BsYXkoZmllbGRJbmZvLGZpZWxkc1ZhbHVlc1tmaWVsZE5hbWVdKTt2YXIgdmFsdWU9dmFsdWVEaXNwbGF5ZWRbMF07dmFyIGRpc3BsYXllZD12YWx1ZURpc3BsYXllZFsxXTtpZighdmFsdWV8fGludmlzaWJsZU9yUmVhZE9ubHl8fGZpZWxkSW5mby50eXBlPT09J29uZTJtYW55J3x8ZmllbGRJbmZvLnR5cGU9PT0nbWFueTJtYW55J3x8ZmllbGRJbmZvLnR5cGU9PT0nYmluYXJ5J3x8ZmllbGRzSW5mb1tmaWVsZE5hbWVdLm9wdGlvbnMuaXNQYXNzd29yZHx8IV8uaXNFbXB0eShmaWVsZEluZm8uZGVwZW5kcykpe3JldHVybiBmYWxzZTt9CnJldHVybntuYW1lOmZpZWxkTmFtZSxzdHJpbmc6ZmllbGRJbmZvLnN0cmluZyx2YWx1ZTp2YWx1ZSxkaXNwbGF5ZWQ6ZGlzcGxheWVkLH07fSkuY29tcGFjdCgpLnNvcnRCeShmdW5jdGlvbihmaWVsZCl7cmV0dXJuIGZpZWxkLnN0cmluZzt9KS52YWx1ZSgpO3ZhciBjb25kaXRpb25zPV8uY2hhaW4oZmllbGROYW1lc0luVmlldykuZmlsdGVyKGZ1bmN0aW9uKGZpZWxkTmFtZSl7dmFyIGZpZWxkSW5mbz1maWVsZHNbZmllbGROYW1lXTtyZXR1cm4gZmllbGRJbmZvLmNoYW5nZV9kZWZhdWx0O30pLm1hcChmdW5jdGlvbihmaWVsZE5hbWUpe3ZhciBmaWVsZEluZm89ZmllbGRzW2ZpZWxkTmFtZV07dmFyIHZhbHVlRGlzcGxheWVkPWRpc3BsYXkoZmllbGRJbmZvLGZpZWxkc1ZhbHVlc1tmaWVsZE5hbWVdKTt2YXIgdmFsdWU9dmFsdWVEaXNwbGF5ZWRbMF07dmFyIGRpc3BsYXllZD12YWx1ZURpc3BsYXllZFsxXTtyZXR1cm57bmFtZTpmaWVsZE5hbWUsc3RyaW5nOmZpZWxkSW5mby5zdHJpbmcsdmFsdWU6dmFsdWUsZGlzcGxheWVkOmRpc3BsYXllZCx9O30pLnZhbHVlKCk7dmFyIGQ9bmV3IERpYWxvZyh0aGlzLHt0aXRsZTpfdCgiU2V0IERlZmF1bHQiKSxidXR0b25zOlt7dGV4dDpfdCgiQ2xvc2UiKSxjbG9zZTp0cnVlfSx7dGV4dDpfdCgiU2F2ZSBkZWZhdWx0IiksY2xpY2s6ZnVuY3Rpb24oKXt2YXIgJGRlZmF1bHRzPWQuJGVsLmZpbmQoJyNmb3Jtdmlld19kZWZhdWx0X2ZpZWxkcycpO3ZhciBmaWVsZFRvU2V0PSRkZWZhdWx0cy52YWwoKTtpZighZmllbGRUb1NldCl7JGRlZmF1bHRzLnBhcmVudCgpLmFkZENsYXNzKCdvX2Zvcm1faW52YWxpZCcpO3JldHVybjt9CnZhciBzZWxmVXNlcj1kLiRlbC5maW5kKCcjZm9ybXZpZXdfZGVmYXVsdF9zZWxmJykuaXMoJzpjaGVja2VkJyk7dmFyIGNvbmRpdGlvbj1kLiRlbC5maW5kKCcjZm9ybXZpZXdfZGVmYXVsdF9jb25kaXRpb25zJykudmFsKCk7dmFyIHZhbHVlPV8uZmluZChzZWxmLmZpZWxkcyxmdW5jdGlvbihmaWVsZCl7cmV0dXJuIGZpZWxkLm5hbWU9PT1maWVsZFRvU2V0O30pLnZhbHVlO3NlbGYuX3JwYyh7bW9kZWw6J2lyLmRlZmF1bHQnLG1ldGhvZDonc2V0JyxhcmdzOltzZWxmLl9hY3Rpb24ucmVzX21vZGVsLGZpZWxkVG9TZXQsdmFsdWUsc2VsZlVzZXIsdHJ1ZSxjb25kaXRpb258fGZhbHNlLF0sfSkudGhlbihmdW5jdGlvbigpe2QuY2xvc2UoKTt9KTt9fV19KTtkLmFyZ3M9e2ZpZWxkczp0aGlzLmZpZWxkcyxjb25kaXRpb25zOmNvbmRpdGlvbnMsfTtkLnRlbXBsYXRlPSdGb3JtVmlldy5zZXRfZGVmYXVsdCc7ZC5vcGVuKCk7fSxmdmc6ZnVuY3Rpb24oKXt2YXIgc2VsZj10aGlzO3ZhciBkaWFsb2c9bmV3IERpYWxvZyh0aGlzLHt0aXRsZTpfdCgiRmllbGRzIFZpZXcgR2V0Iil9KTtkaWFsb2cub3BlbmVkKCkudGhlbihmdW5jdGlvbigpeyQoJzxwcmU+JykudGV4dCh1dGlscy5qc29uX25vZGVfdG9feG1sKHNlbGYuX2NvbnRyb2xsZXIucmVuZGVyZXIuYXJjaCx0cnVlKSkuYXBwZW5kVG8oZGlhbG9nLiRlbCk7fSk7ZGlhbG9nLm9wZW4oKTt9LH0pO2Z1bmN0aW9uIG1ha2VfY29udGV4dCh3aWR0aCxoZWlnaHQsZm4pe3ZhciBjYW52YXM9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7Y2FudmFzLndpZHRoPXdpZHRoO2NhbnZhcy5oZWlnaHQ9aGVpZ2h0O2NhbnZhcy5zdHlsZS5wb3NpdGlvbj0ncmVsYXRpdmUnO3ZhciBjdHg9Y2FudmFzLmdldENvbnRleHQoJzJkJyk7Y3R4LmltYWdlU21vb3RoaW5nRW5hYmxlZD1mYWxzZTtjdHgubW96SW1hZ2VTbW9vdGhpbmdFbmFibGVkPWZhbHNlO2N0eC5vSW1hZ2VTbW9vdGhpbmdFbmFibGVkPWZhbHNlO2N0eC53ZWJraXRJbWFnZVNtb290aGluZ0VuYWJsZWQ9ZmFsc2U7Zm4mJmZuKGN0eCk7cmV0dXJuIGN0eDt9CnZhciBSZXF1ZXN0c092ZXJsYXk9V2lkZ2V0LmV4dGVuZCh7dGVtcGxhdGU6J1dlYkNsaWVudC5EZWJ1Z01hbmFnZXIuUmVxdWVzdHNPdmVybGF5JyxUUkFDS1M6OCxUUkFDS19XSURUSDo5LGV2ZW50czp7bW91c2Vtb3ZlOmZ1bmN0aW9uKGUpe3RoaXMuJHRvb2x0aXAuaGlkZSgpO319LGluaXQ6ZnVuY3Rpb24oKXt0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy5fcmVuZGVyPV8udGhyb3R0bGUodGhpcy5fcmVuZGVyLmJpbmQodGhpcyksMTAwMC8xNSx7bGVhZGluZzpmYWxzZX0pO30sc3RhcnQ6ZnVuY3Rpb24oKXt2YXIgX3N1cGVyPXRoaXMuX3N1cGVyKCk7dGhpcy4kdG9vbHRpcD10aGlzLiQoJ2Rpdi5vX2RlYnVnX3Rvb2x0aXAnKTt0aGlzLmdldFBhcmVudCgpLm9uKCd1cGRhdGUtc3RhdHMnLHRoaXMsdGhpcy5fcmVuZGVyKTt0aGlzLl9yZW5kZXIoKTtyZXR1cm4gX3N1cGVyO30sdG9vbHRpcDpmdW5jdGlvbih0ZXh0LHN0YXJ0LGVuZCx4LHkpe3ZhciB0b3A9eS10aGlzLmVsLm9mZnNldFRvcCt0aGlzLmVsLnNjcm9sbFRvcCsxO3ZhciBsZWZ0PXgtdGhpcy5lbC5vZmZzZXRMZWZ0K3RoaXMuZWwuc2Nyb2xsTGVmdCsxO3RoaXMuJHRvb2x0aXAuY3NzKHt0b3A6dG9wLGxlZnQ6bGVmdH0pLnNob3coKVswXS5pbm5lckhUTUw9Wyc8cD4nLHRleHQsJyAoJywoZW5kLXN0YXJ0KSwnbXMpJywnPC9wPiddLmpvaW4oJycpO30sX3JlbmRlcjpmdW5jdGlvbigpe3ZhciAkc3VtbWFyeT10aGlzLiQoJ2hlYWRlcicpLHc9JHN1bW1hcnlbMF0uY2xpZW50V2lkdGgsJHJlcXVlc3RzPXRoaXMuJCgnLm9fZGVidWdfcmVxdWVzdHMnKTskc3VtbWFyeS5maW5kKCdjYW52YXMnKS5hdHRyKCd3aWR0aCcsdyk7dmFyIHRyYWNrcz1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb19kZWJ1Z19yZXF1ZXN0c19zdW1tYXJ5Jyk7Xy5pbnZva2UodGhpcy5nZXRDaGlsZHJlbigpLCdkZXN0cm95Jyk7dmFyIHJlcXVlc3RzPXRoaXMuZ2V0UGFyZW50KCkuX2V2ZW50czt2YXIgYm91bmRzPXRoaXMuX2dldF9ib3VuZHMocmVxdWVzdHMpO3ZhciBzY2FsZT13Lyhib3VuZHMuaGlnaC1ib3VuZHMubG93KTt2YXIgdHJhY2tfZW5kcz1fKHRoaXMuVFJBQ0tTKS50aW1lcyhfLmNvbnN0YW50KC1JbmZpbml0eSkpO3ZhciBjdHg9dHJhY2tzLmdldENvbnRleHQoJzJkJyk7Y3R4LmxpbmVXaWR0aD10aGlzLlRSQUNLX1dJRFRIO2Zvcih2YXIgaT0wO2k8cmVxdWVzdHMubGVuZ3RoO2krKyl7dmFyIHJlcXVlc3Q9cmVxdWVzdHNbaV07dmFyIHJzdGFydD1NYXRoLmZsb29yKHJlcXVlc3RbMF1bM10qMWUzKTt2YXIgcmVuZD1NYXRoLmNlaWwocmVxdWVzdFtyZXF1ZXN0Lmxlbmd0aC0xXVszXSoxZTMpO2Zvcih2YXIgdHJhY2s9MDt0cmFjazx0cmFja19lbmRzLmxlbmd0aDsrK3RyYWNrKXtpZih0cmFja19lbmRzW3RyYWNrXTxyc3RhcnQpe2JyZWFrO319CmlmKHRyYWNrPj10cmFja19lbmRzLmxlbmd0aCl7Y29uc29sZS53YXJuKCJjb3VsZCBub3QgZmluZCBhbiBlbXB0eSBzdW1tYXJ5IHRyYWNrIik7Y29udGludWU7fQp0cmFja19lbmRzW3RyYWNrXT1yZW5kO2N0eC5zYXZlKCk7Y3R4LnRyYW5zbGF0ZShNYXRoLmZsb29yKChyc3RhcnQtYm91bmRzLmxvdykqc2NhbGUpLHRyYWNrKih0aGlzLlRSQUNLX1dJRFRIKzEpKTt0aGlzLl9kcmF3X3JlcXVlc3QocmVxdWVzdCxjdHgsMCxzY2FsZSk7Y3R4LnJlc3RvcmUoKTtuZXcgUmVxdWVzdERldGFpbHModGhpcyxyZXF1ZXN0LHNjYWxlKS5hcHBlbmRUbygkcmVxdWVzdHMpO319LF9kcmF3X3JlcXVlc3Q6ZnVuY3Rpb24ocmVxdWVzdCx0b19jb250ZXh0LHN0ZXAsaHNjYWxlLGhhbmRsZV9ldmVudCl7dmFyIHN1cmZhY2VzPXtyZXF1ZXN0Om1ha2VfY29udGV4dCh0b19jb250ZXh0LmNhbnZhcy53aWR0aCx0b19jb250ZXh0LmNhbnZhcy5oZWlnaHQsZnVuY3Rpb24oY3R4KXtjdHguc3Ryb2tlU3R5bGU9J2JsdWUnO2N0eC5maWxsU3R5bGU9JyM4OGYnO2N0eC5saW5lSm9pbj0ncm91bmQnO2N0eC5saW5lV2lkdGg9MTt9KSxzcWw6bWFrZV9jb250ZXh0KHRvX2NvbnRleHQuY2FudmFzLndpZHRoLHRvX2NvbnRleHQuY2FudmFzLmhlaWdodCxmdW5jdGlvbihjdHgpe2N0eC5zdHJva2VTdHlsZT0ncmVkJztjdHguZmlsbFN0eWxlPScjZjg4JztjdHgubGluZUpvaW49J3JvdW5kJztjdHgubGluZVdpZHRoPTE7fSksdGVtcGxhdGU6bWFrZV9jb250ZXh0KHRvX2NvbnRleHQuY2FudmFzLndpZHRoLHRvX2NvbnRleHQuY2FudmFzLmhlaWdodCxmdW5jdGlvbihjdHgpe2N0eC5zdHJva2VTdHlsZT0nZ3JlZW4nO2N0eC5maWxsU3R5bGU9JyM4ZjgnO2N0eC5saW5lSm9pbj0ncm91bmQnO2N0eC5saW5lV2lkdGg9MTt9KX07dmFyIHN0YWNrcz17fSxzdGFydD1NYXRoLmZsb29yKHJlcXVlc3RbMF1bM10qMWUzKmhzY2FsZSk7dmFyIGV2ZW50X2lkeD0wO3ZhciByZWN0X3dpZHRoPXRvX2NvbnRleHQubGluZVdpZHRoO2Zvcih2YXIgaT0wO2k8cmVxdWVzdC5sZW5ndGg7aSsrKXt2YXIgdHlwZSxtLGV2ZW50PXJlcXVlc3RbaV07dmFyIHRhZz1ldmVudFswXSx0aW1lc3RhbXA9TWF0aC5mbG9vcihldmVudFszXSoxZTMqaHNjYWxlKS1zdGFydDtpZihtPS8oXHcrKS1zdGFydC8uZXhlYyh0YWcpKXt0eXBlPW1bMV07aWYoISh0eXBlIGluIHN0YWNrcykpe3N0YWNrc1t0eXBlXT1bXTt9CmhhbmRsZV9ldmVudCYmaGFuZGxlX2V2ZW50KGV2ZW50X2lkeCx0aW1lc3RhbXAsZXZlbnQpO3N0YWNrc1t0eXBlXS5wdXNoKHt0aW1lc3RhbXA6dGltZXN0YW1wLGlkeDpldmVudF9pZHgrK30pO31lbHNlIGlmKG09LyhcdyspLWVuZC8uZXhlYyh0YWcpKXt0eXBlPW1bMV07dmFyIHN0YWNrPXN0YWNrc1t0eXBlXTt2YXIgZXN0YXJ0PXN0YWNrLnBvcCgpLGR1cmF0aW9uPU1hdGguY2VpbCh0aW1lc3RhbXAtZXN0YXJ0LnRpbWVzdGFtcCk7aGFuZGxlX2V2ZW50JiZoYW5kbGVfZXZlbnQoZXN0YXJ0LmlkeCx0aW1lc3RhbXAsZXZlbnQpO3ZhciBzdXJmYWNlPXN1cmZhY2VzW3R5cGVdO2lmKCFzdXJmYWNlKXtjb250aW51ZTt9CnZhciB5PXN0ZXAqZXN0YXJ0LmlkeDtzdXJmYWNlLnJlY3QoZXN0YXJ0LnRpbWVzdGFtcCswLjUseSswLjUsZHVyYXRpb258fDEscmVjdF93aWR0aCk7fX0KdmFyIGtleXM9WydyZXF1ZXN0JywndGVtcGxhdGUnLCdzcWwnXTtmb3IodmFyIGo9MDtqPGtleXMubGVuZ3RoOysrail7dmFyIGN0eD1zdXJmYWNlc1trZXlzW2pdXTtjdHguZmlsbCgpO2N0eC5zdHJva2UoKTt0b19jb250ZXh0LmRyYXdJbWFnZShjdHguY2FudmFzLDAsMCk7fX0sX2dldF9ib3VuZHM6ZnVuY3Rpb24ocmVxdWVzdHMpe3ZhciBsb3c9K0luZmluaXR5O3ZhciBoaWdoPS0rSW5maW5pdHk7Zm9yKHZhciBpPTA7aTxyZXF1ZXN0cy5sZW5ndGg7aSsrKXt2YXIgcmVxdWVzdD1yZXF1ZXN0c1tpXTtmb3IodmFyIGo9MDtqPHJlcXVlc3QubGVuZ3RoO2orKyl7dmFyIGV2ZW50PXJlcXVlc3Rbal07dmFyIHRpbWVzdGFtcD1ldmVudFszXTtsb3c9TWF0aC5taW4obG93LHRpbWVzdGFtcCk7aGlnaD1NYXRoLm1heChoaWdoLHRpbWVzdGFtcCk7fX0KcmV0dXJue2xvdzpNYXRoLmZsb29yKGxvdyoxZTMpLGhpZ2g6TWF0aC5jZWlsKGhpZ2gqMWUzKX07fX0pO3ZhciBSZXF1ZXN0RGV0YWlscz1XaWRnZXQuZXh0ZW5kKHtldmVudHM6e2NsaWNrOmZ1bmN0aW9uKCl7dGhpcy5fb3Blbj0hdGhpcy5fb3Blbjt0aGlzLnJlbmRlcigpO30sJ21vdXNlbW92ZSBjYW52YXMnOmZ1bmN0aW9uKGUpe2Uuc3RvcFByb3BhZ2F0aW9uKCk7dmFyIHk9ZS55fHxlLm9mZnNldFl8fGUubGF5ZXJZO2lmKCF5KXtyZXR1cm47fQp2YXIgZXZlbnQ9dGhpcy5fcGF5bG9hZHNbTWF0aC5mbG9vcih5L3RoaXMuX1JFUV9IRUlHSFQpXTtpZighZXZlbnQpe3JldHVybjt9CnRoaXMuZ2V0UGFyZW50KCkudG9vbHRpcChldmVudC5wYXlsb2FkLGV2ZW50LnN0YXJ0LGV2ZW50LnN0b3AsZS5jbGllbnRYLGUuY2xpZW50WSk7fX0saW5pdDpmdW5jdGlvbihwYXJlbnQscmVxdWVzdCxzY2FsZSl7dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3RoaXMuX3JlcXVlc3Q9cmVxdWVzdDt0aGlzLl9vcGVuPWZhbHNlO3RoaXMuX3NjYWxlPXNjYWxlO3RoaXMuX1JFUV9IRUlHSFQ9MjA7fSxzdGFydDpmdW5jdGlvbigpe3RoaXMuZWwuc3R5bGUuYm9yZGVyQm90dG9tPScxcHggc29saWQgYmxhY2snO3RoaXMucmVuZGVyKCk7cmV0dXJuIHRoaXMuX3N1cGVyKCk7fSxyZW5kZXI6ZnVuY3Rpb24oKXt2YXIgcmVxdWVzdF9jZWxsX2hlaWdodD10aGlzLl9SRVFfSEVJR0hULFRJVExFX1dJRFRIPTIwMDt2YXIgcmVxdWVzdD10aGlzLl9yZXF1ZXN0O3ZhciByZXFfc3RhcnQ9cmVxdWVzdFswXVszXSoxZTM7dmFyIHJlcV9kdXJhdGlvbj1yZXF1ZXN0W3JlcXVlc3QubGVuZ3RoLTFdWzNdKjFlMy1yZXFfc3RhcnQ7dmFyIGhlaWdodD1yZXF1ZXN0X2NlbGxfaGVpZ2h0Kih0aGlzLl9vcGVuP3JlcXVlc3QubGVuZ3RoLzI6MSk7dmFyIGNlbGxfY2VudGVyPXJlcXVlc3RfY2VsbF9oZWlnaHQvMjt2YXIgY3R4PW1ha2VfY29udGV4dCgyMTArTWF0aC5jZWlsKHJlcV9kdXJhdGlvbip0aGlzLl9zY2FsZSksaGVpZ2h0LGZ1bmN0aW9uKGN0eCl7Y3R4LmxpbmVXaWR0aD1jZWxsX2NlbnRlcjt9KTt0aGlzLiRlbC5lbXB0eSgpLmFwcGVuZChjdHguY2FudmFzKTt2YXIgcGF5bG9hZHM9dGhpcy5fcGF5bG9hZHM9W107dmFyIHRleHRfY3R4PW1ha2VfY29udGV4dChUSVRMRV9XSURUSCxoZWlnaHQsZnVuY3Rpb24oY3R4KXtjdHguZm9udD0nMTJweCBzYW5zLXNlcmlmJztjdHgudGV4dEFsaWduPSdyaWdodCc7Y3R4LnRleHRCYXNlbGluZT0nbWlkZGxlJztjdHgudHJhbnNsYXRlKDAsY2VsbF9jZW50ZXIpO30pO2N0eC5zYXZlKCk7Y3R4LnRyYW5zbGF0ZShUSVRMRV9XSURUSCsxMCwoKHJlcXVlc3RfY2VsbF9oZWlnaHQvNCl8MCkpO3RoaXMuZ2V0UGFyZW50KCkuX2RyYXdfcmVxdWVzdChyZXF1ZXN0LGN0eCx0aGlzLl9vcGVuP3JlcXVlc3RfY2VsbF9oZWlnaHQ6MCx0aGlzLl9zY2FsZSxmdW5jdGlvbihpZHgsdGltZXN0YW1wLGV2ZW50KXtpZigvLXN0YXJ0JC9nLnRlc3QoZXZlbnRbMF0pKXtwYXlsb2Fkcy5wdXNoKHtwYXlsb2FkOmV2ZW50WzJdLHN0YXJ0OnRpbWVzdGFtcCxzdG9wOm51bGx9KTt2YXIgdGl0bGU9ZXZlbnRbMl07dGl0bGU9dGl0bGUucmVwbGFjZSgvXHMrJC8sJycpO3RpdGxlPXRpdGxlLmxlbmd0aDw9NTA/dGl0bGU6KCfigKYnK3RpdGxlLnNsaWNlKC00OSkpO3doaWxlKHRleHRfY3R4Lm1lYXN1cmVUZXh0KHRpdGxlKS53aWR0aD4yMDApe3RpdGxlPSfigKYnK3RpdGxlLnNsaWNlKDIpO30KdGV4dF9jdHguZmlsbFRleHQodGl0bGUsVElUTEVfV0lEVEgscmVxdWVzdF9jZWxsX2hlaWdodCppZHgpO31lbHNlIGlmKC8tZW5kJC9nLnRlc3QoZXZlbnRbMF0pKXtwYXlsb2Fkc1tpZHhdLnN0b3A9dGltZXN0YW1wO319KTtjdHgucmVzdG9yZSgpO2N0eC5kcmF3SW1hZ2UodGV4dF9jdHguY2FudmFzLDAsMCk7fX0pO2lmKGNvbmZpZy5pc0RlYnVnKCkpe1N5c3RyYXlNZW51Lkl0ZW1zLnB1c2goRGVidWdNYW5hZ2VyKTtXZWJDbGllbnQuaW5jbHVkZSh7Y3VycmVudF9hY3Rpb25fdXBkYXRlZDpmdW5jdGlvbihhY3Rpb24sY29udHJvbGxlcil7dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3ZhciBkZWJ1Z01hbmFnZXI9Xy5maW5kKHRoaXMubWVudS5zeXN0cmF5X21lbnUud2lkZ2V0cyxmdW5jdGlvbihpdGVtKXtyZXR1cm4gaXRlbSBpbnN0YW5jZW9mIERlYnVnTWFuYWdlcjt9KTtkZWJ1Z01hbmFnZXIudXBkYXRlKCdhY3Rpb24nLGFjdGlvbixjb250cm9sbGVyJiZjb250cm9sbGVyLndpZGdldCk7fSx9KTtBY3Rpb25NYW5hZ2VyLmluY2x1ZGUoe2dldEN1cnJlbnRBY3Rpb25JbkRpYWxvZzpmdW5jdGlvbigpe2lmKHRoaXMuY3VycmVudERpYWxvZ0NvbnRyb2xsZXIpe3JldHVybiB0aGlzLmFjdGlvbnNbdGhpcy5jdXJyZW50RGlhbG9nQ29udHJvbGxlci5hY3Rpb25JRF07fQpyZXR1cm4gbnVsbDt9LGdldEN1cnJlbnRDb250cm9sbGVySW5EaWFsb2c6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jdXJyZW50RGlhbG9nQ29udHJvbGxlcjt9LH0pO0RpYWxvZy5pbmNsdWRlKHtvcGVuOmZ1bmN0aW9uKCl7dmFyIHNlbGY9dGhpczt0aGlzLm9wZW5lZChmdW5jdGlvbigpe3NldFRpbWVvdXQoZnVuY3Rpb24oKXt2YXIgcGFyZW50PXNlbGYuZ2V0UGFyZW50KCk7aWYocGFyZW50IGluc3RhbmNlb2YgQWN0aW9uTWFuYWdlcil7dmFyIGFjdGlvbj1wYXJlbnQuZ2V0Q3VycmVudEFjdGlvbkluRGlhbG9nKCk7aWYoYWN0aW9uKXt2YXIgY29udHJvbGxlcj1wYXJlbnQuZ2V0Q3VycmVudENvbnRyb2xsZXJJbkRpYWxvZygpO3NlbGYuZGVidWdNYW5hZ2VyPW5ldyBEZWJ1Z01hbmFnZXIoc2VsZik7dmFyICRoZWFkZXI9c2VsZi4kbW9kYWwuZmluZCgnLm1vZGFsLWhlYWRlcjpmaXJzdCcpO3JldHVybiBzZWxmLmRlYnVnTWFuYWdlci5wcmVwZW5kVG8oJGhlYWRlcikudGhlbihmdW5jdGlvbigpe3NlbGYuZGVidWdNYW5hZ2VyLnVwZGF0ZSgnYWN0aW9uJyxhY3Rpb24sY29udHJvbGxlci53aWRnZXQpO30pO319fSwwKTt9KTtyZXR1cm4gdGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO30sfSk7fQpyZXR1cm4gRGVidWdNYW5hZ2VyO30pOzsKCi8qIC93ZWIvc3RhdGljL3NyYy9qcy90b29scy90b29scy5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwpvZG9vLmRlZmluZSgnd2ViLnRvb2xzJyxmdW5jdGlvbihyZXF1aXJlKXsidXNlIHN0cmljdCI7ZnVuY3Rpb24gZGVwcmVjYXRlZChmbixtZXNzYWdlKXtyZXR1cm4gZnVuY3Rpb24oKXtjb25zb2xlLndhcm4obWVzc2FnZXx8KGZuLm5hbWUrJyBpcyBkZXByZWNhdGVkLicpKTtmbi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fTt9CnJldHVybntkZXByZWNhdGVkOmRlcHJlY2F0ZWQsfTt9KTs7CgovKiAvd2ViL3N0YXRpYy9zcmMvanMvd2lkZ2V0cy9kYXRhX2V4cG9ydC5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwpvZG9vLmRlZmluZSgnd2ViLkRhdGFFeHBvcnQnLGZ1bmN0aW9uKHJlcXVpcmUpeyJ1c2Ugc3RyaWN0Ijt2YXIgY29uZmlnPXJlcXVpcmUoJ3dlYi5jb25maWcnKTt2YXIgY29yZT1yZXF1aXJlKCd3ZWIuY29yZScpO3ZhciBEaWFsb2c9cmVxdWlyZSgnd2ViLkRpYWxvZycpO3ZhciBkYXRhPXJlcXVpcmUoJ3dlYi5kYXRhJyk7dmFyIGZyYW1ld29yaz1yZXF1aXJlKCd3ZWIuZnJhbWV3b3JrJyk7dmFyIHB5VXRpbHM9cmVxdWlyZSgnd2ViLnB5X3V0aWxzJyk7dmFyIFFXZWI9Y29yZS5xd2ViO3ZhciBfdD1jb3JlLl90O3ZhciBEYXRhRXhwb3J0PURpYWxvZy5leHRlbmQoe3RlbXBsYXRlOidFeHBvcnREaWFsb2cnLGV2ZW50czp7J2NoYW5nZSAub19leHBvcnRlZF9saXN0c19zZWxlY3QnOidfb25DaGFuZ2VFeHBvcnRMaXN0JywnY2hhbmdlIC5vX2ltcG9ydF9jb21wYXQgaW5wdXQnOidfb25DaGFuZ2VDb21wYXRpYmxlSW5wdXQnLCdjbGljayAub19hZGRfZmllbGQnOidfb25DbGlja0FkZEZpZWxkJywnY2xpY2sgLm9fZGVsZXRlX2V4cG9ydGVkX2xpc3QnOidfb25DbGlja0RlbGV0ZUV4cG9ydExpc3RCdG4nLCdjbGljayAub19leHBhbmQnOidfb25DbGlja0V4cGFuZCcsJ2NsaWNrIC5vX3JlbW92ZV9maWVsZCc6J19vbkNsaWNrUmVtb3ZlRmllbGQnLCdjbGljayAub19zYXZlX2xpc3QgLm9fc2F2ZV9saXN0X2J0bic6J19vbkNsaWNrU2F2ZUxpc3RCdG4nLCdjbGljayAub19zYXZlX2xpc3QgLm9fY2FuY2VsX2xpc3RfYnRuJzonX3Jlc2V0VGVtcGxhdGVGaWVsZCcsJ2NsaWNrIC5vX2V4cG9ydF90cmVlX2l0ZW0nOidfb25DbGlja1RyZWVJdGVtJywnZGJsY2xpY2sgLm9fZXhwb3J0X3RyZWVfaXRlbTpub3QoLmhhc2NoaWxkKSc6J19vbkRibGNsaWNrVHJlZUl0ZW0nLCdrZXlkb3duIC5vX2V4cG9ydF90cmVlX2l0ZW0nOidfb25LZXlkb3duVHJlZUl0ZW0nLCdrZXlkb3duIC5vX3NhdmVfbGlzdF9uYW1lJzonX29uS2V5ZG93blNhdmVMaXN0JywnaW5wdXQgLm9fZXhwb3J0X3NlYXJjaF9pbnB1dCc6J19vblNlYXJjaElucHV0Jyx9LGluaXQ6ZnVuY3Rpb24ocGFyZW50LHJlY29yZCxkZWZhdWx0RXhwb3J0RmllbGRzLGdyb3VwZWRCeSxhY3RpdmVEb21haW4saWRzVG9FeHBvcnQpe3ZhciBvcHRpb25zPXt0aXRsZTpfdCgiRXhwb3J0IERhdGEiKSxidXR0b25zOlt7dGV4dDpfdCgiRXhwb3J0IiksY2xpY2s6dGhpcy5fb25FeHBvcnREYXRhLGNsYXNzZXM6J2J0bi1wcmltYXJ5J30se3RleHQ6X3QoIkNsb3NlIiksY2xvc2U6dHJ1ZX0sXSx9O3RoaXMuX3N1cGVyKHBhcmVudCxvcHRpb25zKTt0aGlzLnJlY29yZHM9e307dGhpcy5yZWNvcmQ9cmVjb3JkO3RoaXMuZGVmYXVsdEV4cG9ydEZpZWxkcz1kZWZhdWx0RXhwb3J0RmllbGRzO3RoaXMuZ3JvdXBieT1ncm91cGVkQnk7dGhpcy5leHBvcnRzPW5ldyBkYXRhLkRhdGFTZXRTZWFyY2godGhpcywnaXIuZXhwb3J0cycsdGhpcy5yZWNvcmQuZ2V0Q29udGV4dCgpKTt0aGlzLnJvd0luZGV4PTA7dGhpcy5yb3dJbmRleExldmVsPTA7dGhpcy5pc0NvbXBhdGlibGVNb2RlPWZhbHNlO3RoaXMuZG9tYWluPWFjdGl2ZURvbWFpbnx8dGhpcy5yZWNvcmQuZG9tYWluO3RoaXMuaWRzVG9FeHBvcnQ9YWN0aXZlRG9tYWluP2ZhbHNlOmlkc1RvRXhwb3J0O30sc3RhcnQ6ZnVuY3Rpb24oKXt2YXIgc2VsZj10aGlzO3ZhciBwcm9tcz1bdGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpXTt0aGlzLiRtb2RhbC5maW5kKCcubW9kYWwtY29udGVudCcpLmNzcygnaGVpZ2h0JywnMTAwJScpO3RoaXMuJGZpZWxkc0xpc3Q9dGhpcy4kKCcub19maWVsZHNfbGlzdCcpO3Byb21zLnB1c2godGhpcy5fcnBjKHtyb3V0ZTonL3dlYi9leHBvcnQvZm9ybWF0cyd9KS50aGVuKGRvU2V0dXBFeHBvcnRGb3JtYXRzKSk7cHJvbXMucHVzaCh0aGlzLl9vbkNoYW5nZUNvbXBhdGlibGVJbnB1dCgpLnRoZW4oZnVuY3Rpb24oKXtfLmVhY2goc2VsZi5kZWZhdWx0RXhwb3J0RmllbGRzLGZ1bmN0aW9uKGZpZWxkKXt2YXIgcmVjb3JkPXNlbGYucmVjb3Jkc1tmaWVsZF07c2VsZi5fYWRkRmllbGQocmVjb3JkLmlkLHJlY29yZC5zdHJpbmcpO30pO30pKTtwcm9tcy5wdXNoKHRoaXMuX3Nob3dFeHBvcnRzTGlzdCgpKTt0aGlzLm9wZW5lZCgpLnRoZW4oZnVuY3Rpb24oKXtzZWxmLiQoJy5vX2ZpZWxkc19saXN0Jykuc29ydGFibGUoe2F4aXM6J3knLGhhbmRsZTonLm9fc2hvcnRfZmllbGQnLGZvcmNlUGxhY2Vob2xkZXJTaXplOnRydWUscGxhY2Vob2xkZXI6J28tZmllbGQtcGxhY2Vob2xkZXInLHVwZGF0ZTpzZWxmLnByb3h5KCdfcmVzZXRUZW1wbGF0ZUZpZWxkJyksfSk7fSk7cmV0dXJuIFByb21pc2UuYWxsKHByb21zKTtmdW5jdGlvbiBkb1NldHVwRXhwb3J0Rm9ybWF0cyhmb3JtYXRzKXt2YXIgJGZtdHM9c2VsZi4kKCcub19leHBvcnRfZm9ybWF0Jyk7Xy5lYWNoKGZvcm1hdHMsZnVuY3Rpb24oZm9ybWF0KXt2YXIgJHJhZGlvPSQoJzxpbnB1dC8+Jyx7dHlwZToncmFkaW8nLHZhbHVlOmZvcm1hdC50YWcsbmFtZTonb19leHBvcnRfZm9ybWF0X25hbWUnLGNsYXNzOidmb3JtLWNoZWNrLWlucHV0JyxpZDonb19yYWRpbycrZm9ybWF0LmxhYmVsfSk7dmFyICRsYWJlbD0kKCc8bGFiZWwvPicse2h0bWw6Zm9ybWF0LmxhYmVsLGNsYXNzOidmb3JtLWNoZWNrLWxhYmVsJyxmb3I6J29fcmFkaW8nK2Zvcm1hdC5sYWJlbH0pO2lmKGZvcm1hdC5lcnJvcil7JHJhZGlvLnByb3AoJ2Rpc2FibGVkJyx0cnVlKTskbGFiZWwuaHRtbChfLnN0ci5zcHJpbnRmKCIlcyDigJQgJXMiLGZvcm1hdC5sYWJlbCxmb3JtYXQuZXJyb3IpKTt9CiRmbXRzLmFwcGVuZCgkKCI8ZGl2IGNsYXNzPSdyYWRpbyBmb3JtLWNoZWNrIGZvcm0tY2hlY2staW5saW5lIHBsLTQnPjwvZGl2PiIpLmFwcGVuZCgkcmFkaW8sJGxhYmVsKSk7fSk7c2VsZi4kZXhwb3J0Rm9ybWF0SW5wdXRzPSRmbXRzLmZpbmQoJ2lucHV0Jyk7c2VsZi4kZXhwb3J0Rm9ybWF0SW5wdXRzLmZpbHRlcignOmVuYWJsZWQnKS5maXJzdCgpLnByb3AoJ2NoZWNrZWQnLHRydWUpO319LGV4cG9ydCgpe2xldCBleHBvcnRlZEZpZWxkcz10aGlzLmRlZmF1bHRFeHBvcnRGaWVsZHMubWFwKGZpZWxkPT4oe25hbWU6ZmllbGQsbGFiZWw6dGhpcy5yZWNvcmQuZmllbGRzW2ZpZWxkXS5zdHJpbmcsfSkpO3RoaXMuX2V4cG9ydERhdGEoZXhwb3J0ZWRGaWVsZHMsJ3hsc3gnLGZhbHNlKTt9LF9hZGRGaWVsZDpmdW5jdGlvbihmaWVsZElELGxhYmVsKXt2YXIgJGZpZWxkTGlzdD10aGlzLiQoJy5vX2ZpZWxkc19saXN0Jyk7aWYoISRmaWVsZExpc3QuZmluZCgiLm9fZXhwb3J0X2ZpZWxkW2RhdGEtZmllbGRfaWQ9JyIrZmllbGRJRCsiJ10iKS5sZW5ndGgpeyRmaWVsZExpc3QuYXBwZW5kKCQoJzxsaT4nLHsnY2xhc3MnOidvX2V4cG9ydF9maWVsZCcsJ2RhdGEtZmllbGRfaWQnOmZpZWxkSUR9KS5hcHBlbmQoJCgnPHNwYW4+Jyx7J2NsYXNzJzoiZmEgZmEtYXJyb3dzIG9fc2hvcnRfZmllbGQgbXgtMSJ9KSxsYWJlbCwkKCc8c3Bhbj4nLHsnY2xhc3MnOidmYSBmYS10cmFzaCBtLTEgcHVsbC1yaWdodCBvX3JlbW92ZV9maWVsZCcsJ3RpdGxlJzpfdCgiUmVtb3ZlIGZpZWxkIil9KSkpO319LF9leHBvcnREYXRhKGV4cG9ydGVkRmllbGRzLGV4cG9ydEZvcm1hdCxpZHNUb0V4cG9ydCl7aWYoXy5pc0VtcHR5KGV4cG9ydGVkRmllbGRzKSl7RGlhbG9nLmFsZXJ0KHRoaXMsX3QoIlBsZWFzZSBzZWxlY3QgZmllbGRzIHRvIGV4cG9ydC4uLiIpKTtyZXR1cm47fQppZih0aGlzLmlzQ29tcGF0aWJsZU1vZGUpe2V4cG9ydGVkRmllbGRzLnVuc2hpZnQoe25hbWU6J2lkJyxsYWJlbDpfdCgnRXh0ZXJuYWwgSUQnKX0pO30KZnJhbWV3b3JrLmJsb2NrVUkoKTt0aGlzLmdldFNlc3Npb24oKS5nZXRfZmlsZSh7dXJsOicvd2ViL2V4cG9ydC8nK2V4cG9ydEZvcm1hdCxkYXRhOntkYXRhOkpTT04uc3RyaW5naWZ5KHttb2RlbDp0aGlzLnJlY29yZC5tb2RlbCxmaWVsZHM6ZXhwb3J0ZWRGaWVsZHMsaWRzOmlkc1RvRXhwb3J0LGRvbWFpbjp0aGlzLmRvbWFpbixncm91cGJ5OnRoaXMuZ3JvdXBieSxjb250ZXh0OnB5VXRpbHMuZXZhbCgnY29udGV4dHMnLFt0aGlzLnJlY29yZC5nZXRDb250ZXh0KCldKSxpbXBvcnRfY29tcGF0OnRoaXMuaXNDb21wYXRpYmxlTW9kZSx9KX0sY29tcGxldGU6ZnJhbWV3b3JrLnVuYmxvY2tVSSxlcnJvcjooZXJyb3IpPT50aGlzLmNhbGwoJ2NyYXNoX21hbmFnZXInLCdycGNfZXJyb3InLGVycm9yKSx9KTt9LF9nZXRGaWVsZHM6ZnVuY3Rpb24oKXt2YXIgZXhwb3J0RmllbGRzPXRoaXMuJCgnLm9fZXhwb3J0X2ZpZWxkJykubWFwKGZ1bmN0aW9uKCl7cmV0dXJuICQodGhpcykuZGF0YSgnZmllbGRfaWQnKTt9KS5nZXQoKTtpZihleHBvcnRGaWVsZHMubGVuZ3RoPT09MCl7RGlhbG9nLmFsZXJ0KHRoaXMsX3QoIlBsZWFzZSBzZWxlY3QgZmllbGRzIHRvIHNhdmUgZXhwb3J0IGxpc3QuLi4iKSk7fQpyZXR1cm4gZXhwb3J0RmllbGRzO30sX29uRXhwYW5kQWN0aW9uOmZ1bmN0aW9uKHJlY29yZCl7dmFyIHNlbGY9dGhpcztpZighcmVjb3JkLmNoaWxkcmVuKXtyZXR1cm47fQp2YXIgbW9kZWw9cmVjb3JkLnBhcmFtcy5tb2RlbDt2YXIgcHJlZml4PXJlY29yZC5wYXJhbXMucHJlZml4O3ZhciBuYW1lPXJlY29yZC5wYXJhbXMubmFtZTt2YXIgZXhjbHVkZUZpZWxkcz1bXTtpZihyZWNvcmQucmVsYXRpb25fZmllbGQpe2V4Y2x1ZGVGaWVsZHMucHVzaChyZWNvcmQucmVsYXRpb25fZmllbGQpO30KaWYoIXJlY29yZC5sb2FkZWQpe3RoaXMuX3JwYyh7cm91dGU6Jy93ZWIvZXhwb3J0L2dldF9maWVsZHMnLHBhcmFtczp7bW9kZWw6bW9kZWwscHJlZml4OnByZWZpeCxwYXJlbnRfbmFtZTpuYW1lLGltcG9ydF9jb21wYXQ6dGhpcy5pc0NvbXBhdGlibGVNb2RlLHBhcmVudF9maWVsZF90eXBlOnJlY29yZC5maWVsZF90eXBlLHBhcmVudF9maWVsZDpyZWNvcmQucGFyYW1zLnBhcmVudF9maWVsZCxleGNsdWRlOmV4Y2x1ZGVGaWVsZHMsfSx9KS50aGVuKGZ1bmN0aW9uKHJlc3VsdHMpe3JlY29yZC5sb2FkZWQ9dHJ1ZTtzZWxmLl9vblNob3dEYXRhKHJlc3VsdHMscmVjb3JkLmlkKTt9KTt9ZWxzZXt0aGlzLl9zaG93Q29udGVudChyZWNvcmQuaWQpO319LF9vblNob3dEYXRhOmZ1bmN0aW9uKHJlY29yZHMsZXhwYW5zaW9uKXt2YXIgc2VsZj10aGlzO2lmKGV4cGFuc2lvbil7dGhpcy4kKCcub19leHBvcnRfdHJlZV9pdGVtW2RhdGEtaWQ9IicrZXhwYW5zaW9uKyciXScpLmFkZENsYXNzKCdzaG93JykuZmluZCgnLm9fZXhwYW5kX3BhcmVudCcpLnRvZ2dsZUNsYXNzKCdmYS1jaGV2cm9uLXJpZ2h0IGZhLWNoZXZyb24tZG93bicpLm5leHQoKS5hZnRlcihRV2ViLnJlbmRlcignRXhwb3J0LlRyZWVJdGVtcycse2ZpZWxkczpyZWNvcmRzLGRlYnVnOmNvbmZpZy5pc0RlYnVnKCl9KSk7fWVsc2V7dGhpcy4kKCcub19sZWZ0X2ZpZWxkX3BhbmVsJykuZW1wdHkoKS5hcHBlbmQoJCgnPGRpdi8+JykuYWRkQ2xhc3MoJ29fZmllbGRfdHJlZV9zdHJ1Y3R1cmUnKS5hcHBlbmQoUVdlYi5yZW5kZXIoJ0V4cG9ydC5UcmVlSXRlbXMnLHtmaWVsZHM6cmVjb3JkcyxkZWJ1Zzpjb25maWcuaXNEZWJ1ZygpfSkpKTt9Cl8uZXh0ZW5kKHRoaXMucmVjb3JkcyxfLm9iamVjdChfLnBsdWNrKHJlY29yZHMsJ2lkJykscmVjb3JkcykpO3RoaXMuJHJlY29yZHM9dGhpcy4kKCcub19leHBvcnRfdHJlZV9pdGVtJyk7dGhpcy4kcmVjb3Jkcy5lYWNoKGZ1bmN0aW9uKGksZWwpe3ZhciAkZWw9JChlbCk7JGVsLmZpbmQoJy5vX3RyZWVfY29sdW1uJykuZmlyc3QoKS50b2dnbGVDbGFzcygnb19yZXF1aXJlZCcsISFzZWxmLnJlY29yZHNbJGVsLmRhdGEoJ2lkJyldLnJlcXVpcmVkKTt9KTt0aGlzLiQoJyNvLWV4cG9ydC1zZWFyY2gtZmlsdGVyJykudmFsKCcnKTt9LF9hZGROZXdUZW1wbGF0ZTpmdW5jdGlvbigpe3RoaXMuJCgnLm9fZXhwb3J0ZWRfbGlzdHMnKS5hZGRDbGFzcygnZC1ub25lJyk7dGhpcy4kKCIub19zYXZlX2xpc3QiKS5zaG93KCkuZmluZCgiLm9fc2F2ZV9saXN0X25hbWUiKS52YWwoIiIpLmZvY3VzKCk7fSxfcmVzZXRUZW1wbGF0ZUZpZWxkOmZ1bmN0aW9uKCl7dGhpcy4kKCcub19leHBvcnRlZF9saXN0c19zZWxlY3QnKS52YWwoIiIpO3RoaXMuJCgnLm9fZGVsZXRlX2V4cG9ydGVkX2xpc3QnKS5hZGRDbGFzcygnZC1ub25lJyk7dGhpcy4kKCcub19leHBvcnRlZF9saXN0cycpLnJlbW92ZUNsYXNzKCdkLW5vbmUnKTt0aGlzLiQoIi5vX3NhdmVfbGlzdCIpLmhpZGUoKS5maW5kKCIub19zYXZlX2xpc3RfbmFtZSIpLnZhbCgiIik7fSxfc2hvd0NvbnRlbnQ6ZnVuY3Rpb24oZmllbGRJRCl7dmFyICRpdGVtPXRoaXMuJCgnLm9fZXhwb3J0X3RyZWVfaXRlbVtkYXRhLWlkPSInK2ZpZWxkSUQrJyJdJyk7JGl0ZW0udG9nZ2xlQ2xhc3MoJ3Nob3cnKTt2YXIgaXNPcGVuPSRpdGVtLmhhc0NsYXNzKCdzaG93Jyk7JGl0ZW0uY2hpbGRyZW4oJy5vX2V4cGFuZF9wYXJlbnQnKS50b2dnbGVDbGFzcygnZmEtY2hldnJvbi1kb3duJywhIWlzT3BlbikudG9nZ2xlQ2xhc3MoJ2ZhLWNoZXZyb24tcmlnaHQnLCFpc09wZW4pO3ZhciAkY2hpbGRGaWVsZD0kaXRlbS5maW5kKCcub19leHBvcnRfdHJlZV9pdGVtJyk7dmFyIGNoaWxkTGVuZ3RoPShmaWVsZElELnNwbGl0KCcvJykpLmxlbmd0aCsxO2Zvcih2YXIgaT0wO2k8JGNoaWxkRmllbGQubGVuZ3RoO2krKyl7dmFyICRjaGlsZD0kY2hpbGRGaWVsZC5lcShpKTtpZighaXNPcGVuKXskY2hpbGQuaGlkZSgpO31lbHNlIGlmKGNoaWxkTGVuZ3RoPT09JGNoaWxkRmllbGQuZXEoaSkuZGF0YSgnaWQnKS5zcGxpdCgnLycpLmxlbmd0aCl7aWYoJGNoaWxkLmhhc0NsYXNzKCdzaG93JykpeyRjaGlsZC5yZW1vdmVDbGFzcygnc2hvdycpOyRjaGlsZC5jaGlsZHJlbignLm9fZXhwYW5kX3BhcmVudCcpLnJlbW92ZUNsYXNzKCdmYS1jaGV2cm9uLWRvd24nKS5hZGRDbGFzcygnZmEtY2hldnJvbi1yaWdodCcpO30KJGNoaWxkLnNob3coKTt9fQp0aGlzLiQoJyNvLWV4cG9ydC1zZWFyY2gtZmlsdGVyJykudmFsKCcnKTt9LF9zaG93RXhwb3J0c0xpc3Q6ZnVuY3Rpb24oKXt2YXIgc2VsZj10aGlzO2lmKHRoaXMuJCgnLm9fZXhwb3J0ZWRfbGlzdHNfc2VsZWN0JykuaXMoJzpoaWRkZW4nKSl7dGhpcy4kKCcub19leHBvcnRlZF9saXN0cycpLnNob3coKTtyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7fQpyZXR1cm4gdGhpcy5fcnBjKHttb2RlbDonaXIuZXhwb3J0cycsbWV0aG9kOidzZWFyY2hfcmVhZCcsZmllbGRzOlsnbmFtZSddLGRvbWFpbjpbWydyZXNvdXJjZScsJz0nLHRoaXMucmVjb3JkLm1vZGVsXV19KS50aGVuKGZ1bmN0aW9uKGV4cG9ydExpc3Qpe3NlbGYuJCgnLm9fZXhwb3J0ZWRfbGlzdHMnKS5hcHBlbmQoUVdlYi5yZW5kZXIoJ0V4cG9ydC5TYXZlZExpc3QnLHtleGlzdGluZ19leHBvcnRzOmV4cG9ydExpc3QsfSkpO30pO30sX29uQ2hhbmdlRXhwb3J0TGlzdDpmdW5jdGlvbigpe3ZhciBzZWxmPXRoaXM7dmFyIGV4cG9ydElEPXRoaXMuJCgnLm9fZXhwb3J0ZWRfbGlzdHNfc2VsZWN0IG9wdGlvbjpzZWxlY3RlZCcpLnZhbCgpO3RoaXMuJCgnLm9fZGVsZXRlX2V4cG9ydGVkX2xpc3QnKS50b2dnbGVDbGFzcygnZC1ub25lJywhZXhwb3J0SUQpO2lmKGV4cG9ydElEJiZleHBvcnRJRCE9PSduZXdfdGVtcGxhdGUnKXt0aGlzLiQoJy5vX2ZpZWxkc19saXN0JykuZW1wdHkoKTt0aGlzLl9ycGMoe3JvdXRlOicvd2ViL2V4cG9ydC9uYW1lbGlzdCcscGFyYW1zOnttb2RlbDp0aGlzLnJlY29yZC5tb2RlbCxleHBvcnRfaWQ6cGFyc2VJbnQoZXhwb3J0SUQsMTApLH0sfSkudGhlbihmdW5jdGlvbihmaWVsZExpc3Qpe18uZWFjaChmaWVsZExpc3QsZnVuY3Rpb24oZmllbGQpe3NlbGYuX2FkZEZpZWxkKGZpZWxkLm5hbWUsZmllbGQubGFiZWwpO30pO30pO31lbHNlIGlmKGV4cG9ydElEPT09J25ld190ZW1wbGF0ZScpe3NlbGYuX2FkZE5ld1RlbXBsYXRlKCk7fX0sX29uQ2hhbmdlQ29tcGF0aWJsZUlucHV0OmZ1bmN0aW9uKCl7dmFyIHNlbGY9dGhpczt0aGlzLmlzQ29tcGF0aWJsZU1vZGU9dGhpcy4kKCcub19pbXBvcnRfY29tcGF0IGlucHV0JykuaXMoJzpjaGVja2VkJyk7dGhpcy4kKCcub19maWVsZF90cmVlX3N0cnVjdHVyZScpLnJlbW92ZSgpO3RoaXMuX3Jlc2V0VGVtcGxhdGVGaWVsZCgpO3JldHVybiB0aGlzLl9ycGMoe3JvdXRlOicvd2ViL2V4cG9ydC9nZXRfZmllbGRzJyxwYXJhbXM6e21vZGVsOnRoaXMucmVjb3JkLm1vZGVsLGltcG9ydF9jb21wYXQ6dGhpcy5pc0NvbXBhdGlibGVNb2RlLH0sfSkudGhlbihmdW5jdGlvbihyZWNvcmRzKXt2YXIgY29tcGF0aWJsZUZpZWxkcz1fLm1hcChyZWNvcmRzLGZ1bmN0aW9uKHJlY29yZCl7cmV0dXJuIHJlY29yZC5pZDt9KTtzZWxmLl9vblNob3dEYXRhKHJlY29yZHMpO3NlbGYuJCgnLm9fZmllbGRzX2xpc3QnKS5lbXB0eSgpO18uY2hhaW4oc2VsZi4kZmllbGRzTGlzdC5maW5kKCcub19leHBvcnRfZmllbGQnKSkubWFwKGZ1bmN0aW9uKGZpZWxkKXtyZXR1cm4gJChmaWVsZCkuZGF0YSgnZmllbGRfaWQnKTt9KS51bmlvbihzZWxmLmRlZmF1bHRFeHBvcnRGaWVsZHMpLmludGVyc2VjdGlvbihjb21wYXRpYmxlRmllbGRzKS5lYWNoKGZ1bmN0aW9uKGZpZWxkKXt2YXIgcmVjb3JkPV8uZmluZChyZWNvcmRzLGZ1bmN0aW9uKHJlYyl7cmV0dXJuIHJlYy5pZD09PWZpZWxkO30pO3NlbGYuX2FkZEZpZWxkKHJlY29yZC5pZCxyZWNvcmQuc3RyaW5nKTt9KTtzZWxmLiQoJyNvLWV4cG9ydC1zZWFyY2gtZmlsdGVyJykudmFsKCcnKTt9KTt9LF9vbkNsaWNrQWRkRmllbGQ6ZnVuY3Rpb24oZXYpe2V2LnN0b3BQcm9wYWdhdGlvbigpO3ZhciAkZmllbGQ9JChldi5jdXJyZW50VGFyZ2V0KTt0aGlzLl9yZXNldFRlbXBsYXRlRmllbGQoKTt0aGlzLl9hZGRGaWVsZCgkZmllbGQuY2xvc2VzdCgnLm9fZXhwb3J0X3RyZWVfaXRlbScpLmRhdGEoJ2lkJyksJGZpZWxkLmNsb3Nlc3QoJy5vX3RyZWVfY29sdW1uJykudGV4dCgpKTt9LF9vbkNsaWNrRGVsZXRlRXhwb3J0TGlzdEJ0bjpmdW5jdGlvbigpe3ZhciBzZWxmPXRoaXM7dmFyIHNlbGVjdEV4cD10aGlzLiQoJy5vX2V4cG9ydGVkX2xpc3RzX3NlbGVjdCBvcHRpb246c2VsZWN0ZWQnKTt2YXIgb3B0aW9ucz17Y29uZmlybV9jYWxsYmFjazpmdW5jdGlvbigpe2lmKHNlbGVjdEV4cC52YWwoKSl7c2VsZi5leHBvcnRzLnVubGluayhbcGFyc2VJbnQoc2VsZWN0RXhwLnZhbCgpLDEwKV0pO3NlbGVjdEV4cC5yZW1vdmUoKTtpZihzZWxmLiQoJy5vX2V4cG9ydGVkX2xpc3RzX3NlbGVjdCBvcHRpb24nKS5sZW5ndGg8PTEpe3NlbGYuJCgnLm9fZXhwb3J0ZWRfbGlzdHMnKS5oaWRlKCk7fX19fTtEaWFsb2cuY29uZmlybSh0aGlzLF90KCJEbyB5b3UgcmVhbGx5IHdhbnQgdG8gZGVsZXRlIHRoaXMgZXhwb3J0IHRlbXBsYXRlPyIpLG9wdGlvbnMpO30sX29uQ2xpY2tFeHBhbmQ6ZnVuY3Rpb24oZXYpe3RoaXMuX29uRXhwYW5kQWN0aW9uKHRoaXMucmVjb3Jkc1skKGV2LnRhcmdldCkuY2xvc2VzdCgnLm9fZXhwb3J0X3RyZWVfaXRlbScpLmRhdGEoJ2lkJyldKTt9LF9vbkNsaWNrUmVtb3ZlRmllbGQ6ZnVuY3Rpb24oZXYpeyQoZXYuY3VycmVudFRhcmdldCkuY2xvc2VzdCgnLm9fZXhwb3J0X2ZpZWxkJykucmVtb3ZlKCk7dGhpcy5fcmVzZXRUZW1wbGF0ZUZpZWxkKCk7fSxfb25DbGlja1NhdmVMaXN0QnRuOmZ1bmN0aW9uKCl7dmFyIHNlbGY9dGhpczt2YXIgJHNhdmVMaXN0PXRoaXMuJCgnLm9fc2F2ZV9saXN0Jyk7dmFyIHZhbHVlPSRzYXZlTGlzdC5maW5kKCdpbnB1dCcpLnZhbCgpO2lmKCF2YWx1ZSl7RGlhbG9nLmFsZXJ0KHRoaXMsX3QoIlBsZWFzZSBlbnRlciBzYXZlIGZpZWxkIGxpc3QgbmFtZSIpKTtyZXR1cm47fQp2YXIgZmllbGRzPXRoaXMuX2dldEZpZWxkcygpO2lmKGZpZWxkcy5sZW5ndGg9PT0wKXtyZXR1cm47fQokc2F2ZUxpc3QuaGlkZSgpO3RoaXMuZXhwb3J0cy5jcmVhdGUoe25hbWU6dmFsdWUscmVzb3VyY2U6dGhpcy5yZWNvcmQubW9kZWwsZXhwb3J0X2ZpZWxkczpfLm1hcChmaWVsZHMsZnVuY3Rpb24oZmllbGQpe3JldHVyblswLDAse25hbWU6ZmllbGR9XTt9KSx9KS50aGVuKGZ1bmN0aW9uKGV4cG9ydExpc3RJRCl7aWYoIWV4cG9ydExpc3RJRCl7cmV0dXJuO30KdmFyICRzZWxlY3Q9c2VsZi4kKCcub19leHBvcnRlZF9saXN0c19zZWxlY3QnKTtpZigkc2VsZWN0Lmxlbmd0aD09PTB8fCRzZWxlY3QuaXMoJzpoaWRkZW4nKSl7c2VsZi5fc2hvd0V4cG9ydHNMaXN0KCk7fQokc2VsZWN0LmFwcGVuZChuZXcgT3B0aW9uKHZhbHVlLGV4cG9ydExpc3RJRCkpO3NlbGYuJCgnLm9fZXhwb3J0ZWRfbGlzdHMnKS5yZW1vdmVDbGFzcygnZC1ub25lJyk7JHNlbGVjdC52YWwoZXhwb3J0TGlzdElEKTt9KTt9LF9vbkNsaWNrVHJlZUl0ZW06ZnVuY3Rpb24oZXYpe2V2LnN0b3BQcm9wYWdhdGlvbigpO3ZhciAkZWxlbT0kKGV2LmN1cnJlbnRUYXJnZXQpO3ZhciByb3dJbmRleD0kZWxlbS5wcmV2QWxsKCcub19leHBvcnRfdHJlZV9pdGVtJykubGVuZ3RoO3ZhciByb3dJbmRleExldmVsPSRlbGVtLnBhcmVudHMoJy5vX2V4cG9ydF90cmVlX2l0ZW0nKS5sZW5ndGg7aWYoZXYuc2hpZnRLZXkmJnJvd0luZGV4TGV2ZWw9PT10aGlzLnJvd0luZGV4TGV2ZWwpe3ZhciBtaW5JbmRleD1NYXRoLm1pbihyb3dJbmRleCx0aGlzLnJvd0luZGV4KTt2YXIgbWF4SW5kZXg9TWF0aC5tYXgocm93SW5kZXgsdGhpcy5yb3dJbmRleCk7dGhpcy4kcmVjb3Jkcy5maWx0ZXIoZnVuY3Rpb24oKXtyZXR1cm4oJGVsZW0ucGFyZW50KClbMF09PT0kKHRoaXMpLnBhcmVudCgpWzBdKTt9KS5zbGljZShtaW5JbmRleCxtYXhJbmRleCsxKS5hZGRDbGFzcygnb19zZWxlY3RlZCcpLmZpbHRlcignOm5vdCg6bGFzdCknKS5lYWNoKHByb2Nlc3NDaGlsZHJlbik7fQp0aGlzLnJvd0luZGV4PXJvd0luZGV4O3RoaXMucm93SW5kZXhMZXZlbD1yb3dJbmRleExldmVsO2lmKGV2LmN0cmxLZXkpeyRlbGVtLnRvZ2dsZUNsYXNzKCdvX3NlbGVjdGVkJykuZm9jdXMoKTt9ZWxzZSBpZihldi5zaGlmdEtleSl7JGVsZW0uYWRkQ2xhc3MoJ29fc2VsZWN0ZWQnKS5mb2N1cygpO31lbHNle3RoaXMuJCgnLm9fc2VsZWN0ZWQnKS5yZW1vdmVDbGFzcygnb19zZWxlY3RlZCcpOyRlbGVtLmFkZENsYXNzKCdvX3NlbGVjdGVkJykuZm9jdXMoKTt9CmZ1bmN0aW9uIHByb2Nlc3NDaGlsZHJlbigpe3ZhciAkY2hpbGQ9JCh0aGlzKTtpZigkY2hpbGQuaGFzQ2xhc3MoJ3Nob3cnKSl7JGNoaWxkLmNoaWxkcmVuKCcub19leHBvcnRfdHJlZV9pdGVtJykuYWRkQ2xhc3MoJ29fc2VsZWN0ZWQnKS5lYWNoKHByb2Nlc3NDaGlsZHJlbik7fX19LF9vbkV4cG9ydERhdGEoKXtsZXQgZXhwb3J0ZWRGaWVsZHM9dGhpcy4kKCcub19leHBvcnRfZmllbGQnKS5tYXAoKGksZmllbGQpPT4oe25hbWU6JChmaWVsZCkuZGF0YSgnZmllbGRfaWQnKSxsYWJlbDpmaWVsZC50ZXh0Q29udGVudCx9KSkuZ2V0KCk7bGV0IGV4cG9ydEZvcm1hdD10aGlzLiRleHBvcnRGb3JtYXRJbnB1dHMuZmlsdGVyKCc6Y2hlY2tlZCcpLnZhbCgpO3RoaXMuX2V4cG9ydERhdGEoZXhwb3J0ZWRGaWVsZHMsZXhwb3J0Rm9ybWF0LHRoaXMuaWRzVG9FeHBvcnQpO30sX29uRGJsY2xpY2tUcmVlSXRlbTpmdW5jdGlvbihldil7dmFyIHNlbGY9dGhpczt0aGlzLl9yZXNldFRlbXBsYXRlRmllbGQoKTtmdW5jdGlvbiBhZGRFbGVtZW50KGVsKXtzZWxmLl9hZGRGaWVsZChlbC5nZXRBdHRyaWJ1dGUoJ2RhdGEtaWQnKSxlbC5xdWVyeVNlbGVjdG9yKCcub190cmVlX2NvbHVtbicpLnRleHRDb250ZW50KTt9CnZhciB0YXJnZXQ9ZXYuY3VycmVudFRhcmdldDt0YXJnZXQuY2xhc3NMaXN0LnJlbW92ZSgnb19zZWxlY3RlZCcpO1tdLnJldmVyc2UuY2FsbCgkKHRhcmdldCkucGFyZW50cygnLm9fZXhwb3J0X3RyZWVfaXRlbScpKS5lYWNoKGZ1bmN0aW9uKCl7YWRkRWxlbWVudCh0aGlzKTt9KTthZGRFbGVtZW50KHRhcmdldCk7fSxfb25LZXlkb3duU2F2ZUxpc3Q6ZnVuY3Rpb24oZXYpe2lmKGV2LmtleUNvZGU9PT0kLnVpLmtleUNvZGUuRU5URVIpe3RoaXMuX29uQ2xpY2tTYXZlTGlzdEJ0bigpO319LF9vbktleWRvd25UcmVlSXRlbTpmdW5jdGlvbihldil7ZXYuc3RvcFByb3BhZ2F0aW9uKCk7dmFyICRlbD0kKGV2LmN1cnJlbnRUYXJnZXQpO3ZhciByZWNvcmQ9dGhpcy5yZWNvcmRzWyRlbC5kYXRhKCdpZCcpXTtzd2l0Y2goZXYua2V5Q29kZXx8ZXYud2hpY2gpe2Nhc2UgJC51aS5rZXlDb2RlLkxFRlQ6aWYoJGVsLmhhc0NsYXNzKCdzaG93Jykpe3RoaXMuX29uRXhwYW5kQWN0aW9uKHJlY29yZCk7fQpicmVhaztjYXNlICQudWkua2V5Q29kZS5SSUdIVDppZighJGVsLmhhc0NsYXNzKCdzaG93Jykpe3RoaXMuX29uRXhwYW5kQWN0aW9uKHJlY29yZCk7fQpicmVhaztjYXNlICQudWkua2V5Q29kZS5VUDp2YXIgJHByZXY9JGVsLnByZXYoJy5vX2V4cG9ydF90cmVlX2l0ZW0nKTtpZigkcHJldi5sZW5ndGg9PT0xKXt3aGlsZSgkcHJldi5oYXNDbGFzcygnc2hvdycpKXskcHJldj0kcHJldi5jaGlsZHJlbignLm9fZXhwb3J0X3RyZWVfaXRlbScpLmxhc3QoKTt9fWVsc2V7JHByZXY9JGVsLnBhcmVudCgnLm9fZXhwb3J0X3RyZWVfaXRlbScpO2lmKCRwcmV2Lmxlbmd0aD09PTApe2JyZWFrO319CiRlbC5yZW1vdmVDbGFzcygnb19zZWxlY3RlZCcpLmJsdXIoKTskcHJldi5hZGRDbGFzcygib19zZWxlY3RlZCIpLmZvY3VzKCk7YnJlYWs7Y2FzZSAkLnVpLmtleUNvZGUuRE9XTjp2YXIgJG5leHQ7aWYoJGVsLmhhc0NsYXNzKCdzaG93JykpeyRuZXh0PSRlbC5jaGlsZHJlbignLm9fZXhwb3J0X3RyZWVfaXRlbScpLmZpcnN0KCk7fWVsc2V7JG5leHQ9JGVsLm5leHQoJy5vX2V4cG9ydF90cmVlX2l0ZW0nKTtpZigkbmV4dC5sZW5ndGg9PT0wKXskbmV4dD0kZWwucGFyZW50KCcub19leHBvcnRfdHJlZV9pdGVtJykubmV4dCgnLm9fZXhwb3J0X3RyZWVfaXRlbScpO2lmKCRuZXh0Lmxlbmd0aD09PTApe2JyZWFrO319fQokZWwucmVtb3ZlQ2xhc3MoJ29fc2VsZWN0ZWQnKS5ibHVyKCk7JG5leHQuYWRkQ2xhc3MoJ29fc2VsZWN0ZWQnKS5mb2N1cygpO2JyZWFrO319LF9vblNlYXJjaElucHV0OmZ1bmN0aW9uKGV2KXt2YXIgc2VhcmNoVGV4dD0kKGV2LmN1cnJlbnRUYXJnZXQpLnZhbCgpLnRyaW0oKS50b1VwcGVyQ2FzZSgpO2lmKCFzZWFyY2hUZXh0KXt0aGlzLiQoJy5vX25vX21hdGNoJykucmVtb3ZlKCk7dGhpcy4kKCIub19leHBvcnRfdHJlZV9pdGVtIikuc2hvdygpO3RoaXMuJCgiLm9fZXhwb3J0X3RyZWVfaXRlbS5oYXNjaGlsZDpub3QoLnNob3cpIC5vX2V4cG9ydF90cmVlX2l0ZW0iKS5oaWRlKCk7cmV0dXJuO30KdmFyIG1hdGNoSXRlbXM9dGhpcy4kKCIub190cmVlX2NvbHVtbiIpLmZpbHRlcihmdW5jdGlvbigpe3ZhciB0aXRsZT10aGlzLmdldEF0dHJpYnV0ZSgndGl0bGUnKTtyZXR1cm4gdGhpcy5pbm5lclRleHQudG9VcHBlckNhc2UoKS5pbmRleE9mKHNlYXJjaFRleHQpPj0wfHx0aXRsZSYmdGl0bGUudG9VcHBlckNhc2UoKS5pbmRleE9mKHNlYXJjaFRleHQpPj0wO30pLnBhcmVudCgpO3RoaXMuJCgiLm9fZXhwb3J0X3RyZWVfaXRlbSIpLmhpZGUoKTtpZihtYXRjaEl0ZW1zLmxlbmd0aCl7dGhpcy4kKCcub19ub19tYXRjaCcpLnJlbW92ZSgpO18uZWFjaChtYXRjaEl0ZW1zLGZ1bmN0aW9uKGNvbCl7dmFyICRjb2w9JChjb2wpOyRjb2wuc2hvdygpOyRjb2wucGFyZW50cygnLmhhc2NoaWxkLnNob3cnKS5zaG93KCk7aWYoISRjb2wucGFyZW50KCkuaGFzQ2xhc3MoJ3Nob3cnKSYmISRjb2wucGFyZW50KCkuaGFzQ2xhc3MoJ29fZmllbGRfdHJlZV9zdHJ1Y3R1cmUnKSl7JGNvbC5oaWRlKCk7fX0pO31lbHNlIGlmKCF0aGlzLiQoJy5vX25vX21hdGNoJykubGVuZ3RoKXt0aGlzLiQoIi5vX2ZpZWxkX3RyZWVfc3RydWN0dXJlIikuYXBwZW5kKCQoIjxoMy8+Iix7Y2xhc3M6J3RleHQtY2VudGVyIHRleHQtbXV0ZWQgbXQtNSBvX25vX21hdGNoJyx0ZXh0Ol90KCJObyBtYXRjaCBmb3VuZC4iKX0pKTt9fSx9KTtyZXR1cm4gRGF0YUV4cG9ydDt9KTs7CgovKiAvd2ViL3N0YXRpYy9zcmMvanMvd2lkZ2V0cy9kYXRlX3BpY2tlci5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwpvZG9vLmRlZmluZSgnd2ViLmRhdGVwaWNrZXInLGZ1bmN0aW9uKHJlcXVpcmUpeyJ1c2Ugc3RyaWN0Ijt2YXIgY29yZT1yZXF1aXJlKCd3ZWIuY29yZScpO3ZhciBmaWVsZF91dGlscz1yZXF1aXJlKCd3ZWIuZmllbGRfdXRpbHMnKTt2YXIgdGltZT1yZXF1aXJlKCd3ZWIudGltZScpO3ZhciBXaWRnZXQ9cmVxdWlyZSgnd2ViLldpZGdldCcpO3ZhciBfdD1jb3JlLl90O3ZhciBEYXRlV2lkZ2V0PVdpZGdldC5leHRlbmQoe3RlbXBsYXRlOiJ3ZWIuZGF0ZXBpY2tlciIsdHlwZV9vZl9kYXRlOiJkYXRlIixldmVudHM6eydlcnJvci5kYXRldGltZXBpY2tlcic6J2Vycm9yRGF0ZXRpbWUnLCdjaGFuZ2UgLm9fZGF0ZXBpY2tlcl9pbnB1dCc6J2NoYW5nZURhdGV0aW1lJywnY2xpY2sgaW5wdXQnOidfb25JbnB1dENsaWNrZWQnLCdpbnB1dCBpbnB1dCc6J19vbklucHV0Jywna2V5ZG93bic6J19vbktleWRvd24nLCdzaG93LmRhdGV0aW1lcGlja2VyJzonX29uRGF0ZVRpbWVQaWNrZXJTaG93JywnaGlkZS5kYXRldGltZXBpY2tlcic6J19vbkRhdGVUaW1lUGlja2VySGlkZScsfSxpbml0OmZ1bmN0aW9uKHBhcmVudCxvcHRpb25zKXt0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy5uYW1lPXBhcmVudC5uYW1lO3RoaXMub3B0aW9ucz1fLmV4dGVuZCh7bG9jYWxlOm1vbWVudC5sb2NhbGUoKSxmb3JtYXQ6dGhpcy50eXBlX29mX2RhdGU9PT0nZGF0ZXRpbWUnP3RpbWUuZ2V0TGFuZ0RhdGV0aW1lRm9ybWF0KCk6dGltZS5nZXRMYW5nRGF0ZUZvcm1hdCgpLG1pbkRhdGU6bW9tZW50KHt5OjE5MDB9KSxtYXhEYXRlOm1vbWVudCgpLmFkZCgyMDAsInkiKSx1c2VDdXJyZW50OmZhbHNlLGljb25zOnt0aW1lOidmYSBmYS1jbG9jay1vJyxkYXRlOidmYSBmYS1jYWxlbmRhcicsdXA6J2ZhIGZhLWNoZXZyb24tdXAnLGRvd246J2ZhIGZhLWNoZXZyb24tZG93bicscHJldmlvdXM6J2ZhIGZhLWNoZXZyb24tbGVmdCcsbmV4dDonZmEgZmEtY2hldnJvbi1yaWdodCcsdG9kYXk6J2ZhIGZhLWNhbGVuZGFyLWNoZWNrLW8nLGNsZWFyOidmYSBmYS1kZWxldGUnLGNsb3NlOidmYSBmYS1jaGVjayBwcmltYXJ5Jyx9LGNhbGVuZGFyV2Vla3M6dHJ1ZSxidXR0b25zOntzaG93VG9kYXk6ZmFsc2Usc2hvd0NsZWFyOmZhbHNlLHNob3dDbG9zZTpmYWxzZSx9LHdpZGdldFBhcmVudDonYm9keScsa2V5QmluZHM6bnVsbCx9LG9wdGlvbnN8fHt9KTt0aGlzLl9fbGliSW5wdXQ9MDt0aGlzLl9faXNPcGVuPWZhbHNlO30sc3RhcnQ6ZnVuY3Rpb24oKXt0aGlzLiRpbnB1dD10aGlzLiQoJ2lucHV0Lm9fZGF0ZXBpY2tlcl9pbnB1dCcpO3RoaXMuX19saWJJbnB1dCsrO3RoaXMuJGVsLmRhdGV0aW1lcGlja2VyKHRoaXMub3B0aW9ucyk7dGhpcy5fX2xpYklucHV0LS07dGhpcy5fc2V0UmVhZG9ubHkoZmFsc2UpO30sZGVzdHJveTpmdW5jdGlvbigpe2lmKHRoaXMuX29uU2Nyb2xsKXt3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignc2Nyb2xsJyx0aGlzLl9vblNjcm9sbCx0cnVlKTt9CnRoaXMuX19saWJJbnB1dCsrO3RoaXMuJGVsLmRhdGV0aW1lcGlja2VyKCdkZXN0cm95Jyk7dGhpcy5fX2xpYklucHV0LS07dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO30sY2hhbmdlRGF0ZXRpbWU6ZnVuY3Rpb24oKXtpZih0aGlzLl9fbGliSW5wdXQ+MCl7aWYodGhpcy5vcHRpb25zLndhcm5fZnV0dXJlKXt0aGlzLl93YXJuRnV0dXJlKHRoaXMuZ2V0VmFsdWUoKSk7fQp0aGlzLnRyaWdnZXIoImRhdGV0aW1lX2NoYW5nZWQiKTtyZXR1cm47fQp2YXIgb2xkVmFsdWU9dGhpcy5nZXRWYWx1ZSgpO2lmKHRoaXMuaXNWYWxpZCgpKXt0aGlzLl9zZXRWYWx1ZUZyb21VaSgpO3ZhciBuZXdWYWx1ZT10aGlzLmdldFZhbHVlKCk7dmFyIGhhc0NoYW5nZWQ9IW9sZFZhbHVlIT09IW5ld1ZhbHVlO2lmKG9sZFZhbHVlJiZuZXdWYWx1ZSl7dmFyIGZvcm1hdHRlZE9sZFZhbHVlPW9sZFZhbHVlLmZvcm1hdCh0aW1lLmdldExhbmdEYXRldGltZUZvcm1hdCgpKTt2YXIgZm9ybWF0dGVkTmV3VmFsdWU9bmV3VmFsdWUuZm9ybWF0KHRpbWUuZ2V0TGFuZ0RhdGV0aW1lRm9ybWF0KCkpO2lmKGZvcm1hdHRlZE5ld1ZhbHVlIT09Zm9ybWF0dGVkT2xkVmFsdWUpe2hhc0NoYW5nZWQ9dHJ1ZTt9fQppZihoYXNDaGFuZ2VkKXtpZih0aGlzLm9wdGlvbnMud2Fybl9mdXR1cmUpe3RoaXMuX3dhcm5GdXR1cmUobmV3VmFsdWUpO30KdGhpcy50cmlnZ2VyKCJkYXRldGltZV9jaGFuZ2VkIik7fX1lbHNle3ZhciBmb3JtYXR0ZWRWYWx1ZT1vbGRWYWx1ZT90aGlzLl9mb3JtYXRDbGllbnQob2xkVmFsdWUpOm51bGw7dGhpcy4kaW5wdXQudmFsKGZvcm1hdHRlZFZhbHVlKTt9fSxlcnJvckRhdGV0aW1lOmZ1bmN0aW9uKGUpe3JldHVybiBmYWxzZTt9LGZvY3VzOmZ1bmN0aW9uKCl7dGhpcy5fX2xpYklucHV0Kys7dGhpcy4kaW5wdXQuZm9jdXMoKTt0aGlzLl9fbGliSW5wdXQtLTt9LGdldFZhbHVlOmZ1bmN0aW9uKCl7dmFyIHZhbHVlPXRoaXMuZ2V0KCd2YWx1ZScpO3JldHVybiB2YWx1ZSYmdmFsdWUuY2xvbmUoKTt9LGlzVmFsaWQ6ZnVuY3Rpb24oKXt2YXIgdmFsdWU9dGhpcy4kaW5wdXQudmFsKCk7aWYodmFsdWU9PT0iIil7cmV0dXJuIHRydWU7fWVsc2V7dHJ5e3RoaXMuX3BhcnNlQ2xpZW50KHZhbHVlKTtyZXR1cm4gdHJ1ZTt9Y2F0Y2goZSl7cmV0dXJuIGZhbHNlO319fSxtYXhEYXRlOmZ1bmN0aW9uKGRhdGUpe3RoaXMuX19saWJJbnB1dCsrO3RoaXMuJGVsLmRhdGV0aW1lcGlja2VyKCdtYXhEYXRlJyxkYXRlfHxudWxsKTt0aGlzLl9fbGliSW5wdXQtLTt9LG1pbkRhdGU6ZnVuY3Rpb24oZGF0ZSl7dGhpcy5fX2xpYklucHV0Kys7dGhpcy4kZWwuZGF0ZXRpbWVwaWNrZXIoJ21pbkRhdGUnLGRhdGV8fG51bGwpO3RoaXMuX19saWJJbnB1dC0tO30sc2V0VmFsdWU6ZnVuY3Rpb24odmFsdWUpe3RoaXMuc2V0KHsndmFsdWUnOnZhbHVlfSk7dmFyIGZvcm1hdHRlZF92YWx1ZT12YWx1ZT90aGlzLl9mb3JtYXRDbGllbnQodmFsdWUpOm51bGw7dGhpcy4kaW5wdXQudmFsKGZvcm1hdHRlZF92YWx1ZSk7dGhpcy5fX2xpYklucHV0Kys7dGhpcy4kZWwuZGF0ZXRpbWVwaWNrZXIoJ2RhdGUnLHZhbHVlfHxudWxsKTt0aGlzLl9fbGliSW5wdXQtLTt9LF93YXJuRnV0dXJlOmZ1bmN0aW9uKGN1cnJlbnREYXRlKXtpZighdGhpcy4kd2FybmluZyl7dGhpcy4kd2FybmluZz0kKCc8c3Bhbj4nLHtjbGFzczonZmEgZmEtZXhjbGFtYXRpb24tdHJpYW5nbGUgb190el93YXJuaW5nIG9fZGF0ZXBpY2tlcl93YXJuaW5nJyx9KTt2YXIgdGl0bGU9X3QoIlRoaXMgZGF0ZSBpcyBvbiB0aGUgZnV0dXJlLiBNYWtlIHN1cmUgaXQgaXMgd2hhdCB5b3UgZXhwZWN0ZWQuIik7dGhpcy4kd2FybmluZy5hdHRyKCd0aXRsZScsdGl0bGUpO3RoaXMuJGlucHV0LmFmdGVyKHRoaXMuJHdhcm5pbmcpO30KaWYoY3VycmVudERhdGUmJmN1cnJlbnREYXRlLmlzQWZ0ZXIobW9tZW50KCkpKXt0aGlzLiR3YXJuaW5nLnNob3coKTt9ZWxzZXt0aGlzLiR3YXJuaW5nLmhpZGUoKTt9fSxfZm9ybWF0Q2xpZW50OmZ1bmN0aW9uKHYpe3JldHVybiBmaWVsZF91dGlscy5mb3JtYXRbdGhpcy50eXBlX29mX2RhdGVdKHYsbnVsbCx7dGltZXpvbmU6ZmFsc2V9KTt9LF9wYXJzZUNsaWVudDpmdW5jdGlvbih2KXtyZXR1cm4gZmllbGRfdXRpbHMucGFyc2VbdGhpcy50eXBlX29mX2RhdGVdKHYsbnVsbCx7dGltZXpvbmU6ZmFsc2V9KTt9LF9zZXRSZWFkb25seTpmdW5jdGlvbihyZWFkb25seSl7dGhpcy5yZWFkb25seT1yZWFkb25seTt0aGlzLiRpbnB1dC5wcm9wKCdyZWFkb25seScsdGhpcy5yZWFkb25seSk7fSxfc2V0VmFsdWVGcm9tVWk6ZnVuY3Rpb24oKXt2YXIgdmFsdWU9dGhpcy4kaW5wdXQudmFsKCl8fGZhbHNlO3RoaXMuc2V0VmFsdWUodGhpcy5fcGFyc2VDbGllbnQodmFsdWUpKTt9LF9vbkRhdGVUaW1lUGlja2VySGlkZTpmdW5jdGlvbigpe3RoaXMuX19pc09wZW49ZmFsc2U7dGhpcy5jaGFuZ2VEYXRldGltZSgpO2lmKHRoaXMuX29uU2Nyb2xsKXt3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignc2Nyb2xsJyx0aGlzLl9vblNjcm9sbCx0cnVlKTt9CnRoaXMuY2hhbmdlRGF0ZXRpbWUoKTt9LF9vbkRhdGVUaW1lUGlja2VyU2hvdzpmdW5jdGlvbigpe3RoaXMuX19pc09wZW49dHJ1ZTtpZih0aGlzLiRpbnB1dC52YWwoKS5sZW5ndGghPT0wJiZ0aGlzLmlzVmFsaWQoKSl7dGhpcy4kaW5wdXQuc2VsZWN0KCk7fQp2YXIgc2VsZj10aGlzO3RoaXMuX29uU2Nyb2xsPWZ1bmN0aW9uKGV2KXtpZihldi50YXJnZXQhPT1zZWxmLiRpbnB1dC5nZXQoMCkpe3NlbGYuX19saWJJbnB1dCsrO3NlbGYuJGVsLmRhdGV0aW1lcGlja2VyKCdoaWRlJyk7c2VsZi5fX2xpYklucHV0LS07fX07d2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsdGhpcy5fb25TY3JvbGwsdHJ1ZSk7fSxfb25LZXlkb3duOmZ1bmN0aW9uKGV2KXtpZihldi53aGljaD09PSQudWkua2V5Q29kZS5FU0NBUEUpe2lmKHRoaXMuX19pc09wZW4pe2V2LnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO3RoaXMuX19saWJJbnB1dCsrO3RoaXMuJGVsLmRhdGV0aW1lcGlja2VyKCdoaWRlJyk7dGhpcy5fX2xpYklucHV0LS07dGhpcy5mb2N1cygpO319fSxfb25JbnB1dDpmdW5jdGlvbihldil7aWYodGhpcy5fX2xpYklucHV0PjApe2V2LnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO319LF9vbklucHV0Q2xpY2tlZDpmdW5jdGlvbigpe3RoaXMuX19saWJJbnB1dCsrO3RoaXMuJGVsLmRhdGV0aW1lcGlja2VyKCd0b2dnbGUnKTt0aGlzLl9fbGliSW5wdXQtLTt0aGlzLmZvY3VzKCk7fSx9KTt2YXIgRGF0ZVRpbWVXaWRnZXQ9RGF0ZVdpZGdldC5leHRlbmQoe3R5cGVfb2ZfZGF0ZToiZGF0ZXRpbWUiLGluaXQ6ZnVuY3Rpb24ocGFyZW50LG9wdGlvbnMpe3RoaXMuX3N1cGVyKHBhcmVudCxfLmV4dGVuZCh7YnV0dG9uczp7c2hvd1RvZGF5OmZhbHNlLHNob3dDbGVhcjpmYWxzZSxzaG93Q2xvc2U6dHJ1ZSx9LH0sb3B0aW9uc3x8e30pKTt9LH0pO3JldHVybntEYXRlV2lkZ2V0OkRhdGVXaWRnZXQsRGF0ZVRpbWVXaWRnZXQ6RGF0ZVRpbWVXaWRnZXQsfTt9KTs7CgovKiAvd2ViL3N0YXRpYy9zcmMvanMvd2lkZ2V0cy9kb21haW5fc2VsZWN0b3JfZGlhbG9nLmpzIGRlZmluZWQgaW4gYnVuZGxlICd3ZWIuYXNzZXRzX2JhY2tlbmQnICovCm9kb28uZGVmaW5lKCJ3ZWIuRG9tYWluU2VsZWN0b3JEaWFsb2ciLGZ1bmN0aW9uKHJlcXVpcmUpeyJ1c2Ugc3RyaWN0Ijt2YXIgY29yZT1yZXF1aXJlKCJ3ZWIuY29yZSIpO3ZhciBEaWFsb2c9cmVxdWlyZSgid2ViLkRpYWxvZyIpO3ZhciBEb21haW5TZWxlY3Rvcj1yZXF1aXJlKCJ3ZWIuRG9tYWluU2VsZWN0b3IiKTt2YXIgX3Q9Y29yZS5fdDtyZXR1cm4gRGlhbG9nLmV4dGVuZCh7aW5pdDpmdW5jdGlvbihwYXJlbnQsbW9kZWwsZG9tYWluLG9wdGlvbnMpe3RoaXMubW9kZWw9bW9kZWw7dGhpcy5vcHRpb25zPV8uZXh0ZW5kKHtyZWFkb25seTp0cnVlLGRlYnVnTW9kZTpmYWxzZSx9LG9wdGlvbnN8fHt9KTt2YXIgYnV0dG9ucztpZih0aGlzLm9wdGlvbnMucmVhZG9ubHkpe2J1dHRvbnM9W3t0ZXh0Ol90KCJDbG9zZSIpLGNsb3NlOnRydWV9LF07fWVsc2V7YnV0dG9ucz1be3RleHQ6X3QoIlNhdmUiKSxjbGFzc2VzOiJidG4tcHJpbWFyeSIsY2xvc2U6dHJ1ZSxjbGljazpmdW5jdGlvbigpe3RoaXMudHJpZ2dlcl91cCgiZG9tYWluX3NlbGVjdGVkIix7ZG9tYWluOnRoaXMuZG9tYWluU2VsZWN0b3IuZ2V0RG9tYWluKCl9KTt9fSx7dGV4dDpfdCgiRGlzY2FyZCIpLGNsb3NlOnRydWV9LF07fQp0aGlzLl9zdXBlcihwYXJlbnQsXy5leHRlbmQoe30se3RpdGxlOl90KCJEb21haW4iKSxidXR0b25zOmJ1dHRvbnMsfSxvcHRpb25zfHx7fSkpO3RoaXMuZG9tYWluU2VsZWN0b3I9bmV3IERvbWFpblNlbGVjdG9yKHRoaXMsbW9kZWwsZG9tYWluLG9wdGlvbnMpO30sc3RhcnQ6ZnVuY3Rpb24oKXt2YXIgc2VsZj10aGlzO3RoaXMub3BlbmVkKCkudGhlbihmdW5jdGlvbigpe3NlbGYuJGVsLmNzcygnb3ZlcmZsb3cnLCd2aXNpYmxlJykuY2xvc2VzdCgnLm1vZGFsLWRpYWxvZycpLmNzcygnaGVpZ2h0JywnYXV0bycpO30pO3JldHVybiBQcm9taXNlLmFsbChbdGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpLHRoaXMuZG9tYWluU2VsZWN0b3IuYXBwZW5kVG8odGhpcy4kZWwpXSk7fSx9KTt9KTs7CgovKiAvd2ViL3N0YXRpYy9zcmMvanMvd2lkZ2V0cy9kb21haW5fc2VsZWN0b3IuanMgZGVmaW5lZCBpbiBidW5kbGUgJ3dlYi5hc3NldHNfYmFja2VuZCcgKi8Kb2Rvby5kZWZpbmUoIndlYi5Eb21haW5TZWxlY3RvciIsZnVuY3Rpb24ocmVxdWlyZSl7InVzZSBzdHJpY3QiO3ZhciBjb3JlPXJlcXVpcmUoIndlYi5jb3JlIik7dmFyIGRhdGVwaWNrZXI9cmVxdWlyZSgid2ViLmRhdGVwaWNrZXIiKTt2YXIgRG9tYWluPXJlcXVpcmUoIndlYi5Eb21haW4iKTt2YXIgZmllbGRfdXRpbHM9cmVxdWlyZSgid2ViLmZpZWxkX3V0aWxzIik7dmFyIE1vZGVsRmllbGRTZWxlY3Rvcj1yZXF1aXJlKCJ3ZWIuTW9kZWxGaWVsZFNlbGVjdG9yIik7dmFyIFdpZGdldD1yZXF1aXJlKCJ3ZWIuV2lkZ2V0Iik7dmFyIF90PWNvcmUuX3Q7dmFyIF9sdD1jb3JlLl9sdDt2YXIgb3BlcmF0b3JfbWFwcGluZz17Ij0iOiI9IiwiIT0iOl9sdCgiaXMgbm90ID0iKSwiPiI6Ij4iLCI8IjoiPCIsIj49IjoiPj0iLCI8PSI6Ijw9IiwiaWxpa2UiOl9sdCgiY29udGFpbnMiKSwibm90IGlsaWtlIjpfbHQoImRvZXMgbm90IGNvbnRhaW4iKSwiaW4iOl9sdCgiaW4iKSwibm90IGluIjpfbHQoIm5vdCBpbiIpLCJjaGlsZF9vZiI6X2x0KCJjaGlsZCBvZiIpLCJwYXJlbnRfb2YiOl9sdCgicGFyZW50IG9mIiksImxpa2UiOiJsaWtlIiwibm90IGxpa2UiOiJub3QgbGlrZSIsIj1saWtlIjoiPWxpa2UiLCI9aWxpa2UiOiI9aWxpa2UiLCJzZXQiOl9sdCgiaXMgc2V0IiksIm5vdCBzZXQiOl9sdCgiaXMgbm90IHNldCIpLH07dmFyIERvbWFpbk5vZGU9V2lkZ2V0LmV4dGVuZCh7ZXZlbnRzOnsiY2xpY2sgLm9fZG9tYWluX2FkZF9ub2RlX2J1dHRvbiI6Il9vbkFkZEJ1dHRvbkNsaWNrIiwiY2xpY2sgLm9fZG9tYWluX2RlbGV0ZV9ub2RlX2J1dHRvbiI6Il9vbkRlbGV0ZUJ1dHRvbkNsaWNrIiwibW91c2VlbnRlciBidXR0b24iOiJfb25CdXR0b25FbnRlcmVkIiwibW91c2VsZWF2ZSBidXR0b24iOiJfb25CdXR0b25MZWZ0Iix9LGluaXQ6ZnVuY3Rpb24ocGFyZW50LG1vZGVsLGRvbWFpbixvcHRpb25zKXt0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy5tb2RlbD1tb2RlbDt0aGlzLm9wdGlvbnM9Xy5leHRlbmQoe3JlYWRvbmx5OnRydWUsb3BlcmF0b3JzOm51bGwsZGVidWdNb2RlOmZhbHNlLH0sb3B0aW9uc3x8e30pO3RoaXMucmVhZG9ubHk9dGhpcy5vcHRpb25zLnJlYWRvbmx5O3RoaXMuZGVidWc9dGhpcy5vcHRpb25zLmRlYnVnTW9kZTt9LGlzVmFsaWQ6ZnVuY3Rpb24oKXt9LGdldERvbWFpbjpmdW5jdGlvbigpe30sX29uQWRkQnV0dG9uQ2xpY2s6ZnVuY3Rpb24oZSl7ZS5wcmV2ZW50RGVmYXVsdCgpO2Uuc3RvcFByb3BhZ2F0aW9uKCk7dGhpcy50cmlnZ2VyX3VwKCJhZGRfbm9kZV9jbGlja2VkIix7bmV3QnJhbmNoOiEhJChlLmN1cnJlbnRUYXJnZXQpLmRhdGEoImJyYW5jaCIpLGNoaWxkOnRoaXN9KTt9LF9vbkRlbGV0ZUJ1dHRvbkNsaWNrOmZ1bmN0aW9uKGUpe2UucHJldmVudERlZmF1bHQoKTtlLnN0b3BQcm9wYWdhdGlvbigpO3RoaXMudHJpZ2dlcl91cCgiZGVsZXRlX25vZGVfY2xpY2tlZCIse2NoaWxkOnRoaXN9KTt9LF9vbkJ1dHRvbkVudGVyZWQ6ZnVuY3Rpb24oZSl7ZS5wcmV2ZW50RGVmYXVsdCgpO2Uuc3RvcFByb3BhZ2F0aW9uKCk7dmFyICR0YXJnZXQ9JChlLmN1cnJlbnRUYXJnZXQpO3RoaXMuJGVsLnRvZ2dsZUNsYXNzKCJvX2hvdmVyX2J0bnMiLCR0YXJnZXQuaGFzQ2xhc3MoIm9fZG9tYWluX2RlbGV0ZV9ub2RlX2J1dHRvbiIpKTt0aGlzLiRlbC50b2dnbGVDbGFzcygib19ob3Zlcl9hZGRfbm9kZSIsJHRhcmdldC5oYXNDbGFzcygib19kb21haW5fYWRkX25vZGVfYnV0dG9uIikpO3RoaXMuJGVsLnRvZ2dsZUNsYXNzKCJvX2hvdmVyX2FkZF9pbnNldF9ub2RlIiwhISR0YXJnZXQuZGF0YSgiYnJhbmNoIikpO30sX29uQnV0dG9uTGVmdDpmdW5jdGlvbihlKXtlLnByZXZlbnREZWZhdWx0KCk7ZS5zdG9wUHJvcGFnYXRpb24oKTt0aGlzLiRlbC5yZW1vdmVDbGFzcygib19ob3Zlcl9idG5zIG9faG92ZXJfYWRkX25vZGUgb19ob3Zlcl9hZGRfaW5zZXRfbm9kZSIpO30sfSk7dmFyIERvbWFpblRyZWU9RG9tYWluTm9kZS5leHRlbmQoe3RlbXBsYXRlOiJEb21haW5UcmVlIixldmVudHM6Xy5leHRlbmQoe30sRG9tYWluTm9kZS5wcm90b3R5cGUuZXZlbnRzLHsiY2xpY2sgLm9fZG9tYWluX3RyZWVfb3BlcmF0b3Jfc2VsZWN0b3IgLmRyb3Bkb3duLWl0ZW0iOiJfb25PcGVyYXRvckNoYW5nZSIsfSksY3VzdG9tX2V2ZW50czp7ImFkZF9ub2RlX2NsaWNrZWQiOiJfb25Ob2RlQWRkaXRpb25Bc2siLCJkZWxldGVfbm9kZV9jbGlja2VkIjoiX29uTm9kZURlbGV0aW9uQXNrIix9LGluaXQ6ZnVuY3Rpb24ocGFyZW50LG1vZGVsLGRvbWFpbil7dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3ZhciBwYXJzZWREb21haW49dGhpcy5fcGFyc2VEb21haW4oZG9tYWluKTtpZihwYXJzZWREb21haW4pe3RoaXMuX2luaXRpYWxpemUocGFyc2VkRG9tYWluKTt9fSxzdGFydDpmdW5jdGlvbigpe3RoaXMuX3Bvc3RSZW5kZXIoKTtyZXR1cm4gUHJvbWlzZS5hbGwoW3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKSx0aGlzLl9yZW5kZXJDaGlsZHJlblRvKHRoaXMuJGNoaWxkcmVuQ29udGFpbmVyKV0pO30saXNWYWxpZDpmdW5jdGlvbigpe2Zvcih2YXIgaT0wO2k8dGhpcy5jaGlsZHJlbi5sZW5ndGg7aSsrKXt2YXIgY1ZhbGlkPXRoaXMuY2hpbGRyZW5baV0uaXNWYWxpZCgpO2lmKCFjVmFsaWQpe3JldHVybiBjVmFsaWQ7fX0KcmV0dXJuIHRoaXMuX2lzVmFsaWQ7fSxnZXREb21haW46ZnVuY3Rpb24oKXt2YXIgY2hpbGREb21haW5zPVtdO3ZhciBuYkNoaWxkcmVuPTA7Xy5lYWNoKHRoaXMuY2hpbGRyZW4sZnVuY3Rpb24oY2hpbGQpe3ZhciBjaGlsZERvbWFpbj1jaGlsZC5nZXREb21haW4oKTtpZihjaGlsZERvbWFpbi5sZW5ndGgpe25iQ2hpbGRyZW4rKztjaGlsZERvbWFpbnM9Y2hpbGREb21haW5zLmNvbmNhdChjaGlsZC5nZXREb21haW4oKSk7fX0pO3ZhciBuYkNoaWxkUmVxdWlyZWQ9dGhpcy5vcGVyYXRvcj09PSIhIj8xOjI7dmFyIG9wZXJhdG9ycz1fLnRpbWVzKG5iQ2hpbGRyZW4tbmJDaGlsZFJlcXVpcmVkKzEsXy5jb25zdGFudCh0aGlzLm9wZXJhdG9yKSk7cmV0dXJuIG9wZXJhdG9ycy5jb25jYXQoY2hpbGREb21haW5zKTt9LF9hZGRDaGlsZDpmdW5jdGlvbihkb21haW4sYWZ0ZXJOb2RlKXt2YXIgaT1hZnRlck5vZGU/Xy5pbmRleE9mKHRoaXMuY2hpbGRyZW4sYWZ0ZXJOb2RlKTp0aGlzLmNoaWxkcmVuLmxlbmd0aDtpZihpPDApcmV0dXJuIGZhbHNlO3RoaXMuY2hpbGRyZW4uc3BsaWNlKGkrMSwwLGluc3RhbnRpYXRlTm9kZSh0aGlzLHRoaXMubW9kZWwsZG9tYWluLHRoaXMub3B0aW9ucykpO3RoaXMudHJpZ2dlcl91cCgiZG9tYWluX2NoYW5nZWQiLHtjaGlsZDp0aGlzfSk7cmV0dXJuIHRydWU7fSxfYWRkRmxhdHRlbmVkQ2hpbGRyZW46ZnVuY3Rpb24oZG9tYWluKXt2YXIgbm9kZT1pbnN0YW50aWF0ZU5vZGUodGhpcyx0aGlzLm1vZGVsLGRvbWFpbix0aGlzLm9wdGlvbnMpO2lmKG5vZGU9PT1udWxsKXtyZXR1cm47fQppZighbm9kZS5jaGlsZHJlbnx8bm9kZS5vcGVyYXRvciE9PXRoaXMub3BlcmF0b3Ipe3RoaXMuY2hpbGRyZW4ucHVzaChub2RlKTtyZXR1cm47fQpfLmVhY2gobm9kZS5jaGlsZHJlbiwoZnVuY3Rpb24oY2hpbGQpe2NoaWxkLnNldFBhcmVudCh0aGlzKTt0aGlzLmNoaWxkcmVuLnB1c2goY2hpbGQpO30pLmJpbmQodGhpcykpO25vZGUuZGVzdHJveSgpO30sX2NoYW5nZU9wZXJhdG9yOmZ1bmN0aW9uKG9wZXJhdG9yLHNpbGVudCl7dGhpcy5vcGVyYXRvcj1vcGVyYXRvcjtpZighc2lsZW50KXRoaXMudHJpZ2dlcl91cCgiZG9tYWluX2NoYW5nZWQiLHtjaGlsZDp0aGlzfSk7fSxfaW5pdGlhbGl6ZTpmdW5jdGlvbihkb21haW4pe3RoaXMuX2lzVmFsaWQ9dHJ1ZTt0aGlzLm9wZXJhdG9yPWRvbWFpblswXTt0aGlzLmNoaWxkcmVuPVtdO2lmKGRvbWFpbi5sZW5ndGg8PTEpe3JldHVybjt9CnZhciBuYkxlYWZzVG9GaW5kPTE7Zm9yKHZhciBpPTE7aTxkb21haW4ubGVuZ3RoO2krKyl7aWYoZG9tYWluW2ldPT09IiYifHxkb21haW5baV09PT0ifCIpe25iTGVhZnNUb0ZpbmQrKzt9ZWxzZSBpZihkb21haW5baV0hPT0iISIpe25iTGVhZnNUb0ZpbmQtLTt9CmlmKCFuYkxlYWZzVG9GaW5kKXt2YXIgcGFydExlZnQ9ZG9tYWluLnNsaWNlKDEsaSsxKTt2YXIgcGFydFJpZ2h0PWRvbWFpbi5zbGljZShpKzEpO2lmKHBhcnRMZWZ0Lmxlbmd0aCl7dGhpcy5fYWRkRmxhdHRlbmVkQ2hpbGRyZW4ocGFydExlZnQpO30KaWYocGFydFJpZ2h0Lmxlbmd0aCl7dGhpcy5fYWRkRmxhdHRlbmVkQ2hpbGRyZW4ocGFydFJpZ2h0KTt9CmJyZWFrO319CnRoaXMuX2lzVmFsaWQ9KG5iTGVhZnNUb0ZpbmQ9PT0wKTtpZih0aGlzLm9wZXJhdG9yPT09IiEiKXt0aGlzLmNoaWxkcmVuWzBdLm5vQ29udHJvbFBhbmVsPXRydWU7fX0sX3Bvc3RSZW5kZXI6ZnVuY3Rpb24oKXt0aGlzLiRjaGlsZHJlbkNvbnRhaW5lcj10aGlzLiQoIj4gLm9fZG9tYWluX25vZGVfY2hpbGRyZW5fY29udGFpbmVyIik7fSxfcmVtb3ZlQ2hpbGQ6ZnVuY3Rpb24ob2xkQ2hpbGQpe3ZhciBpPV8uaW5kZXhPZih0aGlzLmNoaWxkcmVuLG9sZENoaWxkKTtpZihpPDApcmV0dXJuIGZhbHNlO3RoaXMuY2hpbGRyZW5baV0uZGVzdHJveSgpO3RoaXMuY2hpbGRyZW4uc3BsaWNlKGksMSk7dGhpcy50cmlnZ2VyX3VwKCJkb21haW5fY2hhbmdlZCIse2NoaWxkOnRoaXN9KTtyZXR1cm4gdHJ1ZTt9LF9yZW5kZXJDaGlsZHJlblRvOmZ1bmN0aW9uKCR0byl7dmFyICRkaXY9JCgiPGRpdi8+Iik7cmV0dXJuIFByb21pc2UuYWxsKF8ubWFwKHRoaXMuY2hpbGRyZW4sKGZ1bmN0aW9uKGNoaWxkKXtyZXR1cm4gY2hpbGQuYXBwZW5kVG8oJGRpdik7fSkuYmluZCh0aGlzKSkpLnRoZW4oKGZ1bmN0aW9uKCl7Xy5lYWNoKHRoaXMuY2hpbGRyZW4sZnVuY3Rpb24oY2hpbGQpe2NoaWxkLiRlbC5hcHBlbmRUbygkdG8pO30pO30pLmJpbmQodGhpcykpO30sX3BhcnNlRG9tYWluOmZ1bmN0aW9uKGRvbWFpbil7dmFyIHBhcnNlZERvbWFpbj1mYWxzZTt0cnl7cGFyc2VkRG9tYWluPURvbWFpbi5wcm90b3R5cGUuc3RyaW5nVG9BcnJheShkb21haW4pO3RoaXMuaW52YWxpZERvbWFpbj1mYWxzZTt9Y2F0Y2goZXJyKXt0aGlzLmludmFsaWREb21haW49dHJ1ZTt0aGlzLmNoaWxkcmVuPVtdO30KcmV0dXJuIHBhcnNlZERvbWFpbjt9LF9vbk9wZXJhdG9yQ2hhbmdlOmZ1bmN0aW9uKGUpe2UucHJldmVudERlZmF1bHQoKTtlLnN0b3BQcm9wYWdhdGlvbigpO3RoaXMuX2NoYW5nZU9wZXJhdG9yKCQoZS50YXJnZXQpLmRhdGEoIm9wZXJhdG9yIikpO30sX29uTm9kZUFkZGl0aW9uQXNrOmZ1bmN0aW9uKGUpe3ZhciBkb21haW49dGhpcy5vcHRpb25zLmRlZmF1bHR8fFtbImlkIiwiPSIsMV1dO2lmKGUuZGF0YS5uZXdCcmFuY2gpe2RvbWFpbj1bdGhpcy5vcGVyYXRvcj09PSImIj8ifCI6IiYiXS5jb25jYXQoZG9tYWluKS5jb25jYXQoZG9tYWluKTt9CmlmKHRoaXMuX2FkZENoaWxkKGRvbWFpbixlLmRhdGEuY2hpbGQpKXtlLnN0b3BQcm9wYWdhdGlvbigpO319LF9vbk5vZGVEZWxldGlvbkFzazpmdW5jdGlvbihlKXtpZih0aGlzLl9yZW1vdmVDaGlsZChlLmRhdGEuY2hpbGQpKXtlLnN0b3BQcm9wYWdhdGlvbigpO319LH0pO3ZhciBEb21haW5TZWxlY3Rvcj1Eb21haW5UcmVlLmV4dGVuZCh7dGVtcGxhdGU6IkRvbWFpblNlbGVjdG9yIixldmVudHM6Xy5leHRlbmQoe30sRG9tYWluVHJlZS5wcm90b3R5cGUuZXZlbnRzLHsiY2xpY2sgLm9fZG9tYWluX2FkZF9maXJzdF9ub2RlX2J1dHRvbiI6Il9vbkFkZEZpcnN0QnV0dG9uQ2xpY2siLCJjaGFuZ2UgLm9fZG9tYWluX2RlYnVnX2lucHV0IjoiX29uRGVidWdJbnB1dENoYW5nZSIsfSksY3VzdG9tX2V2ZW50czpfLmV4dGVuZCh7fSxEb21haW5UcmVlLnByb3RvdHlwZS5jdXN0b21fZXZlbnRzLHtkb21haW5fY2hhbmdlZDoiX29uRG9tYWluQ2hhbmdlIix9KSxzdGFydDpmdW5jdGlvbigpe3ZhciBzZWxmPXRoaXM7cmV0dXJuIHRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKS50aGVuKGZ1bmN0aW9uKCl7aWYoc2VsZi5pbnZhbGlkRG9tYWluKXt2YXIgbXNnPV90KCJUaGlzIGRvbWFpbiBpcyBub3Qgc3VwcG9ydGVkLiIpO3NlbGYuJGVsLmh0bWwobXNnKTt9fSk7fSxzZXREb21haW46ZnVuY3Rpb24oZG9tYWluKXtpZihkb21haW49PT1Eb21haW4ucHJvdG90eXBlLmFycmF5VG9TdHJpbmcodGhpcy5nZXREb21haW4oKSkpe3JldHVybiBQcm9taXNlLnJlc29sdmUoKTt9CnZhciBwYXJzZWREb21haW49dGhpcy5fcGFyc2VEb21haW4oZG9tYWluKTtpZihwYXJzZWREb21haW4pe3JldHVybiB0aGlzLl9yZWRyYXcocGFyc2VkRG9tYWluKTt9fSxfaW5pdGlhbGl6ZTpmdW5jdGlvbihkb21haW4pe2lmKGRvbWFpbi5sZW5ndGg+MSl7RG9tYWluLnByb3RvdHlwZS5ub3JtYWxpemVBcnJheShkb21haW4pO31lbHNle2RvbWFpbj1bIiYiXS5jb25jYXQoZG9tYWluKTt9CnJldHVybiB0aGlzLl9zdXBlcihkb21haW4pO30sX3Bvc3RSZW5kZXI6ZnVuY3Rpb24oKXt0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy4kZGVidWdJbnB1dD10aGlzLiQoIi5vX2RvbWFpbl9kZWJ1Z19pbnB1dCIpO2lmKHRoaXMuJGRlYnVnSW5wdXQubGVuZ3RoKXt0aGlzLiRkZWJ1Z0lucHV0LnZhbChEb21haW4ucHJvdG90eXBlLmFycmF5VG9TdHJpbmcodGhpcy5nZXREb21haW4oKSkpO30KaWYoIXRoaXMuX2lzVmFsaWQpe3RoaXMuZG9fd2FybihfdCgiRG9tYWluIGVycm9yIiksX3QoIlRoZSBkb21haW4geW91IGVudGVyZWQgaXMgbm90IHByb3Blcmx5IGZvcm1lZCIpKTt9fSxfcmVkcmF3OmZ1bmN0aW9uKGRvbWFpbil7dmFyIG9sZENoaWxkcmVuPXRoaXMuY2hpbGRyZW4uc2xpY2UoKTt0aGlzLl9pbml0aWFsaXplKGRvbWFpbnx8dGhpcy5nZXREb21haW4oKSk7cmV0dXJuIHRoaXMuX3JlbmRlckNoaWxkcmVuVG8oJCgiPGRpdi8+IikpLnRoZW4oKGZ1bmN0aW9uKCl7Xy5lYWNoKG9sZENoaWxkcmVuLGZ1bmN0aW9uKGNoaWxkKXtjaGlsZC5kZXN0cm95KCk7fSk7dGhpcy5yZW5kZXJFbGVtZW50KCk7dGhpcy5fcG9zdFJlbmRlcigpO18uZWFjaCh0aGlzLmNoaWxkcmVuLChmdW5jdGlvbihjaGlsZCl7Y2hpbGQuJGVsLmFwcGVuZFRvKHRoaXMuJGNoaWxkcmVuQ29udGFpbmVyKTt9KS5iaW5kKHRoaXMpKTt9KS5iaW5kKHRoaXMpKTt9LF9vbkFkZEZpcnN0QnV0dG9uQ2xpY2s6ZnVuY3Rpb24oKXt0aGlzLl9hZGRDaGlsZCh0aGlzLm9wdGlvbnMuZGVmYXVsdHx8W1siaWQiLCI9IiwxXV0pO30sX29uRGVidWdJbnB1dENoYW5nZTpmdW5jdGlvbihlKXt2YXIgZG9tYWluO3RyeXtkb21haW49RG9tYWluLnByb3RvdHlwZS5zdHJpbmdUb0FycmF5KCQoZS5jdXJyZW50VGFyZ2V0KS52YWwoKSk7fWNhdGNoKGVycil7dGhpcy5kb193YXJuKF90KCJTeW50YXggZXJyb3IiKSxfdCgiVGhlIGRvbWFpbiB5b3UgZW50ZXJlZCBpcyBub3QgcHJvcGVybHkgZm9ybWVkIikpO3JldHVybjt9CnRoaXMuX3JlZHJhdyhkb21haW4pLnRoZW4oKGZ1bmN0aW9uKCl7dGhpcy50cmlnZ2VyX3VwKCJkb21haW5fY2hhbmdlZCIse2NoaWxkOnRoaXMsYWxyZWFkeVJlZHJhd246dHJ1ZX0pO30pLmJpbmQodGhpcykpO30sX29uRG9tYWluQ2hhbmdlOmZ1bmN0aW9uKGUpe2lmKCFlLmRhdGEuYWxyZWFkeVJlZHJhd24pe3RoaXMuX3JlZHJhdygpO319LH0pO3ZhciBEb21haW5MZWFmPURvbWFpbk5vZGUuZXh0ZW5kKHt0ZW1wbGF0ZToiRG9tYWluTGVhZiIsZXZlbnRzOl8uZXh0ZW5kKHt9LERvbWFpbk5vZGUucHJvdG90eXBlLmV2ZW50cyx7ImNoYW5nZSAub19kb21haW5fbGVhZl9vcGVyYXRvcl9zZWxlY3QiOiJfb25PcGVyYXRvclNlbGVjdENoYW5nZSIsImNoYW5nZSAub19kb21haW5fbGVhZl92YWx1ZV9pbnB1dCI6Il9vblZhbHVlSW5wdXRDaGFuZ2UiLCJjbGljayAub19kb21haW5fbGVhZl92YWx1ZV9hZGRfdGFnX2J1dHRvbiI6Im9uX2FkZF90YWciLCJrZXl1cCAub19kb21haW5fbGVhZl92YWx1ZV90YWdzIGlucHV0Ijoib25fYWRkX3RhZyIsImNsaWNrIC5vX2RvbWFpbl9sZWFmX3ZhbHVlX3JlbW92ZV90YWdfYnV0dG9uIjoib25fcmVtb3ZlX3RhZyIsfSksY3VzdG9tX2V2ZW50czp7ImZpZWxkX2NoYWluX2NoYW5nZWQiOiJfb25GaWVsZENoYWluQ2hhbmdlIix9LGluaXQ6ZnVuY3Rpb24ocGFyZW50LG1vZGVsLGRvbWFpbixvcHRpb25zKXt0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dmFyIGN1cnJlbnREb21haW49RG9tYWluLnByb3RvdHlwZS5zdHJpbmdUb0FycmF5KGRvbWFpbik7dGhpcy5jaGFpbj1jdXJyZW50RG9tYWluWzBdWzBdO3RoaXMub3BlcmF0b3I9Y3VycmVudERvbWFpblswXVsxXTt0aGlzLnZhbHVlPWN1cnJlbnREb21haW5bMF1bMl07dGhpcy5vcGVyYXRvcl9tYXBwaW5nPW9wZXJhdG9yX21hcHBpbmc7fSx3aWxsU3RhcnQ6ZnVuY3Rpb24oKXt2YXIgZGVmcz1bdGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpXTt0aGlzLmZpZWxkU2VsZWN0b3I9bmV3IE1vZGVsRmllbGRTZWxlY3Rvcih0aGlzLHRoaXMubW9kZWwsdGhpcy5jaGFpbiE9PXVuZGVmaW5lZD90aGlzLmNoYWluLnRvU3RyaW5nKCkuc3BsaXQoIi4iKTpbXSx0aGlzLm9wdGlvbnMpO2RlZnMucHVzaCh0aGlzLmZpZWxkU2VsZWN0b3IuYXBwZW5kVG8oJCgiPGRpdi8+IikpLnRoZW4oKGZ1bmN0aW9uKCl7dmFyIHdEZWZzPVtdO2lmKCF0aGlzLnJlYWRvbmx5KXt2YXIgc2VsZWN0ZWRGaWVsZD10aGlzLmZpZWxkU2VsZWN0b3IuZ2V0U2VsZWN0ZWRGaWVsZCgpfHx7fTt0aGlzLm9wZXJhdG9ycz10aGlzLl9nZXRPcGVyYXRvcnNGcm9tVHlwZShzZWxlY3RlZEZpZWxkLnR5cGUpO2lmKF8uY29udGFpbnMoWyJjaGlsZF9vZiIsInBhcmVudF9vZiIsImxpa2UiLCJub3QgbGlrZSIsIj1saWtlIiwiPWlsaWtlIl0sdGhpcy5vcGVyYXRvcikpe3RoaXMub3BlcmF0b3JzW3RoaXMub3BlcmF0b3JdPW9wZXJhdG9yX21hcHBpbmdbdGhpcy5vcGVyYXRvcl07fWVsc2UgaWYoIXRoaXMub3BlcmF0b3JzW3RoaXMub3BlcmF0b3JdKXt0aGlzLm9wZXJhdG9yc1t0aGlzLm9wZXJhdG9yXT0iPyI7fQp0aGlzLnNlbGVjdGlvbkNob2ljZXM9bnVsbDtpZihzZWxlY3RlZEZpZWxkLnR5cGU9PT0iYm9vbGVhbiIpe3RoaXMuc2VsZWN0aW9uQ2hvaWNlcz1bWyIxIixfdCgic2V0ICh0cnVlKSIpXSxbIjAiLF90KCJub3Qgc2V0IChmYWxzZSkiKV1dO31lbHNlIGlmKHNlbGVjdGVkRmllbGQudHlwZT09PSJzZWxlY3Rpb24iKXt0aGlzLnNlbGVjdGlvbkNob2ljZXM9c2VsZWN0ZWRGaWVsZC5zZWxlY3Rpb247fQp0aGlzLmRpc3BsYXlWYWx1ZT10aGlzLnZhbHVlO3RyeXtpZihzZWxlY3RlZEZpZWxkJiYhc2VsZWN0ZWRGaWVsZC5yZWxhdGlvbiYmIV8uaXNBcnJheSh0aGlzLnZhbHVlKSl7dGhpcy5kaXNwbGF5VmFsdWU9ZmllbGRfdXRpbHMuZm9ybWF0W3NlbGVjdGVkRmllbGQudHlwZV0odGhpcy52YWx1ZSxzZWxlY3RlZEZpZWxkKTt9fWNhdGNoKGVycil7fQp0aGlzLmRpc3BsYXlPcGVyYXRvcj10aGlzLm9wZXJhdG9yO2lmKHNlbGVjdGVkRmllbGQudHlwZT09PSJib29sZWFuIil7dGhpcy5kaXNwbGF5VmFsdWU9dGhpcy52YWx1ZT8iMSI6IjAiO31lbHNlIGlmKCh0aGlzLm9wZXJhdG9yPT09IiE9Inx8dGhpcy5vcGVyYXRvcj09PSI9IikmJnRoaXMudmFsdWU9PT1mYWxzZSl7dGhpcy5kaXNwbGF5T3BlcmF0b3I9dGhpcy5vcGVyYXRvcj09PSIhPSI/InNldCI6Im5vdCBzZXQiO30KaWYoXy5jb250YWlucyhbImRhdGUiLCJkYXRldGltZSJdLHNlbGVjdGVkRmllbGQudHlwZSkpe3RoaXMudmFsdWVXaWRnZXQ9bmV3KHNlbGVjdGVkRmllbGQudHlwZT09PSJkYXRldGltZSI/ZGF0ZXBpY2tlci5EYXRlVGltZVdpZGdldDpkYXRlcGlja2VyLkRhdGVXaWRnZXQpKHRoaXMpO3dEZWZzLnB1c2godGhpcy52YWx1ZVdpZGdldC5hcHBlbmRUbygiPGRpdi8+IikudGhlbigoZnVuY3Rpb24oKXt0aGlzLnZhbHVlV2lkZ2V0LiRlbC5hZGRDbGFzcygib19kb21haW5fbGVhZl92YWx1ZV9pbnB1dCIpO3RoaXMudmFsdWVXaWRnZXQuc2V0VmFsdWUobW9tZW50KHRoaXMudmFsdWUpKTt0aGlzLnZhbHVlV2lkZ2V0Lm9uKCJkYXRldGltZV9jaGFuZ2VkIix0aGlzLGZ1bmN0aW9uKCl7dGhpcy5fY2hhbmdlVmFsdWUodGhpcy52YWx1ZVdpZGdldC5nZXRWYWx1ZSgpKTt9KTt9KS5iaW5kKHRoaXMpKSk7fQpyZXR1cm4gUHJvbWlzZS5hbGwod0RlZnMpO319KS5iaW5kKHRoaXMpKSk7cmV0dXJuIFByb21pc2UuYWxsKGRlZnMpO30sc3RhcnQ6ZnVuY3Rpb24oKXt0aGlzLmZpZWxkU2VsZWN0b3IuJGVsLnByZXBlbmRUbyh0aGlzLiQoIj4gLm9fZG9tYWluX2xlYWZfaW5mbywgPiAub19kb21haW5fbGVhZl9lZGl0aW9uIikpO2lmKCF0aGlzLnJlYWRvbmx5JiZ0aGlzLnZhbHVlV2lkZ2V0KXt0aGlzLiQoIi5vX2RvbWFpbl9sZWFmX3ZhbHVlX2lucHV0IikucmVwbGFjZVdpdGgodGhpcy52YWx1ZVdpZGdldC4kZWwpO30KcmV0dXJuIHRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9LGlzVmFsaWQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5maWVsZFNlbGVjdG9yJiZ0aGlzLmZpZWxkU2VsZWN0b3IuaXNWYWxpZCgpO30sZ2V0RG9tYWluOmZ1bmN0aW9uKCl7cmV0dXJuW1t0aGlzLmNoYWluLHRoaXMub3BlcmF0b3IsdGhpcy52YWx1ZV1dO30sX2NoYW5nZUZpZWxkQ2hhaW46ZnVuY3Rpb24oY2hhaW4sc2lsZW50KXt0aGlzLmNoYWluPWNoYWluLmpvaW4oIi4iKTt0aGlzLmZpZWxkU2VsZWN0b3Iuc2V0Q2hhaW4oY2hhaW4pLnRoZW4oKGZ1bmN0aW9uKCl7aWYoIXRoaXMuZmllbGRTZWxlY3Rvci5pc1ZhbGlkKCkpcmV0dXJuO3ZhciBzZWxlY3RlZEZpZWxkPXRoaXMuZmllbGRTZWxlY3Rvci5nZXRTZWxlY3RlZEZpZWxkKCl8fHt9O3ZhciBvcGVyYXRvcnM9dGhpcy5fZ2V0T3BlcmF0b3JzRnJvbVR5cGUoc2VsZWN0ZWRGaWVsZC50eXBlKTtpZihvcGVyYXRvcnNbdGhpcy5vcGVyYXRvcl09PT11bmRlZmluZWQpe3RoaXMuX2NoYW5nZU9wZXJhdG9yKCI9Iix0cnVlKTt9CnRoaXMuX2NoYW5nZVZhbHVlKHRoaXMudmFsdWUsdHJ1ZSk7aWYoIXNpbGVudCl0aGlzLnRyaWdnZXJfdXAoImRvbWFpbl9jaGFuZ2VkIix7Y2hpbGQ6dGhpc30pO30pLmJpbmQodGhpcykpO30sX2NoYW5nZU9wZXJhdG9yOmZ1bmN0aW9uKG9wZXJhdG9yLHNpbGVudCl7dGhpcy5vcGVyYXRvcj1vcGVyYXRvcjtpZihfLmNvbnRhaW5zKFsic2V0Iiwibm90IHNldCJdLHRoaXMub3BlcmF0b3IpKXt0aGlzLm9wZXJhdG9yPXRoaXMub3BlcmF0b3I9PT0ibm90IHNldCI/Ij0iOiIhPSI7dGhpcy52YWx1ZT1mYWxzZTt9ZWxzZSBpZihfLmNvbnRhaW5zKFsiaW4iLCJub3QgaW4iXSx0aGlzLm9wZXJhdG9yKSl7dGhpcy52YWx1ZT1fLmlzQXJyYXkodGhpcy52YWx1ZSk/dGhpcy52YWx1ZTp0aGlzLnZhbHVlPygiIit0aGlzLnZhbHVlKS5zcGxpdCgiLCIpOltdO31lbHNle2lmKF8uaXNBcnJheSh0aGlzLnZhbHVlKSl7dGhpcy52YWx1ZT10aGlzLnZhbHVlLmpvaW4oIiwiKTt9CnRoaXMuX2NoYW5nZVZhbHVlKHRoaXMudmFsdWUsdHJ1ZSk7fQppZighc2lsZW50KXRoaXMudHJpZ2dlcl91cCgiZG9tYWluX2NoYW5nZWQiLHtjaGlsZDp0aGlzfSk7fSxfY2hhbmdlVmFsdWU6ZnVuY3Rpb24odmFsdWUsc2lsZW50KXt2YXIgY291bGROb3RQYXJzZT1mYWxzZTt2YXIgc2VsZWN0ZWRGaWVsZD10aGlzLmZpZWxkU2VsZWN0b3IuZ2V0U2VsZWN0ZWRGaWVsZCgpfHx7fTt0cnl7dGhpcy52YWx1ZT1maWVsZF91dGlscy5wYXJzZVtzZWxlY3RlZEZpZWxkLnR5cGVdKHZhbHVlLHNlbGVjdGVkRmllbGQpO31jYXRjaChlcnIpe3RoaXMudmFsdWU9dmFsdWU7Y291bGROb3RQYXJzZT10cnVlO30KaWYoc2VsZWN0ZWRGaWVsZC50eXBlPT09ImJvb2xlYW4iKXtpZighXy5pc0Jvb2xlYW4odGhpcy52YWx1ZSkpe3RoaXMudmFsdWU9ISFwYXJzZUZsb2F0KHRoaXMudmFsdWUpO319ZWxzZSBpZihzZWxlY3RlZEZpZWxkLnR5cGU9PT0ic2VsZWN0aW9uIil7aWYoIV8uc29tZShzZWxlY3RlZEZpZWxkLnNlbGVjdGlvbiwoZnVuY3Rpb24ob3B0aW9uKXtyZXR1cm4gb3B0aW9uWzBdPT09dGhpcy52YWx1ZTt9KS5iaW5kKHRoaXMpKSl7dGhpcy52YWx1ZT1zZWxlY3RlZEZpZWxkLnNlbGVjdGlvblswXVswXTt9fWVsc2UgaWYoXy5jb250YWlucyhbImRhdGUiLCJkYXRldGltZSJdLHNlbGVjdGVkRmllbGQudHlwZSkpe2lmKGNvdWxkTm90UGFyc2V8fF8uaXNCb29sZWFuKHRoaXMudmFsdWUpKXt0aGlzLnZhbHVlPWZpZWxkX3V0aWxzLnBhcnNlW3NlbGVjdGVkRmllbGQudHlwZV0oZmllbGRfdXRpbHMuZm9ybWF0W3NlbGVjdGVkRmllbGQudHlwZV0obW9tZW50KCkpKS50b0pTT04oKTt9ZWxzZXt0aGlzLnZhbHVlPXRoaXMudmFsdWUudG9KU09OKCk7fX1lbHNle2lmKF8uaXNCb29sZWFuKHRoaXMudmFsdWUpKXt0aGlzLnZhbHVlPSIiO31lbHNlIGlmKF8uaXNPYmplY3QodGhpcy52YWx1ZSkmJiFfLmlzQXJyYXkodGhpcy52YWx1ZSkpe3RoaXMudmFsdWU9dGhpcy52YWx1ZS5pZHx8dmFsdWV8fCIiO319CmlmKCFzaWxlbnQpdGhpcy50cmlnZ2VyX3VwKCJkb21haW5fY2hhbmdlZCIse2NoaWxkOnRoaXN9KTt9LF9nZXRPcGVyYXRvcnNGcm9tVHlwZTpmdW5jdGlvbih0eXBlKXt2YXIgb3BlcmF0b3JzPXt9O3N3aXRjaCh0eXBlKXtjYXNlImJvb2xlYW4iOm9wZXJhdG9ycz17Ij0iOl90KCJpcyIpLCIhPSI6X3QoImlzIG5vdCIpLH07YnJlYWs7Y2FzZSJjaGFyIjpjYXNlInRleHQiOmNhc2UiaHRtbCI6b3BlcmF0b3JzPV8ucGljayhvcGVyYXRvcl9tYXBwaW5nLCI9IiwiIT0iLCJpbGlrZSIsIm5vdCBpbGlrZSIsInNldCIsIm5vdCBzZXQiLCJpbiIsIm5vdCBpbiIpO2JyZWFrO2Nhc2UibWFueTJtYW55IjpjYXNlIm9uZTJtYW55IjpjYXNlIm1hbnkyb25lIjpvcGVyYXRvcnM9Xy5waWNrKG9wZXJhdG9yX21hcHBpbmcsIj0iLCIhPSIsImlsaWtlIiwibm90IGlsaWtlIiwic2V0Iiwibm90IHNldCIpO2JyZWFrO2Nhc2UiaW50ZWdlciI6Y2FzZSJmbG9hdCI6Y2FzZSJtb25ldGFyeSI6b3BlcmF0b3JzPV8ucGljayhvcGVyYXRvcl9tYXBwaW5nLCI9IiwiIT0iLCI+IiwiPCIsIj49IiwiPD0iLCJpbGlrZSIsIm5vdCBpbGlrZSIsInNldCIsIm5vdCBzZXQiKTticmVhaztjYXNlInNlbGVjdGlvbiI6b3BlcmF0b3JzPV8ucGljayhvcGVyYXRvcl9tYXBwaW5nLCI9IiwiIT0iLCJzZXQiLCJub3Qgc2V0Iik7YnJlYWs7Y2FzZSJkYXRlIjpjYXNlImRhdGV0aW1lIjpvcGVyYXRvcnM9Xy5waWNrKG9wZXJhdG9yX21hcHBpbmcsIj0iLCIhPSIsIj4iLCI8IiwiPj0iLCI8PSIsInNldCIsIm5vdCBzZXQiKTticmVhaztkZWZhdWx0Om9wZXJhdG9ycz1fLmV4dGVuZCh7fSxvcGVyYXRvcl9tYXBwaW5nKTticmVhazt9CmlmKHRoaXMub3B0aW9ucy5vcGVyYXRvcnMpe29wZXJhdG9ycz1fLnBpY2suYXBwbHkoXyxbb3BlcmF0b3JzXS5jb25jYXQodGhpcy5vcHRpb25zLm9wZXJhdG9ycykpO30KcmV0dXJuIG9wZXJhdG9yczt9LF9vbk9wZXJhdG9yU2VsZWN0Q2hhbmdlOmZ1bmN0aW9uKGUpe3RoaXMuX2NoYW5nZU9wZXJhdG9yKCQoZS5jdXJyZW50VGFyZ2V0KS52YWwoKSk7fSxfb25WYWx1ZUlucHV0Q2hhbmdlOmZ1bmN0aW9uKGUpe2lmKGUuY3VycmVudFRhcmdldCE9PWUudGFyZ2V0KXJldHVybjt0aGlzLl9jaGFuZ2VWYWx1ZSgkKGUuY3VycmVudFRhcmdldCkudmFsKCkpO30sX29uRmllbGRDaGFpbkNoYW5nZTpmdW5jdGlvbihlKXt0aGlzLl9jaGFuZ2VGaWVsZENoYWluKGUuZGF0YS5jaGFpbik7fSxvbl9hZGRfdGFnOmZ1bmN0aW9uKGUpe2lmKGUudHlwZT09PSJrZXl1cCImJmUud2hpY2ghPT0kLnVpLmtleUNvZGUuRU5URVIpcmV0dXJuO2lmKCFfLmNvbnRhaW5zKFsibm90IGluIiwiaW4iXSx0aGlzLm9wZXJhdG9yKSlyZXR1cm47dmFyIHZhbHVlcz1fLmlzQXJyYXkodGhpcy52YWx1ZSk/dGhpcy52YWx1ZS5zbGljZSgpOltdO3ZhciAkaW5wdXQ9dGhpcy4kKCIub19kb21haW5fbGVhZl92YWx1ZV90YWdzIGlucHV0Iik7dmFyIHZhbD0kaW5wdXQudmFsKCkudHJpbSgpO2lmKHZhbCYmdmFsdWVzLmluZGV4T2YodmFsKTwwKXt2YWx1ZXMucHVzaCh2YWwpO18uZGVmZXIodGhpcy5fY2hhbmdlVmFsdWUuYmluZCh0aGlzLHZhbHVlcykpOyRpbnB1dC5mb2N1cygpO319LG9uX3JlbW92ZV90YWc6ZnVuY3Rpb24oZSl7dmFyIHZhbHVlcz1fLmlzQXJyYXkodGhpcy52YWx1ZSk/dGhpcy52YWx1ZS5zbGljZSgpOltdO3ZhciB2YWw9dGhpcy4kKGUuY3VycmVudFRhcmdldCkuZGF0YSgidmFsdWUiKTt2YXIgaW5kZXg9dmFsdWVzLmluZGV4T2YodmFsKTtpZihpbmRleD49MCl7dmFsdWVzLnNwbGljZShpbmRleCwxKTtfLmRlZmVyKHRoaXMuX2NoYW5nZVZhbHVlLmJpbmQodGhpcyx2YWx1ZXMpKTt9fSx9KTtmdW5jdGlvbiBpbnN0YW50aWF0ZU5vZGUocGFyZW50LG1vZGVsLGRvbWFpbixvcHRpb25zKXtpZihkb21haW4ubGVuZ3RoPjEpe3JldHVybiBuZXcgRG9tYWluVHJlZShwYXJlbnQsbW9kZWwsZG9tYWluLG9wdGlvbnMpO31lbHNlIGlmKGRvbWFpbi5sZW5ndGg9PT0xKXtyZXR1cm4gbmV3IERvbWFpbkxlYWYocGFyZW50LG1vZGVsLGRvbWFpbixvcHRpb25zKTt9CnJldHVybiBudWxsO30KcmV0dXJuIERvbWFpblNlbGVjdG9yO30pOzsKCi8qIC93ZWIvc3RhdGljL3NyYy9qcy93aWRnZXRzL2lmcmFtZV93aWRnZXQuanMgZGVmaW5lZCBpbiBidW5kbGUgJ3dlYi5hc3NldHNfYmFja2VuZCcgKi8Kb2Rvby5kZWZpbmUoJ3dlYi5JRnJhbWVXaWRnZXQnLGZ1bmN0aW9uKHJlcXVpcmUpeyJ1c2Ugc3RyaWN0Ijt2YXIgV2lkZ2V0PXJlcXVpcmUoJ3dlYi5XaWRnZXQnKTt2YXIgSUZyYW1lV2lkZ2V0PVdpZGdldC5leHRlbmQoe3RhZ05hbWU6J2lmcmFtZScsaW5pdDpmdW5jdGlvbihwYXJlbnQsdXJsKXt0aGlzLl9zdXBlcihwYXJlbnQpO3RoaXMudXJsPXVybDt9LHN0YXJ0OmZ1bmN0aW9uKCl7dGhpcy4kZWwuY3NzKHtoZWlnaHQ6JzEwMCUnLHdpZHRoOicxMDAlJyxib3JkZXI6MH0pO3RoaXMuJGVsLmF0dHIoe3NyYzp0aGlzLnVybH0pO3RoaXMuJGVsLm9uKCJsb2FkIix0aGlzLl9iaW5kRXZlbnRzLmJpbmQodGhpcykpO3JldHVybiB0aGlzLl9zdXBlcigpO30sX2JpbmRFdmVudHM6ZnVuY3Rpb24oKXt0aGlzLiRlbC5jb250ZW50cygpLmNsaWNrKHRoaXMuX29uSUZyYW1lQ2xpY2tlZC5iaW5kKHRoaXMpKTt9LF9vbklGcmFtZUNsaWNrZWQ6ZnVuY3Rpb24oZXZlbnQpe319KTtyZXR1cm4gSUZyYW1lV2lkZ2V0O30pOzsKCi8qIC93ZWIvc3RhdGljL3NyYy9qcy9jaHJvbWUvbG9hZGluZy5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwpvZG9vLmRlZmluZSgnd2ViLkxvYWRpbmcnLGZ1bmN0aW9uKHJlcXVpcmUpeyJ1c2Ugc3RyaWN0Ijt2YXIgY29uZmlnPXJlcXVpcmUoJ3dlYi5jb25maWcnKTt2YXIgY29yZT1yZXF1aXJlKCd3ZWIuY29yZScpO3ZhciBmcmFtZXdvcms9cmVxdWlyZSgnd2ViLmZyYW1ld29yaycpO3ZhciBXaWRnZXQ9cmVxdWlyZSgnd2ViLldpZGdldCcpO3ZhciBfdD1jb3JlLl90O3ZhciBMb2FkaW5nPVdpZGdldC5leHRlbmQoe3RlbXBsYXRlOiJMb2FkaW5nIixpbml0OmZ1bmN0aW9uKHBhcmVudCl7dGhpcy5fc3VwZXIocGFyZW50KTt0aGlzLmNvdW50PTA7dGhpcy5ibG9ja2VkX3VpPWZhbHNlO30sc3RhcnQ6ZnVuY3Rpb24oKXtjb3JlLmJ1cy5vbigncnBjX3JlcXVlc3QnLHRoaXMsdGhpcy5yZXF1ZXN0X2NhbGwpO2NvcmUuYnVzLm9uKCJycGNfcmVzcG9uc2UiLHRoaXMsdGhpcy5yZXNwb25zZV9jYWxsKTtjb3JlLmJ1cy5vbigicnBjX3Jlc3BvbnNlX2ZhaWxlZCIsdGhpcyx0aGlzLnJlc3BvbnNlX2NhbGwpO30sZGVzdHJveTpmdW5jdGlvbigpe3RoaXMub25fcnBjX2V2ZW50KC10aGlzLmNvdW50KTt0aGlzLl9zdXBlcigpO30scmVxdWVzdF9jYWxsOmZ1bmN0aW9uKCl7dGhpcy5vbl9ycGNfZXZlbnQoMSk7fSxyZXNwb25zZV9jYWxsOmZ1bmN0aW9uKCl7dGhpcy5vbl9ycGNfZXZlbnQoLTEpO30sb25fcnBjX2V2ZW50OmZ1bmN0aW9uKGluY3JlbWVudCl7dmFyIHNlbGY9dGhpcztpZighdGhpcy5jb3VudCYmaW5jcmVtZW50PT09MSl7dGhpcy5sb25nX3J1bm5pbmdfdGltZXI9c2V0VGltZW91dChmdW5jdGlvbigpe3NlbGYuYmxvY2tlZF91aT10cnVlO2ZyYW1ld29yay5ibG9ja1VJKCk7fSwzMDAwKTt9CnRoaXMuY291bnQrPWluY3JlbWVudDtpZih0aGlzLmNvdW50PjApe2lmKGNvbmZpZy5pc0RlYnVnKCkpe3RoaXMuJGVsLnRleHQoXy5zdHIuc3ByaW50ZihfdCgiTG9hZGluZyAoJWQpIiksdGhpcy5jb3VudCkpO31lbHNle3RoaXMuJGVsLnRleHQoX3QoIkxvYWRpbmciKSk7fQp0aGlzLiRlbC5zaG93KCk7dGhpcy5nZXRQYXJlbnQoKS4kZWwuYWRkQ2xhc3MoJ29lX3dhaXQnKTt9ZWxzZXt0aGlzLmNvdW50PTA7Y2xlYXJUaW1lb3V0KHRoaXMubG9uZ19ydW5uaW5nX3RpbWVyKTtpZihzZWxmLmJsb2NrZWRfdWkpe3RoaXMuYmxvY2tlZF91aT1mYWxzZTtmcmFtZXdvcmsudW5ibG9ja1VJKCk7fQp0aGlzLiRlbC5mYWRlT3V0KCk7dGhpcy5nZXRQYXJlbnQoKS4kZWwucmVtb3ZlQ2xhc3MoJ29lX3dhaXQnKTt9fX0pO3JldHVybiBMb2FkaW5nO30pOzsKCi8qIC93ZWIvc3RhdGljL3NyYy9qcy93aWRnZXRzL21vZGVsX2ZpZWxkX3NlbGVjdG9yLmpzIGRlZmluZWQgaW4gYnVuZGxlICd3ZWIuYXNzZXRzX2JhY2tlbmQnICovCm9kb28uZGVmaW5lKCJ3ZWIuTW9kZWxGaWVsZFNlbGVjdG9yIixmdW5jdGlvbihyZXF1aXJlKXsidXNlIHN0cmljdCI7dmFyIGNvcmU9cmVxdWlyZSgid2ViLmNvcmUiKTt2YXIgV2lkZ2V0PXJlcXVpcmUoIndlYi5XaWRnZXQiKTt2YXIgX3Q9Y29yZS5fdDt2YXIgbW9kZWxGaWVsZHNDYWNoZT17Y2FjaGU6e30sY2FjaGVEZWZzOnt9LH07Y29yZS5idXMub24oJ2NsZWFyX2NhY2hlJyxudWxsLGZ1bmN0aW9uKCl7bW9kZWxGaWVsZHNDYWNoZS5jYWNoZT17fTttb2RlbEZpZWxkc0NhY2hlLmNhY2hlRGVmcz17fTt9KTt2YXIgTW9kZWxGaWVsZFNlbGVjdG9yPVdpZGdldC5leHRlbmQoe3RlbXBsYXRlOiJNb2RlbEZpZWxkU2VsZWN0b3IiLGV2ZW50czp7fSxlZGl0aW9uRXZlbnRzOnsiZm9jdXNpbiI6Il9vbkZvY3VzSW4iLCJmb2N1c291dCI6Il9vbkZvY3VzT3V0IiwiY2xpY2sgLm9fZmllbGRfc2VsZWN0b3JfY2xvc2UiOiJfb25DbG9zZUNsaWNrIiwiY2xpY2sgLm9fZmllbGRfc2VsZWN0b3JfcHJldl9wYWdlIjoiX29uUHJldlBhZ2VDbGljayIsImNsaWNrIC5vX2ZpZWxkX3NlbGVjdG9yX25leHRfcGFnZSI6Il9vbk5leHRQYWdlQ2xpY2siLCJjbGljayBsaS5vX2ZpZWxkX3NlbGVjdG9yX3NlbGVjdF9idXR0b24iOiJfb25MYXN0RmllbGRDbGljayIsImNoYW5nZSBpbnB1dC5vX2ZpZWxkX3NlbGVjdG9yX2RlYnVnIjoiX29uRGVidWdJbnB1dENoYW5nZSIsImtleXVwIC5vX2ZpZWxkX3NlbGVjdG9yX3NlYXJjaCA+IGlucHV0IjoiX29uU2VhcmNoSW5wdXRDaGFuZ2UiLCJtb3VzZW92ZXIgbGkub19maWVsZF9zZWxlY3Rvcl9pdGVtIjoiX29uSXRlbUhvdmVyIiwia2V5ZG93biI6Il9vbktleWRvd24iLH0saW5pdDpmdW5jdGlvbihwYXJlbnQsbW9kZWwsY2hhaW4sb3B0aW9ucyl7dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3RoaXMubW9kZWw9bW9kZWw7dGhpcy5jaGFpbj1jaGFpbjt0aGlzLm9wdGlvbnM9Xy5leHRlbmQoe29yZGVyOidzdHJpbmcnLHJlYWRvbmx5OnRydWUsZmlsdGVyczp7fSxmaWVsZHM6bnVsbCxmaWx0ZXI6ZnVuY3Rpb24oKXtyZXR1cm4gdHJ1ZTt9LGZvbGxvd1JlbGF0aW9uczp0cnVlLGRlYnVnTW9kZTpmYWxzZSxzaG93U2VhcmNoSW5wdXQ6dHJ1ZSx9LG9wdGlvbnN8fHt9KTt0aGlzLm9wdGlvbnMuZmlsdGVycz1fLmV4dGVuZCh7c2VhcmNoYWJsZTp0cnVlLH0sdGhpcy5vcHRpb25zLmZpbHRlcnMpO2lmKHR5cGVvZiB0aGlzLm9wdGlvbnMuZm9sbG93UmVsYXRpb25zIT09J2Z1bmN0aW9uJyl7dGhpcy5vcHRpb25zLmZvbGxvd1JlbGF0aW9ucz10aGlzLm9wdGlvbnMuZm9sbG93UmVsYXRpb25zP2Z1bmN0aW9uKCl7cmV0dXJuIHRydWU7fTpmdW5jdGlvbigpe3JldHVybiBmYWxzZTt9O30KdGhpcy5wYWdlcz1bXTt0aGlzLmRpcnR5PWZhbHNlO2lmKCF0aGlzLm9wdGlvbnMucmVhZG9ubHkpe18uZXh0ZW5kKHRoaXMuZXZlbnRzLHRoaXMuZWRpdGlvbkV2ZW50cyk7fQp0aGlzLnNlYXJjaFZhbHVlPScnO30sd2lsbFN0YXJ0OmZ1bmN0aW9uKCl7cmV0dXJuIFByb21pc2UuYWxsKFt0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyksdGhpcy5fcHJlZmlsbCgpXSk7fSxzdGFydDpmdW5jdGlvbigpe3RoaXMuJHZhbHVlPXRoaXMuJCgiLm9fZmllbGRfc2VsZWN0b3JfdmFsdWUiKTt0aGlzLiRwb3BvdmVyPXRoaXMuJCgiLm9fZmllbGRfc2VsZWN0b3JfcG9wb3ZlciIpO3RoaXMuJGlucHV0PXRoaXMuJHBvcG92ZXIuZmluZCgiLm9fZmllbGRfc2VsZWN0b3JfcG9wb3Zlcl9mb290ZXIgPiBpbnB1dCIpO3RoaXMuJHNlYXJjaElucHV0PXRoaXMuJHBvcG92ZXIuZmluZCgiLm9fZmllbGRfc2VsZWN0b3Jfc2VhcmNoID4gaW5wdXQiKTt0aGlzLiR2YWxpZD10aGlzLiQoIi5vX2ZpZWxkX3NlbGVjdG9yX3dhcm5pbmciKTt0aGlzLl9yZW5kZXIoKTtyZXR1cm4gdGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO30sZ2V0U2VsZWN0ZWRGaWVsZDpmdW5jdGlvbigpe3JldHVybiBfLmZpbmRXaGVyZSh0aGlzLnBhZ2VzW3RoaXMuY2hhaW4ubGVuZ3RoLTFdLHtuYW1lOl8ubGFzdCh0aGlzLmNoYWluKX0pO30saXNWYWxpZDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnZhbGlkO30sc2V0Q2hhaW46ZnVuY3Rpb24oY2hhaW4pe2lmKF8uaXNFcXVhbChjaGFpbix0aGlzLmNoYWluKSl7cmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO30KdGhpcy5jaGFpbj1jaGFpbjtyZXR1cm4gdGhpcy5fcHJlZmlsbCgpLnRoZW4odGhpcy5fcmVuZGVyLmJpbmQodGhpcykpO30sX2FkZENoYWluTm9kZTpmdW5jdGlvbihmaWVsZE5hbWUpe3RoaXMuZGlydHk9dHJ1ZTt0aGlzLmNoYWluPXRoaXMuY2hhaW4uc2xpY2UoMCx0aGlzLnBhZ2VzLmxlbmd0aC0xKTt0aGlzLmNoYWluLnB1c2goZmllbGROYW1lKTt0aGlzLnNlYXJjaFZhbHVlPScnO3RoaXMuJHNlYXJjaElucHV0LnZhbCgnJyk7fSxfZ2V0TGFzdFBhZ2VGaWVsZDpmdW5jdGlvbihuYW1lKXtyZXR1cm4gXy5maW5kV2hlcmUoXy5sYXN0KHRoaXMucGFnZXMpLHtuYW1lOm5hbWUsfSk7fSxfZ2V0TW9kZWxGaWVsZHNGcm9tQ2FjaGU6ZnVuY3Rpb24obW9kZWwsZmlsdGVycyl7dmFyIHNlbGY9dGhpczt2YXIgZGVmPW1vZGVsRmllbGRzQ2FjaGUuY2FjaGVEZWZzW21vZGVsXTtpZighZGVmKXtkZWY9bW9kZWxGaWVsZHNDYWNoZS5jYWNoZURlZnNbbW9kZWxdPXRoaXMuX3JwYyh7bW9kZWw6bW9kZWwsbWV0aG9kOidmaWVsZHNfZ2V0JyxhcmdzOltmYWxzZSxbInN0b3JlIiwic2VhcmNoYWJsZSIsInR5cGUiLCJzdHJpbmciLCJyZWxhdGlvbiIsInNlbGVjdGlvbiIsInJlbGF0ZWQiXV0sY29udGV4dDp0aGlzLmdldFNlc3Npb24oKS51c2VyX2NvbnRleHQsfSkudGhlbigoZnVuY3Rpb24oZmllbGRzKXttb2RlbEZpZWxkc0NhY2hlLmNhY2hlW21vZGVsXT1zb3J0RmllbGRzKGZpZWxkcyxtb2RlbCxzZWxmLm9wdGlvbnMub3JkZXIpO30pLmJpbmQodGhpcykpO30KcmV0dXJuIGRlZi50aGVuKChmdW5jdGlvbigpe3JldHVybiBfLmZpbHRlcihtb2RlbEZpZWxkc0NhY2hlLmNhY2hlW21vZGVsXSxmdW5jdGlvbihmKXtyZXR1cm4oIWZpbHRlcnMuc2VhcmNoYWJsZXx8Zi5zZWFyY2hhYmxlKSYmc2VsZi5vcHRpb25zLmZpbHRlcihmKTt9KTt9KS5iaW5kKHRoaXMpKTt9LF9nb1RvTmV4dFBhZ2U6ZnVuY3Rpb24oZmllbGQpe2lmKCFfLmlzRXF1YWwodGhpcy5fZ2V0TGFzdFBhZ2VGaWVsZChmaWVsZC5uYW1lKSxmaWVsZCkpcmV0dXJuO3RoaXMuX3ZhbGlkYXRlKHRydWUpO3RoaXMuX2FkZENoYWluTm9kZShmaWVsZC5uYW1lKTt0aGlzLl9wdXNoUGFnZURhdGEoZmllbGQucmVsYXRpb24pLnRoZW4odGhpcy5fcmVuZGVyLmJpbmQodGhpcykpO30sX2dvVG9QcmV2UGFnZTpmdW5jdGlvbigpe2lmKHRoaXMucGFnZXMubGVuZ3RoPD0wKXJldHVybjt0aGlzLl92YWxpZGF0ZSh0cnVlKTt0aGlzLl9yZW1vdmVDaGFpbk5vZGUoKTtpZih0aGlzLnBhZ2VzLmxlbmd0aD4xKXt0aGlzLnBhZ2VzLnBvcCgpO30KdGhpcy5fcmVuZGVyKCk7fSxfaGlkZVBvcG92ZXI6ZnVuY3Rpb24oKXtpZighdGhpcy5faXNPcGVuKXJldHVybjt0aGlzLl9pc09wZW49ZmFsc2U7dGhpcy4kcG9wb3Zlci5hZGRDbGFzcygnZC1ub25lJyk7aWYodGhpcy5kaXJ0eSl7dGhpcy5kaXJ0eT1mYWxzZTt0aGlzLnRyaWdnZXJfdXAoImZpZWxkX2NoYWluX2NoYW5nZWQiLHtjaGFpbjp0aGlzLmNoYWlufSk7fX0sX3ByZWZpbGw6ZnVuY3Rpb24oKXt0aGlzLnBhZ2VzPVtdO3JldHVybiB0aGlzLl9wdXNoUGFnZURhdGEodGhpcy5tb2RlbCkudGhlbigoZnVuY3Rpb24oKXt0aGlzLl92YWxpZGF0ZSh0cnVlKTtyZXR1cm4odGhpcy5jaGFpbi5sZW5ndGg/cHJvY2Vzc0NoYWluLmNhbGwodGhpcyx0aGlzLmNoYWluLnNsaWNlKCkucmV2ZXJzZSgpKTpQcm9taXNlLnJlc29sdmUoKSk7fSkuYmluZCh0aGlzKSk7ZnVuY3Rpb24gcHJvY2Vzc0NoYWluKGNoYWluKXt2YXIgZmllbGROYW1lPWNoYWluLnBvcCgpO3ZhciBmaWVsZD10aGlzLl9nZXRMYXN0UGFnZUZpZWxkKGZpZWxkTmFtZSk7aWYoZmllbGQmJmZpZWxkLnJlbGF0aW9uJiZjaGFpbi5sZW5ndGg+MCl7cmV0dXJuIHRoaXMuX3B1c2hQYWdlRGF0YShmaWVsZC5yZWxhdGlvbikudGhlbihwcm9jZXNzQ2hhaW4uYmluZCh0aGlzLGNoYWluKSk7fWVsc2UgaWYoZmllbGQmJmNoYWluLmxlbmd0aD09PTApe3JldHVybiBQcm9taXNlLnJlc29sdmUoKTt9ZWxzZSBpZighZmllbGQmJmZpZWxkTmFtZT09PSIxIil7dGhpcy5fdmFsaWRhdGUodHJ1ZSk7fWVsc2UgaWYoIWZpZWxkJiZmaWVsZE5hbWU9PT0iMCIpe3RoaXMuX3ZhbGlkYXRlKHRydWUpO31lbHNle3RoaXMuX3ZhbGlkYXRlKGZhbHNlKTt9CnJldHVybiBQcm9taXNlLnJlc29sdmUoKTt9fSxfcHVzaFBhZ2VEYXRhOmZ1bmN0aW9uKG1vZGVsKXt2YXIgZGVmO2lmKHRoaXMubW9kZWw9PT1tb2RlbCYmdGhpcy5vcHRpb25zLmZpZWxkcyl7ZGVmPVByb21pc2UucmVzb2x2ZShzb3J0RmllbGRzKHRoaXMub3B0aW9ucy5maWVsZHMsbW9kZWwsdGhpcy5vcHRpb25zLm9yZGVyKSk7fWVsc2V7ZGVmPXRoaXMuX2dldE1vZGVsRmllbGRzRnJvbUNhY2hlKG1vZGVsLHRoaXMub3B0aW9ucy5maWx0ZXJzKTt9CnJldHVybiBkZWYudGhlbigoZnVuY3Rpb24oZmllbGRzKXt0aGlzLnBhZ2VzLnB1c2goZmllbGRzKTt9KS5iaW5kKHRoaXMpKTt9LF9yZW1vdmVDaGFpbk5vZGU6ZnVuY3Rpb24oKXt0aGlzLmRpcnR5PXRydWU7dGhpcy5jaGFpbj10aGlzLmNoYWluLnNsaWNlKDAsdGhpcy5wYWdlcy5sZW5ndGgtMSk7dGhpcy5jaGFpbi5wb3AoKTt9LF9yZW5kZXI6ZnVuY3Rpb24oKXt0aGlzLiR2YWx1ZS5odG1sKGNvcmUucXdlYi5yZW5kZXIodGhpcy50ZW1wbGF0ZSsiLnZhbHVlIix7Y2hhaW46dGhpcy5jaGFpbixwYWdlczp0aGlzLnBhZ2VzLH0pKTt0aGlzLiR2YWxpZC50b2dnbGVDbGFzcygnZC1ub25lJywhIXRoaXMuaXNWYWxpZCgpKTt2YXIgcGFnZT1fLmxhc3QodGhpcy5wYWdlcyk7dmFyIHRpdGxlPSIiO2lmKHRoaXMucGFnZXMubGVuZ3RoPjEpe3ZhciBwcmV2RmllbGQ9Xy5maW5kV2hlcmUodGhpcy5wYWdlc1t0aGlzLnBhZ2VzLmxlbmd0aC0yXSx7bmFtZToodGhpcy5jaGFpbi5sZW5ndGg9PT10aGlzLnBhZ2VzLmxlbmd0aCk/dGhpcy5jaGFpblt0aGlzLmNoYWluLmxlbmd0aC0yXTpfLmxhc3QodGhpcy5jaGFpbiksfSk7aWYocHJldkZpZWxkKXRpdGxlPXByZXZGaWVsZC5zdHJpbmc7fQp0aGlzLiQoIi5vX2ZpZWxkX3NlbGVjdG9yX3BvcG92ZXJfaGVhZGVyIC5vX2ZpZWxkX3NlbGVjdG9yX3RpdGxlIikudGV4dCh0aXRsZSk7dmFyIGxpbmVzPV8uZmlsdGVyKHBhZ2UsdGhpcy5vcHRpb25zLmZpbHRlcik7aWYodGhpcy5zZWFyY2hWYWx1ZSl7dmFyIG1hdGNoZXM9ZnV6enkuZmlsdGVyKHRoaXMuc2VhcmNoVmFsdWUsXy5wbHVjayhsaW5lcywnc3RyaW5nJykpO2xpbmVzPV8ubWFwKF8ucGx1Y2sobWF0Y2hlcywnaW5kZXgnKSxmdW5jdGlvbihpKXtyZXR1cm4gbGluZXNbaV07fSk7fQp0aGlzLiQoIi5vX2ZpZWxkX3NlbGVjdG9yX3BhZ2UiKS5yZXBsYWNlV2l0aChjb3JlLnF3ZWIucmVuZGVyKHRoaXMudGVtcGxhdGUrIi5wYWdlIix7bGluZXM6bGluZXMsZm9sbG93UmVsYXRpb25zOnRoaXMub3B0aW9ucy5mb2xsb3dSZWxhdGlvbnMsZGVidWc6dGhpcy5vcHRpb25zLmRlYnVnTW9kZSx9KSk7dGhpcy4kaW5wdXQudmFsKHRoaXMuY2hhaW4uam9pbigiLiIpKTt9LF9zZWxlY3RGaWVsZDpmdW5jdGlvbihmaWVsZCl7aWYoIV8uaXNFcXVhbCh0aGlzLl9nZXRMYXN0UGFnZUZpZWxkKGZpZWxkLm5hbWUpLGZpZWxkKSlyZXR1cm47dGhpcy5fdmFsaWRhdGUodHJ1ZSk7dGhpcy5fYWRkQ2hhaW5Ob2RlKGZpZWxkLm5hbWUpO3RoaXMuX3JlbmRlcigpO3RoaXMuX2hpZGVQb3BvdmVyKCk7fSxfc2hvd1BvcG92ZXI6ZnVuY3Rpb24oKXtpZih0aGlzLl9pc09wZW4pcmV0dXJuO3RoaXMuX2lzT3Blbj10cnVlO3RoaXMuJHBvcG92ZXIucmVtb3ZlQ2xhc3MoJ2Qtbm9uZScpO30sX3ZhbGlkYXRlOmZ1bmN0aW9uKHZhbGlkKXt0aGlzLnZhbGlkPSEhdmFsaWQ7aWYoIXRoaXMudmFsaWQpe3RoaXMuZG9fd2FybihfdCgiSW52YWxpZCBmaWVsZCBjaGFpbiIpLF90KCJUaGUgZmllbGQgY2hhaW4gaXMgbm90IHZhbGlkLiBEaWQgeW91IG1heWJlIHVzZSBhIG5vbi1leGlzdGluZyBmaWVsZCBuYW1lIG9yIGZvbGxvd2VkIGEgbm9uLXJlbGF0aW9uYWwgZmllbGQ/IikpO319LF9vbkZvY3VzSW46ZnVuY3Rpb24oKXtjbGVhclRpbWVvdXQodGhpcy5faGlkZVBvcG92ZXJUaW1lb3V0KTt0aGlzLl9zaG93UG9wb3ZlcigpO30sX29uRm9jdXNPdXQ6ZnVuY3Rpb24oKXt0aGlzLl9oaWRlUG9wb3ZlclRpbWVvdXQ9Xy5kZWZlcih0aGlzLl9oaWRlUG9wb3Zlci5iaW5kKHRoaXMpKTt9LF9vbkNsb3NlQ2xpY2s6ZnVuY3Rpb24oKXt0aGlzLl9oaWRlUG9wb3ZlcigpO30sX29uUHJldlBhZ2VDbGljazpmdW5jdGlvbigpe3RoaXMuX2dvVG9QcmV2UGFnZSgpO30sX29uTmV4dFBhZ2VDbGljazpmdW5jdGlvbihlKXtlLnN0b3BQcm9wYWdhdGlvbigpO3RoaXMuX2dvVG9OZXh0UGFnZSh0aGlzLl9nZXRMYXN0UGFnZUZpZWxkKCQoZS5jdXJyZW50VGFyZ2V0KS5kYXRhKCJuYW1lIikpKTt9LF9vbkxhc3RGaWVsZENsaWNrOmZ1bmN0aW9uKGUpe3RoaXMuX3NlbGVjdEZpZWxkKHRoaXMuX2dldExhc3RQYWdlRmllbGQoJChlLmN1cnJlbnRUYXJnZXQpLmRhdGEoIm5hbWUiKSkpO30sX29uRGVidWdJbnB1dENoYW5nZTpmdW5jdGlvbigpe3ZhciB1c2VyQ2hhaW5TdHI9dGhpcy4kaW5wdXQudmFsKCk7dmFyIHVzZXJDaGFpbj11c2VyQ2hhaW5TdHIuc3BsaXQoIi4iKTtpZighdGhpcy5vcHRpb25zLmZvbGxvd1JlbGF0aW9ucyYmdXNlckNoYWluLmxlbmd0aD4xKXt0aGlzLmRvX3dhcm4oX3QoIlJlbGF0aW9uIG5vdCBhbGxvd2VkIiksX3QoIllvdSBjYW5ub3QgZm9sbG93IHJlbGF0aW9ucyBmb3IgdGhpcyBmaWVsZCBjaGFpbiBjb25zdHJ1Y3Rpb24iKSk7dXNlckNoYWluPVt1c2VyQ2hhaW5bMF1dO30KdGhpcy5zZXRDaGFpbih1c2VyQ2hhaW4pLnRoZW4oKGZ1bmN0aW9uKCl7dGhpcy50cmlnZ2VyX3VwKCJmaWVsZF9jaGFpbl9jaGFuZ2VkIix7Y2hhaW46dGhpcy5jaGFpbn0pO30pLmJpbmQodGhpcykpO30sX29uU2VhcmNoSW5wdXRDaGFuZ2U6ZnVuY3Rpb24oKXt0aGlzLnNlYXJjaFZhbHVlPXRoaXMuJHNlYXJjaElucHV0LnZhbCgpO3RoaXMuX3JlbmRlcigpO30sX29uSXRlbUhvdmVyOmZ1bmN0aW9uKGUpe3RoaXMuJCgibGkub19maWVsZF9zZWxlY3Rvcl9pdGVtIikucmVtb3ZlQ2xhc3MoImFjdGl2ZSIpOyQoZS5jdXJyZW50VGFyZ2V0KS5hZGRDbGFzcygiYWN0aXZlIik7fSxfb25LZXlkb3duOmZ1bmN0aW9uKGUpe2lmKCF0aGlzLiRwb3BvdmVyLmlzKCI6dmlzaWJsZSIpKXJldHVybjt2YXIgaW5wdXRIYXNGb2N1cz10aGlzLiRpbnB1dC5pcygiOmZvY3VzIik7dmFyIHNlYXJjaElucHV0SGFzRm9jdXM9dGhpcy4kc2VhcmNoSW5wdXQuaXMoIjpmb2N1cyIpO3N3aXRjaChlLndoaWNoKXtjYXNlICQudWkua2V5Q29kZS5VUDpjYXNlICQudWkua2V5Q29kZS5ET1dOOmUucHJldmVudERlZmF1bHQoKTt2YXIgJGFjdGl2ZT10aGlzLiQoImxpLm9fZmllbGRfc2VsZWN0b3JfaXRlbS5hY3RpdmUiKTt2YXIgJHRvPSRhY3RpdmVbZS53aGljaD09PSQudWkua2V5Q29kZS5ET1dOPyJuZXh0IjoicHJldiJdKCIub19maWVsZF9zZWxlY3Rvcl9pdGVtIik7aWYoJHRvLmxlbmd0aCl7JGFjdGl2ZS5yZW1vdmVDbGFzcygiYWN0aXZlIik7JHRvLmFkZENsYXNzKCJhY3RpdmUiKTt0aGlzLiRwb3BvdmVyLmZvY3VzKCk7dmFyICRwYWdlPSR0by5jbG9zZXN0KCIub19maWVsZF9zZWxlY3Rvcl9wYWdlIik7dmFyIGZ1bGxfaGVpZ2h0PSRwYWdlLmhlaWdodCgpO3ZhciBlbF9wb3NpdGlvbj0kdG8ucG9zaXRpb24oKS50b3A7dmFyIGVsX2hlaWdodD0kdG8ub3V0ZXJIZWlnaHQoKTt2YXIgY3VycmVudF9zY3JvbGw9JHBhZ2Uuc2Nyb2xsVG9wKCk7aWYoZWxfcG9zaXRpb248MCl7JHBhZ2Uuc2Nyb2xsVG9wKGN1cnJlbnRfc2Nyb2xsLWVsX2hlaWdodCk7fWVsc2UgaWYoZnVsbF9oZWlnaHQ8ZWxfcG9zaXRpb24rZWxfaGVpZ2h0KXskcGFnZS5zY3JvbGxUb3AoY3VycmVudF9zY3JvbGwrZWxfaGVpZ2h0KTt9fQpicmVhaztjYXNlICQudWkua2V5Q29kZS5SSUdIVDppZihpbnB1dEhhc0ZvY3VzKWJyZWFrO2UucHJldmVudERlZmF1bHQoKTt2YXIgbmFtZT10aGlzLiQoImxpLm9fZmllbGRfc2VsZWN0b3JfaXRlbS5hY3RpdmUiKS5kYXRhKCJuYW1lIik7aWYobmFtZSl7dmFyIGZpZWxkPXRoaXMuX2dldExhc3RQYWdlRmllbGQobmFtZSk7aWYoZmllbGQucmVsYXRpb24pe3RoaXMuX2dvVG9OZXh0UGFnZShmaWVsZCk7fX0KYnJlYWs7Y2FzZSAkLnVpLmtleUNvZGUuTEVGVDppZihpbnB1dEhhc0ZvY3VzKWJyZWFrO2UucHJldmVudERlZmF1bHQoKTt0aGlzLl9nb1RvUHJldlBhZ2UoKTticmVhaztjYXNlICQudWkua2V5Q29kZS5FU0NBUEU6ZS5zdG9wUHJvcGFnYXRpb24oKTt0aGlzLl9oaWRlUG9wb3ZlcigpO2JyZWFrO2Nhc2UgJC51aS5rZXlDb2RlLkVOVEVSOmlmKGlucHV0SGFzRm9jdXN8fHNlYXJjaElucHV0SGFzRm9jdXMpYnJlYWs7ZS5wcmV2ZW50RGVmYXVsdCgpO3RoaXMuX3NlbGVjdEZpZWxkKHRoaXMuX2dldExhc3RQYWdlRmllbGQodGhpcy4kKCJsaS5vX2ZpZWxkX3NlbGVjdG9yX2l0ZW0uYWN0aXZlIikuZGF0YSgibmFtZSIpKSk7YnJlYWs7fX19KTtyZXR1cm4gTW9kZWxGaWVsZFNlbGVjdG9yO2Z1bmN0aW9uIHNvcnRGaWVsZHMoZmllbGRzLG1vZGVsLG9yZGVyKXt2YXIgYXJyYXk9Xy5jaGFpbihmaWVsZHMpLnBhaXJzKCkuc29ydEJ5KGZ1bmN0aW9uKHApe3JldHVybiBwWzFdLnN0cmluZzt9KTtpZihvcmRlciE9PSdzdHJpbmcnKXthcnJheT1hcnJheS5zb3J0QnkoZnVuY3Rpb24ocCl7cmV0dXJuIHBbMV1bb3JkZXJdO30pO30KcmV0dXJuIGFycmF5Lm1hcChmdW5jdGlvbihwKXtyZXR1cm4gXy5leHRlbmQoe25hbWU6cFswXSxtb2RlbDptb2RlbCx9LHBbMV0pO30pLnZhbHVlKCk7fX0pOzsKCi8qIC93ZWIvc3RhdGljL3NyYy9qcy9jaHJvbWUvc2lkZWJhci5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwpvZG9vLmRlZmluZSgnd2ViLlNpZGViYXInLGZ1bmN0aW9uKHJlcXVpcmUpeyJ1c2Ugc3RyaWN0Ijt2YXIgQ29udGV4dD1yZXF1aXJlKCd3ZWIuQ29udGV4dCcpO3ZhciBjb3JlPXJlcXVpcmUoJ3dlYi5jb3JlJyk7dmFyIHB5VXRpbHM9cmVxdWlyZSgnd2ViLnB5X3V0aWxzJyk7dmFyIFdpZGdldD1yZXF1aXJlKCd3ZWIuV2lkZ2V0Jyk7dmFyIFFXZWI9Y29yZS5xd2ViO3ZhciBfdD1jb3JlLl90O3ZhciBTaWRlYmFyPVdpZGdldC5leHRlbmQoe2V2ZW50czp7ImNsaWNrIGEuZHJvcGRvd24taXRlbSI6Il9vbkRyb3Bkb3duQ2xpY2tlZCJ9LGluaXQ6ZnVuY3Rpb24ocGFyZW50LG9wdGlvbnMpe3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLm9wdGlvbnM9Xy5kZWZhdWx0cyhvcHRpb25zfHx7fSx7J2VkaXRhYmxlJzp0cnVlfSk7dGhpcy5lbnY9b3B0aW9ucy5lbnY7dGhpcy5zZWN0aW9ucz1vcHRpb25zLnNlY3Rpb25zfHxbe25hbWU6J3ByaW50JyxsYWJlbDpfdCgnUHJpbnQnKX0se25hbWU6J290aGVyJyxsYWJlbDpfdCgnQWN0aW9uJyl9LF07dGhpcy5pdGVtcz1vcHRpb25zLml0ZW1zfHx7cHJpbnQ6W10sb3RoZXI6W10sfTtpZihvcHRpb25zLmFjdGlvbnMpe3RoaXMuX2FkZFRvb2xiYXJBY3Rpb25zKG9wdGlvbnMuYWN0aW9ucyk7fX0sc3RhcnQ6ZnVuY3Rpb24oKXt0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy4kZWwuYWRkQ2xhc3MoJ2J0bi1ncm91cCcpO3RoaXMuX3JlZHJhdygpO30sdXBkYXRlRW52OmZ1bmN0aW9uKGVudil7dGhpcy5lbnY9ZW52O3RoaXMuX3JlZHJhdygpO30sX2FkZEl0ZW1zOmZ1bmN0aW9uKHNlY3Rpb25Db2RlLGl0ZW1zKXtpZihpdGVtcyl7dGhpcy5pdGVtc1tzZWN0aW9uQ29kZV0udW5zaGlmdC5hcHBseSh0aGlzLml0ZW1zW3NlY3Rpb25Db2RlXSxpdGVtcyk7fX0sX2FkZFRvb2xiYXJBY3Rpb25zOmZ1bmN0aW9uKHRvb2xiYXJBY3Rpb25zKXt2YXIgc2VsZj10aGlzO18uZWFjaChbJ3ByaW50JywnYWN0aW9uJywncmVsYXRlJ10sZnVuY3Rpb24odHlwZSl7aWYodHlwZSBpbiB0b29sYmFyQWN0aW9ucyl7dmFyIGFjdGlvbnM9dG9vbGJhckFjdGlvbnNbdHlwZV07aWYoYWN0aW9ucyYmYWN0aW9ucy5sZW5ndGgpe3ZhciBpdGVtcz1fLm1hcChhY3Rpb25zLGZ1bmN0aW9uKGFjdGlvbil7cmV0dXJue2xhYmVsOmFjdGlvbi5uYW1lLGFjdGlvbjphY3Rpb24sfTt9KTtzZWxmLl9hZGRJdGVtcyh0eXBlPT09J3ByaW50Jz8ncHJpbnQnOidvdGhlcicsaXRlbXMpO319fSk7aWYoJ290aGVyJ2luIHRvb2xiYXJBY3Rpb25zKXt0aGlzLl9hZGRJdGVtcygnb3RoZXInLHRvb2xiYXJBY3Rpb25zLm90aGVyKTt9fSxfb25JdGVtQWN0aW9uQ2xpY2tlZDpmdW5jdGlvbihpdGVtKXt2YXIgc2VsZj10aGlzO3RoaXMudHJpZ2dlcl91cCgnc2lkZWJhcl9kYXRhX2Fza2VkJyx7Y2FsbGJhY2s6ZnVuY3Rpb24oZW52KXtzZWxmLmVudj1lbnY7dmFyIGFjdGl2ZUlkc0NvbnRleHQ9e2FjdGl2ZV9pZDplbnYuYWN0aXZlSWRzWzBdLGFjdGl2ZV9pZHM6ZW52LmFjdGl2ZUlkcyxhY3RpdmVfbW9kZWw6ZW52Lm1vZGVsLH07aWYoZW52LmRvbWFpbil7YWN0aXZlSWRzQ29udGV4dC5hY3RpdmVfZG9tYWluPWVudi5kb21haW47fQp2YXIgY29udGV4dD1weVV0aWxzLmV2YWwoJ2NvbnRleHQnLG5ldyBDb250ZXh0KGVudi5jb250ZXh0LGFjdGl2ZUlkc0NvbnRleHQpKTtzZWxmLl9ycGMoe3JvdXRlOicvd2ViL2FjdGlvbi9sb2FkJyxwYXJhbXM6e2FjdGlvbl9pZDppdGVtLmFjdGlvbi5pZCxjb250ZXh0OmNvbnRleHQsfSx9KS50aGVuKGZ1bmN0aW9uKHJlc3VsdCl7cmVzdWx0LmNvbnRleHQ9bmV3IENvbnRleHQocmVzdWx0LmNvbnRleHR8fHt9LGFjdGl2ZUlkc0NvbnRleHQpLnNldF9ldmFsX2NvbnRleHQoY29udGV4dCk7cmVzdWx0LmZsYWdzPXJlc3VsdC5mbGFnc3x8e307cmVzdWx0LmZsYWdzLm5ld193aW5kb3c9dHJ1ZTtzZWxmLmRvX2FjdGlvbihyZXN1bHQse29uX2Nsb3NlOmZ1bmN0aW9uKCl7c2VsZi50cmlnZ2VyX3VwKCdyZWxvYWQnKTt9LH0pO30pO319KTt9LF9yZWRyYXc6ZnVuY3Rpb24oKXt0aGlzLiRlbC5odG1sKFFXZWIucmVuZGVyKCdTaWRlYmFyJyx7d2lkZ2V0OnRoaXN9KSk7Xy5lYWNoKHRoaXMuJCgnLm9fZHJvcGRvd24nKSxmdW5jdGlvbihlbCl7dmFyICRkcm9wZG93bj0kKGVsKTtpZighJGRyb3Bkb3duLmZpbmQoJy5kcm9wZG93bi1pdGVtJykubGVuZ3RoKXskZHJvcGRvd24uaGlkZSgpO319KTt0aGlzLiQoIlt0aXRsZV0iKS50b29sdGlwKHtkZWxheTp7c2hvdzo1MDAsaGlkZTowfX0pO30sX29uRHJvcGRvd25DbGlja2VkOmZ1bmN0aW9uKGV2ZW50KXt2YXIgc2VjdGlvbj0kKGV2ZW50LmN1cnJlbnRUYXJnZXQpLmRhdGEoJ3NlY3Rpb24nKTt2YXIgaW5kZXg9JChldmVudC5jdXJyZW50VGFyZ2V0KS5kYXRhKCdpbmRleCcpO3ZhciBpdGVtPXRoaXMuaXRlbXNbc2VjdGlvbl1baW5kZXhdO2lmKGl0ZW0uY2FsbGJhY2spe2l0ZW0uY2FsbGJhY2suYXBwbHkodGhpcyxbaXRlbV0pO31lbHNlIGlmKGl0ZW0uYWN0aW9uKXt0aGlzLl9vbkl0ZW1BY3Rpb25DbGlja2VkKGl0ZW0pO31lbHNlIGlmKGl0ZW0udXJsKXtyZXR1cm4gdHJ1ZTt9CmV2ZW50LnByZXZlbnREZWZhdWx0KCk7fSx9KTtyZXR1cm4gU2lkZWJhcjt9KTs7CgovKiAvd2ViL3N0YXRpYy9zcmMvanMvY2hyb21lL3BhZ2VyLmpzIGRlZmluZWQgaW4gYnVuZGxlICd3ZWIuYXNzZXRzX2JhY2tlbmQnICovCm9kb28uZGVmaW5lKCd3ZWIuUGFnZXInLGZ1bmN0aW9uKHJlcXVpcmUpeyJ1c2Ugc3RyaWN0Ijt2YXIgdXRpbHM9cmVxdWlyZSgnd2ViLnV0aWxzJyk7dmFyIFdpZGdldD1yZXF1aXJlKCd3ZWIuV2lkZ2V0Jyk7dmFyIGRpcmVjdGlvbj17cHJldmlvdXM6LTEsbmV4dDoxLH07dmFyIFBhZ2VyPVdpZGdldC5leHRlbmQoe3RlbXBsYXRlOiJQYWdlciIsZXZlbnRzOnsnY2xpY2sgLm9fcGFnZXJfbmV4dCc6J19vbk5leHQnLCdjbGljayAub19wYWdlcl9wcmV2aW91cyc6J19vblByZXZpb3VzJywnY2xpY2sgLm9fcGFnZXJfdmFsdWUnOidfb25FZGl0Jyx9LGluaXQ6ZnVuY3Rpb24ocGFyZW50LHNpemUsY3VycmVudF9taW4sbGltaXQsb3B0aW9ucyl7dGhpcy5zdGF0ZT17c2l6ZTpzaXplLGN1cnJlbnRfbWluOmN1cnJlbnRfbWluLGxpbWl0OmxpbWl0LH07T2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMuc3RhdGUsJ2N1cnJlbnRfbWF4Jyx7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIE1hdGgubWluKHRoaXMuY3VycmVudF9taW4rdGhpcy5saW1pdC0xLHRoaXMuc2l6ZSk7fX0pO3RoaXMub3B0aW9ucz1fLmRlZmF1bHRzKHt9LG9wdGlvbnMse2Nhbl9lZGl0OnRydWUsc2luZ2xlX3BhZ2VfaGlkZGVuOmZhbHNlLHZhbGlkYXRlOmZ1bmN0aW9uKCl7cmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO30sd2l0aEFjY2Vzc0tleTp0cnVlLH0pO3RoaXMuX3N1cGVyKHBhcmVudCk7fSxzdGFydDpmdW5jdGlvbigpe3RoaXMuJHZhbHVlPXRoaXMuJCgnLm9fcGFnZXJfdmFsdWUnKTt0aGlzLiRsaW1pdD10aGlzLiQoJy5vX3BhZ2VyX2xpbWl0Jyk7dGhpcy5fcmVuZGVyKCk7cmV0dXJuIHRoaXMuX3N1cGVyKCk7fSxkaXNhYmxlOmZ1bmN0aW9uKCl7dGhpcy5kaXNhYmxlZD10cnVlO3RoaXMuX3VwZGF0ZUFycm93cygpO30sZW5hYmxlOmZ1bmN0aW9uKCl7dGhpcy5kaXNhYmxlZD1mYWxzZTt0aGlzLl91cGRhdGVBcnJvd3MoKTt9LG5leHQ6ZnVuY3Rpb24oKXt0aGlzLl9jaGFuZ2VTZWxlY3Rpb24oZGlyZWN0aW9uLm5leHQpO30scHJldmlvdXM6ZnVuY3Rpb24oKXt0aGlzLl9jaGFuZ2VTZWxlY3Rpb24oZGlyZWN0aW9uLnByZXZpb3VzKTt9LHVwZGF0ZVN0YXRlOmZ1bmN0aW9uKHN0YXRlLG9wdGlvbnMpe18uZXh0ZW5kKHRoaXMuc3RhdGUsc3RhdGUpO3RoaXMuX3JlbmRlcigpO2lmKG9wdGlvbnMmJm9wdGlvbnMubm90aWZ5Q2hhbmdlKXt0aGlzLnRyaWdnZXIoJ3BhZ2VyX2NoYW5nZWQnLF8uY2xvbmUodGhpcy5zdGF0ZSkpO319LF9jaGFuZ2VTZWxlY3Rpb246ZnVuY3Rpb24oZGlyZWN0aW9uKXt2YXIgc2VsZj10aGlzO3RoaXMub3B0aW9ucy52YWxpZGF0ZSgpLnRoZW4oZnVuY3Rpb24oKXt2YXIgc2l6ZT1zZWxmLnN0YXRlLnNpemU7dmFyIGN1cnJlbnRfbWluPXNlbGYuc3RhdGUuY3VycmVudF9taW47dmFyIGxpbWl0PXNlbGYuc3RhdGUubGltaXQ7Y3VycmVudF9taW49KGN1cnJlbnRfbWluK2xpbWl0KmRpcmVjdGlvbik7aWYoY3VycmVudF9taW4+c2l6ZSl7Y3VycmVudF9taW49MTt9ZWxzZSBpZigoY3VycmVudF9taW48MSkmJihsaW1pdD09PTEpKXtjdXJyZW50X21pbj1zaXplO31lbHNlIGlmKChjdXJyZW50X21pbjwxKSYmKGxpbWl0PjEpKXtjdXJyZW50X21pbj1zaXplLSgoc2l6ZSVsaW1pdCl8fGxpbWl0KSsxO30Kc2VsZi5zdGF0ZS5jdXJyZW50X21pbj1jdXJyZW50X21pbjtzZWxmLl9yZW5kZXIoKTtzZWxmLnRyaWdnZXIoJ3BhZ2VyX2NoYW5nZWQnLF8uY2xvbmUoc2VsZi5zdGF0ZSkpO30pO30sX2VkaXQ6ZnVuY3Rpb24oKXtpZih0aGlzLm9wdGlvbnMuY2FuX2VkaXQpe3ZhciBzZWxmPXRoaXM7dmFyICRpbnB1dD0kKCc8aW5wdXQ+Jyx7Y2xhc3M6J29faW5wdXQnLHR5cGU6J3RleHQnLHZhbHVlOnRoaXMuJHZhbHVlLmh0bWwoKX0pO3RoaXMuJHZhbHVlLmh0bWwoJGlucHV0KTskaW5wdXQuZm9jdXMoKTskaW5wdXQuY2xpY2soZnVuY3Rpb24oZXYpe2V2LnN0b3BQcm9wYWdhdGlvbigpO30pOyRpbnB1dC5ibHVyKGZ1bmN0aW9uKGV2KXtzZWxmLl9zYXZlKCQoZXYudGFyZ2V0KSk7fSk7JGlucHV0Lm9uKCdrZXlkb3duJyxmdW5jdGlvbihldil7ZXYuc3RvcFByb3BhZ2F0aW9uKCk7aWYoZXYud2hpY2g9PT0kLnVpLmtleUNvZGUuRU5URVIpe3NlbGYuX3NhdmUoJChldi50YXJnZXQpKTt9ZWxzZSBpZihldi53aGljaD09PSQudWkua2V5Q29kZS5FU0NBUEUpe3NlbGYuX3JlbmRlcigpO319KTt9fSxfcmVuZGVyOmZ1bmN0aW9uKCl7dmFyIHNpemU9dGhpcy5zdGF0ZS5zaXplO3ZhciBjdXJyZW50X21pbj10aGlzLnN0YXRlLmN1cnJlbnRfbWluO3ZhciBjdXJyZW50X21heD10aGlzLnN0YXRlLmN1cnJlbnRfbWF4O2lmKHNpemU9PT0wfHwodGhpcy5vcHRpb25zLnNpbmdsZV9wYWdlX2hpZGRlbiYmdGhpcy5fc2luZ2xlUGFnZSgpKSl7dGhpcy5kb19oaWRlKCk7fWVsc2V7dGhpcy5kb19zaG93KCk7dGhpcy5fdXBkYXRlQXJyb3dzKCk7dmFyIHZhbHVlPSIiK2N1cnJlbnRfbWluO2lmKHRoaXMuc3RhdGUubGltaXQ+MSl7dmFsdWUrPSItIitjdXJyZW50X21heDt9CnRoaXMuJHZhbHVlLmh0bWwodmFsdWUpO3RoaXMuJGxpbWl0Lmh0bWwoc2l6ZSk7fX0sX3NhdmU6ZnVuY3Rpb24oJGlucHV0KXt2YXIgc2VsZj10aGlzO3RoaXMub3B0aW9ucy52YWxpZGF0ZSgpLnRoZW4oZnVuY3Rpb24oKXt2YXIgdmFsdWU9JGlucHV0LnZhbCgpLnNwbGl0KCItIik7dmFyIG1pbj11dGlscy5jb25maW5lKHBhcnNlSW50KHZhbHVlWzBdLDEwKSwxLHNlbGYuc3RhdGUuc2l6ZSk7dmFyIG1heD11dGlscy5jb25maW5lKHBhcnNlSW50KHZhbHVlWzFdLDEwKSwxLHNlbGYuc3RhdGUuc2l6ZSk7aWYoIWlzTmFOKG1pbikpe3NlbGYuc3RhdGUuY3VycmVudF9taW49bWluO2lmKCFpc05hTihtYXgpKXtzZWxmLnN0YXRlLmxpbWl0PXV0aWxzLmNvbmZpbmUobWF4LW1pbisxLDEsc2VsZi5zdGF0ZS5zaXplKTt9ZWxzZXtzZWxmLnN0YXRlLmxpbWl0PTE7fQpzZWxmLnRyaWdnZXIoJ3BhZ2VyX2NoYW5nZWQnLF8uY2xvbmUoc2VsZi5zdGF0ZSkpO30Kc2VsZi5fcmVuZGVyKCk7fSk7fSxfc2luZ2xlUGFnZTpmdW5jdGlvbigpe3ZhciBzdGF0ZT10aGlzLnN0YXRlO3JldHVybigxPT09c3RhdGUuY3VycmVudF9taW4pJiYoc3RhdGUuY3VycmVudF9tYXg9PT1zdGF0ZS5zaXplKTt9LF91cGRhdGVBcnJvd3M6ZnVuY3Rpb24oKXt2YXIgZGlzYWJsZWQ9dGhpcy5kaXNhYmxlZHx8dGhpcy5fc2luZ2xlUGFnZSgpO3RoaXMuJCgnYnV0dG9uJykucHJvcCgnZGlzYWJsZWQnLGRpc2FibGVkKTt9LF9vbkVkaXQ6ZnVuY3Rpb24oZXZlbnQpe2V2ZW50LnN0b3BQcm9wYWdhdGlvbigpO2lmKCF0aGlzLmRpc2FibGVkKXt0aGlzLl9lZGl0KCk7fX0sX29uTmV4dDpmdW5jdGlvbihldmVudCl7ZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7dGhpcy5uZXh0KCk7fSxfb25QcmV2aW91czpmdW5jdGlvbihldmVudCl7ZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7dGhpcy5wcmV2aW91cygpO30sfSk7cmV0dXJuIFBhZ2VyO30pOzsKCi8qIC93ZWIvc3RhdGljL3NyYy9qcy9jaHJvbWUvc3lzdHJheV9tZW51LmpzIGRlZmluZWQgaW4gYnVuZGxlICd3ZWIuYXNzZXRzX2JhY2tlbmQnICovCm9kb28uZGVmaW5lKCd3ZWIuU3lzdHJheU1lbnUnLGZ1bmN0aW9uKHJlcXVpcmUpeyJ1c2Ugc3RyaWN0Ijt2YXIgZG9tPXJlcXVpcmUoJ3dlYi5kb20nKTt2YXIgV2lkZ2V0PXJlcXVpcmUoJ3dlYi5XaWRnZXQnKTt2YXIgU3lzdHJheU1lbnU9V2lkZ2V0LmV4dGVuZCh7aW5pdDpmdW5jdGlvbihwYXJlbnQpe3RoaXMuX3N1cGVyKHBhcmVudCk7dGhpcy5pdGVtcz1bXTt0aGlzLndpZGdldHM9W107fSx3aWxsU3RhcnQ6ZnVuY3Rpb24oKXt2YXIgc2VsZj10aGlzO3ZhciBwcm9tcz1bXTtTeXN0cmF5TWVudS5JdGVtcz1fLnNvcnRCeShTeXN0cmF5TWVudS5JdGVtcyxmdW5jdGlvbihpdGVtKXtyZXR1cm4hXy5pc1VuZGVmaW5lZChpdGVtLnByb3RvdHlwZS5zZXF1ZW5jZSk/aXRlbS5wcm90b3R5cGUuc2VxdWVuY2U6NTA7fSk7U3lzdHJheU1lbnUuSXRlbXMuZm9yRWFjaChmdW5jdGlvbihXaWRnZXRDbGFzcyl7dmFyIGN1cl9zeXN0cmF5X2l0ZW09bmV3IFdpZGdldENsYXNzKHNlbGYpO3NlbGYud2lkZ2V0cy5wdXNoKGN1cl9zeXN0cmF5X2l0ZW0pO3Byb21zLnB1c2goY3VyX3N5c3RyYXlfaXRlbS5hcHBlbmRUbygkKCc8ZGl2PicpKSk7fSk7cmV0dXJuIHRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIFByb21pc2UuYWxsKHByb21zKTt9KTt9LHN0YXJ0OmZ1bmN0aW9uKCl7dmFyIHNlbGY9dGhpcztyZXR1cm4gdGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpLnRoZW4oZnVuY3Rpb24oKXtzZWxmLndpZGdldHMuZm9yRWFjaChmdW5jdGlvbih3aWRnZXQpe2RvbS5wcmVwZW5kKHNlbGYuJGVsLHdpZGdldC4kZWwpO30pO30pO30sfSk7U3lzdHJheU1lbnUuSXRlbXM9W107cmV0dXJuIFN5c3RyYXlNZW51O30pOzsKCi8qIC93ZWIvc3RhdGljL3NyYy9qcy93aWRnZXRzL3N3aXRjaF9jb21wYW55X21lbnUuanMgZGVmaW5lZCBpbiBidW5kbGUgJ3dlYi5hc3NldHNfYmFja2VuZCcgKi8Kb2Rvby5kZWZpbmUoJ3dlYi5Td2l0Y2hDb21wYW55TWVudScsZnVuY3Rpb24ocmVxdWlyZSl7InVzZSBzdHJpY3QiO3ZhciBjb25maWc9cmVxdWlyZSgnd2ViLmNvbmZpZycpO3ZhciBjb3JlPXJlcXVpcmUoJ3dlYi5jb3JlJyk7dmFyIHNlc3Npb249cmVxdWlyZSgnd2ViLnNlc3Npb24nKTt2YXIgU3lzdHJheU1lbnU9cmVxdWlyZSgnd2ViLlN5c3RyYXlNZW51Jyk7dmFyIFdpZGdldD1yZXF1aXJlKCd3ZWIuV2lkZ2V0Jyk7dmFyIF90PWNvcmUuX3Q7dmFyIFN3aXRjaENvbXBhbnlNZW51PVdpZGdldC5leHRlbmQoe3RlbXBsYXRlOidTd2l0Y2hDb21wYW55TWVudScsZXZlbnRzOnsnY2xpY2sgLmRyb3Bkb3duLWl0ZW1bZGF0YS1tZW51XSBkaXYubG9nX2ludG8nOidfb25Td2l0Y2hDb21wYW55Q2xpY2snLCdjbGljayAuZHJvcGRvd24taXRlbVtkYXRhLW1lbnVdIGRpdi50b2dnbGVfY29tcGFueSc6J19vblRvZ2dsZUNvbXBhbnlDbGljaycsfSxpbml0OmZ1bmN0aW9uKCl7dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3RoaXMuaXNNb2JpbGU9Y29uZmlnLmRldmljZS5pc01vYmlsZTt0aGlzLl9vblN3aXRjaENvbXBhbnlDbGljaz1fLmRlYm91bmNlKHRoaXMuX29uU3dpdGNoQ29tcGFueUNsaWNrLDE1MDAsdHJ1ZSk7fSx3aWxsU3RhcnQ6ZnVuY3Rpb24oKXt2YXIgc2VsZj10aGlzO3RoaXMuYWxsb3dlZF9jb21wYW55X2lkcz1TdHJpbmcoc2Vzc2lvbi51c2VyX2NvbnRleHQuYWxsb3dlZF9jb21wYW55X2lkcykuc3BsaXQoJywnKS5tYXAoZnVuY3Rpb24oaWQpe3JldHVybiBwYXJzZUludChpZCk7fSk7dGhpcy51c2VyX2NvbXBhbmllcz1zZXNzaW9uLnVzZXJfY29tcGFuaWVzLmFsbG93ZWRfY29tcGFuaWVzO3RoaXMuY3VycmVudF9jb21wYW55PXRoaXMuYWxsb3dlZF9jb21wYW55X2lkc1swXTt0aGlzLmN1cnJlbnRfY29tcGFueV9uYW1lPV8uZmluZChzZXNzaW9uLnVzZXJfY29tcGFuaWVzLmFsbG93ZWRfY29tcGFuaWVzLGZ1bmN0aW9uKGNvbXBhbnkpe3JldHVybiBjb21wYW55WzBdPT09c2VsZi5jdXJyZW50X2NvbXBhbnk7fSlbMV07cmV0dXJuIHRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9LF9vblN3aXRjaENvbXBhbnlDbGljazpmdW5jdGlvbihldil7ZXYuc3RvcFByb3BhZ2F0aW9uKCk7dmFyIGRyb3Bkb3duSXRlbT0kKGV2LmN1cnJlbnRUYXJnZXQpLnBhcmVudCgpO3ZhciBkcm9wZG93bk1lbnU9ZHJvcGRvd25JdGVtLnBhcmVudCgpO3ZhciBjb21wYW55SUQ9ZHJvcGRvd25JdGVtLmRhdGEoJ2NvbXBhbnktaWQnKTt2YXIgYWxsb3dlZF9jb21wYW55X2lkcz10aGlzLmFsbG93ZWRfY29tcGFueV9pZHM7aWYoZHJvcGRvd25JdGVtLmZpbmQoJy5mYS1zcXVhcmUtbycpLmxlbmd0aCl7aWYodGhpcy5hbGxvd2VkX2NvbXBhbnlfaWRzLmxlbmd0aD09PTEpe2Ryb3Bkb3duTWVudS5maW5kKCcuZmEtY2hlY2stc3F1YXJlJykucmVtb3ZlQ2xhc3MoJ2ZhLWNoZWNrLXNxdWFyZScpLmFkZENsYXNzKCdmYS1zcXVhcmUtbycpO2Ryb3Bkb3duSXRlbS5maW5kKCcuZmEtc3F1YXJlLW8nKS5yZW1vdmVDbGFzcygnZmEtc3F1YXJlLW8nKS5hZGRDbGFzcygnZmEtY2hlY2stc3F1YXJlJyk7YWxsb3dlZF9jb21wYW55X2lkcz1bY29tcGFueUlEXX1lbHNle2FsbG93ZWRfY29tcGFueV9pZHMucHVzaChjb21wYW55SUQpO2Ryb3Bkb3duSXRlbS5maW5kKCcuZmEtc3F1YXJlLW8nKS5yZW1vdmVDbGFzcygnZmEtc3F1YXJlLW8nKS5hZGRDbGFzcygnZmEtY2hlY2stc3F1YXJlJyk7fX0Kc2Vzc2lvbi5zZXRDb21wYW5pZXMoY29tcGFueUlELGFsbG93ZWRfY29tcGFueV9pZHMpO30sX29uVG9nZ2xlQ29tcGFueUNsaWNrOmZ1bmN0aW9uKGV2KXtldi5zdG9wUHJvcGFnYXRpb24oKTt2YXIgZHJvcGRvd25JdGVtPSQoZXYuY3VycmVudFRhcmdldCkucGFyZW50KCk7dmFyIGNvbXBhbnlJRD1kcm9wZG93bkl0ZW0uZGF0YSgnY29tcGFueS1pZCcpO3ZhciBhbGxvd2VkX2NvbXBhbnlfaWRzPXRoaXMuYWxsb3dlZF9jb21wYW55X2lkczt2YXIgY3VycmVudF9jb21wYW55X2lkPWFsbG93ZWRfY29tcGFueV9pZHNbMF07aWYoZHJvcGRvd25JdGVtLmZpbmQoJy5mYS1zcXVhcmUtbycpLmxlbmd0aCl7YWxsb3dlZF9jb21wYW55X2lkcy5wdXNoKGNvbXBhbnlJRCk7ZHJvcGRvd25JdGVtLmZpbmQoJy5mYS1zcXVhcmUtbycpLnJlbW92ZUNsYXNzKCdmYS1zcXVhcmUtbycpLmFkZENsYXNzKCdmYS1jaGVjay1zcXVhcmUnKTt9ZWxzZXthbGxvd2VkX2NvbXBhbnlfaWRzLnNwbGljZShhbGxvd2VkX2NvbXBhbnlfaWRzLmluZGV4T2YoY29tcGFueUlEKSwxKTtkcm9wZG93bkl0ZW0uZmluZCgnLmZhLWNoZWNrLXNxdWFyZScpLmFkZENsYXNzKCdmYS1zcXVhcmUtbycpLnJlbW92ZUNsYXNzKCdmYS1jaGVjay1zcXVhcmUnKTt9CnNlc3Npb24uc2V0Q29tcGFuaWVzKGN1cnJlbnRfY29tcGFueV9pZCxhbGxvd2VkX2NvbXBhbnlfaWRzKTt9LH0pO2lmKHNlc3Npb24uZGlzcGxheV9zd2l0Y2hfY29tcGFueV9tZW51KXtTeXN0cmF5TWVudS5JdGVtcy5wdXNoKFN3aXRjaENvbXBhbnlNZW51KTt9CnJldHVybiBTd2l0Y2hDb21wYW55TWVudTt9KTs7CgovKiAvd2ViL3N0YXRpYy9zcmMvanMvY2hyb21lL3VzZXJfbWVudS5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwpvZG9vLmRlZmluZSgnd2ViLlVzZXJNZW51JyxmdW5jdGlvbihyZXF1aXJlKXsidXNlIHN0cmljdCI7dmFyIGNvbmZpZz1yZXF1aXJlKCd3ZWIuY29uZmlnJyk7dmFyIGNvcmU9cmVxdWlyZSgnd2ViLmNvcmUnKTt2YXIgZnJhbWV3b3JrPXJlcXVpcmUoJ3dlYi5mcmFtZXdvcmsnKTt2YXIgRGlhbG9nPXJlcXVpcmUoJ3dlYi5EaWFsb2cnKTt2YXIgV2lkZ2V0PXJlcXVpcmUoJ3dlYi5XaWRnZXQnKTt2YXIgX3Q9Y29yZS5fdDt2YXIgUVdlYj1jb3JlLnF3ZWI7dmFyIFVzZXJNZW51PVdpZGdldC5leHRlbmQoe3RlbXBsYXRlOidVc2VyTWVudScsc3RhcnQ6ZnVuY3Rpb24oKXt2YXIgc2VsZj10aGlzO3ZhciBzZXNzaW9uPXRoaXMuZ2V0U2Vzc2lvbigpO3RoaXMuJGVsLm9uKCdjbGljaycsJ1tkYXRhLW1lbnVdJyxmdW5jdGlvbihldil7ZXYucHJldmVudERlZmF1bHQoKTt2YXIgbWVudT0kKHRoaXMpLmRhdGEoJ21lbnUnKTtzZWxmWydfb25NZW51JyttZW51LmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpK21lbnUuc2xpY2UoMSldKCk7fSk7cmV0dXJuIHRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKS50aGVuKGZ1bmN0aW9uKCl7dmFyICRhdmF0YXI9c2VsZi4kKCcub2VfdG9wYmFyX2F2YXRhcicpO2lmKCFzZXNzaW9uLnVpZCl7JGF2YXRhci5hdHRyKCdzcmMnLCRhdmF0YXIuZGF0YSgnZGVmYXVsdC1zcmMnKSk7cmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO30KdmFyIHRvcGJhcl9uYW1lPXNlc3Npb24ubmFtZTtpZihjb25maWcuaXNEZWJ1ZygpKXt0b3BiYXJfbmFtZT1fLnN0ci5zcHJpbnRmKCIlcyAoJXMpIix0b3BiYXJfbmFtZSxzZXNzaW9uLmRiKTt9CnNlbGYuJCgnLm9lX3RvcGJhcl9uYW1lJykudGV4dCh0b3BiYXJfbmFtZSk7dmFyIGF2YXRhcl9zcmM9c2Vzc2lvbi51cmwoJy93ZWIvaW1hZ2UnLHttb2RlbDoncmVzLnVzZXJzJyxmaWVsZDonaW1hZ2VfMTI4JyxpZDpzZXNzaW9uLnVpZCx9KTskYXZhdGFyLmF0dHIoJ3NyYycsYXZhdGFyX3NyYyk7fSk7fSxfb25NZW51QWNjb3VudDpmdW5jdGlvbigpe3ZhciBzZWxmPXRoaXM7dGhpcy50cmlnZ2VyX3VwKCdjbGVhcl91bmNvbW1pdHRlZF9jaGFuZ2VzJyx7Y2FsbGJhY2s6ZnVuY3Rpb24oKXtzZWxmLl9ycGMoe3JvdXRlOicvd2ViL3Nlc3Npb24vYWNjb3VudCd9KS50aGVuKGZ1bmN0aW9uKHVybCl7ZnJhbWV3b3JrLnJlZGlyZWN0KHVybCk7fSkuZ3VhcmRlZENhdGNoKGZ1bmN0aW9uKHJlc3VsdCxldil7ZXYucHJldmVudERlZmF1bHQoKTtmcmFtZXdvcmsucmVkaXJlY3QoJ2h0dHBzOi8vYWNjb3VudHMub2Rvby5jb20vYWNjb3VudCcpO30pO30sfSk7fSxfb25NZW51RG9jdW1lbnRhdGlvbjpmdW5jdGlvbigpe3dpbmRvdy5vcGVuKCdodHRwczovL3d3dy5vZG9vLmNvbS9kb2N1bWVudGF0aW9uL3VzZXInLCdfYmxhbmsnKTt9LF9vbk1lbnVMb2dvdXQ6ZnVuY3Rpb24oKXt0aGlzLnRyaWdnZXJfdXAoJ2NsZWFyX3VuY29tbWl0dGVkX2NoYW5nZXMnLHtjYWxsYmFjazp0aGlzLmRvX2FjdGlvbi5iaW5kKHRoaXMsJ2xvZ291dCcpLH0pO30sX29uTWVudVNldHRpbmdzOmZ1bmN0aW9uKCl7dmFyIHNlbGY9dGhpczt2YXIgc2Vzc2lvbj10aGlzLmdldFNlc3Npb24oKTt0aGlzLnRyaWdnZXJfdXAoJ2NsZWFyX3VuY29tbWl0dGVkX2NoYW5nZXMnLHtjYWxsYmFjazpmdW5jdGlvbigpe3NlbGYuX3JwYyh7bW9kZWw6InJlcy51c2VycyIsbWV0aG9kOiJhY3Rpb25fZ2V0In0pLnRoZW4oZnVuY3Rpb24ocmVzdWx0KXtyZXN1bHQucmVzX2lkPXNlc3Npb24udWlkO3NlbGYuZG9fYWN0aW9uKHJlc3VsdCk7fSk7fSx9KTt9LF9vbk1lbnVTdXBwb3J0OmZ1bmN0aW9uKCl7d2luZG93Lm9wZW4oJ2h0dHBzOi8vd3d3Lm9kb28uY29tL2J1eScsJ19ibGFuaycpO30sX29uTWVudVNob3J0Y3V0czpmdW5jdGlvbigpe25ldyBEaWFsb2codGhpcyx7c2l6ZTonbGFyZ2UnLGRpYWxvZ0NsYXNzOidvX2FjdF93aW5kb3cnLHRpdGxlOl90KCJLZXlib2FyZCBTaG9ydGN1dHMiKSwkY29udGVudDokKFFXZWIucmVuZGVyKCJVc2VyTWVudS5zaG9ydGN1dHMiKSl9KS5vcGVuKCk7fSx9KTtyZXR1cm4gVXNlck1lbnU7fSk7OwoKLyogL3dlYi9zdGF0aWMvc3JjL2pzL2Nocm9tZS9tZW51LmpzIGRlZmluZWQgaW4gYnVuZGxlICd3ZWIuYXNzZXRzX2JhY2tlbmQnICovCm9kb28uZGVmaW5lKCd3ZWIuTWVudScsZnVuY3Rpb24ocmVxdWlyZSl7InVzZSBzdHJpY3QiO3ZhciBBcHBzTWVudT1yZXF1aXJlKCd3ZWIuQXBwc01lbnUnKTt2YXIgY29uZmlnPXJlcXVpcmUoJ3dlYi5jb25maWcnKTt2YXIgY29yZT1yZXF1aXJlKCd3ZWIuY29yZScpO3ZhciBkb209cmVxdWlyZSgnd2ViLmRvbScpO3ZhciBTeXN0cmF5TWVudT1yZXF1aXJlKCd3ZWIuU3lzdHJheU1lbnUnKTt2YXIgVXNlck1lbnU9cmVxdWlyZSgnd2ViLlVzZXJNZW51Jyk7dmFyIFdpZGdldD1yZXF1aXJlKCd3ZWIuV2lkZ2V0Jyk7VXNlck1lbnUucHJvdG90eXBlLnNlcXVlbmNlPTA7U3lzdHJheU1lbnUuSXRlbXMucHVzaChVc2VyTWVudSk7dmFyIFFXZWI9Y29yZS5xd2ViO3ZhciBNZW51PVdpZGdldC5leHRlbmQoe3RlbXBsYXRlOidNZW51JyxtZW51c1RlbXBsYXRlOidNZW51LnNlY3Rpb25zJyxldmVudHM6eydtb3VzZW92ZXIgLm9fbWVudV9zZWN0aW9ucyA+IGxpOm5vdCguc2hvdyknOidfb25Nb3VzZU92ZXJNZW51JywnY2xpY2sgLm9fbWVudV9icmFuZCc6J19vbkFwcE5hbWVDbGlja2VkJyx9LGluaXQ6ZnVuY3Rpb24ocGFyZW50LG1lbnVfZGF0YSl7dmFyIHNlbGY9dGhpczt0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy4kbWVudV9zZWN0aW9ucz17fTt0aGlzLm1lbnVfZGF0YT1tZW51X2RhdGE7dmFyICRtZW51X3NlY3Rpb25zPSQoUVdlYi5yZW5kZXIodGhpcy5tZW51c1RlbXBsYXRlLHttZW51X2RhdGE6dGhpcy5tZW51X2RhdGEsfSkpOyRtZW51X3NlY3Rpb25zLmZpbHRlcignc2VjdGlvbicpLmVhY2goZnVuY3Rpb24oKXtzZWxmLiRtZW51X3NlY3Rpb25zW3BhcnNlSW50KHRoaXMuY2xhc3NOYW1lLDEwKV09JCh0aGlzKS5jaGlsZHJlbignbGknKTt9KTtjb3JlLmJ1cy5vbignY2hhbmdlX21lbnVfc2VjdGlvbicsdGhpcyx0aGlzLmNoYW5nZV9tZW51X3NlY3Rpb24pO30sc3RhcnQ6ZnVuY3Rpb24oKXt2YXIgc2VsZj10aGlzO3RoaXMuJG1lbnVfYXBwcz10aGlzLiQoJy5vX21lbnVfYXBwcycpO3RoaXMuJG1lbnVfYnJhbmRfcGxhY2Vob2xkZXI9dGhpcy4kKCcub19tZW51X2JyYW5kJyk7dGhpcy4kc2VjdGlvbl9wbGFjZWhvbGRlcj10aGlzLiQoJy5vX21lbnVfc2VjdGlvbnMnKTt2YXIgb25fc2Vjb25kYXJ5X21lbnVfY2xpY2s9ZnVuY3Rpb24oZXYpe2V2LnByZXZlbnREZWZhdWx0KCk7dmFyIG1lbnVfaWQ9JChldi5jdXJyZW50VGFyZ2V0KS5kYXRhKCdtZW51Jyk7dmFyIGFjdGlvbl9pZD0kKGV2LmN1cnJlbnRUYXJnZXQpLmRhdGEoJ2FjdGlvbi1pZCcpO3NlbGYuX29uX3NlY29uZGFyeV9tZW51X2NsaWNrKG1lbnVfaWQsYWN0aW9uX2lkKTt9O3ZhciBtZW51X2lkcz1fLmtleXModGhpcy4kbWVudV9zZWN0aW9ucyk7dmFyIHByaW1hcnlfbWVudV9pZCwkc2VjdGlvbjtmb3IodmFyIGk9MDtpPG1lbnVfaWRzLmxlbmd0aDtpKyspe3ByaW1hcnlfbWVudV9pZD1tZW51X2lkc1tpXTskc2VjdGlvbj10aGlzLiRtZW51X3NlY3Rpb25zW3ByaW1hcnlfbWVudV9pZF07JHNlY3Rpb24ub24oJ2NsaWNrJywnYVtkYXRhLW1lbnVdJyxzZWxmLG9uX3NlY29uZGFyeV9tZW51X2NsaWNrLmJpbmQodGhpcykpO30KdGhpcy5fYXBwc01lbnU9bmV3IEFwcHNNZW51KHNlbGYsdGhpcy5tZW51X2RhdGEpO3ZhciBhcHBzTWVudVByb209dGhpcy5fYXBwc01lbnUuYXBwZW5kVG8odGhpcy4kbWVudV9hcHBzKTt0aGlzLnN5c3RyYXlfbWVudT1uZXcgU3lzdHJheU1lbnUodGhpcyk7dmFyIHN5c3RyYXlNZW51UHJvbT10aGlzLnN5c3RyYXlfbWVudS5hdHRhY2hUbyh0aGlzLiQoJy5vX21lbnVfc3lzdHJheScpKS50aGVuKGZ1bmN0aW9uKCl7ZG9tLmluaXRBdXRvTW9yZU1lbnUoc2VsZi4kc2VjdGlvbl9wbGFjZWhvbGRlcix7bWF4V2lkdGg6ZnVuY3Rpb24oKXtyZXR1cm4gc2VsZi4kZWwud2lkdGgoKS0oc2VsZi4kbWVudV9hcHBzLm91dGVyV2lkdGgodHJ1ZSkrc2VsZi4kbWVudV9icmFuZF9wbGFjZWhvbGRlci5vdXRlcldpZHRoKHRydWUpK3NlbGYuc3lzdHJheV9tZW51LiRlbC5vdXRlcldpZHRoKHRydWUpKTt9LHNpemVDbGFzczonU00nLH0pO30pO3JldHVybiBQcm9taXNlLmFsbChbdGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpLGFwcHNNZW51UHJvbSxzeXN0cmF5TWVudVByb21dKTt9LGNoYW5nZV9tZW51X3NlY3Rpb246ZnVuY3Rpb24ocHJpbWFyeV9tZW51X2lkKXtpZighdGhpcy4kbWVudV9zZWN0aW9uc1twcmltYXJ5X21lbnVfaWRdKXt0aGlzLl91cGRhdGVNZW51QnJhbmQoKTtyZXR1cm47fQppZih0aGlzLmN1cnJlbnRfcHJpbWFyeV9tZW51PT09cHJpbWFyeV9tZW51X2lkKXtyZXR1cm47fQppZih0aGlzLmN1cnJlbnRfcHJpbWFyeV9tZW51KXt0aGlzLiRtZW51X3NlY3Rpb25zW3RoaXMuY3VycmVudF9wcmltYXJ5X21lbnVdLmRldGFjaCgpO30KZm9yKHZhciBpPTA7aTx0aGlzLm1lbnVfZGF0YS5jaGlsZHJlbi5sZW5ndGg7aSsrKXtpZih0aGlzLm1lbnVfZGF0YS5jaGlsZHJlbltpXS5pZD09PXByaW1hcnlfbWVudV9pZCl7dGhpcy5fdXBkYXRlTWVudUJyYW5kKHRoaXMubWVudV9kYXRhLmNoaWxkcmVuW2ldLm5hbWUpO2JyZWFrO319CnRoaXMuJG1lbnVfc2VjdGlvbnNbcHJpbWFyeV9tZW51X2lkXS5hcHBlbmRUbyh0aGlzLiRzZWN0aW9uX3BsYWNlaG9sZGVyKTt0aGlzLmN1cnJlbnRfcHJpbWFyeV9tZW51PXByaW1hcnlfbWVudV9pZDtjb3JlLmJ1cy50cmlnZ2VyKCdyZXNpemUnKTt9LF90cmlnZ2VyX21lbnVfY2xpY2tlZDpmdW5jdGlvbihtZW51X2lkLGFjdGlvbl9pZCl7dGhpcy50cmlnZ2VyX3VwKCdtZW51X2NsaWNrZWQnLHtpZDptZW51X2lkLGFjdGlvbl9pZDphY3Rpb25faWQscHJldmlvdXNfbWVudV9pZDp0aGlzLmN1cnJlbnRfc2Vjb25kYXJ5X21lbnV8fHRoaXMuY3VycmVudF9wcmltYXJ5X21lbnUsfSk7fSxfdXBkYXRlTWVudUJyYW5kOmZ1bmN0aW9uKGJyYW5kTmFtZSl7aWYoYnJhbmROYW1lKXt0aGlzLiRtZW51X2JyYW5kX3BsYWNlaG9sZGVyLnRleHQoYnJhbmROYW1lKS5zaG93KCk7dGhpcy4kc2VjdGlvbl9wbGFjZWhvbGRlci5zaG93KCk7fWVsc2V7dGhpcy4kbWVudV9icmFuZF9wbGFjZWhvbGRlci5oaWRlKCkKdGhpcy4kc2VjdGlvbl9wbGFjZWhvbGRlci5oaWRlKCk7fX0sX29uX3NlY29uZGFyeV9tZW51X2NsaWNrOmZ1bmN0aW9uKG1lbnVfaWQsYWN0aW9uX2lkKXt2YXIgc2VsZj10aGlzO2lmKGFjdGlvbl9pZCl7c2VsZi5fdHJpZ2dlcl9tZW51X2NsaWNrZWQobWVudV9pZCxhY3Rpb25faWQpO3RoaXMuY3VycmVudF9zZWNvbmRhcnlfbWVudT1tZW51X2lkO319LGFjdGlvbl9pZF90b19wcmltYXJ5X21lbnVfaWQ6ZnVuY3Rpb24oYWN0aW9uX2lkKXt2YXIgcHJpbWFyeV9tZW51X2lkLGZvdW5kO2Zvcih2YXIgaT0wO2k8dGhpcy5tZW51X2RhdGEuY2hpbGRyZW4ubGVuZ3RoJiYhcHJpbWFyeV9tZW51X2lkO2krKyl7Zm91bmQ9dGhpcy5fYWN0aW9uX2lkX2luX3N1YnRyZWUodGhpcy5tZW51X2RhdGEuY2hpbGRyZW5baV0sYWN0aW9uX2lkKTtpZihmb3VuZCl7cHJpbWFyeV9tZW51X2lkPXRoaXMubWVudV9kYXRhLmNoaWxkcmVuW2ldLmlkO319CnJldHVybiBwcmltYXJ5X21lbnVfaWQ7fSxfYWN0aW9uX2lkX2luX3N1YnRyZWU6ZnVuY3Rpb24ocm9vdCxhY3Rpb25faWQpe2lmKHJvb3QuYWN0aW9uJiZyb290LmFjdGlvbi5zcGxpdCgnLCcpWzFdPT09U3RyaW5nKGFjdGlvbl9pZCkpe3JldHVybiB0cnVlO30KdmFyIGZvdW5kO2Zvcih2YXIgaT0wO2k8cm9vdC5jaGlsZHJlbi5sZW5ndGgmJiFmb3VuZDtpKyspe2ZvdW5kPXRoaXMuX2FjdGlvbl9pZF9pbl9zdWJ0cmVlKHJvb3QuY2hpbGRyZW5baV0sYWN0aW9uX2lkKTt9CnJldHVybiBmb3VuZDt9LG1lbnVfaWRfdG9fYWN0aW9uX2lkOmZ1bmN0aW9uKG1lbnVfaWQscm9vdCl7aWYoIXJvb3Qpe3Jvb3Q9JC5leHRlbmQodHJ1ZSx7fSx0aGlzLm1lbnVfZGF0YSk7fQppZihyb290LmlkPT09bWVudV9pZCl7cmV0dXJuIHJvb3QuYWN0aW9uLnNwbGl0KCcsJylbMV07fQpmb3IodmFyIGk9MDtpPHJvb3QuY2hpbGRyZW4ubGVuZ3RoO2krKyl7dmFyIGFjdGlvbl9pZD10aGlzLm1lbnVfaWRfdG9fYWN0aW9uX2lkKG1lbnVfaWQscm9vdC5jaGlsZHJlbltpXSk7aWYoYWN0aW9uX2lkIT09dW5kZWZpbmVkKXtyZXR1cm4gYWN0aW9uX2lkO319CnJldHVybiB1bmRlZmluZWQ7fSxnZXRDdXJyZW50UHJpbWFyeU1lbnU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jdXJyZW50X3ByaW1hcnlfbWVudTt9LG9wZW5GaXJzdEFwcDpmdW5jdGlvbigpe3RoaXMuX2FwcHNNZW51Lm9wZW5GaXJzdEFwcCgpO30sX29uQXBwTmFtZUNsaWNrZWQ6ZnVuY3Rpb24oZXYpe3ZhciBhY3Rpb25JRD1wYXJzZUludCh0aGlzLm1lbnVfaWRfdG9fYWN0aW9uX2lkKHRoaXMuY3VycmVudF9wcmltYXJ5X21lbnUpKTt0aGlzLl90cmlnZ2VyX21lbnVfY2xpY2tlZCh0aGlzLmN1cnJlbnRfcHJpbWFyeV9tZW51LGFjdGlvbklEKTt9LF9vbk1vdXNlT3Zlck1lbnU6ZnVuY3Rpb24oZXYpe2lmKGNvbmZpZy5kZXZpY2UuaXNNb2JpbGUpe3JldHVybjt9CnZhciAkdGFyZ2V0PSQoZXYuY3VycmVudFRhcmdldCk7dmFyICRvcGVuZWQ9JHRhcmdldC5zaWJsaW5ncygnLnNob3cnKTtpZigkb3BlbmVkLmxlbmd0aCl7JG9wZW5lZC5maW5kKCdbZGF0YS10b2dnbGU9ImRyb3Bkb3duIl0nKS5kcm9wZG93bigndG9nZ2xlJyk7JG9wZW5lZC5yZW1vdmVDbGFzcygnc2hvdycpOyR0YXJnZXQuZmluZCgnW2RhdGEtdG9nZ2xlPSJkcm9wZG93biJdJykuZHJvcGRvd24oJ3RvZ2dsZScpOyR0YXJnZXQuYWRkQ2xhc3MoJ3Nob3cnKTt9fSx9KTtyZXR1cm4gTWVudTt9KTs7CgovKiAvd2ViL3N0YXRpYy9zcmMvanMvY2hyb21lL2FwcHNfbWVudS5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwpvZG9vLmRlZmluZSgnd2ViLkFwcHNNZW51JyxmdW5jdGlvbihyZXF1aXJlKXsidXNlIHN0cmljdCI7dmFyIFdpZGdldD1yZXF1aXJlKCd3ZWIuV2lkZ2V0Jyk7dmFyIEFwcHNNZW51PVdpZGdldC5leHRlbmQoe3RlbXBsYXRlOidBcHBzTWVudScsZXZlbnRzOnsnY2xpY2sgLm9fYXBwJzonX29uQXBwc01lbnVJdGVtQ2xpY2tlZCcsfSxpbml0OmZ1bmN0aW9uKHBhcmVudCxtZW51RGF0YSl7dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3RoaXMuX2FjdGl2ZUFwcD11bmRlZmluZWQ7dGhpcy5fYXBwcz1fLm1hcChtZW51RGF0YS5jaGlsZHJlbixmdW5jdGlvbihhcHBNZW51RGF0YSl7cmV0dXJue2FjdGlvbklEOnBhcnNlSW50KGFwcE1lbnVEYXRhLmFjdGlvbi5zcGxpdCgnLCcpWzFdKSxtZW51SUQ6YXBwTWVudURhdGEuaWQsbmFtZTphcHBNZW51RGF0YS5uYW1lLHhtbElEOmFwcE1lbnVEYXRhLnhtbGlkLH07fSk7fSxnZXRBcHBzOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2FwcHM7fSxvcGVuRmlyc3RBcHA6ZnVuY3Rpb24oKXtpZighdGhpcy5fYXBwcy5sZW5ndGgpe3JldHVybn0KdmFyIGZpcnN0QXBwPXRoaXMuX2FwcHNbMF07dGhpcy5fb3BlbkFwcChmaXJzdEFwcCk7fSxfb3BlbkFwcDpmdW5jdGlvbihhcHApe3RoaXMuX3NldEFjdGl2ZUFwcChhcHApO3RoaXMudHJpZ2dlcl91cCgnYXBwX2NsaWNrZWQnLHthY3Rpb25faWQ6YXBwLmFjdGlvbklELG1lbnVfaWQ6YXBwLm1lbnVJRCx9KTt9LF9zZXRBY3RpdmVBcHA6ZnVuY3Rpb24oYXBwKXt2YXIgJG9sZEFjdGl2ZUFwcD10aGlzLiQoJy5vX2FwcC5hY3RpdmUnKTskb2xkQWN0aXZlQXBwLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTt2YXIgJG5ld0FjdGl2ZUFwcD10aGlzLiQoJy5vX2FwcFtkYXRhLWFjdGlvbi1pZD0iJythcHAuYWN0aW9uSUQrJyJdJyk7JG5ld0FjdGl2ZUFwcC5hZGRDbGFzcygnYWN0aXZlJyk7fSxfb25BcHBzTWVudUl0ZW1DbGlja2VkOmZ1bmN0aW9uKGV2KXt2YXIgJHRhcmdldD0kKGV2LmN1cnJlbnRUYXJnZXQpO3ZhciBhY3Rpb25JRD0kdGFyZ2V0LmRhdGEoJ2FjdGlvbi1pZCcpO3ZhciBtZW51SUQ9JHRhcmdldC5kYXRhKCdtZW51LWlkJyk7dmFyIGFwcD1fLmZpbmRXaGVyZSh0aGlzLl9hcHBzLHthY3Rpb25JRDphY3Rpb25JRCxtZW51SUQ6bWVudUlEfSk7dGhpcy5fb3BlbkFwcChhcHApO30sfSk7cmV0dXJuIEFwcHNNZW51O30pOzsKCi8qIC93ZWIvc3RhdGljL3NyYy9qcy93aWRnZXRzL2Ryb3Bkb3duX21lbnUuanMgZGVmaW5lZCBpbiBidW5kbGUgJ3dlYi5hc3NldHNfYmFja2VuZCcgKi8Kb2Rvby5kZWZpbmUoJ3dlYi5Ecm9wZG93bk1lbnUnLGZ1bmN0aW9uKHJlcXVpcmUpeyJ1c2Ugc3RyaWN0Ijt2YXIgY29yZT1yZXF1aXJlKCd3ZWIuY29yZScpO3ZhciBXaWRnZXQ9cmVxdWlyZSgnd2ViLldpZGdldCcpO3ZhciBRV2ViPWNvcmUucXdlYjt2YXIgRHJvcGRvd25NZW51PVdpZGdldC5leHRlbmQoe3RlbXBsYXRlOid3ZWIuRHJvcGRvd25NZW51JyxldmVudHM6eydjbGljayAub19tZW51X2l0ZW0nOidfb25JdGVtQ2xpY2snLCdjbGljayAub19pdGVtX29wdGlvbic6J19vbk9wdGlvbkNsaWNrJywnY2xpY2sgc3Bhbi5vX3RyYXNoX2J1dHRvbic6J19vblRyYXNoQnV0dG9uQ2xpY2snLCdoaWRkZW4uYnMuZHJvcGRvd24nOidfb25Cb290c3RyYXBDbG9zZScsJ2NsaWNrIC5kcm9wZG93bi1pdGVtLXRleHQnOidfb25Ecm9wRG93bkl0ZW1UZXh0Q2xpY2snLH0saW5pdDpmdW5jdGlvbihwYXJlbnQsaXRlbXMpe3RoaXMuX3N1cGVyKHBhcmVudCk7dGhpcy5kcm9wZG93bkNhdGVnb3J5PW51bGw7dGhpcy5kcm9wZG93blRpdGxlPW51bGw7dGhpcy5kcm9wZG93bkljb249bnVsbDt0aGlzLmRyb3Bkb3duU3ltYm9sPWZhbHNlO3RoaXMuZHJvcGRvd25TdHlsZT17ZWw6e2NsYXNzOididG4tZ3JvdXAgb19kcm9wZG93bicsYXR0cnM6e319LG1haW5CdXR0b246e2NsYXNzOidvX2Ryb3Bkb3duX3RvZ2dsZXJfYnRuIGJ0biBidG4tc2Vjb25kYXJ5ICcrJ2Ryb3Bkb3duLXRvZ2dsZSAnKwoodGhpcy5kcm9wZG93blN5bWJvbD8nby1uby1jYXJldCc6JycpfSx9O3RoaXMuaXRlbXM9aXRlbXM7dGhpcy5vcGVuSXRlbXM9e307fSx1cGRhdGU6ZnVuY3Rpb24oaXRlbXMpe3RoaXMuaXRlbXM9aXRlbXM7dGhpcy5fcmVuZGVyTWVudUl0ZW1zKCk7fSxfcmVuZGVyTWVudUl0ZW1zOmZ1bmN0aW9uKCl7dmFyIG5ld01lbnVJdGVtcz1RV2ViLnJlbmRlcignRHJvcGRvd25NZW51Lk1lbnVJdGVtcycse3dpZGdldDp0aGlzfSk7dGhpcy4kZWwuZmluZCgnLm9fbWVudV9pdGVtLCAuZHJvcGRvd24tZGl2aWRlcltkYXRhLXJlbW92YWJsZT0iMSJdJykucmVtb3ZlKCk7dGhpcy4kKCcub19kcm9wZG93bl9tZW51JykucHJlcGVuZChuZXdNZW51SXRlbXMpO30sX29uQm9vdHN0cmFwQ2xvc2U6ZnVuY3Rpb24oKXt0aGlzLm9wZW5JdGVtcz17fTt0aGlzLl9yZW5kZXJNZW51SXRlbXMoKTt9LF9vbkRyb3BEb3duSXRlbVRleHRDbGljazpmdW5jdGlvbihldil7ZXYuc3RvcFByb3BhZ2F0aW9uKCk7fSxfb25JdGVtQ2xpY2s6ZnVuY3Rpb24oZXZlbnQpe2V2ZW50LnByZXZlbnREZWZhdWx0KCk7ZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7dmFyIGlkPSQoZXZlbnQuY3VycmVudFRhcmdldCkuZGF0YSgnaWQnKTt2YXIgaXRlbT10aGlzLml0ZW1zLmZpbmQoZnVuY3Rpb24oaXRlbSl7cmV0dXJuIGl0ZW0uaWQ9PT1pZDt9KTtpZihpdGVtLmhhc09wdGlvbnMpe3RoaXMub3Blbkl0ZW1zW2lkXT0hdGhpcy5vcGVuSXRlbXNbaWRdO3RoaXMuX3JlbmRlck1lbnVJdGVtcygpO31lbHNle3RoaXMudHJpZ2dlcl91cCgnbWVudV9pdGVtX2NsaWNrZWQnLHtpZDppZH0pO319LF9vbk9wdGlvbkNsaWNrOmZ1bmN0aW9uKGV2ZW50KXtldmVudC5wcmV2ZW50RGVmYXVsdCgpO2V2ZW50LnN0b3BQcm9wYWdhdGlvbigpO3ZhciBvcHRpb25JZD0kKGV2ZW50LmN1cnJlbnRUYXJnZXQpLmRhdGEoJ29wdGlvbl9pZCcpO3ZhciBpZD0kKGV2ZW50LmN1cnJlbnRUYXJnZXQpLmRhdGEoJ2l0ZW1faWQnKTt0aGlzLnRyaWdnZXJfdXAoJ2l0ZW1fb3B0aW9uX2NsaWNrZWQnLHtpZDppZCxvcHRpb25JZDpvcHRpb25JZH0pO30sX29uVHJhc2hCdXR0b25DbGljazpmdW5jdGlvbihldmVudCl7fSx9KTtyZXR1cm4gRHJvcGRvd25NZW51O30pOzsKCi8qIC93ZWIvc3RhdGljL3NyYy9qcy93aWRnZXRzL3BpZV9jaGFydC5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwpvZG9vLmRlZmluZSgnd2ViLlBpZUNoYXJ0JyxmdW5jdGlvbihyZXF1aXJlKXsidXNlIHN0cmljdCI7dmFyIGNvcmU9cmVxdWlyZSgnd2ViLmNvcmUnKTt2YXIgRG9tYWluPXJlcXVpcmUoJ3dlYi5Eb21haW4nKTt2YXIgdmlld1JlZ2lzdHJ5PXJlcXVpcmUoJ3dlYi52aWV3X3JlZ2lzdHJ5Jyk7dmFyIFdpZGdldD1yZXF1aXJlKCd3ZWIuV2lkZ2V0Jyk7dmFyIHdpZGdldFJlZ2lzdHJ5PXJlcXVpcmUoJ3dlYi53aWRnZXRfcmVnaXN0cnknKTt2YXIgcXdlYj1jb3JlLnF3ZWI7dmFyIFBpZUNoYXJ0PVdpZGdldC5leHRlbmQoe2NsYXNzTmFtZTonb19waWVfY2hhcnQnLHhtbERlcGVuZGVuY2llczpbJy93ZWIvc3RhdGljL3NyYy94bWwvY2hhcnQueG1sJ10saW5pdDpmdW5jdGlvbihwYXJlbnQscmVjb3JkLG5vZGUpe3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt2YXIgbW9kaWZpZXJzPW5vZGUuYXR0cnMubW9kaWZpZXJzO3ZhciBkb21haW49cmVjb3JkLmRvbWFpbi5jb25jYXQoRG9tYWluLnByb3RvdHlwZS5zdHJpbmdUb0FycmF5KG1vZGlmaWVycy5kb21haW58fCdbXScpKTt2YXIgYXJjaD1xd2ViLnJlbmRlcignd2ViLlBpZUNoYXJ0Jyx7bW9kaWZpZXJzOm1vZGlmaWVycyx0aXRsZTpub2RlLmF0dHJzLnRpdGxlfHxtb2RpZmllcnMudGl0bGV8fG1vZGlmaWVycy5tZWFzdXJlLH0pO3ZhciBwaWVDaGFydENvbnRleHQ9SlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShyZWNvcmQuY29udGV4dCkpO2RlbGV0ZSBwaWVDaGFydENvbnRleHQuZ3JhcGhfbW9kZTtkZWxldGUgcGllQ2hhcnRDb250ZXh0LmdyYXBoX21lYXN1cmU7ZGVsZXRlIHBpZUNoYXJ0Q29udGV4dC5ncmFwaF9ncm91cGJ5czt0aGlzLnN1YlZpZXdQYXJhbXM9e21vZGVsTmFtZTpyZWNvcmQubW9kZWwsd2l0aENvbnRyb2xQYW5lbDpmYWxzZSxpc0VtYmVkZGVkOnRydWUsbW9kZToncGllJyx9O3RoaXMuc3ViVmlld1BhcmFtcy5zZWFyY2hRdWVyeT17Y29udGV4dDpwaWVDaGFydENvbnRleHQsZG9tYWluOmRvbWFpbixncm91cEJ5OltdLH07dGhpcy52aWV3SW5mbz17YXJjaDphcmNoLGZpZWxkczpyZWNvcmQuZmllbGRzLHZpZXdGaWVsZHM6cmVjb3JkLmZpZWxkc0luZm8uZGFzaGJvYXJkLH07fSx3aWxsU3RhcnQ6ZnVuY3Rpb24oKXt2YXIgc2VsZj10aGlzO3ZhciBkZWYxPXRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt2YXIgU3ViVmlldz12aWV3UmVnaXN0cnkuZ2V0KCdncmFwaCcpO3ZhciBzdWJWaWV3PW5ldyBTdWJWaWV3KHRoaXMudmlld0luZm8sdGhpcy5zdWJWaWV3UGFyYW1zKTt2YXIgZGVmMj1zdWJWaWV3LmdldENvbnRyb2xsZXIodGhpcykudGhlbihmdW5jdGlvbihjb250cm9sbGVyKXtzZWxmLmNvbnRyb2xsZXI9Y29udHJvbGxlcjtyZXR1cm4gc2VsZi5jb250cm9sbGVyLmFwcGVuZFRvKGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKSk7fSk7cmV0dXJuIFByb21pc2UuYWxsKFtkZWYxLGRlZjJdKTt9LHN0YXJ0OmZ1bmN0aW9uKCl7dGhpcy4kZWwuYXBwZW5kKHRoaXMuY29udHJvbGxlci4kZWwpO3JldHVybiB0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fSxvbl9hdHRhY2hfY2FsbGJhY2s6ZnVuY3Rpb24oKXt0aGlzLmNvbnRyb2xsZXIub25fYXR0YWNoX2NhbGxiYWNrKCk7fSx9KTt3aWRnZXRSZWdpc3RyeS5hZGQoJ3BpZV9jaGFydCcsUGllQ2hhcnQpO3JldHVybiBQaWVDaGFydDt9KTs7CgovKiAvd2ViL3N0YXRpYy9zcmMvanMvd2lkZ2V0cy9yaWJib24uanMgZGVmaW5lZCBpbiBidW5kbGUgJ3dlYi5hc3NldHNfYmFja2VuZCcgKi8Kb2Rvby5kZWZpbmUoJ3dlYi5yaWJib24nLGZ1bmN0aW9uKHJlcXVpcmUpeyd1c2Ugc3RyaWN0Jzt2YXIgd2lkZ2V0UmVnaXN0cnk9cmVxdWlyZSgnd2ViLndpZGdldF9yZWdpc3RyeScpO3ZhciBXaWRnZXQ9cmVxdWlyZSgnd2ViLldpZGdldCcpO3ZhciBSaWJib25XaWRnZXQ9V2lkZ2V0LmV4dGVuZCh7dGVtcGxhdGU6J3dlYi5yaWJib24nLHhtbERlcGVuZGVuY2llczpbJy93ZWIvc3RhdGljL3NyYy94bWwvcmliYm9uLnhtbCddLGluaXQ6ZnVuY3Rpb24ocGFyZW50LGRhdGEsb3B0aW9ucyl7dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3RoaXMudGV4dD1vcHRpb25zLmF0dHJzLnRleHQ7dGhpcy5iZ0NvbG9yPW9wdGlvbnMuYXR0cnMuYmdfY29sb3I7fX0pO3dpZGdldFJlZ2lzdHJ5LmFkZCgnd2ViX3JpYmJvbicsUmliYm9uV2lkZ2V0KTtyZXR1cm4gUmliYm9uV2lkZ2V0O30pOzsKCi8qIC93ZWIvc3RhdGljL3NyYy9qcy9hcHBzLmpzIGRlZmluZWQgaW4gYnVuZGxlICd3ZWIuYXNzZXRzX2JhY2tlbmQnICovCm9kb28uZGVmaW5lKCd3ZWIuQXBwcycsZnVuY3Rpb24ocmVxdWlyZSl7InVzZSBzdHJpY3QiO3ZhciBBYnN0cmFjdEFjdGlvbj1yZXF1aXJlKCd3ZWIuQWJzdHJhY3RBY3Rpb24nKTt2YXIgY29uZmlnPXJlcXVpcmUoJ3dlYi5jb25maWcnKTt2YXIgY29yZT1yZXF1aXJlKCd3ZWIuY29yZScpO3ZhciBmcmFtZXdvcms9cmVxdWlyZSgnd2ViLmZyYW1ld29yaycpO3ZhciBzZXNzaW9uPXJlcXVpcmUoJ3dlYi5zZXNzaW9uJyk7dmFyIF90PWNvcmUuX3Q7dmFyIGFwcHNfY2xpZW50PW51bGw7dmFyIEFwcHM9QWJzdHJhY3RBY3Rpb24uZXh0ZW5kKHtjb250ZW50VGVtcGxhdGU6J0VtcHR5Q29tcG9uZW50JyxyZW1vdGVfYWN0aW9uX3RhZzonbG9lbXBpYS5lbWJlZCcsZmFpbGJhY2tfYWN0aW9uX2lkOidiYXNlLm9wZW5fbW9kdWxlX3RyZWUnLGluaXQ6ZnVuY3Rpb24ocGFyZW50LGFjdGlvbil7dGhpcy5fc3VwZXIocGFyZW50LGFjdGlvbik7dmFyIG9wdGlvbnM9YWN0aW9uLnBhcmFtc3x8e307dGhpcy5wYXJhbXM9b3B0aW9uczt9LGdldF9jbGllbnQ6ZnVuY3Rpb24oKXt2YXIgY2hlY2tfY2xpZW50X2F2YWlsYWJsZT1mdW5jdGlvbihjbGllbnQpe3ZhciBpPW5ldyBJbWFnZSgpO3ZhciBkZWY9bmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSxyZWplY3Qpe2kub25lcnJvcj1mdW5jdGlvbigpe3JlamVjdChjbGllbnQpO307aS5vbmxvYWQ9ZnVuY3Rpb24oKXtyZXNvbHZlKGNsaWVudCk7fTt9KTt2YXIgdHM9bmV3IERhdGUoKS5nZXRUaW1lKCk7aS5zcmM9Xy5zdHIuc3ByaW50ZignJXMvd2ViL3N0YXRpYy9zcmMvaW1nL3NlcC1hLmdpZj8lcycsY2xpZW50Lm9yaWdpbix0cyk7cmV0dXJuIGRlZjt9O2lmKGFwcHNfY2xpZW50KXtyZXR1cm4gY2hlY2tfY2xpZW50X2F2YWlsYWJsZShhcHBzX2NsaWVudCk7fWVsc2V7cmV0dXJuIHRoaXMuX3JwYyh7bW9kZWw6J2lyLm1vZHVsZS5tb2R1bGUnLG1ldGhvZDonZ2V0X2FwcHNfc2VydmVyJ30pLnRoZW4oZnVuY3Rpb24odSl7dmFyIGxpbms9JChfLnN0ci5zcHJpbnRmKCc8YSBocmVmPSIlcyI+PC9hPicsdSkpWzBdO3ZhciBob3N0PV8uc3RyLnNwcmludGYoJyVzLy8lcycsbGluay5wcm90b2NvbCxsaW5rLmhvc3QpO3ZhciBkYm5hbWU9bGluay5wYXRobmFtZTtpZihkYm5hbWVbMF09PT0nLycpe2RibmFtZT1kYm5hbWUuc3Vic3RyKDEpO30KdmFyIGNsaWVudD17b3JpZ2luOmhvc3QsZGJuYW1lOmRibmFtZX07YXBwc19jbGllbnQ9Y2xpZW50O3JldHVybiBjaGVja19jbGllbnRfYXZhaWxhYmxlKGNsaWVudCk7fSk7fX0sZGVzdHJveTpmdW5jdGlvbigpeyQod2luZG93KS5vZmYoIm1lc3NhZ2UuIit0aGlzLnVuaXEpO2lmKHRoaXMuJGlmcil7dGhpcy4kaWZyLnJlbW92ZSgpO3RoaXMuJGlmcj1udWxsO30KcmV0dXJuIHRoaXMuX3N1cGVyKCk7fSxfb25fbWVzc2FnZTpmdW5jdGlvbigkZSl7dmFyIHNlbGY9dGhpcyxjbGllbnQ9dGhpcy5jbGllbnQsZT0kZS5vcmlnaW5hbEV2ZW50O2lmKGUub3JpZ2luIT09Y2xpZW50Lm9yaWdpbil7cmV0dXJuO30KdmFyIGRpc3BhdGNoZXI9eydldmVudCc6ZnVuY3Rpb24obSl7c2VsZi50cmlnZ2VyKCdtZXNzYWdlOicrbS5ldmVudCxtKTt9LCdhY3Rpb24nOmZ1bmN0aW9uKG0pe3NlbGYuZG9fYWN0aW9uKG0uYWN0aW9uKS50aGVuKGZ1bmN0aW9uKHIpe3ZhciB3PXNlbGYuJGlmclswXS5jb250ZW50V2luZG93O3cucG9zdE1lc3NhZ2Uoe2lkOm0uaWQscmVzdWx0OnJ9LGNsaWVudC5vcmlnaW4pO30pO30sJ3JwYyc6ZnVuY3Rpb24obSl7cmV0dXJuIHNlbGYuX3JwYyh7cm91dGU6bS5hcmdzWzBdLHBhcmFtczptLmFyZ3NbMV19KS50aGVuKGZ1bmN0aW9uKHIpe3ZhciB3PXNlbGYuJGlmclswXS5jb250ZW50V2luZG93O3cucG9zdE1lc3NhZ2Uoe2lkOm0uaWQscmVzdWx0OnJ9LGNsaWVudC5vcmlnaW4pO30pO30sJ01vZGVsJzpmdW5jdGlvbihtKXtyZXR1cm4gc2VsZi5fcnBjKHttb2RlbDptLm1vZGVsLG1ldGhvZDptLmFyZ3NbMF0sYXJnczptLmFyZ3NbMV19KS50aGVuKGZ1bmN0aW9uKHIpe3ZhciB3PXNlbGYuJGlmclswXS5jb250ZW50V2luZG93O3cucG9zdE1lc3NhZ2Uoe2lkOm0uaWQscmVzdWx0OnJ9LGNsaWVudC5vcmlnaW4pO30pO30sfTtpZighXy5pc09iamVjdChlLmRhdGEpKXtyZXR1cm47fQppZihkaXNwYXRjaGVyW2UuZGF0YS50eXBlXSl7ZGlzcGF0Y2hlcltlLmRhdGEudHlwZV0oZS5kYXRhKTt9fSxzdGFydDpmdW5jdGlvbigpe3ZhciBzZWxmPXRoaXM7cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUscmVqZWN0KXtzZWxmLmdldF9jbGllbnQoKS50aGVuKGZ1bmN0aW9uKGNsaWVudCl7c2VsZi5jbGllbnQ9Y2xpZW50O3ZhciBxcz17ZGI6Y2xpZW50LmRibmFtZX07aWYoY29uZmlnLmlzRGVidWcoKSl7cXMuZGVidWc9b2Rvby5kZWJ1Zzt9CnZhciB1PSQucGFyYW0ucXVlcnlzdHJpbmcoY2xpZW50Lm9yaWdpbisiL2FwcHMvZW1iZWQvY2xpZW50Iixxcyk7dmFyIGNzcz17d2lkdGg6JzEwMCUnLGhlaWdodDonNzUwcHgnfTtzZWxmLiRpZnI9JCgnPGlmcmFtZT4nKS5hdHRyKCdzcmMnLHUpO3NlbGYudW5pcT1fLnVuaXF1ZUlkKCdhcHBzJyk7JCh3aW5kb3cpLm9uKCJtZXNzYWdlLiIrc2VsZi51bmlxLHNlbGYucHJveHkoJ19vbl9tZXNzYWdlJykpO3NlbGYub24oJ21lc3NhZ2U6cmVhZHknLHNlbGYsZnVuY3Rpb24obSl7dmFyIHc9dGhpcy4kaWZyWzBdLmNvbnRlbnRXaW5kb3c7dmFyIGFjdD17dHlwZTonaXIuYWN0aW9ucy5jbGllbnQnLHRhZzp0aGlzLnJlbW90ZV9hY3Rpb25fdGFnLHBhcmFtczpfLmV4dGVuZCh7fSx0aGlzLnBhcmFtcyx7ZGI6c2Vzc2lvbi5kYixvcmlnaW46c2Vzc2lvbi5vcmlnaW4sfSl9O3cucG9zdE1lc3NhZ2Uoe3R5cGU6J2FjdGlvbicsYWN0aW9uOmFjdH0sY2xpZW50Lm9yaWdpbik7fSk7c2VsZi5vbignbWVzc2FnZTpzZXRfaGVpZ2h0JyxzZWxmLGZ1bmN0aW9uKG0pe3RoaXMuJGlmci5oZWlnaHQobS5oZWlnaHQpO30pO3NlbGYub24oJ21lc3NhZ2U6YmxvY2tVSScsc2VsZixmdW5jdGlvbigpe2ZyYW1ld29yay5ibG9ja1VJKCk7fSk7c2VsZi5vbignbWVzc2FnZTp1bmJsb2NrVUknLHNlbGYsZnVuY3Rpb24oKXtmcmFtZXdvcmsudW5ibG9ja1VJKCk7fSk7c2VsZi5vbignbWVzc2FnZTp3YXJuJyxzZWxmLGZ1bmN0aW9uKG0pe3NlbGYuZG9fd2FybihtLnRpdGxlLG0ubWVzc2FnZSxtLnN0aWNreSk7fSk7c2VsZi4kaWZyLmFwcGVuZFRvKHNlbGYuJCgnLm9fY29udGVudCcpKS5jc3MoY3NzKS5hZGRDbGFzcygnYXBwcy1jbGllbnQnKTtyZXNvbHZlKCk7fSxmdW5jdGlvbigpe3NlbGYuZG9fd2FybihfdCgnT2RvbyBBcHBzIHdpbGwgYmUgYXZhaWxhYmxlIHNvb24nKSxfdCgnU2hvd2luZyBsb2NhbGx5IGF2YWlsYWJsZSBtb2R1bGVzJyksdHJ1ZSk7cmV0dXJuIHNlbGYuX3JwYyh7cm91dGU6Jy93ZWIvYWN0aW9uL2xvYWQnLHBhcmFtczp7YWN0aW9uX2lkOnNlbGYuZmFpbGJhY2tfYWN0aW9uX2lkfSx9KS50aGVuKGZ1bmN0aW9uKGFjdGlvbil7cmV0dXJuIHNlbGYuZG9fYWN0aW9uKGFjdGlvbik7fSkudGhlbihyZWplY3QscmVqZWN0KTt9KTt9KTt9fSk7dmFyIEFwcHNVcGRhdGVzPUFwcHMuZXh0ZW5kKHtyZW1vdGVfYWN0aW9uX3RhZzonbG9lbXBpYS5lbWJlZC51cGRhdGVzJyx9KTtjb3JlLmFjdGlvbl9yZWdpc3RyeS5hZGQoImFwcHMiLEFwcHMpO2NvcmUuYWN0aW9uX3JlZ2lzdHJ5LmFkZCgiYXBwcy51cGRhdGVzIixBcHBzVXBkYXRlcyk7cmV0dXJuIEFwcHM7fSk7OwoKLyogL3dlYi9zdGF0aWMvc3JjL2pzL2ZpZWxkcy9hYnN0cmFjdF9maWVsZC5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwpvZG9vLmRlZmluZSgnd2ViLkFic3RyYWN0RmllbGQnLGZ1bmN0aW9uKHJlcXVpcmUpeyJ1c2Ugc3RyaWN0Ijt2YXIgZmllbGRfdXRpbHM9cmVxdWlyZSgnd2ViLmZpZWxkX3V0aWxzJyk7dmFyIFdpZGdldD1yZXF1aXJlKCd3ZWIuV2lkZ2V0Jyk7dmFyIEFic3RyYWN0RmllbGQ9V2lkZ2V0LmV4dGVuZCh7ZXZlbnRzOnsna2V5ZG93bic6J19vbktleWRvd24nLH0sY3VzdG9tX2V2ZW50czp7bmF2aWdhdGlvbl9tb3ZlOidfb25OYXZpZ2F0aW9uTW92ZScsfSxmaWVsZERlcGVuZGVuY2llczp7fSxyZXNldE9uQW55RmllbGRDaGFuZ2U6ZmFsc2Usc3BlY2lhbERhdGE6ZmFsc2Usc3VwcG9ydGVkRmllbGRUeXBlczpbXSxkZXNjcmlwdGlvbjoiIixub0xhYmVsOmZhbHNlLGluaXQ6ZnVuY3Rpb24ocGFyZW50LG5hbWUscmVjb3JkLG9wdGlvbnMpe3RoaXMuX3N1cGVyKHBhcmVudCk7b3B0aW9ucz1vcHRpb25zfHx7fTt0aGlzLm5hbWU9bmFtZTt0aGlzLnJlY29yZD1yZWNvcmQ7dGhpcy5maWVsZD1yZWNvcmQuZmllbGRzW25hbWVdO3RoaXMudmlld1R5cGU9b3B0aW9ucy52aWV3VHlwZXx8J2RlZmF1bHQnO3ZhciBmaWVsZHNJbmZvPXJlY29yZC5maWVsZHNJbmZvW3RoaXMudmlld1R5cGVdO3RoaXMuYXR0cnM9b3B0aW9ucy5hdHRyc3x8KGZpZWxkc0luZm8mJmZpZWxkc0luZm9bbmFtZV0pfHx7fTt0aGlzLmFkZGl0aW9uYWxDb250ZXh0PW9wdGlvbnMuYWRkaXRpb25hbENvbnRleHR8fHt9O3RoaXMudmFsdWU9cmVjb3JkLmRhdGFbbmFtZV07dGhpcy5yZWNvcmREYXRhPXJlY29yZC5kYXRhO3RoaXMuc3RyaW5nPXRoaXMuYXR0cnMuc3RyaW5nfHx0aGlzLmZpZWxkLnN0cmluZ3x8dGhpcy5uYW1lO3RoaXMubm9kZU9wdGlvbnM9dGhpcy5hdHRycy5vcHRpb25zfHx7fTt0aGlzLmRhdGFQb2ludElEPXJlY29yZC5pZDt0aGlzLnJlc19pZD1yZWNvcmQucmVzX2lkO3RoaXMubW9kZWw9cmVjb3JkLm1vZGVsO3RoaXMubW9kZT1vcHRpb25zLm1vZGV8fCJyZWFkb25seSI7dGhpcy5faXNWYWxpZD10cnVlO3RoaXMubGFzdFNldFZhbHVlPXVuZGVmaW5lZDt0aGlzLmZvcm1hdFR5cGU9dGhpcy5hdHRycy53aWRnZXQgaW4gZmllbGRfdXRpbHMuZm9ybWF0P3RoaXMuYXR0cnMud2lkZ2V0OnRoaXMuZmllbGQudHlwZTt0aGlzLmZvcm1hdE9wdGlvbnM9e307dGhpcy5wYXJzZU9wdGlvbnM9e307aWYodGhpcy5hdHRycy5kZWNvcmF0aW9ucyl7dGhpcy5yZXNldE9uQW55RmllbGRDaGFuZ2U9dHJ1ZTt9fSxzdGFydDpmdW5jdGlvbigpe3ZhciBzZWxmPXRoaXM7cmV0dXJuIHRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKS50aGVuKGZ1bmN0aW9uKCl7c2VsZi4kZWwuYXR0cignbmFtZScsc2VsZi5uYW1lKTtzZWxmLiRlbC5hZGRDbGFzcygnb19maWVsZF93aWRnZXQnKTtyZXR1cm4gc2VsZi5fcmVuZGVyKCk7fSk7fSxhY3RpdmF0ZTpmdW5jdGlvbihvcHRpb25zKXtpZih0aGlzLmlzRm9jdXNhYmxlKCkpe3ZhciAkZm9jdXNhYmxlPXRoaXMuZ2V0Rm9jdXNhYmxlRWxlbWVudCgpOyRmb2N1c2FibGUuZm9jdXMoKTtpZigkZm9jdXNhYmxlLmlzKCdpbnB1dFt0eXBlPSJ0ZXh0Il0sIHRleHRhcmVhJykpeyRmb2N1c2FibGVbMF0uc2VsZWN0aW9uU3RhcnQ9JGZvY3VzYWJsZVswXS5zZWxlY3Rpb25FbmQ9JGZvY3VzYWJsZVswXS52YWx1ZS5sZW5ndGg7aWYob3B0aW9ucyYmIW9wdGlvbnMubm9zZWxlY3QpeyRmb2N1c2FibGUuc2VsZWN0KCk7fX0KcmV0dXJuIHRydWU7fQpyZXR1cm4gZmFsc2U7fSxjb21taXRDaGFuZ2VzOmZ1bmN0aW9uKCl7fSxnZXRGb2N1c2FibGVFbGVtZW50OmZ1bmN0aW9uKCl7cmV0dXJuICQoKTt9LGlzRm9jdXNhYmxlOmZ1bmN0aW9uKCl7dmFyICRmb2N1c2FibGU9dGhpcy5nZXRGb2N1c2FibGVFbGVtZW50KCk7cmV0dXJuICRmb2N1c2FibGUubGVuZ3RoJiYkZm9jdXNhYmxlLmlzKCc6dmlzaWJsZScpO30saXNTZXQ6ZnVuY3Rpb24oKXtyZXR1cm4hIXRoaXMudmFsdWU7fSxpc1ZhbGlkOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2lzVmFsaWQ7fSxyZXNldDpmdW5jdGlvbihyZWNvcmQsZXZlbnQpe3RoaXMuX3Jlc2V0KHJlY29yZCxldmVudCk7cmV0dXJuIHRoaXMuX3JlbmRlcigpfHxQcm9taXNlLnJlc29sdmUoKTt9LHJlbW92ZUludmFsaWRDbGFzczpmdW5jdGlvbigpe3RoaXMuJGVsLnJlbW92ZUNsYXNzKCdvX2ZpZWxkX2ludmFsaWQnKTt0aGlzLiRlbC5yZW1vdmVBdHRyKCdhcmlhLWludmFsaWQnKTt9LHNldElERm9yTGFiZWw6ZnVuY3Rpb24oaWQpe3RoaXMuZ2V0Rm9jdXNhYmxlRWxlbWVudCgpLmF0dHIoJ2lkJyxpZCk7fSxzZXRJbnZhbGlkQ2xhc3M6ZnVuY3Rpb24oKXt0aGlzLiRlbC5hZGRDbGFzcygnb19maWVsZF9pbnZhbGlkJyk7dGhpcy4kZWwuYXR0cignYXJpYS1pbnZhbGlkJywndHJ1ZScpO30sdXBkYXRlTW9kaWZpZXJzVmFsdWU6ZnVuY3Rpb24obW9kaWZpZXJzKXt0aGlzLmF0dHJzLm1vZGlmaWVyc1ZhbHVlPW1vZGlmaWVyc3x8e307fSxfYXBwbHlEZWNvcmF0aW9uczpmdW5jdGlvbigpe3ZhciBzZWxmPXRoaXM7dGhpcy5hdHRycy5kZWNvcmF0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uKGRlYyl7dmFyIGlzVG9nZ2xlZD1weS5QWV9pc1RydWUocHkuZXZhbHVhdGUoZGVjLmV4cHJlc3Npb24sc2VsZi5yZWNvcmQuZXZhbENvbnRleHQpKTtzZWxmLiRlbC50b2dnbGVDbGFzcyhkZWMuY2xhc3NOYW1lLGlzVG9nZ2xlZCk7fSk7fSxfZm9ybWF0VmFsdWU6ZnVuY3Rpb24odmFsdWUpe3ZhciBvcHRpb25zPV8uZXh0ZW5kKHt9LHRoaXMubm9kZU9wdGlvbnMse2RhdGE6dGhpcy5yZWNvcmREYXRhfSx0aGlzLmZvcm1hdE9wdGlvbnMpO3JldHVybiBmaWVsZF91dGlscy5mb3JtYXRbdGhpcy5mb3JtYXRUeXBlXSh2YWx1ZSx0aGlzLmZpZWxkLG9wdGlvbnMpO30sX2lzU2FtZVZhbHVlOmZ1bmN0aW9uKHZhbHVlKXtyZXR1cm4gdGhpcy52YWx1ZT09PXZhbHVlO30sX3BhcnNlVmFsdWU6ZnVuY3Rpb24odmFsdWUpe3JldHVybiBmaWVsZF91dGlscy5wYXJzZVt0aGlzLmZvcm1hdFR5cGVdKHZhbHVlLHRoaXMuZmllbGQsdGhpcy5wYXJzZU9wdGlvbnMpO30sX3JlbmRlcjpmdW5jdGlvbigpe2lmKHRoaXMuYXR0cnMuZGVjb3JhdGlvbnMpe3RoaXMuX2FwcGx5RGVjb3JhdGlvbnMoKTt9CmlmKHRoaXMubW9kZT09PSdlZGl0Jyl7cmV0dXJuIHRoaXMuX3JlbmRlckVkaXQoKTt9ZWxzZSBpZih0aGlzLm1vZGU9PT0ncmVhZG9ubHknKXtyZXR1cm4gdGhpcy5fcmVuZGVyUmVhZG9ubHkoKTt9fSxfcmVuZGVyRWRpdDpmdW5jdGlvbigpe30sX3JlbmRlclJlYWRvbmx5OmZ1bmN0aW9uKCl7fSxfcmVzZXQ6ZnVuY3Rpb24ocmVjb3JkLGV2ZW50KXt0aGlzLmxhc3RTZXRWYWx1ZT11bmRlZmluZWQ7dGhpcy5yZWNvcmQ9cmVjb3JkO3RoaXMudmFsdWU9cmVjb3JkLmRhdGFbdGhpcy5uYW1lXTt0aGlzLnJlY29yZERhdGE9cmVjb3JkLmRhdGE7fSxfc2V0VmFsdWU6ZnVuY3Rpb24odmFsdWUsb3B0aW9ucyl7aWYodGhpcy5sYXN0U2V0VmFsdWU9PT12YWx1ZXx8KHRoaXMudmFsdWU9PT1mYWxzZSYmdmFsdWU9PT0nJykpe3JldHVybiBQcm9taXNlLnJlc29sdmUoKTt9CnRoaXMubGFzdFNldFZhbHVlPXZhbHVlO3RyeXt2YWx1ZT10aGlzLl9wYXJzZVZhbHVlKHZhbHVlKTt0aGlzLl9pc1ZhbGlkPXRydWU7fWNhdGNoKGUpe3RoaXMuX2lzVmFsaWQ9ZmFsc2U7dGhpcy50cmlnZ2VyX3VwKCdzZXRfZGlydHknLHtkYXRhUG9pbnRJRDp0aGlzLmRhdGFQb2ludElEfSk7cmV0dXJuIFByb21pc2UucmVqZWN0KHttZXNzYWdlOiJWYWx1ZSBzZXQgaXMgbm90IHZhbGlkIn0pO30KaWYoIShvcHRpb25zJiZvcHRpb25zLmZvcmNlQ2hhbmdlKSYmdGhpcy5faXNTYW1lVmFsdWUodmFsdWUpKXtyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7fQp2YXIgc2VsZj10aGlzO3JldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLHJlamVjdCl7dmFyIGNoYW5nZXM9e307Y2hhbmdlc1tzZWxmLm5hbWVdPXZhbHVlO3NlbGYudHJpZ2dlcl91cCgnZmllbGRfY2hhbmdlZCcse2RhdGFQb2ludElEOnNlbGYuZGF0YVBvaW50SUQsY2hhbmdlczpjaGFuZ2VzLHZpZXdUeXBlOnNlbGYudmlld1R5cGUsZG9Ob3RTZXREaXJ0eTpvcHRpb25zJiZvcHRpb25zLmRvTm90U2V0RGlydHksbm90aWZ5Q2hhbmdlOiFvcHRpb25zfHxvcHRpb25zLm5vdGlmeUNoYW5nZSE9PWZhbHNlLGFsbG93V2FybmluZzpvcHRpb25zJiZvcHRpb25zLmFsbG93V2FybmluZyxvblN1Y2Nlc3M6cmVzb2x2ZSxvbkZhaWx1cmU6cmVqZWN0LH0pO30pO30sX29uS2V5ZG93bjpmdW5jdGlvbihldil7c3dpdGNoKGV2LndoaWNoKXtjYXNlICQudWkua2V5Q29kZS5UQUI6dmFyIGV2ZW50PXRoaXMudHJpZ2dlcl91cCgnbmF2aWdhdGlvbl9tb3ZlJyx7ZGlyZWN0aW9uOmV2LnNoaWZ0S2V5PydwcmV2aW91cyc6J25leHQnLH0pO2lmKGV2ZW50LmlzX3N0b3BwZWQoKSl7ZXYucHJldmVudERlZmF1bHQoKTtldi5zdG9wUHJvcGFnYXRpb24oKTt9CmJyZWFrO2Nhc2UgJC51aS5rZXlDb2RlLkVOVEVSOmV2LnByZXZlbnREZWZhdWx0KCk7ZXYuc3RvcFByb3BhZ2F0aW9uKCk7dGhpcy50cmlnZ2VyX3VwKCduYXZpZ2F0aW9uX21vdmUnLHtkaXJlY3Rpb246J25leHRfbGluZSd9KTticmVhaztjYXNlICQudWkua2V5Q29kZS5FU0NBUEU6dGhpcy50cmlnZ2VyX3VwKCduYXZpZ2F0aW9uX21vdmUnLHtkaXJlY3Rpb246J2NhbmNlbCcsb3JpZ2luYWxFdmVudDpldn0pO2JyZWFrO2Nhc2UgJC51aS5rZXlDb2RlLlVQOmV2LnN0b3BQcm9wYWdhdGlvbigpO3RoaXMudHJpZ2dlcl91cCgnbmF2aWdhdGlvbl9tb3ZlJyx7ZGlyZWN0aW9uOid1cCd9KTticmVhaztjYXNlICQudWkua2V5Q29kZS5SSUdIVDpldi5zdG9wUHJvcGFnYXRpb24oKTt0aGlzLnRyaWdnZXJfdXAoJ25hdmlnYXRpb25fbW92ZScse2RpcmVjdGlvbjoncmlnaHQnfSk7YnJlYWs7Y2FzZSAkLnVpLmtleUNvZGUuRE9XTjpldi5zdG9wUHJvcGFnYXRpb24oKTt0aGlzLnRyaWdnZXJfdXAoJ25hdmlnYXRpb25fbW92ZScse2RpcmVjdGlvbjonZG93bid9KTticmVhaztjYXNlICQudWkua2V5Q29kZS5MRUZUOmV2LnN0b3BQcm9wYWdhdGlvbigpO3RoaXMudHJpZ2dlcl91cCgnbmF2aWdhdGlvbl9tb3ZlJyx7ZGlyZWN0aW9uOidsZWZ0J30pO2JyZWFrO319LF9vbk5hdmlnYXRpb25Nb3ZlOmZ1bmN0aW9uKGV2KXtldi5kYXRhLnRhcmdldD10aGlzO30sfSk7cmV0dXJuIEFic3RyYWN0RmllbGQ7fSk7OwoKLyogL3dlYi9zdGF0aWMvc3JjL2pzL2ZpZWxkcy9iYXNpY19maWVsZHMuanMgZGVmaW5lZCBpbiBidW5kbGUgJ3dlYi5hc3NldHNfYmFja2VuZCcgKi8Kb2Rvby5kZWZpbmUoJ3dlYi5iYXNpY19maWVsZHMnLGZ1bmN0aW9uKHJlcXVpcmUpeyJ1c2Ugc3RyaWN0Ijt2YXIgQWJzdHJhY3RGaWVsZD1yZXF1aXJlKCd3ZWIuQWJzdHJhY3RGaWVsZCcpO3ZhciBjb25maWc9cmVxdWlyZSgnd2ViLmNvbmZpZycpO3ZhciBjb3JlPXJlcXVpcmUoJ3dlYi5jb3JlJyk7dmFyIGRhdGVwaWNrZXI9cmVxdWlyZSgnd2ViLmRhdGVwaWNrZXInKTt2YXIgZG9tPXJlcXVpcmUoJ3dlYi5kb20nKTt2YXIgRG9tYWluPXJlcXVpcmUoJ3dlYi5Eb21haW4nKTt2YXIgRG9tYWluU2VsZWN0b3I9cmVxdWlyZSgnd2ViLkRvbWFpblNlbGVjdG9yJyk7dmFyIERvbWFpblNlbGVjdG9yRGlhbG9nPXJlcXVpcmUoJ3dlYi5Eb21haW5TZWxlY3RvckRpYWxvZycpO3ZhciBmcmFtZXdvcms9cmVxdWlyZSgnd2ViLmZyYW1ld29yaycpO3ZhciBweV91dGlscz1yZXF1aXJlKCd3ZWIucHlfdXRpbHMnKTt2YXIgc2Vzc2lvbj1yZXF1aXJlKCd3ZWIuc2Vzc2lvbicpO3ZhciB1dGlscz1yZXF1aXJlKCd3ZWIudXRpbHMnKTt2YXIgdmlld19kaWFsb2dzPXJlcXVpcmUoJ3dlYi52aWV3X2RpYWxvZ3MnKTt2YXIgZmllbGRfdXRpbHM9cmVxdWlyZSgnd2ViLmZpZWxkX3V0aWxzJyk7dmFyIHRpbWU9cmVxdWlyZSgnd2ViLnRpbWUnKTt2YXIgQ29sb3JwaWNrZXJEaWFsb2c9cmVxdWlyZSgnd2ViLkNvbG9ycGlja2VyRGlhbG9nJyk7cmVxdWlyZSgid2ViLnpvb21vZG9vIik7dmFyIHF3ZWI9Y29yZS5xd2ViO3ZhciBfdD1jb3JlLl90O3ZhciBfbHQ9Y29yZS5fbHQ7dmFyIFRyYW5zbGF0YWJsZUZpZWxkTWl4aW49e19yZW5kZXJUcmFuc2xhdGVCdXR0b246ZnVuY3Rpb24oKXtpZihfdC5kYXRhYmFzZS5tdWx0aV9sYW5nJiZ0aGlzLmZpZWxkLnRyYW5zbGF0ZSl7dmFyIGxhbmc9X3QuZGF0YWJhc2UucGFyYW1ldGVycy5jb2RlLnNwbGl0KCdfJylbMF0udG9VcHBlckNhc2UoKTtyZXR1cm4gJChgPHNwYW4gY2xhc3M9Im9fZmllbGRfdHJhbnNsYXRlIGJ0biBidG4tbGluayI+JHtsYW5nfTwvc3Bhbj5gKS5vbignY2xpY2snLHRoaXMuX29uVHJhbnNsYXRlLmJpbmQodGhpcykpO30KcmV0dXJuICQoKTt9LF9vblRyYW5zbGF0ZTpmdW5jdGlvbihldil7ZXYucHJldmVudERlZmF1bHQoKTt0aGlzLnRyaWdnZXJfdXAoJ3RyYW5zbGF0ZScse2ZpZWxkTmFtZTp0aGlzLm5hbWUsaWQ6dGhpcy5kYXRhUG9pbnRJRCxpc0NvbWluZ0Zyb21UcmFuc2xhdGlvbkFsZXJ0OmZhbHNlLH0pO30sfTt2YXIgRGVib3VuY2VkRmllbGQ9QWJzdHJhY3RGaWVsZC5leHRlbmQoe0RFQk9VTkNFOjEwMDAwMDAwMDAsaW5pdDpmdW5jdGlvbigpe3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLl9pc0RpcnR5PWZhbHNlO2lmKHRoaXMubW9kZT09PSdlZGl0Jyl7aWYodGhpcy5ERUJPVU5DRSl7dGhpcy5fZG9EZWJvdW5jZWRBY3Rpb249Xy5kZWJvdW5jZSh0aGlzLl9kb0FjdGlvbix0aGlzLkRFQk9VTkNFKTt9ZWxzZXt0aGlzLl9kb0RlYm91bmNlZEFjdGlvbj10aGlzLl9kb0FjdGlvbjt9CnZhciBzZWxmPXRoaXM7dmFyIGRlYm91bmNlZEZ1bmN0aW9uPXRoaXMuX2RvRGVib3VuY2VkQWN0aW9uO3RoaXMuX2RvRGVib3VuY2VkQWN0aW9uPWZ1bmN0aW9uKCl7c2VsZi5faXNEaXJ0eT10cnVlO2RlYm91bmNlZEZ1bmN0aW9uLmFwcGx5KHNlbGYsYXJndW1lbnRzKTt9O319LGNvbW1pdENoYW5nZXM6ZnVuY3Rpb24oKXtpZih0aGlzLl9pc0RpcnR5JiZ0aGlzLm1vZGU9PT0nZWRpdCcpe3JldHVybiB0aGlzLl9kb0FjdGlvbigpO319LF9kb0FjdGlvbjpmdW5jdGlvbigpe2lmKCF0aGlzLmlzRGVzdHJveWVkKCkpe3JldHVybiB0aGlzLl9zZXRWYWx1ZSh0aGlzLl9nZXRWYWx1ZSgpKTt9fSxfZ2V0VmFsdWU6ZnVuY3Rpb24oKXt9LH0pO3ZhciBJbnB1dEZpZWxkPURlYm91bmNlZEZpZWxkLmV4dGVuZCh7Y3VzdG9tX2V2ZW50czpfLmV4dGVuZCh7fSxEZWJvdW5jZWRGaWVsZC5wcm90b3R5cGUuY3VzdG9tX2V2ZW50cyx7ZmllbGRfY2hhbmdlZDonX29uRmllbGRDaGFuZ2VkJyx9KSxldmVudHM6Xy5leHRlbmQoe30sRGVib3VuY2VkRmllbGQucHJvdG90eXBlLmV2ZW50cyx7J2lucHV0JzonX29uSW5wdXQnLCdjaGFuZ2UnOidfb25DaGFuZ2UnLH0pLGluaXQ6ZnVuY3Rpb24oKXt0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy5ub2RlT3B0aW9ucy5pc1Bhc3N3b3JkPSdwYXNzd29yZCdpbiB0aGlzLmF0dHJzO2lmKHRoaXMubW9kZT09PSdlZGl0Jyl7dGhpcy50YWdOYW1lPSdpbnB1dCc7fQp0aGlzLmlzRGlydHk9ZmFsc2U7dGhpcy5sYXN0Q2hhbmdlRXZlbnQ9dW5kZWZpbmVkO30sZ2V0Rm9jdXNhYmxlRWxlbWVudDpmdW5jdGlvbigpe3JldHVybiB0aGlzLiRpbnB1dHx8JCgpO30scmVzZXQ6ZnVuY3Rpb24ocmVjb3JkLGV2ZW50KXt0aGlzLl9yZXNldChyZWNvcmQsZXZlbnQpO2lmKCFldmVudHx8ZXZlbnQ9PT10aGlzLmxhc3RDaGFuZ2VFdmVudCl7dGhpcy5pc0RpcnR5PWZhbHNlO30KaWYodGhpcy5pc0RpcnR5fHwoZXZlbnQmJmV2ZW50LnRhcmdldD09PXRoaXMmJmV2ZW50LmRhdGEuY2hhbmdlcyYmZXZlbnQuZGF0YS5jaGFuZ2VzW3RoaXMubmFtZV09PT10aGlzLnZhbHVlKSl7aWYodGhpcy5hdHRycy5kZWNvcmF0aW9ucyl7dGhpcy5fYXBwbHlEZWNvcmF0aW9ucygpO30KcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO31lbHNle3JldHVybiB0aGlzLl9yZW5kZXIoKTt9fSxfZ2V0VmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy4kaW5wdXQudmFsKCk7fSxfcHJlcGFyZUlucHV0OmZ1bmN0aW9uKCRpbnB1dCl7dGhpcy4kaW5wdXQ9JGlucHV0fHwkKCI8aW5wdXQvPiIpO3RoaXMuJGlucHV0LmFkZENsYXNzKCdvX2lucHV0Jyk7dmFyIGlucHV0QXR0cnM9e3BsYWNlaG9sZGVyOnRoaXMuYXR0cnMucGxhY2Vob2xkZXJ8fCIifTt2YXIgaW5wdXRWYWw7aWYodGhpcy5ub2RlT3B0aW9ucy5pc1Bhc3N3b3JkKXtpbnB1dEF0dHJzPV8uZXh0ZW5kKGlucHV0QXR0cnMse3R5cGU6J3Bhc3N3b3JkJyxhdXRvY29tcGxldGU6J25ldy1wYXNzd29yZCd9KTtpbnB1dFZhbD10aGlzLnZhbHVlfHwnJzt9ZWxzZXtpbnB1dEF0dHJzPV8uZXh0ZW5kKGlucHV0QXR0cnMse3R5cGU6J3RleHQnLGF1dG9jb21wbGV0ZTp0aGlzLmF0dHJzLmF1dG9jb21wbGV0ZX0pO2lucHV0VmFsPXRoaXMuX2Zvcm1hdFZhbHVlKHRoaXMudmFsdWUpO30KdGhpcy4kaW5wdXQuYXR0cihpbnB1dEF0dHJzKTt0aGlzLiRpbnB1dC52YWwoaW5wdXRWYWwpO3JldHVybiB0aGlzLiRpbnB1dDt9LF9yZW5kZXJFZGl0OmZ1bmN0aW9uKCl7dGhpcy5fcHJlcGFyZUlucHV0KHRoaXMuJGVsKTt9LF9yZW5kZXJSZWFkb25seTpmdW5jdGlvbigpe3RoaXMuJGVsLnRleHQodGhpcy5fZm9ybWF0VmFsdWUodGhpcy52YWx1ZSkpO30sX29uQ2hhbmdlOmZ1bmN0aW9uKCl7dGhpcy5fZG9BY3Rpb24oKTt9LF9vbkZpZWxkQ2hhbmdlZDpmdW5jdGlvbihldmVudCl7dGhpcy5sYXN0Q2hhbmdlRXZlbnQ9ZXZlbnQ7fSxfb25JbnB1dDpmdW5jdGlvbigpe3RoaXMuaXNEaXJ0eT10cnVlO3RoaXMuX2RvRGVib3VuY2VkQWN0aW9uKCk7fSxfb25OYXZpZ2F0aW9uTW92ZTpmdW5jdGlvbihldil7dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO2lmKHRoaXMubW9kZT09PSdlZGl0JyYmZXYuZGF0YS5kaXJlY3Rpb24hPT0nY2FuY2VsJyl7dmFyIGlucHV0PXRoaXMuJGlucHV0WzBdO3ZhciBzZWxlY3Rpbmc9KGlucHV0LnNlbGVjdGlvbkVuZCE9PWlucHV0LnNlbGVjdGlvblN0YXJ0KTtpZigoZXYuZGF0YS5kaXJlY3Rpb249PT0ibGVmdCImJihzZWxlY3Rpbmd8fGlucHV0LnNlbGVjdGlvblN0YXJ0IT09MCkpfHwoZXYuZGF0YS5kaXJlY3Rpb249PT0icmlnaHQiJiYoc2VsZWN0aW5nfHxpbnB1dC5zZWxlY3Rpb25TdGFydCE9PWlucHV0LnZhbHVlLmxlbmd0aCkpKXtldi5zdG9wUHJvcGFnYXRpb24oKTt9CmlmKGV2LmRhdGEuZGlyZWN0aW9uPT09J25leHQnJiZ0aGlzLmF0dHJzLm1vZGlmaWVyc1ZhbHVlJiZ0aGlzLmF0dHJzLm1vZGlmaWVyc1ZhbHVlLnJlcXVpcmVkJiZ0aGlzLnZpZXdUeXBlIT09J2xpc3QnKXtpZighdGhpcy4kaW5wdXQudmFsKCkpe3RoaXMuc2V0SW52YWxpZENsYXNzKCk7ZXYuc3RvcFByb3BhZ2F0aW9uKCk7fWVsc2V7dGhpcy5yZW1vdmVJbnZhbGlkQ2xhc3MoKTt9fX19LH0pO3ZhciBOdW1lcmljRmllbGQ9SW5wdXRGaWVsZC5leHRlbmQoe3RhZ05hbWU6J3NwYW4nLGlzU2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudmFsdWU9PT0wfHx0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fSxfZXZhbEZvcm11bGE6ZnVuY3Rpb24oZXhwcixjb250ZXh0KXt2YXIgdmFsPWV4cHIucmVwbGFjZShuZXcgUmVnRXhwKC8oICkvZyksJycpO3ZhciBzYWZlRXZhbFN0cmluZz0nJztmb3IobGV0IHYgb2YgdmFsLnNwbGl0KG5ldyBSZWdFeHAoLyhbLSsqLygpXl0pL2cpKSl7aWYoIVsnKycsJy0nLCcqJywnLycsJygnLCcpJywnXiddLmluY2x1ZGVzKHYpJiZ2Lmxlbmd0aCl7dj1maWVsZF91dGlscy5wYXJzZS5mbG9hdCh2KTt9CmlmKHY9PT0nXicpe3Y9JyoqJzt9CnNhZmVFdmFsU3RyaW5nKz12O307cmV0dXJuIHB5X3V0aWxzLnB5X2V2YWwoc2FmZUV2YWxTdHJpbmcsY29udGV4dCk7fSxfZm9ybWF0VmFsdWU6ZnVuY3Rpb24odmFsdWUpe2lmKHRoaXMubW9kZT09PSdlZGl0JyYmdGhpcy5ub2RlT3B0aW9ucy50eXBlPT09J251bWJlcicpe3JldHVybiB2YWx1ZTt9CnJldHVybiB0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fSxfcHJlcGFyZUlucHV0OmZ1bmN0aW9uKCRpbnB1dCl7dmFyIHJlc3VsdD10aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7aWYodGhpcy5ub2RlT3B0aW9ucy50eXBlPT09J251bWJlcicpe3RoaXMuJGlucHV0LmF0dHIoe3R5cGU6J251bWJlcid9KTt9CmlmKHRoaXMubm9kZU9wdGlvbnMuc3RlcCl7dGhpcy4kaW5wdXQuYXR0cih7c3RlcDp0aGlzLm5vZGVPcHRpb25zLnN0ZXB9KTt9CnJldHVybiByZXN1bHQ7fSxfc2V0VmFsdWU6ZnVuY3Rpb24odmFsdWUsb3B0aW9ucyl7dmFyIG9yaWdpbmFsVmFsdWU9dmFsdWU7dmFsdWU9dmFsdWUudHJpbSgpO2lmKHZhbHVlLnN0YXJ0c1dpdGgoJz0nKSl7dHJ5e3ZhbHVlPXRoaXMuX2V2YWxGb3JtdWxhKHZhbHVlLnN1YnN0cigxKSk7dmFsdWU9dGhpcy5fZm9ybWF0VmFsdWUodmFsdWUpO3RoaXMuJGlucHV0LnZhbCh2YWx1ZSk7fWNhdGNoKGVycil7dmFsdWU9b3JpZ2luYWxWYWx1ZTt9fQpyZXR1cm4gdGhpcy5fc3VwZXIodmFsdWUsb3B0aW9ucyk7fSx9KTt2YXIgRmllbGRDaGFyPUlucHV0RmllbGQuZXh0ZW5kKFRyYW5zbGF0YWJsZUZpZWxkTWl4aW4se2Rlc2NyaXB0aW9uOl9sdCgiVGV4dCIpLGNsYXNzTmFtZTonb19maWVsZF9jaGFyJyx0YWdOYW1lOidzcGFuJyxzdXBwb3J0ZWRGaWVsZFR5cGVzOlsnY2hhciddLF9yZW5kZXJFZGl0OmZ1bmN0aW9uKCl7dmFyIGRlZj10aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7aWYodGhpcy5maWVsZC5zaXplJiZ0aGlzLmZpZWxkLnNpemU+MCl7dGhpcy4kZWwuYXR0cignbWF4bGVuZ3RoJyx0aGlzLmZpZWxkLnNpemUpO30KaWYodGhpcy5maWVsZC50cmFuc2xhdGUpe3RoaXMuJGVsPXRoaXMuJGVsLmFkZCh0aGlzLl9yZW5kZXJUcmFuc2xhdGVCdXR0b24oKSk7dGhpcy4kZWwuYWRkQ2xhc3MoJ29fZmllbGRfdHJhbnNsYXRlJyk7fQpyZXR1cm4gZGVmO30sX3NldFZhbHVlOmZ1bmN0aW9uKHZhbHVlLG9wdGlvbnMpe2lmKHRoaXMuZmllbGQudHJpbSl7dmFsdWU9dmFsdWUudHJpbSgpO30KcmV0dXJuIHRoaXMuX3N1cGVyKHZhbHVlLG9wdGlvbnMpO30sfSk7dmFyIExpbmtCdXR0b249QWJzdHJhY3RGaWVsZC5leHRlbmQoe2V2ZW50czpfLmV4dGVuZCh7fSxBYnN0cmFjdEZpZWxkLnByb3RvdHlwZS5ldmVudHMseydjbGljayc6J19vbkNsaWNrJ30pLF9yZW5kZXI6ZnVuY3Rpb24oKXtpZih0aGlzLnZhbHVlKXt2YXIgY2xhc3NOYW1lPXRoaXMuYXR0cnMuaWNvbnx8J2ZhLWdsb2JlJzt0aGlzLiRlbC5odG1sKCI8c3BhbiByb2xlPSdpbWcnLz4iKTt0aGlzLiRlbC5hZGRDbGFzcygiZmEgIitjbGFzc05hbWUpO3RoaXMuJGVsLmF0dHIoJ3RpdGxlJyx0aGlzLnZhbHVlKTt0aGlzLiRlbC5hdHRyKCdhcmlhLWxhYmVsJyx0aGlzLnZhbHVlKTt9fSxfb25DbGljazpmdW5jdGlvbihldmVudCl7ZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7d2luZG93Lm9wZW4odGhpcy52YWx1ZSwnX2JsYW5rJyk7fSx9KTt2YXIgRmllbGREYXRlUmFuZ2U9SW5wdXRGaWVsZC5leHRlbmQoe2NsYXNzTmFtZTonb19maWVsZF9kYXRlX3JhbmdlJyx0YWdOYW1lOidzcGFuJyxqc0xpYnM6Wycvd2ViL3N0YXRpYy9saWIvZGF0ZXJhbmdlcGlja2VyL2RhdGVyYW5nZXBpY2tlci5qcycsJy93ZWIvc3RhdGljL3NyYy9qcy9saWJzL2RhdGVyYW5nZXBpY2tlci5qcycsXSxjc3NMaWJzOlsnL3dlYi9zdGF0aWMvbGliL2RhdGVyYW5nZXBpY2tlci9kYXRlcmFuZ2VwaWNrZXIuY3NzJyxdLHN1cHBvcnRlZEZpZWxkVHlwZXM6WydkYXRlJywnZGF0ZXRpbWUnXSxpbml0OmZ1bmN0aW9uKCl7dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3RoaXMuaXNEYXRlRmllbGQ9dGhpcy5mb3JtYXRUeXBlPT09J2RhdGUnO3RoaXMuZGF0ZVJhbmdlUGlja2VyT3B0aW9ucz1fLmRlZmF1bHRzKHt9LHRoaXMubm9kZU9wdGlvbnMucGlja2VyX29wdGlvbnN8fHt9LHt0aW1lUGlja2VyOiF0aGlzLmlzRGF0ZUZpZWxkLHRpbWVQaWNrZXIyNEhvdXI6X3QuZGF0YWJhc2UucGFyYW1ldGVycy50aW1lX2Zvcm1hdC5zZWFyY2goJyVIJykhPT0tMSxhdXRvVXBkYXRlSW5wdXQ6ZmFsc2UsdGltZVBpY2tlckluY3JlbWVudDo1LGxvY2FsZTp7Zm9ybWF0OnRoaXMuaXNEYXRlRmllbGQ/dGltZS5nZXRMYW5nRGF0ZUZvcm1hdCgpOnRpbWUuZ2V0TGFuZ0RhdGV0aW1lRm9ybWF0KCksfSx9KTt0aGlzLnJlbGF0ZWRFbmREYXRlPXRoaXMubm9kZU9wdGlvbnMucmVsYXRlZF9lbmRfZGF0ZTt0aGlzLnJlbGF0ZWRTdGFydERhdGU9dGhpcy5ub2RlT3B0aW9ucy5yZWxhdGVkX3N0YXJ0X2RhdGU7fSxkZXN0cm95OmZ1bmN0aW9uKCl7aWYodGhpcy4kcGlja2VyQ29udGFpbmVyKXt0aGlzLiRwaWNrZXJDb250YWluZXIucmVtb3ZlKCk7fQp0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fSxfYXBwbHlDaGFuZ2VzOmZ1bmN0aW9uKGV2LHBpY2tlcil7dmFyIGNoYW5nZXM9e307dmFyIGRpc3BsYXlTdGFydERhdGU9ZmllbGRfdXRpbHMuZm9ybWF0W3RoaXMuZm9ybWF0VHlwZV0ocGlja2VyLnN0YXJ0RGF0ZSx7fSx7dGltZXpvbmU6ZmFsc2V9KTt2YXIgZGlzcGxheUVuZERhdGU9ZmllbGRfdXRpbHMuZm9ybWF0W3RoaXMuZm9ybWF0VHlwZV0ocGlja2VyLmVuZERhdGUse30se3RpbWV6b25lOmZhbHNlfSk7dmFyIGNoYW5nZWRTdGFydERhdGU9cGlja2VyLnN0YXJ0RGF0ZTt2YXIgY2hhbmdlZEVuZERhdGU9cGlja2VyLmVuZERhdGU7aWYodGhpcy5pc0RhdGVGaWVsZCl7Y2hhbmdlZFN0YXJ0RGF0ZT1waWNrZXIuc3RhcnREYXRlLmFkZChzZXNzaW9uLmdldFRaT2Zmc2V0KHBpY2tlci5zdGFydERhdGUpLCdtaW51dGVzJyk7Y2hhbmdlZEVuZERhdGU9cGlja2VyLmVuZERhdGUuc3RhcnRPZignZGF5JykuYWRkKHNlc3Npb24uZ2V0VFpPZmZzZXQocGlja2VyLmVuZERhdGUpLCdtaW51dGVzJyk7fQppZih0aGlzLnJlbGF0ZWRFbmREYXRlKXt0aGlzLiRlbC52YWwoZGlzcGxheVN0YXJ0RGF0ZSk7Y2hhbmdlc1t0aGlzLm5hbWVdPXRoaXMuX3BhcnNlVmFsdWUoY2hhbmdlZFN0YXJ0RGF0ZSk7Y2hhbmdlc1t0aGlzLnJlbGF0ZWRFbmREYXRlXT10aGlzLl9wYXJzZVZhbHVlKGNoYW5nZWRFbmREYXRlKTt9CmlmKHRoaXMucmVsYXRlZFN0YXJ0RGF0ZSl7dGhpcy4kZWwudmFsKGRpc3BsYXlFbmREYXRlKTtjaGFuZ2VzW3RoaXMubmFtZV09dGhpcy5fcGFyc2VWYWx1ZShjaGFuZ2VkRW5kRGF0ZSk7Y2hhbmdlc1t0aGlzLnJlbGF0ZWRTdGFydERhdGVdPXRoaXMuX3BhcnNlVmFsdWUoY2hhbmdlZFN0YXJ0RGF0ZSk7fQp0aGlzLnRyaWdnZXJfdXAoJ2ZpZWxkX2NoYW5nZWQnLHtkYXRhUG9pbnRJRDp0aGlzLmRhdGFQb2ludElELHZpZXdUeXBlOnRoaXMudmlld1R5cGUsY2hhbmdlczpjaGFuZ2VzLH0pO30sX3JlbmRlckVkaXQ6ZnVuY3Rpb24oKXt0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dmFyIHNlbGY9dGhpczt2YXIgc3RhcnREYXRlO3ZhciBlbmREYXRlO2lmKHRoaXMucmVsYXRlZEVuZERhdGUpe3N0YXJ0RGF0ZT10aGlzLl9mb3JtYXRWYWx1ZSh0aGlzLnZhbHVlKTtlbmREYXRlPXRoaXMuX2Zvcm1hdFZhbHVlKHRoaXMucmVjb3JkRGF0YVt0aGlzLnJlbGF0ZWRFbmREYXRlXSk7fQppZih0aGlzLnJlbGF0ZWRTdGFydERhdGUpe3N0YXJ0RGF0ZT10aGlzLl9mb3JtYXRWYWx1ZSh0aGlzLnJlY29yZERhdGFbdGhpcy5yZWxhdGVkU3RhcnREYXRlXSk7ZW5kRGF0ZT10aGlzLl9mb3JtYXRWYWx1ZSh0aGlzLnZhbHVlKTt9CnRoaXMuZGF0ZVJhbmdlUGlja2VyT3B0aW9ucy5zdGFydERhdGU9c3RhcnREYXRlfHxtb21lbnQoKTt0aGlzLmRhdGVSYW5nZVBpY2tlck9wdGlvbnMuZW5kRGF0ZT1lbmREYXRlfHxtb21lbnQoKTt0aGlzLiRlbC5kYXRlcmFuZ2VwaWNrZXIodGhpcy5kYXRlUmFuZ2VQaWNrZXJPcHRpb25zKTt0aGlzLiRlbC5vbignYXBwbHkuZGF0ZXJhbmdlcGlja2VyJyx0aGlzLl9hcHBseUNoYW5nZXMuYmluZCh0aGlzKSk7dGhpcy4kZWwub2ZmKCdrZXl1cC5kYXRlcmFuZ2VwaWNrZXInKTt0aGlzLiRwaWNrZXJDb250YWluZXI9dGhpcy4kZWwuZGF0YSgnZGF0ZXJhbmdlcGlja2VyJykuY29udGFpbmVyO3RoaXMuJHBpY2tlckNvbnRhaW5lci5vbignY2xpY2snLGZ1bmN0aW9uKGV2KXtldi5zdG9wUHJvcGFnYXRpb24oKTtpZigkKGV2LnRhcmdldCkuaGFzQ2xhc3MoJ2FwcGx5QnRuJykpe3NlbGYuJGVsLmRhdGEoJ2RhdGVyYW5nZXBpY2tlcicpLmhpZGUoKTt9fSk7fSx9KTt2YXIgRmllbGREYXRlPUlucHV0RmllbGQuZXh0ZW5kKHtkZXNjcmlwdGlvbjpfbHQoIkRhdGUiKSxjbGFzc05hbWU6Im9fZmllbGRfZGF0ZSIsdGFnTmFtZToic3BhbiIsc3VwcG9ydGVkRmllbGRUeXBlczpbJ2RhdGUnLCdkYXRldGltZSddLGV2ZW50czpBYnN0cmFjdEZpZWxkLnByb3RvdHlwZS5ldmVudHMsaW5pdDpmdW5jdGlvbigpe3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLmZvcm1hdE9wdGlvbnMudGltZXpvbmU9dHJ1ZTt0aGlzLmRhdGVwaWNrZXJPcHRpb25zPV8uZGVmYXVsdHMoe30sdGhpcy5ub2RlT3B0aW9ucy5kYXRlcGlja2VyfHx7fSx7ZGVmYXVsdERhdGU6dGhpcy52YWx1ZX0pO30sc3RhcnQ6ZnVuY3Rpb24oKXt2YXIgc2VsZj10aGlzO3ZhciBwcm9tO2lmKHRoaXMubW9kZT09PSdlZGl0Jyl7dGhpcy5kYXRld2lkZ2V0PXRoaXMuX21ha2VEYXRlUGlja2VyKCk7dGhpcy5kYXRld2lkZ2V0Lm9uKCdkYXRldGltZV9jaGFuZ2VkJyx0aGlzLGZ1bmN0aW9uKCl7dmFyIHZhbHVlPXRoaXMuX2dldFZhbHVlKCk7aWYoKCF2YWx1ZSYmdGhpcy52YWx1ZSl8fCh2YWx1ZSYmIXRoaXMuX2lzU2FtZVZhbHVlKHZhbHVlKSkpe3RoaXMuX3NldFZhbHVlKHZhbHVlKTt9fSk7cHJvbT10aGlzLmRhdGV3aWRnZXQuYXBwZW5kVG8oJzxkaXY+JykudGhlbihmdW5jdGlvbigpe3NlbGYuZGF0ZXdpZGdldC4kZWwuYWRkQ2xhc3Moc2VsZi4kZWwuYXR0cignY2xhc3MnKSk7c2VsZi5fcHJlcGFyZUlucHV0KHNlbGYuZGF0ZXdpZGdldC4kaW5wdXQpO3NlbGYuX3JlcGxhY2VFbGVtZW50KHNlbGYuZGF0ZXdpZGdldC4kZWwpO30pO30KcmV0dXJuIFByb21pc2UucmVzb2x2ZShwcm9tKS50aGVuKHRoaXMuX3N1cGVyLmJpbmQodGhpcykpO30sYWN0aXZhdGU6ZnVuY3Rpb24oKXtpZih0aGlzLmlzRm9jdXNhYmxlKCkmJnRoaXMuZGF0ZXdpZGdldCl7dGhpcy5kYXRld2lkZ2V0LmZvY3VzKCk7cmV0dXJuIHRydWU7fQpyZXR1cm4gZmFsc2U7fSxfZG9EZWJvdW5jZWRBY3Rpb246ZnVuY3Rpb24oKXt0aGlzLmRhdGV3aWRnZXQuY2hhbmdlRGF0ZXRpbWUoKTt9LF9nZXRWYWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLmRhdGV3aWRnZXQuZ2V0VmFsdWUoKTt9LF9pc1NhbWVWYWx1ZTpmdW5jdGlvbih2YWx1ZSl7aWYodmFsdWU9PT1mYWxzZSl7cmV0dXJuIHRoaXMudmFsdWU9PT1mYWxzZTt9CnJldHVybiB2YWx1ZS5pc1NhbWUodGhpcy52YWx1ZSwnZGF5Jyk7fSxfbWFrZURhdGVQaWNrZXI6ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IGRhdGVwaWNrZXIuRGF0ZVdpZGdldCh0aGlzLHRoaXMuZGF0ZXBpY2tlck9wdGlvbnMpO30sX3JlbmRlckVkaXQ6ZnVuY3Rpb24oKXt0aGlzLmRhdGV3aWRnZXQuc2V0VmFsdWUodGhpcy52YWx1ZSk7dGhpcy4kaW5wdXQ9dGhpcy5kYXRld2lkZ2V0LiRpbnB1dDt9LH0pO3ZhciBGaWVsZERhdGVUaW1lPUZpZWxkRGF0ZS5leHRlbmQoe2Rlc2NyaXB0aW9uOl9sdCgiRGF0ZSAmIFRpbWUiKSxzdXBwb3J0ZWRGaWVsZFR5cGVzOlsnZGF0ZXRpbWUnXSxpbml0OmZ1bmN0aW9uKCl7dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO2lmKHRoaXMudmFsdWUpe3ZhciBvZmZzZXQ9dGhpcy5nZXRTZXNzaW9uKCkuZ2V0VFpPZmZzZXQodGhpcy52YWx1ZSk7dmFyIGRpc3BsYXllZFZhbHVlPXRoaXMudmFsdWUuY2xvbmUoKS5hZGQob2Zmc2V0LCdtaW51dGVzJyk7dGhpcy5kYXRlcGlja2VyT3B0aW9ucy5kZWZhdWx0RGF0ZT1kaXNwbGF5ZWRWYWx1ZTt9fSxfZ2V0VmFsdWU6ZnVuY3Rpb24oKXt2YXIgdmFsdWU9dGhpcy5kYXRld2lkZ2V0LmdldFZhbHVlKCk7cmV0dXJuIHZhbHVlJiZ2YWx1ZS5hZGQoLXRoaXMuZ2V0U2Vzc2lvbigpLmdldFRaT2Zmc2V0KHZhbHVlKSwnbWludXRlcycpO30sX2lzU2FtZVZhbHVlOmZ1bmN0aW9uKHZhbHVlKXtpZih2YWx1ZT09PWZhbHNlKXtyZXR1cm4gdGhpcy52YWx1ZT09PWZhbHNlO30KcmV0dXJuIHZhbHVlLmlzU2FtZSh0aGlzLnZhbHVlKTt9LF9tYWtlRGF0ZVBpY2tlcjpmdW5jdGlvbigpe3JldHVybiBuZXcgZGF0ZXBpY2tlci5EYXRlVGltZVdpZGdldCh0aGlzLHRoaXMuZGF0ZXBpY2tlck9wdGlvbnMpO30sX3JlbmRlckVkaXQ6ZnVuY3Rpb24oKXt2YXIgdmFsdWU9dGhpcy52YWx1ZSYmdGhpcy52YWx1ZS5jbG9uZSgpLmFkZCh0aGlzLmdldFNlc3Npb24oKS5nZXRUWk9mZnNldCh0aGlzLnZhbHVlKSwnbWludXRlcycpO3RoaXMuZGF0ZXdpZGdldC5zZXRWYWx1ZSh2YWx1ZSk7dGhpcy4kaW5wdXQ9dGhpcy5kYXRld2lkZ2V0LiRpbnB1dDt9LH0pO3ZhciBGaWVsZE1vbmV0YXJ5PU51bWVyaWNGaWVsZC5leHRlbmQoe2Rlc2NyaXB0aW9uOl9sdCgiTW9uZXRhcnkiKSxjbGFzc05hbWU6J29fZmllbGRfbW9uZXRhcnkgb19maWVsZF9udW1iZXInLHRhZ05hbWU6J3NwYW4nLHN1cHBvcnRlZEZpZWxkVHlwZXM6WydmbG9hdCcsJ21vbmV0YXJ5J10scmVzZXRPbkFueUZpZWxkQ2hhbmdlOnRydWUsaW5pdDpmdW5jdGlvbigpe3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLl9zZXRDdXJyZW5jeSgpO2lmKHRoaXMubW9kZT09PSdlZGl0Jyl7dGhpcy50YWdOYW1lPSdkaXYnO3RoaXMuY2xhc3NOYW1lKz0nIG9faW5wdXQnO3RoaXMuZm9ybWF0T3B0aW9ucy5ub1N5bWJvbD10cnVlO30KdGhpcy5mb3JtYXRPcHRpb25zLmN1cnJlbmN5PXRoaXMuY3VycmVuY3k7dGhpcy5mb3JtYXRPcHRpb25zLmRpZ2l0cz1bMTYsMl07dGhpcy5mb3JtYXRPcHRpb25zLmZpZWxkX2RpZ2l0cz10aGlzLm5vZGVPcHRpb25zLmZpZWxkX2RpZ2l0czt9LGlzU2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudmFsdWU9PT0wfHx0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fSxfcmVuZGVyRWRpdDpmdW5jdGlvbigpe3RoaXMuJGVsLmVtcHR5KCk7dmFyIGRlZj10aGlzLl9wcmVwYXJlSW5wdXQodGhpcy4kaW5wdXQpLmFwcGVuZFRvKHRoaXMuJGVsKTtpZih0aGlzLmN1cnJlbmN5KXt2YXIgJGN1cnJlbmN5U3ltYm9sPSQoJzxzcGFuPicse3RleHQ6dGhpcy5jdXJyZW5jeS5zeW1ib2x9KTtpZih0aGlzLmN1cnJlbmN5LnBvc2l0aW9uPT09ImFmdGVyIil7dGhpcy4kZWwuYXBwZW5kKCRjdXJyZW5jeVN5bWJvbCk7fWVsc2V7dGhpcy4kZWwucHJlcGVuZCgkY3VycmVuY3lTeW1ib2wpO319CnJldHVybiBkZWY7fSxfcmVuZGVyUmVhZG9ubHk6ZnVuY3Rpb24oKXt0aGlzLiRlbC5odG1sKHRoaXMuX2Zvcm1hdFZhbHVlKHRoaXMudmFsdWUpKTt9LF9yZXNldDpmdW5jdGlvbigpe3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLl9zZXRDdXJyZW5jeSgpO30sX3NldEN1cnJlbmN5OmZ1bmN0aW9uKCl7dmFyIGN1cnJlbmN5RmllbGQ9dGhpcy5ub2RlT3B0aW9ucy5jdXJyZW5jeV9maWVsZHx8dGhpcy5maWVsZC5jdXJyZW5jeV9maWVsZHx8J2N1cnJlbmN5X2lkJzt2YXIgY3VycmVuY3lJRD10aGlzLnJlY29yZC5kYXRhW2N1cnJlbmN5RmllbGRdJiZ0aGlzLnJlY29yZC5kYXRhW2N1cnJlbmN5RmllbGRdLnJlc19pZDt0aGlzLmN1cnJlbmN5PXNlc3Npb24uZ2V0X2N1cnJlbmN5KGN1cnJlbmN5SUQpO3RoaXMuZm9ybWF0T3B0aW9ucy5jdXJyZW5jeT10aGlzLmN1cnJlbmN5O30sfSk7dmFyIEZpZWxkQm9vbGVhbj1BYnN0cmFjdEZpZWxkLmV4dGVuZCh7Y2xhc3NOYW1lOidvX2ZpZWxkX2Jvb2xlYW4nLGRlc2NyaXB0aW9uOl9sdCgiQ2hlY2tib3giKSxldmVudHM6Xy5leHRlbmQoe30sQWJzdHJhY3RGaWVsZC5wcm90b3R5cGUuZXZlbnRzLHtjaGFuZ2U6J19vbkNoYW5nZScsfSksc3VwcG9ydGVkRmllbGRUeXBlczpbJ2Jvb2xlYW4nXSxhY3RpdmF0ZTpmdW5jdGlvbihvcHRpb25zKXt2YXIgYWN0aXZhdGVkPXRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtpZihhY3RpdmF0ZWQmJm9wdGlvbnMmJm9wdGlvbnMuZXZlbnQmJiQob3B0aW9ucy5ldmVudC50YXJnZXQpLmNsb3Nlc3QoJy5jdXN0b20tY29udHJvbC5jdXN0b20tY2hlY2tib3gnKS5sZW5ndGgpe3RoaXMuX3NldFZhbHVlKCF0aGlzLnZhbHVlKTt9CnJldHVybiBhY3RpdmF0ZWQ7fSxnZXRGb2N1c2FibGVFbGVtZW50OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubW9kZT09PSdyZWFkb25seSc/JCgpOnRoaXMuJGlucHV0O30saXNTZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdHJ1ZTt9LHJlc2V0OmZ1bmN0aW9uKHJlY29yZCxldmVudCl7dmFyIHJlbmRlcmVkPXRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtpZihldmVudCYmZXZlbnQudGFyZ2V0Lm5hbWU9PT10aGlzLm5hbWUpe3RoaXMuYWN0aXZhdGUoKTt9CnJldHVybiByZW5kZXJlZDt9LHNldElERm9yTGFiZWw6ZnVuY3Rpb24oaWQpe3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLiQoJy5jdXN0b20tY29udHJvbC1sYWJlbCcpLmF0dHIoJ2ZvcicsaWQpO30sX3JlbmRlcjpmdW5jdGlvbigpe3ZhciAkY2hlY2tib3g9dGhpcy5fZm9ybWF0VmFsdWUodGhpcy52YWx1ZSk7dGhpcy4kaW5wdXQ9JGNoZWNrYm94LmZpbmQoJ2lucHV0Jyk7dGhpcy4kaW5wdXQucHJvcCgnZGlzYWJsZWQnLHRoaXMubW9kZT09PSdyZWFkb25seScpO3RoaXMuJGVsLmFkZENsYXNzKCRjaGVja2JveC5hdHRyKCdjbGFzcycpKTt0aGlzLiRlbC5lbXB0eSgpLmFwcGVuZCgkY2hlY2tib3guY29udGVudHMoKSk7fSxfb25DaGFuZ2U6ZnVuY3Rpb24oKXt0aGlzLl9zZXRWYWx1ZSh0aGlzLiRpbnB1dFswXS5jaGVja2VkKTt9LF9vbktleWRvd246ZnVuY3Rpb24oZXYpe3N3aXRjaChldi53aGljaCl7Y2FzZSAkLnVpLmtleUNvZGUuRU5URVI6ZXYucHJldmVudERlZmF1bHQoKTt0aGlzLiRpbnB1dC5wcm9wKCdjaGVja2VkJywhdGhpcy52YWx1ZSk7dGhpcy5fc2V0VmFsdWUoIXRoaXMudmFsdWUpO3JldHVybjtjYXNlICQudWkua2V5Q29kZS5VUDpjYXNlICQudWkua2V5Q29kZS5SSUdIVDpjYXNlICQudWkua2V5Q29kZS5ET1dOOmNhc2UgJC51aS5rZXlDb2RlLkxFRlQ6ZXYucHJldmVudERlZmF1bHQoKTt9CnRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9LH0pO3ZhciBGaWVsZEludGVnZXI9TnVtZXJpY0ZpZWxkLmV4dGVuZCh7ZGVzY3JpcHRpb246X2x0KCJJbnRlZ2VyIiksY2xhc3NOYW1lOidvX2ZpZWxkX2ludGVnZXIgb19maWVsZF9udW1iZXInLHN1cHBvcnRlZEZpZWxkVHlwZXM6WydpbnRlZ2VyJ10sX2Zvcm1hdFZhbHVlOmZ1bmN0aW9uKHZhbHVlKXtpZih0eXBlb2YgdmFsdWU9PT0nc3RyaW5nJyl7aWYoIS9eWzAtOV0rLS8udGVzdCh2YWx1ZSkpe3Rocm93IG5ldyBFcnJvcignIicrdmFsdWUrJyIgaXMgbm90IGFuIGludGVnZXIgb3IgYSB2aXJ0dWFsIGlkJyk7fQpyZXR1cm4gdmFsdWU7fQpyZXR1cm4gdGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO30sfSk7dmFyIEZpZWxkRmxvYXQ9TnVtZXJpY0ZpZWxkLmV4dGVuZCh7ZGVzY3JpcHRpb246X2x0KCJEZWNpbWFsIiksY2xhc3NOYW1lOidvX2ZpZWxkX2Zsb2F0IG9fZmllbGRfbnVtYmVyJyxzdXBwb3J0ZWRGaWVsZFR5cGVzOlsnZmxvYXQnXSxpbml0OmZ1bmN0aW9uKCl7dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO2lmKHRoaXMuYXR0cnMuZGlnaXRzKXt0aGlzLm5vZGVPcHRpb25zLmRpZ2l0cz1KU09OLnBhcnNlKHRoaXMuYXR0cnMuZGlnaXRzKTt9fSx9KTt2YXIgRmllbGRGbG9hdFRpbWU9RmllbGRGbG9hdC5leHRlbmQoe2Rlc2NyaXB0aW9uOl9sdCgiVGltZSIpLGZvcm1hdFR5cGU6J2Zsb2F0X3RpbWUnLGluaXQ6ZnVuY3Rpb24oKXt0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy5mb3JtYXRUeXBlPSdmbG9hdF90aW1lJzt9fSk7dmFyIEZpZWxkRmxvYXRGYWN0b3I9RmllbGRGbG9hdC5leHRlbmQoe3N1cHBvcnRlZEZpZWxkVHlwZXM6WydmbG9hdCddLGNsYXNzTmFtZTonb19maWVsZF9mbG9hdF9mYWN0b3InLGZvcm1hdFR5cGU6J2Zsb2F0X2ZhY3RvcicsaW5pdDpmdW5jdGlvbigpe3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtpZighdGhpcy5ub2RlT3B0aW9ucy5mYWN0b3Ipe3RoaXMubm9kZU9wdGlvbnMuZmFjdG9yPTE7fQp0aGlzLnBhcnNlT3B0aW9ucz10aGlzLm5vZGVPcHRpb25zO319KTt2YXIgRmllbGRGbG9hdFRvZ2dsZT1BYnN0cmFjdEZpZWxkLmV4dGVuZCh7c3VwcG9ydGVkRmllbGRUeXBlczpbJ2Zsb2F0J10sZm9ybWF0VHlwZTonZmxvYXRfZmFjdG9yJyxjbGFzc05hbWU6J29fZmllbGRfZmxvYXRfdG9nZ2xlJyx0YWdOYW1lOidzcGFuJyxldmVudHM6e2NsaWNrOidfb25DbGljayd9LGluaXQ6ZnVuY3Rpb24oKXt0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy5mb3JtYXRUeXBlPSdmbG9hdF9mYWN0b3InO2lmKHRoaXMubW9kZT09PSdlZGl0Jyl7dGhpcy50YWdOYW1lPSdidXR0b24nO30KaWYodGhpcy5hdHRycy5kaWdpdHMpe3RoaXMubm9kZU9wdGlvbnMuZGlnaXRzPUpTT04ucGFyc2UodGhpcy5hdHRycy5kaWdpdHMpO30KaWYoIXRoaXMubm9kZU9wdGlvbnMuZmFjdG9yKXt0aGlzLm5vZGVPcHRpb25zLmZhY3Rvcj0xO30KaWYoIXRoaXMubm9kZU9wdGlvbnMucmFuZ2Upe3RoaXMubm9kZU9wdGlvbnMucmFuZ2U9WzAuMCwwLjUsMS4wXTt9CnRoaXMucGFyc2VPcHRpb25zPXRoaXMubm9kZU9wdGlvbnM7fSxfZ2V0RGlzcGxheWVkVmFsdWU6ZnVuY3Rpb24oKXt2YXIgdXNyRm9ybWF0VmFsdWU9dGhpcy5fZm9ybWF0VmFsdWUodGhpcy52YWx1ZSk7cmV0dXJuIGZpZWxkX3V0aWxzLnBhcnNlWydmbG9hdCddKHVzckZvcm1hdFZhbHVlKTt9LF9yZW5kZXJFZGl0OmZ1bmN0aW9uKCl7dGhpcy4kZWwudGV4dCh0aGlzLl9mb3JtYXRWYWx1ZSh0aGlzLnZhbHVlKSk7fSxfcmVuZGVyUmVhZG9ubHk6ZnVuY3Rpb24oKXt0aGlzLiRlbC50ZXh0KHRoaXMuX2Zvcm1hdFZhbHVlKHRoaXMudmFsdWUpKTt9LF9uZXh0VmFsdWU6ZnVuY3Rpb24oKXt2YXIgcmFuZ2U9dGhpcy5ub2RlT3B0aW9ucy5yYW5nZTt2YXIgdmFsPXV0aWxzLmNsb3Nlc3ROdW1iZXIodGhpcy5fZ2V0RGlzcGxheWVkVmFsdWUoKSxyYW5nZSk7dmFyIGluZGV4PV8uaW5kZXhPZihyYW5nZSx2YWwpO2lmKGluZGV4IT09LTEpe2lmKGluZGV4KzE8cmFuZ2UubGVuZ3RoKXtyZXR1cm4gcmFuZ2VbaW5kZXgrMV07fX0KcmV0dXJuIHJhbmdlWzBdO30sX29uQ2xpY2s6ZnVuY3Rpb24oZXYpe2lmKHRoaXMubW9kZT09PSdlZGl0Jyl7ZXYuc3RvcFByb3BhZ2F0aW9uKCk7dmFyIG5leHRfdmFsPXRoaXMuX25leHRWYWx1ZSgpO25leHRfdmFsPWZpZWxkX3V0aWxzLmZvcm1hdFsnZmxvYXQnXShuZXh0X3ZhbCk7dGhpcy5fc2V0VmFsdWUobmV4dF92YWwpO319LH0pO3ZhciBGaWVsZFBlcmNlbnRhZ2U9RmllbGRGbG9hdC5leHRlbmQoe2Rlc2NyaXB0aW9uOl9sdCgiUGVyY2VudGFnZSIpLGZvcm1hdFR5cGU6J3BlcmNlbnRhZ2UnLH0pO3ZhciBGaWVsZFRleHQ9SW5wdXRGaWVsZC5leHRlbmQoVHJhbnNsYXRhYmxlRmllbGRNaXhpbix7ZGVzY3JpcHRpb246X2x0KCJNdWx0aWxpbmUgVGV4dCIpLGNsYXNzTmFtZTonb19maWVsZF90ZXh0JyxzdXBwb3J0ZWRGaWVsZFR5cGVzOlsndGV4dCddLHRhZ05hbWU6J3NwYW4nLGluaXQ6ZnVuY3Rpb24oKXt0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7aWYodGhpcy5tb2RlPT09J2VkaXQnKXt0aGlzLnRhZ05hbWU9J3RleHRhcmVhJzt9CnRoaXMuYXV0b1Jlc2l6ZU9wdGlvbnM9e3BhcmVudDp0aGlzfTt9LHN0YXJ0OmZ1bmN0aW9uKCl7aWYodGhpcy5tb2RlPT09J2VkaXQnKXtkb20uYXV0b3Jlc2l6ZSh0aGlzLiRlbCx0aGlzLmF1dG9SZXNpemVPcHRpb25zKTtpZih0aGlzLmZpZWxkLnRyYW5zbGF0ZSl7dGhpcy4kZWw9dGhpcy4kZWwuYWRkKHRoaXMuX3JlbmRlclRyYW5zbGF0ZUJ1dHRvbigpKTt0aGlzLiRlbC5hZGRDbGFzcygnb19maWVsZF90cmFuc2xhdGUnKTt9fQpyZXR1cm4gdGhpcy5fc3VwZXIoKTt9LHJlc2V0OmZ1bmN0aW9uKCl7dmFyIHNlbGY9dGhpcztyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKSkudGhlbihmdW5jdGlvbigpe2lmKHNlbGYubW9kZT09PSdlZGl0Jyl7c2VsZi4kaW5wdXQudHJpZ2dlcignY2hhbmdlJyk7fX0pO30sX29uS2V5ZG93bjpmdW5jdGlvbihldil7aWYoZXYud2hpY2g9PT0kLnVpLmtleUNvZGUuRU5URVIpe2V2LnN0b3BQcm9wYWdhdGlvbigpO3JldHVybjt9CnRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9LH0pO3ZhciBMaXN0RmllbGRUZXh0PUZpZWxkVGV4dC5leHRlbmQoe2luaXQ6ZnVuY3Rpb24oKXt0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy5hdXRvUmVzaXplT3B0aW9ucy5taW5faGVpZ2h0PTA7fSx9KTt2YXIgSGFuZGxlV2lkZ2V0PUFic3RyYWN0RmllbGQuZXh0ZW5kKHtkZXNjcmlwdGlvbjpfbHQoIkhhbmRsZSIpLG5vTGFiZWw6dHJ1ZSxjbGFzc05hbWU6J29fcm93X2hhbmRsZSBmYSBmYS1hcnJvd3MgdWktc29ydGFibGUtaGFuZGxlJyx3aWR0aEluTGlzdDonMzNweCcsdGFnTmFtZTonc3Bhbicsc3VwcG9ydGVkRmllbGRUeXBlczpbJ2ludGVnZXInXSxpc1NldDpmdW5jdGlvbigpe3JldHVybiB0cnVlO30sfSk7dmFyIEZpZWxkRW1haWw9SW5wdXRGaWVsZC5leHRlbmQoe2Rlc2NyaXB0aW9uOl9sdCgiRW1haWwiKSxjbGFzc05hbWU6J29fZmllbGRfZW1haWwnLGV2ZW50czpfLmV4dGVuZCh7fSxJbnB1dEZpZWxkLnByb3RvdHlwZS5ldmVudHMseydjbGljayc6J19vbkNsaWNrJyx9KSxwcmVmaXg6J21haWx0bycsc3VwcG9ydGVkRmllbGRUeXBlczpbJ2NoYXInXSxpbml0OmZ1bmN0aW9uKCl7dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3RoaXMudGFnTmFtZT10aGlzLm1vZGU9PT0ncmVhZG9ubHknPydhJzonaW5wdXQnO30sZ2V0Rm9jdXNhYmxlRWxlbWVudDpmdW5jdGlvbigpe3JldHVybiB0aGlzLm1vZGU9PT0ncmVhZG9ubHknP3RoaXMuJGVsOnRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9LF9yZW5kZXJSZWFkb25seTpmdW5jdGlvbigpe3RoaXMuJGVsLnRleHQodGhpcy52YWx1ZSkuYWRkQ2xhc3MoJ29fZm9ybV91cmkgb190ZXh0X292ZXJmbG93JykuYXR0cignaHJlZicsdGhpcy5wcmVmaXgrJzonK3RoaXMudmFsdWUpO30sX29uQ2xpY2s6ZnVuY3Rpb24oZXYpe2V2LnN0b3BQcm9wYWdhdGlvbigpO30sfSk7dmFyIEZpZWxkUGhvbmU9RmllbGRFbWFpbC5leHRlbmQoe2Rlc2NyaXB0aW9uOl9sdCgiUGhvbmUiKSxjbGFzc05hbWU6J29fZmllbGRfcGhvbmUnLHByZWZpeDondGVsJyxfcmVuZGVyUmVhZG9ubHk6ZnVuY3Rpb24oKXt0aGlzLl9zdXBlcigpO3RoaXMuJGVsLnJlbW92ZUNsYXNzKCdvX3RleHRfb3ZlcmZsb3cnKTt9LH0pO3ZhciBVcmxXaWRnZXQ9SW5wdXRGaWVsZC5leHRlbmQoe2Rlc2NyaXB0aW9uOl9sdCgiVVJMIiksY2xhc3NOYW1lOidvX2ZpZWxkX3VybCcsZXZlbnRzOl8uZXh0ZW5kKHt9LElucHV0RmllbGQucHJvdG90eXBlLmV2ZW50cyx7J2NsaWNrJzonX29uQ2xpY2snLH0pLHN1cHBvcnRlZEZpZWxkVHlwZXM6WydjaGFyJ10saW5pdDpmdW5jdGlvbigpe3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLnRhZ05hbWU9dGhpcy5tb2RlPT09J3JlYWRvbmx5Jz8nYSc6J2lucHV0Jzt9LGdldEZvY3VzYWJsZUVsZW1lbnQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tb2RlPT09J3JlYWRvbmx5Jz90aGlzLiRlbDp0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fSxfcmVuZGVyUmVhZG9ubHk6ZnVuY3Rpb24oKXt0aGlzLiRlbC50ZXh0KHRoaXMuYXR0cnMudGV4dHx8dGhpcy52YWx1ZSkuYWRkQ2xhc3MoJ29fZm9ybV91cmkgb190ZXh0X292ZXJmbG93JykuYXR0cigndGFyZ2V0JywnX2JsYW5rJykuYXR0cignaHJlZicsdGhpcy52YWx1ZSk7fSxfb25DbGljazpmdW5jdGlvbihldil7ZXYuc3RvcFByb3BhZ2F0aW9uKCk7fSx9KTt2YXIgQ29weUNsaXBib2FyZD17ZGVzdHJveTpmdW5jdGlvbigpe3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtpZih0aGlzLmNsaXBib2FyZCl7dGhpcy5jbGlwYm9hcmQuZGVzdHJveSgpO319LF9pbml0Q2xpcGJvYXJkOmZ1bmN0aW9uKCl7dmFyIHNlbGY9dGhpczt2YXIgJGNsaXBib2FyZEJ0bj10aGlzLiQoJy5vX2NsaXBib2FyZF9idXR0b24nKTskY2xpcGJvYXJkQnRuLnRvb2x0aXAoe3RpdGxlOl90KCdDb3BpZWQgIScpLHRyaWdnZXI6J21hbnVhbCcscGxhY2VtZW50OidyaWdodCd9KTt0aGlzLmNsaXBib2FyZD1uZXcgQ2xpcGJvYXJkSlMoJGNsaXBib2FyZEJ0blswXSx7dGV4dDpmdW5jdGlvbigpe3JldHVybiBzZWxmLnZhbHVlLnRyaW0oKTt9LGNvbnRhaW5lcjpzZWxmLiRlbFswXX0pO3RoaXMuY2xpcGJvYXJkLm9uKCdzdWNjZXNzJyxmdW5jdGlvbigpe18uZGVmZXIoZnVuY3Rpb24oKXskY2xpcGJvYXJkQnRuLnRvb2x0aXAoJ3Nob3cnKTtfLmRlbGF5KGZ1bmN0aW9uKCl7JGNsaXBib2FyZEJ0bi50b29sdGlwKCdoaWRlJyk7fSw4MDApO30pO30pO30sX3JlbmRlcjpmdW5jdGlvbigpe3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLiRlbC5hZGRDbGFzcygnb19maWVsZF9jb3B5Jyk7fSxfcmVuZGVyUmVhZG9ubHk6ZnVuY3Rpb24oKXt0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7aWYodGhpcy52YWx1ZSl7dGhpcy4kZWwuYXBwZW5kKCQocXdlYi5yZW5kZXIodGhpcy5jbGlwYm9hcmRUZW1wbGF0ZSkpKTt0aGlzLl9pbml0Q2xpcGJvYXJkKCk7fX19O3ZhciBUZXh0Q29weUNsaXBib2FyZD1GaWVsZFRleHQuZXh0ZW5kKENvcHlDbGlwYm9hcmQse2Rlc2NyaXB0aW9uOl9sdCgiQ29weSB0byBDbGlwYm9hcmQiKSxjbGlwYm9hcmRUZW1wbGF0ZTonQ29weUNsaXBib2FyZFRleHQnLH0pO3ZhciBDaGFyQ29weUNsaXBib2FyZD1GaWVsZENoYXIuZXh0ZW5kKENvcHlDbGlwYm9hcmQse2Rlc2NyaXB0aW9uOl9sdCgiQ29weSB0byBDbGlwYm9hcmQiKSxjbGlwYm9hcmRUZW1wbGF0ZTonQ29weUNsaXBib2FyZENoYXInLH0pO3ZhciBBYnN0cmFjdEZpZWxkQmluYXJ5PUFic3RyYWN0RmllbGQuZXh0ZW5kKHtldmVudHM6Xy5leHRlbmQoe30sQWJzdHJhY3RGaWVsZC5wcm90b3R5cGUuZXZlbnRzLHsnY2hhbmdlIC5vX2lucHV0X2ZpbGUnOidvbl9maWxlX2NoYW5nZScsJ2NsaWNrIC5vX3NlbGVjdF9maWxlX2J1dHRvbic6ZnVuY3Rpb24oKXt0aGlzLiQoJy5vX2lucHV0X2ZpbGUnKS5jbGljaygpO30sJ2NsaWNrIC5vX2NsZWFyX2ZpbGVfYnV0dG9uJzonX29uQ2xlYXJDbGljaycsfSksaW5pdDpmdW5jdGlvbihwYXJlbnQsbmFtZSxyZWNvcmQpe3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLmZpZWxkcz1yZWNvcmQuZmllbGRzO3RoaXMudXNlRmlsZUFQST0hIXdpbmRvdy5GaWxlUmVhZGVyO3RoaXMubWF4X3VwbG9hZF9zaXplPTI1KjEwMjQqMTAyNDtpZighdGhpcy51c2VGaWxlQVBJKXt2YXIgc2VsZj10aGlzO3RoaXMuZmlsZXVwbG9hZF9pZD1fLnVuaXF1ZUlkKCdvX2ZpbGV1cGxvYWQnKTskKHdpbmRvdykub24odGhpcy5maWxldXBsb2FkX2lkLGZ1bmN0aW9uKCl7dmFyIGFyZ3M9W10uc2xpY2UuY2FsbChhcmd1bWVudHMpLnNsaWNlKDEpO3NlbGYub25fZmlsZV91cGxvYWRlZC5hcHBseShzZWxmLGFyZ3MpO30pO319LGRlc3Ryb3k6ZnVuY3Rpb24oKXtpZih0aGlzLmZpbGV1cGxvYWRfaWQpeyQod2luZG93KS5vZmYodGhpcy5maWxldXBsb2FkX2lkKTt9CnRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9LG9uX2ZpbGVfY2hhbmdlOmZ1bmN0aW9uKGUpe3ZhciBzZWxmPXRoaXM7dmFyIGZpbGVfbm9kZT1lLnRhcmdldDtpZigodGhpcy51c2VGaWxlQVBJJiZmaWxlX25vZGUuZmlsZXMubGVuZ3RoKXx8KCF0aGlzLnVzZUZpbGVBUEkmJiQoZmlsZV9ub2RlKS52YWwoKSE9PScnKSl7aWYodGhpcy51c2VGaWxlQVBJKXt2YXIgZmlsZT1maWxlX25vZGUuZmlsZXNbMF07aWYoZmlsZS5zaXplPnRoaXMubWF4X3VwbG9hZF9zaXplKXt2YXIgbXNnPV90KCJUaGUgc2VsZWN0ZWQgZmlsZSBleGNlZWQgdGhlIG1heGltdW0gZmlsZSBzaXplIG9mICVzLiIpO3RoaXMuZG9fd2FybihfdCgiRmlsZSB1cGxvYWQiKSxfLnN0ci5zcHJpbnRmKG1zZyx1dGlscy5odW1hbl9zaXplKHRoaXMubWF4X3VwbG9hZF9zaXplKSkpO3JldHVybiBmYWxzZTt9CnV0aWxzLmdldERhdGFVUkxGcm9tRmlsZShmaWxlKS50aGVuKGZ1bmN0aW9uKGRhdGEpe2RhdGE9ZGF0YS5zcGxpdCgnLCcpWzFdO3NlbGYub25fZmlsZV91cGxvYWRlZChmaWxlLnNpemUsZmlsZS5uYW1lLGZpbGUudHlwZSxkYXRhKTt9KTt9ZWxzZXt0aGlzLiQoJ2Zvcm0ub19mb3JtX2JpbmFyeV9mb3JtJykuc3VibWl0KCk7fQp0aGlzLiQoJy5vX2Zvcm1fYmluYXJ5X3Byb2dyZXNzJykuc2hvdygpO3RoaXMuJCgnYnV0dG9uJykuaGlkZSgpO319LG9uX2ZpbGVfdXBsb2FkZWQ6ZnVuY3Rpb24oc2l6ZSxuYW1lKXtpZihzaXplPT09ZmFsc2Upe3RoaXMuZG9fd2FybihfdCgiRmlsZSBVcGxvYWQiKSxfdCgiVGhlcmUgd2FzIGEgcHJvYmxlbSB3aGlsZSB1cGxvYWRpbmcgeW91ciBmaWxlIikpO2NvbnNvbGUud2FybigiRXJyb3Igd2hpbGUgdXBsb2FkaW5nIGZpbGUgOiAiLG5hbWUpO31lbHNle3RoaXMub25fZmlsZV91cGxvYWRlZF9hbmRfdmFsaWQuYXBwbHkodGhpcyxhcmd1bWVudHMpO30KdGhpcy4kKCcub19mb3JtX2JpbmFyeV9wcm9ncmVzcycpLmhpZGUoKTt0aGlzLiQoJ2J1dHRvbicpLnNob3coKTt9LG9uX2ZpbGVfdXBsb2FkZWRfYW5kX3ZhbGlkOmZ1bmN0aW9uKHNpemUsbmFtZSxjb250ZW50X3R5cGUsZmlsZV9iYXNlNjQpe3RoaXMuc2V0X2ZpbGVuYW1lKG5hbWUpO3RoaXMuX3NldFZhbHVlKGZpbGVfYmFzZTY0KTt0aGlzLl9yZW5kZXIoKTt9LHNldF9maWxlbmFtZTpmdW5jdGlvbih2YWx1ZSl7dmFyIGZpbGVuYW1lPXRoaXMuYXR0cnMuZmlsZW5hbWU7aWYoZmlsZW5hbWUmJmZpbGVuYW1lIGluIHRoaXMuZmllbGRzKXt2YXIgY2hhbmdlcz17fTtjaGFuZ2VzW2ZpbGVuYW1lXT12YWx1ZTt0aGlzLnRyaWdnZXJfdXAoJ2ZpZWxkX2NoYW5nZWQnLHtkYXRhUG9pbnRJRDp0aGlzLmRhdGFQb2ludElELGNoYW5nZXM6Y2hhbmdlcyx2aWV3VHlwZTp0aGlzLnZpZXdUeXBlLH0pO319LF9jbGVhckZpbGU6ZnVuY3Rpb24oKXt2YXIgc2VsZj10aGlzO3RoaXMuJCgnLm9faW5wdXRfZmlsZScpLnZhbCgnJyk7dGhpcy5zZXRfZmlsZW5hbWUoJycpO2lmKCF0aGlzLmlzRGVzdHJveWVkKCkpe3RoaXMuX3NldFZhbHVlKGZhbHNlKS50aGVuKGZ1bmN0aW9uKCl7c2VsZi5fcmVuZGVyKCk7fSk7fX0sX29uQ2xlYXJDbGljazpmdW5jdGlvbihldil7dGhpcy5fY2xlYXJGaWxlKCk7fSx9KTt2YXIgRmllbGRCaW5hcnlJbWFnZT1BYnN0cmFjdEZpZWxkQmluYXJ5LmV4dGVuZCh7ZGVzY3JpcHRpb246X2x0KCJJbWFnZSIpLGZpZWxkRGVwZW5kZW5jaWVzOl8uZXh0ZW5kKHt9LEFic3RyYWN0RmllbGRCaW5hcnkucHJvdG90eXBlLmZpZWxkRGVwZW5kZW5jaWVzLHtfX2xhc3RfdXBkYXRlOnt0eXBlOidkYXRldGltZSd9LH0pLHRlbXBsYXRlOidGaWVsZEJpbmFyeUltYWdlJyxwbGFjZWhvbGRlcjoiL3dlYi9zdGF0aWMvc3JjL2ltZy9wbGFjZWhvbGRlci5wbmciLGV2ZW50czpfLmV4dGVuZCh7fSxBYnN0cmFjdEZpZWxkQmluYXJ5LnByb3RvdHlwZS5ldmVudHMseydjbGljayBpbWcnOmZ1bmN0aW9uKCl7aWYodGhpcy5tb2RlPT09InJlYWRvbmx5Iil7dGhpcy50cmlnZ2VyX3VwKCdib3VuY2VfZWRpdCcpO319LH0pLHN1cHBvcnRlZEZpZWxkVHlwZXM6WydiaW5hcnknXSxmaWxlX3R5cGVfbWFnaWNfd29yZDp7Jy8nOidqcGcnLCdSJzonZ2lmJywnaSc6J3BuZycsJ1AnOidzdmcreG1sJyx9LF9nZXRJbWFnZVVybDpmdW5jdGlvbihtb2RlbCxyZXNfaWQsZmllbGQsdW5pcXVlKXtyZXR1cm4gc2Vzc2lvbi51cmwoJy93ZWIvaW1hZ2UnLHttb2RlbDptb2RlbCxpZDpKU09OLnN0cmluZ2lmeShyZXNfaWQpLGZpZWxkOmZpZWxkLHVuaXF1ZTpmaWVsZF91dGlscy5mb3JtYXQuZGF0ZXRpbWUodW5pcXVlKS5yZXBsYWNlKC9bXjAtOV0vZywnJyksfSk7fSxfcmVuZGVyOmZ1bmN0aW9uKCl7dmFyIHNlbGY9dGhpczt2YXIgdXJsPXRoaXMucGxhY2Vob2xkZXI7aWYodGhpcy52YWx1ZSl7aWYoIXV0aWxzLmlzX2Jpbl9zaXplKHRoaXMudmFsdWUpKXt1cmw9J2RhdGE6aW1hZ2UvJysodGhpcy5maWxlX3R5cGVfbWFnaWNfd29yZFt0aGlzLnZhbHVlWzBdXXx8J3BuZycpKyc7YmFzZTY0LCcrdGhpcy52YWx1ZTt9ZWxzZXt2YXIgZmllbGQ9dGhpcy5ub2RlT3B0aW9ucy5wcmV2aWV3X2ltYWdlfHx0aGlzLm5hbWU7dmFyIHVuaXF1ZT10aGlzLnJlY29yZERhdGEuX19sYXN0X3VwZGF0ZTt1cmw9dGhpcy5fZ2V0SW1hZ2VVcmwodGhpcy5tb2RlbCx0aGlzLnJlc19pZCxmaWVsZCx1bmlxdWUpO319CnZhciAkaW1nPSQocXdlYi5yZW5kZXIoIkZpZWxkQmluYXJ5SW1hZ2UtaW1nIix7d2lkZ2V0OnRoaXMsdXJsOnVybH0pKTt2YXIgd2lkdGg9dGhpcy5ub2RlT3B0aW9ucy5zaXplP3RoaXMubm9kZU9wdGlvbnMuc2l6ZVswXTp0aGlzLmF0dHJzLndpZHRoO3ZhciBoZWlnaHQ9dGhpcy5ub2RlT3B0aW9ucy5zaXplP3RoaXMubm9kZU9wdGlvbnMuc2l6ZVsxXTp0aGlzLmF0dHJzLmhlaWdodDtpZih3aWR0aCl7JGltZy5hdHRyKCd3aWR0aCcsd2lkdGgpOyRpbWcuY3NzKCdtYXgtd2lkdGgnLHdpZHRoKydweCcpO30KaWYoaGVpZ2h0KXskaW1nLmF0dHIoJ2hlaWdodCcsaGVpZ2h0KTskaW1nLmNzcygnbWF4LWhlaWdodCcsaGVpZ2h0KydweCcpO30KdGhpcy4kKCc+IGltZycpLnJlbW92ZSgpO3RoaXMuJGVsLnByZXBlbmQoJGltZyk7JGltZy5vbmUoJ2Vycm9yJyxmdW5jdGlvbigpeyRpbWcuYXR0cignc3JjJyxzZWxmLnBsYWNlaG9sZGVyKTtzZWxmLmRvX3dhcm4oX3QoIkltYWdlIiksX3QoIkNvdWxkIG5vdCBkaXNwbGF5IHRoZSBzZWxlY3RlZCBpbWFnZS4iKSk7fSk7cmV0dXJuIHRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9LF9yZW5kZXJSZWFkb25seTpmdW5jdGlvbigpe3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtpZih0aGlzLm5vZGVPcHRpb25zLnpvb20pe3ZhciB1bmlxdWU9dGhpcy5yZWNvcmREYXRhLl9fbGFzdF91cGRhdGU7dmFyIHVybD10aGlzLl9nZXRJbWFnZVVybCh0aGlzLm1vZGVsLHRoaXMucmVzX2lkLCdpbWFnZV8xOTIwJyx1bmlxdWUpO3ZhciAkaW1nO3ZhciBpbWFnZUZpZWxkPV8uZmluZChPYmplY3Qua2V5cyh0aGlzLnJlY29yZERhdGEpLGZ1bmN0aW9uKG8pe3JldHVybiBvLnN0YXJ0c1dpdGgoJ2ltYWdlXycpO30pO2lmKHRoaXMubm9kZU9wdGlvbnMuYmFja2dyb3VuZCkKe2lmKCd0YWcnaW4gdGhpcy5ub2RlT3B0aW9ucyl7dGhpcy50YWdOYW1lPXRoaXMubm9kZU9wdGlvbnMudGFnO30KaWYoJ2NsYXNzJ2luIHRoaXMuYXR0cnMpe3RoaXMuJGVsLmFkZENsYXNzKHRoaXMuYXR0cnMuY2xhc3MpO30KdmFyIHVybFRodW1iPXRoaXMuX2dldEltYWdlVXJsKHRoaXMubW9kZWwsdGhpcy5yZXNfaWQsJ2ltYWdlXzEyOCcsdW5pcXVlKTt0aGlzLiRlbC5lbXB0eSgpOyRpbWc9dGhpcy4kZWw7JGltZy5jc3MoJ2JhY2tncm91bmRJbWFnZScsJ3VybCgnK3VybFRodW1iKycpJyk7fWVsc2V7JGltZz10aGlzLiQoJ2ltZycpO30KaWYodGhpcy5yZWNvcmREYXRhW2ltYWdlRmllbGRdKXskaW1nLmF0dHIoJ2RhdGEtem9vbScsMSk7JGltZy5hdHRyKCdkYXRhLXpvb20taW1hZ2UnLHVybCk7JGltZy56b29tT2Rvbyh7ZXZlbnQ6J21vdXNlZW50ZXInLGF0dGFjaDonLm9fY29udGVudCcsYXR0YWNoVG9UYXJnZXQ6dHJ1ZSxvblNob3c6ZnVuY3Rpb24oKXtpZih0aGlzLiR6b29tLmhlaWdodCgpPDI1NiYmdGhpcy4kem9vbS53aWR0aCgpPDI1Nil7dGhpcy5oaWRlKCk7fX0sYmVmb3JlQXR0YWNoOmZ1bmN0aW9uKCl7dGhpcy4kZmx5b3V0LmNzcyh7d2lkdGg6JzUxMnB4JyxoZWlnaHQ6JzUxMnB4J30pO30scHJldmVudENsaWNrczp0aGlzLm5vZGVPcHRpb25zLnByZXZlbnRDbGlja3MsfSk7fX19LH0pO3ZhciBLYW5iYW5GaWVsZEJpbmFyeUltYWdlPUZpZWxkQmluYXJ5SW1hZ2UuZXh0ZW5kKHtldmVudHM6e30sfSk7dmFyIEZpZWxkQmluYXJ5RmlsZT1BYnN0cmFjdEZpZWxkQmluYXJ5LmV4dGVuZCh7ZGVzY3JpcHRpb246X2x0KCJGaWxlIiksdGVtcGxhdGU6J0ZpZWxkQmluYXJ5RmlsZScsZXZlbnRzOl8uZXh0ZW5kKHt9LEFic3RyYWN0RmllbGRCaW5hcnkucHJvdG90eXBlLmV2ZW50cyx7J2NsaWNrJzpmdW5jdGlvbihldmVudCl7aWYodGhpcy5tb2RlPT09J3JlYWRvbmx5JyYmdGhpcy52YWx1ZSYmdGhpcy5yZWNvcmREYXRhLmlkKXt0aGlzLm9uX3NhdmVfYXMoZXZlbnQpO319LCdjbGljayAub19pbnB1dCc6ZnVuY3Rpb24oKXt0aGlzLiQoJy5vX2lucHV0X2ZpbGUnKS5jbGljaygpO30sfSksc3VwcG9ydGVkRmllbGRUeXBlczpbJ2JpbmFyeSddLGluaXQ6ZnVuY3Rpb24oKXt0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy5maWxlbmFtZV92YWx1ZT10aGlzLnJlY29yZERhdGFbdGhpcy5hdHRycy5maWxlbmFtZV07fSxfcmVuZGVyUmVhZG9ubHk6ZnVuY3Rpb24oKXt0aGlzLmRvX3RvZ2dsZSghIXRoaXMudmFsdWUpO2lmKHRoaXMudmFsdWUpe3RoaXMuJGVsLmVtcHR5KCkuYXBwZW5kKCQoIjxzcGFuLz4iKS5hZGRDbGFzcygnZmEgZmEtZG93bmxvYWQnKSk7aWYodGhpcy5yZWNvcmREYXRhLmlkKXt0aGlzLiRlbC5jc3MoJ2N1cnNvcicsJ3BvaW50ZXInKTt9ZWxzZXt0aGlzLiRlbC5jc3MoJ2N1cnNvcicsJ25vdC1hbGxvd2VkJyk7fQppZih0aGlzLmZpbGVuYW1lX3ZhbHVlKXt0aGlzLiRlbC5hcHBlbmQoIiAiK3RoaXMuZmlsZW5hbWVfdmFsdWUpO319CmlmKCF0aGlzLnJlc19pZCl7dGhpcy4kZWwuY3NzKCdjdXJzb3InLCdub3QtYWxsb3dlZCcpO31lbHNle3RoaXMuJGVsLmNzcygnY3Vyc29yJywncG9pbnRlcicpO319LF9yZW5kZXJFZGl0OmZ1bmN0aW9uKCl7aWYodGhpcy52YWx1ZSl7dGhpcy4kZWwuY2hpbGRyZW4oKS5yZW1vdmVDbGFzcygnb19oaWRkZW4nKTt0aGlzLiQoJy5vX3NlbGVjdF9maWxlX2J1dHRvbicpLmZpcnN0KCkuYWRkQ2xhc3MoJ29faGlkZGVuJyk7dGhpcy4kKCcub19pbnB1dCcpLmVxKDApLnZhbCh0aGlzLmZpbGVuYW1lX3ZhbHVlfHx0aGlzLnZhbHVlKTt9ZWxzZXt0aGlzLiRlbC5jaGlsZHJlbigpLmFkZENsYXNzKCdvX2hpZGRlbicpO3RoaXMuJCgnLm9fc2VsZWN0X2ZpbGVfYnV0dG9uJykuZmlyc3QoKS5yZW1vdmVDbGFzcygnb19oaWRkZW4nKTt9fSxzZXRfZmlsZW5hbWU6ZnVuY3Rpb24odmFsdWUpe3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLmZpbGVuYW1lX3ZhbHVlPXZhbHVlO3RoaXMuJCgnLm9fc2F2ZV9maWxlX2J1dHRvbicpLnByb3AoJ2Rpc2FibGVkJyx0cnVlKTt9LG9uX3NhdmVfYXM6ZnVuY3Rpb24oZXYpe2lmKCF0aGlzLnZhbHVlKXt0aGlzLmRvX3dhcm4oX3QoIlNhdmUgQXMuLi4iKSxfdCgiVGhlIGZpZWxkIGlzIGVtcHR5LCB0aGVyZSdzIG5vdGhpbmcgdG8gc2F2ZSAhIikpO2V2LnN0b3BQcm9wYWdhdGlvbigpO31lbHNlIGlmKHRoaXMucmVzX2lkKXtmcmFtZXdvcmsuYmxvY2tVSSgpO3ZhciBmaWxlbmFtZV9maWVsZG5hbWU9dGhpcy5hdHRycy5maWxlbmFtZTt0aGlzLmdldFNlc3Npb24oKS5nZXRfZmlsZSh7Y29tcGxldGU6ZnJhbWV3b3JrLnVuYmxvY2tVSSxkYXRhOnsnbW9kZWwnOnRoaXMubW9kZWwsJ2lkJzp0aGlzLnJlc19pZCwnZmllbGQnOnRoaXMubmFtZSwnZmlsZW5hbWVfZmllbGQnOmZpbGVuYW1lX2ZpZWxkbmFtZSwnZmlsZW5hbWUnOnRoaXMucmVjb3JkRGF0YVtmaWxlbmFtZV9maWVsZG5hbWVdfHwiIiwnZG93bmxvYWQnOnRydWUsJ2RhdGEnOnV0aWxzLmlzX2Jpbl9zaXplKHRoaXMudmFsdWUpP251bGw6dGhpcy52YWx1ZSx9LGVycm9yOihlcnJvcik9PnRoaXMuY2FsbCgnY3Jhc2hfbWFuYWdlcicsJ3JwY19lcnJvcicsZXJyb3IpLHVybDonL3dlYi9jb250ZW50Jyx9KTtldi5zdG9wUHJvcGFnYXRpb24oKTt9fSx9KTt2YXIgRmllbGRQZGZWaWV3ZXI9RmllbGRCaW5hcnlGaWxlLmV4dGVuZCh7ZGVzY3JpcHRpb246X2x0KCJQREYgVmlld2VyIiksc3VwcG9ydGVkRmllbGRUeXBlczpbJ2JpbmFyeSddLHRlbXBsYXRlOidGaWVsZFBkZlZpZXdlcicsaW5pdDpmdW5jdGlvbigpe3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLlBERlZpZXdlckFwcGxpY2F0aW9uPWZhbHNlO30sX2Rpc2FibGVCdXR0b25zOmZ1bmN0aW9uKGlmcmFtZSl7JChpZnJhbWUpLmNvbnRlbnRzKCkuZmluZCgnYnV0dG9uI29wZW5GaWxlJykuaGlkZSgpO30sX2dldFVSSTpmdW5jdGlvbihmaWxlVVJJKXt2YXIgcGFnZT10aGlzLnJlY29yZERhdGFbdGhpcy5uYW1lKydfcGFnZSddfHwxO2lmKCFmaWxlVVJJKXt2YXIgcXVlcnlPYmo9e21vZGVsOnRoaXMubW9kZWwsZmllbGQ6dGhpcy5uYW1lLGlkOnRoaXMucmVzX2lkLH07dmFyIHF1ZXJ5U3RyaW5nPSQucGFyYW0ocXVlcnlPYmopO2ZpbGVVUkk9Jy93ZWIvY29udGVudD8nK3F1ZXJ5U3RyaW5nO30KZmlsZVVSST1lbmNvZGVVUklDb21wb25lbnQoZmlsZVVSSSk7dmFyIHZpZXdlclVSTD0nL3dlYi9zdGF0aWMvbGliL3BkZmpzL3dlYi92aWV3ZXIuaHRtbD9maWxlPSc7cmV0dXJuIHZpZXdlclVSTCtmaWxlVVJJKycjcGFnZT0nK3BhZ2U7fSxfcmVuZGVyOmZ1bmN0aW9uKCl7dmFyIHNlbGY9dGhpczt2YXIgJHBkZlZpZXdlcj10aGlzLiQoJy5vX2Zvcm1fcGRmX2NvbnRyb2xzJykuY2hpbGRyZW4oKS5hZGQodGhpcy4kKCcub19wZGZ2aWV3X2lmcmFtZScpKTt2YXIgJHNlbGVjdFVwbG9hZD10aGlzLiQoJy5vX3NlbGVjdF9maWxlX2J1dHRvbicpLmZpcnN0KCk7dmFyICRpRnJhbWU9dGhpcy4kKCcub19wZGZ2aWV3X2lmcmFtZScpOyRpRnJhbWUub24oJ2xvYWQnLGZ1bmN0aW9uKCl7c2VsZi5QREZWaWV3ZXJBcHBsaWNhdGlvbj10aGlzLmNvbnRlbnRXaW5kb3cud2luZG93LlBERlZpZXdlckFwcGxpY2F0aW9uO3NlbGYuX2Rpc2FibGVCdXR0b25zKHRoaXMpO30pO2lmKHRoaXMubW9kZT09PSJyZWFkb25seSImJnRoaXMudmFsdWUpeyRpRnJhbWUuYXR0cignc3JjJyx0aGlzLl9nZXRVUkkoKSk7fWVsc2V7aWYodGhpcy52YWx1ZSl7dmFyIGJpblNpemU9dXRpbHMuaXNfYmluX3NpemUodGhpcy52YWx1ZSk7JHBkZlZpZXdlci5yZW1vdmVDbGFzcygnb19oaWRkZW4nKTskc2VsZWN0VXBsb2FkLmFkZENsYXNzKCdvX2hpZGRlbicpO2lmKGJpblNpemUpeyRpRnJhbWUuYXR0cignc3JjJyx0aGlzLl9nZXRVUkkoKSk7fX1lbHNleyRwZGZWaWV3ZXIuYWRkQ2xhc3MoJ29faGlkZGVuJyk7JHNlbGVjdFVwbG9hZC5yZW1vdmVDbGFzcygnb19oaWRkZW4nKTt9fX0sb25fZmlsZV9jaGFuZ2U6ZnVuY3Rpb24oZXYpe3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt2YXIgZmlsZXM9ZXYudGFyZ2V0LmZpbGVzO2lmKCFmaWxlc3x8ZmlsZXMubGVuZ3RoPT09MCl7cmV0dXJuO30KdmFyIGZpbGVVUkk9VVJMLmNyZWF0ZU9iamVjdFVSTChmaWxlc1swXSk7aWYodGhpcy5QREZWaWV3ZXJBcHBsaWNhdGlvbil7dGhpcy5QREZWaWV3ZXJBcHBsaWNhdGlvbi5vcGVuKGZpbGVVUkksMCk7fWVsc2V7dGhpcy4kKCcub19wZGZ2aWV3X2lmcmFtZScpLmF0dHIoJ3NyYycsdGhpcy5fZ2V0VVJJKGZpbGVVUkkpKTt9fSxvbl9zYXZlX2FzOmZ1bmN0aW9uKGV2KXtldi5zdG9wUHJvcGFnYXRpb24oKTt9LH0pO3ZhciBQcmlvcml0eVdpZGdldD1BYnN0cmFjdEZpZWxkLmV4dGVuZCh7ZGVzY3JpcHRpb246X2x0KCJQcmlvcml0eSIpLGNsYXNzTmFtZToib19wcmlvcml0eSIsZXZlbnRzOnsnbW91c2VvdmVyID4gYSc6J19vbk1vdXNlT3ZlcicsJ21vdXNlb3V0ID4gYSc6J19vbk1vdXNlT3V0JywnY2xpY2sgPiBhJzonX29uQ2xpY2snLH0sc3VwcG9ydGVkRmllbGRUeXBlczpbJ3NlbGVjdGlvbiddLGlzU2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRydWU7fSxfcmVuZGVyOmZ1bmN0aW9uKCl7dmFyIHNlbGY9dGhpczt2YXIgaW5kZXhfdmFsdWU9dGhpcy52YWx1ZT9fLmZpbmRJbmRleCh0aGlzLmZpZWxkLnNlbGVjdGlvbixmdW5jdGlvbih2KXtyZXR1cm4gdlswXT09PXNlbGYudmFsdWU7fSk6MDt0aGlzLiRlbC5lbXB0eSgpO3RoaXMuZW1wdHlfdmFsdWU9dGhpcy5maWVsZC5zZWxlY3Rpb25bMF1bMF07Xy5lYWNoKHRoaXMuZmllbGQuc2VsZWN0aW9uLnNsaWNlKDEpLGZ1bmN0aW9uKGNob2ljZSxpbmRleCl7c2VsZi4kZWwuYXBwZW5kKHNlbGYuX3JlbmRlclN0YXIoJzxhIGhyZWY9IiMiPicsaW5kZXhfdmFsdWU+PWluZGV4KzEsaW5kZXgrMSxjaG9pY2VbMV0pKTt9KTt9LF9yZW5kZXJTdGFyOmZ1bmN0aW9uKHRhZyxpc0Z1bGwsaW5kZXgsdGlwKXtyZXR1cm4gJCh0YWcpLmF0dHIoJ3RpdGxlJyx0aXApLmF0dHIoJ2FyaWEtbGFiZWwnLHRpcCkuYXR0cignZGF0YS1pbmRleCcsaW5kZXgpLmFkZENsYXNzKCdvX3ByaW9yaXR5X3N0YXIgZmEnKS50b2dnbGVDbGFzcygnZmEtc3RhcicsaXNGdWxsKS50b2dnbGVDbGFzcygnZmEtc3Rhci1vJywhaXNGdWxsKTt9LF9vbkNsaWNrOmZ1bmN0aW9uKGV2ZW50KXtldmVudC5wcmV2ZW50RGVmYXVsdCgpO2V2ZW50LnN0b3BQcm9wYWdhdGlvbigpO3ZhciBpbmRleD0kKGV2ZW50LmN1cnJlbnRUYXJnZXQpLmRhdGEoJ2luZGV4Jyk7dmFyIG5ld1ZhbHVlPXRoaXMuZmllbGQuc2VsZWN0aW9uW2luZGV4XVswXTtpZihuZXdWYWx1ZT09PXRoaXMudmFsdWUpe25ld1ZhbHVlPXRoaXMuZW1wdHlfdmFsdWU7fQp0aGlzLl9zZXRWYWx1ZShuZXdWYWx1ZSk7fSxfb25Nb3VzZU91dDpmdW5jdGlvbigpe2NsZWFyVGltZW91dCh0aGlzLmhvdmVyVGltZXIpO3ZhciBzZWxmPXRoaXM7dGhpcy5ob3ZlclRpbWVyPXNldFRpbWVvdXQoZnVuY3Rpb24oKXtzZWxmLl9yZW5kZXIoKTt9LDIwMCk7fSxfb25Nb3VzZU92ZXI6ZnVuY3Rpb24oZXZlbnQpe2NsZWFyVGltZW91dCh0aGlzLmhvdmVyVGltZXIpO3RoaXMuJCgnLm9fcHJpb3JpdHlfc3RhcicpLnJlbW92ZUNsYXNzKCdmYS1zdGFyLW8nKS5hZGRDbGFzcygnZmEtc3RhcicpOyQoZXZlbnQuY3VycmVudFRhcmdldCkubmV4dEFsbCgpLnJlbW92ZUNsYXNzKCdmYS1zdGFyJykuYWRkQ2xhc3MoJ2ZhLXN0YXItbycpO30sfSk7dmFyIEF0dGFjaG1lbnRJbWFnZT1BYnN0cmFjdEZpZWxkLmV4dGVuZCh7Y2xhc3NOYW1lOidvX2F0dGFjaG1lbnRfaW1hZ2UnLF9yZW5kZXI6ZnVuY3Rpb24oKXtpZih0aGlzLnZhbHVlKXt0aGlzLiRlbC5lbXB0eSgpLmFwcGVuZCgkKCc8aW1nPi8nLHtzcmM6Ii93ZWIvaW1hZ2UvIit0aGlzLnZhbHVlLmRhdGEuaWQrIj91bmlxdWU9MSIsdGl0bGU6dGhpcy52YWx1ZS5kYXRhLmRpc3BsYXlfbmFtZSxhbHQ6X3QoIkltYWdlIil9KSk7fX19KTt2YXIgU3RhdGVTZWxlY3Rpb25XaWRnZXQ9QWJzdHJhY3RGaWVsZC5leHRlbmQoe3RlbXBsYXRlOidGb3JtU2VsZWN0aW9uJyxldmVudHM6eydjbGljayAuZHJvcGRvd24taXRlbSc6J19zZXRTZWxlY3Rpb24nLH0sc3VwcG9ydGVkRmllbGRUeXBlczpbJ3NlbGVjdGlvbiddLF9wcmVwYXJlRHJvcGRvd25WYWx1ZXM6ZnVuY3Rpb24oKXt2YXIgc2VsZj10aGlzO3ZhciBfZGF0YT1bXTt2YXIgY3VycmVudF9zdGFnZV9pZD1zZWxmLnJlY29yZERhdGEuc3RhZ2VfaWQmJnNlbGYucmVjb3JkRGF0YS5zdGFnZV9pZFswXTt2YXIgc3RhZ2VfZGF0YT17aWQ6Y3VycmVudF9zdGFnZV9pZCxsZWdlbmRfbm9ybWFsOnRoaXMucmVjb3JkRGF0YS5sZWdlbmRfbm9ybWFsfHx1bmRlZmluZWQsbGVnZW5kX2Jsb2NrZWQ6dGhpcy5yZWNvcmREYXRhLmxlZ2VuZF9ibG9ja2VkfHx1bmRlZmluZWQsbGVnZW5kX2RvbmU6dGhpcy5yZWNvcmREYXRhLmxlZ2VuZF9kb25lfHx1bmRlZmluZWQsfTtfLm1hcCh0aGlzLmZpZWxkLnNlbGVjdGlvbnx8W10sZnVuY3Rpb24oc2VsZWN0aW9uX2l0ZW0pe3ZhciB2YWx1ZT17J25hbWUnOnNlbGVjdGlvbl9pdGVtWzBdLCd0b29sdGlwJzpzZWxlY3Rpb25faXRlbVsxXSx9O2lmKHNlbGVjdGlvbl9pdGVtWzBdPT09J25vcm1hbCcpe3ZhbHVlLnN0YXRlX25hbWU9c3RhZ2VfZGF0YS5sZWdlbmRfbm9ybWFsP3N0YWdlX2RhdGEubGVnZW5kX25vcm1hbDpzZWxlY3Rpb25faXRlbVsxXTt9ZWxzZSBpZihzZWxlY3Rpb25faXRlbVswXT09PSdkb25lJyl7dmFsdWUuc3RhdGVfY2xhc3M9J29fc3RhdHVzX2dyZWVuJzt2YWx1ZS5zdGF0ZV9uYW1lPXN0YWdlX2RhdGEubGVnZW5kX2RvbmU/c3RhZ2VfZGF0YS5sZWdlbmRfZG9uZTpzZWxlY3Rpb25faXRlbVsxXTt9ZWxzZXt2YWx1ZS5zdGF0ZV9jbGFzcz0nb19zdGF0dXNfcmVkJzt2YWx1ZS5zdGF0ZV9uYW1lPXN0YWdlX2RhdGEubGVnZW5kX2Jsb2NrZWQ/c3RhZ2VfZGF0YS5sZWdlbmRfYmxvY2tlZDpzZWxlY3Rpb25faXRlbVsxXTt9Cl9kYXRhLnB1c2godmFsdWUpO30pO3JldHVybiBfZGF0YTt9LF9yZW5kZXI6ZnVuY3Rpb24oKXt2YXIgc3RhdGVzPXRoaXMuX3ByZXBhcmVEcm9wZG93blZhbHVlcygpO3ZhciBjdXJyZW50U3RhdGU9Xy5maW5kV2hlcmUoc3RhdGVzLHtuYW1lOnRoaXMudmFsdWV9KXx8c3RhdGVzWzBdO3RoaXMuJCgnLm9fc3RhdHVzJykucmVtb3ZlQ2xhc3MoJ29fc3RhdHVzX3JlZCBvX3N0YXR1c19ncmVlbicpLmFkZENsYXNzKGN1cnJlbnRTdGF0ZS5zdGF0ZV9jbGFzcykucHJvcCgnc3BlY2lhbF9jbGljaycsdHJ1ZSkucGFyZW50KCkuYXR0cigndGl0bGUnLGN1cnJlbnRTdGF0ZS5zdGF0ZV9uYW1lKS5hdHRyKCdhcmlhLWxhYmVsJyxjdXJyZW50U3RhdGUuc3RhdGVfbmFtZSk7dmFyICRpdGVtcz0kKHF3ZWIucmVuZGVyKCdGb3JtU2VsZWN0aW9uLml0ZW1zJyx7c3RhdGVzOl8ud2l0aG91dChzdGF0ZXMsY3VycmVudFN0YXRlKX0pKTt2YXIgJGRyb3Bkb3duPXRoaXMuJCgnLmRyb3Bkb3duLW1lbnUnKTskZHJvcGRvd24uY2hpbGRyZW4oKS5yZW1vdmUoKTskaXRlbXMuYXBwZW5kVG8oJGRyb3Bkb3duKTt2YXIgaXNSZWFkb25seT10aGlzLnJlY29yZC5ldmFsTW9kaWZpZXJzKHRoaXMuYXR0cnMubW9kaWZpZXJzKS5yZWFkb25seTt0aGlzLiQoJ2FbZGF0YS10b2dnbGU9ZHJvcGRvd25dJykudG9nZ2xlQ2xhc3MoJ2Rpc2FibGVkJyxpc1JlYWRvbmx5fHxmYWxzZSk7fSxfc2V0U2VsZWN0aW9uOmZ1bmN0aW9uKGV2KXtldi5wcmV2ZW50RGVmYXVsdCgpO3ZhciAkaXRlbT0kKGV2LmN1cnJlbnRUYXJnZXQpO3ZhciB2YWx1ZT1TdHJpbmcoJGl0ZW0uZGF0YSgndmFsdWUnKSk7dGhpcy5fc2V0VmFsdWUodmFsdWUpO2lmKHRoaXMubW9kZT09PSdlZGl0Jyl7dGhpcy5fcmVuZGVyKCk7fX0sfSk7dmFyIEZhdm9yaXRlV2lkZ2V0PUFic3RyYWN0RmllbGQuZXh0ZW5kKHtjbGFzc05hbWU6J29fZmF2b3JpdGUnLGV2ZW50czp7J2NsaWNrJzonX3NldEZhdm9yaXRlJ30sc3VwcG9ydGVkRmllbGRUeXBlczpbJ2Jvb2xlYW4nXSxpc1NldDpmdW5jdGlvbigpe3JldHVybiB0cnVlO30sX3JlbmRlcjpmdW5jdGlvbigpe3ZhciB0aXA9dGhpcy52YWx1ZT9fdCgnUmVtb3ZlIGZyb20gRmF2b3JpdGVzJyk6X3QoJ0FkZCB0byBGYXZvcml0ZXMnKTt2YXIgdGVtcGxhdGU9dGhpcy5hdHRycy5ub2xhYmVsPyc8YSBocmVmPSIjIj48aSBjbGFzcz0iZmEgJXMiIHRpdGxlPSIlcyIgYXJpYS1sYWJlbD0iJXMiIHJvbGU9ImltZyI+PC9pPjwvYT4nOic8YSBocmVmPSIjIj48aSBjbGFzcz0iZmEgJXMiIHJvbGU9ImltZyIgYXJpYS1sYWJlbD0iJXMiPjwvaT4gJXM8L2E+Jzt0aGlzLiRlbC5lbXB0eSgpLmFwcGVuZChfLnN0ci5zcHJpbnRmKHRlbXBsYXRlLHRoaXMudmFsdWU/J2ZhLXN0YXInOidmYS1zdGFyLW8nLHRpcCx0aXApKTt9LF9zZXRGYXZvcml0ZTpmdW5jdGlvbihldmVudCl7ZXZlbnQucHJldmVudERlZmF1bHQoKTtldmVudC5zdG9wUHJvcGFnYXRpb24oKTt0aGlzLl9zZXRWYWx1ZSghdGhpcy52YWx1ZSk7fSx9KTt2YXIgTGFiZWxTZWxlY3Rpb249QWJzdHJhY3RGaWVsZC5leHRlbmQoe3N1cHBvcnRlZEZpZWxkVHlwZXM6WydzZWxlY3Rpb24nXSxfcmVuZGVyOmZ1bmN0aW9uKCl7dGhpcy5jbGFzc2VzPXRoaXMubm9kZU9wdGlvbnMmJnRoaXMubm9kZU9wdGlvbnMuY2xhc3Nlc3x8e307dmFyIGxhYmVsQ2xhc3M9dGhpcy5jbGFzc2VzW3RoaXMudmFsdWVdfHwncHJpbWFyeSc7dGhpcy4kZWwuYWRkQ2xhc3MoJ2JhZGdlIGJhZGdlLScrbGFiZWxDbGFzcykudGV4dCh0aGlzLl9mb3JtYXRWYWx1ZSh0aGlzLnZhbHVlKSk7fSx9KTt2YXIgQm9vbGVhblRvZ2dsZT1GaWVsZEJvb2xlYW4uZXh0ZW5kKHtkZXNjcmlwdGlvbjpfbHQoIlRvZ2dsZSIpLGNsYXNzTmFtZTpGaWVsZEJvb2xlYW4ucHJvdG90eXBlLmNsYXNzTmFtZSsnIG9fYm9vbGVhbl90b2dnbGUnLGV2ZW50czp7J2NsaWNrJzonX29uQ2xpY2snfSxfb25DbGljazpmdW5jdGlvbihldmVudCl7ZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7dGhpcy5fc2V0VmFsdWUoIXRoaXMudmFsdWUpO3RoaXMuJGVsLmNsb3Nlc3QoIi5vX2RhdGFfcm93IikudG9nZ2xlQ2xhc3MoJ3RleHQtbXV0ZWQnLHRoaXMudmFsdWUpO30sfSk7dmFyIFN0YXRJbmZvPUFic3RyYWN0RmllbGQuZXh0ZW5kKHtzdXBwb3J0ZWRGaWVsZFR5cGVzOlsnaW50ZWdlcicsJ2Zsb2F0J10saXNTZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdHJ1ZTt9LF9yZW5kZXI6ZnVuY3Rpb24oKXt2YXIgb3B0aW9ucz17dmFsdWU6dGhpcy5fZm9ybWF0VmFsdWUodGhpcy52YWx1ZXx8MCksfTtpZighdGhpcy5hdHRycy5ub2xhYmVsKXtpZih0aGlzLm5vZGVPcHRpb25zLmxhYmVsX2ZpZWxkJiZ0aGlzLnJlY29yZERhdGFbdGhpcy5ub2RlT3B0aW9ucy5sYWJlbF9maWVsZF0pe29wdGlvbnMudGV4dD10aGlzLnJlY29yZERhdGFbdGhpcy5ub2RlT3B0aW9ucy5sYWJlbF9maWVsZF07fWVsc2V7b3B0aW9ucy50ZXh0PXRoaXMuc3RyaW5nO319CnRoaXMuJGVsLmh0bWwocXdlYi5yZW5kZXIoIlN0YXRJbmZvIixvcHRpb25zKSk7dGhpcy4kZWwuYWRkQ2xhc3MoJ29fc3RhdF9pbmZvJyk7fSx9KTt2YXIgRmllbGRQZXJjZW50UGllPUFic3RyYWN0RmllbGQuZXh0ZW5kKHtkZXNjcmlwdGlvbjpfbHQoIlBlcmNlbnRhZ2UgUGllIiksdGVtcGxhdGU6J0ZpZWxkUGVyY2VudFBpZScsc3VwcG9ydGVkRmllbGRUeXBlczpbJ2ludGVnZXInLCdmbG9hdCddLHN0YXJ0OmZ1bmN0aW9uKCl7dGhpcy4kbGVmdE1hc2s9dGhpcy4kKCcub19tYXNrJykuZmlyc3QoKTt0aGlzLiRyaWdodE1hc2s9dGhpcy4kKCcub19tYXNrJykubGFzdCgpO3RoaXMuJHBpZVZhbHVlPXRoaXMuJCgnLm9fcGllX3ZhbHVlJyk7cmV0dXJuIHRoaXMuX3N1cGVyKCk7fSxpc1NldDpmdW5jdGlvbigpe3JldHVybiB0cnVlO30sX3JlbmRlcjpmdW5jdGlvbigpe3ZhciB2YWx1ZT10aGlzLnZhbHVlfHwwO3ZhciBkZWdWYWx1ZT0zNjAqdmFsdWUvMTAwO3RoaXMuJHJpZ2h0TWFzay50b2dnbGVDbGFzcygnb19mdWxsJyxkZWdWYWx1ZT49MTgwKTt2YXIgbGVmdERlZz0ncm90YXRlKCcrKChkZWdWYWx1ZTwxODApPzE4MDpkZWdWYWx1ZSkrJ2RlZyknO3ZhciByaWdodERlZz0ncm90YXRlKCcrKChkZWdWYWx1ZTwxODApP2RlZ1ZhbHVlOjApKydkZWcpJzt0aGlzLiRsZWZ0TWFzay5jc3Moe3RyYW5zZm9ybTpsZWZ0RGVnLG1zVHJhbnNmb3JtOmxlZnREZWcsbW96VHJhbnNmb3JtOmxlZnREZWcsd2Via2l0VHJhbnNmb3JtOmxlZnREZWd9KTt0aGlzLiRyaWdodE1hc2suY3NzKHt0cmFuc2Zvcm06cmlnaHREZWcsbXNUcmFuc2Zvcm06cmlnaHREZWcsbW96VHJhbnNmb3JtOnJpZ2h0RGVnLHdlYmtpdFRyYW5zZm9ybTpyaWdodERlZ30pO3RoaXMuJHBpZVZhbHVlLnRleHQoTWF0aC5yb3VuZCh2YWx1ZSkrJyUnKTt9LH0pO3ZhciBGaWVsZFByb2dyZXNzQmFyPUFic3RyYWN0RmllbGQuZXh0ZW5kKHtkZXNjcmlwdGlvbjpfbHQoIlByb2dyZXNzIEJhciIpLHRlbXBsYXRlOiJQcm9ncmVzc0JhciIsZXZlbnRzOnsnY2hhbmdlIGlucHV0Jzonb25fY2hhbmdlX2lucHV0JywnaW5wdXQgaW5wdXQnOidvbl9jaGFuZ2VfaW5wdXQnLCdrZXl1cCBpbnB1dCc6ZnVuY3Rpb24oZSl7aWYoZS53aGljaD09PSQudWkua2V5Q29kZS5FTlRFUil7dGhpcy5vbl9jaGFuZ2VfaW5wdXQoZSk7fX0sfSxzdXBwb3J0ZWRGaWVsZFR5cGVzOlsnaW50ZWdlcicsJ2Zsb2F0J10saW5pdDpmdW5jdGlvbigpe3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtpZih0aGlzLnJlY29yZERhdGFbdGhpcy5ub2RlT3B0aW9ucy5jdXJyZW50X3ZhbHVlXSl7dGhpcy52YWx1ZT10aGlzLnJlY29yZERhdGFbdGhpcy5ub2RlT3B0aW9ucy5jdXJyZW50X3ZhbHVlXTt9CnRoaXMuZWRpdGFibGVfcmVhZG9ubHk9ISF0aGlzLm5vZGVPcHRpb25zLmVkaXRhYmxlX3JlYWRvbmx5O3RoaXMucmVhZG9ubHk9dGhpcy5ub2RlT3B0aW9ucy5yZWFkb25seXx8IXRoaXMubm9kZU9wdGlvbnMuZWRpdGFibGU7dGhpcy5jYW5Xcml0ZT0hdGhpcy5yZWFkb25seSYmKHRoaXMubW9kZT09PSdlZGl0J3x8KHRoaXMuZWRpdGFibGVfcmVhZG9ubHkmJnRoaXMubW9kZT09PSdyZWFkb25seScpfHwodGhpcy52aWV3VHlwZT09PSdrYW5iYW4nKSk7dGhpcy5lZGl0X21heF92YWx1ZT0hIXRoaXMubm9kZU9wdGlvbnMuZWRpdF9tYXhfdmFsdWU7dGhpcy5tYXhfdmFsdWU9dGhpcy5yZWNvcmREYXRhW3RoaXMubm9kZU9wdGlvbnMubWF4X3ZhbHVlXXx8MTAwO3RoaXMudGl0bGU9X3QodGhpcy5hdHRycy50aXRsZXx8dGhpcy5ub2RlT3B0aW9ucy50aXRsZSl8fCcnO3RoaXMuZW5hYmxlQmFyQXNJbnB1dD1mYWxzZTt0aGlzLmVkaXRfb25fY2xpY2s9dGhpcy5lbmFibGVCYXJBc0lucHV0JiZ0aGlzLm1vZGU9PT0ncmVhZG9ubHknJiYhdGhpcy5lZGl0X21heF92YWx1ZTt0aGlzLndyaXRlX21vZGU9ZmFsc2U7fSxfcmVuZGVyOmZ1bmN0aW9uKCl7dmFyIHNlbGY9dGhpczt0aGlzLl9yZW5kZXJfdmFsdWUoKTtpZih0aGlzLmNhbldyaXRlKXtpZih0aGlzLmVkaXRfb25fY2xpY2spe3RoaXMuJGVsLm9uKCdjbGljaycsJy5vX3Byb2dyZXNzJyxmdW5jdGlvbihlKXt2YXIgJHRhcmdldD0kKGUuY3VycmVudFRhcmdldCk7dmFyIG51bVZhbHVlPU1hdGguZmxvb3IoKGUucGFnZVgtJHRhcmdldC5vZmZzZXQoKS5sZWZ0KS8kdGFyZ2V0Lm91dGVyV2lkdGgoKSpzZWxmLm1heF92YWx1ZSk7c2VsZi5vbl91cGRhdGUobnVtVmFsdWUpO3NlbGYuX3JlbmRlcl92YWx1ZSgpO30pO31lbHNle3RoaXMuJGVsLm9uKCdjbGljaycsZnVuY3Rpb24oKXtpZighc2VsZi53cml0ZV9tb2RlKXt2YXIgJGlucHV0PSQoJzxpbnB1dD4nLHt0eXBlOid0ZXh0JyxjbGFzczonb19wcm9ncmVzc2Jhcl92YWx1ZSBvX2lucHV0J30pOyRpbnB1dC5vbignYmx1cicsc2VsZi5vbl9jaGFuZ2VfaW5wdXQuYmluZChzZWxmKSk7c2VsZi4kKCcub19wcm9ncmVzc2Jhcl92YWx1ZScpLnJlcGxhY2VXaXRoKCRpbnB1dCk7c2VsZi53cml0ZV9tb2RlPXRydWU7c2VsZi5fcmVuZGVyX3ZhbHVlKCk7fX0pO319CnJldHVybiB0aGlzLl9zdXBlcigpO30sb25fdXBkYXRlOmZ1bmN0aW9uKHZhbHVlKXtpZih0aGlzLmVkaXRfbWF4X3ZhbHVlKXt0aGlzLm1heF92YWx1ZT12YWx1ZTt0aGlzLl9pc1ZhbGlkPXRydWU7dmFyIGNoYW5nZXM9e307Y2hhbmdlc1t0aGlzLm5vZGVPcHRpb25zLm1heF92YWx1ZV09dGhpcy5tYXhfdmFsdWU7dGhpcy50cmlnZ2VyX3VwKCdmaWVsZF9jaGFuZ2VkJyx7ZGF0YVBvaW50SUQ6dGhpcy5kYXRhUG9pbnRJRCxjaGFuZ2VzOmNoYW5nZXMsfSk7fWVsc2V7dmFyIGZvcm1hdHRlZFZhbHVlPXRoaXMuX2Zvcm1hdFZhbHVlKHZhbHVlKTt0aGlzLl9zZXRWYWx1ZShmb3JtYXR0ZWRWYWx1ZSk7fX0sb25fY2hhbmdlX2lucHV0OmZ1bmN0aW9uKGUpe3ZhciAkaW5wdXQ9JChlLnRhcmdldCk7aWYoZS50eXBlPT09J2NoYW5nZScmJiEkaW5wdXQuaXMoJzpmb2N1cycpKXtyZXR1cm47fQp2YXIgcGFyc2VkVmFsdWU7dHJ5e3BhcnNlZFZhbHVlPWZpZWxkX3V0aWxzLnBhcnNlLmZsb2F0KCRpbnB1dC52YWwoKSk7fWNhdGNoKGVycm9yKXt0aGlzLmRvX3dhcm4oX3QoIldyb25nIHZhbHVlIGVudGVyZWQhIiksX3QoIk9ubHkgSW50ZWdlciBvciBGbG9hdCBWYWx1ZSBzaG91bGQgYmUgdmFsaWQuIikpO30KaWYocGFyc2VkVmFsdWUhPT11bmRlZmluZWQpe2lmKGUudHlwZT09PSdpbnB1dCcpe3RoaXMuX3JlbmRlcl92YWx1ZShwYXJzZWRWYWx1ZSk7aWYocGFyc2VkVmFsdWU9PT0wKXskaW5wdXQuc2VsZWN0KCk7fX1lbHNle2lmKHRoaXMuZWRpdF9tYXhfdmFsdWUpe3BhcnNlZFZhbHVlPXBhcnNlZFZhbHVlfHwxMDA7fQp2YXIgJGRpdj0kKCc8ZGl2Picse2NsYXNzOidvX3Byb2dyZXNzYmFyX3ZhbHVlJ30pO3RoaXMuJCgnLm9fcHJvZ3Jlc3NiYXJfdmFsdWUnKS5yZXBsYWNlV2l0aCgkZGl2KTt0aGlzLndyaXRlX21vZGU9ZmFsc2U7dGhpcy5vbl91cGRhdGUocGFyc2VkVmFsdWUpO3RoaXMuX3JlbmRlcl92YWx1ZSgpO319fSxfcmVuZGVyX3ZhbHVlOmZ1bmN0aW9uKHYpe3ZhciB2YWx1ZT10aGlzLnZhbHVlO3ZhciBtYXhfdmFsdWU9dGhpcy5tYXhfdmFsdWU7aWYoIWlzTmFOKHYpKXtpZih0aGlzLmVkaXRfbWF4X3ZhbHVlKXttYXhfdmFsdWU9djt9ZWxzZXt2YWx1ZT12O319CnZhbHVlPXZhbHVlfHwwO21heF92YWx1ZT1tYXhfdmFsdWV8fDA7dmFyIHdpZHRoQ29tcGxldGU7aWYodmFsdWU8PW1heF92YWx1ZSl7d2lkdGhDb21wbGV0ZT12YWx1ZS9tYXhfdmFsdWUqMTAwO31lbHNle3dpZHRoQ29tcGxldGU9MTAwO30KdGhpcy4kKCcub19wcm9ncmVzcycpLnRvZ2dsZUNsYXNzKCdvX3Byb2dyZXNzX292ZXJmbG93Jyx2YWx1ZT5tYXhfdmFsdWUpLmF0dHIoJ2FyaWEtdmFsdWVtaW4nLCcwJykuYXR0cignYXJpYS12YWx1ZW1heCcsbWF4X3ZhbHVlKS5hdHRyKCdhcmlhLXZhbHVlbm93Jyx2YWx1ZSk7dGhpcy4kKCcub19wcm9ncmVzc2Jhcl9jb21wbGV0ZScpLmNzcygnd2lkdGgnLHdpZHRoQ29tcGxldGUrJyUnKTtpZighdGhpcy53cml0ZV9tb2RlKXtpZihtYXhfdmFsdWUhPT0xMDApe3RoaXMuJCgnLm9fcHJvZ3Jlc3NiYXJfdmFsdWUnKS50ZXh0KHV0aWxzLmh1bWFuX251bWJlcih2YWx1ZSkrIiAvICIrdXRpbHMuaHVtYW5fbnVtYmVyKG1heF92YWx1ZSkpO31lbHNle3RoaXMuJCgnLm9fcHJvZ3Jlc3NiYXJfdmFsdWUnKS50ZXh0KHV0aWxzLmh1bWFuX251bWJlcih2YWx1ZSkrIiUiKTt9fWVsc2UgaWYoaXNOYU4odikpe3RoaXMuJCgnLm9fcHJvZ3Jlc3NiYXJfdmFsdWUnKS52YWwodGhpcy5lZGl0X21heF92YWx1ZT9tYXhfdmFsdWU6dmFsdWUpO3RoaXMuJCgnLm9fcHJvZ3Jlc3NiYXJfdmFsdWUnKS5mb2N1cygpLnNlbGVjdCgpO319LF9yZXNldDpmdW5jdGlvbigpe3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt2YXIgbmV3X21heF92YWx1ZT10aGlzLnJlY29yZERhdGFbdGhpcy5ub2RlT3B0aW9ucy5tYXhfdmFsdWVdO3RoaXMubWF4X3ZhbHVlPW5ld19tYXhfdmFsdWUhPT11bmRlZmluZWQ/bmV3X21heF92YWx1ZTp0aGlzLm1heF92YWx1ZTt9LGlzU2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRydWU7fSx9KTt2YXIgRmllbGRUb2dnbGVCb29sZWFuPUFic3RyYWN0RmllbGQuZXh0ZW5kKHtkZXNjcmlwdGlvbjpfbHQoIkJ1dHRvbiIpLHRlbXBsYXRlOiJ0b2dnbGVfYnV0dG9uIixldmVudHM6eydjbGljayc6J19vblRvZ2dsZUJ1dHRvbid9LHN1cHBvcnRlZEZpZWxkVHlwZXM6Wydib29sZWFuJ10saXNTZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdHJ1ZTt9LF9yZW5kZXI6ZnVuY3Rpb24oKXt0aGlzLiQoJ2knKS50b2dnbGVDbGFzcygnb190b2dnbGVfYnV0dG9uX3N1Y2Nlc3MnLCEhdGhpcy52YWx1ZSkudG9nZ2xlQ2xhc3MoJ3RleHQtbXV0ZWQnLCF0aGlzLnZhbHVlKTt2YXIgdGl0bGU9dGhpcy52YWx1ZT90aGlzLmF0dHJzLm9wdGlvbnMuYWN0aXZlOnRoaXMuYXR0cnMub3B0aW9ucy5pbmFjdGl2ZTt0aGlzLiRlbC5hdHRyKCd0aXRsZScsdGl0bGUpO3RoaXMuJGVsLmF0dHIoJ2FyaWEtcHJlc3NlZCcsdGhpcy52YWx1ZSk7fSxfb25Ub2dnbGVCdXR0b246ZnVuY3Rpb24oZXZlbnQpe2V2ZW50LnN0b3BQcm9wYWdhdGlvbigpO3RoaXMuX3NldFZhbHVlKCF0aGlzLnZhbHVlKTt9LH0pO3ZhciBKb3VybmFsRGFzaGJvYXJkR3JhcGg9QWJzdHJhY3RGaWVsZC5leHRlbmQoe2NsYXNzTmFtZToib19kYXNoYm9hcmRfZ3JhcGgiLGpzTGliczpbJy93ZWIvc3RhdGljL2xpYi9DaGFydC9DaGFydC5qcycsXSxpbml0OmZ1bmN0aW9uKCl7dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3RoaXMuZ3JhcGhfdHlwZT10aGlzLmF0dHJzLmdyYXBoX3R5cGU7dGhpcy5kYXRhPUpTT04ucGFyc2UodGhpcy52YWx1ZSk7fSxvbl9hdHRhY2hfY2FsbGJhY2s6ZnVuY3Rpb24oKXt0aGlzLl9pc0luRE9NPXRydWU7dGhpcy5fcmVuZGVySW5ET00oKTt9LG9uX2RldGFjaF9jYWxsYmFjazpmdW5jdGlvbigpe3RoaXMuX2lzSW5ET009ZmFsc2U7fSxfcmVuZGVyOmZ1bmN0aW9uKCl7aWYodGhpcy5faXNJbkRPTSl7cmV0dXJuIHRoaXMuX3JlbmRlckluRE9NKCk7fQpyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7fSxfcmVuZGVySW5ET006ZnVuY3Rpb24oKXt0aGlzLiRlbC5lbXB0eSgpO3ZhciBjb25maWcsY3NzQ2xhc3M7aWYodGhpcy5ncmFwaF90eXBlPT09J2xpbmUnKXtjb25maWc9dGhpcy5fZ2V0TGluZUNoYXJ0Q29uZmlnKCk7Y3NzQ2xhc3M9J29fZ3JhcGhfbGluZWNoYXJ0Jzt9ZWxzZSBpZih0aGlzLmdyYXBoX3R5cGU9PT0nYmFyJyl7Y29uZmlnPXRoaXMuX2dldEJhckNoYXJ0Q29uZmlnKCk7Y3NzQ2xhc3M9J29fZ3JhcGhfYmFyY2hhcnQnO30KdGhpcy4kY2FudmFzPSQoJzxjYW52YXMvPicpO3RoaXMuJGVsLmFkZENsYXNzKGNzc0NsYXNzKTt0aGlzLiRlbC5lbXB0eSgpO3RoaXMuJGVsLmFwcGVuZCh0aGlzLiRjYW52YXMpO3ZhciBjb250ZXh0PXRoaXMuJGNhbnZhc1swXS5nZXRDb250ZXh0KCcyZCcpO3RoaXMuY2hhcnQ9bmV3IENoYXJ0KGNvbnRleHQsY29uZmlnKTt9LF9nZXRMaW5lQ2hhcnRDb25maWc6ZnVuY3Rpb24oKXt2YXIgbGFiZWxzPXRoaXMuZGF0YVswXS52YWx1ZXMubWFwKGZ1bmN0aW9uKHB0KXtyZXR1cm4gcHQueDt9KTt2YXIgYm9yZGVyQ29sb3I9dGhpcy5kYXRhWzBdLmlzX3NhbXBsZV9kYXRhPycjZGRkZGRkJzonIzg3NWE3Yic7dmFyIGJhY2tncm91bmRDb2xvcj10aGlzLmRhdGFbMF0uaXNfc2FtcGxlX2RhdGE/JyNlYmViZWInOicjZGNkMGQ5JztyZXR1cm57dHlwZTonbGluZScsZGF0YTp7bGFiZWxzOmxhYmVscyxkYXRhc2V0czpbe2RhdGE6dGhpcy5kYXRhWzBdLnZhbHVlcyxmaWxsOidzdGFydCcsbGFiZWw6dGhpcy5kYXRhWzBdLmtleSxiYWNrZ3JvdW5kQ29sb3I6YmFja2dyb3VuZENvbG9yLGJvcmRlckNvbG9yOmJvcmRlckNvbG9yLGJvcmRlcldpZHRoOjIsfV19LG9wdGlvbnM6e2xlZ2VuZDp7ZGlzcGxheTpmYWxzZX0sc2NhbGVzOnt5QXhlczpbe2Rpc3BsYXk6ZmFsc2V9XSx4QXhlczpbe2Rpc3BsYXk6ZmFsc2V9XX0sbWFpbnRhaW5Bc3BlY3RSYXRpbzpmYWxzZSxlbGVtZW50czp7bGluZTp7dGVuc2lvbjowLjAwMDAwMX19LHRvb2x0aXBzOntpbnRlcnNlY3Q6ZmFsc2UscG9zaXRpb246J25lYXJlc3QnLGNhcmV0U2l6ZTowLH0sfSx9O30sX2dldEJhckNoYXJ0Q29uZmlnOmZ1bmN0aW9uKCl7dmFyIGRhdGE9W107dmFyIGxhYmVscz1bXTt2YXIgYmFja2dyb3VuZENvbG9yPVtdO3RoaXMuZGF0YVswXS52YWx1ZXMuZm9yRWFjaChmdW5jdGlvbihwdCl7ZGF0YS5wdXNoKHB0LnZhbHVlKTtsYWJlbHMucHVzaChwdC5sYWJlbCk7dmFyIGNvbG9yPXB0LnR5cGU9PT0ncGFzdCc/JyNjY2JkYzgnOihwdC50eXBlPT09J2Z1dHVyZSc/JyNhNWQ4ZDcnOicjZWJlYmViJyk7YmFja2dyb3VuZENvbG9yLnB1c2goY29sb3IpO30pO3JldHVybnt0eXBlOidiYXInLGRhdGE6e2xhYmVsczpsYWJlbHMsZGF0YXNldHM6W3tkYXRhOmRhdGEsZmlsbDonc3RhcnQnLGxhYmVsOnRoaXMuZGF0YVswXS5rZXksYmFja2dyb3VuZENvbG9yOmJhY2tncm91bmRDb2xvcix9XX0sb3B0aW9uczp7bGVnZW5kOntkaXNwbGF5OmZhbHNlfSxzY2FsZXM6e3lBeGVzOlt7ZGlzcGxheTpmYWxzZX1dLH0sbWFpbnRhaW5Bc3BlY3RSYXRpbzpmYWxzZSx0b29sdGlwczp7aW50ZXJzZWN0OmZhbHNlLHBvc2l0aW9uOiduZWFyZXN0JyxjYXJldFNpemU6MCx9LGVsZW1lbnRzOntsaW5lOnt0ZW5zaW9uOjAuMDAwMDAxfX0sfSx9O30sfSk7dmFyIEZpZWxkRG9tYWluPUFic3RyYWN0RmllbGQuZXh0ZW5kKHtzcGVjaWFsRGF0YToiX2ZldGNoU3BlY2lhbERvbWFpbiIsZXZlbnRzOl8uZXh0ZW5kKHt9LEFic3RyYWN0RmllbGQucHJvdG90eXBlLmV2ZW50cyx7ImNsaWNrIC5vX2RvbWFpbl9zaG93X3NlbGVjdGlvbl9idXR0b24iOiJfb25TaG93U2VsZWN0aW9uQnV0dG9uQ2xpY2siLCJjbGljayAub19maWVsZF9kb21haW5fZGlhbG9nX2J1dHRvbiI6Il9vbkRpYWxvZ0VkaXRCdXR0b25DbGljayIsfSksY3VzdG9tX2V2ZW50czpfLmV4dGVuZCh7fSxBYnN0cmFjdEZpZWxkLnByb3RvdHlwZS5jdXN0b21fZXZlbnRzLHtkb21haW5fY2hhbmdlZDoiX29uRG9tYWluU2VsZWN0b3JWYWx1ZUNoYW5nZSIsZG9tYWluX3NlbGVjdGVkOiJfb25Eb21haW5TZWxlY3RvckRpYWxvZ1ZhbHVlQ2hhbmdlIixvcGVuX3JlY29yZDoiX29uT3BlblJlY29yZCIsfSksaW5pdDpmdW5jdGlvbigpe3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLmluRGlhbG9nPSEhdGhpcy5ub2RlT3B0aW9ucy5pbl9kaWFsb2c7dGhpcy5mc0ZpbHRlcnM9dGhpcy5ub2RlT3B0aW9ucy5mc19maWx0ZXJzfHx7fTt0aGlzLmNsYXNzTmFtZT0ib19maWVsZF9kb21haW4iO2lmKHRoaXMubW9kZT09PSJlZGl0Iil7dGhpcy5jbGFzc05hbWUrPSIgb19lZGl0X21vZGUiO30KaWYoIXRoaXMuaW5EaWFsb2cpe3RoaXMuY2xhc3NOYW1lKz0iIG9faW5saW5lX21vZGUiO30KdGhpcy5fc2V0U3RhdGUoKTt9LGlzU2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRydWU7fSxpc1ZhbGlkOmZ1bmN0aW9uKCl7cmV0dXJuKHRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKSYmKCF0aGlzLmRvbWFpblNlbGVjdG9yfHx0aGlzLmRvbWFpblNlbGVjdG9yLmlzVmFsaWQoKSkmJnRoaXMuX2lzVmFsaWRGb3JNb2RlbCk7fSxfcmVuZGVyOmZ1bmN0aW9uKCl7aWYoIXRoaXMuX2RvbWFpbk1vZGVsKXt0aGlzLl9yZXBsYWNlQ29udGVudCgpO3JldHVybiBQcm9taXNlLnJlc29sdmUoKTt9CnZhciB2YWx1ZT10aGlzLnZhbHVlfHwiW10iO3ZhciBkZWY7aWYoIXRoaXMuZG9tYWluU2VsZWN0b3Ipe3RoaXMuZG9tYWluU2VsZWN0b3I9bmV3IERvbWFpblNlbGVjdG9yKHRoaXMsdGhpcy5fZG9tYWluTW9kZWwsdmFsdWUse3JlYWRvbmx5OnRoaXMubW9kZT09PSJyZWFkb25seSJ8fHRoaXMuaW5EaWFsb2csZmlsdGVyczp0aGlzLmZzRmlsdGVycyxkZWJ1Z01vZGU6Y29uZmlnLmlzRGVidWcoKSx9KTtkZWY9dGhpcy5kb21haW5TZWxlY3Rvci5wcmVwZW5kVG8odGhpcy4kZWwpO31lbHNle2RlZj10aGlzLmRvbWFpblNlbGVjdG9yLnNldERvbWFpbih2YWx1ZSk7fQpyZXR1cm4gZGVmLnRoZW4odGhpcy5fcmVwbGFjZUNvbnRlbnQuYmluZCh0aGlzKSk7fSxfcmVwbGFjZUNvbnRlbnQ6ZnVuY3Rpb24oKXtpZih0aGlzLl8kY29udGVudCl7dGhpcy5fJGNvbnRlbnQucmVtb3ZlKCk7fQp0aGlzLl8kY29udGVudD0kKHF3ZWIucmVuZGVyKCJGaWVsZERvbWFpbi5jb250ZW50Iix7aGFzTW9kZWw6ISF0aGlzLl9kb21haW5Nb2RlbCxpc1ZhbGlkOiEhdGhpcy5faXNWYWxpZEZvck1vZGVsLG5iUmVjb3Jkczp0aGlzLnJlY29yZC5zcGVjaWFsRGF0YVt0aGlzLm5hbWVdLm5iUmVjb3Jkc3x8MCxpbkRpYWxvZ0VkaXQ6dGhpcy5pbkRpYWxvZyYmdGhpcy5tb2RlPT09ImVkaXQiLH0pKTt0aGlzLl8kY29udGVudC5hcHBlbmRUbyh0aGlzLiRlbCk7fSxfcmVzZXQ6ZnVuY3Rpb24oKXt0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dmFyIG9sZERvbWFpbk1vZGVsPXRoaXMuX2RvbWFpbk1vZGVsO3RoaXMuX3NldFN0YXRlKCk7aWYodGhpcy5kb21haW5TZWxlY3RvciYmdGhpcy5fZG9tYWluTW9kZWwhPT1vbGREb21haW5Nb2RlbCl7dGhpcy5kb21haW5TZWxlY3Rvci5kZXN0cm95KCk7dGhpcy5kb21haW5TZWxlY3Rvcj1udWxsO319LF9zZXRTdGF0ZTpmdW5jdGlvbigpe3ZhciBzcGVjaWFsRGF0YT10aGlzLnJlY29yZC5zcGVjaWFsRGF0YVt0aGlzLm5hbWVdO3RoaXMuX2RvbWFpbk1vZGVsPXNwZWNpYWxEYXRhLm1vZGVsO3RoaXMuX2lzVmFsaWRGb3JNb2RlbD0oc3BlY2lhbERhdGEubmJSZWNvcmRzIT09ZmFsc2UpO30sX29uU2hvd1NlbGVjdGlvbkJ1dHRvbkNsaWNrOmZ1bmN0aW9uKGUpe2UucHJldmVudERlZmF1bHQoKTtuZXcgdmlld19kaWFsb2dzLlNlbGVjdENyZWF0ZURpYWxvZyh0aGlzLHt0aXRsZTpfdCgiU2VsZWN0ZWQgcmVjb3JkcyIpLHJlc19tb2RlbDp0aGlzLl9kb21haW5Nb2RlbCxjb250ZXh0OnRoaXMucmVjb3JkLmdldENvbnRleHQoe2ZpZWxkTmFtZTp0aGlzLm5hbWUsdmlld1R5cGU6dGhpcy52aWV3VHlwZX0pLGRvbWFpbjp0aGlzLnZhbHVlfHwiW10iLG5vX2NyZWF0ZTp0cnVlLHJlYWRvbmx5OnRydWUsZGlzYWJsZV9tdWx0aXBsZV9zZWxlY3Rpb246dHJ1ZSx9KS5vcGVuKCk7fSxfb25EaWFsb2dFZGl0QnV0dG9uQ2xpY2s6ZnVuY3Rpb24oZSl7ZS5wcmV2ZW50RGVmYXVsdCgpO25ldyBEb21haW5TZWxlY3RvckRpYWxvZyh0aGlzLHRoaXMuX2RvbWFpbk1vZGVsLHRoaXMudmFsdWV8fCJbXSIse3JlYWRvbmx5OnRoaXMubW9kZT09PSJyZWFkb25seSIsZmlsdGVyczp0aGlzLmZzRmlsdGVycyxkZWJ1Z01vZGU6Y29uZmlnLmlzRGVidWcoKSx9KS5vcGVuKCk7fSxfb25Eb21haW5TZWxlY3RvclZhbHVlQ2hhbmdlOmZ1bmN0aW9uKGUpe2lmKHRoaXMuaW5EaWFsb2cpcmV0dXJuO3RoaXMuX3NldFZhbHVlKERvbWFpbi5wcm90b3R5cGUuYXJyYXlUb1N0cmluZyh0aGlzLmRvbWFpblNlbGVjdG9yLmdldERvbWFpbigpKSk7fSxfb25Eb21haW5TZWxlY3RvckRpYWxvZ1ZhbHVlQ2hhbmdlOmZ1bmN0aW9uKGUpe3RoaXMuX3NldFZhbHVlKERvbWFpbi5wcm90b3R5cGUuYXJyYXlUb1N0cmluZyhlLmRhdGEuZG9tYWluKSk7fSxfb25PcGVuUmVjb3JkOmZ1bmN0aW9uKGV2ZW50KXtldmVudC5zdG9wUHJvcGFnYXRpb24oKTt9LH0pO3ZhciBBY2VFZGl0b3I9RGVib3VuY2VkRmllbGQuZXh0ZW5kKHt0ZW1wbGF0ZToiQWNlRWRpdG9yIixqc0xpYnM6Wycvd2ViL3N0YXRpYy9saWIvYWNlL2FjZS5qcycsWycvd2ViL3N0YXRpYy9saWIvYWNlL21vZGUtcHl0aG9uLmpzJywnL3dlYi9zdGF0aWMvbGliL2FjZS9tb2RlLXhtbC5qcyddXSxldmVudHM6e30sc3RhcnQ6ZnVuY3Rpb24oKXt0aGlzLl9zdGFydEFjZSh0aGlzLiQoJy5hY2Utdmlldy1lZGl0b3InKVswXSk7cmV0dXJuIHRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9LGRlc3Ryb3k6ZnVuY3Rpb24oKXtpZih0aGlzLmFjZUVkaXRvcil7dGhpcy5hY2VFZGl0b3IuZGVzdHJveSgpO30KdGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO30sX2Zvcm1hdFZhbHVlOmZ1bmN0aW9uKHZhbHVlKXtyZXR1cm4gdGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpfHwnJzt9LF9nZXRWYWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLmFjZVNlc3Npb24uZ2V0VmFsdWUoKTt9LF9yZW5kZXI6ZnVuY3Rpb24oKXt2YXIgbmV3VmFsdWU9dGhpcy5fZm9ybWF0VmFsdWUodGhpcy52YWx1ZSk7aWYodGhpcy5hY2VTZXNzaW9uLmdldFZhbHVlKCkhPT1uZXdWYWx1ZSl7dGhpcy5hY2VTZXNzaW9uLnNldFZhbHVlKG5ld1ZhbHVlKTt9fSxfc3RhcnRBY2U6ZnVuY3Rpb24obm9kZSl7dGhpcy5hY2VFZGl0b3I9YWNlLmVkaXQobm9kZSk7dGhpcy5hY2VFZGl0b3Iuc2V0T3B0aW9ucyh7bWF4TGluZXM6SW5maW5pdHksc2hvd1ByaW50TWFyZ2luOmZhbHNlLH0pO2lmKHRoaXMubW9kZT09PSdyZWFkb25seScpe3RoaXMuYWNlRWRpdG9yLnJlbmRlcmVyLnNldE9wdGlvbnMoe2Rpc3BsYXlJbmRlbnRHdWlkZXM6ZmFsc2Usc2hvd0d1dHRlcjpmYWxzZSx9KTt0aGlzLmFjZUVkaXRvci5zZXRPcHRpb25zKHtoaWdobGlnaHRBY3RpdmVMaW5lOmZhbHNlLGhpZ2hsaWdodEd1dHRlckxpbmU6ZmFsc2UscmVhZE9ubHk6dHJ1ZSx9KTt0aGlzLmFjZUVkaXRvci5yZW5kZXJlci4kY3Vyc29yTGF5ZXIuZWxlbWVudC5zdHlsZS5kaXNwbGF5PSJub25lIjt9CnRoaXMuYWNlRWRpdG9yLiRibG9ja1Njcm9sbGluZz10cnVlO3RoaXMuYWNlU2Vzc2lvbj10aGlzLmFjZUVkaXRvci5nZXRTZXNzaW9uKCk7dGhpcy5hY2VTZXNzaW9uLnNldE9wdGlvbnMoe3VzZVdvcmtlcjpmYWxzZSxtb2RlOiJhY2UvbW9kZS8iKyh0aGlzLm5vZGVPcHRpb25zLm1vZGV8fCd4bWwnKSx0YWJTaXplOjIsdXNlU29mdFRhYnM6dHJ1ZSx9KTtpZih0aGlzLm1vZGU9PT0iZWRpdCIpe3RoaXMuYWNlRWRpdG9yLm9uKCJjaGFuZ2UiLHRoaXMuX2RvRGVib3VuY2VkQWN0aW9uLmJpbmQodGhpcykpO3RoaXMuYWNlRWRpdG9yLm9uKCJibHVyIix0aGlzLl9kb0FjdGlvbi5iaW5kKHRoaXMpKTt9fSx9KTt2YXIgRmllbGRDb2xvcj1BYnN0cmFjdEZpZWxkLmV4dGVuZCh7dGVtcGxhdGU6J0ZpZWxkQ29sb3InLGV2ZW50czpfLmV4dGVuZCh7fSxBYnN0cmFjdEZpZWxkLnByb3RvdHlwZS5ldmVudHMseydjbGljayAub19maWVsZF9jb2xvcic6J19vbkNvbG9yQ2xpY2snLH0pLGN1c3RvbV9ldmVudHM6Xy5leHRlbmQoe30sQWJzdHJhY3RGaWVsZC5wcm90b3R5cGUuY3VzdG9tX2V2ZW50cyx7J2NvbG9ycGlja2VyOnNhdmVkJzonX29uQ29sb3JwaWNrZXJTYXZlZCcsfSksZ2V0Rm9jdXNhYmxlRWxlbWVudDpmdW5jdGlvbigpe3JldHVybiB0aGlzLiQoJy5vX2ZpZWxkX2NvbG9yJyk7fSxfcmVuZGVyOmZ1bmN0aW9uKCl7dGhpcy4kKCcub19maWVsZF9jb2xvcicpLmRhdGEoJ3ZhbHVlJyx0aGlzLnZhbHVlKS5jc3MoJ2JhY2tncm91bmQtY29sb3InLHRoaXMudmFsdWUpLmF0dHIoJ3RpdGxlJyx0aGlzLnZhbHVlKTtyZXR1cm4gdGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO30sX29uQ29sb3JDbGljazpmdW5jdGlvbigpe2lmKHRoaXMubW9kZT09PSdlZGl0Jyl7Y29uc3QgZGlhbG9nPW5ldyBDb2xvcnBpY2tlckRpYWxvZyh0aGlzLHtkZWZhdWx0Q29sb3I6dGhpcy52YWx1ZSxub1RyYW5zcGFyZW5jeTp0cnVlLH0pLm9wZW4oKTtkaWFsb2cub24oJ2Nsb3NlZCcsdGhpcywoKT0+e1Byb21pc2UucmVzb2x2ZSgpLnRoZW4oKCk9Pnt0aGlzLmdldEZvY3VzYWJsZUVsZW1lbnQoKS5mb2N1cygpO30pO30pO319LF9vbkNvbG9ycGlja2VyU2F2ZWQ6ZnVuY3Rpb24oZXYpe3RoaXMuX3NldFZhbHVlKGV2LmRhdGEuaGV4KTt9LF9vbktleWRvd246ZnVuY3Rpb24oZXYpe2lmKGV2LndoaWNoPT09JC51aS5rZXlDb2RlLkVOVEVSKXtldi5wcmV2ZW50RGVmYXVsdCgpO2V2LnN0b3BQcm9wYWdhdGlvbigpO3RoaXMuX29uQ29sb3JDbGljayhldik7fWVsc2V7dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO319LH0pO3JldHVybntUcmFuc2xhdGFibGVGaWVsZE1peGluOlRyYW5zbGF0YWJsZUZpZWxkTWl4aW4sRGVib3VuY2VkRmllbGQ6RGVib3VuY2VkRmllbGQsRmllbGRFbWFpbDpGaWVsZEVtYWlsLEZpZWxkQmluYXJ5RmlsZTpGaWVsZEJpbmFyeUZpbGUsRmllbGRQZGZWaWV3ZXI6RmllbGRQZGZWaWV3ZXIsQWJzdHJhY3RGaWVsZEJpbmFyeTpBYnN0cmFjdEZpZWxkQmluYXJ5LEZpZWxkQmluYXJ5SW1hZ2U6RmllbGRCaW5hcnlJbWFnZSxLYW5iYW5GaWVsZEJpbmFyeUltYWdlOkthbmJhbkZpZWxkQmluYXJ5SW1hZ2UsRmllbGRCb29sZWFuOkZpZWxkQm9vbGVhbixCb29sZWFuVG9nZ2xlOkJvb2xlYW5Ub2dnbGUsRmllbGRDaGFyOkZpZWxkQ2hhcixMaW5rQnV0dG9uOkxpbmtCdXR0b24sRmllbGREYXRlOkZpZWxkRGF0ZSxGaWVsZERhdGVUaW1lOkZpZWxkRGF0ZVRpbWUsRmllbGREYXRlUmFuZ2U6RmllbGREYXRlUmFuZ2UsRmllbGREb21haW46RmllbGREb21haW4sRmllbGRGbG9hdDpGaWVsZEZsb2F0LEZpZWxkRmxvYXRUaW1lOkZpZWxkRmxvYXRUaW1lLEZpZWxkRmxvYXRGYWN0b3I6RmllbGRGbG9hdEZhY3RvcixGaWVsZEZsb2F0VG9nZ2xlOkZpZWxkRmxvYXRUb2dnbGUsRmllbGRQZXJjZW50YWdlOkZpZWxkUGVyY2VudGFnZSxGaWVsZEludGVnZXI6RmllbGRJbnRlZ2VyLEZpZWxkTW9uZXRhcnk6RmllbGRNb25ldGFyeSxGaWVsZFBlcmNlbnRQaWU6RmllbGRQZXJjZW50UGllLEZpZWxkUGhvbmU6RmllbGRQaG9uZSxGaWVsZFByb2dyZXNzQmFyOkZpZWxkUHJvZ3Jlc3NCYXIsRmllbGRUZXh0OkZpZWxkVGV4dCxMaXN0RmllbGRUZXh0Okxpc3RGaWVsZFRleHQsRmllbGRUb2dnbGVCb29sZWFuOkZpZWxkVG9nZ2xlQm9vbGVhbixIYW5kbGVXaWRnZXQ6SGFuZGxlV2lkZ2V0LElucHV0RmllbGQ6SW5wdXRGaWVsZCxOdW1lcmljRmllbGQ6TnVtZXJpY0ZpZWxkLEF0dGFjaG1lbnRJbWFnZTpBdHRhY2htZW50SW1hZ2UsTGFiZWxTZWxlY3Rpb246TGFiZWxTZWxlY3Rpb24sU3RhdGVTZWxlY3Rpb25XaWRnZXQ6U3RhdGVTZWxlY3Rpb25XaWRnZXQsRmF2b3JpdGVXaWRnZXQ6RmF2b3JpdGVXaWRnZXQsUHJpb3JpdHlXaWRnZXQ6UHJpb3JpdHlXaWRnZXQsU3RhdEluZm86U3RhdEluZm8sVXJsV2lkZ2V0OlVybFdpZGdldCxUZXh0Q29weUNsaXBib2FyZDpUZXh0Q29weUNsaXBib2FyZCxDaGFyQ29weUNsaXBib2FyZDpDaGFyQ29weUNsaXBib2FyZCxKb3VybmFsRGFzaGJvYXJkR3JhcGg6Sm91cm5hbERhc2hib2FyZEdyYXBoLEFjZUVkaXRvcjpBY2VFZGl0b3IsRmllbGRDb2xvcjpGaWVsZENvbG9yLH07fSk7OwoKLyogL3dlYi9zdGF0aWMvc3JjL2pzL2ZpZWxkcy9maWVsZF9yZWdpc3RyeS5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwpvZG9vLmRlZmluZSgnd2ViLmZpZWxkX3JlZ2lzdHJ5JyxmdW5jdGlvbihyZXF1aXJlKXsidXNlIHN0cmljdCI7dmFyIFJlZ2lzdHJ5PXJlcXVpcmUoJ3dlYi5SZWdpc3RyeScpO3JldHVybiBuZXcgUmVnaXN0cnkoKTt9KTtvZG9vLmRlZmluZSgnd2ViLl9maWVsZF9yZWdpc3RyeScsZnVuY3Rpb24ocmVxdWlyZSl7InVzZSBzdHJpY3QiO3ZhciBBYnN0cmFjdEZpZWxkPXJlcXVpcmUoJ3dlYi5BYnN0cmFjdEZpZWxkJyk7dmFyIGJhc2ljX2ZpZWxkcz1yZXF1aXJlKCd3ZWIuYmFzaWNfZmllbGRzJyk7dmFyIHJlbGF0aW9uYWxfZmllbGRzPXJlcXVpcmUoJ3dlYi5yZWxhdGlvbmFsX2ZpZWxkcycpO3ZhciByZWdpc3RyeT1yZXF1aXJlKCd3ZWIuZmllbGRfcmVnaXN0cnknKTt2YXIgc3BlY2lhbF9maWVsZHM9cmVxdWlyZSgnd2ViLnNwZWNpYWxfZmllbGRzJyk7cmVnaXN0cnkuYWRkKCdhYnN0cmFjdCcsQWJzdHJhY3RGaWVsZCkuYWRkKCdpbnB1dCcsYmFzaWNfZmllbGRzLklucHV0RmllbGQpLmFkZCgnaW50ZWdlcicsYmFzaWNfZmllbGRzLkZpZWxkSW50ZWdlcikuYWRkKCdib29sZWFuJyxiYXNpY19maWVsZHMuRmllbGRCb29sZWFuKS5hZGQoJ2RhdGUnLGJhc2ljX2ZpZWxkcy5GaWVsZERhdGUpLmFkZCgnZGF0ZXRpbWUnLGJhc2ljX2ZpZWxkcy5GaWVsZERhdGVUaW1lKS5hZGQoJ2RhdGVyYW5nZScsYmFzaWNfZmllbGRzLkZpZWxkRGF0ZVJhbmdlKS5hZGQoJ2RvbWFpbicsYmFzaWNfZmllbGRzLkZpZWxkRG9tYWluKS5hZGQoJ3RleHQnLGJhc2ljX2ZpZWxkcy5GaWVsZFRleHQpLmFkZCgnbGlzdC50ZXh0JyxiYXNpY19maWVsZHMuTGlzdEZpZWxkVGV4dCkuYWRkKCdodG1sJyxiYXNpY19maWVsZHMuRmllbGRUZXh0KS5hZGQoJ2Zsb2F0JyxiYXNpY19maWVsZHMuRmllbGRGbG9hdCkuYWRkKCdjaGFyJyxiYXNpY19maWVsZHMuRmllbGRDaGFyKS5hZGQoJ2xpbmtfYnV0dG9uJyxiYXNpY19maWVsZHMuTGlua0J1dHRvbikuYWRkKCdoYW5kbGUnLGJhc2ljX2ZpZWxkcy5IYW5kbGVXaWRnZXQpLmFkZCgnZW1haWwnLGJhc2ljX2ZpZWxkcy5GaWVsZEVtYWlsKS5hZGQoJ3Bob25lJyxiYXNpY19maWVsZHMuRmllbGRQaG9uZSkuYWRkKCd1cmwnLGJhc2ljX2ZpZWxkcy5VcmxXaWRnZXQpLmFkZCgnQ29weUNsaXBib2FyZFRleHQnLGJhc2ljX2ZpZWxkcy5UZXh0Q29weUNsaXBib2FyZCkuYWRkKCdDb3B5Q2xpcGJvYXJkQ2hhcicsYmFzaWNfZmllbGRzLkNoYXJDb3B5Q2xpcGJvYXJkKS5hZGQoJ2ltYWdlJyxiYXNpY19maWVsZHMuRmllbGRCaW5hcnlJbWFnZSkuYWRkKCdrYW5iYW4uaW1hZ2UnLGJhc2ljX2ZpZWxkcy5LYW5iYW5GaWVsZEJpbmFyeUltYWdlKS5hZGQoJ2JpbmFyeScsYmFzaWNfZmllbGRzLkZpZWxkQmluYXJ5RmlsZSkuYWRkKCdwZGZfdmlld2VyJyxiYXNpY19maWVsZHMuRmllbGRQZGZWaWV3ZXIpLmFkZCgnbW9uZXRhcnknLGJhc2ljX2ZpZWxkcy5GaWVsZE1vbmV0YXJ5KS5hZGQoJ3BlcmNlbnRhZ2UnLGJhc2ljX2ZpZWxkcy5GaWVsZFBlcmNlbnRhZ2UpLmFkZCgncHJpb3JpdHknLGJhc2ljX2ZpZWxkcy5Qcmlvcml0eVdpZGdldCkuYWRkKCdhdHRhY2htZW50X2ltYWdlJyxiYXNpY19maWVsZHMuQXR0YWNobWVudEltYWdlKS5hZGQoJ2xhYmVsX3NlbGVjdGlvbicsYmFzaWNfZmllbGRzLkxhYmVsU2VsZWN0aW9uKS5hZGQoJ2thbmJhbl9sYWJlbF9zZWxlY3Rpb24nLGJhc2ljX2ZpZWxkcy5MYWJlbFNlbGVjdGlvbikuYWRkKCdzdGF0ZV9zZWxlY3Rpb24nLGJhc2ljX2ZpZWxkcy5TdGF0ZVNlbGVjdGlvbldpZGdldCkuYWRkKCdrYW5iYW5fc3RhdGVfc2VsZWN0aW9uJyxiYXNpY19maWVsZHMuU3RhdGVTZWxlY3Rpb25XaWRnZXQpLmFkZCgnYm9vbGVhbl9mYXZvcml0ZScsYmFzaWNfZmllbGRzLkZhdm9yaXRlV2lkZ2V0KS5hZGQoJ2Jvb2xlYW5fdG9nZ2xlJyxiYXNpY19maWVsZHMuQm9vbGVhblRvZ2dsZSkuYWRkKCdzdGF0aW5mbycsYmFzaWNfZmllbGRzLlN0YXRJbmZvKS5hZGQoJ3BlcmNlbnRwaWUnLGJhc2ljX2ZpZWxkcy5GaWVsZFBlcmNlbnRQaWUpLmFkZCgnZmxvYXRfdGltZScsYmFzaWNfZmllbGRzLkZpZWxkRmxvYXRUaW1lKS5hZGQoJ2Zsb2F0X2ZhY3RvcicsYmFzaWNfZmllbGRzLkZpZWxkRmxvYXRGYWN0b3IpLmFkZCgnZmxvYXRfdG9nZ2xlJyxiYXNpY19maWVsZHMuRmllbGRGbG9hdFRvZ2dsZSkuYWRkKCdwcm9ncmVzc2JhcicsYmFzaWNfZmllbGRzLkZpZWxkUHJvZ3Jlc3NCYXIpLmFkZCgndG9nZ2xlX2J1dHRvbicsYmFzaWNfZmllbGRzLkZpZWxkVG9nZ2xlQm9vbGVhbikuYWRkKCdkYXNoYm9hcmRfZ3JhcGgnLGJhc2ljX2ZpZWxkcy5Kb3VybmFsRGFzaGJvYXJkR3JhcGgpLmFkZCgnYWNlJyxiYXNpY19maWVsZHMuQWNlRWRpdG9yKS5hZGQoJ2NvbG9yJyxiYXNpY19maWVsZHMuRmllbGRDb2xvcik7cmVnaXN0cnkuYWRkKCdzZWxlY3Rpb24nLHJlbGF0aW9uYWxfZmllbGRzLkZpZWxkU2VsZWN0aW9uKS5hZGQoJ3JhZGlvJyxyZWxhdGlvbmFsX2ZpZWxkcy5GaWVsZFJhZGlvKS5hZGQoJ3NlbGVjdGlvbl9iYWRnZScscmVsYXRpb25hbF9maWVsZHMuRmllbGRTZWxlY3Rpb25CYWRnZSkuYWRkKCdtYW55Mm9uZScscmVsYXRpb25hbF9maWVsZHMuRmllbGRNYW55Mk9uZSkuYWRkKCdtYW55Mm9uZV9iYXJjb2RlJyxyZWxhdGlvbmFsX2ZpZWxkcy5NYW55Mm9uZUJhcmNvZGUpLmFkZCgnbGlzdC5tYW55Mm9uZScscmVsYXRpb25hbF9maWVsZHMuTGlzdEZpZWxkTWFueTJPbmUpLmFkZCgna2FuYmFuLm1hbnkyb25lJyxyZWxhdGlvbmFsX2ZpZWxkcy5LYW5iYW5GaWVsZE1hbnkyT25lKS5hZGQoJ21hbnkybWFueScscmVsYXRpb25hbF9maWVsZHMuRmllbGRNYW55Mk1hbnkpLmFkZCgnbWFueTJtYW55X2JpbmFyeScscmVsYXRpb25hbF9maWVsZHMuRmllbGRNYW55Mk1hbnlCaW5hcnlNdWx0aUZpbGVzKS5hZGQoJ21hbnkybWFueV90YWdzJyxyZWxhdGlvbmFsX2ZpZWxkcy5GaWVsZE1hbnkyTWFueVRhZ3MpLmFkZCgnbWFueTJtYW55X3RhZ3NfYXZhdGFyJyxyZWxhdGlvbmFsX2ZpZWxkcy5GaWVsZE1hbnkyTWFueVRhZ3NBdmF0YXIpLmFkZCgnZm9ybS5tYW55Mm1hbnlfdGFncycscmVsYXRpb25hbF9maWVsZHMuRm9ybUZpZWxkTWFueTJNYW55VGFncykuYWRkKCdrYW5iYW4ubWFueTJtYW55X3RhZ3MnLHJlbGF0aW9uYWxfZmllbGRzLkthbmJhbkZpZWxkTWFueTJNYW55VGFncykuYWRkKCdtYW55Mm1hbnlfY2hlY2tib3hlcycscmVsYXRpb25hbF9maWVsZHMuRmllbGRNYW55Mk1hbnlDaGVja0JveGVzKS5hZGQoJ29uZTJtYW55JyxyZWxhdGlvbmFsX2ZpZWxkcy5GaWVsZE9uZTJNYW55KS5hZGQoJ3N0YXR1c2JhcicscmVsYXRpb25hbF9maWVsZHMuRmllbGRTdGF0dXMpLmFkZCgncmVmZXJlbmNlJyxyZWxhdGlvbmFsX2ZpZWxkcy5GaWVsZFJlZmVyZW5jZSkuYWRkKCdmb250JyxyZWxhdGlvbmFsX2ZpZWxkcy5GaWVsZFNlbGVjdGlvbkZvbnQpO3JlZ2lzdHJ5LmFkZCgndGltZXpvbmVfbWlzbWF0Y2gnLHNwZWNpYWxfZmllbGRzLkZpZWxkVGltZXpvbmVNaXNtYXRjaCkuYWRkKCdyZXBvcnRfbGF5b3V0JyxzcGVjaWFsX2ZpZWxkcy5GaWVsZFJlcG9ydExheW91dCk7fSk7OwoKLyogL3dlYi9zdGF0aWMvc3JjL2pzL3ZpZXdzL2Jhc2ljL3dpZGdldF9yZWdpc3RyeS5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwpvZG9vLmRlZmluZSgnd2ViLndpZGdldF9yZWdpc3RyeScsZnVuY3Rpb24ocmVxdWlyZSl7InVzZSBzdHJpY3QiO3ZhciBSZWdpc3RyeT1yZXF1aXJlKCd3ZWIuUmVnaXN0cnknKTtyZXR1cm4gbmV3IFJlZ2lzdHJ5KCk7fSk7OwoKLyogL3dlYi9zdGF0aWMvc3JjL2pzL2ZpZWxkcy9maWVsZF91dGlscy5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwpvZG9vLmRlZmluZSgnd2ViLmZpZWxkX3V0aWxzJyxmdW5jdGlvbihyZXF1aXJlKXsidXNlIHN0cmljdCI7dmFyIGNvcmU9cmVxdWlyZSgnd2ViLmNvcmUnKTt2YXIgZG9tPXJlcXVpcmUoJ3dlYi5kb20nKTt2YXIgc2Vzc2lvbj1yZXF1aXJlKCd3ZWIuc2Vzc2lvbicpO3ZhciB0aW1lPXJlcXVpcmUoJ3dlYi50aW1lJyk7dmFyIHV0aWxzPXJlcXVpcmUoJ3dlYi51dGlscycpO3ZhciBfdD1jb3JlLl90O2Z1bmN0aW9uIGZvcm1hdEJpbmFyeSh2YWx1ZSxmaWVsZCxvcHRpb25zKXtpZighdmFsdWUpe3JldHVybicnO30KcmV0dXJuIHV0aWxzLmJpbmFyeVRvQmluc2l6ZSh2YWx1ZSk7fQpmdW5jdGlvbiBmb3JtYXRCb29sZWFuKHZhbHVlLGZpZWxkLG9wdGlvbnMpe2lmKG9wdGlvbnMmJm9wdGlvbnMuZm9yY2VTdHJpbmcpe3JldHVybiB2YWx1ZT9fdCgnVHJ1ZScpOl90KCdGYWxzZScpO30KcmV0dXJuIGRvbS5yZW5kZXJDaGVja2JveCh7cHJvcDp7Y2hlY2tlZDp2YWx1ZSxkaXNhYmxlZDp0cnVlLH0sfSk7fQpmdW5jdGlvbiBmb3JtYXRDaGFyKHZhbHVlLGZpZWxkLG9wdGlvbnMpe3ZhbHVlPXR5cGVvZiB2YWx1ZT09PSdzdHJpbmcnP3ZhbHVlOicnO2lmKG9wdGlvbnMmJm9wdGlvbnMuaXNQYXNzd29yZCl7cmV0dXJuIF8uc3RyLnJlcGVhdCgnKicsdmFsdWU/dmFsdWUubGVuZ3RoOjApO30KaWYob3B0aW9ucyYmb3B0aW9ucy5lc2NhcGUpe3ZhbHVlPV8uZXNjYXBlKHZhbHVlKTt9CnJldHVybiB2YWx1ZTt9CmZ1bmN0aW9uIGZvcm1hdERhdGUodmFsdWUsZmllbGQsb3B0aW9ucyl7aWYodmFsdWU9PT1mYWxzZXx8aXNOYU4odmFsdWUpKXtyZXR1cm4iIjt9CmlmKGZpZWxkJiZmaWVsZC50eXBlPT09J2RhdGV0aW1lJyl7aWYoIW9wdGlvbnN8fCEoJ3RpbWV6b25lJ2luIG9wdGlvbnMpfHxvcHRpb25zLnRpbWV6b25lKXt2YWx1ZT12YWx1ZS5jbG9uZSgpLmFkZChzZXNzaW9uLmdldFRaT2Zmc2V0KHZhbHVlKSwnbWludXRlcycpO319CnZhciBkYXRlX2Zvcm1hdD10aW1lLmdldExhbmdEYXRlRm9ybWF0KCk7cmV0dXJuIHZhbHVlLmZvcm1hdChkYXRlX2Zvcm1hdCk7fQpmdW5jdGlvbiBmb3JtYXREYXRlVGltZSh2YWx1ZSxmaWVsZCxvcHRpb25zKXtpZih2YWx1ZT09PWZhbHNlKXtyZXR1cm4iIjt9CmlmKCFvcHRpb25zfHwhKCd0aW1lem9uZSdpbiBvcHRpb25zKXx8b3B0aW9ucy50aW1lem9uZSl7dmFsdWU9dmFsdWUuY2xvbmUoKS5hZGQoc2Vzc2lvbi5nZXRUWk9mZnNldCh2YWx1ZSksJ21pbnV0ZXMnKTt9CnJldHVybiB2YWx1ZS5mb3JtYXQodGltZS5nZXRMYW5nRGF0ZXRpbWVGb3JtYXQoKSk7fQpmdW5jdGlvbiBmb3JtYXRGbG9hdCh2YWx1ZSxmaWVsZCxvcHRpb25zKXtvcHRpb25zPW9wdGlvbnN8fHt9O2lmKHZhbHVlPT09ZmFsc2Upe3JldHVybiIiO30KaWYob3B0aW9ucy5odW1hblJlYWRhYmxlJiZvcHRpb25zLmh1bWFuUmVhZGFibGUodmFsdWUpKXtyZXR1cm4gdXRpbHMuaHVtYW5fbnVtYmVyKHZhbHVlLG9wdGlvbnMuZGVjaW1hbHMsb3B0aW9ucy5taW5EaWdpdHMsb3B0aW9ucy5mb3JtYXR0ZXJDYWxsYmFjayk7fQp2YXIgbDEwbj1jb3JlLl90LmRhdGFiYXNlLnBhcmFtZXRlcnM7dmFyIHByZWNpc2lvbjtpZihvcHRpb25zLmRpZ2l0cyl7cHJlY2lzaW9uPW9wdGlvbnMuZGlnaXRzWzFdO31lbHNlIGlmKGZpZWxkJiZmaWVsZC5kaWdpdHMpe3ByZWNpc2lvbj1maWVsZC5kaWdpdHNbMV07fWVsc2V7cHJlY2lzaW9uPTI7fQp2YXIgZm9ybWF0dGVkPV8uc3RyLnNwcmludGYoJyUuJytwcmVjaXNpb24rJ2YnLHZhbHVlfHwwKS5zcGxpdCgnLicpO2Zvcm1hdHRlZFswXT11dGlscy5pbnNlcnRfdGhvdXNhbmRfc2Vwcyhmb3JtYXR0ZWRbMF0pO3JldHVybiBmb3JtYXR0ZWQuam9pbihsMTBuLmRlY2ltYWxfcG9pbnQpO30KZnVuY3Rpb24gZm9ybWF0RmxvYXRGYWN0b3IodmFsdWUsZmllbGQsb3B0aW9ucyl7dmFyIGZhY3Rvcj1vcHRpb25zLmZhY3Rvcnx8MTtyZXR1cm4gZm9ybWF0RmxvYXQodmFsdWUqZmFjdG9yLGZpZWxkLG9wdGlvbnMpO30KZnVuY3Rpb24gZm9ybWF0RmxvYXRUaW1lKHZhbHVlKXt2YXIgcGF0dGVybj0nJTAyZDolMDJkJztpZih2YWx1ZTwwKXt2YWx1ZT1NYXRoLmFicyh2YWx1ZSk7cGF0dGVybj0nLScrcGF0dGVybjt9CnZhciBob3VyPU1hdGguZmxvb3IodmFsdWUpO3ZhciBtaW49TWF0aC5yb3VuZCgodmFsdWUlMSkqNjApO2lmKG1pbj09PTYwKXttaW49MDtob3VyPWhvdXIrMTt9CnJldHVybiBfLnN0ci5zcHJpbnRmKHBhdHRlcm4saG91cixtaW4pO30KZnVuY3Rpb24gZm9ybWF0SW50ZWdlcih2YWx1ZSxmaWVsZCxvcHRpb25zKXtvcHRpb25zPW9wdGlvbnN8fHt9O2lmKG9wdGlvbnMuaXNQYXNzd29yZCl7cmV0dXJuIF8uc3RyLnJlcGVhdCgnKicsU3RyaW5nKHZhbHVlKS5sZW5ndGgpO30KaWYoIXZhbHVlJiZ2YWx1ZSE9PTApe3JldHVybiIiO30KaWYob3B0aW9ucy5odW1hblJlYWRhYmxlJiZvcHRpb25zLmh1bWFuUmVhZGFibGUodmFsdWUpKXtyZXR1cm4gdXRpbHMuaHVtYW5fbnVtYmVyKHZhbHVlLG9wdGlvbnMuZGVjaW1hbHMsb3B0aW9ucy5taW5EaWdpdHMsb3B0aW9ucy5mb3JtYXR0ZXJDYWxsYmFjayk7fQpyZXR1cm4gdXRpbHMuaW5zZXJ0X3Rob3VzYW5kX3NlcHMoXy5zdHIuc3ByaW50ZignJWQnLHZhbHVlKSk7fQpmdW5jdGlvbiBmb3JtYXRNYW55Mm9uZSh2YWx1ZSxmaWVsZCxvcHRpb25zKXt2YWx1ZT12YWx1ZSYmKF8uaXNBcnJheSh2YWx1ZSk/dmFsdWVbMV06dmFsdWUuZGF0YS5kaXNwbGF5X25hbWUpfHwnJztpZihvcHRpb25zJiZvcHRpb25zLmVzY2FwZSl7dmFsdWU9Xy5lc2NhcGUodmFsdWUpO30KcmV0dXJuIHZhbHVlO30KZnVuY3Rpb24gZm9ybWF0WDJNYW55KHZhbHVlKXtpZih2YWx1ZS5kYXRhLmxlbmd0aD09PTApe3JldHVybiBfdCgnTm8gcmVjb3JkcycpO31lbHNlIGlmKHZhbHVlLmRhdGEubGVuZ3RoPT09MSl7cmV0dXJuIF90KCcxIHJlY29yZCcpO31lbHNle3JldHVybiB2YWx1ZS5kYXRhLmxlbmd0aCtfdCgnIHJlY29yZHMnKTt9fQpmdW5jdGlvbiBmb3JtYXRNb25ldGFyeSh2YWx1ZSxmaWVsZCxvcHRpb25zKXtpZih2YWx1ZT09PWZhbHNlKXtyZXR1cm4iIjt9Cm9wdGlvbnM9b3B0aW9uc3x8e307dmFyIGN1cnJlbmN5PW9wdGlvbnMuY3VycmVuY3k7aWYoIWN1cnJlbmN5KXt2YXIgY3VycmVuY3lfaWQ9b3B0aW9ucy5jdXJyZW5jeV9pZDtpZighY3VycmVuY3lfaWQmJm9wdGlvbnMuZGF0YSl7dmFyIGN1cnJlbmN5X2ZpZWxkPW9wdGlvbnMuY3VycmVuY3lfZmllbGR8fGZpZWxkLmN1cnJlbmN5X2ZpZWxkfHwnY3VycmVuY3lfaWQnO2N1cnJlbmN5X2lkPW9wdGlvbnMuZGF0YVtjdXJyZW5jeV9maWVsZF0mJm9wdGlvbnMuZGF0YVtjdXJyZW5jeV9maWVsZF0ucmVzX2lkO30KY3VycmVuY3k9c2Vzc2lvbi5nZXRfY3VycmVuY3koY3VycmVuY3lfaWQpO30KdmFyIGRpZ2l0cz0oY3VycmVuY3kmJmN1cnJlbmN5LmRpZ2l0cyl8fG9wdGlvbnMuZGlnaXRzO2lmKG9wdGlvbnMuZmllbGRfZGlnaXRzPT09dHJ1ZSl7ZGlnaXRzPWZpZWxkLmRpZ2l0c3x8ZGlnaXRzO30KdmFyIGZvcm1hdHRlZF92YWx1ZT1mb3JtYXRGbG9hdCh2YWx1ZSxmaWVsZCxfLmV4dGVuZCh7fSxvcHRpb25zLHtkaWdpdHM6ZGlnaXRzfSkpO2lmKCFjdXJyZW5jeXx8b3B0aW9ucy5ub1N5bWJvbCl7cmV0dXJuIGZvcm1hdHRlZF92YWx1ZTt9CmlmKGN1cnJlbmN5LnBvc2l0aW9uPT09ImFmdGVyIil7cmV0dXJuIGZvcm1hdHRlZF92YWx1ZSs9JyZuYnNwOycrY3VycmVuY3kuc3ltYm9sO31lbHNle3JldHVybiBjdXJyZW5jeS5zeW1ib2wrJyZuYnNwOycrZm9ybWF0dGVkX3ZhbHVlO319CmZ1bmN0aW9uIGZvcm1hdFBlcmNlbnRhZ2UodmFsdWUsZmllbGQsb3B0aW9ucyl7b3B0aW9ucz1vcHRpb25zfHx7fTt2YXIgcmVzdWx0PWZvcm1hdEZsb2F0KHZhbHVlKjEwMCxmaWVsZCxvcHRpb25zKXx8JzAnO2lmKG9wdGlvbnMuaHVtYW5SZWFkYWJsZSYmb3B0aW9ucy5odW1hblJlYWRhYmxlKHZhbHVlKjEwMCkpe3JldHVybiByZXN1bHQrIiUiO30KcmV0dXJuKHBhcnNlRmxvYXQocmVzdWx0KSsiJSIpLnJlcGxhY2UoJy4nLF90LmRhdGFiYXNlLnBhcmFtZXRlcnMuZGVjaW1hbF9wb2ludCk7fQpmdW5jdGlvbiBmb3JtYXRTZWxlY3Rpb24odmFsdWUsZmllbGQsb3B0aW9ucyl7dmFyIHZhbD1fLmZpbmQoZmllbGQuc2VsZWN0aW9uLGZ1bmN0aW9uKG9wdGlvbil7cmV0dXJuIG9wdGlvblswXT09PXZhbHVlO30pO2lmKCF2YWwpe3JldHVybicnO30KdmFsdWU9dmFsWzFdO2lmKG9wdGlvbnMmJm9wdGlvbnMuZXNjYXBlKXt2YWx1ZT1fLmVzY2FwZSh2YWx1ZSk7fQpyZXR1cm4gdmFsdWU7fQpmdW5jdGlvbiBwYXJzZURhdGUodmFsdWUsZmllbGQsb3B0aW9ucyl7aWYoIXZhbHVlKXtyZXR1cm4gZmFsc2U7fQp2YXIgZGF0ZVBhdHRlcm49dGltZS5nZXRMYW5nRGF0ZUZvcm1hdCgpO3ZhciBkYXRlUGF0dGVybldvWmVybz1kYXRlUGF0dGVybi5yZXBsYWNlKCdNTScsJ00nKS5yZXBsYWNlKCdERCcsJ0QnKTt2YXIgZGF0ZTtpZihvcHRpb25zJiZvcHRpb25zLmlzVVRDKXtkYXRlPW1vbWVudC51dGModmFsdWUpO31lbHNle2RhdGU9bW9tZW50LnV0Yyh2YWx1ZSxbZGF0ZVBhdHRlcm4sZGF0ZVBhdHRlcm5Xb1plcm8sbW9tZW50LklTT184NjAxXSk7fQppZihkYXRlLmlzVmFsaWQoKSl7aWYoZGF0ZS55ZWFyKCk9PT0wKXtkYXRlLnllYXIobW9tZW50LnV0YygpLnllYXIoKSk7fQppZihkYXRlLnllYXIoKT49MTkwMCl7ZGF0ZS50b0pTT049ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jbG9uZSgpLmxvY2FsZSgnZW4nKS5mb3JtYXQoJ1lZWVktTU0tREQnKTt9O3JldHVybiBkYXRlO319CnRocm93IG5ldyBFcnJvcihfLnN0ci5zcHJpbnRmKGNvcmUuX3QoIiclcycgaXMgbm90IGEgY29ycmVjdCBkYXRlIiksdmFsdWUpKTt9CmZ1bmN0aW9uIHBhcnNlRGF0ZVRpbWUodmFsdWUsZmllbGQsb3B0aW9ucyl7aWYoIXZhbHVlKXtyZXR1cm4gZmFsc2U7fQp2YXIgZGF0ZVBhdHRlcm49dGltZS5nZXRMYW5nRGF0ZUZvcm1hdCgpLHRpbWVQYXR0ZXJuPXRpbWUuZ2V0TGFuZ1RpbWVGb3JtYXQoKTt2YXIgZGF0ZVBhdHRlcm5Xb1plcm89ZGF0ZVBhdHRlcm4ucmVwbGFjZSgnTU0nLCdNJykucmVwbGFjZSgnREQnLCdEJyksdGltZVBhdHRlcm5Xb1plcm89dGltZVBhdHRlcm4ucmVwbGFjZSgnSEgnLCdIJykucmVwbGFjZSgnbW0nLCdtJykucmVwbGFjZSgnc3MnLCdzJyk7dmFyIHBhdHRlcm4xPWRhdGVQYXR0ZXJuKycgJyt0aW1lUGF0dGVybjt2YXIgcGF0dGVybjI9ZGF0ZVBhdHRlcm5Xb1plcm8rJyAnK3RpbWVQYXR0ZXJuV29aZXJvO3ZhciBkYXRldGltZTtpZihvcHRpb25zJiZvcHRpb25zLmlzVVRDKXtkYXRldGltZT1tb21lbnQudXRjKHZhbHVlLnJlcGxhY2UoJyAnLCdUJykrJ1onKTt9ZWxzZXtkYXRldGltZT1tb21lbnQudXRjKHZhbHVlLFtwYXR0ZXJuMSxwYXR0ZXJuMixtb21lbnQuSVNPXzg2MDFdKTtpZihvcHRpb25zJiZvcHRpb25zLnRpbWV6b25lKXtkYXRldGltZS5hZGQoLXNlc3Npb24uZ2V0VFpPZmZzZXQoZGF0ZXRpbWUpLCdtaW51dGVzJyk7fX0KaWYoZGF0ZXRpbWUuaXNWYWxpZCgpKXtpZihkYXRldGltZS55ZWFyKCk9PT0wKXtkYXRldGltZS55ZWFyKG1vbWVudC51dGMoKS55ZWFyKCkpO30KaWYoZGF0ZXRpbWUueWVhcigpPj0xOTAwKXtkYXRldGltZS50b0pTT049ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jbG9uZSgpLmxvY2FsZSgnZW4nKS5mb3JtYXQoJ1lZWVktTU0tREQgSEg6bW06c3MnKTt9O3JldHVybiBkYXRldGltZTt9fQp0aHJvdyBuZXcgRXJyb3IoXy5zdHIuc3ByaW50Zihjb3JlLl90KCInJXMnIGlzIG5vdCBhIGNvcnJlY3QgZGF0ZXRpbWUiKSx2YWx1ZSkpO30KZnVuY3Rpb24gcGFyc2VOdW1iZXIodmFsdWUpe2lmKGNvcmUuX3QuZGF0YWJhc2UucGFyYW1ldGVycy50aG91c2FuZHNfc2VwKXt2YXIgZXNjYXBlZFNlcD1fLnN0ci5lc2NhcGVSZWdFeHAoY29yZS5fdC5kYXRhYmFzZS5wYXJhbWV0ZXJzLnRob3VzYW5kc19zZXApO3ZhbHVlPXZhbHVlLnJlcGxhY2UobmV3IFJlZ0V4cChlc2NhcGVkU2VwLCdnJyksJycpO30KaWYoY29yZS5fdC5kYXRhYmFzZS5wYXJhbWV0ZXJzLmRlY2ltYWxfcG9pbnQpe3ZhbHVlPXZhbHVlLnJlcGxhY2UoY29yZS5fdC5kYXRhYmFzZS5wYXJhbWV0ZXJzLmRlY2ltYWxfcG9pbnQsJy4nKTt9CnJldHVybiBOdW1iZXIodmFsdWUpO30KZnVuY3Rpb24gcGFyc2VGbG9hdCh2YWx1ZSl7dmFyIHBhcnNlZD1wYXJzZU51bWJlcih2YWx1ZSk7aWYoaXNOYU4ocGFyc2VkKSl7dGhyb3cgbmV3IEVycm9yKF8uc3RyLnNwcmludGYoY29yZS5fdCgiJyVzJyBpcyBub3QgYSBjb3JyZWN0IGZsb2F0IiksdmFsdWUpKTt9CnJldHVybiBwYXJzZWQ7fQpmdW5jdGlvbiBwYXJzZU1vbmV0YXJ5KHZhbHVlLGZpZWxkLG9wdGlvbnMpe3ZhciB2YWx1ZXM9dmFsdWUuc3BsaXQoJyZuYnNwOycpO2lmKHZhbHVlcy5sZW5ndGg9PT0xKXtyZXR1cm4gcGFyc2VGbG9hdCh2YWx1ZSk7fQplbHNlIGlmKHZhbHVlcy5sZW5ndGghPT0yKXt0aHJvdyBuZXcgRXJyb3IoXy5zdHIuc3ByaW50Zihjb3JlLl90KCInJXMnIGlzIG5vdCBhIGNvcnJlY3QgbW9uZXRhcnkgZmllbGQiKSx2YWx1ZSkpO30Kb3B0aW9ucz1vcHRpb25zfHx7fTt2YXIgY3VycmVuY3k9b3B0aW9ucy5jdXJyZW5jeTtpZighY3VycmVuY3kpe3ZhciBjdXJyZW5jeV9pZD1vcHRpb25zLmN1cnJlbmN5X2lkO2lmKCFjdXJyZW5jeV9pZCYmb3B0aW9ucy5kYXRhKXt2YXIgY3VycmVuY3lfZmllbGQ9b3B0aW9ucy5jdXJyZW5jeV9maWVsZHx8ZmllbGQuY3VycmVuY3lfZmllbGR8fCdjdXJyZW5jeV9pZCc7Y3VycmVuY3lfaWQ9b3B0aW9ucy5kYXRhW2N1cnJlbmN5X2ZpZWxkXSYmb3B0aW9ucy5kYXRhW2N1cnJlbmN5X2ZpZWxkXS5yZXNfaWQ7fQpjdXJyZW5jeT1zZXNzaW9uLmdldF9jdXJyZW5jeShjdXJyZW5jeV9pZCk7fQpyZXR1cm4gcGFyc2VGbG9hdCh2YWx1ZXNbMF09PT1jdXJyZW5jeS5zeW1ib2w/dmFsdWVzWzFdOnZhbHVlc1swXSk7fQpmdW5jdGlvbiBwYXJzZUZsb2F0RmFjdG9yKHZhbHVlLGZpZWxkLG9wdGlvbnMpe3ZhciBwYXJzZWQ9cGFyc2VGbG9hdCh2YWx1ZSk7dmFyIGZhY3Rvcj1vcHRpb25zLmZhY3Rvcnx8MS4wO3JldHVybiBwYXJzZWQvZmFjdG9yO30KZnVuY3Rpb24gcGFyc2VGbG9hdFRpbWUodmFsdWUpe3ZhciBmYWN0b3I9MTtpZih2YWx1ZVswXT09PSctJyl7dmFsdWU9dmFsdWUuc2xpY2UoMSk7ZmFjdG9yPS0xO30KdmFyIGZsb2F0X3RpbWVfcGFpcj12YWx1ZS5zcGxpdCgiOiIpO2lmKGZsb2F0X3RpbWVfcGFpci5sZW5ndGghPT0yKQpyZXR1cm4gZmFjdG9yKnBhcnNlRmxvYXQodmFsdWUpO3ZhciBob3Vycz1wYXJzZUludGVnZXIoZmxvYXRfdGltZV9wYWlyWzBdKTt2YXIgbWludXRlcz1wYXJzZUludGVnZXIoZmxvYXRfdGltZV9wYWlyWzFdKTtyZXR1cm4gZmFjdG9yKihob3VycysobWludXRlcy82MCkpO30KZnVuY3Rpb24gcGFyc2VQZXJjZW50YWdlKHZhbHVlKXtpZih2YWx1ZS5zbGljZSgtMSk9PT0nJScpe3JldHVybiBwYXJzZUZsb2F0KHZhbHVlLnNsaWNlKDAsLTEpKS8xMDA7fQpyZXR1cm4gcGFyc2VGbG9hdCh2YWx1ZSk7fQpmdW5jdGlvbiBwYXJzZUludGVnZXIodmFsdWUpe3ZhciBwYXJzZWQ9cGFyc2VOdW1iZXIodmFsdWUpO2lmKGlzTmFOKHBhcnNlZCl8fHBhcnNlZCUxfHxwYXJzZWQ8LTIxNDc0ODM2NDh8fHBhcnNlZD4yMTQ3NDgzNjQ3KXt0aHJvdyBuZXcgRXJyb3IoXy5zdHIuc3ByaW50Zihjb3JlLl90KCInJXMnIGlzIG5vdCBhIGNvcnJlY3QgaW50ZWdlciIpLHZhbHVlKSk7fQpyZXR1cm4gcGFyc2VkO30KZnVuY3Rpb24gcGFyc2VNYW55Mm9uZSh2YWx1ZSl7aWYoXy5pc0FycmF5KHZhbHVlKSl7cmV0dXJue2lkOnZhbHVlWzBdLGRpc3BsYXlfbmFtZTp2YWx1ZVsxXSx9O30KaWYoXy5pc051bWJlcih2YWx1ZSl8fF8uaXNTdHJpbmcodmFsdWUpKXtyZXR1cm57aWQ6cGFyc2VJbnQodmFsdWUsMTApLH07fQpyZXR1cm4gdmFsdWU7fQpyZXR1cm57Zm9ybWF0OntiaW5hcnk6Zm9ybWF0QmluYXJ5LGJvb2xlYW46Zm9ybWF0Qm9vbGVhbixjaGFyOmZvcm1hdENoYXIsZGF0ZTpmb3JtYXREYXRlLGRhdGV0aW1lOmZvcm1hdERhdGVUaW1lLGZsb2F0OmZvcm1hdEZsb2F0LGZsb2F0X2ZhY3Rvcjpmb3JtYXRGbG9hdEZhY3RvcixmbG9hdF90aW1lOmZvcm1hdEZsb2F0VGltZSxodG1sOl8uaWRlbnRpdHksaW50ZWdlcjpmb3JtYXRJbnRlZ2VyLG1hbnkybWFueTpmb3JtYXRYMk1hbnksbWFueTJvbmU6Zm9ybWF0TWFueTJvbmUsbWFueTJvbmVfcmVmZXJlbmNlOmZvcm1hdEludGVnZXIsbW9uZXRhcnk6Zm9ybWF0TW9uZXRhcnksb25lMm1hbnk6Zm9ybWF0WDJNYW55LHBlcmNlbnRhZ2U6Zm9ybWF0UGVyY2VudGFnZSxyZWZlcmVuY2U6Zm9ybWF0TWFueTJvbmUsc2VsZWN0aW9uOmZvcm1hdFNlbGVjdGlvbix0ZXh0OmZvcm1hdENoYXIsfSxwYXJzZTp7YmluYXJ5Ol8uaWRlbnRpdHksYm9vbGVhbjpfLmlkZW50aXR5LGNoYXI6Xy5pZGVudGl0eSxkYXRlOnBhcnNlRGF0ZSxkYXRldGltZTpwYXJzZURhdGVUaW1lLGZsb2F0OnBhcnNlRmxvYXQsZmxvYXRfZmFjdG9yOnBhcnNlRmxvYXRGYWN0b3IsZmxvYXRfdGltZTpwYXJzZUZsb2F0VGltZSxodG1sOl8uaWRlbnRpdHksaW50ZWdlcjpwYXJzZUludGVnZXIsbWFueTJtYW55Ol8uaWRlbnRpdHksbWFueTJvbmU6cGFyc2VNYW55Mm9uZSxtb25ldGFyeTpwYXJzZU1vbmV0YXJ5LG9uZTJtYW55Ol8uaWRlbnRpdHkscGVyY2VudGFnZTpwYXJzZVBlcmNlbnRhZ2UscmVmZXJlbmNlOnBhcnNlTWFueTJvbmUsc2VsZWN0aW9uOl8uaWRlbnRpdHksdGV4dDpfLmlkZW50aXR5LH0sfTt9KTs7CgovKiAvd2ViL3N0YXRpYy9zcmMvanMvZmllbGRzL3JlbGF0aW9uYWxfZmllbGRzLmpzIGRlZmluZWQgaW4gYnVuZGxlICd3ZWIuYXNzZXRzX2JhY2tlbmQnICovCm9kb28uZGVmaW5lKCd3ZWIucmVsYXRpb25hbF9maWVsZHMnLGZ1bmN0aW9uKHJlcXVpcmUpeyJ1c2Ugc3RyaWN0Ijt2YXIgQWJzdHJhY3RGaWVsZD1yZXF1aXJlKCd3ZWIuQWJzdHJhY3RGaWVsZCcpO3ZhciBiYXNpY0ZpZWxkcz1yZXF1aXJlKCd3ZWIuYmFzaWNfZmllbGRzJyk7dmFyIGNvbmN1cnJlbmN5PXJlcXVpcmUoJ3dlYi5jb25jdXJyZW5jeScpO3ZhciBDb250cm9sUGFuZWxWaWV3PXJlcXVpcmUoJ3dlYi5Db250cm9sUGFuZWxWaWV3Jyk7dmFyIGNvcmU9cmVxdWlyZSgnd2ViLmNvcmUnKTt2YXIgZGF0YT1yZXF1aXJlKCd3ZWIuZGF0YScpO3ZhciBEaWFsb2c9cmVxdWlyZSgnd2ViLkRpYWxvZycpO3ZhciBkaWFsb2dzPXJlcXVpcmUoJ3dlYi52aWV3X2RpYWxvZ3MnKTt2YXIgZG9tPXJlcXVpcmUoJ3dlYi5kb20nKTt2YXIgS2FuYmFuUmVjb3JkPXJlcXVpcmUoJ3dlYi5LYW5iYW5SZWNvcmQnKTt2YXIgS2FuYmFuUmVuZGVyZXI9cmVxdWlyZSgnd2ViLkthbmJhblJlbmRlcmVyJyk7dmFyIExpc3RSZW5kZXJlcj1yZXF1aXJlKCd3ZWIuTGlzdFJlbmRlcmVyJyk7dmFyIFBhZ2VyPXJlcXVpcmUoJ3dlYi5QYWdlcicpO3ZhciBfdD1jb3JlLl90O3ZhciBfbHQ9Y29yZS5fbHQ7dmFyIHF3ZWI9Y29yZS5xd2ViO3ZhciBNMk9EaWFsb2c9RGlhbG9nLmV4dGVuZCh7dGVtcGxhdGU6Ik0yT0RpYWxvZyIsaW5pdDpmdW5jdGlvbihwYXJlbnQsbmFtZSx2YWx1ZSl7dGhpcy5uYW1lPW5hbWU7dGhpcy52YWx1ZT12YWx1ZTt0aGlzLl9zdXBlcihwYXJlbnQse3RpdGxlOl8uc3RyLnNwcmludGYoX3QoIkNyZWF0ZSBhICVzIiksdGhpcy5uYW1lKSxzaXplOidtZWRpdW0nLGJ1dHRvbnM6W3t0ZXh0Ol90KCdDcmVhdGUnKSxjbGFzc2VzOididG4tcHJpbWFyeScsY2xpY2s6ZnVuY3Rpb24oKXtpZih0aGlzLiQoImlucHV0IikudmFsKCkhPT0nJyl7dGhpcy50cmlnZ2VyX3VwKCdxdWlja19jcmVhdGUnLHt2YWx1ZTp0aGlzLiQoJ2lucHV0JykudmFsKCl9KTt0aGlzLmNsb3NlKHRydWUpO31lbHNle3RoaXMuJCgiaW5wdXQiKS5mb2N1cygpO319LH0se3RleHQ6X3QoJ0NyZWF0ZSBhbmQgZWRpdCcpLGNsYXNzZXM6J2J0bi1wcmltYXJ5JyxjbG9zZTp0cnVlLGNsaWNrOmZ1bmN0aW9uKCl7dGhpcy50cmlnZ2VyX3VwKCdzZWFyY2hfY3JlYXRlX3BvcHVwJyx7dmlld190eXBlOidmb3JtJyx2YWx1ZTp0aGlzLiQoJ2lucHV0JykudmFsKCksfSk7fSx9LHt0ZXh0Ol90KCdDYW5jZWwnKSxjbG9zZTp0cnVlLH1dLH0pO30sc3RhcnQ6ZnVuY3Rpb24oKXt0aGlzLiQoInAiKS50ZXh0KF8uc3RyLnNwcmludGYoX3QoIllvdSBhcmUgY3JlYXRpbmcgYSBuZXcgJXMsIGFyZSB5b3Ugc3VyZSBpdCBkb2VzIG5vdCBleGlzdCB5ZXQ/IiksdGhpcy5uYW1lKSk7dGhpcy4kKCJpbnB1dCIpLnZhbCh0aGlzLnZhbHVlKTt9LGNsb3NlOmZ1bmN0aW9uKGlzU2V0KXt0aGlzLmlzU2V0PWlzU2V0O3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9LGRlc3Ryb3k6ZnVuY3Rpb24oKXtpZighdGhpcy5pc1NldCl7dGhpcy50cmlnZ2VyX3VwKCdjbG9zZWRfdW5zZXQnKTt9CnRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9LH0pO3ZhciBGaWVsZE1hbnkyT25lPUFic3RyYWN0RmllbGQuZXh0ZW5kKHtkZXNjcmlwdGlvbjpfbHQoIk1hbnkyb25lIiksc3VwcG9ydGVkRmllbGRUeXBlczpbJ21hbnkyb25lJ10sdGVtcGxhdGU6J0ZpZWxkTWFueTJPbmUnLGN1c3RvbV9ldmVudHM6Xy5leHRlbmQoe30sQWJzdHJhY3RGaWVsZC5wcm90b3R5cGUuY3VzdG9tX2V2ZW50cyx7J2Nsb3NlZF91bnNldCc6J19vbkRpYWxvZ0Nsb3NlZFVuc2V0JywnZmllbGRfY2hhbmdlZCc6J19vbkZpZWxkQ2hhbmdlZCcsJ3F1aWNrX2NyZWF0ZSc6J19vblF1aWNrQ3JlYXRlJywnc2VhcmNoX2NyZWF0ZV9wb3B1cCc6J19vblNlYXJjaENyZWF0ZVBvcHVwJyx9KSxldmVudHM6Xy5leHRlbmQoe30sQWJzdHJhY3RGaWVsZC5wcm90b3R5cGUuZXZlbnRzLHsnY2xpY2sgaW5wdXQnOidfb25JbnB1dENsaWNrJywnZm9jdXNvdXQgaW5wdXQnOidfb25JbnB1dEZvY3Vzb3V0Jywna2V5dXAgaW5wdXQnOidfb25JbnB1dEtleXVwJywnY2xpY2sgLm9fZXh0ZXJuYWxfYnV0dG9uJzonX29uRXh0ZXJuYWxCdXR0b25DbGljaycsJ2NsaWNrJzonX29uQ2xpY2snLH0pLEFVVE9DT01QTEVURV9ERUxBWToyMDAsU0VBUkNIX01PUkVfTElNSVQ6MzIwLGluaXQ6ZnVuY3Rpb24ocGFyZW50LG5hbWUscmVjb3JkLG9wdGlvbnMpe3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLmxpbWl0PTc7dGhpcy5vcmRlcmVyPW5ldyBjb25jdXJyZW5jeS5Ecm9wTWlzb3JkZXJlZCgpO3RoaXMuY2FuX2NyZWF0ZT0oJ2Nhbl9jcmVhdGUnaW4gdGhpcy5hdHRycz9KU09OLnBhcnNlKHRoaXMuYXR0cnMuY2FuX2NyZWF0ZSk6dHJ1ZSkmJiF0aGlzLm5vZGVPcHRpb25zLm5vX2NyZWF0ZTt0aGlzLmNhbl93cml0ZT0nY2FuX3dyaXRlJ2luIHRoaXMuYXR0cnM/SlNPTi5wYXJzZSh0aGlzLmF0dHJzLmNhbl93cml0ZSk6dHJ1ZTt0aGlzLm5vZGVPcHRpb25zPV8uZGVmYXVsdHModGhpcy5ub2RlT3B0aW9ucyx7cXVpY2tfY3JlYXRlOnRydWUsfSk7dGhpcy5ub09wZW49J25vT3BlbidpbihvcHRpb25zfHx7fSk/b3B0aW9ucy5ub09wZW46dGhpcy5ub2RlT3B0aW9ucy5ub19vcGVuO3RoaXMubTJvX3ZhbHVlPXRoaXMuX2Zvcm1hdFZhbHVlKHRoaXMudmFsdWUpO3RoaXMucmVjb3JkUGFyYW1zPXtmaWVsZE5hbWU6dGhpcy5uYW1lLHZpZXdUeXBlOnRoaXMudmlld1R5cGV9O3RoaXMuaXNEaXJ0eT1mYWxzZTt0aGlzLmxhc3RDaGFuZ2VFdmVudD11bmRlZmluZWQ7dGhpcy5fYXV0b2NvbXBsZXRlU291cmNlcz1bXTt0aGlzLl9hZGRBdXRvY29tcGxldGVTb3VyY2UodGhpcy5fc2VhcmNoLHtwbGFjZWhvbGRlcjpfdCgnTG9hZGluZy4uLicpLG9yZGVyOjF9KTt0aGlzLmRwPW5ldyBjb25jdXJyZW5jeS5Ecm9wUHJldmlvdXMoKTt0aGlzLmNyZWF0ZURlZj11bmRlZmluZWQ7fSxzdGFydDpmdW5jdGlvbigpe3RoaXMuZmxvYXRpbmc9ZmFsc2U7dGhpcy4kaW5wdXQ9dGhpcy4kKCdpbnB1dCcpO3RoaXMuJGV4dGVybmFsX2J1dHRvbj10aGlzLiQoJy5vX2V4dGVybmFsX2J1dHRvbicpO3JldHVybiB0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fSxkZXN0cm95OmZ1bmN0aW9uKCl7aWYodGhpcy5fb25TY3JvbGwpe3dpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdzY3JvbGwnLHRoaXMuX29uU2Nyb2xsLHRydWUpO30KdGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO30sY29tbWl0Q2hhbmdlczpmdW5jdGlvbigpe3JldHVybiBQcm9taXNlLnJlc29sdmUodGhpcy5jcmVhdGVEZWYpO30sZ2V0Rm9jdXNhYmxlRWxlbWVudDpmdW5jdGlvbigpe3JldHVybiB0aGlzLm1vZGU9PT0nZWRpdCcmJnRoaXMuJGlucHV0fHx0aGlzLiRlbDt9LHJlaW5pdGlhbGl6ZTpmdW5jdGlvbih2YWx1ZSl7dGhpcy5pc0RpcnR5PWZhbHNlO3RoaXMuZmxvYXRpbmc9ZmFsc2U7cmV0dXJuIHRoaXMuX3NldFZhbHVlKHZhbHVlKTt9LHJlc2V0OmZ1bmN0aW9uKHJlY29yZCxldmVudCl7dGhpcy5fcmVzZXQocmVjb3JkLGV2ZW50KTtpZighZXZlbnR8fGV2ZW50PT09dGhpcy5sYXN0Q2hhbmdlRXZlbnQpe3RoaXMuaXNEaXJ0eT1mYWxzZTt9CmlmKHRoaXMuaXNEaXJ0eSl7cmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO31lbHNle3JldHVybiB0aGlzLl9yZW5kZXIoKTt9fSxfYWRkQXV0b2NvbXBsZXRlU291cmNlOmZ1bmN0aW9uKG1ldGhvZCxwYXJhbXMpe3RoaXMuX2F1dG9jb21wbGV0ZVNvdXJjZXMucHVzaCh7bWV0aG9kOm1ldGhvZCxwbGFjZWhvbGRlcjoocGFyYW1zLnBsYWNlaG9sZGVyP190KHBhcmFtcy5wbGFjZWhvbGRlcik6X3QoJ0xvYWRpbmcuLi4nKSkrJzxpIGNsYXNzPSJmYSBmYS1zcGlubmVyIGZhLXNwaW4gcHVsbC1yaWdodCI+PC9pPicsdmFsaWRhdGlvbjpwYXJhbXMudmFsaWRhdGlvbixsb2FkaW5nOmZhbHNlLG9yZGVyOnBhcmFtcy5vcmRlcnx8OTk5fSk7dGhpcy5fYXV0b2NvbXBsZXRlU291cmNlcz1fLnNvcnRCeSh0aGlzLl9hdXRvY29tcGxldGVTb3VyY2VzLCdvcmRlcicpO30sX2JpbmRBdXRvQ29tcGxldGU6ZnVuY3Rpb24oKXt2YXIgc2VsZj10aGlzO2lmKCQuYnJvd3Nlci5jaHJvbWUmJnRoaXMuJGlucHV0LmF0dHIoJ3BsYWNlaG9sZGVyJykpe3RoaXMuJGlucHV0LmF0dHIoJ3BsYWNlaG9sZGVyJyxmdW5jdGlvbihpbmRleCx2YWwpe3JldHVybiB2YWwuc3BsaXQoJycpLmpvaW4oJ1x1ZmVmZicpO30pO30KdGhpcy4kaW5wdXQuYXV0b2NvbXBsZXRlKHtzb3VyY2U6ZnVuY3Rpb24ocmVxLHJlc3Ape18uZWFjaChzZWxmLl9hdXRvY29tcGxldGVTb3VyY2VzLGZ1bmN0aW9uKHNvdXJjZSl7c291cmNlLnJlc3VsdHM9W107aWYoIXNvdXJjZS52YWxpZGF0aW9ufHxzb3VyY2UudmFsaWRhdGlvbi5jYWxsKHNlbGYscmVxLnRlcm0pKXtzb3VyY2UubG9hZGluZz10cnVlO1Byb21pc2UucmVzb2x2ZShzb3VyY2UubWV0aG9kLmNhbGwoc2VsZixyZXEudGVybSkpLnRoZW4oZnVuY3Rpb24ocmVzdWx0cyl7c291cmNlLnJlc3VsdHM9cmVzdWx0cztzb3VyY2UubG9hZGluZz1mYWxzZTtyZXNwKHNlbGYuX2NvbmNhdGVuYXRlQXV0b2NvbXBsZXRlUmVzdWx0cygpKTt9KTt9fSk7fSxzZWxlY3Q6ZnVuY3Rpb24oZXZlbnQsdWkpe2V2ZW50LnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO2V2ZW50LnByZXZlbnREZWZhdWx0KCk7dmFyIGl0ZW09dWkuaXRlbTtzZWxmLmZsb2F0aW5nPWZhbHNlO2lmKGl0ZW0uaWQpe3NlbGYucmVpbml0aWFsaXplKHtpZDppdGVtLmlkLGRpc3BsYXlfbmFtZTppdGVtLm5hbWV9KTt9ZWxzZSBpZihpdGVtLmFjdGlvbil7aXRlbS5hY3Rpb24oKTt9CnJldHVybiBmYWxzZTt9LGZvY3VzOmZ1bmN0aW9uKGV2ZW50KXtldmVudC5wcmV2ZW50RGVmYXVsdCgpO30sb3BlbjpmdW5jdGlvbihldmVudCl7c2VsZi5fb25TY3JvbGw9ZnVuY3Rpb24oZXYpe2lmKGV2LnRhcmdldCE9PXNlbGYuJGlucHV0LmdldCgwKSYmc2VsZi4kaW5wdXQuaGFzQ2xhc3MoJ3VpLWF1dG9jb21wbGV0ZS1pbnB1dCcpKXtzZWxmLiRpbnB1dC5hdXRvY29tcGxldGUoJ2Nsb3NlJyk7fX07d2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsc2VsZi5fb25TY3JvbGwsdHJ1ZSk7fSxjbG9zZTpmdW5jdGlvbihldmVudCl7aWYoZXZlbnQud2hpY2g9PT0kLnVpLmtleUNvZGUuRVNDQVBFKXtldmVudC5zdG9wUHJvcGFnYXRpb24oKTt9CmlmKHNlbGYuX29uU2Nyb2xsKXt3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignc2Nyb2xsJyxzZWxmLl9vblNjcm9sbCx0cnVlKTt9fSxhdXRvRm9jdXM6dHJ1ZSxodG1sOnRydWUsbWluTGVuZ3RoOjAsZGVsYXk6dGhpcy5BVVRPQ09NUExFVEVfREVMQVksfSk7dGhpcy4kaW5wdXQuYXV0b2NvbXBsZXRlKCJvcHRpb24iLCJwb3NpdGlvbiIse215OiJsZWZ0IHRvcCIsYXQ6ImxlZnQgYm90dG9tIn0pO3RoaXMuYXV0b2NvbXBsZXRlX2JvdW5kPXRydWU7fSxfY29uY2F0ZW5hdGVBdXRvY29tcGxldGVSZXN1bHRzOmZ1bmN0aW9uKCl7dmFyIHJlc3VsdHM9W107Xy5lYWNoKHRoaXMuX2F1dG9jb21wbGV0ZVNvdXJjZXMsZnVuY3Rpb24oc291cmNlKXtpZihzb3VyY2UucmVzdWx0cyYmc291cmNlLnJlc3VsdHMubGVuZ3RoKXtyZXN1bHRzPXJlc3VsdHMuY29uY2F0KHNvdXJjZS5yZXN1bHRzKTt9ZWxzZSBpZihzb3VyY2UubG9hZGluZyl7cmVzdWx0cy5wdXNoKHtsYWJlbDpzb3VyY2UucGxhY2Vob2xkZXJ9KTt9fSk7cmV0dXJuIHJlc3VsdHM7fSxfY3JlYXRlQ29udGV4dDpmdW5jdGlvbihuYW1lKXt2YXIgdG1wPXt9O3ZhciBmaWVsZD10aGlzLm5vZGVPcHRpb25zLmNyZWF0ZV9uYW1lX2ZpZWxkO2lmKGZpZWxkPT09dW5kZWZpbmVkKXtmaWVsZD0ibmFtZSI7fQppZihmaWVsZCE9PWZhbHNlJiZuYW1lJiZ0aGlzLm5vZGVPcHRpb25zLnF1aWNrX2NyZWF0ZSE9PWZhbHNlKXt0bXBbImRlZmF1bHRfIitmaWVsZF09bmFtZTt9CnJldHVybiB0bXA7fSxfZ2V0U2VhcmNoQmxhY2tsaXN0OmZ1bmN0aW9uKCl7cmV0dXJuW107fSxfZ2V0RGlzcGxheU5hbWU6ZnVuY3Rpb24odmFsdWUpe3JldHVybiB2YWx1ZS5zcGxpdCgnXG4nKVswXTt9LF9nZXRTZWFyY2hDcmVhdGVQb3B1cE9wdGlvbnM6ZnVuY3Rpb24odmlldyxpZHMsY29udGV4dCxkeW5hbWljRmlsdGVycyl7dmFyIHNlbGY9dGhpcztyZXR1cm57cmVzX21vZGVsOnRoaXMuZmllbGQucmVsYXRpb24sZG9tYWluOnRoaXMucmVjb3JkLmdldERvbWFpbih7ZmllbGROYW1lOnRoaXMubmFtZX0pLGNvbnRleHQ6Xy5leHRlbmQoe30sdGhpcy5yZWNvcmQuZ2V0Q29udGV4dCh0aGlzLnJlY29yZFBhcmFtcyksY29udGV4dHx8e30pLGR5bmFtaWNGaWx0ZXJzOmR5bmFtaWNGaWx0ZXJzfHxbXSx0aXRsZToodmlldz09PSdzZWFyY2gnP190KCJTZWFyY2g6ICIpOl90KCJDcmVhdGU6ICIpKSt0aGlzLnN0cmluZyxpbml0aWFsX2lkczppZHMsaW5pdGlhbF92aWV3OnZpZXcsZGlzYWJsZV9tdWx0aXBsZV9zZWxlY3Rpb246dHJ1ZSxub19jcmVhdGU6IXNlbGYuY2FuX2NyZWF0ZSxrYW5iYW5fdmlld19yZWY6dGhpcy5hdHRycy5rYW5iYW5fdmlld19yZWYsb25fc2VsZWN0ZWQ6ZnVuY3Rpb24ocmVjb3Jkcyl7c2VsZi5yZWluaXRpYWxpemUocmVjb3Jkc1swXSk7fSxvbl9jbG9zZWQ6ZnVuY3Rpb24oKXtzZWxmLmFjdGl2YXRlKCk7fSx9O30sX21hbmFnZVNlYXJjaE1vcmU6ZnVuY3Rpb24odmFsdWVzLHNlYXJjaF92YWwsZG9tYWluLGNvbnRleHQpe3ZhciBzZWxmPXRoaXM7dmFsdWVzPXZhbHVlcy5zbGljZSgwLHRoaXMubGltaXQpO3ZhbHVlcy5wdXNoKHtsYWJlbDpfdCgiU2VhcmNoIE1vcmUuLi4iKSxhY3Rpb246ZnVuY3Rpb24oKXt2YXIgcHJvbTtpZihzZWFyY2hfdmFsIT09Jycpe3Byb209c2VsZi5fcnBjKHttb2RlbDpzZWxmLmZpZWxkLnJlbGF0aW9uLG1ldGhvZDonbmFtZV9zZWFyY2gnLGt3YXJnczp7bmFtZTpzZWFyY2hfdmFsLGFyZ3M6ZG9tYWluLG9wZXJhdG9yOiJpbGlrZSIsbGltaXQ6c2VsZi5TRUFSQ0hfTU9SRV9MSU1JVCxjb250ZXh0OmNvbnRleHQsfSx9KTt9ClByb21pc2UucmVzb2x2ZShwcm9tKS50aGVuKGZ1bmN0aW9uKHJlc3VsdHMpe3ZhciBkeW5hbWljRmlsdGVycztpZihyZXN1bHRzKXt2YXIgaWRzPV8ubWFwKHJlc3VsdHMsZnVuY3Rpb24oeCl7cmV0dXJuIHhbMF07fSk7ZHluYW1pY0ZpbHRlcnM9W3tkZXNjcmlwdGlvbjpfLnN0ci5zcHJpbnRmKF90KCdRdWljayBzZWFyY2g6ICVzJyksc2VhcmNoX3ZhbCksZG9tYWluOltbJ2lkJywnaW4nLGlkc11dLH1dO30Kc2VsZi5fc2VhcmNoQ3JlYXRlUG9wdXAoInNlYXJjaCIsZmFsc2Use30sZHluYW1pY0ZpbHRlcnMpO30pO30sY2xhc3NuYW1lOidvX20yb19kcm9wZG93bl9vcHRpb24nLH0pO3JldHVybiB2YWx1ZXM7fSxfb25GaWVsZENoYW5nZWQ6ZnVuY3Rpb24oZXZlbnQpe3RoaXMubGFzdENoYW5nZUV2ZW50PWV2ZW50O30sX3F1aWNrQ3JlYXRlOmZ1bmN0aW9uKG5hbWUpe3ZhciBzZWxmPXRoaXM7dmFyIGNyZWF0ZURvbmU7dmFyIGRlZj1uZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLHJlamVjdCl7c2VsZi5jcmVhdGVEZWY9bmV3IFByb21pc2UoZnVuY3Rpb24oaW5uZXJSZXNvbHZlKXtjcmVhdGVEb25lPWZ1bmN0aW9uKCl7aW5uZXJSZXNvbHZlKCk7cmVzb2x2ZSgpO3NlbGYuY3JlYXRlRGVmPXVuZGVmaW5lZDt9O30pO3ZhciBzbG93Q3JlYXRlPWZ1bmN0aW9uKCl7dmFyIGRpYWxvZz1zZWxmLl9zZWFyY2hDcmVhdGVQb3B1cCgiZm9ybSIsZmFsc2Usc2VsZi5fY3JlYXRlQ29udGV4dChuYW1lKSk7ZGlhbG9nLm9uKCdjbG9zZWQnLHNlbGYsY3JlYXRlRG9uZSk7fTtpZihzZWxmLm5vZGVPcHRpb25zLnF1aWNrX2NyZWF0ZSl7dmFyIG5hbWVDcmVhdGVEZWY9c2VsZi5fcnBjKHttb2RlbDpzZWxmLmZpZWxkLnJlbGF0aW9uLG1ldGhvZDonbmFtZV9jcmVhdGUnLGFyZ3M6W25hbWVdLGNvbnRleHQ6c2VsZi5yZWNvcmQuZ2V0Q29udGV4dChzZWxmLnJlY29yZFBhcmFtcyksfSkuZ3VhcmRlZENhdGNoKGZ1bmN0aW9uKHJlYXNvbil7cmVhc29uLmV2ZW50LnByZXZlbnREZWZhdWx0KCk7c2xvd0NyZWF0ZSgpO30pO3NlbGYuZHAuYWRkKG5hbWVDcmVhdGVEZWYpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KXtpZihzZWxmLm1vZGU9PT0iZWRpdCIpe3NlbGYucmVpbml0aWFsaXplKHtpZDpyZXN1bHRbMF0sZGlzcGxheV9uYW1lOnJlc3VsdFsxXX0pO30KY3JlYXRlRG9uZSgpO30pLmd1YXJkZWRDYXRjaChyZWplY3QpO31lbHNle3Nsb3dDcmVhdGUoKTt9fSk7cmV0dXJuIGRlZjt9LF9yZW5kZXJFZGl0OmZ1bmN0aW9uKCl7dmFyIHZhbHVlPXRoaXMubTJvX3ZhbHVlO2lmKHRoaXMubm9kZU9wdGlvbnMuYWx3YXlzX3JlbG9hZCl7dmFsdWU9dGhpcy5fZ2V0RGlzcGxheU5hbWUodmFsdWUpO30KdGhpcy4kaW5wdXQudmFsKHZhbHVlKTtpZighdGhpcy5hdXRvY29tcGxldGVfYm91bmQpe3RoaXMuX2JpbmRBdXRvQ29tcGxldGUoKTt9CnRoaXMuX3VwZGF0ZUV4dGVybmFsQnV0dG9uKCk7fSxfcmVuZGVyUmVhZG9ubHk6ZnVuY3Rpb24oKXt2YXIgZXNjYXBlZFZhbHVlPV8uZXNjYXBlKCh0aGlzLm0yb192YWx1ZXx8IiIpLnRyaW0oKSk7dmFyIHZhbHVlPWVzY2FwZWRWYWx1ZS5zcGxpdCgnXG4nKS5tYXAoZnVuY3Rpb24obGluZSl7cmV0dXJuJzxzcGFuPicrbGluZSsnPC9zcGFuPic7fSkuam9pbignPGJyLz4nKTt0aGlzLiRlbC5odG1sKHZhbHVlKTtpZighdGhpcy5ub09wZW4mJnRoaXMudmFsdWUpe3RoaXMuJGVsLmF0dHIoJ2hyZWYnLF8uc3RyLnNwcmludGYoJyNpZD0lcyZtb2RlbD0lcycsdGhpcy52YWx1ZS5yZXNfaWQsdGhpcy5maWVsZC5yZWxhdGlvbikpO3RoaXMuJGVsLmFkZENsYXNzKCdvX2Zvcm1fdXJpJyk7fX0sX3Jlc2V0OmZ1bmN0aW9uKCl7dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3RoaXMuZmxvYXRpbmc9ZmFsc2U7dGhpcy5tMm9fdmFsdWU9dGhpcy5fZm9ybWF0VmFsdWUodGhpcy52YWx1ZSk7fSxfc2VhcmNoOmZ1bmN0aW9uKHNlYXJjaF92YWwpe3ZhciBzZWxmPXRoaXM7dmFyIGRlZj1uZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLHJlamVjdCl7dmFyIGNvbnRleHQ9c2VsZi5yZWNvcmQuZ2V0Q29udGV4dChzZWxmLnJlY29yZFBhcmFtcyk7dmFyIGRvbWFpbj1zZWxmLnJlY29yZC5nZXREb21haW4oc2VsZi5yZWNvcmRQYXJhbXMpO18uZXh0ZW5kKGNvbnRleHQsc2VsZi5hZGRpdGlvbmFsQ29udGV4dCk7dmFyIGJsYWNrbGlzdGVkX2lkcz1zZWxmLl9nZXRTZWFyY2hCbGFja2xpc3QoKTtpZihibGFja2xpc3RlZF9pZHMubGVuZ3RoPjApe2RvbWFpbi5wdXNoKFsnaWQnLCdub3QgaW4nLGJsYWNrbGlzdGVkX2lkc10pO30Kc2VsZi5fcnBjKHttb2RlbDpzZWxmLmZpZWxkLnJlbGF0aW9uLG1ldGhvZDoibmFtZV9zZWFyY2giLGt3YXJnczp7bmFtZTpzZWFyY2hfdmFsLGFyZ3M6ZG9tYWluLG9wZXJhdG9yOiJpbGlrZSIsbGltaXQ6c2VsZi5saW1pdCsxLGNvbnRleHQ6Y29udGV4dCx9fSkudGhlbihmdW5jdGlvbihyZXN1bHQpe3ZhciB2YWx1ZXM9Xy5tYXAocmVzdWx0LGZ1bmN0aW9uKHgpe3hbMV09c2VsZi5fZ2V0RGlzcGxheU5hbWUoeFsxXSk7cmV0dXJue2xhYmVsOl8uc3RyLmVzY2FwZUhUTUwoeFsxXS50cmltKCkpfHxkYXRhLm5vRGlzcGxheUNvbnRlbnQsdmFsdWU6eFsxXSxuYW1lOnhbMV0saWQ6eFswXSx9O30pO2lmKHZhbHVlcy5sZW5ndGg+c2VsZi5saW1pdCl7dmFsdWVzPXNlbGYuX21hbmFnZVNlYXJjaE1vcmUodmFsdWVzLHNlYXJjaF92YWwsZG9tYWluLGNvbnRleHQpO30KdmFyIGNyZWF0ZV9lbmFibGVkPXNlbGYuY2FuX2NyZWF0ZSYmIXNlbGYubm9kZU9wdGlvbnMubm9fY3JlYXRlO3ZhciByYXdfcmVzdWx0PV8ubWFwKHJlc3VsdCxmdW5jdGlvbih4KXtyZXR1cm4geFsxXTt9KTtpZihjcmVhdGVfZW5hYmxlZCYmIXNlbGYubm9kZU9wdGlvbnMubm9fcXVpY2tfY3JlYXRlJiZzZWFyY2hfdmFsLmxlbmd0aD4wJiYhXy5jb250YWlucyhyYXdfcmVzdWx0LHNlYXJjaF92YWwpKXt2YWx1ZXMucHVzaCh7bGFiZWw6Xy5zdHIuc3ByaW50ZihfdCgnQ3JlYXRlICI8c3Ryb25nPiVzPC9zdHJvbmc+IicpLCQoJzxzcGFuIC8+JykudGV4dChzZWFyY2hfdmFsKS5odG1sKCkpLGFjdGlvbjpzZWxmLl9xdWlja0NyZWF0ZS5iaW5kKHNlbGYsc2VhcmNoX3ZhbCksY2xhc3NuYW1lOidvX20yb19kcm9wZG93bl9vcHRpb24nfSk7fQppZihjcmVhdGVfZW5hYmxlZCYmIXNlbGYubm9kZU9wdGlvbnMubm9fY3JlYXRlX2VkaXQpe3ZhciBjcmVhdGVBbmRFZGl0QWN0aW9uPWZ1bmN0aW9uKCl7c2VsZi4kKCdpbnB1dCcpLnZhbCgnJyk7cmV0dXJuIHNlbGYuX3NlYXJjaENyZWF0ZVBvcHVwKCJmb3JtIixmYWxzZSxzZWxmLl9jcmVhdGVDb250ZXh0KHNlYXJjaF92YWwpKTt9O3ZhbHVlcy5wdXNoKHtsYWJlbDpfdCgiQ3JlYXRlIGFuZCBFZGl0Li4uIiksYWN0aW9uOmNyZWF0ZUFuZEVkaXRBY3Rpb24sY2xhc3NuYW1lOidvX20yb19kcm9wZG93bl9vcHRpb24nLH0pO31lbHNlIGlmKHZhbHVlcy5sZW5ndGg9PT0wKXt2YWx1ZXMucHVzaCh7bGFiZWw6X3QoIk5vIHJlc3VsdHMgdG8gc2hvdy4uLiIpLH0pO30KcmVzb2x2ZSh2YWx1ZXMpO30pO30pO3RoaXMub3JkZXJlci5hZGQoZGVmKTtyZXR1cm4gZGVmO30sX3NlYXJjaENyZWF0ZVBvcHVwOmZ1bmN0aW9uKHZpZXcsaWRzLGNvbnRleHQsZHluYW1pY0ZpbHRlcnMpe3ZhciBvcHRpb25zPXRoaXMuX2dldFNlYXJjaENyZWF0ZVBvcHVwT3B0aW9ucyh2aWV3LGlkcyxjb250ZXh0LGR5bmFtaWNGaWx0ZXJzKTtyZXR1cm4gbmV3IGRpYWxvZ3MuU2VsZWN0Q3JlYXRlRGlhbG9nKHRoaXMsXy5leHRlbmQoe30sdGhpcy5ub2RlT3B0aW9ucyxvcHRpb25zKSkub3BlbigpO30sX3VwZGF0ZUV4dGVybmFsQnV0dG9uOmZ1bmN0aW9uKCl7dmFyIGhhc19leHRlcm5hbF9idXR0b249IXRoaXMubm9PcGVuJiYhdGhpcy5mbG9hdGluZyYmdGhpcy5pc1NldCgpO3RoaXMuJGV4dGVybmFsX2J1dHRvbi50b2dnbGUoaGFzX2V4dGVybmFsX2J1dHRvbik7dGhpcy4kZWwudG9nZ2xlQ2xhc3MoJ29fd2l0aF9idXR0b24nLGhhc19leHRlcm5hbF9idXR0b24pO30sX29uQ2xpY2s6ZnVuY3Rpb24oZXZlbnQpe3ZhciBzZWxmPXRoaXM7aWYodGhpcy5tb2RlPT09J3JlYWRvbmx5JyYmIXRoaXMubm9PcGVuKXtldmVudC5wcmV2ZW50RGVmYXVsdCgpO2V2ZW50LnN0b3BQcm9wYWdhdGlvbigpO3RoaXMuX3JwYyh7bW9kZWw6dGhpcy5maWVsZC5yZWxhdGlvbixtZXRob2Q6J2dldF9mb3Jtdmlld19hY3Rpb24nLGFyZ3M6W1t0aGlzLnZhbHVlLnJlc19pZF1dLGNvbnRleHQ6dGhpcy5yZWNvcmQuZ2V0Q29udGV4dCh0aGlzLnJlY29yZFBhcmFtcyksfSkudGhlbihmdW5jdGlvbihhY3Rpb24pe3NlbGYudHJpZ2dlcl91cCgnZG9fYWN0aW9uJyx7YWN0aW9uOmFjdGlvbn0pO30pO319LF9vbkRpYWxvZ0Nsb3NlZFVuc2V0OmZ1bmN0aW9uKCl7dGhpcy5pc0RpcnR5PWZhbHNlO3RoaXMuZmxvYXRpbmc9ZmFsc2U7dGhpcy5fcmVuZGVyKCk7fSxfb25FeHRlcm5hbEJ1dHRvbkNsaWNrOmZ1bmN0aW9uKCl7aWYoIXRoaXMudmFsdWUpe3RoaXMuYWN0aXZhdGUoKTtyZXR1cm47fQp2YXIgc2VsZj10aGlzO3ZhciBjb250ZXh0PXRoaXMucmVjb3JkLmdldENvbnRleHQodGhpcy5yZWNvcmRQYXJhbXMpO3RoaXMuX3JwYyh7bW9kZWw6dGhpcy5maWVsZC5yZWxhdGlvbixtZXRob2Q6J2dldF9mb3Jtdmlld19pZCcsYXJnczpbW3RoaXMudmFsdWUucmVzX2lkXV0sY29udGV4dDpjb250ZXh0LH0pLnRoZW4oZnVuY3Rpb24odmlld19pZCl7bmV3IGRpYWxvZ3MuRm9ybVZpZXdEaWFsb2coc2VsZix7cmVzX21vZGVsOnNlbGYuZmllbGQucmVsYXRpb24scmVzX2lkOnNlbGYudmFsdWUucmVzX2lkLGNvbnRleHQ6Y29udGV4dCx0aXRsZTpfdCgiT3BlbjogIikrc2VsZi5zdHJpbmcsdmlld19pZDp2aWV3X2lkLHJlYWRvbmx5OiFzZWxmLmNhbl93cml0ZSxvbl9zYXZlZDpmdW5jdGlvbihyZWNvcmQsY2hhbmdlZCl7aWYoY2hhbmdlZCl7Y29uc3QgX3NldFZhbHVlPXNlbGYuX3NldFZhbHVlLmJpbmQoc2VsZixzZWxmLnZhbHVlLmRhdGEse2ZvcmNlQ2hhbmdlOnRydWUsfSk7c2VsZi50cmlnZ2VyX3VwKCdyZWxvYWQnLHtkYl9pZDpzZWxmLnZhbHVlLmlkLG9uU3VjY2Vzczpfc2V0VmFsdWUsb25GYWlsdXJlOl9zZXRWYWx1ZSx9KTt9fSx9KS5vcGVuKCk7fSk7fSxfb25JbnB1dENsaWNrOmZ1bmN0aW9uKCl7aWYodGhpcy4kaW5wdXQuYXV0b2NvbXBsZXRlKCJ3aWRnZXQiKS5pcygiOnZpc2libGUiKSl7dGhpcy4kaW5wdXQuYXV0b2NvbXBsZXRlKCJjbG9zZSIpO31lbHNlIGlmKHRoaXMuZmxvYXRpbmcpe3RoaXMuJGlucHV0LmF1dG9jb21wbGV0ZSgic2VhcmNoIik7fWVsc2V7dGhpcy4kaW5wdXQuYXV0b2NvbXBsZXRlKCJzZWFyY2giLCcnKTt9fSxfb25JbnB1dEZvY3Vzb3V0OmZ1bmN0aW9uKCl7aWYodGhpcy5jYW5fY3JlYXRlJiZ0aGlzLmZsb2F0aW5nKXtuZXcgTTJPRGlhbG9nKHRoaXMsdGhpcy5zdHJpbmcsdGhpcy4kaW5wdXQudmFsKCkpLm9wZW4oKTt9fSxfb25JbnB1dEtleXVwOmZ1bmN0aW9uKGV2KXtpZihldi53aGljaD09PSQudWkua2V5Q29kZS5FTlRFUnx8ZXYud2hpY2g9PT0kLnVpLmtleUNvZGUuVEFCKXtyZXR1cm47fQp0aGlzLmlzRGlydHk9dHJ1ZTtpZih0aGlzLiRpbnB1dC52YWwoKT09PSIiKXt0aGlzLnJlaW5pdGlhbGl6ZShmYWxzZSk7fWVsc2UgaWYodGhpcy5fZ2V0RGlzcGxheU5hbWUodGhpcy5tMm9fdmFsdWUpIT09dGhpcy4kaW5wdXQudmFsKCkpe3RoaXMuZmxvYXRpbmc9dHJ1ZTt0aGlzLl91cGRhdGVFeHRlcm5hbEJ1dHRvbigpO319LF9vbktleWRvd246ZnVuY3Rpb24oKXt0aGlzLmZsb2F0aW5nPWZhbHNlO3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9LF9vbk5hdmlnYXRpb25Nb3ZlOmZ1bmN0aW9uKGV2KXtiYXNpY0ZpZWxkcy5JbnB1dEZpZWxkLnByb3RvdHlwZS5fb25OYXZpZ2F0aW9uTW92ZS5hcHBseSh0aGlzLGFyZ3VtZW50cyk7aWYodGhpcy5tb2RlPT09J2VkaXQnJiYkKHRoaXMuJGlucHV0LmF1dG9jb21wbGV0ZSgnd2lkZ2V0JykpLmlzKCc6dmlzaWJsZScpKXtldi5zdG9wUHJvcGFnYXRpb24oKTt9fSxfb25RdWlja0NyZWF0ZTpmdW5jdGlvbihldmVudCl7dGhpcy5fcXVpY2tDcmVhdGUoZXZlbnQuZGF0YS52YWx1ZSk7fSxfb25TZWFyY2hDcmVhdGVQb3B1cDpmdW5jdGlvbihldmVudCl7dmFyIGRhdGE9ZXZlbnQuZGF0YTt0aGlzLl9zZWFyY2hDcmVhdGVQb3B1cChkYXRhLnZpZXdfdHlwZSxmYWxzZSx0aGlzLl9jcmVhdGVDb250ZXh0KGRhdGEudmFsdWUpKTt9LH0pO3ZhciBNYW55Mm9uZUJhcmNvZGU9RmllbGRNYW55Mk9uZS5leHRlbmQoe30pO3ZhciBMaXN0RmllbGRNYW55Mk9uZT1GaWVsZE1hbnkyT25lLmV4dGVuZCh7ZXZlbnRzOl8uZXh0ZW5kKHt9LEZpZWxkTWFueTJPbmUucHJvdG90eXBlLmV2ZW50cyx7J2ZvY3VzaW4gaW5wdXQnOidfb25JbnB1dEZvY3VzaW4nLH0pLGluaXQ6ZnVuY3Rpb24oKXt0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy5tdXN0U2V0VmFsdWU9ZmFsc2U7dGhpcy5tMm9EaWFsb2dGb2N1c2VkPWZhbHNlO30sYWN0aXZhdGU6ZnVuY3Rpb24oKXtpZih0aGlzLm1vZGU9PT0ncmVhZG9ubHknKXtyZXR1cm4gZmFsc2U7fQpyZXR1cm4gdGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO30scmVpbml0aWFsaXplOmZ1bmN0aW9uKCl7dGhpcy5tdXN0U2V0VmFsdWU9ZmFsc2U7cmV0dXJuIHRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9LF9yZW5kZXJSZWFkb25seTpmdW5jdGlvbigpe3RoaXMuJGVsLnRleHQodGhpcy5tMm9fdmFsdWUpO30sX3NlYXJjaENyZWF0ZVBvcHVwOmZ1bmN0aW9uKCl7dGhpcy5tMm9EaWFsb2dGb2N1c2VkPXRydWU7cmV0dXJuIHRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9LF9vbklucHV0Rm9jdXNpbjpmdW5jdGlvbigpe3RoaXMubTJvRGlhbG9nRm9jdXNlZD1mYWxzZTt9LF9vbklucHV0Rm9jdXNvdXQ6ZnVuY3Rpb24oKXtpZih0aGlzLmNhbl9jcmVhdGUmJnRoaXMuZmxvYXRpbmcpe3ZhciBhdHRhY2hlZEV2ZW50cz1bJ2NsaWNrJywnbW91c2Vkb3duJ107dmFyIHN0b3BOZXh0Q2xpY2s9KGZ1bmN0aW9uKGV2KXtldi5zdG9wUHJvcGFnYXRpb24oKTthdHRhY2hlZEV2ZW50cy5mb3JFYWNoKGZ1bmN0aW9uKGV2ZW50TmFtZSl7d2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnROYW1lLHN0b3BOZXh0Q2xpY2ssdHJ1ZSk7fSk7fSkuYmluZCh0aGlzKTthdHRhY2hlZEV2ZW50cy5mb3JFYWNoKGZ1bmN0aW9uKGV2ZW50TmFtZSl7d2luZG93LmFkZEV2ZW50TGlzdGVuZXIoZXZlbnROYW1lLHN0b3BOZXh0Q2xpY2ssdHJ1ZSk7fSk7fQp0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7aWYoIXRoaXMubTJvRGlhbG9nRm9jdXNlZCYmdGhpcy4kaW5wdXQudmFsKCk9PT0iIiYmdGhpcy5tdXN0U2V0VmFsdWUpe3RoaXMucmVpbml0aWFsaXplKGZhbHNlKTt9fSxfb25JbnB1dEtleXVwOmZ1bmN0aW9uKCl7aWYodGhpcy4kaW5wdXQudmFsKCkhPT0iIil7dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO31lbHNle3RoaXMubXVzdFNldFZhbHVlPXRydWU7fX0sfSk7dmFyIEthbmJhbkZpZWxkTWFueTJPbmU9QWJzdHJhY3RGaWVsZC5leHRlbmQoe3RhZ05hbWU6J3NwYW4nLGluaXQ6ZnVuY3Rpb24oKXt0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy5tMm9fdmFsdWU9dGhpcy5fZm9ybWF0VmFsdWUodGhpcy52YWx1ZSk7fSxfcmVuZGVyOmZ1bmN0aW9uKCl7dGhpcy4kZWwudGV4dCh0aGlzLm0yb192YWx1ZSk7fSx9KTt2YXIgRmllbGRYMk1hbnk9QWJzdHJhY3RGaWVsZC5leHRlbmQoe3RhZ05hbWU6J2RpdicsY3VzdG9tX2V2ZW50czpfLmV4dGVuZCh7fSxBYnN0cmFjdEZpZWxkLnByb3RvdHlwZS5jdXN0b21fZXZlbnRzLHthZGRfcmVjb3JkOidfb25BZGRSZWNvcmQnLGRpc2NhcmRfY2hhbmdlczonX29uRGlzY2FyZENoYW5nZXMnLGVkaXRfbGluZTonX29uRWRpdExpbmUnLGZpZWxkX2NoYW5nZWQ6J19vbkZpZWxkQ2hhbmdlZCcsb3Blbl9yZWNvcmQ6J19vbk9wZW5SZWNvcmQnLGthbmJhbl9yZWNvcmRfZGVsZXRlOidfb25SZW1vdmVSZWNvcmQnLGxpc3RfcmVjb3JkX3JlbW92ZTonX29uUmVtb3ZlUmVjb3JkJyxyZXNlcXVlbmNlX3JlY29yZHM6J19vblJlc2VxdWVuY2VSZWNvcmRzJyxzYXZlX2xpbmU6J19vblNhdmVMaW5lJyx0b2dnbGVfY29sdW1uX29yZGVyOidfb25Ub2dnbGVDb2x1bW5PcmRlcicsYWN0aXZhdGVfbmV4dF93aWRnZXQ6J19vbkFjdGl2ZU5leHRXaWRnZXQnLG5hdmlnYXRpb25fbW92ZTonX29uTmF2aWdhdGlvbk1vdmUnLHNhdmVfb3B0aW9uYWxfZmllbGRzOidfb25TYXZlT3JMb2FkT3B0aW9uYWxGaWVsZHMnLGxvYWRfb3B0aW9uYWxfZmllbGRzOidfb25TYXZlT3JMb2FkT3B0aW9uYWxGaWVsZHMnLH0pLHJlc2V0T25BbnlGaWVsZENoYW5nZTp0cnVlLHVzZVN1YnZpZXc6dHJ1ZSxpbml0OmZ1bmN0aW9uKHBhcmVudCxuYW1lLHJlY29yZCxvcHRpb25zKXt0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy5ub2RlT3B0aW9ucz1fLmRlZmF1bHRzKHRoaXMubm9kZU9wdGlvbnMse2NyZWF0ZV90ZXh0Ol90KCdBZGQnKSx9KTt0aGlzLm9wZXJhdGlvbnM9W107dGhpcy5pc1JlYWRvbmx5PXRoaXMubW9kZT09PSdyZWFkb25seSc7dGhpcy52aWV3PXRoaXMuYXR0cnMudmlld3NbdGhpcy5hdHRycy5tb2RlXTt0aGlzLmlzTWFueTJNYW55PXRoaXMuZmllbGQudHlwZT09PSdtYW55Mm1hbnknfHx0aGlzLmF0dHJzLndpZGdldD09PSdtYW55Mm1hbnknO3RoaXMuYWN0aXZlQWN0aW9ucz17fTt0aGlzLnJlY29yZFBhcmFtcz17ZmllbGROYW1lOnRoaXMubmFtZSx2aWV3VHlwZTp0aGlzLnZpZXdUeXBlfTt2YXIgYXJjaD10aGlzLnZpZXcmJnRoaXMudmlldy5hcmNoO2lmKGFyY2gpe3RoaXMuYWN0aXZlQWN0aW9ucy5jcmVhdGU9YXJjaC5hdHRycy5jcmVhdGU/ISFKU09OLnBhcnNlKGFyY2guYXR0cnMuY3JlYXRlKTp0cnVlO3RoaXMuYWN0aXZlQWN0aW9ucy5kZWxldGU9YXJjaC5hdHRycy5kZWxldGU/ISFKU09OLnBhcnNlKGFyY2guYXR0cnMuZGVsZXRlKTp0cnVlO3RoaXMuZWRpdGFibGU9YXJjaC5hdHRycy5lZGl0YWJsZTt9CmlmKHRoaXMuYXR0cnMuY29sdW1uSW52aXNpYmxlRmllbGRzKXt0aGlzLl9wcm9jZXNzQ29sdW1uSW52aXNpYmxlRmllbGRzKCk7fX0sc3RhcnQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fcmVuZGVyQ29udHJvbFBhbmVsKCkudGhlbih0aGlzLl9zdXBlci5iaW5kKHRoaXMpKTt9LG9uX2F0dGFjaF9jYWxsYmFjazpmdW5jdGlvbigpe3RoaXMuaXNJbkRPTT10cnVlO2lmKHRoaXMucmVuZGVyZXIpe3RoaXMucmVuZGVyZXIub25fYXR0YWNoX2NhbGxiYWNrKCk7fX0sb25fZGV0YWNoX2NhbGxiYWNrOmZ1bmN0aW9uKCl7dGhpcy5pc0luRE9NPWZhbHNlO30sY29tbWl0Q2hhbmdlczpmdW5jdGlvbigpe3ZhciBzZWxmPXRoaXM7dmFyIGluRWRpdGlvblJlY29yZElEPXRoaXMucmVuZGVyZXImJnRoaXMucmVuZGVyZXIudmlld1R5cGU9PT0ibGlzdCImJnRoaXMucmVuZGVyZXIuZ2V0RWRpdGFibGVSZWNvcmRJRCgpO2lmKGluRWRpdGlvblJlY29yZElEKXtyZXR1cm4gdGhpcy5yZW5kZXJlci5jb21taXRDaGFuZ2VzKGluRWRpdGlvblJlY29yZElEKS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIHNlbGYuX3NhdmVMaW5lKGluRWRpdGlvblJlY29yZElEKTt9KTt9CnJldHVybiB0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fSxpc1NldDpmdW5jdGlvbigpe3JldHVybiB0cnVlO30scmVzZXQ6ZnVuY3Rpb24ocmVjb3JkLGV2LGZpZWxkQ2hhbmdlZCl7aWYoIWZpZWxkQ2hhbmdlZCl7dmFyIG5ld0V2YWw9dGhpcy5fZXZhbENvbHVtbkludmlzaWJsZUZpZWxkcygpO2lmKF8uaXNFcXVhbCh0aGlzLmN1cnJlbnRDb2xJbnZpc2libGVGaWVsZHMsbmV3RXZhbCkpe3JldHVybiBQcm9taXNlLnJlc29sdmUoKTt9fWVsc2UgaWYoZXYmJmV2LnRhcmdldD09PXRoaXMmJmV2LmRhdGEuY2hhbmdlcyYmdGhpcy52aWV3LmFyY2gudGFnPT09J3RyZWUnKXt2YXIgY29tbWFuZD1ldi5kYXRhLmNoYW5nZXNbdGhpcy5uYW1lXTtpZihjb21tYW5kLm9wZXJhdGlvbj09PSdVUERBVEUnJiZjb21tYW5kLmRhdGEpe3ZhciBzdGF0ZT1yZWNvcmQuZGF0YVt0aGlzLm5hbWVdO3ZhciBmaWVsZE5hbWVzPXN0YXRlLmdldEZpZWxkTmFtZXMoKTt0aGlzLl9yZXNldChyZWNvcmQsZXYpO3JldHVybiB0aGlzLnJlbmRlcmVyLmNvbmZpcm1VcGRhdGUoc3RhdGUsY29tbWFuZC5pZCxmaWVsZE5hbWVzLGV2LmluaXRpYWxFdmVudCk7fX0KcmV0dXJuIHRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9LGdldEZvY3VzYWJsZUVsZW1lbnQ6ZnVuY3Rpb24oKXtyZXR1cm4odGhpcy5tb2RlPT09J2VkaXQnJiZ0aGlzLiRpbnB1dCl8fHRoaXMuJGVsO30sYWN0aXZhdGU6ZnVuY3Rpb24ob3B0aW9ucyl7aWYoIXRoaXMuYWN0aXZlQWN0aW9ucy5jcmVhdGV8fHRoaXMuaXNSZWFkb25seXx8IXRoaXMuJGVsLmlzKCI6dmlzaWJsZSIpKXtyZXR1cm4gZmFsc2U7fQppZih0aGlzLnZpZXcudHlwZT09PSdrYW5iYW4nKXt0aGlzLiRidXR0b25zLmZpbmQoIi5vLWthbmJhbi1idXR0b24tbmV3IikuZm9jdXMoKTt9CmlmKHRoaXMudmlldy5hcmNoLnRhZz09PSd0cmVlJyl7aWYob3B0aW9ucyYmb3B0aW9ucy5ub0F1dG9tYXRpY0NyZWF0ZSl7dGhpcy5yZW5kZXJlci4kKCcub19maWVsZF94Mm1hbnlfbGlzdF9yb3dfYWRkIGE6Zmlyc3QnKS5mb2N1cygpO31lbHNle3RoaXMucmVuZGVyZXIuJCgnLm9fZmllbGRfeDJtYW55X2xpc3Rfcm93X2FkZCBhOmZpcnN0JykuY2xpY2soKTt9fQpyZXR1cm4gdHJ1ZTt9LF9ldmFsQ29sdW1uSW52aXNpYmxlRmllbGRzOmZ1bmN0aW9uKCl7dmFyIHNlbGY9dGhpcztyZXR1cm4gXy5tYXBPYmplY3QodGhpcy5jb2x1bW5JbnZpc2libGVGaWVsZHMsZnVuY3Rpb24oZG9tYWlucyl7cmV0dXJuIHNlbGYucmVjb3JkLmV2YWxNb2RpZmllcnMoe2NvbHVtbl9pbnZpc2libGU6ZG9tYWlucyx9KS5jb2x1bW5faW52aXNpYmxlO30pO30sX2dldFJlbmRlcmVyOmZ1bmN0aW9uKCl7aWYodGhpcy52aWV3LmFyY2gudGFnPT09J3RyZWUnKXtyZXR1cm4gTGlzdFJlbmRlcmVyO30KaWYodGhpcy52aWV3LmFyY2gudGFnPT09J2thbmJhbicpe3JldHVybiBLYW5iYW5SZW5kZXJlcjt9fSxfcmVuZGVyOmZ1bmN0aW9uKCl7dmFyIHNlbGY9dGhpcztpZighdGhpcy52aWV3KXtyZXR1cm4gdGhpcy5fc3VwZXIoKTt9CmlmKHRoaXMucmVuZGVyZXIpe3RoaXMuY3VycmVudENvbEludmlzaWJsZUZpZWxkcz10aGlzLl9ldmFsQ29sdW1uSW52aXNpYmxlRmllbGRzKCk7cmV0dXJuIHRoaXMucmVuZGVyZXIudXBkYXRlU3RhdGUodGhpcy52YWx1ZSx7Y29sdW1uSW52aXNpYmxlRmllbGRzOnRoaXMuY3VycmVudENvbEludmlzaWJsZUZpZWxkcyxrZWVwV2lkdGhzOnRydWUsfSkudGhlbihmdW5jdGlvbigpe3NlbGYucGFnZXIudXBkYXRlU3RhdGUoe3NpemU6c2VsZi52YWx1ZS5jb3VudH0pO30pO30KdmFyIGFyY2g9dGhpcy52aWV3LmFyY2g7dmFyIHZpZXdUeXBlO3ZhciByZW5kZXJlclBhcmFtcz17YXJjaDphcmNoLH07aWYoYXJjaC50YWc9PT0ndHJlZScpe3ZpZXdUeXBlPSdsaXN0Jzt0aGlzLmN1cnJlbnRDb2xJbnZpc2libGVGaWVsZHM9dGhpcy5fZXZhbENvbHVtbkludmlzaWJsZUZpZWxkcygpO18uZXh0ZW5kKHJlbmRlcmVyUGFyYW1zLHtlZGl0YWJsZTp0aGlzLm1vZGU9PT0nZWRpdCcmJmFyY2guYXR0cnMuZWRpdGFibGUsYWRkQ3JlYXRlTGluZTohdGhpcy5pc1JlYWRvbmx5JiZ0aGlzLmFjdGl2ZUFjdGlvbnMuY3JlYXRlLGFkZFRyYXNoSWNvbjohdGhpcy5pc1JlYWRvbmx5JiZ0aGlzLmFjdGl2ZUFjdGlvbnMuZGVsZXRlLGlzTWFueTJNYW55OnRoaXMuaXNNYW55Mk1hbnksY29sdW1uSW52aXNpYmxlRmllbGRzOnRoaXMuY3VycmVudENvbEludmlzaWJsZUZpZWxkcyx9KTt9CmlmKGFyY2gudGFnPT09J2thbmJhbicpe3ZpZXdUeXBlPSdrYW5iYW4nO3ZhciByZWNvcmRfb3B0aW9ucz17ZWRpdGFibGU6ZmFsc2UsZGVsZXRhYmxlOmZhbHNlLHJlYWRfb25seV9tb2RlOnRoaXMuaXNSZWFkb25seSx9O18uZXh0ZW5kKHJlbmRlcmVyUGFyYW1zLHtyZWNvcmRfb3B0aW9uczpyZWNvcmRfb3B0aW9ucyxyZWFkT25seU1vZGU6dGhpcy5pc1JlYWRvbmx5LH0pO30KXy5leHRlbmQocmVuZGVyZXJQYXJhbXMse3ZpZXdUeXBlOnZpZXdUeXBlLH0pO3ZhciBSZW5kZXJlcj10aGlzLl9nZXRSZW5kZXJlcigpO3RoaXMucmVuZGVyZXI9bmV3IFJlbmRlcmVyKHRoaXMsdGhpcy52YWx1ZSxyZW5kZXJlclBhcmFtcyk7dGhpcy4kZWwuYWRkQ2xhc3MoJ29fZmllbGRfeDJtYW55IG9fZmllbGRfeDJtYW55Xycrdmlld1R5cGUpO2lmKHRoaXMucmVuZGVyZXIpe3JldHVybiB0aGlzLnJlbmRlcmVyLmFwcGVuZFRvKGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKSkudGhlbihmdW5jdGlvbigpe2RvbS5hcHBlbmQoc2VsZi4kZWwsc2VsZi5yZW5kZXJlci4kZWwse2luX0RPTTpzZWxmLmlzSW5ET00sY2FsbGJhY2tzOlt7d2lkZ2V0OnNlbGYucmVuZGVyZXJ9XSx9KTt9KTt9ZWxzZXtyZXR1cm4gdGhpcy5fc3VwZXIoKTt9fSxfcmVuZGVyQ29udHJvbFBhbmVsOmZ1bmN0aW9uKCl7aWYoIXRoaXMudmlldyl7cmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO30KdmFyIHNlbGY9dGhpczt2YXIgZGVmcz1bXTt2YXIgY29udHJvbFBhbmVsVmlldz1uZXcgQ29udHJvbFBhbmVsVmlldyh7dGVtcGxhdGU6J1gyTWFueUNvbnRyb2xQYW5lbCcsd2l0aFNlYXJjaEJhcjpmYWxzZSx9KTt2YXIgY3BEZWY9Y29udHJvbFBhbmVsVmlldy5nZXRDb250cm9sbGVyKHRoaXMpLnRoZW4oZnVuY3Rpb24oY29udHJvbFBhbmVsKXtzZWxmLl9jb250cm9sUGFuZWw9Y29udHJvbFBhbmVsO3JldHVybiBzZWxmLl9jb250cm9sUGFuZWwucHJlcGVuZFRvKHNlbGYuJGVsKTt9KTt0aGlzLnBhZ2VyPW5ldyBQYWdlcih0aGlzLHRoaXMudmFsdWUuY291bnQsdGhpcy52YWx1ZS5vZmZzZXQrMSx0aGlzLnZhbHVlLmxpbWl0LHtzaW5nbGVfcGFnZV9oaWRkZW46dHJ1ZSx3aXRoQWNjZXNzS2V5OmZhbHNlLHZhbGlkYXRlOmZ1bmN0aW9uKCl7dmFyIGlzTGlzdD1zZWxmLnZpZXcuYXJjaC50YWc9PT0ndHJlZSc7cmV0dXJuIGlzTGlzdD9zZWxmLnJlbmRlcmVyLnVuc2VsZWN0Um93KCk6UHJvbWlzZS5yZXNvbHZlKCk7fSx9KTt0aGlzLnBhZ2VyLm9uKCdwYWdlcl9jaGFuZ2VkJyx0aGlzLGZ1bmN0aW9uKG5ld19zdGF0ZSl7c2VsZi50cmlnZ2VyX3VwKCdsb2FkJyx7aWQ6c2VsZi52YWx1ZS5pZCxsaW1pdDpuZXdfc3RhdGUubGltaXQsb2Zmc2V0Om5ld19zdGF0ZS5jdXJyZW50X21pbi0xLG9uX3N1Y2Nlc3M6ZnVuY3Rpb24odmFsdWUpe3NlbGYudmFsdWU9dmFsdWU7c2VsZi5fcmVuZGVyKCk7fSx9KTt9KTt0aGlzLl9yZW5kZXJCdXR0b25zKCk7ZGVmcy5wdXNoKHRoaXMucGFnZXIuYXBwZW5kVG8oJCgnPGRpdj4nKSkpO2RlZnMucHVzaChjcERlZik7cmV0dXJuIFByb21pc2UuYWxsKGRlZnMpLnRoZW4oZnVuY3Rpb24oKXtzZWxmLl9jb250cm9sUGFuZWwudXBkYXRlQ29udGVudHMoe2NwX2NvbnRlbnQ6eyRidXR0b25zOnNlbGYuJGJ1dHRvbnMsJHBhZ2VyOnNlbGYucGFnZXIuJGVsLH19KTt9KTt9LF9yZW5kZXJCdXR0b25zOmZ1bmN0aW9uKCl7aWYoIXRoaXMuaXNSZWFkb25seSYmdGhpcy52aWV3LmFyY2gudGFnPT09J2thbmJhbicpe3RoaXMuJGJ1dHRvbnM9JChxd2ViLnJlbmRlcignS2FuYmFuVmlldy5idXR0b25zJyx7YnRuQ2xhc3M6J2J0bi1zZWNvbmRhcnknLGNyZWF0ZV90ZXh0OnRoaXMubm9kZU9wdGlvbnMuY3JlYXRlX3RleHQsfSkpO3RoaXMuJGJ1dHRvbnMub24oJ2NsaWNrJywnYnV0dG9uLm8ta2FuYmFuLWJ1dHRvbi1uZXcnLHRoaXMuX29uQWRkUmVjb3JkLmJpbmQodGhpcykpO319LF9zYXZlTGluZTpmdW5jdGlvbihyZWNvcmRJRCl7dmFyIHNlbGY9dGhpcztyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSxyZWplY3Qpe3ZhciBmaWVsZE5hbWVzPXNlbGYucmVuZGVyZXIuY2FuQmVTYXZlZChyZWNvcmRJRCk7aWYoZmllbGROYW1lcy5sZW5ndGgpe3NlbGYudHJpZ2dlcl91cCgnZGlzY2FyZF9jaGFuZ2VzJyx7cmVjb3JkSUQ6cmVjb3JkSUQsb25TdWNjZXNzOnJlc29sdmUsb25GYWlsdXJlOnJlamVjdCx9KTt9ZWxzZXtzZWxmLnJlbmRlcmVyLnNldFJvd01vZGUocmVjb3JkSUQsJ3JlYWRvbmx5JykudGhlbihyZXNvbHZlKTt9fSkudGhlbihmdW5jdGlvbigpe3NlbGYucGFnZXIudXBkYXRlU3RhdGUoe3NpemU6c2VsZi52YWx1ZS5jb3VudH0pO3ZhciBuZXdFdmFsPXNlbGYuX2V2YWxDb2x1bW5JbnZpc2libGVGaWVsZHMoKTtpZighXy5pc0VxdWFsKHNlbGYuY3VycmVudENvbEludmlzaWJsZUZpZWxkcyxuZXdFdmFsKSl7c2VsZi5jdXJyZW50Q29sSW52aXNpYmxlRmllbGRzPW5ld0V2YWw7c2VsZi5yZW5kZXJlci51cGRhdGVTdGF0ZShzZWxmLnZhbHVlLHtjb2x1bW5JbnZpc2libGVGaWVsZHM6c2VsZi5jdXJyZW50Q29sSW52aXNpYmxlRmllbGRzLH0pO319KTt9LF9wcm9jZXNzQ29sdW1uSW52aXNpYmxlRmllbGRzOmZ1bmN0aW9uKCl7dmFyIGNvbHVtbkludmlzaWJsZUZpZWxkcz17fTtfLmVhY2godGhpcy5hdHRycy5jb2x1bW5JbnZpc2libGVGaWVsZHMsZnVuY3Rpb24oZG9tYWlucyxmaWVsZE5hbWUpe2lmKF8uaXNBcnJheShkb21haW5zKSl7Y29sdW1uSW52aXNpYmxlRmllbGRzW2ZpZWxkTmFtZV09Xy5tYXAoZG9tYWlucyxmdW5jdGlvbihkb21haW4pe2lmKF8uaXNBcnJheShkb21haW4pKXtyZXR1cm5bZG9tYWluWzBdLnNwbGl0KCcuJylbMV1dLmNvbmNhdChkb21haW4uc2xpY2UoMSkpO30KcmV0dXJuIGRvbWFpbjt9KTt9fSk7dGhpcy5jb2x1bW5JbnZpc2libGVGaWVsZHM9Y29sdW1uSW52aXNpYmxlRmllbGRzO30sX29uQWRkUmVjb3JkOmZ1bmN0aW9uKCl7fSxfb25SZW1vdmVSZWNvcmQ6ZnVuY3Rpb24oZXYpe2V2LnN0b3BQcm9wYWdhdGlvbigpO3ZhciBvcGVyYXRpb249dGhpcy5pc01hbnkyTWFueT8nRk9SR0VUJzonREVMRVRFJzt0aGlzLl9zZXRWYWx1ZSh7b3BlcmF0aW9uOm9wZXJhdGlvbixpZHM6W2V2LmRhdGEuaWRdLH0pO30sX29uRGlzY2FyZENoYW5nZXM6ZnVuY3Rpb24oZXYpe2lmKGV2LnRhcmdldCE9PXRoaXMpe2V2LnN0b3BQcm9wYWdhdGlvbigpO3RoaXMudHJpZ2dlcl91cCgnZGlzY2FyZF9jaGFuZ2VzJyxfLmV4dGVuZCh7fSxldi5kYXRhLHtmaWVsZE5hbWU6dGhpcy5uYW1lfSkpO319LF9vbkVkaXRMaW5lOmZ1bmN0aW9uKGV2KXtldi5zdG9wUHJvcGFnYXRpb24oKTt0aGlzLnRyaWdnZXJfdXAoJ2VkaXRlZF9saXN0Jyx7aWQ6dGhpcy52YWx1ZS5pZH0pO3RoaXMucmVuZGVyZXIuc2V0Um93TW9kZShldi5kYXRhLnJlY29yZElkLCdlZGl0JykudGhlbihldi5kYXRhLm9uU3VjY2Vzcyk7fSxfb25GaWVsZENoYW5nZWQ6ZnVuY3Rpb24oZXYpe2lmKGV2LnRhcmdldD09PXRoaXMpe2V2LmluaXRpYWxFdmVudD10aGlzLmxhc3RJbml0aWFsRXZlbnQ7cmV0dXJuO30KZXYuc3RvcFByb3BhZ2F0aW9uKCk7dmFyIGNoYW5nZXM9ZXYuZGF0YS5jaGFuZ2VzO3RoaXMubGFzdEluaXRpYWxFdmVudD11bmRlZmluZWQ7aWYoT2JqZWN0LmtleXMoY2hhbmdlcykubGVuZ3RoKXt0aGlzLmxhc3RJbml0aWFsRXZlbnQ9ZXY7dGhpcy5fc2V0VmFsdWUoe29wZXJhdGlvbjonVVBEQVRFJyxpZDpldi5kYXRhLmRhdGFQb2ludElELGRhdGE6Y2hhbmdlcyx9KS50aGVuKGZ1bmN0aW9uKCl7aWYoZXYuZGF0YS5vblN1Y2Nlc3Mpe2V2LmRhdGEub25TdWNjZXNzKCk7fX0pLmd1YXJkZWRDYXRjaChmdW5jdGlvbigpe2lmKGV2LmRhdGEub25GYWlsdXJlKXtldi5kYXRhLm9uRmFpbHVyZSgpO319KTt9fSxfb25OYXZpZ2F0aW9uTW92ZTpmdW5jdGlvbihldil7aWYodGhpcy52aWV3LmFyY2gudGFnPT09J3RyZWUnKXt2YXIgJGN1ckNvbnRyb2w9dGhpcy5yZW5kZXJlci4kKCcub19maWVsZF94Mm1hbnlfbGlzdF9yb3dfYWRkIGE6Zm9jdXMnKTtpZigkY3VyQ29udHJvbC5sZW5ndGgpe3ZhciAkbmV4dENvbnRyb2w7aWYoZXYuZGF0YS5kaXJlY3Rpb249PT0ncmlnaHQnKXskbmV4dENvbnRyb2w9JGN1ckNvbnRyb2wubmV4dCgnYScpO31lbHNlIGlmKGV2LmRhdGEuZGlyZWN0aW9uPT09J2xlZnQnKXskbmV4dENvbnRyb2w9JGN1ckNvbnRyb2wucHJldignYScpO30KaWYoJG5leHRDb250cm9sJiYkbmV4dENvbnRyb2wubGVuZ3RoKXtldi5zdG9wUHJvcGFnYXRpb24oKTskbmV4dENvbnRyb2wuZm9jdXMoKTtyZXR1cm47fX19CnRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9LF9vbk9wZW5SZWNvcmQ6ZnVuY3Rpb24oKXt9LF9vblNhdmVMaW5lOmZ1bmN0aW9uKGV2KXt2YXIgc2VsZj10aGlzO2V2LnN0b3BQcm9wYWdhdGlvbigpO3RoaXMucmVuZGVyZXIuY29tbWl0Q2hhbmdlcyhldi5kYXRhLnJlY29yZElEKS50aGVuKGZ1bmN0aW9uKCl7c2VsZi50cmlnZ2VyX3VwKCdtdXRleGlmeScse2FjdGlvbjpmdW5jdGlvbigpe3JldHVybiBzZWxmLl9zYXZlTGluZShldi5kYXRhLnJlY29yZElEKS50aGVuKGV2LmRhdGEub25TdWNjZXNzKS5ndWFyZGVkQ2F0Y2goZXYuZGF0YS5vbkZhaWx1cmUpO30sfSk7fSk7fSxfb25TYXZlT3JMb2FkT3B0aW9uYWxGaWVsZHM6ZnVuY3Rpb24oZXYpe2V2LmRhdGEua2V5UGFydHMucmVsYXRpb25hbEZpZWxkPXRoaXMubmFtZTtldi5kYXRhLmtleVBhcnRzLnN1YlZpZXdJZD10aGlzLnZpZXcudmlld19pZDtldi5kYXRhLmtleVBhcnRzLnN1YlZpZXdUeXBlPXRoaXMudmlldy50eXBlO30sX29uUmVzZXF1ZW5jZVJlY29yZHM6ZnVuY3Rpb24oZXYpe2V2LnN0b3BQcm9wYWdhdGlvbigpO3ZhciBzZWxmPXRoaXM7aWYodGhpcy52aWV3LmFyY2gudGFnPT09J3RyZWUnKXt0aGlzLnRyaWdnZXJfdXAoJ2VkaXRlZF9saXN0Jyx7aWQ6dGhpcy52YWx1ZS5pZH0pO30KdmFyIGhhbmRsZUZpZWxkPWV2LmRhdGEuaGFuZGxlRmllbGQ7dmFyIG9mZnNldD1ldi5kYXRhLm9mZnNldDt2YXIgcmVjb3JkSWRzPWV2LmRhdGEucmVjb3JkSWRzLnNsaWNlKCk7dmFyIHJlY29yZElkPXJlY29yZElkcy5wb3AoKTt2YXIgcHJvbXM9cmVjb3JkSWRzLm1hcChmdW5jdGlvbihyZWNvcmRJZCxpbmRleCl7dmFyIGRhdGE9e307ZGF0YVtoYW5kbGVGaWVsZF09b2Zmc2V0K2luZGV4O3JldHVybiBzZWxmLl9zZXRWYWx1ZSh7b3BlcmF0aW9uOidVUERBVEUnLGlkOnJlY29yZElkLGRhdGE6ZGF0YSx9LHtub3RpZnlDaGFuZ2U6ZmFsc2UsfSk7fSk7UHJvbWlzZS5hbGwocHJvbXMpLnRoZW4oZnVuY3Rpb24oKXtmdW5jdGlvbiBhbHdheXMoKXtpZihzZWxmLnZpZXcuYXJjaC50YWc9PT0ndHJlZScpe3NlbGYudHJpZ2dlcl91cCgndG9nZ2xlX2NvbHVtbl9vcmRlcicse2lkOnNlbGYudmFsdWUuaWQsbmFtZTpoYW5kbGVGaWVsZCx9KTt9fQp2YXIgZGF0YT17fTtkYXRhW2hhbmRsZUZpZWxkXT1vZmZzZXQrcmVjb3JkSWRzLmxlbmd0aDtzZWxmLl9zZXRWYWx1ZSh7b3BlcmF0aW9uOidVUERBVEUnLGlkOnJlY29yZElkLGRhdGE6ZGF0YSx9KS50aGVuKGFsd2F5cykuZ3VhcmRlZENhdGNoKGFsd2F5cyk7fSk7fSxfb25Ub2dnbGVDb2x1bW5PcmRlcjpmdW5jdGlvbihldil7ZXYuZGF0YS5maWVsZD10aGlzLm5hbWU7fSxfb25BY3RpdmVOZXh0V2lkZ2V0OmZ1bmN0aW9uKGUpe2Uuc3RvcFByb3BhZ2F0aW9uKCk7dGhpcy5yZW5kZXJlci51bnNlbGVjdFJvdygpO3RoaXMudHJpZ2dlcl91cCgnbmF2aWdhdGlvbl9tb3ZlJyx7ZGlyZWN0aW9uOmUuZGF0YS5kaXJlY3Rpb258fCduZXh0Jyx9KTt9LH0pO3ZhciBPbmUyTWFueUthbmJhblJlY29yZD1LYW5iYW5SZWNvcmQuZXh0ZW5kKHtfcG9zdFByb2Nlc3NPYmplY3RCdXR0b25zOmZ1bmN0aW9uKCl7dmFyIHNlbGY9dGhpcztpZighdGhpcy5zdGF0ZS5yZXNfaWQpe3RoaXMuJCgnLm9lX2thbmJhbl9hY3Rpb25bZGF0YS10eXBlPW9iamVjdF0nKS5lYWNoKGZ1bmN0aW9uKGluZGV4LGJ1dHRvbil7dmFyICRidXR0b249JChidXR0b24pO2lmKCRidXR0b24uYXR0cignd2FybicpKXskYnV0dG9uLm9uKCdjbGljaycsZnVuY3Rpb24oZSl7ZS5zdG9wUHJvcGFnYXRpb24oKTtzZWxmLmRvX3dhcm4oX3QoJ1dhcm5pbmcnKSxfdCgnUGxlYXNlIGNsaWNrIG9uIHRoZSAic2F2ZSIgYnV0dG9uIGZpcnN0LicpKTt9KTt9ZWxzZXskYnV0dG9uLmF0dHIoJ2Rpc2FibGVkJywnZGlzYWJsZWQnKTt9fSk7fX0sX3JlbmRlcjpmdW5jdGlvbigpe3ZhciBzZWxmPXRoaXM7cmV0dXJuIHRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKS50aGVuKGZ1bmN0aW9uKCl7c2VsZi5fcG9zdFByb2Nlc3NPYmplY3RCdXR0b25zKCk7fSk7fSx9KTt2YXIgT25lMk1hbnlLYW5iYW5SZW5kZXJlcj1LYW5iYW5SZW5kZXJlci5leHRlbmQoe2NvbmZpZzpfLmV4dGVuZCh7fSxLYW5iYW5SZW5kZXJlci5wcm90b3R5cGUuY29uZmlnLHtLYW5iYW5SZWNvcmQ6T25lMk1hbnlLYW5iYW5SZWNvcmQsfSksfSk7dmFyIEZpZWxkT25lMk1hbnk9RmllbGRYMk1hbnkuZXh0ZW5kKHtkZXNjcmlwdGlvbjpfbHQoIk9uZTJtYW55IiksY2xhc3NOYW1lOidvX2ZpZWxkX29uZTJtYW55JyxzdXBwb3J0ZWRGaWVsZFR5cGVzOlsnb25lMm1hbnknXSxpbml0OmZ1bmN0aW9uKCl7dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3RoaXMuY3JlYXRpbmdSZWNvcmQ9ZmFsc2U7fSxyZXNldDpmdW5jdGlvbihyZWNvcmQsZXYpe3ZhciBzZWxmPXRoaXM7cmV0dXJuIHRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKS50aGVuKGZ1bmN0aW9uKCl7aWYoZXYmJmV2LnRhcmdldD09PXNlbGYmJmV2LmRhdGEuY2hhbmdlcyYmc2VsZi52aWV3LmFyY2gudGFnPT09J3RyZWUnKXtpZihldi5kYXRhLmNoYW5nZXNbc2VsZi5uYW1lXS5vcGVyYXRpb249PT0nQ1JFQVRFJyl7dmFyIGluZGV4PTA7aWYoc2VsZi5lZGl0YWJsZSE9PSd0b3AnKXtpbmRleD1zZWxmLnZhbHVlLmRhdGEubGVuZ3RoLTE7c2VsZi5wYWdlci51cGRhdGVTdGF0ZSh7c2l6ZTpzZWxmLnZhbHVlLmNvdW50LTF9KTt9CnZhciBuZXdJRD1zZWxmLnZhbHVlLmRhdGFbaW5kZXhdLmlkO3NlbGYucmVuZGVyZXIuZWRpdFJlY29yZChuZXdJRCk7fX19KTt9LF9nZXRSZW5kZXJlcjpmdW5jdGlvbigpe2lmKHRoaXMudmlldy5hcmNoLnRhZz09PSdrYW5iYW4nKXtyZXR1cm4gT25lMk1hbnlLYW5iYW5SZW5kZXJlcjt9CnJldHVybiB0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fSxfcmVuZGVyQnV0dG9uczpmdW5jdGlvbigpe2lmKHRoaXMuYWN0aXZlQWN0aW9ucy5jcmVhdGUpe3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9fSxfb3BlbkZvcm1EaWFsb2c6ZnVuY3Rpb24ocGFyYW1zKXt2YXIgY29udGV4dD10aGlzLnJlY29yZC5nZXRDb250ZXh0KF8uZXh0ZW5kKHt9LHRoaXMucmVjb3JkUGFyYW1zLHthZGRpdGlvbmFsQ29udGV4dDpwYXJhbXMuY29udGV4dH0pKTt0aGlzLnRyaWdnZXJfdXAoJ29wZW5fb25lMm1hbnlfcmVjb3JkJyxfLmV4dGVuZChwYXJhbXMse2RvbWFpbjp0aGlzLnJlY29yZC5nZXREb21haW4odGhpcy5yZWNvcmRQYXJhbXMpLGNvbnRleHQ6Y29udGV4dCxmaWVsZDp0aGlzLmZpZWxkLGZpZWxkc192aWV3OnRoaXMuYXR0cnMudmlld3MmJnRoaXMuYXR0cnMudmlld3MuZm9ybSxwYXJlbnRJRDp0aGlzLnZhbHVlLmlkLHZpZXdJbmZvOnRoaXMudmlldyxkZWxldGFibGU6dGhpcy5hY3RpdmVBY3Rpb25zLmRlbGV0ZSYmcGFyYW1zLmRlbGV0YWJsZSx9KSk7fSxfb25BZGRSZWNvcmQ6ZnVuY3Rpb24oZXYpe3ZhciBzZWxmPXRoaXM7dmFyIGRhdGE9ZXYuZGF0YXx8e307ZXYuc3RvcFByb3BhZ2F0aW9uKCk7aWYodGhpcy5lZGl0YWJsZXx8ZGF0YS5mb3JjZUVkaXRhYmxlKXtpZighdGhpcy5hY3RpdmVBY3Rpb25zLmNyZWF0ZSl7aWYoZGF0YS5vbkZhaWwpe2RhdGEub25GYWlsKCk7fX1lbHNlIGlmKCF0aGlzLmNyZWF0aW5nUmVjb3JkKXt0aGlzLmNyZWF0aW5nUmVjb3JkPXRydWU7dGhpcy50cmlnZ2VyX3VwKCdlZGl0ZWRfbGlzdCcse2lkOnRoaXMudmFsdWUuaWR9KTt0aGlzLl9zZXRWYWx1ZSh7b3BlcmF0aW9uOidDUkVBVEUnLHBvc2l0aW9uOnRoaXMuZWRpdGFibGV8fGRhdGEuZm9yY2VFZGl0YWJsZSxjb250ZXh0OmRhdGEuY29udGV4dCx9LHthbGxvd1dhcm5pbmc6ZGF0YS5hbGxvd1dhcm5pbmd9KS50aGVuKGZ1bmN0aW9uKCl7c2VsZi5jcmVhdGluZ1JlY29yZD1mYWxzZTt9KS50aGVuKGZ1bmN0aW9uKCl7aWYoZGF0YS5vblN1Y2Nlc3Mpe2RhdGEub25TdWNjZXNzKCk7fX0pLmd1YXJkZWRDYXRjaChmdW5jdGlvbigpe3NlbGYuY3JlYXRpbmdSZWNvcmQ9ZmFsc2U7fSk7fX1lbHNle3RoaXMuX29wZW5Gb3JtRGlhbG9nKHtjb250ZXh0OmRhdGEuY29udGV4dCYmZGF0YS5jb250ZXh0WzBdLG9uX3NhdmVkOmZ1bmN0aW9uKHJlY29yZCl7c2VsZi5fc2V0VmFsdWUoe29wZXJhdGlvbjonQUREJyxpZDpyZWNvcmQuaWR9KTt9LH0pO319LF9vbk9wZW5SZWNvcmQ6ZnVuY3Rpb24oZXYpe3ZhciBzZWxmPXRoaXM7ZXYuc3RvcFByb3BhZ2F0aW9uKCk7dmFyIGlkPWV2LmRhdGEuaWQ7dmFyIG9uU2F2ZWQ9ZnVuY3Rpb24ocmVjb3JkKXtpZihfLnNvbWUoc2VsZi52YWx1ZS5kYXRhLHtpZDpyZWNvcmQuaWR9KSl7c2VsZi5fc2V0VmFsdWUoe29wZXJhdGlvbjonVVBEQVRFJyxpZDpyZWNvcmQuaWR9KTt9ZWxzZXtzZWxmLl9zZXRWYWx1ZSh7b3BlcmF0aW9uOidBREQnLGlkOnJlY29yZC5pZH0pO319O3RoaXMuX29wZW5Gb3JtRGlhbG9nKHtpZDppZCxvbl9zYXZlZDpvblNhdmVkLG9uX3JlbW92ZTpmdW5jdGlvbigpe3NlbGYuX3NldFZhbHVlKHtvcGVyYXRpb246J0RFTEVURScsaWRzOltpZF19KTt9LGRlbGV0YWJsZTp0aGlzLmFjdGl2ZUFjdGlvbnMuZGVsZXRlJiZ0aGlzLnZpZXcuYXJjaC50YWchPT0ndHJlZScscmVhZG9ubHk6dGhpcy5tb2RlPT09J3JlYWRvbmx5Jyx9KTt9LH0pO3ZhciBGaWVsZE1hbnkyTWFueT1GaWVsZFgyTWFueS5leHRlbmQoe2Rlc2NyaXB0aW9uOl9sdCgiTWFueTJtYW55IiksY2xhc3NOYW1lOidvX2ZpZWxkX21hbnkybWFueScsc3VwcG9ydGVkRmllbGRUeXBlczpbJ21hbnkybWFueSddLG9uQWRkUmVjb3JkT3BlbkRpYWxvZzpmdW5jdGlvbigpe3ZhciBzZWxmPXRoaXM7dmFyIGRvbWFpbj10aGlzLnJlY29yZC5nZXREb21haW4oe2ZpZWxkTmFtZTp0aGlzLm5hbWV9KTtuZXcgZGlhbG9ncy5TZWxlY3RDcmVhdGVEaWFsb2codGhpcyx7cmVzX21vZGVsOnRoaXMuZmllbGQucmVsYXRpb24sZG9tYWluOmRvbWFpbi5jb25jYXQoWyIhIixbImlkIiwiaW4iLHRoaXMudmFsdWUucmVzX2lkc11dKSxjb250ZXh0OnRoaXMucmVjb3JkLmdldENvbnRleHQodGhpcy5yZWNvcmRQYXJhbXMpLHRpdGxlOl90KCJBZGQ6ICIpK3RoaXMuc3RyaW5nLG5vX2NyZWF0ZTp0aGlzLm5vZGVPcHRpb25zLm5vX2NyZWF0ZXx8IXRoaXMuYWN0aXZlQWN0aW9ucy5jcmVhdGUsZmllbGRzX3ZpZXc6dGhpcy5hdHRycy52aWV3cy5mb3JtLGthbmJhbl92aWV3X3JlZjp0aGlzLmF0dHJzLmthbmJhbl92aWV3X3JlZixvbl9zZWxlY3RlZDpmdW5jdGlvbihyZWNvcmRzKXt2YXIgcmVzSURzPV8ucGx1Y2socmVjb3JkcywnaWQnKTt2YXIgbmV3SURzPV8uZGlmZmVyZW5jZShyZXNJRHMsc2VsZi52YWx1ZS5yZXNfaWRzKTtpZihuZXdJRHMubGVuZ3RoKXt2YXIgdmFsdWVzPV8ubWFwKG5ld0lEcyxmdW5jdGlvbihpZCl7cmV0dXJue2lkOmlkfTt9KTtzZWxmLl9zZXRWYWx1ZSh7b3BlcmF0aW9uOidBRERfTTJNJyxpZHM6dmFsdWVzLH0pO319fSkub3BlbigpO30sX29uQWRkUmVjb3JkOmZ1bmN0aW9uKGV2KXtldi5zdG9wUHJvcGFnYXRpb24oKTt0aGlzLm9uQWRkUmVjb3JkT3BlbkRpYWxvZygpO30sX29uT3BlblJlY29yZDpmdW5jdGlvbihldil7dmFyIHNlbGY9dGhpcztfLmV4dGVuZChldi5kYXRhLHtjb250ZXh0OnRoaXMucmVjb3JkLmdldENvbnRleHQodGhpcy5yZWNvcmRQYXJhbXMpLGRvbWFpbjp0aGlzLnJlY29yZC5nZXREb21haW4odGhpcy5yZWNvcmRQYXJhbXMpLGZpZWxkc192aWV3OnRoaXMuYXR0cnMudmlld3MmJnRoaXMuYXR0cnMudmlld3MuZm9ybSxvbl9zYXZlZDpmdW5jdGlvbigpe3NlbGYuX3NldFZhbHVlKHtvcGVyYXRpb246J1RSSUdHRVJfT05DSEFOR0UnfSx7Zm9yY2VDaGFuZ2U6dHJ1ZX0pLnRoZW4oZnVuY3Rpb24oKXtzZWxmLnRyaWdnZXJfdXAoJ3JlbG9hZCcse2RiX2lkOmV2LmRhdGEuaWR9KTt9KTt9LG9uX3JlbW92ZTpmdW5jdGlvbigpe3NlbGYuX3NldFZhbHVlKHtvcGVyYXRpb246J0ZPUkdFVCcsaWRzOltldi5kYXRhLmlkXX0pO30scmVhZG9ubHk6dGhpcy5tb2RlPT09J3JlYWRvbmx5JyxkZWxldGFibGU6dGhpcy5hY3RpdmVBY3Rpb25zLmRlbGV0ZSYmdGhpcy52aWV3LmFyY2gudGFnIT09J3RyZWUnLHN0cmluZzp0aGlzLnN0cmluZyx9KTt9LH0pO3ZhciBGaWVsZE1hbnkyTWFueUJpbmFyeU11bHRpRmlsZXM9QWJzdHJhY3RGaWVsZC5leHRlbmQoe3RlbXBsYXRlOiJGaWVsZEJpbmFyeUZpbGVVcGxvYWRlciIsdGVtcGxhdGVfZmlsZXM6IkZpZWxkQmluYXJ5RmlsZVVwbG9hZGVyLmZpbGVzIixzdXBwb3J0ZWRGaWVsZFR5cGVzOlsnbWFueTJtYW55J10sZmllbGRzVG9GZXRjaDp7bmFtZTp7dHlwZTonY2hhcid9LG1pbWV0eXBlOnt0eXBlOidjaGFyJ30sfSxldmVudHM6eydjbGljayAub19hdHRhY2gnOidfb25BdHRhY2gnLCdjbGljayAub19hdHRhY2htZW50X2RlbGV0ZSc6J19vbkRlbGV0ZScsJ2NoYW5nZSAub19pbnB1dF9maWxlJzonX29uRmlsZUNoYW5nZWQnLH0saW5pdDpmdW5jdGlvbigpe3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtpZih0aGlzLmZpZWxkLnR5cGUhPT0nbWFueTJtYW55J3x8dGhpcy5maWVsZC5yZWxhdGlvbiE9PSdpci5hdHRhY2htZW50Jyl7dmFyIG1zZz1fdCgiVGhlIHR5cGUgb2YgdGhlIGZpZWxkICclcycgbXVzdCBiZSBhIG1hbnkybWFueSBmaWVsZCB3aXRoIGEgcmVsYXRpb24gdG8gJ2lyLmF0dGFjaG1lbnQnIG1vZGVsLiIpO3Rocm93IF8uc3RyLnNwcmludGYobXNnLHRoaXMuZmllbGQuc3RyaW5nKTt9CnRoaXMudXBsb2FkZWRGaWxlcz17fTt0aGlzLnVwbG9hZGluZ0ZpbGVzPVtdO3RoaXMuZmlsZXVwbG9hZF9pZD1fLnVuaXF1ZUlkKCdvZV9maWxldXBsb2FkX3RlbXAnKTskKHdpbmRvdykub24odGhpcy5maWxldXBsb2FkX2lkLHRoaXMuX29uRmlsZUxvYWRlZC5iaW5kKHRoaXMpKTt0aGlzLm1ldGFkYXRhPXt9O30sZGVzdHJveTpmdW5jdGlvbigpe3RoaXMuX3N1cGVyKCk7JCh3aW5kb3cpLm9mZih0aGlzLmZpbGV1cGxvYWRfaWQpO30sX2dldEZpbGVVcmw6ZnVuY3Rpb24oYXR0YWNobWVudCl7cmV0dXJuJy93ZWIvY29udGVudC8nK2F0dGFjaG1lbnQuaWQrJz9kb3dubG9hZD10cnVlJzt9LF9nZW5lcmF0ZWRNZXRhZGF0YTpmdW5jdGlvbigpe3ZhciBzZWxmPXRoaXM7Xy5lYWNoKHRoaXMudmFsdWUuZGF0YSxmdW5jdGlvbihyZWNvcmQpe3NlbGYubWV0YWRhdGFbcmVjb3JkLmlkXT17YWxsb3dVbmxpbms6c2VsZi51cGxvYWRlZEZpbGVzW3JlY29yZC5kYXRhLmlkXXx8ZmFsc2UsdXJsOnNlbGYuX2dldEZpbGVVcmwocmVjb3JkLmRhdGEpLH07fSk7fSxfcmVuZGVyOmZ1bmN0aW9uKCl7dGhpcy5fZ2VuZXJhdGVkTWV0YWRhdGEoKTt0aGlzLiQoJy5vZV9wbGFjZWhvbGRlcl9maWxlcywgLm9fYXR0YWNobWVudHMnKS5yZXBsYWNlV2l0aCgkKHF3ZWIucmVuZGVyKHRoaXMudGVtcGxhdGVfZmlsZXMse3dpZGdldDp0aGlzLH0pKSk7dGhpcy4kKCcub2VfZmlsZXVwbG9hZCcpLnNob3coKTt0aGlzLiQoJy5vX2ltYWdlW2RhdGEtbWltZXR5cGVePSJpbWFnZSJdJykuZWFjaChmdW5jdGlvbigpe3ZhciAkaW1nPSQodGhpcyk7aWYoL2dpZnxqcGV8anBnfHBuZy8udGVzdCgkaW1nLmRhdGEoJ21pbWV0eXBlJykpJiYkaW1nLmRhdGEoJ3NyYycpKXskaW1nLmNzcygnYmFja2dyb3VuZC1pbWFnZScsInVybCgnIiskaW1nLmRhdGEoJ3NyYycpKyInKSIpO319KTt9LF9vbkF0dGFjaDpmdW5jdGlvbigpe3RoaXMuJCgnLm9faW5wdXRfZmlsZScpLmNsaWNrKCk7fSxfb25EZWxldGU6ZnVuY3Rpb24oZXYpe2V2LnByZXZlbnREZWZhdWx0KCk7ZXYuc3RvcFByb3BhZ2F0aW9uKCk7dmFyIGZpbGVJRD0kKGV2LmN1cnJlbnRUYXJnZXQpLmRhdGEoJ2lkJyk7dmFyIHJlY29yZD1fLmZpbmRXaGVyZSh0aGlzLnZhbHVlLmRhdGEse3Jlc19pZDpmaWxlSUR9KTtpZihyZWNvcmQpe3RoaXMuX3NldFZhbHVlKHtvcGVyYXRpb246J0ZPUkdFVCcsaWRzOltyZWNvcmQuaWRdLH0pO3ZhciBtZXRhZGF0YT10aGlzLm1ldGFkYXRhW3JlY29yZC5pZF07aWYoIW1ldGFkYXRhfHxtZXRhZGF0YS5hbGxvd1VubGluayl7dGhpcy5fcnBjKHttb2RlbDonaXIuYXR0YWNobWVudCcsbWV0aG9kOid1bmxpbmsnLGFyZ3M6W3JlY29yZC5yZXNfaWRdLH0pO319fSxfb25GaWxlQ2hhbmdlZDpmdW5jdGlvbihldil7dmFyIHNlbGY9dGhpcztldi5zdG9wUHJvcGFnYXRpb24oKTt2YXIgZmlsZXM9ZXYudGFyZ2V0LmZpbGVzO3ZhciBhdHRhY2htZW50X2lkcz10aGlzLnZhbHVlLnJlc19pZHM7aWYoZmlsZXMubGVuZ3RoPT09MCkKcmV0dXJuO18uZWFjaChmaWxlcyxmdW5jdGlvbihmaWxlKXt2YXIgcmVjb3JkPV8uZmluZChzZWxmLnZhbHVlLmRhdGEsZnVuY3Rpb24oYXR0YWNobWVudCl7cmV0dXJuIGF0dGFjaG1lbnQuZGF0YS5uYW1lPT09ZmlsZS5uYW1lO30pO2lmKHJlY29yZCl7dmFyIG1ldGFkYXRhPXNlbGYubWV0YWRhdGFbcmVjb3JkLmlkXTtpZighbWV0YWRhdGF8fG1ldGFkYXRhLmFsbG93VW5saW5rKXthdHRhY2htZW50X2lkcz1fLndpdGhvdXQoYXR0YWNobWVudF9pZHMscmVjb3JkLnJlc19pZCk7c2VsZi5fcnBjKHttb2RlbDonaXIuYXR0YWNobWVudCcsbWV0aG9kOid1bmxpbmsnLGFyZ3M6W3JlY29yZC5yZXNfaWRdLH0pO319CnNlbGYudXBsb2FkaW5nRmlsZXMucHVzaChmaWxlKTt9KTt0aGlzLl9zZXRWYWx1ZSh7b3BlcmF0aW9uOidSRVBMQUNFX1dJVEgnLGlkczphdHRhY2htZW50X2lkcyx9KTt0aGlzLiQoJ2Zvcm0ub19mb3JtX2JpbmFyeV9mb3JtJykuc3VibWl0KCk7dGhpcy4kKCcub2VfZmlsZXVwbG9hZCcpLmhpZGUoKTtldi50YXJnZXQudmFsdWU9IiI7fSxfb25GaWxlTG9hZGVkOmZ1bmN0aW9uKCl7dmFyIHNlbGY9dGhpczt2YXIgZmlsZXM9QXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpO3RoaXMudXBsb2FkaW5nRmlsZXM9W107dmFyIGF0dGFjaG1lbnRfaWRzPXRoaXMudmFsdWUucmVzX2lkcztfLmVhY2goZmlsZXMsZnVuY3Rpb24oZmlsZSl7aWYoZmlsZS5lcnJvcil7c2VsZi5kb193YXJuKF90KCdVcGxvYWRpbmcgRXJyb3InKSxmaWxlLmVycm9yKTt9ZWxzZXthdHRhY2htZW50X2lkcy5wdXNoKGZpbGUuaWQpO3NlbGYudXBsb2FkZWRGaWxlc1tmaWxlLmlkXT10cnVlO319KTt0aGlzLl9zZXRWYWx1ZSh7b3BlcmF0aW9uOidSRVBMQUNFX1dJVEgnLGlkczphdHRhY2htZW50X2lkcyx9KTt9LH0pO3ZhciBGaWVsZE1hbnkyTWFueVRhZ3M9QWJzdHJhY3RGaWVsZC5leHRlbmQoe2Rlc2NyaXB0aW9uOl9sdCgiVGFncyIpLHRhZ190ZW1wbGF0ZToiRmllbGRNYW55Mk1hbnlUYWciLGNsYXNzTmFtZToib19maWVsZF9tYW55Mm1hbnl0YWdzIixzdXBwb3J0ZWRGaWVsZFR5cGVzOlsnbWFueTJtYW55J10sY3VzdG9tX2V2ZW50czpfLmV4dGVuZCh7fSxBYnN0cmFjdEZpZWxkLnByb3RvdHlwZS5jdXN0b21fZXZlbnRzLHtmaWVsZF9jaGFuZ2VkOidfb25GaWVsZENoYW5nZWQnLH0pLGV2ZW50czpfLmV4dGVuZCh7fSxBYnN0cmFjdEZpZWxkLnByb3RvdHlwZS5ldmVudHMseydjbGljayAub19kZWxldGUnOidfb25EZWxldGVUYWcnLH0pLGZpZWxkc1RvRmV0Y2g6e2Rpc3BsYXlfbmFtZTp7dHlwZTonY2hhcid9LH0saW5pdDpmdW5jdGlvbigpe3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtpZih0aGlzLm1vZGU9PT0nZWRpdCcpe3RoaXMuY2xhc3NOYW1lKz0nIG9faW5wdXQnO30KdGhpcy5jb2xvckZpZWxkPXRoaXMubm9kZU9wdGlvbnMuY29sb3JfZmllbGQ7dGhpcy5oYXNEcm9wZG93bj1mYWxzZTt9LGFjdGl2YXRlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubWFueTJvbmU/dGhpcy5tYW55Mm9uZS5hY3RpdmF0ZSgpOmZhbHNlO30sZ2V0Rm9jdXNhYmxlRWxlbWVudDpmdW5jdGlvbigpe3JldHVybiB0aGlzLm1hbnkyb25lP3RoaXMubWFueTJvbmUuZ2V0Rm9jdXNhYmxlRWxlbWVudCgpOiQoKTt9LGlzU2V0OmZ1bmN0aW9uKCl7cmV0dXJuISF0aGlzLnZhbHVlJiZ0aGlzLnZhbHVlLmNvdW50O30scmVzZXQ6ZnVuY3Rpb24ocmVjb3JkLGV2ZW50KXt2YXIgc2VsZj10aGlzO3JldHVybiB0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cykudGhlbihmdW5jdGlvbigpe2lmKGV2ZW50JiZldmVudC50YXJnZXQ9PT1zZWxmKXtzZWxmLmFjdGl2YXRlKCk7fX0pO30sX2FkZFRhZzpmdW5jdGlvbihkYXRhKXtpZighXy5jb250YWlucyh0aGlzLnZhbHVlLnJlc19pZHMsZGF0YS5pZCkpe3RoaXMuX3NldFZhbHVlKHtvcGVyYXRpb246J0FERF9NMk0nLGlkczpkYXRhfSk7fX0sX2dldFJlbmRlclRhZ3NDb250ZXh0OmZ1bmN0aW9uKCl7dmFyIGVsZW1lbnRzPXRoaXMudmFsdWU/Xy5wbHVjayh0aGlzLnZhbHVlLmRhdGEsJ2RhdGEnKTpbXTtyZXR1cm57Y29sb3JGaWVsZDp0aGlzLmNvbG9yRmllbGQsZWxlbWVudHM6ZWxlbWVudHMsaGFzRHJvcGRvd246dGhpcy5oYXNEcm9wZG93bixyZWFkb25seTp0aGlzLm1vZGU9PT0icmVhZG9ubHkiLH07fSxfcmVtb3ZlVGFnOmZ1bmN0aW9uKGlkKXt2YXIgcmVjb3JkPV8uZmluZFdoZXJlKHRoaXMudmFsdWUuZGF0YSx7cmVzX2lkOmlkfSk7dGhpcy5fc2V0VmFsdWUoe29wZXJhdGlvbjonRk9SR0VUJyxpZHM6W3JlY29yZC5pZF0sfSk7fSxfcmVuZGVyRWRpdDpmdW5jdGlvbigpe3ZhciBzZWxmPXRoaXM7dGhpcy5fcmVuZGVyVGFncygpO2lmKHRoaXMubWFueTJvbmUpe3RoaXMubWFueTJvbmUuZGVzdHJveSgpO30KdGhpcy5tYW55Mm9uZT1uZXcgRmllbGRNYW55Mk9uZSh0aGlzLHRoaXMubmFtZSx0aGlzLnJlY29yZCx7bW9kZTonZWRpdCcsbm9PcGVuOnRydWUsdmlld1R5cGU6dGhpcy52aWV3VHlwZSxhdHRyczp0aGlzLmF0dHJzLH0pO3RoaXMubWFueTJvbmUudmFsdWU9ZmFsc2U7dGhpcy5tYW55Mm9uZS5tMm9fdmFsdWU9Jyc7dGhpcy5tYW55Mm9uZS5fZ2V0U2VhcmNoQmxhY2tsaXN0PWZ1bmN0aW9uKCl7cmV0dXJuIHNlbGYudmFsdWUucmVzX2lkczt9O3ZhciBfZ2V0U2VhcmNoQ3JlYXRlUG9wdXBPcHRpb25zPXRoaXMubWFueTJvbmUuX2dldFNlYXJjaENyZWF0ZVBvcHVwT3B0aW9uczt0aGlzLm1hbnkyb25lLl9nZXRTZWFyY2hDcmVhdGVQb3B1cE9wdGlvbnM9ZnVuY3Rpb24odmlldyxpZHMsY29udGV4dCxkeW5hbWljRmlsdGVycyl7dmFyIG9wdGlvbnM9X2dldFNlYXJjaENyZWF0ZVBvcHVwT3B0aW9ucy5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dmFyIGRvbWFpbj10aGlzLnJlY29yZC5nZXREb21haW4oe2ZpZWxkTmFtZTp0aGlzLm5hbWV9KTt2YXIgbTJtUmVjb3Jkcz1bXTtyZXR1cm4gXy5leHRlbmQoe30sb3B0aW9ucyx7ZG9tYWluOmRvbWFpbi5jb25jYXQoWyIhIixbImlkIiwiaW4iLHNlbGYudmFsdWUucmVzX2lkc11dKSxkaXNhYmxlX211bHRpcGxlX3NlbGVjdGlvbjpmYWxzZSxvbl9zZWxlY3RlZDpmdW5jdGlvbihyZWNvcmRzKXttMm1SZWNvcmRzLnB1c2goLi4ucmVjb3Jkcyk7fSxvbl9jbG9zZWQ6ZnVuY3Rpb24oKXtzZWxmLm1hbnkyb25lLnJlaW5pdGlhbGl6ZShtMm1SZWNvcmRzKTt9LH0pO307cmV0dXJuIHRoaXMubWFueTJvbmUuYXBwZW5kVG8odGhpcy4kZWwpO30sX3JlbmRlclJlYWRvbmx5OmZ1bmN0aW9uKCl7dGhpcy5fcmVuZGVyVGFncygpO30sX3JlbmRlclRhZ3M6ZnVuY3Rpb24oKXt0aGlzLiRlbC5odG1sKHF3ZWIucmVuZGVyKHRoaXMudGFnX3RlbXBsYXRlLHRoaXMuX2dldFJlbmRlclRhZ3NDb250ZXh0KCkpKTt9LF9vbkRlbGV0ZVRhZzpmdW5jdGlvbihldmVudCl7ZXZlbnQucHJldmVudERlZmF1bHQoKTtldmVudC5zdG9wUHJvcGFnYXRpb24oKTt0aGlzLl9yZW1vdmVUYWcoJChldmVudC50YXJnZXQpLnBhcmVudCgpLmRhdGEoJ2lkJykpO30sX29uRmllbGRDaGFuZ2VkOmZ1bmN0aW9uKGV2KXtpZihldi50YXJnZXQhPT10aGlzLm1hbnkyb25lKXtyZXR1cm47fQpldi5zdG9wUHJvcGFnYXRpb24oKTt2YXIgbmV3VmFsdWU9ZXYuZGF0YS5jaGFuZ2VzW3RoaXMubmFtZV07aWYobmV3VmFsdWUpe3RoaXMuX2FkZFRhZyhuZXdWYWx1ZSk7dGhpcy5tYW55Mm9uZS5yZWluaXRpYWxpemUoZmFsc2UpO319LF9vbktleWRvd246ZnVuY3Rpb24oZXYpe2lmKGV2LndoaWNoPT09JC51aS5rZXlDb2RlLkJBQ0tTUEFDRSYmdGhpcy4kKCdpbnB1dCcpLnZhbCgpPT09IiIpe3ZhciAkYmFkZ2VzPXRoaXMuJCgnLmJhZGdlJyk7aWYoJGJhZGdlcy5sZW5ndGgpe3RoaXMuX3JlbW92ZVRhZygkYmFkZ2VzLmxhc3QoKS5kYXRhKCdpZCcpKTtyZXR1cm47fX0KdGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO30sX29uUXVpY2tDcmVhdGU6ZnVuY3Rpb24oZXZlbnQpe3RoaXMuX3F1aWNrQ3JlYXRlKGV2ZW50LmRhdGEudmFsdWUpO30sfSk7dmFyIEZpZWxkTWFueTJNYW55VGFnc0F2YXRhcj1GaWVsZE1hbnkyTWFueVRhZ3MuZXh0ZW5kKHt0YWdfdGVtcGxhdGU6J0ZpZWxkTWFueTJNYW55VGFnQXZhdGFyJyxjbGFzc05hbWU6J29fZmllbGRfbWFueTJtYW55dGFncyBhdmF0YXInLF9nZXRSZW5kZXJUYWdzQ29udGV4dDpmdW5jdGlvbigpe3ZhciByZXN1bHQ9dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3Jlc3VsdC5hdmF0YXJNb2RlbD10aGlzLm5vZGVPcHRpb25zLmF2YXRhck1vZGVsfHx0aGlzLmZpZWxkLnJlbGF0aW9uO3Jlc3VsdC5hdmF0YXJGaWVsZD10aGlzLm5vZGVPcHRpb25zLmF2YXRhckZpZWxkfHwnaW1hZ2VfMTI4JztyZXR1cm4gcmVzdWx0O30sfSk7dmFyIEZvcm1GaWVsZE1hbnkyTWFueVRhZ3M9RmllbGRNYW55Mk1hbnlUYWdzLmV4dGVuZCh7ZXZlbnRzOl8uZXh0ZW5kKHt9LEZpZWxkTWFueTJNYW55VGFncy5wcm90b3R5cGUuZXZlbnRzLHsnY2xpY2sgLmRyb3Bkb3duLXRvZ2dsZSc6J19vbk9wZW5Db2xvclBpY2tlcicsJ21vdXNlZG93biAub19jb2xvcnBpY2tlciBhJzonX29uVXBkYXRlQ29sb3InLCdtb3VzZWRvd24gLm9fY29sb3JwaWNrZXIgLm9faGlkZV9pbl9rYW5iYW4nOidfb25VcGRhdGVDb2xvcicsfSksaW5pdDpmdW5jdGlvbigpe3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLmhhc0Ryb3Bkb3duPSEhdGhpcy5jb2xvckZpZWxkO30sX29uT3BlbkNvbG9yUGlja2VyOmZ1bmN0aW9uKGV2KXtldi5wcmV2ZW50RGVmYXVsdCgpO3ZhciB0YWdJRD0kKGV2LmN1cnJlbnRUYXJnZXQpLnBhcmVudCgpLmRhdGEoJ2lkJyk7dmFyIHRhZ0NvbG9yPSQoZXYuY3VycmVudFRhcmdldCkucGFyZW50KCkuZGF0YSgnY29sb3InKTt2YXIgdGFnPV8uZmluZFdoZXJlKHRoaXMudmFsdWUuZGF0YSx7cmVzX2lkOnRhZ0lEfSk7aWYodGFnJiZ0aGlzLmNvbG9yRmllbGQgaW4gdGFnLmRhdGEpe3RoaXMuJGNvbG9yX3BpY2tlcj0kKHF3ZWIucmVuZGVyKCdGaWVsZE1hbnkyTWFueVRhZy5jb2xvcnBpY2tlcicseyd3aWRnZXQnOnRoaXMsJ3RhZ19pZCc6dGFnSUQsfSkpOyQoZXYuY3VycmVudFRhcmdldCkuYWZ0ZXIodGhpcy4kY29sb3JfcGlja2VyKTt0aGlzLiRjb2xvcl9waWNrZXIuZHJvcGRvd24oKTt0aGlzLiRjb2xvcl9waWNrZXIuYXR0cigidGFiaW5kZXgiLDEpLmZvY3VzKCk7aWYoIXRhZ0NvbG9yKXt0aGlzLiQoJy5jdXN0b20tY2hlY2tib3ggaW5wdXQnKS5wcm9wKCdjaGVja2VkJyx0cnVlKTt9fX0sX29uVXBkYXRlQ29sb3I6ZnVuY3Rpb24oZXYpe2V2LnByZXZlbnREZWZhdWx0KCk7dmFyICR0YXJnZXQ9JChldi5jdXJyZW50VGFyZ2V0KTt2YXIgY29sb3I9JHRhcmdldC5kYXRhKCdjb2xvcicpO3ZhciBpZD0kdGFyZ2V0LmRhdGEoJ2lkJyk7dmFyICR0YWc9dGhpcy4kKCIuYmFkZ2VbZGF0YS1pZD0nIitpZCsiJ10iKTt2YXIgY3VycmVudENvbG9yPSR0YWcuZGF0YSgnY29sb3InKTt2YXIgY2hhbmdlcz17fTtpZigkdGFyZ2V0LmlzKCcub19oaWRlX2luX2thbmJhbicpKXt2YXIgJGNoZWNrYm94PSQoJy5vX2hpZGVfaW5fa2FuYmFuIC5jdXN0b20tY2hlY2tib3ggaW5wdXQnKTskY2hlY2tib3gucHJvcCgnY2hlY2tlZCcsISRjaGVja2JveC5wcm9wKCdjaGVja2VkJykpO3RoaXMucHJldkNvbG9ycz10aGlzLnByZXZDb2xvcnM/dGhpcy5wcmV2Q29sb3JzOnt9O2lmKCRjaGVja2JveC5pcygnOmNoZWNrZWQnKSl7dGhpcy5wcmV2Q29sb3JzW2lkXT1jdXJyZW50Q29sb3I7fWVsc2V7Y29sb3I9dGhpcy5wcmV2Q29sb3JzW2lkXT90aGlzLnByZXZDb2xvcnNbaWRdOjE7fX1lbHNlIGlmKCR0YXJnZXQuaXMoJ1tjbGFzc149Im9fdGFnX2NvbG9yIl0nKSl7aWYoY29sb3I9PT1jdXJyZW50Q29sb3Ipe3JldHVybjt9fQpjaGFuZ2VzW3RoaXMuY29sb3JGaWVsZF09Y29sb3I7dGhpcy50cmlnZ2VyX3VwKCdmaWVsZF9jaGFuZ2VkJyx7ZGF0YVBvaW50SUQ6Xy5maW5kV2hlcmUodGhpcy52YWx1ZS5kYXRhLHtyZXNfaWQ6aWR9KS5pZCxjaGFuZ2VzOmNoYW5nZXMsZm9yY2Vfc2F2ZTp0cnVlLH0pO30sfSk7dmFyIEthbmJhbkZpZWxkTWFueTJNYW55VGFncz1GaWVsZE1hbnkyTWFueVRhZ3MuZXh0ZW5kKHtldmVudHM6QWJzdHJhY3RGaWVsZC5wcm90b3R5cGUuZXZlbnRzLF9yZW5kZXI6ZnVuY3Rpb24oKXt2YXIgc2VsZj10aGlzO3RoaXMuJGVsLmVtcHR5KCkuYWRkQ2xhc3MoJ29fZmllbGRfbWFueTJtYW55dGFncyBvX2thbmJhbl90YWdzJyk7Xy5lYWNoKHRoaXMudmFsdWUuZGF0YSxmdW5jdGlvbihtMm0pe2lmKHNlbGYuY29sb3JGaWVsZCBpbiBtMm0uZGF0YSYmIW0ybS5kYXRhW3NlbGYuY29sb3JGaWVsZF0pe3JldHVybjt9CiQoJzxzcGFuPicse2NsYXNzOidvX3RhZyBvX3RhZ19jb2xvcl8nKyhtMm0uZGF0YVtzZWxmLmNvbG9yRmllbGRdfHwwKSx0ZXh0Om0ybS5kYXRhLmRpc3BsYXlfbmFtZSx9KS5wcmVwZW5kKCc8c3Bhbj4nKS5hcHBlbmRUbyhzZWxmLiRlbCk7fSk7fSx9KTt2YXIgRmllbGRNYW55Mk1hbnlDaGVja0JveGVzPUFic3RyYWN0RmllbGQuZXh0ZW5kKHtkZXNjcmlwdGlvbjpfbHQoIkNoZWNrYm94ZXMiKSx0ZW1wbGF0ZTonRmllbGRNYW55Mk1hbnlDaGVja0JveGVzJyxldmVudHM6Xy5leHRlbmQoe30sQWJzdHJhY3RGaWVsZC5wcm90b3R5cGUuZXZlbnRzLHtjaGFuZ2U6J19vbkNoYW5nZScsfSksc3BlY2lhbERhdGE6Il9mZXRjaFNwZWNpYWxSZWxhdGlvbiIsc3VwcG9ydGVkRmllbGRUeXBlczpbJ21hbnkybWFueSddLGluaXQ6ZnVuY3Rpb24oKXt0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy5tMm1WYWx1ZXM9dGhpcy5yZWNvcmQuc3BlY2lhbERhdGFbdGhpcy5uYW1lXTt9LGlzU2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRydWU7fSxfcmVuZGVyOmZ1bmN0aW9uKCl7dmFyIHNlbGY9dGhpczt0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7Xy5lYWNoKHRoaXMudmFsdWUucmVzX2lkcyxmdW5jdGlvbihpZCl7c2VsZi4kKCdpbnB1dFtkYXRhLXJlY29yZC1pZD0iJytpZCsnIl0nKS5wcm9wKCdjaGVja2VkJyx0cnVlKTt9KTt9LF9yZW5kZXJSZWFkb25seTpmdW5jdGlvbigpe3RoaXMuJCgiaW5wdXQiKS5wcm9wKCJkaXNhYmxlZCIsdHJ1ZSk7fSxfb25DaGFuZ2U6ZnVuY3Rpb24oKXt2YXIgaWRzPV8ubWFwKHRoaXMuJCgnaW5wdXQ6Y2hlY2tlZCcpLGZ1bmN0aW9uKGlucHV0KXtyZXR1cm4gJChpbnB1dCkuZGF0YSgicmVjb3JkLWlkIik7fSk7dGhpcy5fc2V0VmFsdWUoe29wZXJhdGlvbjonUkVQTEFDRV9XSVRIJyxpZHM6aWRzLH0pO30sfSk7dmFyIEZpZWxkU3RhdHVzPUFic3RyYWN0RmllbGQuZXh0ZW5kKHtjbGFzc05hbWU6J29fc3RhdHVzYmFyX3N0YXR1cycsZXZlbnRzOnsnY2xpY2sgYnV0dG9uOm5vdCguZHJvcGRvd24tdG9nZ2xlKSc6J19vbkNsaWNrU3RhZ2UnLH0sc3BlY2lhbERhdGE6Il9mZXRjaFNwZWNpYWxTdGF0dXMiLHN1cHBvcnRlZEZpZWxkVHlwZXM6WydzZWxlY3Rpb24nLCdtYW55Mm9uZSddLGluaXQ6ZnVuY3Rpb24oKXt0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy5fc2V0U3RhdGUoKTt0aGlzLl9vbkNsaWNrU3RhZ2U9Xy5kZWJvdW5jZSh0aGlzLl9vbkNsaWNrU3RhZ2UsMzAwLHRydWUpO3RoaXMuaXNDbGlja2FibGU9ISF0aGlzLmF0dHJzLmNsaWNrYWJsZXx8ISF0aGlzLm5vZGVPcHRpb25zLmNsaWNrYWJsZTt9LF9yZXNldDpmdW5jdGlvbigpe3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLl9zZXRTdGF0ZSgpO30sX3NldFN0YXRlOmZ1bmN0aW9uKCl7dmFyIHNlbGY9dGhpcztpZih0aGlzLmZpZWxkLnR5cGU9PT0nbWFueTJvbmUnKXt0aGlzLnN0YXR1c19pbmZvcm1hdGlvbj1fLm1hcCh0aGlzLnJlY29yZC5zcGVjaWFsRGF0YVt0aGlzLm5hbWVdLGZ1bmN0aW9uKGluZm8pe3JldHVybiBfLmV4dGVuZCh7c2VsZWN0ZWQ6aW5mby5pZD09PXNlbGYudmFsdWUucmVzX2lkLH0saW5mbyk7fSk7fWVsc2V7dmFyIHNlbGVjdGlvbj10aGlzLmZpZWxkLnNlbGVjdGlvbjtpZih0aGlzLmF0dHJzLnN0YXR1c2Jhcl92aXNpYmxlKXt2YXIgcmVzdHJpY3Rpb249dGhpcy5hdHRycy5zdGF0dXNiYXJfdmlzaWJsZS5zcGxpdCgiLCIpO3NlbGVjdGlvbj1fLmZpbHRlcihzZWxlY3Rpb24sZnVuY3Rpb24odmFsKXtyZXR1cm4gXy5jb250YWlucyhyZXN0cmljdGlvbix2YWxbMF0pfHx2YWxbMF09PT1zZWxmLnZhbHVlO30pO30KdGhpcy5zdGF0dXNfaW5mb3JtYXRpb249Xy5tYXAoc2VsZWN0aW9uLGZ1bmN0aW9uKHZhbCl7cmV0dXJue2lkOnZhbFswXSxkaXNwbGF5X25hbWU6dmFsWzFdLHNlbGVjdGVkOnZhbFswXT09PXNlbGYudmFsdWUsZm9sZDpmYWxzZX07fSk7fX0sX3JlbmRlcjpmdW5jdGlvbigpe3ZhciBzZWxlY3Rpb25zPV8ucGFydGl0aW9uKHRoaXMuc3RhdHVzX2luZm9ybWF0aW9uLGZ1bmN0aW9uKGluZm8pe3JldHVybihpbmZvLnNlbGVjdGVkfHwhaW5mby5mb2xkKTt9KTt0aGlzLiRlbC5odG1sKHF3ZWIucmVuZGVyKCJGaWVsZFN0YXR1cy5jb250ZW50Iix7c2VsZWN0aW9uX3VuZm9sZGVkOnNlbGVjdGlvbnNbMF0sc2VsZWN0aW9uX2ZvbGRlZDpzZWxlY3Rpb25zWzFdLGNsaWNrYWJsZTp0aGlzLmlzQ2xpY2thYmxlLH0pKTt9LF9vbkNsaWNrU3RhZ2U6ZnVuY3Rpb24oZSl7dGhpcy5fc2V0VmFsdWUoJChlLmN1cnJlbnRUYXJnZXQpLmRhdGEoInZhbHVlIikpO30sfSk7dmFyIEZpZWxkU2VsZWN0aW9uPUFic3RyYWN0RmllbGQuZXh0ZW5kKHtkZXNjcmlwdGlvbjpfbHQoIlNlbGVjdGlvbiIpLHRlbXBsYXRlOidGaWVsZFNlbGVjdGlvbicsc3BlY2lhbERhdGE6Il9mZXRjaFNwZWNpYWxSZWxhdGlvbiIsc3VwcG9ydGVkRmllbGRUeXBlczpbJ3NlbGVjdGlvbiddLGV2ZW50czpfLmV4dGVuZCh7fSxBYnN0cmFjdEZpZWxkLnByb3RvdHlwZS5ldmVudHMseydjaGFuZ2UnOidfb25DaGFuZ2UnLH0pLGluaXQ6ZnVuY3Rpb24oKXt0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy5fc2V0VmFsdWVzKCk7fSxnZXRGb2N1c2FibGVFbGVtZW50OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuJGVsLmlzKCdzZWxlY3QnKT90aGlzLiRlbDokKCk7fSxpc1NldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnZhbHVlIT09ZmFsc2U7fSx1cGRhdGVNb2RpZmllcnNWYWx1ZTpmdW5jdGlvbigpe3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtpZighdGhpcy5hdHRycy5tb2RpZmllcnNWYWx1ZS5pbnZpc2libGUmJnRoaXMubW9kZSE9PSdyZWFkb25seScpe3RoaXMuX3NldFZhbHVlcygpO3RoaXMuX3JlbmRlckVkaXQoKTt9fSxfcmVuZGVyRWRpdDpmdW5jdGlvbigpe3RoaXMuJGVsLmVtcHR5KCk7dmFyIHJlcXVpcmVkPXRoaXMuYXR0cnMubW9kaWZpZXJzVmFsdWUmJnRoaXMuYXR0cnMubW9kaWZpZXJzVmFsdWUucmVxdWlyZWQ7Zm9yKHZhciBpPTA7aTx0aGlzLnZhbHVlcy5sZW5ndGg7aSsrKXt2YXIgZGlzYWJsZWQ9cmVxdWlyZWQmJnRoaXMudmFsdWVzW2ldWzBdPT09ZmFsc2U7dGhpcy4kZWwuYXBwZW5kKCQoJzxvcHRpb24vPicse3ZhbHVlOkpTT04uc3RyaW5naWZ5KHRoaXMudmFsdWVzW2ldWzBdKSx0ZXh0OnRoaXMudmFsdWVzW2ldWzFdLHN0eWxlOmRpc2FibGVkPyJkaXNwbGF5OiBub25lIjoiIix9KSk7fQp2YXIgdmFsdWU9dGhpcy52YWx1ZTtpZih0aGlzLmZpZWxkLnR5cGU9PT0nbWFueTJvbmUnJiZ2YWx1ZSl7dmFsdWU9dmFsdWUuZGF0YS5pZDt9CnRoaXMuJGVsLnZhbChKU09OLnN0cmluZ2lmeSh2YWx1ZSkpO30sX3JlbmRlclJlYWRvbmx5OmZ1bmN0aW9uKCl7dGhpcy4kZWwuZW1wdHkoKS50ZXh0KHRoaXMuX2Zvcm1hdFZhbHVlKHRoaXMudmFsdWUpKTt9LF9yZXNldDpmdW5jdGlvbigpe3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLl9zZXRWYWx1ZXMoKTt9LF9zZXRWYWx1ZXM6ZnVuY3Rpb24oKXtpZih0aGlzLmZpZWxkLnR5cGU9PT0nbWFueTJvbmUnKXt0aGlzLnZhbHVlcz10aGlzLnJlY29yZC5zcGVjaWFsRGF0YVt0aGlzLm5hbWVdO3RoaXMuZm9ybWF0VHlwZT0nbWFueTJvbmUnO31lbHNle3RoaXMudmFsdWVzPV8ucmVqZWN0KHRoaXMuZmllbGQuc2VsZWN0aW9uLGZ1bmN0aW9uKHYpe3JldHVybiB2WzBdPT09ZmFsc2UmJnZbMV09PT0nJzt9KTt9CnRoaXMudmFsdWVzPVtbZmFsc2UsdGhpcy5hdHRycy5wbGFjZWhvbGRlcnx8JyddXS5jb25jYXQodGhpcy52YWx1ZXMpO30sX29uQ2hhbmdlOmZ1bmN0aW9uKCl7dmFyIHJlc19pZD1KU09OLnBhcnNlKHRoaXMuJGVsLnZhbCgpKTtpZih0aGlzLmZpZWxkLnR5cGU9PT0nbWFueTJvbmUnKXt2YXIgdmFsdWU9Xy5maW5kKHRoaXMudmFsdWVzLGZ1bmN0aW9uKHZhbCl7cmV0dXJuIHZhbFswXT09PXJlc19pZDt9KTt0aGlzLl9zZXRWYWx1ZSh7aWQ6cmVzX2lkLGRpc3BsYXlfbmFtZTp2YWx1ZVsxXX0pO31lbHNle3RoaXMuX3NldFZhbHVlKHJlc19pZCk7fX0sfSk7dmFyIEZpZWxkUmFkaW89RmllbGRTZWxlY3Rpb24uZXh0ZW5kKHtkZXNjcmlwdGlvbjpfbHQoIlJhZGlvIiksdGVtcGxhdGU6bnVsbCxjbGFzc05hbWU6J29fZmllbGRfcmFkaW8nLHRhZ05hbWU6J3NwYW4nLHNwZWNpYWxEYXRhOiJfZmV0Y2hTcGVjaWFsTWFueTJvbmVzIixzdXBwb3J0ZWRGaWVsZFR5cGVzOlsnc2VsZWN0aW9uJywnbWFueTJvbmUnXSxldmVudHM6Xy5leHRlbmQoe30sQWJzdHJhY3RGaWVsZC5wcm90b3R5cGUuZXZlbnRzLHsnY2xpY2sgaW5wdXQnOidfb25JbnB1dENsaWNrJyx9KSxpbml0OmZ1bmN0aW9uKCl7dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO2lmKHRoaXMubW9kZT09PSdlZGl0Jyl7dGhpcy50YWdOYW1lPSdkaXYnO3RoaXMuY2xhc3NOYW1lKz10aGlzLm5vZGVPcHRpb25zLmhvcml6b250YWw/JyBvX2hvcml6b250YWwnOicgb192ZXJ0aWNhbCc7fQp0aGlzLnVuaXF1ZV9pZD1fLnVuaXF1ZUlkKCJyYWRpbyIpO3RoaXMuX3NldFZhbHVlcygpO30saXNTZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdHJ1ZTt9LF9yZW5kZXJFZGl0OmZ1bmN0aW9uKCl7dmFyIHNlbGY9dGhpczt2YXIgY3VycmVudFZhbHVlO2lmKHRoaXMuZmllbGQudHlwZT09PSdtYW55Mm9uZScpe2N1cnJlbnRWYWx1ZT10aGlzLnZhbHVlJiZ0aGlzLnZhbHVlLmRhdGEuaWQ7fWVsc2V7Y3VycmVudFZhbHVlPXRoaXMudmFsdWU7fQp0aGlzLiRlbC5lbXB0eSgpO18uZWFjaCh0aGlzLnZhbHVlcyxmdW5jdGlvbih2YWx1ZSxpbmRleCl7c2VsZi4kZWwuYXBwZW5kKHF3ZWIucmVuZGVyKCdGaWVsZFJhZGlvLmJ1dHRvbicse2NoZWNrZWQ6dmFsdWVbMF09PT1jdXJyZW50VmFsdWUsaWQ6c2VsZi51bmlxdWVfaWQrJ18nK3ZhbHVlWzBdLGluZGV4OmluZGV4LHZhbHVlOnZhbHVlLH0pKTt9KTt9LF9yZXNldDpmdW5jdGlvbigpe3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLl9zZXRWYWx1ZXMoKTt9LF9zZXRWYWx1ZXM6ZnVuY3Rpb24oKXtpZih0aGlzLmZpZWxkLnR5cGU9PT0nc2VsZWN0aW9uJyl7dGhpcy52YWx1ZXM9dGhpcy5maWVsZC5zZWxlY3Rpb258fFtdO31lbHNlIGlmKHRoaXMuZmllbGQudHlwZT09PSdtYW55Mm9uZScpe3RoaXMudmFsdWVzPV8ubWFwKHRoaXMucmVjb3JkLnNwZWNpYWxEYXRhW3RoaXMubmFtZV0sZnVuY3Rpb24odmFsKXtyZXR1cm5bdmFsLmlkLHZhbC5kaXNwbGF5X25hbWVdO30pO319LF9vbklucHV0Q2xpY2s6ZnVuY3Rpb24oZXZlbnQpe3ZhciBpbmRleD0kKGV2ZW50LnRhcmdldCkuZGF0YSgnaW5kZXgnKTt2YXIgdmFsdWU9dGhpcy52YWx1ZXNbaW5kZXhdO2lmKHRoaXMuZmllbGQudHlwZT09PSdtYW55Mm9uZScpe3RoaXMuX3NldFZhbHVlKHtpZDp2YWx1ZVswXSxkaXNwbGF5X25hbWU6dmFsdWVbMV19KTt9ZWxzZXt0aGlzLl9zZXRWYWx1ZSh2YWx1ZVswXSk7fX0sfSk7dmFyIEZpZWxkU2VsZWN0aW9uQmFkZ2U9RmllbGRTZWxlY3Rpb24uZXh0ZW5kKHtkZXNjcmlwdGlvbjpfbHQoIkJhZGdlcyIpLHRlbXBsYXRlOm51bGwsY2xhc3NOYW1lOidvX2ZpZWxkX3NlbGVjdGlvbl9iYWRnZScsdGFnTmFtZTonc3Bhbicsc3BlY2lhbERhdGE6Il9mZXRjaFNwZWNpYWxNYW55Mm9uZXMiLGV2ZW50czpfLmV4dGVuZCh7fSxBYnN0cmFjdEZpZWxkLnByb3RvdHlwZS5ldmVudHMseydjbGljayBzcGFuLm9fc2VsZWN0aW9uX2JhZGdlJzonX29uQmFkZ2VDbGlja2VkJyx9KSxfcmVuZGVyRWRpdDpmdW5jdGlvbigpe3RoaXMuY3VycmVudFZhbHVlPXRoaXMudmFsdWU7aWYodGhpcy5maWVsZC50eXBlPT09J21hbnkyb25lJyl7dGhpcy5jdXJyZW50VmFsdWU9dGhpcy52YWx1ZSYmdGhpcy52YWx1ZS5kYXRhLmlkO30KdGhpcy4kZWwuZW1wdHkoKTt0aGlzLiRlbC5odG1sKHF3ZWIucmVuZGVyKCdGaWVsZFNlbGVjdGlvbkJhZGdlJyx7J3ZhbHVlcyc6dGhpcy52YWx1ZXMsJ2N1cnJlbnRfdmFsdWUnOnRoaXMuY3VycmVudFZhbHVlfSkpO30sX3NldFZhbHVlczpmdW5jdGlvbigpe2lmKHRoaXMuZmllbGQudHlwZT09PSdzZWxlY3Rpb24nKXt0aGlzLnZhbHVlcz10aGlzLmZpZWxkLnNlbGVjdGlvbnx8W107fWVsc2UgaWYodGhpcy5maWVsZC50eXBlPT09J21hbnkyb25lJyl7dGhpcy52YWx1ZXM9Xy5tYXAodGhpcy5yZWNvcmQuc3BlY2lhbERhdGFbdGhpcy5uYW1lXSxmdW5jdGlvbih2YWwpe3JldHVyblt2YWwuaWQsdmFsLmRpc3BsYXlfbmFtZV07fSk7fX0sX29uQmFkZ2VDbGlja2VkOmZ1bmN0aW9uKGV2ZW50KXt2YXIgaW5kZXg9JChldmVudC50YXJnZXQpLmRhdGEoJ2luZGV4Jyk7dmFyIHZhbHVlPXRoaXMudmFsdWVzW2luZGV4XTtpZih2YWx1ZVswXSE9PXRoaXMuY3VycmVudFZhbHVlKXtpZih0aGlzLmZpZWxkLnR5cGU9PT0nbWFueTJvbmUnKXt0aGlzLl9zZXRWYWx1ZSh7aWQ6dmFsdWVbMF0sZGlzcGxheV9uYW1lOnZhbHVlWzFdfSk7fWVsc2V7dGhpcy5fc2V0VmFsdWUodmFsdWVbMF0pO319ZWxzZXt0aGlzLl9zZXRWYWx1ZShmYWxzZSk7fX0sfSk7dmFyIEZpZWxkU2VsZWN0aW9uRm9udD1GaWVsZFNlbGVjdGlvbi5leHRlbmQoe19yZW5kZXJFZGl0OmZ1bmN0aW9uKCl7dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3RoaXMuJCgnb3B0aW9uJykuZWFjaChmdW5jdGlvbihpLG9wdGlvbil7aWYoIW9wdGlvbi5sYWJlbCl7JChvcHRpb24pLnJlbW92ZSgpO30KJChvcHRpb24pLmNzcygnZm9udC1mYW1pbHknLG9wdGlvbi52YWx1ZSk7fSk7dGhpcy4kZWwuY3NzKCdmb250LWZhbWlseScsdGhpcy52YWx1ZSk7fSx9KTt2YXIgRmllbGRSZWZlcmVuY2U9RmllbGRNYW55Mk9uZS5leHRlbmQoe3NwZWNpYWxEYXRhOiJfZmV0Y2hTcGVjaWFsUmVmZXJlbmNlIixzdXBwb3J0ZWRGaWVsZFR5cGVzOlsncmVmZXJlbmNlJ10sdGVtcGxhdGU6J0ZpZWxkUmVmZXJlbmNlJyxldmVudHM6Xy5leHRlbmQoe30sRmllbGRNYW55Mk9uZS5wcm90b3R5cGUuZXZlbnRzLHsnY2hhbmdlIHNlbGVjdCc6J19vblNlbGVjdGlvbkNoYW5nZScsfSksaW5pdDpmdW5jdGlvbigpe3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLmZpZWxkPV8uZXh0ZW5kKHt9LHRoaXMuZmllbGQpO3RoaXMuX3NldFN0YXRlKCk7fSxzdGFydDpmdW5jdGlvbigpe3RoaXMuJCgnc2VsZWN0JykudmFsKHRoaXMuZmllbGQucmVsYXRpb24pO3JldHVybiB0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fSxnZXRGb2N1c2FibGVFbGVtZW50OmZ1bmN0aW9uKCl7aWYodGhpcy5tb2RlPT09J2VkaXQnJiYhdGhpcy5maWVsZC5yZWxhdGlvbil7cmV0dXJuIHRoaXMuJCgnc2VsZWN0Jyk7fQpyZXR1cm4gdGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO30sX2Zvcm1hdFZhbHVlOmZ1bmN0aW9uKCl7dmFyIHZhbHVlO2lmKHRoaXMuZmllbGQudHlwZT09PSdjaGFyJyl7dmFsdWU9dGhpcy5yZWNvcmQuc3BlY2lhbERhdGFbdGhpcy5uYW1lXTt9ZWxzZXt2YWx1ZT10aGlzLnZhbHVlO30KcmV0dXJuIHZhbHVlJiZ2YWx1ZS5kYXRhJiZ2YWx1ZS5kYXRhLmRpc3BsYXlfbmFtZXx8Jyc7fSxfcmVuZGVyRWRpdDpmdW5jdGlvbigpe3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtpZih0aGlzLiQoJ3NlbGVjdCcpLnZhbCgpKXt0aGlzLiQoJy5vX2lucHV0X2Ryb3Bkb3duJykuc2hvdygpO3RoaXMuJGVsLmFkZENsYXNzKCdvX3JvdycpO31lbHNle3RoaXMuJCgnLm9faW5wdXRfZHJvcGRvd24nKS5oaWRlKCk7fX0sX3Jlc2V0OmZ1bmN0aW9uKCl7dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3ZhciB2YWx1ZT10aGlzLiQoJ3NlbGVjdCcpLnZhbCgpO3RoaXMuX3NldFN0YXRlKCk7dGhpcy4kKCdzZWxlY3QnKS52YWwodGhpcy52YWx1ZSYmdGhpcy52YWx1ZS5tb2RlbHx8dmFsdWUpO30sX3NldFJlbGF0aW9uOmZ1bmN0aW9uKG1vZGVsKXt0aGlzLmZpZWxkLnJlbGF0aW9uPW1vZGVsO30sX3NldFN0YXRlOmZ1bmN0aW9uKCl7aWYodGhpcy5maWVsZC50eXBlPT09J2NoYXInKXt0aGlzLnZhbHVlPXRoaXMucmVjb3JkLnNwZWNpYWxEYXRhW3RoaXMubmFtZV07fQppZih0aGlzLnZhbHVlKXt0aGlzLl9zZXRSZWxhdGlvbih0aGlzLnZhbHVlLm1vZGVsKTt9fSxfc2V0VmFsdWU6ZnVuY3Rpb24odmFsdWUsb3B0aW9ucyl7dmFsdWU9dmFsdWV8fHt9O3ZhbHVlLm1vZGVsPXRoaXMuJCgnc2VsZWN0JykudmFsKCk7cmV0dXJuIHRoaXMuX3N1cGVyKHZhbHVlLG9wdGlvbnMpO30sX29uU2VsZWN0aW9uQ2hhbmdlOmZ1bmN0aW9uKCl7dmFyIHZhbHVlPXRoaXMuJCgnc2VsZWN0JykudmFsKCk7dGhpcy5yZWluaXRpYWxpemUoZmFsc2UpO3RoaXMuX3NldFJlbGF0aW9uKHZhbHVlKTt9LH0pO3JldHVybntGaWVsZE1hbnkyT25lOkZpZWxkTWFueTJPbmUsTWFueTJvbmVCYXJjb2RlOk1hbnkyb25lQmFyY29kZSxLYW5iYW5GaWVsZE1hbnkyT25lOkthbmJhbkZpZWxkTWFueTJPbmUsTGlzdEZpZWxkTWFueTJPbmU6TGlzdEZpZWxkTWFueTJPbmUsRmllbGRYMk1hbnk6RmllbGRYMk1hbnksRmllbGRPbmUyTWFueTpGaWVsZE9uZTJNYW55LEZpZWxkTWFueTJNYW55OkZpZWxkTWFueTJNYW55LEZpZWxkTWFueTJNYW55QmluYXJ5TXVsdGlGaWxlczpGaWVsZE1hbnkyTWFueUJpbmFyeU11bHRpRmlsZXMsRmllbGRNYW55Mk1hbnlDaGVja0JveGVzOkZpZWxkTWFueTJNYW55Q2hlY2tCb3hlcyxGaWVsZE1hbnkyTWFueVRhZ3M6RmllbGRNYW55Mk1hbnlUYWdzLEZpZWxkTWFueTJNYW55VGFnc0F2YXRhcjpGaWVsZE1hbnkyTWFueVRhZ3NBdmF0YXIsRm9ybUZpZWxkTWFueTJNYW55VGFnczpGb3JtRmllbGRNYW55Mk1hbnlUYWdzLEthbmJhbkZpZWxkTWFueTJNYW55VGFnczpLYW5iYW5GaWVsZE1hbnkyTWFueVRhZ3MsRmllbGRSYWRpbzpGaWVsZFJhZGlvLEZpZWxkU2VsZWN0aW9uQmFkZ2U6RmllbGRTZWxlY3Rpb25CYWRnZSxGaWVsZFNlbGVjdGlvbjpGaWVsZFNlbGVjdGlvbixGaWVsZFN0YXR1czpGaWVsZFN0YXR1cyxGaWVsZFNlbGVjdGlvbkZvbnQ6RmllbGRTZWxlY3Rpb25Gb250LEZpZWxkUmVmZXJlbmNlOkZpZWxkUmVmZXJlbmNlLH07fSk7OwoKLyogL3dlYi9zdGF0aWMvc3JjL2pzL2ZpZWxkcy9zcGVjaWFsX2ZpZWxkcy5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwpvZG9vLmRlZmluZSgnd2ViLnNwZWNpYWxfZmllbGRzJyxmdW5jdGlvbihyZXF1aXJlKXsidXNlIHN0cmljdCI7dmFyIGNvcmU9cmVxdWlyZSgnd2ViLmNvcmUnKTt2YXIgZmllbGRfdXRpbHM9cmVxdWlyZSgnd2ViLmZpZWxkX3V0aWxzJyk7dmFyIHJlbGF0aW9uYWxfZmllbGRzPXJlcXVpcmUoJ3dlYi5yZWxhdGlvbmFsX2ZpZWxkcycpO3ZhciBGaWVsZFNlbGVjdGlvbj1yZWxhdGlvbmFsX2ZpZWxkcy5GaWVsZFNlbGVjdGlvbjt2YXIgX3Q9Y29yZS5fdDt2YXIgRmllbGRUaW1lem9uZU1pc21hdGNoPUZpZWxkU2VsZWN0aW9uLmV4dGVuZCh7c3RhcnQ6ZnVuY3Rpb24oKXt2YXIgaW50ZXJ2YWw9bmF2aWdhdG9yLnBsYXRmb3JtLnRvVXBwZXJDYXNlKCkuaW5kZXhPZignTUFDJyk+PTA/NjAwMDA6MTAwMDt0aGlzLl9kYXRldGltZT1zZXRJbnRlcnZhbCh0aGlzLl9yZW5kZXJEYXRlVGltZVRpbWV6b25lLmJpbmQodGhpcyksaW50ZXJ2YWwpO3JldHVybiB0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fSxkZXN0cm95OmZ1bmN0aW9uKCl7Y2xlYXJJbnRlcnZhbCh0aGlzLl9kYXRldGltZSk7cmV0dXJuIHRoaXMuX3N1cGVyKCk7fSxfcmVuZGVyOmZ1bmN0aW9uKCl7dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3RoaXMuX3JlbmRlclRpbWV6b25lTWlzbWF0Y2goKTt9LF9yZW5kZXJEYXRlVGltZVRpbWV6b25lOmZ1bmN0aW9uKCl7aWYoIXRoaXMubWlzbWF0Y2h8fCF0aGlzLiRvcHRpb24uaHRtbCgpKXtyZXR1cm47fQp2YXIgb2Zmc2V0PXRoaXMucmVjb3JkRGF0YS50el9vZmZzZXQubWF0Y2goLyhbKy1dKShbMC05XXsyfSkoWzAtOV17Mn0pLyk7b2Zmc2V0PShvZmZzZXRbMV09PT0nLSc/LTE6MSkqKHBhcnNlSW50KG9mZnNldFsyXSkqNjArcGFyc2VJbnQob2Zmc2V0WzNdKSk7dmFyIGRhdGV0aW1lPWZpZWxkX3V0aWxzLmZvcm1hdC5kYXRldGltZShtb21lbnQudXRjKCkuYWRkKG9mZnNldCwnbWludXRlcycpLHRoaXMuZmllbGQse3RpbWV6b25lOmZhbHNlfSk7dmFyIGNvbnRlbnQ9dGhpcy4kb3B0aW9uLmh0bWwoKS5zcGxpdCgnICcpWzBdO2NvbnRlbnQrPScgICAgKCcrZGF0ZXRpbWUrJyknO3RoaXMuJG9wdGlvbi5odG1sKGNvbnRlbnQpO30sX3JlbmRlclRpbWV6b25lTWlzbWF0Y2g6ZnVuY3Rpb24oKXt0aGlzLiRlbC5sYXN0KCkuZmlsdGVyKCcub190el93YXJuaW5nJykucmVtb3ZlKCk7dGhpcy4kZWw9dGhpcy4kZWwuZmlyc3QoKTt2YXIgdmFsdWU9dGhpcy4kZWwudmFsKCk7dmFyICRzcGFuPSQoJzxzcGFuIGNsYXNzPSJmYSBmYS1leGNsYW1hdGlvbi10cmlhbmdsZSBvX3R6X3dhcm5pbmciLz4nKTtpZih0aGlzLiRvcHRpb24mJnRoaXMuJG9wdGlvbi5odG1sKCkpe3RoaXMuJG9wdGlvbi5odG1sKHRoaXMuJG9wdGlvbi5odG1sKCkuc3BsaXQoJyAnKVswXSk7fQp2YXIgdXNlck9mZnNldD10aGlzLnJlY29yZERhdGEudHpfb2Zmc2V0O3RoaXMubWlzbWF0Y2g9ZmFsc2U7aWYodXNlck9mZnNldCYmdmFsdWUhPT0iIiYmdmFsdWUhPT0iZmFsc2UiKXt2YXIgb2Zmc2V0PS0obmV3IERhdGUoKS5nZXRUaW1lem9uZU9mZnNldCgpKTt2YXIgYnJvd3Nlck9mZnNldD0ob2Zmc2V0PDApPyItIjoiKyI7YnJvd3Nlck9mZnNldCs9Xy5zdHIuc3ByaW50ZigiJTAyZCIsTWF0aC5hYnMob2Zmc2V0LzYwKSk7YnJvd3Nlck9mZnNldCs9Xy5zdHIuc3ByaW50ZigiJTAyZCIsTWF0aC5hYnMob2Zmc2V0JTYwKSk7dGhpcy5taXNtYXRjaD0oYnJvd3Nlck9mZnNldCE9PXVzZXJPZmZzZXQpO30KaWYodGhpcy5taXNtYXRjaCl7JHNwYW4uaW5zZXJ0QWZ0ZXIodGhpcy4kZWwpOyRzcGFuLmF0dHIoJ3RpdGxlJyxfdCgiVGltZXpvbmUgTWlzbWF0Y2ggOiBUaGlzIHRpbWV6b25lIGlzIGRpZmZlcmVudCBmcm9tIHRoYXQgb2YgeW91ciBicm93c2VyLlxuUGxlYXNlLCBzZXQgdGhlIHNhbWUgdGltZXpvbmUgYXMgeW91ciBicm93c2VyJ3MgdG8gYXZvaWQgdGltZSBkaXNjcmVwYW5jaWVzIGluIHlvdXIgc3lzdGVtLiIpKTt0aGlzLiRlbD10aGlzLiRlbC5hZGQoJHNwYW4pO3RoaXMuJG9wdGlvbj10aGlzLiQoJ29wdGlvbicpLmZpbHRlcihmdW5jdGlvbigpe3JldHVybiAkKHRoaXMpLmF0dHIoJ3ZhbHVlJyk9PT12YWx1ZTt9KTt0aGlzLl9yZW5kZXJEYXRlVGltZVRpbWV6b25lKCk7fWVsc2UgaWYodmFsdWU9PSJmYWxzZSIpeyRzcGFuLmluc2VydEFmdGVyKHRoaXMuJGVsKTskc3Bhbi5hdHRyKCd0aXRsZScsX3QoIlNldCBhIHRpbWV6b25lIG9uIHlvdXIgdXNlciIpKTt0aGlzLiRlbD10aGlzLiRlbC5hZGQoJHNwYW4pO319LF9yZW5kZXJFZGl0OmZ1bmN0aW9uKCl7dmFyICRvdGhlckVsPXRoaXMuJGVsLm5vdCgnc2VsZWN0Jyk7dGhpcy4kZWw9dGhpcy4kZWwuZmlyc3QoKTt0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7JG90aGVyRWwuaW5zZXJ0QWZ0ZXIodGhpcy4kZWwpO3RoaXMuJGVsPXRoaXMuJGVsLmFkZCgkb3RoZXJFbCk7fSx9KTt2YXIgRmllbGRSZXBvcnRMYXlvdXQ9cmVsYXRpb25hbF9maWVsZHMuRmllbGRNYW55Mk9uZS5leHRlbmQoe2V2ZW50czpfLmV4dGVuZCh7fSxyZWxhdGlvbmFsX2ZpZWxkcy5GaWVsZE1hbnkyT25lLnByb3RvdHlwZS5ldmVudHMseydjbGljayBpbWcnOidfb25JbWdDbGlja2VkJyx9KSx3aWxsU3RhcnQ6ZnVuY3Rpb24oKXt2YXIgc2VsZj10aGlzO3RoaXMucHJldmlld3M9e307cmV0dXJuIHRoaXMuX3N1cGVyKCkudGhlbihmdW5jdGlvbigpe3JldHVybiBzZWxmLl9ycGMoe21vZGVsOidyZXBvcnQubGF5b3V0JyxtZXRob2Q6InNlYXJjaF9yZWFkIn0pLnRoZW4oZnVuY3Rpb24odmFsdWVzKXtzZWxmLnByZXZpZXdzPXZhbHVlczt9KTt9KTt9LF9yZW5kZXI6ZnVuY3Rpb24oKXt2YXIgc2VsZj10aGlzO3RoaXMuJGVsLmVtcHR5KCk7dmFyIHZhbHVlPV8uaXNPYmplY3QodGhpcy52YWx1ZSk/dGhpcy52YWx1ZS5kYXRhLmlkOnRoaXMudmFsdWU7Xy5lYWNoKHRoaXMucHJldmlld3MsZnVuY3Rpb24odmFsKXt2YXIgJGNvbnRhaW5lcj0kKCc8ZGl2PicpLmFkZENsYXNzKCdjb2wtMyB0ZXh0LWNlbnRlcicpO3ZhciAkaW1nPSQoJzxpbWc+JykuYWRkQ2xhc3MoJ2ltZyBpbWctZmx1aWQgaW1nLXRodW1ibmFpbCBtbDE2JykudG9nZ2xlQ2xhc3MoJ2J0bi1pbmZvJyx2YWwudmlld19pZFswXT09PXZhbHVlKS5hdHRyKCdzcmMnLHZhbC5pbWFnZSkuZGF0YSgna2V5Jyx2YWwudmlld19pZFswXSk7JGNvbnRhaW5lci5hcHBlbmQoJGltZyk7aWYodmFsLnBkZil7dmFyICRwcmV2aWV3TGluaz0kKCc8YT4nKS50ZXh0KCdFeGFtcGxlJykuYXR0cignaHJlZicsdmFsLnBkZikuYXR0cigndGFyZ2V0JywnX2JsYW5rJyk7JGNvbnRhaW5lci5hcHBlbmQoJHByZXZpZXdMaW5rKTt9CnNlbGYuJGVsLmFwcGVuZCgkY29udGFpbmVyKTt9KTt9LF9vbkltZ0NsaWNrZWQ6ZnVuY3Rpb24oZXZlbnQpe3RoaXMuX3NldFZhbHVlKCQoZXZlbnQuY3VycmVudFRhcmdldCkuZGF0YSgna2V5JykpO30sfSk7cmV0dXJue0ZpZWxkVGltZXpvbmVNaXNtYXRjaDpGaWVsZFRpbWV6b25lTWlzbWF0Y2gsRmllbGRSZXBvcnRMYXlvdXQ6RmllbGRSZXBvcnRMYXlvdXQsfTt9KTs7CgovKiAvd2ViL3N0YXRpYy9zcmMvanMvZmllbGRzL3VwZ3JhZGVfZmllbGRzLmpzIGRlZmluZWQgaW4gYnVuZGxlICd3ZWIuYXNzZXRzX2JhY2tlbmQnICovCm9kb28uZGVmaW5lKCd3ZWIudXBncmFkZV93aWRnZXRzJyxmdW5jdGlvbihyZXF1aXJlKXsidXNlIHN0cmljdCI7dmFyIEFic3RyYWN0RmllbGQ9cmVxdWlyZSgnd2ViLkFic3RyYWN0RmllbGQnKTt2YXIgYmFzaWNfZmllbGRzPXJlcXVpcmUoJ3dlYi5iYXNpY19maWVsZHMnKTt2YXIgY29yZT1yZXF1aXJlKCd3ZWIuY29yZScpO3ZhciBEaWFsb2c9cmVxdWlyZSgnd2ViLkRpYWxvZycpO3ZhciBmaWVsZF9yZWdpc3RyeT1yZXF1aXJlKCd3ZWIuZmllbGRfcmVnaXN0cnknKTt2YXIgZnJhbWV3b3JrPXJlcXVpcmUoJ3dlYi5mcmFtZXdvcmsnKTt2YXIgcmVsYXRpb25hbF9maWVsZHM9cmVxdWlyZSgnd2ViLnJlbGF0aW9uYWxfZmllbGRzJyk7dmFyIF90PWNvcmUuX3Q7dmFyIFFXZWI9Y29yZS5xd2ViO3ZhciBGaWVsZEJvb2xlYW49YmFzaWNfZmllbGRzLkZpZWxkQm9vbGVhbjt2YXIgRmllbGRSYWRpbz1yZWxhdGlvbmFsX2ZpZWxkcy5GaWVsZFJhZGlvO3ZhciBBYnN0cmFjdEZpZWxkVXBncmFkZT17X2NvbmZpcm1VcGdyYWRlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3JwYyh7bW9kZWw6J3Jlcy51c2VycycsbWV0aG9kOidzZWFyY2hfY291bnQnLGFyZ3M6W1tbInNoYXJlIiwiPSIsZmFsc2VdXV0sfSkudGhlbihmdW5jdGlvbihkYXRhKXtmcmFtZXdvcmsucmVkaXJlY3QoImh0dHBzOi8vd3d3Lm9kb28uY29tL29kb28tZW50ZXJwcmlzZS91cGdyYWRlP251bV91c2Vycz0iK2RhdGEpO30pO30sX2luc2VydEVudGVycHJpc2VMYWJlbDpmdW5jdGlvbigkZW50ZXJwcmlzZUxhYmVsKXt9LF9vcGVuRGlhbG9nOmZ1bmN0aW9uKCl7dmFyIG1lc3NhZ2U9JChRV2ViLnJlbmRlcignRW50ZXJwcmlzZVVwZ3JhZGUnKSk7dmFyIGJ1dHRvbnM9W3t0ZXh0Ol90KCJVcGdyYWRlIG5vdyIpLGNsYXNzZXM6J2J0bi1wcmltYXJ5JyxjbG9zZTp0cnVlLGNsaWNrOnRoaXMuX2NvbmZpcm1VcGdyYWRlLmJpbmQodGhpcyksfSx7dGV4dDpfdCgiQ2FuY2VsIiksY2xvc2U6dHJ1ZSx9LF07cmV0dXJuIG5ldyBEaWFsb2codGhpcyx7c2l6ZTonbWVkaXVtJyxidXR0b25zOmJ1dHRvbnMsJGNvbnRlbnQ6JCgnPGRpdj4nLHtodG1sOm1lc3NhZ2UsfSksdGl0bGU6X3QoIk9kb28gRW50ZXJwcmlzZSIpLH0pLm9wZW4oKTt9LF9yZW5kZXI6ZnVuY3Rpb24oKXt0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy5faW5zZXJ0RW50ZXJwcmlzZUxhYmVsKCQoIjxzcGFuPiIse3RleHQ6IkVudGVycHJpc2UiLCdjbGFzcyc6ImJhZGdlIGJhZGdlLXByaW1hcnkgb2VfaW5saW5lIG9fZW50ZXJwcmlzZV9sYWJlbCJ9KSk7fSxfcmVzZXRWYWx1ZTpmdW5jdGlvbigpe30sX29uSW5wdXRDbGlja2VkOmZ1bmN0aW9uKGV2ZW50KXtpZigkKGV2ZW50LmN1cnJlbnRUYXJnZXQpLnByb3AoImNoZWNrZWQiKSl7dGhpcy5fb3BlbkRpYWxvZygpLm9uKCdjbG9zZWQnLHRoaXMsdGhpcy5fcmVzZXRWYWx1ZS5iaW5kKHRoaXMpKTt9fSx9O3ZhciBVcGdyYWRlQm9vbGVhbj1GaWVsZEJvb2xlYW4uZXh0ZW5kKEFic3RyYWN0RmllbGRVcGdyYWRlLHtzdXBwb3J0ZWRGaWVsZFR5cGVzOltdLGV2ZW50czpfLmV4dGVuZCh7fSxBYnN0cmFjdEZpZWxkLnByb3RvdHlwZS5ldmVudHMseydjbGljayBpbnB1dCc6J19vbklucHV0Q2xpY2tlZCcsfSkscmVuZGVyV2l0aExhYmVsOmZ1bmN0aW9uKCRsYWJlbCl7dGhpcy4kbGFiZWw9JGxhYmVsO3RoaXMuX3JlbmRlcigpO30sX2luc2VydEVudGVycHJpc2VMYWJlbDpmdW5jdGlvbigkZW50ZXJwcmlzZUxhYmVsKXt2YXIgJGVsPXRoaXMuJGxhYmVsfHx0aGlzLiRlbDskZWwuYXBwZW5kKCcmbmJzcDsnKS5hcHBlbmQoJGVudGVycHJpc2VMYWJlbCk7fSxfcmVzZXRWYWx1ZTpmdW5jdGlvbigpe3RoaXMuJGlucHV0LnByb3AoImNoZWNrZWQiLGZhbHNlKS5jaGFuZ2UoKTt9LH0pO3ZhciBVcGdyYWRlUmFkaW89RmllbGRSYWRpby5leHRlbmQoQWJzdHJhY3RGaWVsZFVwZ3JhZGUse3N1cHBvcnRlZEZpZWxkVHlwZXM6W10sZXZlbnRzOl8uZXh0ZW5kKHt9LEZpZWxkUmFkaW8ucHJvdG90eXBlLmV2ZW50cyx7J2NsaWNrIGlucHV0Omxhc3QnOidfb25JbnB1dENsaWNrZWQnLH0pLGlzU2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRydWU7fSxfaW5zZXJ0RW50ZXJwcmlzZUxhYmVsOmZ1bmN0aW9uKCRlbnRlcnByaXNlTGFiZWwpe3RoaXMuJCgnbGFiZWwnKS5sYXN0KCkuYXBwZW5kKCcmbmJzcDsnKS5hcHBlbmQoJGVudGVycHJpc2VMYWJlbCk7fSxfcmVzZXRWYWx1ZTpmdW5jdGlvbigpe3RoaXMuJCgnaW5wdXQnKS5maXJzdCgpLnByb3AoImNoZWNrZWQiLHRydWUpLmNsaWNrKCk7fSx9KTtmaWVsZF9yZWdpc3RyeS5hZGQoJ3VwZ3JhZGVfYm9vbGVhbicsVXBncmFkZUJvb2xlYW4pLmFkZCgndXBncmFkZV9yYWRpbycsVXBncmFkZVJhZGlvKTt9KTs7CgovKiAvd2ViL3N0YXRpYy9zcmMvanMvdmlld3MvYWJzdHJhY3Rfdmlldy5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwpvZG9vLmRlZmluZSgnd2ViLkFic3RyYWN0VmlldycsZnVuY3Rpb24ocmVxdWlyZSl7InVzZSBzdHJpY3QiO3ZhciBBYnN0cmFjdE1vZGVsPXJlcXVpcmUoJ3dlYi5BYnN0cmFjdE1vZGVsJyk7dmFyIEFic3RyYWN0UmVuZGVyZXI9cmVxdWlyZSgnd2ViLkFic3RyYWN0UmVuZGVyZXInKTt2YXIgQWJzdHJhY3RDb250cm9sbGVyPXJlcXVpcmUoJ3dlYi5BYnN0cmFjdENvbnRyb2xsZXInKTt2YXIgQ29udHJvbFBhbmVsVmlldz1yZXF1aXJlKCd3ZWIuQ29udHJvbFBhbmVsVmlldycpO3ZhciBtdmM9cmVxdWlyZSgnd2ViLm12YycpO3ZhciBTZWFyY2hQYW5lbD1yZXF1aXJlKCd3ZWIuU2VhcmNoUGFuZWwnKTt2YXIgdmlld1V0aWxzPXJlcXVpcmUoJ3dlYi52aWV3VXRpbHMnKTt2YXIgRmFjdG9yeT1tdmMuRmFjdG9yeTt2YXIgQWJzdHJhY3RWaWV3PUZhY3RvcnkuZXh0ZW5kKHtkaXNwbGF5X25hbWU6JycsbW9iaWxlX2ZyaWVuZGx5OmZhbHNlLGljb246J2ZhLXF1ZXN0aW9uJyxtdWx0aV9yZWNvcmQ6dHJ1ZSx2aWV3VHlwZTp1bmRlZmluZWQsd2l0aFNlYXJjaEJhcjp0cnVlLHNlYXJjaE1lbnVUeXBlczpbJ2ZpbHRlcicsJ2dyb3VwQnknLCdmYXZvcml0ZSddLHdpdGhDb250cm9sUGFuZWw6dHJ1ZSx3aXRoU2VhcmNoUGFuZWw6dHJ1ZSxjb25maWc6Xy5leHRlbmQoe30sRmFjdG9yeS5wcm90b3R5cGUuY29uZmlnLHtNb2RlbDpBYnN0cmFjdE1vZGVsLFJlbmRlcmVyOkFic3RyYWN0UmVuZGVyZXIsQ29udHJvbGxlcjpBYnN0cmFjdENvbnRyb2xsZXIsU2VhcmNoUGFuZWw6U2VhcmNoUGFuZWwsfSksaW5pdDpmdW5jdGlvbih2aWV3SW5mbyxwYXJhbXMpe3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt2YXIgYWN0aW9uPXBhcmFtcy5hY3Rpb258fHt9O3BhcmFtcz1fLmRlZmF1bHRzKHBhcmFtcyx0aGlzLl9leHRyYWN0UGFyYW1zRnJvbUFjdGlvbihhY3Rpb24pKTtpZih0eXBlb2Ygdmlld0luZm8uYXJjaD09PSdzdHJpbmcnKXt0aGlzLmZpZWxkc1ZpZXc9dGhpcy5fcHJvY2Vzc0ZpZWxkc1ZpZXcodmlld0luZm8pO31lbHNle3RoaXMuZmllbGRzVmlldz12aWV3SW5mbzt9CnRoaXMuYXJjaD10aGlzLmZpZWxkc1ZpZXcuYXJjaDt0aGlzLmZpZWxkcz10aGlzLmZpZWxkc1ZpZXcudmlld0ZpZWxkczt0aGlzLnVzZXJDb250ZXh0PXBhcmFtcy51c2VyQ29udGV4dHx8e307dGhpcy53aXRoQ29udHJvbFBhbmVsPXRoaXMud2l0aENvbnRyb2xQYW5lbCYmcGFyYW1zLndpdGhDb250cm9sUGFuZWw7Y29uc3Qgc2VhcmNoUGFuZWxEaXNhYmxlZD0nc2VhcmNoX3BhbmVsJ2luIHBhcmFtcy5jb250ZXh0JiYhcGFyYW1zLnNlYXJjaF9wYW5lbDt0aGlzLndpdGhTZWFyY2hQYW5lbD10aGlzLndpdGhTZWFyY2hQYW5lbCYmdGhpcy5tdWx0aV9yZWNvcmQmJnBhcmFtcy53aXRoU2VhcmNoUGFuZWwmJiFzZWFyY2hQYW5lbERpc2FibGVkO3ZhciBpc0VtYmVkZGVkPXBhcmFtcy5pc0VtYmVkZGVkfHxmYWxzZTt0aGlzLnJlbmRlcmVyUGFyYW1zPXthcmNoOnRoaXMuYXJjaCxpc0VtYmVkZGVkOmlzRW1iZWRkZWQsbm9Db250ZW50SGVscDpwYXJhbXMubm9Db250ZW50SGVscCx9O3RoaXMuY29udHJvbGxlclBhcmFtcz17YWN0aW9uVmlld3M6cGFyYW1zLmFjdGlvblZpZXdzLGFjdGl2ZUFjdGlvbnM6e2VkaXQ6dGhpcy5hcmNoLmF0dHJzLmVkaXQ/ISFKU09OLnBhcnNlKHRoaXMuYXJjaC5hdHRycy5lZGl0KTp0cnVlLGNyZWF0ZTp0aGlzLmFyY2guYXR0cnMuY3JlYXRlPyEhSlNPTi5wYXJzZSh0aGlzLmFyY2guYXR0cnMuY3JlYXRlKTp0cnVlLGRlbGV0ZTp0aGlzLmFyY2guYXR0cnMuZGVsZXRlPyEhSlNPTi5wYXJzZSh0aGlzLmFyY2guYXR0cnMuZGVsZXRlKTp0cnVlLGR1cGxpY2F0ZTp0aGlzLmFyY2guYXR0cnMuZHVwbGljYXRlPyEhSlNPTi5wYXJzZSh0aGlzLmFyY2guYXR0cnMuZHVwbGljYXRlKTp0cnVlLH0sYmFubmVyUm91dGU6dGhpcy5hcmNoLmF0dHJzLmJhbm5lcl9yb3V0ZSxjb250cm9sbGVySUQ6cGFyYW1zLmNvbnRyb2xsZXJJRCxkaXNwbGF5TmFtZTpwYXJhbXMuZGlzcGxheU5hbWUsaXNFbWJlZGRlZDppc0VtYmVkZGVkLGlzTXVsdGlSZWNvcmQ6dGhpcy5tdWx0aV9yZWNvcmQsbW9kZWxOYW1lOnBhcmFtcy5tb2RlbE5hbWUsdmlld1R5cGU6dGhpcy52aWV3VHlwZSx9O3ZhciBjb250cm9sbGVyU3RhdGU9cGFyYW1zLmNvbnRyb2xsZXJTdGF0ZXx8e307dmFyIGN1cnJlbnRJZD1jb250cm9sbGVyU3RhdGUuY3VycmVudElkfHxwYXJhbXMuY3VycmVudElkO3RoaXMubG9hZFBhcmFtcz17Y29udGV4dDpwYXJhbXMuY29udGV4dCxjb3VudDpwYXJhbXMuY291bnR8fCgodGhpcy5jb250cm9sbGVyUGFyYW1zLmlkcyE9PXVuZGVmaW5lZCkmJnRoaXMuY29udHJvbGxlclBhcmFtcy5pZHMubGVuZ3RoKXx8MCxkb21haW46cGFyYW1zLmRvbWFpbixtb2RlbE5hbWU6cGFyYW1zLm1vZGVsTmFtZSxyZXNfaWQ6Y3VycmVudElkLHJlc19pZHM6Y29udHJvbGxlclN0YXRlLnJlc0lkc3x8cGFyYW1zLmlkc3x8KGN1cnJlbnRJZD9bY3VycmVudElkXTp1bmRlZmluZWQpLH07dmFyIGRlZmF1bHRPcmRlcj10aGlzLmFyY2guYXR0cnMuZGVmYXVsdF9vcmRlcjtpZihkZWZhdWx0T3JkZXIpe3RoaXMubG9hZFBhcmFtcy5vcmRlcmVkQnk9Xy5tYXAoZGVmYXVsdE9yZGVyLnNwbGl0KCcsJyksZnVuY3Rpb24ob3JkZXIpe29yZGVyPW9yZGVyLnRyaW0oKS5zcGxpdCgnICcpO3JldHVybntuYW1lOm9yZGVyWzBdLGFzYzpvcmRlclsxXSE9PSdkZXNjJ307fSk7fQppZihwYXJhbXMuc2VhcmNoUXVlcnkpe3RoaXMuX3VwZGF0ZU1WQ1BhcmFtcyhwYXJhbXMuc2VhcmNoUXVlcnkpO30KdGhpcy5jb250cm9sUGFuZWxQYXJhbXM9e2FjdGlvbjphY3Rpb24sYWN0aXZhdGVEZWZhdWx0RmF2b3JpdGU6cGFyYW1zLmFjdGl2YXRlRGVmYXVsdEZhdm9yaXRlLGR5bmFtaWNGaWx0ZXJzOnBhcmFtcy5keW5hbWljRmlsdGVycyxicmVhZGNydW1iczpwYXJhbXMuYnJlYWRjcnVtYnMsY29udGV4dDp0aGlzLmxvYWRQYXJhbXMuY29udGV4dCxkb21haW46dGhpcy5sb2FkUGFyYW1zLmRvbWFpbixtb2RlbE5hbWU6cGFyYW1zLm1vZGVsTmFtZSxzZWFyY2hNZW51VHlwZXM6cGFyYW1zLnNlYXJjaE1lbnVUeXBlcyxzdGF0ZTpjb250cm9sbGVyU3RhdGUuY3BTdGF0ZSx2aWV3SW5mbzpwYXJhbXMuY29udHJvbFBhbmVsRmllbGRzVmlldyx3aXRoQnJlYWRjcnVtYnM6cGFyYW1zLndpdGhCcmVhZGNydW1icyx3aXRoU2VhcmNoQmFyOnBhcmFtcy53aXRoU2VhcmNoQmFyLH07dGhpcy5zZWFyY2hQYW5lbFBhcmFtcz17ZGVmYXVsdE5vRmlsdGVyOnBhcmFtcy5zZWFyY2hQYW5lbERlZmF1bHROb0ZpbHRlcixmaWVsZHM6dGhpcy5maWVsZHMsbW9kZWw6dGhpcy5sb2FkUGFyYW1zLm1vZGVsTmFtZSxzdGF0ZTpjb250cm9sbGVyU3RhdGUuc3BTdGF0ZSx9O30sZ2V0Q29udHJvbGxlcjpmdW5jdGlvbihwYXJlbnQpe3ZhciBzZWxmPXRoaXM7dmFyIGNwRGVmPXRoaXMud2l0aENvbnRyb2xQYW5lbCYmdGhpcy5fY3JlYXRlQ29udHJvbFBhbmVsKHBhcmVudCk7dmFyIHNwRGVmO2lmKHRoaXMud2l0aFNlYXJjaFBhbmVsKXt2YXIgc3BQcm90bz10aGlzLmNvbmZpZy5TZWFyY2hQYW5lbC5wcm90b3R5cGU7dmFyIHZpZXdJbmZvPXRoaXMuY29udHJvbFBhbmVsUGFyYW1zLnZpZXdJbmZvO3ZhciBzZWFyY2hQYW5lbFBhcmFtcz1zcFByb3RvLmNvbXB1dGVTZWFyY2hQYW5lbFBhcmFtcyh2aWV3SW5mbyx0aGlzLnZpZXdUeXBlKTtpZihzZWFyY2hQYW5lbFBhcmFtcy5zZWN0aW9ucyl7dGhpcy5zZWFyY2hQYW5lbFBhcmFtcy5zZWN0aW9ucz1zZWFyY2hQYW5lbFBhcmFtcy5zZWN0aW9uczt0aGlzLnJlbmRlcmVyUGFyYW1zLndpdGhTZWFyY2hQYW5lbD10cnVlO3NwRGVmPVByb21pc2UucmVzb2x2ZShjcERlZikudGhlbih0aGlzLl9jcmVhdGVTZWFyY2hQYW5lbC5iaW5kKHRoaXMscGFyZW50LHNlYXJjaFBhbmVsUGFyYW1zKSk7fX0KdmFyIF9zdXBlcj10aGlzLl9zdXBlci5iaW5kKHRoaXMpO3JldHVybiBQcm9taXNlLmFsbChbY3BEZWYsc3BEZWZdKS50aGVuKGZ1bmN0aW9uKFtjb250cm9sUGFuZWwsc2VhcmNoUGFuZWxdKXt2YXIgbW9kZWxQYXJlbnQ9c2VsZi5tb2RlbCYmc2VsZi5tb2RlbC5nZXRQYXJlbnQoKTt2YXIgcHJvbT1fc3VwZXIocGFyZW50KTtwcm9tLnRoZW4oZnVuY3Rpb24oY29udHJvbGxlcil7aWYoY29udHJvbFBhbmVsKXtjb250cm9sUGFuZWwuc2V0UGFyZW50KGNvbnRyb2xsZXIpO30KaWYoc2VhcmNoUGFuZWwpe3NlYXJjaFBhbmVsLnNldFBhcmVudChjb250cm9sbGVyKTt9CmlmKG1vZGVsUGFyZW50KXtzZWxmLm1vZGVsLnNldFBhcmVudChtb2RlbFBhcmVudCk7fX0pO3JldHVybiBwcm9tO30pO30sZ2V0TW9kZWw6ZnVuY3Rpb24oKXtpZighdGhpcy5tb2RlbCl7dGhpcy5tb2RlbD10aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fQpyZXR1cm4gdGhpcy5tb2RlbDt9LHNldENvbnRyb2xsZXI6ZnVuY3Rpb24oQ29udHJvbGxlcil7dGhpcy5Db250cm9sbGVyPUNvbnRyb2xsZXI7fSxfY3JlYXRlQ29udHJvbFBhbmVsOmZ1bmN0aW9uKHBhcmVudCl7dmFyIHNlbGY9dGhpczt2YXIgY29udHJvbFBhbmVsVmlldz1uZXcgQ29udHJvbFBhbmVsVmlldyh0aGlzLmNvbnRyb2xQYW5lbFBhcmFtcyk7cmV0dXJuIGNvbnRyb2xQYW5lbFZpZXcuZ2V0Q29udHJvbGxlcihwYXJlbnQpLnRoZW4oZnVuY3Rpb24oY29udHJvbFBhbmVsKXtzZWxmLmNvbnRyb2xsZXJQYXJhbXMuY29udHJvbFBhbmVsPWNvbnRyb2xQYW5lbDtyZXR1cm4gY29udHJvbFBhbmVsLmFwcGVuZFRvKGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKSkudGhlbihmdW5jdGlvbigpe3NlbGYuX3VwZGF0ZU1WQ1BhcmFtcyhjb250cm9sUGFuZWwuZ2V0U2VhcmNoUXVlcnkoKSk7cmV0dXJuIGNvbnRyb2xQYW5lbDt9KTt9KTt9LF9jcmVhdGVTZWFyY2hQYW5lbDphc3luYyBmdW5jdGlvbihwYXJlbnQscGFyYW1zKXt2YXIgZGVmYXVsdFZhbHVlcz17fTtPYmplY3Qua2V5cyh0aGlzLmxvYWRQYXJhbXMuY29udGV4dCkuZm9yRWFjaCgoa2V5KT0+e2xldCBtYXRjaD0vXnNlYXJjaHBhbmVsX2RlZmF1bHRfKC4qKSQvLmV4ZWMoa2V5KTtpZihtYXRjaCl7ZGVmYXVsdFZhbHVlc1ttYXRjaFsxXV09dGhpcy5sb2FkUGFyYW1zLmNvbnRleHRba2V5XTt9fSk7dmFyIGNvbnRyb2xQYW5lbERvbWFpbj10aGlzLmxvYWRQYXJhbXMuZG9tYWluO3ZhciBzcFBhcmFtcz1fLmV4dGVuZCh7fSx0aGlzLnNlYXJjaFBhbmVsUGFyYW1zLHtkZWZhdWx0VmFsdWVzOmRlZmF1bHRWYWx1ZXMsc2VhcmNoRG9tYWluOmNvbnRyb2xQYW5lbERvbWFpbixjbGFzc2VzOnBhcmFtcy5jbGFzc2VzfHxbXSx9KTt2YXIgc2VhcmNoUGFuZWw9bmV3IHRoaXMuY29uZmlnLlNlYXJjaFBhbmVsKHBhcmVudCxzcFBhcmFtcyk7dGhpcy5jb250cm9sbGVyUGFyYW1zLnNlYXJjaFBhbmVsPXNlYXJjaFBhbmVsO3RoaXMuY29udHJvbGxlclBhcmFtcy5jb250cm9sUGFuZWxEb21haW49Y29udHJvbFBhbmVsRG9tYWluO2F3YWl0IHNlYXJjaFBhbmVsLmFwcGVuZFRvKGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKSk7dmFyIHNlYXJjaFBhbmVsRG9tYWluPXNlYXJjaFBhbmVsLmdldERvbWFpbigpO3RoaXMubG9hZFBhcmFtcy5kb21haW49Y29udHJvbFBhbmVsRG9tYWluLmNvbmNhdChzZWFyY2hQYW5lbERvbWFpbik7cmV0dXJuIHNlYXJjaFBhbmVsO30sX2V4dHJhY3RQYXJhbXNGcm9tQWN0aW9uOmZ1bmN0aW9uKGFjdGlvbil7YWN0aW9uPWFjdGlvbnx8e307dmFyIGNvbnRleHQ9YWN0aW9uLmNvbnRleHR8fHt9O3ZhciBpbmxpbmU9YWN0aW9uLnRhcmdldD09PSdpbmxpbmUnO3JldHVybnthY3Rpb25JZDphY3Rpb24uaWR8fGZhbHNlLGFjdGlvblZpZXdzOmFjdGlvbi52aWV3c3x8W10sYWN0aXZhdGVEZWZhdWx0RmF2b3JpdGU6IWNvbnRleHQuYWN0aXZlX2lkJiYhY29udGV4dC5hY3RpdmVfaWRzLGNvbnRleHQ6YWN0aW9uLmNvbnRleHR8fHt9LGNvbnRyb2xQYW5lbEZpZWxkc1ZpZXc6YWN0aW9uLmNvbnRyb2xQYW5lbEZpZWxkc1ZpZXcsY3VycmVudElkOmFjdGlvbi5yZXNfaWQ/YWN0aW9uLnJlc19pZDp1bmRlZmluZWQsZGlzcGxheU5hbWU6YWN0aW9uLmRpc3BsYXlfbmFtZXx8YWN0aW9uLm5hbWUsZG9tYWluOmFjdGlvbi5kb21haW58fFtdLGxpbWl0OmFjdGlvbi5saW1pdCxtb2RlbE5hbWU6YWN0aW9uLnJlc19tb2RlbCxub0NvbnRlbnRIZWxwOmFjdGlvbi5oZWxwLHNlYXJjaE1lbnVUeXBlczppbmxpbmU/W106dGhpcy5zZWFyY2hNZW51VHlwZXMsd2l0aEJyZWFkY3J1bWJzOidub19icmVhZGNydW1icydpbiBjb250ZXh0PyFjb250ZXh0Lm5vX2JyZWFkY3J1bWJzOnRydWUsd2l0aENvbnRyb2xQYW5lbDp0aGlzLndpdGhDb250cm9sUGFuZWwsd2l0aFNlYXJjaEJhcjppbmxpbmU/ZmFsc2U6dGhpcy53aXRoU2VhcmNoQmFyLHdpdGhTZWFyY2hQYW5lbDp0aGlzLndpdGhTZWFyY2hQYW5lbCx9O30sX3Byb2Nlc3NGaWVsZHNWaWV3OmZ1bmN0aW9uKGZpZWxkc1ZpZXcpe3ZhciBmdj1fLmV4dGVuZCh7fSxmaWVsZHNWaWV3KTtmdi5hcmNoPXZpZXdVdGlscy5wYXJzZUFyY2goZnYuYXJjaCk7ZnYudmlld0ZpZWxkcz1fLmRlZmF1bHRzKHt9LGZ2LnZpZXdGaWVsZHMsZnYuZmllbGRzKTtyZXR1cm4gZnY7fSxfdXBkYXRlTVZDUGFyYW1zOmZ1bmN0aW9uKHNlYXJjaFF1ZXJ5KXt2YXIgdGltZVJhbmdlTWVudURhdGE9c2VhcmNoUXVlcnkuY29udGV4dC50aW1lUmFuZ2VNZW51RGF0YXx8e307dmFyIGNvbXBhcmlzb25UaW1lUmFuZ2U9dGltZVJhbmdlTWVudURhdGEuY29tcGFyaXNvblRpbWVSYW5nZXx8W107dmFyIGNvbXBhcmlzb25UaW1lUmFuZ2VEZXNjcmlwdGlvbj10aW1lUmFuZ2VNZW51RGF0YS5jb21wYXJpc29uVGltZVJhbmdlRGVzY3JpcHRpb258fCcnO3ZhciB0aW1lUmFuZ2VEZXNjcmlwdGlvbj10aW1lUmFuZ2VNZW51RGF0YS50aW1lUmFuZ2VEZXNjcmlwdGlvbnx8Jyc7dGhpcy5sb2FkUGFyYW1zPV8uZXh0ZW5kKHRoaXMubG9hZFBhcmFtcyx7Y29tcGFyZTpjb21wYXJpc29uVGltZVJhbmdlLmxlbmd0aD4wLGNvbXBhcmlzb25GaWVsZDp0aW1lUmFuZ2VNZW51RGF0YS5jb21wYXJpc29uRmllbGQsY29tcGFyaXNvblRpbWVSYW5nZTpjb21wYXJpc29uVGltZVJhbmdlLGNvbXBhcmlzb25UaW1lUmFuZ2VEZXNjcmlwdGlvbjpjb21wYXJpc29uVGltZVJhbmdlRGVzY3JpcHRpb24sY29udGV4dDpzZWFyY2hRdWVyeS5jb250ZXh0LGRvbWFpbjpzZWFyY2hRdWVyeS5kb21haW4sZ3JvdXBlZEJ5OnNlYXJjaFF1ZXJ5Lmdyb3VwQnksdGltZVJhbmdlOnRpbWVSYW5nZU1lbnVEYXRhLnRpbWVSYW5nZXx8W10sdGltZVJhbmdlRGVzY3JpcHRpb246dGltZVJhbmdlTWVudURhdGEudGltZVJhbmdlRGVzY3JpcHRpb258fCcnLH0pO3RoaXMubG9hZFBhcmFtcy5vcmRlcmVkQnk9c2VhcmNoUXVlcnkub3JkZXJlZEJ5P3NlYXJjaFF1ZXJ5Lm9yZGVyZWRCeTp0aGlzLmxvYWRQYXJhbXMub3JkZXJlZEJ5O3RoaXMucmVuZGVyZXJQYXJhbXMudGltZVJhbmdlRGVzY3JpcHRpb249dGltZVJhbmdlRGVzY3JpcHRpb247dGhpcy5yZW5kZXJlclBhcmFtcy5jb21wYXJpc29uVGltZVJhbmdlRGVzY3JpcHRpb249Y29tcGFyaXNvblRpbWVSYW5nZURlc2NyaXB0aW9uO30sfSk7cmV0dXJuIEFic3RyYWN0Vmlldzt9KTs7CgovKiAvd2ViL3N0YXRpYy9zcmMvanMvdmlld3MvYWJzdHJhY3RfcmVuZGVyZXIuanMgZGVmaW5lZCBpbiBidW5kbGUgJ3dlYi5hc3NldHNfYmFja2VuZCcgKi8Kb2Rvby5kZWZpbmUoJ3dlYi5BYnN0cmFjdFJlbmRlcmVyJyxmdW5jdGlvbihyZXF1aXJlKXsidXNlIHN0cmljdCI7dmFyIG12Yz1yZXF1aXJlKCd3ZWIubXZjJyk7cmV0dXJuIG12Yy5SZW5kZXJlci5leHRlbmQoe2luaXQ6ZnVuY3Rpb24ocGFyZW50LHN0YXRlLHBhcmFtcyl7dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3RoaXMuYXJjaD1wYXJhbXMuYXJjaDt0aGlzLm5vQ29udGVudEhlbHA9cGFyYW1zLm5vQ29udGVudEhlbHA7dGhpcy53aXRoU2VhcmNoUGFuZWw9cGFyYW1zLndpdGhTZWFyY2hQYW5lbDt9LHN0YXJ0OmZ1bmN0aW9uKCl7dGhpcy4kZWwuYWRkQ2xhc3ModGhpcy5hcmNoLmF0dHJzLmNsYXNzKTtpZih0aGlzLndpdGhTZWFyY2hQYW5lbCl7dGhpcy4kZWwuYWRkQ2xhc3MoJ29fcmVuZGVyZXJfd2l0aF9zZWFyY2hwYW5lbCcpO30KcmV0dXJuIFByb21pc2UuYWxsKFt0aGlzLl9yZW5kZXIoKSx0aGlzLl9zdXBlcigpXSk7fSxvbl9hdHRhY2hfY2FsbGJhY2s6ZnVuY3Rpb24oKXt9LG9uX2RldGFjaF9jYWxsYmFjazpmdW5jdGlvbigpe30sZ2V0TG9jYWxTdGF0ZTpmdW5jdGlvbigpe30sZ2l2ZUZvY3VzOmZ1bmN0aW9uKCl7fSxzZXRMb2NhbFN0YXRlOmZ1bmN0aW9uKGxvY2FsU3RhdGUpe30sdXBkYXRlU3RhdGU6ZnVuY3Rpb24oc3RhdGUscGFyYW1zKXt0aGlzLnN0YXRlPXN0YXRlO3JldHVybiBwYXJhbXMubm9SZW5kZXI/UHJvbWlzZS5yZXNvbHZlKCk6dGhpcy5fcmVuZGVyKCk7fSxfcmVuZGVyOmZ1bmN0aW9uKCl7cmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO30sfSk7fSk7OwoKLyogL3dlYi9zdGF0aWMvc3JjL2pzL3ZpZXdzL2Fic3RyYWN0X21vZGVsLmpzIGRlZmluZWQgaW4gYnVuZGxlICd3ZWIuYXNzZXRzX2JhY2tlbmQnICovCm9kb28uZGVmaW5lKCd3ZWIuQWJzdHJhY3RNb2RlbCcsZnVuY3Rpb24ocmVxdWlyZSl7InVzZSBzdHJpY3QiO3ZhciBmaWVsZFV0aWxzPXJlcXVpcmUoJ3dlYi5maWVsZF91dGlscycpO3ZhciBtdmM9cmVxdWlyZSgnd2ViLm12YycpO3ZhciBBYnN0cmFjdE1vZGVsPW12Yy5Nb2RlbC5leHRlbmQoe3JlbG9hZDpmdW5jdGlvbihwYXJhbXMpe3JldHVybiBQcm9taXNlLnJlc29sdmUoKTt9LF9wYXJzZVNlcnZlclZhbHVlOmZ1bmN0aW9uKGZpZWxkLHZhbHVlKXtpZihmaWVsZC50eXBlPT09J2RhdGUnfHxmaWVsZC50eXBlPT09J2RhdGV0aW1lJyl7dmFsdWU9ZmllbGRVdGlscy5wYXJzZVtmaWVsZC50eXBlXSh2YWx1ZSxmaWVsZCx7aXNVVEM6dHJ1ZX0pO31lbHNlIGlmKGZpZWxkLnR5cGU9PT0nc2VsZWN0aW9uJyYmdmFsdWU9PT1mYWxzZSl7dmFyIGhhc0tleTA9Xy5maW5kKGZpZWxkLnNlbGVjdGlvbixmdW5jdGlvbihvcHRpb24pe3JldHVybiBvcHRpb25bMF09PT0wO30pO3ZhbHVlPWhhc0tleTA/MDp2YWx1ZTt9CnJldHVybiB2YWx1ZTt9LH0pO3JldHVybiBBYnN0cmFjdE1vZGVsO30pOzsKCi8qIC93ZWIvc3RhdGljL3NyYy9qcy92aWV3cy9hYnN0cmFjdF9jb250cm9sbGVyLmpzIGRlZmluZWQgaW4gYnVuZGxlICd3ZWIuYXNzZXRzX2JhY2tlbmQnICovCm9kb28uZGVmaW5lKCd3ZWIuQWJzdHJhY3RDb250cm9sbGVyJyxmdW5jdGlvbihyZXF1aXJlKXsidXNlIHN0cmljdCI7dmFyIEFjdGlvbk1peGluPXJlcXVpcmUoJ3dlYi5BY3Rpb25NaXhpbicpO3ZhciBhamF4PXJlcXVpcmUoJ3dlYi5hamF4Jyk7dmFyIGNvbmN1cnJlbmN5PXJlcXVpcmUoJ3dlYi5jb25jdXJyZW5jeScpO3ZhciBjb25maWc9cmVxdWlyZSgnd2ViLmNvbmZpZycpO3ZhciBjb3JlPXJlcXVpcmUoJ3dlYi5jb3JlJyk7dmFyIG12Yz1yZXF1aXJlKCd3ZWIubXZjJyk7dmFyIHNlc3Npb249cmVxdWlyZSgnd2ViLnNlc3Npb24nKTt2YXIgUVdlYj1jb3JlLnF3ZWI7dmFyIEFic3RyYWN0Q29udHJvbGxlcj1tdmMuQ29udHJvbGxlci5leHRlbmQoQWN0aW9uTWl4aW4se2N1c3RvbV9ldmVudHM6e2dldF9jb250cm9sbGVyX3F1ZXJ5X3BhcmFtczonX29uR2V0Q29udHJvbGxlclF1ZXJ5UGFyYW1zJyxuYXZpZ2F0aW9uX21vdmU6J19vbk5hdmlnYXRpb25Nb3ZlJyxvcGVuX3JlY29yZDonX29uT3BlblJlY29yZCcsc2VhcmNoOidfb25TZWFyY2gnLHN3aXRjaF92aWV3Oidfb25Td2l0Y2hWaWV3JyxzZWFyY2hfcGFuZWxfZG9tYWluX3VwZGF0ZWQ6J19vblNlYXJjaFBhbmVsRG9tYWluVXBkYXRlZCcsfSxldmVudHM6eydjbGljayBhW3R5cGU9ImFjdGlvbiJdJzonX29uQWN0aW9uQ2xpY2tlZCcsfSxpbml0OmZ1bmN0aW9uKHBhcmVudCxtb2RlbCxyZW5kZXJlcixwYXJhbXMpe3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLl9jb250cm9sUGFuZWw9cGFyYW1zLmNvbnRyb2xQYW5lbDt0aGlzLl90aXRsZT1wYXJhbXMuZGlzcGxheU5hbWU7dGhpcy5tb2RlbE5hbWU9cGFyYW1zLm1vZGVsTmFtZTt0aGlzLmFjdGl2ZUFjdGlvbnM9cGFyYW1zLmFjdGl2ZUFjdGlvbnM7dGhpcy5jb250cm9sbGVySUQ9cGFyYW1zLmNvbnRyb2xsZXJJRDt0aGlzLmluaXRpYWxTdGF0ZT1wYXJhbXMuaW5pdGlhbFN0YXRlO3RoaXMuYmFubmVyUm91dGU9cGFyYW1zLmJhbm5lclJvdXRlO3RoaXMuaXNNdWx0aVJlY29yZD1wYXJhbXMuaXNNdWx0aVJlY29yZDt0aGlzLmFjdGlvblZpZXdzPXBhcmFtcy5hY3Rpb25WaWV3czt0aGlzLnZpZXdUeXBlPXBhcmFtcy52aWV3VHlwZTt0aGlzLmRwPW5ldyBjb25jdXJyZW5jeS5Ecm9wUHJldmlvdXMoKTt0aGlzLl9zZWFyY2hQYW5lbD1wYXJhbXMuc2VhcmNoUGFuZWw7dGhpcy5jb250cm9sUGFuZWxEb21haW49cGFyYW1zLmNvbnRyb2xQYW5lbERvbWFpbnx8W107dGhpcy5zZWFyY2hQYW5lbERvbWFpbj10aGlzLl9zZWFyY2hQYW5lbD90aGlzLl9zZWFyY2hQYW5lbC5nZXREb21haW4oKTpbXTt9LHN0YXJ0OmZ1bmN0aW9uKCl7dmFyIHNlbGY9dGhpcztpZih0aGlzLl9zZWFyY2hQYW5lbCl7dGhpcy4kKCcub19jb250ZW50JykuYWRkQ2xhc3MoJ29fY29udHJvbGxlcl93aXRoX3NlYXJjaHBhbmVsJykucHJlcGVuZCh0aGlzLl9zZWFyY2hQYW5lbC4kZWwpO30KdGhpcy4kZWwuYWRkQ2xhc3MoJ29fdmlld19jb250cm9sbGVyJyk7cmV0dXJuIHRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKS50aGVuKGZ1bmN0aW9uKCl7dmFyIHByb207aWYoc2VsZi5fY29udHJvbFBhbmVsKXtwcm9tPXNlbGYuX3JlbmRlckNvbnRyb2xQYW5lbEVsZW1lbnRzKCkudGhlbihmdW5jdGlvbihlbGVtZW50cyl7c2VsZi5jb250cm9sUGFuZWxFbGVtZW50cz1lbGVtZW50cztzZWxmLl9jb250cm9sUGFuZWwuJGVsLnByZXBlbmRUbyhzZWxmLiRlbCk7fSk7fQpyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHByb20pO30pLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gc2VsZi5fdXBkYXRlKHNlbGYuaW5pdGlhbFN0YXRlKTt9KTt9LGRlc3Ryb3k6ZnVuY3Rpb24oKXtpZih0aGlzLiRidXR0b25zKXt0aGlzLiRidXR0b25zLm9mZigpO30KaWYodGhpcy5jb250cm9sUGFuZWxFbGVtZW50cyYmdGhpcy5jb250cm9sUGFuZWxFbGVtZW50cy4kc3dpdGNoX2J1dHRvbnMpe3RoaXMuY29udHJvbFBhbmVsRWxlbWVudHMuJHN3aXRjaF9idXR0b25zLm9mZigpO30KdGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO30sb25fYXR0YWNoX2NhbGxiYWNrOmZ1bmN0aW9uKCl7aWYodGhpcy5fY29udHJvbFBhbmVsKXt0aGlzLl9jb250cm9sUGFuZWwub25fYXR0YWNoX2NhbGxiYWNrKCk7fQppZih0aGlzLl9zZWFyY2hQYW5lbCl7dGhpcy5fc2VhcmNoUGFuZWwub25fYXR0YWNoX2NhbGxiYWNrKCk7fQp0aGlzLnJlbmRlcmVyLm9uX2F0dGFjaF9jYWxsYmFjaygpO30sb25fZGV0YWNoX2NhbGxiYWNrOmZ1bmN0aW9uKCl7aWYodGhpcy5fY29udHJvbFBhbmVsKXt0aGlzLl9jb250cm9sUGFuZWwub25fZGV0YWNoX2NhbGxiYWNrKCk7fQp0aGlzLnJlbmRlcmVyLm9uX2RldGFjaF9jYWxsYmFjaygpO30sY2FuQmVSZW1vdmVkOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZGlzY2FyZENoYW5nZXModW5kZWZpbmVkLHtub0FiYW5kb246dHJ1ZSxyZWFkb25seUlmUmVhbERpc2NhcmQ6dHJ1ZSx9KTt9LGRpc2NhcmRDaGFuZ2VzOmZ1bmN0aW9uKHJlY29yZElELG9wdGlvbnMpe3JldHVybiBQcm9taXNlLnJlc29sdmUoKTt9LGV4cG9ydFN0YXRlOmZ1bmN0aW9uKCl7dmFyIHN0YXRlPXt9O2lmKHRoaXMuX2NvbnRyb2xQYW5lbCl7c3RhdGUuY3BTdGF0ZT10aGlzLl9jb250cm9sUGFuZWwuZXhwb3J0U3RhdGUoKTt9CmlmKHRoaXMuX3NlYXJjaFBhbmVsKXtzdGF0ZS5zcFN0YXRlPXRoaXMuX3NlYXJjaFBhbmVsLmV4cG9ydFN0YXRlKCk7fQpyZXR1cm4gc3RhdGU7fSxnaXZlRm9jdXM6ZnVuY3Rpb24oKXt0aGlzLnJlbmRlcmVyLmdpdmVGb2N1cygpO30saXNfYWN0aW9uX2VuYWJsZWQ6ZnVuY3Rpb24oYWN0aW9uKXtyZXR1cm4gdGhpcy5hY3RpdmVBY3Rpb25zW2FjdGlvbl07fSxyZWxvYWQ6YXN5bmMgZnVuY3Rpb24ocGFyYW1zKXtwYXJhbXM9cGFyYW1zfHx7fTt2YXIgc2VhcmNoUGFuZWxVcGRhdGVQcm9tO3ZhciBjb250cm9sbGVyU3RhdGU9cGFyYW1zLmNvbnRyb2xsZXJTdGF0ZXx8e307dmFyIGNwU3RhdGU9Y29udHJvbGxlclN0YXRlLmNwU3RhdGU7aWYodGhpcy5fY29udHJvbFBhbmVsJiZjcFN0YXRlKXthd2FpdCB0aGlzLl9jb250cm9sUGFuZWwuaW1wb3J0U3RhdGUoY3BTdGF0ZSkudGhlbihmdW5jdGlvbihzZWFyY2hRdWVyeSl7cGFyYW1zPV8uZXh0ZW5kKHt9LHBhcmFtcyxzZWFyY2hRdWVyeSk7fSk7fQp2YXIgcG9zdHBvbmVSZW5kZXJpbmc9ZmFsc2U7aWYodGhpcy5fc2VhcmNoUGFuZWwpe3RoaXMuY29udHJvbFBhbmVsRG9tYWluPXBhcmFtcy5kb21haW58fHRoaXMuY29udHJvbFBhbmVsRG9tYWluO2lmKGNvbnRyb2xsZXJTdGF0ZS5zcFN0YXRlKXt0aGlzLl9zZWFyY2hQYW5lbC5pbXBvcnRTdGF0ZShjb250cm9sbGVyU3RhdGUuc3BTdGF0ZSk7dGhpcy5zZWFyY2hQYW5lbERvbWFpbj10aGlzLl9zZWFyY2hQYW5lbC5nZXREb21haW4oKTt9ZWxzZXtzZWFyY2hQYW5lbFVwZGF0ZVByb209dGhpcy5fc2VhcmNoUGFuZWwudXBkYXRlKHtzZWFyY2hEb21haW46dGhpcy5fZ2V0U2VhcmNoRG9tYWluKCl9KTtwb3N0cG9uZVJlbmRlcmluZz0hcGFyYW1zLm5vUmVuZGVyO3BhcmFtcy5ub1JlbmRlcj10cnVlO30KcGFyYW1zLmRvbWFpbj10aGlzLmNvbnRyb2xQYW5lbERvbWFpbi5jb25jYXQodGhpcy5zZWFyY2hQYW5lbERvbWFpbik7fQphd2FpdCBQcm9taXNlLmFsbChbdGhpcy51cGRhdGUocGFyYW1zLHt9KSxzZWFyY2hQYW5lbFVwZGF0ZVByb21dKTtpZihwb3N0cG9uZVJlbmRlcmluZyl7cmV0dXJuIHRoaXMucmVuZGVyZXIuX3JlbmRlcigpO319LHJlbmRlclBhZ2VyOmZ1bmN0aW9uKCRub2RlKXtyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7fSxyZW5kZXJTaWRlYmFyOmZ1bmN0aW9uKCRub2RlKXtyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7fSx1cGRhdGU6ZnVuY3Rpb24ocGFyYW1zLG9wdGlvbnMpe3ZhciBzZWxmPXRoaXM7dmFyIHNob3VsZFJlbG9hZD0ob3B0aW9ucyYmJ3JlbG9hZCdpbiBvcHRpb25zKT9vcHRpb25zLnJlbG9hZDp0cnVlO3ZhciBkZWY9c2hvdWxkUmVsb2FkP3RoaXMubW9kZWwucmVsb2FkKHRoaXMuaGFuZGxlLHBhcmFtcyk6UHJvbWlzZS5yZXNvbHZlKCk7dmFyIGNwVXBkYXRlSW5kZXg9dGhpcy5fY29udHJvbFBhbmVsJiZ0aGlzLl9jb250cm9sUGFuZWwudXBkYXRlSW5kZXg7cmV0dXJuIHRoaXMuZHAuYWRkKGRlZikudGhlbihmdW5jdGlvbihoYW5kbGUpe2lmKHNlbGYuX2NvbnRyb2xQYW5lbCYmY3BVcGRhdGVJbmRleCE9PXNlbGYuX2NvbnRyb2xQYW5lbC51cGRhdGVJbmRleCl7cmV0dXJuO30Kc2VsZi5oYW5kbGU9aGFuZGxlfHxzZWxmLmhhbmRsZTt2YXIgc3RhdGU9c2VsZi5tb2RlbC5nZXQoc2VsZi5oYW5kbGUpO3ZhciBsb2NhbFN0YXRlPXNlbGYucmVuZGVyZXIuZ2V0TG9jYWxTdGF0ZSgpO3JldHVybiBzZWxmLmRwLmFkZChzZWxmLnJlbmRlcmVyLnVwZGF0ZVN0YXRlKHN0YXRlLHBhcmFtcykpLnRoZW4oZnVuY3Rpb24oKXtpZihzZWxmLl9jb250cm9sUGFuZWwmJmNwVXBkYXRlSW5kZXghPT1zZWxmLl9jb250cm9sUGFuZWwudXBkYXRlSW5kZXgpe3JldHVybjt9CnNlbGYucmVuZGVyZXIuc2V0TG9jYWxTdGF0ZShsb2NhbFN0YXRlKTtyZXR1cm4gc2VsZi5fdXBkYXRlKHN0YXRlLHBhcmFtcyk7fSk7fSk7fSxfZ2V0U2VhcmNoRG9tYWluOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY29udHJvbFBhbmVsRG9tYWluO30sX3B1c2hTdGF0ZTpmdW5jdGlvbihzdGF0ZSl7dGhpcy50cmlnZ2VyX3VwKCdwdXNoX3N0YXRlJyx7Y29udHJvbGxlcklEOnRoaXMuY29udHJvbGxlcklELHN0YXRlOnN0YXRlfHx7fSx9KTt9LF9yZW5kZXJCYW5uZXI6ZnVuY3Rpb24oKXtpZih0aGlzLmJhbm5lclJvdXRlIT09dW5kZWZpbmVkKXt2YXIgc2VsZj10aGlzO3JldHVybiB0aGlzLmRwLmFkZCh0aGlzLl9ycGMoe3JvdXRlOnRoaXMuYmFubmVyUm91dGV9KSkudGhlbihmdW5jdGlvbihyZXNwb25zZSl7aWYoIXJlc3BvbnNlLmh0bWwpe3NlbGYuJGVsLnJlbW92ZUNsYXNzKCdvX2hhc19iYW5uZXInKTtyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7fQpzZWxmLiRlbC5hZGRDbGFzcygnb19oYXNfYmFubmVyJyk7dmFyICRiYW5uZXI9JChyZXNwb25zZS5odG1sKTtpZihzZWxmLl8kYmFubmVyJiZzZWxmLl8kYmFubmVyLnJlbW92ZSl7c2VsZi5fJGJhbm5lci5yZW1vdmUoKTt9CnZhciBkZWZzPVtdOyQoJ2xpbmtbcmVsPSJzdHlsZXNoZWV0Il0nLCRiYW5uZXIpLmVhY2goZnVuY3Rpb24oaSxsaW5rKXtkZWZzLnB1c2goYWpheC5sb2FkQ1NTKGxpbmsuaHJlZikpO2xpbmsucmVtb3ZlKCk7fSk7JCgnc2NyaXB0W3R5cGU9InRleHQvamF2YXNjcmlwdCJdJywkYmFubmVyKS5lYWNoKGZ1bmN0aW9uKGksanMpe2RlZnMucHVzaChhamF4LmxvYWRKUyhqcy5zcmMpKTtqcy5yZW1vdmUoKTt9KTtyZXR1cm4gUHJvbWlzZS5hbGwoZGVmcykudGhlbihmdW5jdGlvbigpeyRiYW5uZXIuaW5zZXJ0QmVmb3JlKHNlbGYuJCgnPiAub19jb250ZW50JykpO3NlbGYuXyRiYW5uZXI9JGJhbm5lcjt9KTt9KTt9CnJldHVybiBQcm9taXNlLnJlc29sdmUoKTt9LF9yZW5kZXJDb250cm9sUGFuZWxFbGVtZW50czpmdW5jdGlvbigpe3ZhciBzZWxmPXRoaXM7dmFyIGVsZW1lbnRzPXskYnV0dG9uczokKCc8ZGl2PicpLCRzaWRlYmFyOiQoJzxkaXY+JyksJHBhZ2VyOiQoJzxkaXY+JyksfTt0aGlzLnJlbmRlckJ1dHRvbnMoZWxlbWVudHMuJGJ1dHRvbnMpO3ZhciBzaWRlYmFyUHJvbT10aGlzLnJlbmRlclNpZGViYXIoZWxlbWVudHMuJHNpZGViYXIpO3ZhciBwYWdlclByb209dGhpcy5yZW5kZXJQYWdlcihlbGVtZW50cy4kcGFnZXIpO3JldHVybiBQcm9taXNlLmFsbChbc2lkZWJhclByb20scGFnZXJQcm9tXSkudGhlbihmdW5jdGlvbigpe2VsZW1lbnRzPV8ubWFwT2JqZWN0KGVsZW1lbnRzLGZ1bmN0aW9uKCRub2RlKXtyZXR1cm4gJG5vZGUmJiRub2RlLmNvbnRlbnRzKCk7fSk7ZWxlbWVudHMuJHN3aXRjaF9idXR0b25zPXNlbGYuX3JlbmRlclN3aXRjaEJ1dHRvbnMoKTtyZXR1cm4gZWxlbWVudHM7fSk7fSxfcmVuZGVyU3dpdGNoQnV0dG9uczpmdW5jdGlvbigpe3ZhciBzZWxmPXRoaXM7dmFyIHZpZXdzPV8uZmlsdGVyKHRoaXMuYWN0aW9uVmlld3Mse211bHRpUmVjb3JkOnRoaXMuaXNNdWx0aVJlY29yZH0pO2lmKHZpZXdzLmxlbmd0aDw9MSl7cmV0dXJuICQoKTt9CnZhciB0ZW1wbGF0ZT1jb25maWcuZGV2aWNlLmlzTW9iaWxlPydDb250cm9sUGFuZWwuU3dpdGNoQnV0dG9ucy5Nb2JpbGUnOidDb250cm9sUGFuZWwuU3dpdGNoQnV0dG9ucyc7dmFyICRzd2l0Y2hCdXR0b25zPSQoUVdlYi5yZW5kZXIodGVtcGxhdGUse3ZpZXdUeXBlOnRoaXMudmlld1R5cGUsdmlld3M6dmlld3MsfSkpO18uZWFjaCh2aWV3cyxmdW5jdGlvbih2aWV3KXskc3dpdGNoQnV0dG9ucy5maWx0ZXIoJy5vX2NwX3N3aXRjaF8nK3ZpZXcudHlwZSkudG9vbHRpcCgpO30pO3ZhciAkc3dpdGNoQnV0dG9uc0ZpbHRlcmVkPWNvbmZpZy5kZXZpY2UuaXNNb2JpbGU/JHN3aXRjaEJ1dHRvbnMuZmluZCgnYnV0dG9uJyk6JHN3aXRjaEJ1dHRvbnMuZmlsdGVyKCdidXR0b24nKTskc3dpdGNoQnV0dG9uc0ZpbHRlcmVkLmNsaWNrKF8uZGVib3VuY2UoZnVuY3Rpb24oZXZlbnQpe3ZhciB2aWV3VHlwZT0kKGV2ZW50LnRhcmdldCkuZGF0YSgndmlldy10eXBlJyk7c2VsZi50cmlnZ2VyX3VwKCdzd2l0Y2hfdmlldycse3ZpZXdfdHlwZTp2aWV3VHlwZX0pO30sMjAwLHRydWUpKTtpZihjb25maWcuZGV2aWNlLmlzTW9iaWxlKXt2YXIgYWN0aXZlVmlldz1fLmZpbmRXaGVyZSh2aWV3cyx7dHlwZTp0aGlzLnZpZXdUeXBlfSk7JHN3aXRjaEJ1dHRvbnMuZmluZCgnLm9fc3dpdGNoX3ZpZXdfYnV0dG9uX2ljb24nKS5hZGRDbGFzcygnZmEgZmEtbGcgJythY3RpdmVWaWV3Lmljb24pO30KcmV0dXJuICRzd2l0Y2hCdXR0b25zO30sX3N0YXJ0UmVuZGVyZXI6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5yZW5kZXJlci5hcHBlbmRUbyh0aGlzLiQoJy5vX2NvbnRlbnQnKSk7fSxfdXBkYXRlOmZ1bmN0aW9uKHN0YXRlLHBhcmFtcyl7dmFyIGNwQ29udGVudD1fLmV4dGVuZCh7fSx0aGlzLmNvbnRyb2xQYW5lbEVsZW1lbnRzKTt0aGlzLnVwZGF0ZUNvbnRyb2xQYW5lbCh7YnJlYWRjcnVtYnM6cGFyYW1zJiZwYXJhbXMuYnJlYWRjcnVtYnMsY3BfY29udGVudDpjcENvbnRlbnQsdGl0bGU6dGhpcy5nZXRUaXRsZSgpLH0pO3RoaXMuX3B1c2hTdGF0ZSgpO3JldHVybiB0aGlzLl9yZW5kZXJCYW5uZXIoKTt9LF9vbkFjdGlvbkNsaWNrZWQ6ZnVuY3Rpb24oZXYpe2V2LnByZXZlbnREZWZhdWx0KCk7dmFyICR0YXJnZXQ9JChldi5jdXJyZW50VGFyZ2V0KTt2YXIgc2VsZj10aGlzO3ZhciBkYXRhPSR0YXJnZXQuZGF0YSgpO2lmKGRhdGEubWV0aG9kIT09dW5kZWZpbmVkJiZkYXRhLm1vZGVsIT09dW5kZWZpbmVkKXt2YXIgb3B0aW9ucz17fTtpZihkYXRhLnJlbG9hZE9uQ2xvc2Upe29wdGlvbnMub25fY2xvc2U9ZnVuY3Rpb24oKXtzZWxmLnRyaWdnZXJfdXAoJ3JlbG9hZCcpO307fQp0aGlzLmRwLmFkZCh0aGlzLl9ycGMoe21vZGVsOmRhdGEubW9kZWwsbWV0aG9kOmRhdGEubWV0aG9kLGNvbnRleHQ6c2Vzc2lvbi51c2VyX2NvbnRleHQsfSkpLnRoZW4oZnVuY3Rpb24oYWN0aW9uKXtpZihhY3Rpb24hPT11bmRlZmluZWQpe3NlbGYuZG9fYWN0aW9uKGFjdGlvbixvcHRpb25zKTt9fSk7fWVsc2UgaWYoJHRhcmdldC5hdHRyKCduYW1lJykpe3RoaXMuZG9fYWN0aW9uKCR0YXJnZXQuYXR0cignbmFtZScpLGRhdGEuY29udGV4dCYme2FkZGl0aW9uYWxfY29udGV4dDpkYXRhLmNvbnRleHR9KTt9ZWxzZXt0aGlzLmRvX2FjdGlvbih7bmFtZTokdGFyZ2V0LmF0dHIoJ3RpdGxlJyl8fF8uc3RyLnN0cmlwKCR0YXJnZXQudGV4dCgpKSx0eXBlOidpci5hY3Rpb25zLmFjdF93aW5kb3cnLHJlc19tb2RlbDpkYXRhLm1vZGVsfHx0aGlzLm1vZGVsTmFtZSxyZXNfaWQ6ZGF0YS5yZXNJZCx0YXJnZXQ6J2N1cnJlbnQnLHZpZXdzOmRhdGEudmlld3N8fChkYXRhLnJlc0lkP1tbZmFsc2UsJ2Zvcm0nXV06W1tmYWxzZSwnbGlzdCddLFtmYWxzZSwnZm9ybSddXSksZG9tYWluOmRhdGEuZG9tYWlufHxbXSx9LHthZGRpdGlvbmFsX2NvbnRleHQ6Xy5leHRlbmQoe30sZGF0YS5jb250ZXh0KX0pO319LF9vbkdldENvbnRyb2xsZXJRdWVyeVBhcmFtczpmdW5jdGlvbihldil7ZXYuc3RvcFByb3BhZ2F0aW9uKCk7dmFyIHN0YXRlPXRoaXMuZ2V0T3duZWRRdWVyeVBhcmFtcygpO2V2LmRhdGEuY2FsbGJhY2soc3RhdGV8fHt9KTt9LF9vbk5hdmlnYXRpb25Nb3ZlOmZ1bmN0aW9uKGV2KXtzd2l0Y2goZXYuZGF0YS5kaXJlY3Rpb24pe2Nhc2UndXAnOmV2LnN0b3BQcm9wYWdhdGlvbigpO3RoaXMuX2NvbnRyb2xQYW5lbC5mb2N1c1NlYXJjaEJhcigpO2JyZWFrO2Nhc2UnZG93bic6ZXYuc3RvcFByb3BhZ2F0aW9uKCk7dGhpcy5naXZlRm9jdXMoKTticmVhazt9fSxfb25PcGVuUmVjb3JkOmZ1bmN0aW9uKGV2KXtldi5zdG9wUHJvcGFnYXRpb24oKTt2YXIgcmVjb3JkPXRoaXMubW9kZWwuZ2V0KGV2LmRhdGEuaWQse3Jhdzp0cnVlfSk7dGhpcy50cmlnZ2VyX3VwKCdzd2l0Y2hfdmlldycse3ZpZXdfdHlwZTonZm9ybScscmVzX2lkOnJlY29yZC5yZXNfaWQsbW9kZTpldi5kYXRhLm1vZGV8fCdyZWFkb25seScsbW9kZWw6dGhpcy5tb2RlbE5hbWUsfSk7fSxfb25TZWFyY2g6ZnVuY3Rpb24oZXYpe2V2LnN0b3BQcm9wYWdhdGlvbigpO3RoaXMucmVsb2FkKF8uZXh0ZW5kKHtvZmZzZXQ6MH0sZXYuZGF0YSkpO30sX29uU2VhcmNoUGFuZWxEb21haW5VcGRhdGVkOmZ1bmN0aW9uKGV2KXt0aGlzLnNlYXJjaFBhbmVsRG9tYWluPWV2LmRhdGEuZG9tYWluO3RoaXMucmVsb2FkKHtvZmZzZXQ6MH0pO30sX29uU3dpdGNoVmlldzpmdW5jdGlvbihldil7ZXYuZGF0YS5jb250cm9sbGVySUQ9dGhpcy5jb250cm9sbGVySUQ7fSx9KTtyZXR1cm4gQWJzdHJhY3RDb250cm9sbGVyO30pOzsKCi8qIC93ZWIvc3RhdGljL3NyYy9qcy92aWV3cy9iYXNpYy9iYXNpY19tb2RlbC5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwpvZG9vLmRlZmluZSgnd2ViLkJhc2ljTW9kZWwnLGZ1bmN0aW9uKHJlcXVpcmUpeyJ1c2Ugc3RyaWN0Ijt2YXIgQWJzdHJhY3RNb2RlbD1yZXF1aXJlKCd3ZWIuQWJzdHJhY3RNb2RlbCcpO3ZhciBjb25jdXJyZW5jeT1yZXF1aXJlKCd3ZWIuY29uY3VycmVuY3knKTt2YXIgQ29udGV4dD1yZXF1aXJlKCd3ZWIuQ29udGV4dCcpO3ZhciBjb3JlPXJlcXVpcmUoJ3dlYi5jb3JlJyk7dmFyIERvbWFpbj1yZXF1aXJlKCd3ZWIuRG9tYWluJyk7dmFyIHNlc3Npb249cmVxdWlyZSgnd2ViLnNlc3Npb24nKTt2YXIgdXRpbHM9cmVxdWlyZSgnd2ViLnV0aWxzJyk7dmFyIHZpZXdVdGlscz1yZXF1aXJlKCd3ZWIudmlld1V0aWxzJyk7dmFyIF90PWNvcmUuX3Q7Y29uc3QgQUdHUkVHQVRBQkxFX1RZUEVTPVsnZmxvYXQnLCdpbnRlZ2VyJywnbW9uZXRhcnknXTt2YXIgeDJNYW55Q29tbWFuZHM9e0NSRUFURTowLGNyZWF0ZTpmdW5jdGlvbih2aXJ0dWFsSUQsdmFsdWVzKXtkZWxldGUgdmFsdWVzLmlkO3JldHVyblt4Mk1hbnlDb21tYW5kcy5DUkVBVEUsdmlydHVhbElEfHxmYWxzZSx2YWx1ZXNdO30sVVBEQVRFOjEsdXBkYXRlOmZ1bmN0aW9uKGlkLHZhbHVlcyl7ZGVsZXRlIHZhbHVlcy5pZDtyZXR1cm5beDJNYW55Q29tbWFuZHMuVVBEQVRFLGlkLHZhbHVlc107fSxERUxFVEU6MixkZWxldGU6ZnVuY3Rpb24oaWQpe3JldHVyblt4Mk1hbnlDb21tYW5kcy5ERUxFVEUsaWQsZmFsc2VdO30sRk9SR0VUOjMsZm9yZ2V0OmZ1bmN0aW9uKGlkKXtyZXR1cm5beDJNYW55Q29tbWFuZHMuRk9SR0VULGlkLGZhbHNlXTt9LExJTktfVE86NCxsaW5rX3RvOmZ1bmN0aW9uKGlkKXtyZXR1cm5beDJNYW55Q29tbWFuZHMuTElOS19UTyxpZCxmYWxzZV07fSxERUxFVEVfQUxMOjUsZGVsZXRlX2FsbDpmdW5jdGlvbigpe3JldHVybls1LGZhbHNlLGZhbHNlXTt9LFJFUExBQ0VfV0lUSDo2LHJlcGxhY2Vfd2l0aDpmdW5jdGlvbihpZHMpe3JldHVybls2LGZhbHNlLGlkc107fX07dmFyIEJhc2ljTW9kZWw9QWJzdHJhY3RNb2RlbC5leHRlbmQoe09QRU5fR1JPVVBfTElNSVQ6MTAsbm9DYWNoZU1vZGVsczpbJ2lyLmFjdGlvbnMuYWN0X3dpbmRvdycsJ2lyLmZpbHRlcnMnLCdpci51aS52aWV3JyxdLGluaXQ6ZnVuY3Rpb24oKXt0aGlzLm11dGV4PW5ldyBjb25jdXJyZW5jeS5NdXRleCgpO3RoaXMuYmF0Y2hlZFJQQ3NSZXF1ZXN0cz1bXTt0aGlzLmxvY2FsRGF0YT1PYmplY3QuY3JlYXRlKG51bGwpO3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9LGFkZERlZmF1bHRSZWNvcmQ6ZnVuY3Rpb24obGlzdElELG9wdGlvbnMpe3ZhciBzZWxmPXRoaXM7dmFyIGxpc3Q9dGhpcy5sb2NhbERhdGFbbGlzdElEXTt2YXIgY29udGV4dD1fLmV4dGVuZCh7fSx0aGlzLl9nZXREZWZhdWx0Q29udGV4dChsaXN0KSx0aGlzLl9nZXRDb250ZXh0KGxpc3QpKTt2YXIgcG9zaXRpb249KG9wdGlvbnMmJm9wdGlvbnMucG9zaXRpb24pfHwndG9wJzt2YXIgcGFyYW1zPXtjb250ZXh0OmNvbnRleHQsZmllbGRzOmxpc3QuZmllbGRzLGZpZWxkc0luZm86bGlzdC5maWVsZHNJbmZvLHBhcmVudElEOmxpc3QuaWQscG9zaXRpb246cG9zaXRpb24sdmlld1R5cGU6bGlzdC52aWV3VHlwZSx9O3JldHVybiB0aGlzLl9tYWtlRGVmYXVsdFJlY29yZChsaXN0Lm1vZGVsLHBhcmFtcykudGhlbihmdW5jdGlvbihpZCl7bGlzdC5jb3VudCsrO2lmKHBvc2l0aW9uPT09J3RvcCcpe2xpc3QuZGF0YS51bnNoaWZ0KGlkKTt9ZWxzZXtsaXN0LmRhdGEucHVzaChpZCk7fQp2YXIgcmVjb3JkPXNlbGYubG9jYWxEYXRhW2lkXTtsaXN0Ll9jYWNoZVtyZWNvcmQucmVzX2lkXT1pZDtyZXR1cm4gaWQ7fSk7fSxhZGRGaWVsZHNJbmZvOmZ1bmN0aW9uKHJlY29yZElELHZpZXdJbmZvKXt2YXIgcmVjb3JkPXRoaXMubG9jYWxEYXRhW3JlY29yZElEXTtyZWNvcmQuZmllbGRzPV8uZXh0ZW5kKHt9LHJlY29yZC5maWVsZHMsdmlld0luZm8uZmllbGRzKTt2YXIgZmllbGRzSW5mbz1fLm1hcE9iamVjdCh2aWV3SW5mby5maWVsZHNJbmZvLGZ1bmN0aW9uKGZpZWxkc0luZm8pe3JldHVybiBfLmRlZmF1bHRzKHt9LGZpZWxkc0luZm8scmVjb3JkLmZpZWxkc0luZm9bcmVjb3JkLnZpZXdUeXBlXSk7fSk7cmVjb3JkLmZpZWxkc0luZm89Xy5leHRlbmQoe30scmVjb3JkLmZpZWxkc0luZm8sZmllbGRzSW5mbyk7fSxhcHBseURlZmF1bHRWYWx1ZXM6ZnVuY3Rpb24ocmVjb3JkSUQsdmFsdWVzLG9wdGlvbnMpe29wdGlvbnM9b3B0aW9uc3x8e307dmFyIHJlY29yZD10aGlzLmxvY2FsRGF0YVtyZWNvcmRJRF07dmFyIHZpZXdUeXBlPW9wdGlvbnMudmlld1R5cGV8fHJlY29yZC52aWV3VHlwZTt2YXIgZmllbGROYW1lcz1vcHRpb25zLmZpZWxkTmFtZXN8fE9iamVjdC5rZXlzKHJlY29yZC5maWVsZHNJbmZvW3ZpZXdUeXBlXSk7dmFyIGZpZWxkO3ZhciBmaWVsZE5hbWU7cmVjb3JkLl9jaGFuZ2VzPXJlY29yZC5fY2hhbmdlc3x8e307dmFsdWVzPV8ucGljayh2YWx1ZXMsZmllbGROYW1lcyk7Zm9yKHZhciBpPTA7aTxmaWVsZE5hbWVzLmxlbmd0aDtpKyspe2ZpZWxkTmFtZT1maWVsZE5hbWVzW2ldO2lmKCEoZmllbGROYW1lIGluIHZhbHVlcykmJiEoZmllbGROYW1lIGluIHJlY29yZC5fY2hhbmdlcykpe2ZpZWxkPXJlY29yZC5maWVsZHNbZmllbGROYW1lXTtpZihmaWVsZC50eXBlPT09J2Zsb2F0J3x8ZmllbGQudHlwZT09PSdpbnRlZ2VyJ3x8ZmllbGQudHlwZT09PSdtb25ldGFyeScpe3ZhbHVlc1tmaWVsZE5hbWVdPTA7fWVsc2UgaWYoZmllbGQudHlwZT09PSdvbmUybWFueSd8fGZpZWxkLnR5cGU9PT0nbWFueTJtYW55Jyl7dmFsdWVzW2ZpZWxkTmFtZV09W107fWVsc2V7dmFsdWVzW2ZpZWxkTmFtZV09bnVsbDt9fX0KdmFyIGRlZnM9W107Zm9yKGZpZWxkTmFtZSBpbiB2YWx1ZXMpe2ZpZWxkPXJlY29yZC5maWVsZHNbZmllbGROYW1lXTtyZWNvcmQuZGF0YVtmaWVsZE5hbWVdPW51bGw7dmFyIGRwO2lmKGZpZWxkLnR5cGU9PT0nbWFueTJvbmUnJiZ2YWx1ZXNbZmllbGROYW1lXSl7ZHA9dGhpcy5fbWFrZURhdGFQb2ludCh7Y29udGV4dDpyZWNvcmQuY29udGV4dCxkYXRhOntpZDp2YWx1ZXNbZmllbGROYW1lXX0sbW9kZWxOYW1lOmZpZWxkLnJlbGF0aW9uLHBhcmVudElEOnJlY29yZC5pZCx9KTtyZWNvcmQuX2NoYW5nZXNbZmllbGROYW1lXT1kcC5pZDt9ZWxzZSBpZihmaWVsZC50eXBlPT09J3JlZmVyZW5jZScmJnZhbHVlc1tmaWVsZE5hbWVdKXt2YXIgcmVmPXZhbHVlc1tmaWVsZE5hbWVdLnNwbGl0KCcsJyk7ZHA9dGhpcy5fbWFrZURhdGFQb2ludCh7Y29udGV4dDpyZWNvcmQuY29udGV4dCxkYXRhOntpZDpwYXJzZUludChyZWZbMV0pfSxtb2RlbE5hbWU6cmVmWzBdLHBhcmVudElEOnJlY29yZC5pZCx9KTtkZWZzLnB1c2godGhpcy5fZmV0Y2hOYW1lR2V0KGRwKSk7cmVjb3JkLl9jaGFuZ2VzW2ZpZWxkTmFtZV09ZHAuaWQ7fWVsc2UgaWYoZmllbGQudHlwZT09PSdvbmUybWFueSd8fGZpZWxkLnR5cGU9PT0nbWFueTJtYW55Jyl7ZGVmcy5wdXNoKHRoaXMuX3Byb2Nlc3NYMk1hbnlDb21tYW5kcyhyZWNvcmQsZmllbGROYW1lLHZhbHVlc1tmaWVsZE5hbWVdLG9wdGlvbnMpKTt9ZWxzZXtyZWNvcmQuX2NoYW5nZXNbZmllbGROYW1lXT10aGlzLl9wYXJzZVNlcnZlclZhbHVlKGZpZWxkLHZhbHVlc1tmaWVsZE5hbWVdKTt9fQpyZXR1cm4gUHJvbWlzZS5hbGwoZGVmcyk7fSxhcHBseVJhd0NoYW5nZXM6ZnVuY3Rpb24ocmVjb3JkSUQsdmlld1R5cGUpe3ZhciByZWNvcmQ9dGhpcy5sb2NhbERhdGFbcmVjb3JkSURdO3JldHVybiB0aGlzLl9hcHBseU9uQ2hhbmdlKHJlY29yZC5fcmF3Q2hhbmdlcyxyZWNvcmQsdmlld1R5cGUpLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gcmVjb3JkLmlkO30pO30sY2FuQmVBYmFuZG9uZWQ6ZnVuY3Rpb24oaWQpe2lmKHRoaXMubG9jYWxEYXRhW2lkXS5fbm9BYmFuZG9uKXtyZXR1cm4gZmFsc2U7fQp2YXIgcmVjb3JkPXRoaXMubG9jYWxEYXRhW2lkXTt2YXIgcGFyZW50PXRoaXMubG9jYWxEYXRhW3JlY29yZC5wYXJlbnRJRF07aWYocGFyZW50KXt2YXIgZW50cnk9Xy5maW5kV2hlcmUocGFyZW50Ll9zYXZlUG9pbnQse29wZXJhdGlvbjonQUREJyxpZDppZH0pO2lmKGVudHJ5KXtpZighZW50cnkuaXNOZXcpe3JldHVybiBmYWxzZTt9CnZhciBsYXN0RW50cnk9Xy5sYXN0KHBhcmVudC5fc2F2ZVBvaW50KTtpZihsYXN0RW50cnkub3BlcmF0aW9uPT09J1VQREFURScmJmxhc3RFbnRyeS5pZD09PWlkKXtyZXR1cm4gZmFsc2U7fX19CnJldHVybiB0aGlzLmlzTmV3KGlkKTt9LGRlbGV0ZVJlY29yZHM6ZnVuY3Rpb24ocmVjb3JkSWRzLG1vZGVsTmFtZSl7dmFyIHNlbGY9dGhpczt2YXIgcmVjb3Jkcz1fLm1hcChyZWNvcmRJZHMsZnVuY3Rpb24oaWQpe3JldHVybiBzZWxmLmxvY2FsRGF0YVtpZF07fSk7dmFyIGNvbnRleHQ9Xy5leHRlbmQocmVjb3Jkc1swXS5nZXRDb250ZXh0KCksc2Vzc2lvbi51c2VyX2NvbnRleHQpO3JldHVybiB0aGlzLl9ycGMoe21vZGVsOm1vZGVsTmFtZSxtZXRob2Q6J3VubGluaycsYXJnczpbXy5wbHVjayhyZWNvcmRzLCdyZXNfaWQnKV0sY29udGV4dDpjb250ZXh0LH0pLnRoZW4oZnVuY3Rpb24oKXtfLmVhY2gocmVjb3JkcyxmdW5jdGlvbihyZWNvcmQpe3ZhciBwYXJlbnQ9cmVjb3JkLnBhcmVudElEJiZzZWxmLmxvY2FsRGF0YVtyZWNvcmQucGFyZW50SURdO2lmKHBhcmVudCYmcGFyZW50LnR5cGU9PT0nbGlzdCcpe3BhcmVudC5kYXRhPV8ud2l0aG91dChwYXJlbnQuZGF0YSxyZWNvcmQuaWQpO2RlbGV0ZSBzZWxmLmxvY2FsRGF0YVtyZWNvcmQuaWRdO31lbHNle3JlY29yZC5yZXNfaWRzLnNwbGljZShyZWNvcmQub2Zmc2V0LDEpO3JlY29yZC5vZmZzZXQ9TWF0aC5taW4ocmVjb3JkLm9mZnNldCxyZWNvcmQucmVzX2lkcy5sZW5ndGgtMSk7cmVjb3JkLnJlc19pZD1yZWNvcmQucmVzX2lkc1tyZWNvcmQub2Zmc2V0XTtyZWNvcmQuY291bnQtLTt9fSk7c2VsZi5faW52YWxpZGF0ZUNhY2hlKHJlY29yZHNbMF0pO30pO30sZGlzY2FyZENoYW5nZXM6ZnVuY3Rpb24oaWQsb3B0aW9ucyl7b3B0aW9ucz1vcHRpb25zfHx7fTt2YXIgZWxlbWVudD10aGlzLmxvY2FsRGF0YVtpZF07dmFyIGlzTmV3PXRoaXMuaXNOZXcoaWQpO3ZhciByb2xsYmFjaz0ncm9sbGJhY2snaW4gb3B0aW9ucz9vcHRpb25zLnJvbGxiYWNrOmlzTmV3O3ZhciBpbml0aWFsT2Zmc2V0PWVsZW1lbnQub2Zmc2V0O2VsZW1lbnQuX2RvbWFpbnM9e307dGhpcy5fdmlzaXRDaGlsZHJlbihlbGVtZW50LGZ1bmN0aW9uKGVsZW0pe2lmKHJvbGxiYWNrJiZlbGVtLl9zYXZlUG9pbnQpe2lmKGVsZW0uX3NhdmVQb2ludCBpbnN0YW5jZW9mIEFycmF5KXtlbGVtLl9jaGFuZ2VzPWVsZW0uX3NhdmVQb2ludC5zbGljZSgwKTt9ZWxzZXtlbGVtLl9jaGFuZ2VzPV8uZXh0ZW5kKHt9LGVsZW0uX3NhdmVQb2ludCk7fQplbGVtLl9pc0RpcnR5PSFpc05ldzt9ZWxzZXtlbGVtLl9jaGFuZ2VzPW51bGw7ZWxlbS5faXNEaXJ0eT1mYWxzZTt9CmVsZW0ub2Zmc2V0PTA7aWYoZWxlbS50ZW1wTGltaXRJbmNyZW1lbnQpe2VsZW0ubGltaXQtPWVsZW0udGVtcExpbWl0SW5jcmVtZW50O2RlbGV0ZSBlbGVtLnRlbXBMaW1pdEluY3JlbWVudDt9fSk7ZWxlbWVudC5vZmZzZXQ9aW5pdGlhbE9mZnNldDt9LGR1cGxpY2F0ZVJlY29yZDpmdW5jdGlvbihyZWNvcmRJRCl7dmFyIHNlbGY9dGhpczt2YXIgcmVjb3JkPXRoaXMubG9jYWxEYXRhW3JlY29yZElEXTt2YXIgY29udGV4dD10aGlzLl9nZXRDb250ZXh0KHJlY29yZCk7cmV0dXJuIHRoaXMuX3JwYyh7bW9kZWw6cmVjb3JkLm1vZGVsLG1ldGhvZDonY29weScsYXJnczpbcmVjb3JkLmRhdGEuaWRdLGNvbnRleHQ6Y29udGV4dCx9KS50aGVuKGZ1bmN0aW9uKHJlc19pZCl7dmFyIGluZGV4PXJlY29yZC5yZXNfaWRzLmluZGV4T2YocmVjb3JkLnJlc19pZCk7cmVjb3JkLnJlc19pZHMuc3BsaWNlKGluZGV4KzEsMCxyZXNfaWQpO3JldHVybiBzZWxmLmxvYWQoe2ZpZWxkc0luZm86cmVjb3JkLmZpZWxkc0luZm8sZmllbGRzOnJlY29yZC5maWVsZHMsbW9kZWxOYW1lOnJlY29yZC5tb2RlbCxyZXNfaWQ6cmVzX2lkLHJlc19pZHM6cmVjb3JkLnJlc19pZHMuc2xpY2UoMCksdmlld1R5cGU6cmVjb3JkLnZpZXdUeXBlLGNvbnRleHQ6Y29udGV4dCx9KTt9KTt9LGZyZWV6ZU9yZGVyOmZ1bmN0aW9uKGxpc3RJRCl7dmFyIGxpc3Q9dGhpcy5sb2NhbERhdGFbbGlzdElEXTtpZihsaXN0LnR5cGU9PT0ncmVjb3JkJyl7cmV0dXJuO30KbGlzdD10aGlzLl9hcHBseVgyTWFueU9wZXJhdGlvbnMobGlzdCk7dGhpcy5fc29ydExpc3QobGlzdCk7dGhpcy5sb2NhbERhdGFbbGlzdElEXS5vcmRlcmVkUmVzSURzPWxpc3QucmVzX2lkczt9LGdldDpmdW5jdGlvbihpZCxvcHRpb25zKXt2YXIgc2VsZj10aGlzO29wdGlvbnM9b3B0aW9uc3x8e307aWYoIShpZCBpbiB0aGlzLmxvY2FsRGF0YSkpe3JldHVybiBudWxsO30KdmFyIGVsZW1lbnQ9dGhpcy5sb2NhbERhdGFbaWRdO2lmKG9wdGlvbnMuZW52KXt2YXIgZW52PXtpZHM6ZWxlbWVudC5yZXNfaWRzP2VsZW1lbnQucmVzX2lkcy5zbGljZSgwKTpbXSx9O2lmKGVsZW1lbnQudHlwZT09PSdyZWNvcmQnKXtlbnYuY3VycmVudElkPXRoaXMuaXNOZXcoZWxlbWVudC5pZCk/dW5kZWZpbmVkOmVsZW1lbnQucmVzX2lkO30KcmV0dXJuIGVudjt9CmlmKGVsZW1lbnQudHlwZT09PSdyZWNvcmQnKXt2YXIgZGF0YT1fLmV4dGVuZCh7fSxlbGVtZW50LmRhdGEsZWxlbWVudC5fY2hhbmdlcyk7dmFyIHJlbERhdGFQb2ludDtmb3IodmFyIGZpZWxkTmFtZSBpbiBkYXRhKXt2YXIgZmllbGQ9ZWxlbWVudC5maWVsZHNbZmllbGROYW1lXTtpZihkYXRhW2ZpZWxkTmFtZV09PT1udWxsKXtkYXRhW2ZpZWxkTmFtZV09ZmFsc2U7fQppZighZmllbGQpe2NvbnRpbnVlO30KaWYoZmllbGQudHlwZT09PSdtYW55Mm9uZScpe2lmKG9wdGlvbnMucmF3KXtyZWxEYXRhUG9pbnQ9dGhpcy5sb2NhbERhdGFbZGF0YVtmaWVsZE5hbWVdXTtkYXRhW2ZpZWxkTmFtZV09cmVsRGF0YVBvaW50P3JlbERhdGFQb2ludC5yZXNfaWQ6ZmFsc2U7fWVsc2V7ZGF0YVtmaWVsZE5hbWVdPXRoaXMuZ2V0KGRhdGFbZmllbGROYW1lXSl8fGZhbHNlO319ZWxzZSBpZihmaWVsZC50eXBlPT09J3JlZmVyZW5jZScpe2lmKG9wdGlvbnMucmF3KXtyZWxEYXRhUG9pbnQ9dGhpcy5sb2NhbERhdGFbZGF0YVtmaWVsZE5hbWVdXTtkYXRhW2ZpZWxkTmFtZV09cmVsRGF0YVBvaW50P3JlbERhdGFQb2ludC5tb2RlbCsnLCcrcmVsRGF0YVBvaW50LnJlc19pZDpmYWxzZTt9ZWxzZXtkYXRhW2ZpZWxkTmFtZV09dGhpcy5nZXQoZGF0YVtmaWVsZE5hbWVdKXx8ZmFsc2U7fX1lbHNlIGlmKGZpZWxkLnR5cGU9PT0nb25lMm1hbnknfHxmaWVsZC50eXBlPT09J21hbnkybWFueScpe2lmKG9wdGlvbnMucmF3KXtpZih0eXBlb2YgZGF0YVtmaWVsZE5hbWVdPT09J3N0cmluZycpe3JlbERhdGFQb2ludD10aGlzLmxvY2FsRGF0YVtkYXRhW2ZpZWxkTmFtZV1dO3JlbERhdGFQb2ludD10aGlzLl9hcHBseVgyTWFueU9wZXJhdGlvbnMocmVsRGF0YVBvaW50KTtkYXRhW2ZpZWxkTmFtZV09cmVsRGF0YVBvaW50LnJlc19pZHM7fWVsc2V7ZGF0YVtmaWVsZE5hbWVdPWRhdGFbZmllbGROYW1lXXx8W107fX1lbHNle2RhdGFbZmllbGROYW1lXT10aGlzLmdldChkYXRhW2ZpZWxkTmFtZV0pfHxbXTt9fX0KdmFyIHJlY29yZD17Y29udGV4dDpfLmV4dGVuZCh7fSxlbGVtZW50LmNvbnRleHQpLGNvdW50OmVsZW1lbnQuY291bnQsZGF0YTpkYXRhLGRvbWFpbjplbGVtZW50LmRvbWFpbi5zbGljZSgwKSxldmFsTW9kaWZpZXJzOmVsZW1lbnQuZXZhbE1vZGlmaWVycyxmaWVsZHM6ZWxlbWVudC5maWVsZHMsZmllbGRzSW5mbzplbGVtZW50LmZpZWxkc0luZm8sZ2V0Q29udGV4dDplbGVtZW50LmdldENvbnRleHQsZ2V0RG9tYWluOmVsZW1lbnQuZ2V0RG9tYWluLGdldEZpZWxkTmFtZXM6ZWxlbWVudC5nZXRGaWVsZE5hbWVzLGlkOmVsZW1lbnQuaWQsaXNEaXJ0eTplbGVtZW50LmlzRGlydHksbGltaXQ6ZWxlbWVudC5saW1pdCxtb2RlbDplbGVtZW50Lm1vZGVsLG9mZnNldDplbGVtZW50Lm9mZnNldCxyZWY6ZWxlbWVudC5yZWYscmVzX2lkczplbGVtZW50LnJlc19pZHMuc2xpY2UoMCksc3BlY2lhbERhdGE6Xy5leHRlbmQoe30sZWxlbWVudC5zcGVjaWFsRGF0YSksdHlwZToncmVjb3JkJyx2aWV3VHlwZTplbGVtZW50LnZpZXdUeXBlLH07aWYoIXRoaXMuaXNOZXcoZWxlbWVudC5pZCkpe3JlY29yZC5yZXNfaWQ9ZWxlbWVudC5yZXNfaWQ7fQp2YXIgZXZhbENvbnRleHQ7T2JqZWN0LmRlZmluZVByb3BlcnR5KHJlY29yZCwnZXZhbENvbnRleHQnLHtnZXQ6ZnVuY3Rpb24oKXtldmFsQ29udGV4dD1ldmFsQ29udGV4dHx8c2VsZi5fZ2V0RXZhbENvbnRleHQoZWxlbWVudCk7cmV0dXJuIGV2YWxDb250ZXh0O30sfSk7cmV0dXJuIHJlY29yZDt9CmVsZW1lbnQ9dGhpcy5fYXBwbHlYMk1hbnlPcGVyYXRpb25zKGVsZW1lbnQpO3RoaXMuX3NvcnRMaXN0KGVsZW1lbnQpO2lmKCFlbGVtZW50Lm9yZGVyZWRSZXNJRHMmJmVsZW1lbnQuX2NoYW5nZXMpe18uZWFjaChlbGVtZW50Ll9jaGFuZ2VzLGZ1bmN0aW9uKGNoYW5nZSl7aWYoY2hhbmdlLm9wZXJhdGlvbj09PSdBREQnJiZjaGFuZ2UuaXNOZXcpe2VsZW1lbnQuZGF0YT1fLndpdGhvdXQoZWxlbWVudC5kYXRhLGNoYW5nZS5pZCk7aWYoY2hhbmdlLnBvc2l0aW9uPT09J3RvcCcpe2VsZW1lbnQuZGF0YS51bnNoaWZ0KGNoYW5nZS5pZCk7fWVsc2V7ZWxlbWVudC5kYXRhLnB1c2goY2hhbmdlLmlkKTt9fX0pO30KdmFyIGxpc3Q9e2FnZ3JlZ2F0ZVZhbHVlczpfLmV4dGVuZCh7fSxlbGVtZW50LmFnZ3JlZ2F0ZVZhbHVlcyksY29udGV4dDpfLmV4dGVuZCh7fSxlbGVtZW50LmNvbnRleHQpLGNvdW50OmVsZW1lbnQuY291bnQsZGF0YTpfLm1hcChlbGVtZW50LmRhdGEsZnVuY3Rpb24oZWxlbUlEKXtyZXR1cm4gc2VsZi5nZXQoZWxlbUlELG9wdGlvbnMpO30pLGRvbWFpbjplbGVtZW50LmRvbWFpbi5zbGljZSgwKSxmaWVsZHM6ZWxlbWVudC5maWVsZHMsZ2V0Q29udGV4dDplbGVtZW50LmdldENvbnRleHQsZ2V0RG9tYWluOmVsZW1lbnQuZ2V0RG9tYWluLGdldEZpZWxkTmFtZXM6ZWxlbWVudC5nZXRGaWVsZE5hbWVzLGdyb3VwZWRCeTplbGVtZW50Lmdyb3VwZWRCeSxncm91cHNDb3VudDplbGVtZW50Lmdyb3Vwc0NvdW50LGdyb3Vwc0xpbWl0OmVsZW1lbnQuZ3JvdXBzTGltaXQsZ3JvdXBzT2Zmc2V0OmVsZW1lbnQuZ3JvdXBzT2Zmc2V0LGlkOmVsZW1lbnQuaWQsaXNEaXJ0eTplbGVtZW50LmlzRGlydHksaXNPcGVuOmVsZW1lbnQuaXNPcGVuLGxpbWl0OmVsZW1lbnQubGltaXQsbW9kZWw6ZWxlbWVudC5tb2RlbCxvZmZzZXQ6ZWxlbWVudC5vZmZzZXQsb3JkZXJlZEJ5OmVsZW1lbnQub3JkZXJlZEJ5LHJlc19pZDplbGVtZW50LnJlc19pZCxyZXNfaWRzOmVsZW1lbnQucmVzX2lkcy5zbGljZSgwKSx0eXBlOidsaXN0Jyx2YWx1ZTplbGVtZW50LnZhbHVlLHZpZXdUeXBlOmVsZW1lbnQudmlld1R5cGUsfTtpZihlbGVtZW50LmZpZWxkc0luZm8pe2xpc3QuZmllbGRzSW5mbz1lbGVtZW50LmZpZWxkc0luZm87fQpyZXR1cm4gbGlzdDt9LGdldE5hbWU6ZnVuY3Rpb24oaWQpe3ZhciByZWNvcmQ9dGhpcy5sb2NhbERhdGFbaWRdO3ZhciByZXR1cm5WYWx1ZT0nJztpZihyZWNvcmQuX2NoYW5nZXMmJidkaXNwbGF5X25hbWUnaW4gcmVjb3JkLl9jaGFuZ2VzKXtyZXR1cm5WYWx1ZT1yZWNvcmQuX2NoYW5nZXMuZGlzcGxheV9uYW1lO30KZWxzZSBpZignZGlzcGxheV9uYW1lJ2luIHJlY29yZC5kYXRhKXtyZXR1cm5WYWx1ZT1yZWNvcmQuZGF0YS5kaXNwbGF5X25hbWU7fQpyZXR1cm4gcmV0dXJuVmFsdWV8fF90KCJOZXciKTt9LGlzRGlydHk6ZnVuY3Rpb24oaWQpe3ZhciBpc0RpcnR5PWZhbHNlO3RoaXMuX3Zpc2l0Q2hpbGRyZW4odGhpcy5sb2NhbERhdGFbaWRdLGZ1bmN0aW9uKHIpe2lmKHIuX2lzRGlydHkpe2lzRGlydHk9dHJ1ZTt9fSk7cmV0dXJuIGlzRGlydHk7fSxpc05ldzpmdW5jdGlvbihpZCl7dmFyIGRhdGE9dGhpcy5sb2NhbERhdGFbaWRdO2lmKGRhdGEudHlwZSE9PSJyZWNvcmQiKXtyZXR1cm4gZmFsc2U7fQp2YXIgcmVzX2lkPWRhdGEucmVzX2lkO2lmKHR5cGVvZiByZXNfaWQ9PT0nbnVtYmVyJyl7cmV0dXJuIGZhbHNlO31lbHNlIGlmKHR5cGVvZiByZXNfaWQ9PT0nc3RyaW5nJyYmL15bMC05XSstLy50ZXN0KHJlc19pZCkpe3JldHVybiBmYWxzZTt9CnJldHVybiB0cnVlO30sbG9hZDpmdW5jdGlvbihwYXJhbXMpe3BhcmFtcy50eXBlPXBhcmFtcy50eXBlfHwocGFyYW1zLnJlc19pZCE9PXVuZGVmaW5lZD8ncmVjb3JkJzonbGlzdCcpO3BhcmFtcy52aWV3VHlwZT1wYXJhbXMudmlld1R5cGV8fCdkZWZhdWx0JztpZighcGFyYW1zLmZpZWxkc0luZm8pe3ZhciBmaWVsZHNJbmZvPXt9O2Zvcih2YXIgZmllbGROYW1lIGluIHBhcmFtcy5maWVsZE5hbWVzKXtmaWVsZHNJbmZvW3BhcmFtcy5maWVsZE5hbWVzW2ZpZWxkTmFtZV1dPXt9O30KcGFyYW1zLmZpZWxkc0luZm89e307cGFyYW1zLmZpZWxkc0luZm9bcGFyYW1zLnZpZXdUeXBlXT1maWVsZHNJbmZvO30KaWYocGFyYW1zLnR5cGU9PT0ncmVjb3JkJyYmcGFyYW1zLnJlc19pZD09PXVuZGVmaW5lZCl7cGFyYW1zLmFsbG93V2FybmluZz10cnVlO3JldHVybiB0aGlzLl9tYWtlRGVmYXVsdFJlY29yZChwYXJhbXMubW9kZWxOYW1lLHBhcmFtcyk7fQp2YXIgZGF0YVBvaW50PXRoaXMuX21ha2VEYXRhUG9pbnQocGFyYW1zKTtyZXR1cm4gdGhpcy5fbG9hZChkYXRhUG9pbnQpLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gZGF0YVBvaW50LmlkO30pO30sbWFrZVJlY29yZDpmdW5jdGlvbihtb2RlbCxmaWVsZHMsZmllbGRJbmZvKXt2YXIgc2VsZj10aGlzO3ZhciBkZWZzPVtdO3ZhciByZWNvcmRfZmllbGRzPXt9O18uZWFjaChmaWVsZHMsZnVuY3Rpb24oZmllbGQpe3JlY29yZF9maWVsZHNbZmllbGQubmFtZV09Xy5waWNrKGZpZWxkLCd0eXBlJywncmVsYXRpb24nLCdkb21haW4nLCdzZWxlY3Rpb24nKTt9KTtmaWVsZEluZm89ZmllbGRJbmZvfHx7fTt2YXIgZmllbGRzSW5mbz17fTtmaWVsZHNJbmZvLmRlZmF1bHQ9e307Xy5lYWNoKGZpZWxkcyxmdW5jdGlvbihmaWVsZCl7ZmllbGRzSW5mby5kZWZhdWx0W2ZpZWxkLm5hbWVdPWZpZWxkSW5mb1tmaWVsZC5uYW1lXXx8e307fSk7dmFyIHJlY29yZD10aGlzLl9tYWtlRGF0YVBvaW50KHttb2RlbE5hbWU6bW9kZWwsZmllbGRzOnJlY29yZF9maWVsZHMsZmllbGRzSW5mbzpmaWVsZHNJbmZvLHZpZXdUeXBlOidkZWZhdWx0Jyx9KTtfLmVhY2goZmllbGRzLGZ1bmN0aW9uKGZpZWxkKXt2YXIgZGF0YVBvaW50O3JlY29yZC5kYXRhW2ZpZWxkLm5hbWVdPW51bGw7aWYoZmllbGQudHlwZT09PSdtYW55Mm9uZScpe2lmKGZpZWxkLnZhbHVlKXt2YXIgaWQ9Xy5pc0FycmF5KGZpZWxkLnZhbHVlKT9maWVsZC52YWx1ZVswXTpmaWVsZC52YWx1ZTt2YXIgZGlzcGxheV9uYW1lPV8uaXNBcnJheShmaWVsZC52YWx1ZSk/ZmllbGQudmFsdWVbMV06dW5kZWZpbmVkO2RhdGFQb2ludD1zZWxmLl9tYWtlRGF0YVBvaW50KHttb2RlbE5hbWU6ZmllbGQucmVsYXRpb24sZGF0YTp7aWQ6aWQsZGlzcGxheV9uYW1lOmRpc3BsYXlfbmFtZSx9LHBhcmVudElEOnJlY29yZC5pZCx9KTtyZWNvcmQuZGF0YVtmaWVsZC5uYW1lXT1kYXRhUG9pbnQuaWQ7aWYoZGlzcGxheV9uYW1lPT09dW5kZWZpbmVkKXtkZWZzLnB1c2goc2VsZi5fZmV0Y2hOYW1lR2V0KGRhdGFQb2ludCkpO319fWVsc2UgaWYoZmllbGQudHlwZT09PSdvbmUybWFueSd8fGZpZWxkLnR5cGU9PT0nbWFueTJtYW55Jyl7dmFyIHJlbGF0ZWRGaWVsZHNJbmZvPXt9O3JlbGF0ZWRGaWVsZHNJbmZvLmRlZmF1bHQ9e307Xy5lYWNoKGZpZWxkLmZpZWxkcyxmdW5jdGlvbihmaWVsZCl7cmVsYXRlZEZpZWxkc0luZm8uZGVmYXVsdFtmaWVsZC5uYW1lXT17fTt9KTt2YXIgZHBQYXJhbXM9e2ZpZWxkc0luZm86cmVsYXRlZEZpZWxkc0luZm8sbW9kZWxOYW1lOmZpZWxkLnJlbGF0aW9uLHBhcmVudElEOnJlY29yZC5pZCxzdGF0aWM6dHJ1ZSx0eXBlOidsaXN0Jyx2aWV3VHlwZTonZGVmYXVsdCcsfTt2YXIgbmVlZExvYWQ9ZmFsc2U7aWYoZmllbGQudmFsdWUmJmZpZWxkLnZhbHVlLmxlbmd0aCl7aWYoXy5pc09iamVjdChmaWVsZC52YWx1ZVswXSkpe2RwUGFyYW1zLnJlc19pZHM9Xy5wbHVjayhmaWVsZC52YWx1ZSwnaWQnKTtkYXRhUG9pbnQ9c2VsZi5fbWFrZURhdGFQb2ludChkcFBhcmFtcyk7Xy5lYWNoKGZpZWxkLnZhbHVlLGZ1bmN0aW9uKGRhdGEpe3ZhciByZWNvcmREUD1zZWxmLl9tYWtlRGF0YVBvaW50KHtkYXRhOmRhdGEsbW9kZWxOYW1lOmZpZWxkLnJlbGF0aW9uLHBhcmVudElEOmRhdGFQb2ludC5pZCx0eXBlOidyZWNvcmQnLH0pO2RhdGFQb2ludC5kYXRhLnB1c2gocmVjb3JkRFAuaWQpO2RhdGFQb2ludC5fY2FjaGVbcmVjb3JkRFAucmVzX2lkXT1yZWNvcmREUC5pZDt9KTt9ZWxzZXtkcFBhcmFtcy5yZXNfaWRzPWZpZWxkLnZhbHVlO2RhdGFQb2ludD1zZWxmLl9tYWtlRGF0YVBvaW50KGRwUGFyYW1zKTtuZWVkTG9hZD10cnVlO319ZWxzZXtkcFBhcmFtcy5yZXNfaWRzPVtdO2RhdGFQb2ludD1zZWxmLl9tYWtlRGF0YVBvaW50KGRwUGFyYW1zKTt9CmlmKG5lZWRMb2FkKXtkZWZzLnB1c2goc2VsZi5fbG9hZChkYXRhUG9pbnQpKTt9CnJlY29yZC5kYXRhW2ZpZWxkLm5hbWVdPWRhdGFQb2ludC5pZDt9ZWxzZSBpZihmaWVsZC52YWx1ZSl7cmVjb3JkLmRhdGFbZmllbGQubmFtZV09ZmllbGQudmFsdWU7fX0pO3JldHVybiBQcm9taXNlLmFsbChkZWZzKS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIHJlY29yZC5pZDt9KTt9LG5vdGlmeUNoYW5nZXM6ZnVuY3Rpb24ocmVjb3JkX2lkLGNoYW5nZXMsb3B0aW9ucyl7cmV0dXJuIHRoaXMubXV0ZXguZXhlYyh0aGlzLl9hcHBseUNoYW5nZS5iaW5kKHRoaXMscmVjb3JkX2lkLGNoYW5nZXMsb3B0aW9ucykpO30scmVsb2FkOmZ1bmN0aW9uKGlkLG9wdGlvbnMpe3JldHVybiB0aGlzLm11dGV4LmV4ZWModGhpcy5fcmVsb2FkLmJpbmQodGhpcyxpZCxvcHRpb25zKSk7fSxyZW1vdmVMaW5lOmZ1bmN0aW9uKGVsZW1lbnRJRCl7dmFyIHJlY29yZD10aGlzLmxvY2FsRGF0YVtlbGVtZW50SURdO3ZhciBwYXJlbnQ9dGhpcy5sb2NhbERhdGFbcmVjb3JkLnBhcmVudElEXTtpZihwYXJlbnQuc3RhdGljKXtwYXJlbnQuX2NoYW5nZXM9Xy5maWx0ZXIocGFyZW50Ll9jaGFuZ2VzLGZ1bmN0aW9uKGNoYW5nZSl7aWYoY2hhbmdlLmlkPT09ZWxlbWVudElEJiZjaGFuZ2Uub3BlcmF0aW9uPT09J0FERCcmJnBhcmVudC50ZW1wTGltaXRJbmNyZW1lbnQpe3BhcmVudC50ZW1wTGltaXRJbmNyZW1lbnQtLTtwYXJlbnQubGltaXQtLTt9CnJldHVybiBjaGFuZ2UuaWQhPT1lbGVtZW50SUQ7fSk7fWVsc2V7cGFyZW50LmRhdGE9Xy53aXRob3V0KHBhcmVudC5kYXRhLGVsZW1lbnRJRCk7cGFyZW50LmNvdW50LS07fX0scmVzZXF1ZW5jZTpmdW5jdGlvbihtb2RlbE5hbWUscmVzSURzLHBhcmVudElELG9wdGlvbnMpe29wdGlvbnM9b3B0aW9uc3x8e307aWYoKHJlc0lEcy5sZW5ndGg8PTEpKXtyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHBhcmVudElEKTt9CnZhciBzZWxmPXRoaXM7dmFyIGRhdGE9dGhpcy5sb2NhbERhdGFbcGFyZW50SURdO3ZhciBwYXJhbXM9e21vZGVsOm1vZGVsTmFtZSxpZHM6cmVzSURzLH07aWYob3B0aW9ucy5vZmZzZXQpe3BhcmFtcy5vZmZzZXQ9b3B0aW9ucy5vZmZzZXQ7fQppZihvcHRpb25zLmZpZWxkKXtwYXJhbXMuZmllbGQ9b3B0aW9ucy5maWVsZDt9CnJldHVybiB0aGlzLl9ycGMoe3JvdXRlOicvd2ViL2RhdGFzZXQvcmVzZXF1ZW5jZScscGFyYW1zOnBhcmFtcyx9KS50aGVuKGZ1bmN0aW9uKHdhc1Jlc2VxdWVuY2VkKXtpZighd2FzUmVzZXF1ZW5jZWQpe3JldHVybiBQcm9taXNlLnJlc29sdmUoKTt9CnZhciBmaWVsZD1wYXJhbXMuZmllbGQ/cGFyYW1zLmZpZWxkOidzZXF1ZW5jZSc7cmV0dXJuIHNlbGYuX3JwYyh7bW9kZWw6bW9kZWxOYW1lLG1ldGhvZDoncmVhZCcsYXJnczpbcmVzSURzLFtmaWVsZF1dLH0pLnRoZW4oZnVuY3Rpb24ocmVjb3Jkcyl7aWYoZGF0YS5kYXRhLmxlbmd0aCl7dmFyIGRhdGFUeXBlPXNlbGYubG9jYWxEYXRhW2RhdGEuZGF0YVswXV0udHlwZTtpZihkYXRhVHlwZT09PSdyZWNvcmQnKXtfLmVhY2goZGF0YS5kYXRhLGZ1bmN0aW9uKGRhdGFQb2ludCl7dmFyIHJlY29yZERhdGE9c2VsZi5sb2NhbERhdGFbZGF0YVBvaW50XS5kYXRhO3ZhciBpblJlY29yZHM9Xy5maW5kV2hlcmUocmVjb3Jkcyx7aWQ6cmVjb3JkRGF0YS5pZH0pO2lmKGluUmVjb3Jkcyl7cmVjb3JkRGF0YVtmaWVsZF09aW5SZWNvcmRzW2ZpZWxkXTt9fSk7ZGF0YS5kYXRhPV8uc29ydEJ5KGRhdGEuZGF0YSxmdW5jdGlvbihkKXtyZXR1cm4gc2VsZi5sb2NhbERhdGFbZF0uZGF0YVtmaWVsZF07fSk7fQppZihkYXRhVHlwZT09PSdsaXN0Jyl7ZGF0YS5kYXRhPV8uc29ydEJ5KGRhdGEuZGF0YSxmdW5jdGlvbihkKXtyZXR1cm4gXy5pbmRleE9mKHJlc0lEcyxzZWxmLmxvY2FsRGF0YVtkXS5yZXNfaWQpfSk7fX0KZGF0YS5yZXNfaWRzPVtdO18uZWFjaChkYXRhLmRhdGEsZnVuY3Rpb24oZCl7dmFyIGRhdGFQb2ludD1zZWxmLmxvY2FsRGF0YVtkXTtpZihkYXRhUG9pbnQudHlwZT09PSdyZWNvcmQnKXtkYXRhLnJlc19pZHMucHVzaChkYXRhUG9pbnQucmVzX2lkKTt9ZWxzZXtkYXRhLnJlc19pZHM9ZGF0YS5yZXNfaWRzLmNvbmNhdChkYXRhUG9pbnQucmVzX2lkcyk7fX0pO3NlbGYuX3VwZGF0ZVBhcmVudFJlc0lEcyhkYXRhKTtyZXR1cm4gcGFyZW50SUQ7fSl9KTt9LHNhdmU6ZnVuY3Rpb24ocmVjb3JkSUQsb3B0aW9ucyl7dmFyIHNlbGY9dGhpcztyZXR1cm4gdGhpcy5tdXRleC5leGVjKGZ1bmN0aW9uKCl7b3B0aW9ucz1vcHRpb25zfHx7fTt2YXIgcmVjb3JkPXNlbGYubG9jYWxEYXRhW3JlY29yZElEXTtpZihvcHRpb25zLnNhdmVQb2ludCl7c2VsZi5fdmlzaXRDaGlsZHJlbihyZWNvcmQsZnVuY3Rpb24ocmVjKXt2YXIgbmV3VmFsdWU9cmVjLl9jaGFuZ2VzfHxyZWMuZGF0YTtpZihuZXdWYWx1ZSBpbnN0YW5jZW9mIEFycmF5KXtyZWMuX3NhdmVQb2ludD1uZXdWYWx1ZS5zbGljZSgwKTt9ZWxzZXtyZWMuX3NhdmVQb2ludD1fLmV4dGVuZCh7fSxuZXdWYWx1ZSk7fX0pO18uZWFjaCgocmVjb3JkLl9jaGFuZ2VzfHx7fSksZnVuY3Rpb24odmFsdWUsZmllbGROYW1lKXtyZWNvcmQuX2VkaXRpb25WaWV3VHlwZVtmaWVsZE5hbWVdPW9wdGlvbnMudmlld1R5cGU7fSk7fQp2YXIgc2hvdWxkUmVsb2FkPSdyZWxvYWQnaW4gb3B0aW9ucz9vcHRpb25zLnJlbG9hZDp0cnVlO3ZhciBtZXRob2Q9c2VsZi5pc05ldyhyZWNvcmRJRCk/J2NyZWF0ZSc6J3dyaXRlJztpZihyZWNvcmQuX2NoYW5nZXMpe2RlbGV0ZSByZWNvcmQuX2NoYW5nZXMuaWQ7fQp2YXIgY2hhbmdlcz1zZWxmLl9nZW5lcmF0ZUNoYW5nZXMocmVjb3JkLHt2aWV3VHlwZTpvcHRpb25zLnZpZXdUeXBlLGNoYW5nZXNPbmx5Om1ldGhvZCE9PSdjcmVhdGUnfSk7ZGVsZXRlIGNoYW5nZXMuaWQ7aWYobWV0aG9kPT09J2NyZWF0ZScpe3ZhciBmaWVsZE5hbWVzPXJlY29yZC5nZXRGaWVsZE5hbWVzKCk7Xy5lYWNoKGZpZWxkTmFtZXMsZnVuY3Rpb24obmFtZSl7aWYoY2hhbmdlc1tuYW1lXT09PW51bGwpe2RlbGV0ZSBjaGFuZ2VzW25hbWVdO319KTt9CnZhciBwcm9tPW5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUscmVqZWN0KXt2YXIgY2hhbmdlZEZpZWxkcz1PYmplY3Qua2V5cyhjaGFuZ2VzKTtpZihvcHRpb25zLnNhdmVQb2ludCl7cmVzb2x2ZShjaGFuZ2VkRmllbGRzKTtyZXR1cm47fQppZihtZXRob2Q9PT0nY3JlYXRlJ3x8Y2hhbmdlZEZpZWxkcy5sZW5ndGgpe3ZhciBhcmdzPW1ldGhvZD09PSd3cml0ZSc/W1tyZWNvcmQuZGF0YS5pZF0sY2hhbmdlc106W2NoYW5nZXNdO3NlbGYuX3JwYyh7bW9kZWw6cmVjb3JkLm1vZGVsLG1ldGhvZDptZXRob2QsYXJnczphcmdzLGNvbnRleHQ6cmVjb3JkLmdldENvbnRleHQoKSx9KS50aGVuKGZ1bmN0aW9uKGlkKXtpZihtZXRob2Q9PT0nY3JlYXRlJyl7cmVjb3JkLnJlc19pZD1pZDtyZWNvcmQuZGF0YS5pZD1pZDtyZWNvcmQub2Zmc2V0PXJlY29yZC5yZXNfaWRzLmxlbmd0aDtyZWNvcmQucmVzX2lkcy5wdXNoKGlkKTtyZWNvcmQuY291bnQrKzt9CnZhciBfY2hhbmdlcz1yZWNvcmQuX2NoYW5nZXM7cmVjb3JkLl9jaGFuZ2VzPXt9O3NlbGYuX2ludmFsaWRhdGVDYWNoZShyZWNvcmQpO3NlbGYudW5mcmVlemVPcmRlcihyZWNvcmQuaWQpO2lmKHNob3VsZFJlbG9hZCl7c2VsZi5fZmV0Y2hSZWNvcmQocmVjb3JkKS50aGVuKGZ1bmN0aW9uKCl7cmVzb2x2ZShjaGFuZ2VkRmllbGRzKTt9KTt9ZWxzZXtfLmV4dGVuZChyZWNvcmQuZGF0YSxfY2hhbmdlcyk7cmVzb2x2ZShjaGFuZ2VkRmllbGRzKTt9fSkuZ3VhcmRlZENhdGNoKHJlamVjdCk7fWVsc2V7cmVzb2x2ZShjaGFuZ2VkRmllbGRzKTt9fSk7cHJvbS50aGVuKGZ1bmN0aW9uKCl7cmVjb3JkLl9pc0RpcnR5PWZhbHNlO30pO3JldHVybiBwcm9tO30pO30sc2V0RGlydHk6ZnVuY3Rpb24oaWQpe3RoaXMubG9jYWxEYXRhW2lkXS5faXNEaXJ0eT10cnVlO30sc2V0U29ydDpmdW5jdGlvbihsaXN0X2lkLGZpZWxkTmFtZSl7dmFyIGxpc3Q9dGhpcy5sb2NhbERhdGFbbGlzdF9pZF07aWYobGlzdC50eXBlPT09J3JlY29yZCcpe3JldHVybjt9ZWxzZSBpZihsaXN0Ll9jaGFuZ2VzKXtfLmVhY2gobGlzdC5fY2hhbmdlcyxmdW5jdGlvbihjaGFuZ2Upe2RlbGV0ZSBjaGFuZ2UuaXNOZXc7fSk7fQppZihsaXN0Lm9yZGVyZWRCeS5sZW5ndGg9PT0wKXtsaXN0Lm9yZGVyZWRCeS5wdXNoKHtuYW1lOmZpZWxkTmFtZSxhc2M6dHJ1ZX0pO31lbHNlIGlmKGxpc3Qub3JkZXJlZEJ5WzBdLm5hbWU9PT1maWVsZE5hbWUpe2lmKCFsaXN0Lm9yZGVyZWRSZXNJRHMpe2xpc3Qub3JkZXJlZEJ5WzBdLmFzYz0hbGlzdC5vcmRlcmVkQnlbMF0uYXNjO319ZWxzZXt2YXIgb3JkZXJlZEJ5PV8ucmVqZWN0KGxpc3Qub3JkZXJlZEJ5LGZ1bmN0aW9uKG8pe3JldHVybiBvLm5hbWU9PT1maWVsZE5hbWU7fSk7bGlzdC5vcmRlcmVkQnk9W3tuYW1lOmZpZWxkTmFtZSxhc2M6dHJ1ZX1dLmNvbmNhdChvcmRlcmVkQnkpO30KbGlzdC5vcmRlcmVkUmVzSURzPW51bGw7aWYobGlzdC5zdGF0aWMpe3JldHVybiB0aGlzLl9mZXRjaFVuZ3JvdXBlZExpc3QobGlzdCk7fQpyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7fSx0b2dnbGVBY3RpdmU6ZnVuY3Rpb24ocmVjb3JkSURzLHBhcmVudElEKXt2YXIgc2VsZj10aGlzO3ZhciBwYXJlbnQ9dGhpcy5sb2NhbERhdGFbcGFyZW50SURdO3ZhciByZXNJRHM9Xy5tYXAocmVjb3JkSURzLGZ1bmN0aW9uKHJlY29yZElEKXtyZXR1cm4gc2VsZi5sb2NhbERhdGFbcmVjb3JkSURdLnJlc19pZDt9KTtyZXR1cm4gdGhpcy5fcnBjKHttb2RlbDpwYXJlbnQubW9kZWwsbWV0aG9kOid0b2dnbGVfYWN0aXZlJyxhcmdzOltyZXNJRHNdLH0pLnRoZW4oZnVuY3Rpb24oYWN0aW9uKXtzZWxmLl9pbnZhbGlkYXRlQ2FjaGUocGFyZW50KTtpZighXy5pc0VtcHR5KGFjdGlvbikpe3JldHVybiBzZWxmLmRvX2FjdGlvbihhY3Rpb24se29uX2Nsb3NlOmZ1bmN0aW9uKCl7cmV0dXJuIHNlbGYudHJpZ2dlcl91cCgncmVsb2FkJyk7fX0pO31lbHNle3JldHVybiBzZWxmLnJlbG9hZChwYXJlbnRJRCk7fX0pO30sYWN0aW9uQXJjaGl2ZTpmdW5jdGlvbihyZWNvcmRJRHMscGFyZW50SUQpe3ZhciBzZWxmPXRoaXM7dmFyIHBhcmVudD10aGlzLmxvY2FsRGF0YVtwYXJlbnRJRF07dmFyIHJlc0lEcz1fLm1hcChyZWNvcmRJRHMsZnVuY3Rpb24ocmVjb3JkSUQpe3JldHVybiBzZWxmLmxvY2FsRGF0YVtyZWNvcmRJRF0ucmVzX2lkO30pO3JldHVybiB0aGlzLl9ycGMoe21vZGVsOnBhcmVudC5tb2RlbCxtZXRob2Q6J2FjdGlvbl9hcmNoaXZlJyxhcmdzOltyZXNJRHNdLH0pLnRoZW4oZnVuY3Rpb24oYWN0aW9uKXtzZWxmLl9pbnZhbGlkYXRlQ2FjaGUocGFyZW50KTtpZighXy5pc0VtcHR5KGFjdGlvbikpe3JldHVybiBzZWxmLmRvX2FjdGlvbihhY3Rpb24se29uX2Nsb3NlOmZ1bmN0aW9uKCl7cmV0dXJuIHNlbGYudHJpZ2dlcl91cCgncmVsb2FkJyk7fX0pO31lbHNle3JldHVybiBzZWxmLnJlbG9hZChwYXJlbnRJRCk7fX0pO30sYWN0aW9uVW5hcmNoaXZlOmZ1bmN0aW9uKHJlY29yZElEcyxwYXJlbnRJRCl7dmFyIHNlbGY9dGhpczt2YXIgcGFyZW50PXRoaXMubG9jYWxEYXRhW3BhcmVudElEXTt2YXIgcmVzSURzPV8ubWFwKHJlY29yZElEcyxmdW5jdGlvbihyZWNvcmRJRCl7cmV0dXJuIHNlbGYubG9jYWxEYXRhW3JlY29yZElEXS5yZXNfaWQ7fSk7cmV0dXJuIHRoaXMuX3JwYyh7bW9kZWw6cGFyZW50Lm1vZGVsLG1ldGhvZDonYWN0aW9uX3VuYXJjaGl2ZScsYXJnczpbcmVzSURzXSx9KS50aGVuKGZ1bmN0aW9uKGFjdGlvbil7c2VsZi5faW52YWxpZGF0ZUNhY2hlKHBhcmVudCk7aWYoIV8uaXNFbXB0eShhY3Rpb24pKXtyZXR1cm4gc2VsZi5kb19hY3Rpb24oYWN0aW9uLHtvbl9jbG9zZTpmdW5jdGlvbigpe3JldHVybiBzZWxmLnRyaWdnZXJfdXAoJ3JlbG9hZCcpO319KTt9ZWxzZXtyZXR1cm4gc2VsZi5yZWxvYWQocGFyZW50SUQpO319KTt9LHRvZ2dsZUdyb3VwOmZ1bmN0aW9uKGdyb3VwSWQpe3ZhciBzZWxmPXRoaXM7dmFyIGdyb3VwPXRoaXMubG9jYWxEYXRhW2dyb3VwSWRdO2lmKGdyb3VwLmlzT3Blbil7Z3JvdXAuaXNPcGVuPWZhbHNlO2dyb3VwLmRhdGE9W107Z3JvdXAucmVzX2lkcz1bXTtncm91cC5vZmZzZXQ9MDt0aGlzLl91cGRhdGVQYXJlbnRSZXNJRHMoZ3JvdXApO3JldHVybiBQcm9taXNlLnJlc29sdmUoZ3JvdXBJZCk7fQppZighZ3JvdXAuaXNPcGVuKXtncm91cC5pc09wZW49dHJ1ZTt2YXIgZGVmO2lmKGdyb3VwLmNvdW50PjApe2RlZj10aGlzLl9sb2FkKGdyb3VwKS50aGVuKGZ1bmN0aW9uKCl7c2VsZi5fdXBkYXRlUGFyZW50UmVzSURzKGdyb3VwKTt9KTt9CnJldHVybiBQcm9taXNlLnJlc29sdmUoZGVmKS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIGdyb3VwSWQ7fSk7fX0sdW5mcmVlemVPcmRlcjpmdW5jdGlvbihlbGVtZW50SUQpe3ZhciBsaXN0PXRoaXMubG9jYWxEYXRhW2VsZW1lbnRJRF07aWYobGlzdC50eXBlPT09J3JlY29yZCcpe3ZhciBkYXRhPV8uZXh0ZW5kKHt9LGxpc3QuZGF0YSxsaXN0Ll9jaGFuZ2VzKTtmb3IodmFyIGZpZWxkTmFtZSBpbiBkYXRhKXt2YXIgZmllbGQ9bGlzdC5maWVsZHNbZmllbGROYW1lXTtpZighZmllbGR8fCFkYXRhW2ZpZWxkTmFtZV0pe2NvbnRpbnVlO30KaWYoZmllbGQudHlwZT09PSdvbmUybWFueSd8fGZpZWxkLnR5cGU9PT0nbWFueTJtYW55Jyl7dmFyIHJlY29yZGxpc3Q9dGhpcy5sb2NhbERhdGFbZGF0YVtmaWVsZE5hbWVdXTtyZWNvcmRsaXN0Lm9yZGVyZWRSZXNJRHM9bnVsbDtmb3IodmFyIGluZGV4IGluIHJlY29yZGxpc3QuZGF0YSl7dGhpcy51bmZyZWV6ZU9yZGVyKHJlY29yZGxpc3QuZGF0YVtpbmRleF0pO319fQpyZXR1cm47fQpsaXN0Lm9yZGVyZWRSZXNJRHM9bnVsbDt0aGlzLl9zb3J0TGlzdChsaXN0KTt9LF9hZGRYMk1hbnlEZWZhdWx0UmVjb3JkOmZ1bmN0aW9uKGxpc3Qsb3B0aW9ucyl7dmFyIHNlbGY9dGhpczt2YXIgcG9zaXRpb249b3B0aW9ucyYmb3B0aW9ucy5wb3NpdGlvbnx8J3RvcCc7dmFyIHBhcmFtcz17ZmllbGRzOmxpc3QuZmllbGRzLGZpZWxkc0luZm86bGlzdC5maWVsZHNJbmZvLHBhcmVudElEOmxpc3QuaWQscG9zaXRpb246cG9zaXRpb24sdmlld1R5cGU6bGlzdC52aWV3VHlwZSxhbGxvd1dhcm5pbmc6b3B0aW9ucyYmb3B0aW9ucy5hbGxvd1dhcm5pbmd9O3ZhciBhZGRpdGlvbmFsQ29udGV4dHM9b3B0aW9ucyYmb3B0aW9ucy5jb250ZXh0O3ZhciBtYWtlRGVmYXVsdFJlY29yZHM9W107aWYoYWRkaXRpb25hbENvbnRleHRzKXtfLmVhY2goYWRkaXRpb25hbENvbnRleHRzLGZ1bmN0aW9uKGNvbnRleHQpe3BhcmFtcy5jb250ZXh0PXNlbGYuX2dldENvbnRleHQobGlzdCx7YWRkaXRpb25hbENvbnRleHQ6Y29udGV4dH0pO21ha2VEZWZhdWx0UmVjb3Jkcy5wdXNoKHNlbGYuX21ha2VEZWZhdWx0UmVjb3JkKGxpc3QubW9kZWwscGFyYW1zKSk7fSk7fWVsc2V7cGFyYW1zLmNvbnRleHQ9c2VsZi5fZ2V0Q29udGV4dChsaXN0KTttYWtlRGVmYXVsdFJlY29yZHMucHVzaChzZWxmLl9tYWtlRGVmYXVsdFJlY29yZChsaXN0Lm1vZGVsLHBhcmFtcykpO30KcmV0dXJuIFByb21pc2UuYWxsKG1ha2VEZWZhdWx0UmVjb3JkcykudGhlbihmdW5jdGlvbihyZXN1bHRJZHMpe3ZhciBpZHM9W107Xy5lYWNoKHJlc3VsdElkcyxmdW5jdGlvbihpZCl7aWRzLnB1c2goaWQpO2xpc3QuX2NoYW5nZXMucHVzaCh7b3BlcmF0aW9uOidBREQnLGlkOmlkLHBvc2l0aW9uOnBvc2l0aW9uLGlzTmV3OnRydWV9KTt2YXIgcmVjb3JkPXNlbGYubG9jYWxEYXRhW2lkXTtsaXN0Ll9jYWNoZVtyZWNvcmQucmVzX2lkXT1pZDtpZihsaXN0Lm9yZGVyZWRSZXNJRHMpe3ZhciBpbmRleD1saXN0Lm9mZnNldCsocG9zaXRpb24hPT0ndG9wJz9saXN0LmxpbWl0OjApO2xpc3Qub3JkZXJlZFJlc0lEcy5zcGxpY2UoaW5kZXgsMCxyZWNvcmQucmVzX2lkKTtzZWxmLmxvY2FsRGF0YVtsaXN0LmlkXS5vcmRlcmVkUmVzSURzPWxpc3Qub3JkZXJlZFJlc0lEczt9fSk7cmV0dXJuIGlkczt9KTt9LF9hcHBseUNoYW5nZTpmdW5jdGlvbihyZWNvcmRJRCxjaGFuZ2VzLG9wdGlvbnMpe3ZhciBzZWxmPXRoaXM7dmFyIHJlY29yZD10aGlzLmxvY2FsRGF0YVtyZWNvcmRJRF07dmFyIGZpZWxkO3ZhciBkZWZzPVtdO29wdGlvbnM9b3B0aW9uc3x8e307cmVjb3JkLl9jaGFuZ2VzPXJlY29yZC5fY2hhbmdlc3x8e307aWYoIW9wdGlvbnMuZG9Ob3RTZXREaXJ0eSl7cmVjb3JkLl9pc0RpcnR5PXRydWU7fQp2YXIgaW5pdGlhbERhdGE9e307dGhpcy5fdmlzaXRDaGlsZHJlbihyZWNvcmQsZnVuY3Rpb24oZWxlbSl7aW5pdGlhbERhdGFbZWxlbS5pZF09JC5leHRlbmQodHJ1ZSx7fSxfLnBpY2soZWxlbSwnZGF0YScsJ19jaGFuZ2VzJykpO30pO2Zvcih2YXIgZmllbGROYW1lIGluIGNoYW5nZXMpe2ZpZWxkPXJlY29yZC5maWVsZHNbZmllbGROYW1lXTtpZihmaWVsZCYmKGZpZWxkLnR5cGU9PT0nb25lMm1hbnknfHxmaWVsZC50eXBlPT09J21hbnkybWFueScpKXtkZWZzLnB1c2godGhpcy5fYXBwbHlYMk1hbnlDaGFuZ2UocmVjb3JkLGZpZWxkTmFtZSxjaGFuZ2VzW2ZpZWxkTmFtZV0sb3B0aW9ucykpO31lbHNlIGlmKGZpZWxkJiYoZmllbGQudHlwZT09PSdtYW55Mm9uZSd8fGZpZWxkLnR5cGU9PT0ncmVmZXJlbmNlJykpe2RlZnMucHVzaCh0aGlzLl9hcHBseVgyT25lQ2hhbmdlKHJlY29yZCxmaWVsZE5hbWUsY2hhbmdlc1tmaWVsZE5hbWVdKSk7fWVsc2V7cmVjb3JkLl9jaGFuZ2VzW2ZpZWxkTmFtZV09Y2hhbmdlc1tmaWVsZE5hbWVdO319CmlmKG9wdGlvbnMubm90aWZ5Q2hhbmdlPT09ZmFsc2Upe3JldHVybiBQcm9taXNlLnJlc29sdmUoXy5rZXlzKGNoYW5nZXMpKTt9CnJldHVybiBQcm9taXNlLmFsbChkZWZzKS50aGVuKGZ1bmN0aW9uKCl7dmFyIG9uQ2hhbmdlRmllbGRzPVtdO2Zvcih2YXIgZmllbGROYW1lIGluIGNoYW5nZXMpe2ZpZWxkPXJlY29yZC5maWVsZHNbZmllbGROYW1lXTtpZihmaWVsZCYmZmllbGQub25DaGFuZ2Upe3ZhciBpc1gyTWFueT1maWVsZC50eXBlPT09J29uZTJtYW55J3x8ZmllbGQudHlwZT09PSdtYW55Mm1hbnknO2lmKCFpc1gyTWFueXx8KHNlbGYuX2lzWDJNYW55VmFsaWQocmVjb3JkLl9jaGFuZ2VzW2ZpZWxkTmFtZV18fHJlY29yZC5kYXRhW2ZpZWxkTmFtZV0pKSl7b25DaGFuZ2VGaWVsZHMucHVzaChmaWVsZE5hbWUpO319fQpyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSxyZWplY3Qpe2lmKG9uQ2hhbmdlRmllbGRzLmxlbmd0aCl7c2VsZi5fcGVyZm9ybU9uQ2hhbmdlKHJlY29yZCxvbkNoYW5nZUZpZWxkcyxvcHRpb25zLnZpZXdUeXBlKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCl7ZGVsZXRlIHJlY29yZC5fd2FybmluZztyZXNvbHZlKF8ua2V5cyhjaGFuZ2VzKS5jb25jYXQoT2JqZWN0LmtleXMocmVzdWx0JiZyZXN1bHQudmFsdWV8fHt9KSkpO30pLmd1YXJkZWRDYXRjaChmdW5jdGlvbigpe3NlbGYuX3Zpc2l0Q2hpbGRyZW4ocmVjb3JkLGZ1bmN0aW9uKGVsZW0pe18uZXh0ZW5kKGVsZW0saW5pdGlhbERhdGFbZWxlbS5pZF0pO30pO3Jlc29sdmUoe30pO30pO31lbHNle3Jlc29sdmUoXy5rZXlzKGNoYW5nZXMpKTt9fSkudGhlbihmdW5jdGlvbihmaWVsZE5hbWVzKXtyZXR1cm4gc2VsZi5fZmV0Y2hTcGVjaWFsRGF0YShyZWNvcmQpLnRoZW4oZnVuY3Rpb24oZmllbGROYW1lczIpe3JldHVybiBfLnVuaW9uKGZpZWxkTmFtZXMsZmllbGROYW1lczIpO30pO30pO30pO30sX2FwcGx5WDJPbmVDaGFuZ2U6ZnVuY3Rpb24ocmVjb3JkLGZpZWxkTmFtZSxkYXRhKXt2YXIgc2VsZj10aGlzO2lmKCFkYXRhfHwhZGF0YS5pZCl7cmVjb3JkLl9jaGFuZ2VzW2ZpZWxkTmFtZV09ZmFsc2U7cmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO30KdmFyIHJlbGF0ZWRJRDtpZihyZWNvcmQuX2NoYW5nZXMmJmZpZWxkTmFtZSBpbiByZWNvcmQuX2NoYW5nZXMpe3JlbGF0ZWRJRD1yZWNvcmQuX2NoYW5nZXNbZmllbGROYW1lXTt9ZWxzZXtyZWxhdGVkSUQ9cmVjb3JkLmRhdGFbZmllbGROYW1lXTt9CnZhciByZWxhdGVkUmVjb3JkPXRoaXMubG9jYWxEYXRhW3JlbGF0ZWRJRF07aWYocmVsYXRlZFJlY29yZCYmKGRhdGEuaWQ9PT10aGlzLmxvY2FsRGF0YVtyZWxhdGVkSURdLnJlc19pZCkpe3JldHVybiBQcm9taXNlLnJlc29sdmUoKTt9CnZhciByZWxfZGF0YT1fLnBpY2soZGF0YSwnaWQnLCdkaXNwbGF5X25hbWUnKTt2YXIgZmllbGQ9cmVjb3JkLmZpZWxkc1tmaWVsZE5hbWVdO3ZhciBjb01vZGVsPWZpZWxkLnR5cGU9PT0ncmVmZXJlbmNlJz9kYXRhLm1vZGVsOmZpZWxkLnJlbGF0aW9uO3ZhciBkZWY7aWYocmVsX2RhdGEuZGlzcGxheV9uYW1lPT09dW5kZWZpbmVkKXtkZWY9dGhpcy5fcnBjKHttb2RlbDpjb01vZGVsLG1ldGhvZDonbmFtZV9nZXQnLGFyZ3M6W2RhdGEuaWRdLGNvbnRleHQ6cmVjb3JkLmNvbnRleHQsfSkudGhlbihmdW5jdGlvbihyZXN1bHQpe3JlbF9kYXRhLmRpc3BsYXlfbmFtZT1yZXN1bHRbMF1bMV07fSk7fQpyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGRlZikudGhlbihmdW5jdGlvbigpe3ZhciByZWM9c2VsZi5fbWFrZURhdGFQb2ludCh7Y29udGV4dDpyZWNvcmQuY29udGV4dCxkYXRhOnJlbF9kYXRhLGZpZWxkczp7fSxmaWVsZHNJbmZvOnt9LG1vZGVsTmFtZTpjb01vZGVsLHBhcmVudElEOnJlY29yZC5pZCx9KTtyZWNvcmQuX2NoYW5nZXNbZmllbGROYW1lXT1yZWMuaWQ7fSk7fSxfYXBwbHlPbkNoYW5nZTpmdW5jdGlvbih2YWx1ZXMscmVjb3JkLHZpZXdUeXBlKXt2YXIgc2VsZj10aGlzO3ZhciBkZWZzPVtdO3ZhciByZWM7dmlld1R5cGU9dmlld1R5cGV8fHJlY29yZC52aWV3VHlwZTtyZWNvcmQuX2NoYW5nZXM9cmVjb3JkLl9jaGFuZ2VzfHx7fTtfLmVhY2godmFsdWVzLGZ1bmN0aW9uKHZhbCxuYW1lKXt2YXIgZmllbGQ9cmVjb3JkLmZpZWxkc1tuYW1lXTtpZighZmllbGQpe3JlY29yZC5fcmF3Q2hhbmdlc1tuYW1lXT12YWw7cmV0dXJuO30KaWYocmVjb3JkLl9yYXdDaGFuZ2VzW25hbWVdKXtkZWxldGUgcmVjb3JkLl9yYXdDaGFuZ2VzW25hbWVdO30KdmFyIG9sZFZhbHVlPW5hbWUgaW4gcmVjb3JkLl9jaGFuZ2VzP3JlY29yZC5fY2hhbmdlc1tuYW1lXTpyZWNvcmQuZGF0YVtuYW1lXTt2YXIgaWQ7aWYoZmllbGQudHlwZT09PSdtYW55Mm9uZScpe2lkPWZhbHNlO2lmKHZhbCl7dmFyIGRhdGE9Xy5pc0FycmF5KHZhbCk/e2lkOnZhbFswXSxkaXNwbGF5X25hbWU6dmFsWzFdfTp7aWQ6dmFsfTtpZighb2xkVmFsdWV8fChzZWxmLmxvY2FsRGF0YVtvbGRWYWx1ZV0ucmVzX2lkIT09ZGF0YS5pZCkpe3JlYz1zZWxmLl9tYWtlRGF0YVBvaW50KHtjb250ZXh0OnJlY29yZC5jb250ZXh0LGRhdGE6ZGF0YSxtb2RlbE5hbWU6ZmllbGQucmVsYXRpb24scGFyZW50SUQ6cmVjb3JkLmlkLH0pO2lkPXJlYy5pZDtyZWNvcmQuX2NoYW5nZXNbbmFtZV09aWQ7fX1lbHNle3JlY29yZC5fY2hhbmdlc1tuYW1lXT1mYWxzZTt9fWVsc2UgaWYoZmllbGQudHlwZT09PSdyZWZlcmVuY2UnKXtpZD1mYWxzZTtpZih2YWwpe3ZhciByZWY9dmFsLnNwbGl0KCcsJyk7dmFyIG1vZGVsTmFtZT1yZWZbMF07dmFyIHJlc0lEPXBhcnNlSW50KHJlZlsxXSk7aWYoIW9sZFZhbHVlfHxzZWxmLmxvY2FsRGF0YVtvbGRWYWx1ZV0ucmVzX2lkIT09cmVzSUR8fHNlbGYubG9jYWxEYXRhW29sZFZhbHVlXS5tb2RlbCE9PW1vZGVsTmFtZSl7cmVjPXNlbGYuX21ha2VEYXRhUG9pbnQoe2NvbnRleHQ6cmVjb3JkLmNvbnRleHQsZGF0YTp7aWQ6cGFyc2VJbnQocmVmWzFdKX0sbW9kZWxOYW1lOm1vZGVsTmFtZSxwYXJlbnRJRDpyZWNvcmQuaWQsfSk7ZGVmcy5wdXNoKHNlbGYuX2ZldGNoTmFtZUdldChyZWMpKTtpZD1yZWMuaWQ7cmVjb3JkLl9jaGFuZ2VzW25hbWVdPWlkO319ZWxzZXtyZWNvcmQuX2NoYW5nZXNbbmFtZV09aWQ7fX1lbHNlIGlmKGZpZWxkLnR5cGU9PT0nb25lMm1hbnknfHxmaWVsZC50eXBlPT09J21hbnkybWFueScpe3ZhciBsaXN0SWQ9cmVjb3JkLl9jaGFuZ2VzW25hbWVdfHxyZWNvcmQuZGF0YVtuYW1lXTt2YXIgbGlzdDtpZihsaXN0SWQpe2xpc3Q9c2VsZi5sb2NhbERhdGFbbGlzdElkXTt9ZWxzZXt2YXIgZmllbGRJbmZvPXJlY29yZC5maWVsZHNJbmZvW3ZpZXdUeXBlXVtuYW1lXTtpZighZmllbGRJbmZvKXtyZXR1cm47fQp2YXIgdmlldz1maWVsZEluZm8udmlld3MmJmZpZWxkSW5mby52aWV3c1tmaWVsZEluZm8ubW9kZV07bGlzdD1zZWxmLl9tYWtlRGF0YVBvaW50KHtmaWVsZHM6dmlldz92aWV3LmZpZWxkczpmaWVsZEluZm8ucmVsYXRlZEZpZWxkcyxmaWVsZHNJbmZvOnZpZXc/dmlldy5maWVsZHNJbmZvOmZpZWxkSW5mby5maWVsZHNJbmZvLGxpbWl0OmZpZWxkSW5mby5saW1pdCxtb2RlbE5hbWU6ZmllbGQucmVsYXRpb24scGFyZW50SUQ6cmVjb3JkLmlkLHN0YXRpYzp0cnVlLHR5cGU6J2xpc3QnLHZpZXdUeXBlOnZpZXc/dmlldy50eXBlOmZpZWxkSW5mby52aWV3VHlwZSx9KTt9CnJlY29yZC5fY2hhbmdlc1tuYW1lXT1saXN0LmlkO2xpc3QuX2NoYW5nZXM9bGlzdC5fY2hhbmdlc3x8W107dmFyIG9sZENoYW5nZXM9bGlzdC5fY2hhbmdlcztfLmVhY2godmFsLGZ1bmN0aW9uKGNvbW1hbmQpe3ZhciByZWMscmVjSUQ7aWYoY29tbWFuZFswXT09PTB8fGNvbW1hbmRbMF09PT0xKXtpZihjb21tYW5kWzBdPT09MCYmY29tbWFuZFsxXSl7dmFyIHByZXZpb3VzQ2hhbmdlPV8uZmluZChvbGRDaGFuZ2VzLGZ1bmN0aW9uKG9wZXJhdGlvbil7dmFyIGNoaWxkPXNlbGYubG9jYWxEYXRhW29wZXJhdGlvbi5pZF07cmV0dXJuIGNoaWxkJiYoY2hpbGQucmVmPT09Y29tbWFuZFsxXSk7fSk7cmVjSUQ9cHJldmlvdXNDaGFuZ2UmJnByZXZpb3VzQ2hhbmdlLmlkO3JlYz1zZWxmLmxvY2FsRGF0YVtyZWNJRF07fQppZihjb21tYW5kWzBdPT09MSYmY29tbWFuZFsxXSl7cmVjPXNlbGYubG9jYWxEYXRhW2xpc3QuX2NhY2hlW2NvbW1hbmRbMV1dXTt9CmlmKCFyZWMpe3ZhciBwYXJhbXM9e2NvbnRleHQ6bGlzdC5jb250ZXh0LGZpZWxkczpsaXN0LmZpZWxkcyxmaWVsZHNJbmZvOmxpc3QuZmllbGRzSW5mbyxtb2RlbE5hbWU6bGlzdC5tb2RlbCxwYXJlbnRJRDpsaXN0LmlkLHZpZXdUeXBlOmxpc3Qudmlld1R5cGUscmVmOmNvbW1hbmRbMV0sfTtpZihjb21tYW5kWzBdPT09MSl7cGFyYW1zLnJlc19pZD1jb21tYW5kWzFdO30KcmVjPXNlbGYuX21ha2VEYXRhUG9pbnQocGFyYW1zKTtsaXN0Ll9jYWNoZVtyZWMucmVzX2lkXT1yZWMuaWQ7fQpyZWMuX25vQWJhbmRvbj0hbGlzdC5fc2F2ZVBvaW50O2xpc3QuX2NoYW5nZXMucHVzaCh7b3BlcmF0aW9uOidBREQnLGlkOnJlYy5pZH0pO2lmKGNvbW1hbmRbMF09PT0xKXtsaXN0Ll9jaGFuZ2VzLnB1c2goe29wZXJhdGlvbjonVVBEQVRFJyxpZDpyZWMuaWR9KTt9CmRlZnMucHVzaChzZWxmLl9hcHBseU9uQ2hhbmdlKGNvbW1hbmRbMl0scmVjKSk7fWVsc2UgaWYoY29tbWFuZFswXT09PTQpe2xpbmtSZWNvcmQobGlzdCxjb21tYW5kWzFdKTt9ZWxzZSBpZihjb21tYW5kWzBdPT09NSl7bGlzdC5fY2hhbmdlcz1be29wZXJhdGlvbjonUkVNT1ZFX0FMTCd9XTt9ZWxzZSBpZihjb21tYW5kWzBdPT09Nil7bGlzdC5fY2hhbmdlcz1be29wZXJhdGlvbjonUkVNT1ZFX0FMTCd9XTtfLmVhY2goY29tbWFuZFsyXSxmdW5jdGlvbihyZXNJRCl7bGlua1JlY29yZChsaXN0LHJlc0lEKTt9KTt9fSk7dmFyIGRlZj1zZWxmLl9yZWFkVW5ncm91cGVkTGlzdChsaXN0KS50aGVuKGZ1bmN0aW9uKCl7dmFyIHgyTWFueXNEZWY9c2VsZi5fZmV0Y2hYMk1hbnlzQmF0Y2hlZChsaXN0KTt2YXIgcmVmZXJlbmNlc0RlZj1zZWxmLl9mZXRjaFJlZmVyZW5jZXNCYXRjaGVkKGxpc3QpO3JldHVybiBQcm9taXNlLmFsbChbeDJNYW55c0RlZixyZWZlcmVuY2VzRGVmXSk7fSk7ZGVmcy5wdXNoKGRlZik7fWVsc2V7dmFyIG5ld1ZhbHVlPXNlbGYuX3BhcnNlU2VydmVyVmFsdWUoZmllbGQsdmFsKTtpZihuZXdWYWx1ZSE9PW9sZFZhbHVlKXtyZWNvcmQuX2NoYW5nZXNbbmFtZV09bmV3VmFsdWU7fX19KTtyZXR1cm4gUHJvbWlzZS5hbGwoZGVmcyk7ZnVuY3Rpb24gbGlua1JlY29yZChsaXN0LHJlc0lEKXtyZWM9c2VsZi5sb2NhbERhdGFbbGlzdC5fY2FjaGVbcmVzSURdXTtpZihyZWMpe3NlbGYuZGlzY2FyZENoYW5nZXMocmVjLmlkKTt9Cmxpc3QuX2NoYW5nZXMucHVzaCh7b3BlcmF0aW9uOidBREQnLGlkOnJlYz9yZWMuaWQ6bnVsbCxyZXNJRDpyZXNJRCx9KTt9fSxfYXBwbHlYMk1hbnlDaGFuZ2U6ZnVuY3Rpb24ocmVjb3JkLGZpZWxkTmFtZSxjb21tYW5kLG9wdGlvbnMpe2lmKGNvbW1hbmQub3BlcmF0aW9uPT09J1RSSUdHRVJfT05DSEFOR0UnKXtyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7fQp2YXIgc2VsZj10aGlzO3ZhciBsb2NhbElEPShyZWNvcmQuX2NoYW5nZXMmJnJlY29yZC5fY2hhbmdlc1tmaWVsZE5hbWVdKXx8cmVjb3JkLmRhdGFbZmllbGROYW1lXTt2YXIgbGlzdD10aGlzLmxvY2FsRGF0YVtsb2NhbElEXTt2YXIgZmllbGQ9cmVjb3JkLmZpZWxkc1tmaWVsZE5hbWVdO3ZhciB2aWV3VHlwZT0ob3B0aW9ucyYmb3B0aW9ucy52aWV3VHlwZSl8fHJlY29yZC52aWV3VHlwZTt2YXIgZmllbGRJbmZvPXJlY29yZC5maWVsZHNJbmZvW3ZpZXdUeXBlXVtmaWVsZE5hbWVdO3ZhciB2aWV3PWZpZWxkSW5mby52aWV3cyYmZmllbGRJbmZvLnZpZXdzW2ZpZWxkSW5mby5tb2RlXTt2YXIgZGVmLHJlYzt2YXIgZGVmcz1bXTtsaXN0Ll9jaGFuZ2VzPWxpc3QuX2NoYW5nZXN8fFtdO3N3aXRjaChjb21tYW5kLm9wZXJhdGlvbil7Y2FzZSdBREQnOnZhciBuZXdSZWNvcmQ9dGhpcy5sb2NhbERhdGFbY29tbWFuZC5pZF07Xy5kZWZhdWx0cyhsaXN0LmZpZWxkcyxuZXdSZWNvcmQuZmllbGRzKTtfLmRlZmF1bHRzKGxpc3QuZmllbGRzSW5mbyxuZXdSZWNvcmQuZmllbGRzSW5mbyk7bmV3UmVjb3JkLmZpZWxkcz1saXN0LmZpZWxkcztuZXdSZWNvcmQuZmllbGRzSW5mbz1saXN0LmZpZWxkc0luZm87bmV3UmVjb3JkLnZpZXdUeXBlPWxpc3Qudmlld1R5cGU7bGlzdC5fY2FjaGVbbmV3UmVjb3JkLnJlc19pZF09bmV3UmVjb3JkLmlkO2xpc3QuX2NoYW5nZXMucHVzaChjb21tYW5kKTticmVhaztjYXNlJ0FERF9NMk0nOmxpc3QuX2ZvcmNlTTJNTGluaz10cnVlO3ZhciBkYXRhPV8uaXNBcnJheShjb21tYW5kLmlkcyk/Y29tbWFuZC5pZHM6W2NvbW1hbmQuaWRzXTtpZihkYXRhLmxlbmd0aCtsaXN0LnJlc19pZHMubGVuZ3RoPmxpc3QubGltaXQpe2xpc3QubGltaXQ9ZGF0YS5sZW5ndGgrbGlzdC5yZXNfaWRzLmxlbmd0aDt9CnZhciBsaXN0X3JlY29yZHM9e307Xy5lYWNoKGRhdGEsZnVuY3Rpb24oZCl7cmVjPXNlbGYuX21ha2VEYXRhUG9pbnQoe2NvbnRleHQ6cmVjb3JkLmNvbnRleHQsbW9kZWxOYW1lOmZpZWxkLnJlbGF0aW9uLGZpZWxkczp2aWV3P3ZpZXcuZmllbGRzOmZpZWxkSW5mby5yZWxhdGVkRmllbGRzLGZpZWxkc0luZm86dmlldz92aWV3LmZpZWxkc0luZm86ZmllbGRJbmZvLmZpZWxkc0luZm8scmVzX2lkOmQuaWQsZGF0YTpkLHZpZXdUeXBlOnZpZXc/dmlldy50eXBlOmZpZWxkSW5mby52aWV3VHlwZSxwYXJlbnRJRDpsaXN0LmlkLH0pO2xpc3RfcmVjb3Jkc1tkLmlkXT1yZWM7bGlzdC5fY2FjaGVbcmVjLnJlc19pZF09cmVjLmlkO2xpc3QuX2NoYW5nZXMucHVzaCh7b3BlcmF0aW9uOidBREQnLGlkOnJlYy5pZH0pO30pO3ZhciBmaWVsZE5hbWVzPWxpc3QuZ2V0RmllbGROYW1lcygpO2lmKGZpZWxkTmFtZXMubGVuZ3RoKXtkZWY9dGhpcy5fcnBjKHttb2RlbDpsaXN0Lm1vZGVsLG1ldGhvZDoncmVhZCcsYXJnczpbXy5wbHVjayhkYXRhLCdpZCcpLGZpZWxkTmFtZXNdLGNvbnRleHQ6Xy5leHRlbmQoe30scmVjb3JkLmNvbnRleHQsZmllbGQuY29udGV4dCksfSkudGhlbihmdW5jdGlvbihyZWNvcmRzKXtfLmVhY2gocmVjb3JkcyxmdW5jdGlvbihyZWNvcmQpe2xpc3RfcmVjb3Jkc1tyZWNvcmQuaWRdLmRhdGE9cmVjb3JkO3NlbGYuX3BhcnNlU2VydmVyRGF0YShmaWVsZE5hbWVzLGxpc3QscmVjb3JkKTt9KTtyZXR1cm4gUHJvbWlzZS5hbGwoW3NlbGYuX2ZldGNoWDJNYW55c0JhdGNoZWQobGlzdCksc2VsZi5fZmV0Y2hSZWZlcmVuY2VzQmF0Y2hlZChsaXN0KV0pO30pO2RlZnMucHVzaChkZWYpO30KYnJlYWs7Y2FzZSdDUkVBVEUnOnZhciBjcmVhdGVPcHRpb25zPV8uZXh0ZW5kKHtjb250ZXh0OmNvbW1hbmQuY29udGV4dCxwb3NpdGlvbjpjb21tYW5kLnBvc2l0aW9ufSxvcHRpb25zfHx7fSk7ZGVmPXRoaXMuX2FkZFgyTWFueURlZmF1bHRSZWNvcmQobGlzdCxjcmVhdGVPcHRpb25zKS50aGVuKGZ1bmN0aW9uKGlkcyl7Xy5lYWNoKGlkcyxmdW5jdGlvbihpZCl7aWYoY29tbWFuZC5wb3NpdGlvbj09PSdib3R0b20nJiZsaXN0Lm9yZGVyZWRSZXNJRHMmJmxpc3Qub3JkZXJlZFJlc0lEcy5sZW5ndGg+PWxpc3QubGltaXQpe2xpc3QudGVtcExpbWl0SW5jcmVtZW50PShsaXN0LnRlbXBMaW1pdEluY3JlbWVudHx8MCkrMTtsaXN0LmxpbWl0Kz0xO30KaWYoY29tbWFuZC5kYXRhKXtyZXR1cm4gc2VsZi5fYXBwbHlDaGFuZ2UoaWQsY29tbWFuZC5kYXRhKTt9fSk7fSk7ZGVmcy5wdXNoKGRlZik7YnJlYWs7Y2FzZSdVUERBVEUnOmxpc3QuX2NoYW5nZXMucHVzaCh7b3BlcmF0aW9uOidVUERBVEUnLGlkOmNvbW1hbmQuaWR9KTtpZihjb21tYW5kLmRhdGEpe2RlZnMucHVzaCh0aGlzLl9hcHBseUNoYW5nZShjb21tYW5kLmlkLGNvbW1hbmQuZGF0YSkpO30KYnJlYWs7Y2FzZSdGT1JHRVQnOmxpc3QuX2ZvcmNlTTJNVW5saW5rPXRydWU7Y2FzZSdERUxFVEUnOnZhciBpZHNUb1JlbW92ZT1jb21tYW5kLmlkcztsaXN0Ll9jaGFuZ2VzPV8ucmVqZWN0KGxpc3QuX2NoYW5nZXMsZnVuY3Rpb24oY2hhbmdlLGluZGV4KXt2YXIgaWRJbkNvbW1hbmRzPV8uY29udGFpbnMoY29tbWFuZC5pZHMsY2hhbmdlLmlkKTtpZihpZEluQ29tbWFuZHMmJmNoYW5nZS5vcGVyYXRpb249PT0nQUREJyl7aWRzVG9SZW1vdmU9Xy53aXRob3V0KGlkc1RvUmVtb3ZlLGNoYW5nZS5pZCk7fQpyZXR1cm4gaWRJbkNvbW1hbmRzO30pO18uZWFjaChpZHNUb1JlbW92ZSxmdW5jdGlvbihpZCl7dmFyIG9wZXJhdGlvbj1saXN0Ll9mb3JjZU0yTVVubGluaz8nRk9SR0VUJzonREVMRVRFJztsaXN0Ll9jaGFuZ2VzLnB1c2goe29wZXJhdGlvbjpvcGVyYXRpb24saWQ6aWR9KTt9KTticmVhaztjYXNlJ0RFTEVURV9BTEwnOmxpc3QuX2NoYW5nZXM9Xy5yZWplY3QobGlzdC5fY2hhbmdlcyxmdW5jdGlvbihjaGFuZ2Upe3JldHVybiBjaGFuZ2Uub3BlcmF0aW9uPT09J0FERCc7fSk7cmV0dXJuIHRoaXMuX2FwcGx5WDJNYW55Q2hhbmdlKHJlY29yZCxmaWVsZE5hbWUse29wZXJhdGlvbjonREVMRVRFJyxpZHM6bGlzdC5yZXNfaWRzfSxvcHRpb25zKTtjYXNlJ1JFUExBQ0VfV0lUSCc6bGlzdC5fY2hhbmdlcz1bXTt2YXIgbmV3SWRzPV8uZGlmZmVyZW5jZShjb21tYW5kLmlkcyxsaXN0LnJlc19pZHMpO3ZhciByZW1vdmVkSWRzPV8uZGlmZmVyZW5jZShsaXN0LnJlc19pZHMsY29tbWFuZC5pZHMpO3ZhciBhZGREZWYscmVtb3ZlZERlZix2YWx1ZXM7aWYobmV3SWRzLmxlbmd0aCl7dmFsdWVzPV8ubWFwKG5ld0lkcyxmdW5jdGlvbihpZCl7cmV0dXJue2lkOmlkfTt9KTthZGREZWY9dGhpcy5fYXBwbHlYMk1hbnlDaGFuZ2UocmVjb3JkLGZpZWxkTmFtZSx7b3BlcmF0aW9uOidBRERfTTJNJyxpZHM6dmFsdWVzfSxvcHRpb25zKTt9CmlmKHJlbW92ZWRJZHMubGVuZ3RoKXt2YXIgbGlzdERhdGE9Xy5tYXAobGlzdC5kYXRhLGZ1bmN0aW9uKGxvY2FsSWQpe3JldHVybiBzZWxmLmxvY2FsRGF0YVtsb2NhbElkXTt9KTtyZW1vdmVkRGVmPXRoaXMuX2FwcGx5WDJNYW55Q2hhbmdlKHJlY29yZCxmaWVsZE5hbWUse29wZXJhdGlvbjonREVMRVRFJyxpZHM6Xy5tYXAocmVtb3ZlZElkcyxmdW5jdGlvbihyZXNJRCl7aWYocmVzSUQgaW4gbGlzdC5fY2FjaGUpe3JldHVybiBsaXN0Ll9jYWNoZVtyZXNJRF07fQpyZXR1cm4gXy5maW5kV2hlcmUobGlzdERhdGEse3Jlc19pZDpyZXNJRH0pLmlkO30pLH0sb3B0aW9ucyk7fQpyZXR1cm4gUHJvbWlzZS5hbGwoW2FkZERlZixyZW1vdmVkRGVmXSk7Y2FzZSdNVUxUSSc6Xy5lYWNoKGNvbW1hbmQuY29tbWFuZHMsZnVuY3Rpb24oaW5uZXJDb21tYW5kKXtkZWZzLnB1c2goc2VsZi5fYXBwbHlYMk1hbnlDaGFuZ2UocmVjb3JkLGZpZWxkTmFtZSxpbm5lckNvbW1hbmQsb3B0aW9ucykpO30pO2JyZWFrO30KcmV0dXJuIFByb21pc2UuYWxsKGRlZnMpLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gc2VsZi5fcmVhZFVuZ3JvdXBlZExpc3QobGlzdCkudGhlbihmdW5jdGlvbigpe3JldHVybiBzZWxmLl9mZXRjaFgyTWFueXNCYXRjaGVkKGxpc3QpO30pO30pO30sX2FwcGx5WDJNYW55T3BlcmF0aW9uczpmdW5jdGlvbihsaXN0LG9wdGlvbnMpe2lmKCFsaXN0LnN0YXRpYyl7cmV0dXJuIGxpc3Q7fQp2YXIgc2VsZj10aGlzO2xpc3Q9Xy5leHRlbmQoe30sbGlzdCk7bGlzdC5yZXNfaWRzPWxpc3QucmVzX2lkcy5zbGljZSgwKTt2YXIgY2hhbmdlcz1saXN0Ll9jaGFuZ2VzfHxbXTtpZihvcHRpb25zKXt2YXIgdG89b3B0aW9ucy50bz09PTA/MDoob3B0aW9ucy50b3x8Y2hhbmdlcy5sZW5ndGgpO2NoYW5nZXM9Y2hhbmdlcy5zbGljZShvcHRpb25zLmZyb218fDAsdG8pO30KXy5lYWNoKGNoYW5nZXMsZnVuY3Rpb24oY2hhbmdlKXt2YXIgcmVsUmVjb3JkO2lmKGNoYW5nZS5pZCl7cmVsUmVjb3JkPXNlbGYubG9jYWxEYXRhW2NoYW5nZS5pZF07fQpzd2l0Y2goY2hhbmdlLm9wZXJhdGlvbil7Y2FzZSdBREQnOmxpc3QuY291bnQrKzt2YXIgcmVzSUQ9cmVsUmVjb3JkP3JlbFJlY29yZC5yZXNfaWQ6Y2hhbmdlLnJlc0lEO2lmKGNoYW5nZS5wb3NpdGlvbj09PSd0b3AnJiYob3B0aW9ucz9vcHRpb25zLnBvc2l0aW9uIT09J2JvdHRvbSc6dHJ1ZSkpe2xpc3QucmVzX2lkcy51bnNoaWZ0KHJlc0lEKTt9ZWxzZXtsaXN0LnJlc19pZHMucHVzaChyZXNJRCk7fQpicmVhaztjYXNlJ0ZPUkdFVCc6Y2FzZSdERUxFVEUnOmxpc3QuY291bnQtLTt2YXIgZGVsZXRlZFJlc0lEPXJlbFJlY29yZD9yZWxSZWNvcmQucmVzX2lkOmNoYW5nZS5pZDtsaXN0LnJlc19pZHM9Xy53aXRob3V0KGxpc3QucmVzX2lkcyxkZWxldGVkUmVzSUQpO2JyZWFrO2Nhc2UnUkVNT1ZFX0FMTCc6bGlzdC5jb3VudD0wO2xpc3QucmVzX2lkcz1bXTticmVhaztjYXNlJ1VQREFURSc6YnJlYWs7fX0pO3RoaXMuX3NldERhdGFJblJhbmdlKGxpc3QpO3JldHVybiBsaXN0O30sX2J1aWxkT25jaGFuZ2VTcGVjczpmdW5jdGlvbihyZWNvcmQsdmlld1R5cGUpe3ZhciBoYXNPbmNoYW5nZT1mYWxzZTt2YXIgc3BlY3M9e307dmFyIGZpZWxkc0luZm89cmVjb3JkLmZpZWxkc0luZm9bdmlld1R5cGV8fHJlY29yZC52aWV3VHlwZV07Z2VuZXJhdGVTcGVjcyhmaWVsZHNJbmZvLHJlY29yZC5maWVsZHMpO2Z1bmN0aW9uIGdlbmVyYXRlU3BlY3MoZmllbGRzSW5mbyxmaWVsZHMscHJlZml4KXtwcmVmaXg9cHJlZml4fHwnJztfLmVhY2goT2JqZWN0LmtleXMoZmllbGRzSW5mbyksZnVuY3Rpb24obmFtZSl7dmFyIGZpZWxkPWZpZWxkc1tuYW1lXTt2YXIgZmllbGRJbmZvPWZpZWxkc0luZm9bbmFtZV07dmFyIGtleT1wcmVmaXgrbmFtZTtzcGVjc1trZXldPShmaWVsZC5vbkNoYW5nZSl8fCIiO2lmKGZpZWxkLm9uQ2hhbmdlKXtoYXNPbmNoYW5nZT10cnVlO30KaWYoZmllbGQudHlwZT09PSdvbmUybWFueSd8fGZpZWxkLnR5cGU9PT0nbWFueTJtYW55Jyl7Xy5lYWNoKGZpZWxkSW5mby52aWV3cyxmdW5jdGlvbih2aWV3KXtnZW5lcmF0ZVNwZWNzKHZpZXcuZmllbGRzSW5mb1t2aWV3LnR5cGVdLHZpZXcuZmllbGRzLGtleSsnLicpO30pO319KTt9CnJldHVybiBoYXNPbmNoYW5nZT9zcGVjczpmYWxzZTt9LF9jb21wdXRlT3ZlcnJpZGVEZWZhdWx0RmllbGRzOmZ1bmN0aW9uKGxpc3RJRCxwb3NpdGlvbil7dmFyIGxpc3Q9dGhpcy5sb2NhbERhdGFbbGlzdElEXTt2YXIgaGFuZGxlRmllbGQ7aWYoIWxpc3Qpe3JldHVybnt9O30KcG9zaXRpb249cG9zaXRpb258fCdib3R0b20nO2lmKCFsaXN0LmZpZWxkc0luZm8pe3JldHVybnt9O30KZm9yKHZhciBmaWVsZCBpbiBsaXN0LmZpZWxkc0luZm8ubGlzdCl7aWYobGlzdC5maWVsZHNJbmZvLmxpc3RbZmllbGRdLndpZGdldD09PSdoYW5kbGUnKXtoYW5kbGVGaWVsZD1maWVsZDticmVhazt9fQppZighaGFuZGxlRmllbGQpe3JldHVybnt9O30KdmFyIGlzT3JkZXJlZEJ5SGFuZGxlPWxpc3Qub3JkZXJlZEJ5JiZsaXN0Lm9yZGVyZWRCeS5sZW5ndGgmJmxpc3Qub3JkZXJlZEJ5WzBdLmFzYz09PXRydWUmJmxpc3Qub3JkZXJlZEJ5WzBdLm5hbWU9PT1oYW5kbGVGaWVsZDtpZighaXNPcmRlcmVkQnlIYW5kbGUpe3JldHVybnt9O30KdmFyIGNvbXB1dGVkTGlzdD10aGlzLmdldChsaXN0LmlkLHtyYXc6dHJ1ZX0pO2lmKCFjb21wdXRlZExpc3R8fCFjb21wdXRlZExpc3QuZGF0YXx8IWNvbXB1dGVkTGlzdC5kYXRhLmxlbmd0aCl7cmV0dXJue307fQp2YXIgaW5kZXg9TWF0aC5taW4oY29tcHV0ZWRMaXN0LmRhdGEubGVuZ3RoLTEscG9zaXRpb24hPT0ndG9wJz9saXN0LmxpbWl0LTE6MCk7dmFyIGhhbmRsZUZpZWxkVmFsdWU9Y29tcHV0ZWRMaXN0LmRhdGFbaW5kZXhdLmRhdGFbaGFuZGxlRmllbGRdO2lmKHBvc2l0aW9uPT09J3RvcCcpe2hhbmRsZUZpZWxkVmFsdWUtLTt9ZWxzZSBpZihsaXN0LmNvdW50PD1saXN0Lm9mZnNldCtsaXN0LmxpbWl0LShsaXN0LnRlbXBMaW1pdEluY3JlbWVudHx8MCkpe2hhbmRsZUZpZWxkVmFsdWUrKzt9CnJldHVybntmaWVsZDpoYW5kbGVGaWVsZCx2YWx1ZTpoYW5kbGVGaWVsZFZhbHVlLH07fSxfZXZhbE1vZGlmaWVyczpmdW5jdGlvbihlbGVtZW50LG1vZGlmaWVycyl7dmFyIHJlc3VsdD17fTt2YXIgc2VsZj10aGlzO3ZhciBldmFsQ29udGV4dDtmdW5jdGlvbiBldmFsTW9kaWZpZXIobW9kKXtpZihtb2Q9PT11bmRlZmluZWR8fG1vZD09PWZhbHNlfHxtb2Q9PT10cnVlKXtyZXR1cm4hIW1vZDt9CmV2YWxDb250ZXh0PWV2YWxDb250ZXh0fHxzZWxmLl9nZXRFdmFsQ29udGV4dChlbGVtZW50KTtyZXR1cm4gbmV3IERvbWFpbihtb2QsZXZhbENvbnRleHQpLmNvbXB1dGUoZXZhbENvbnRleHQpO30KaWYoJ2ludmlzaWJsZSdpbiBtb2RpZmllcnMpe3Jlc3VsdC5pbnZpc2libGU9ZXZhbE1vZGlmaWVyKG1vZGlmaWVycy5pbnZpc2libGUpO30KaWYoJ2NvbHVtbl9pbnZpc2libGUnaW4gbW9kaWZpZXJzKXtyZXN1bHQuY29sdW1uX2ludmlzaWJsZT1ldmFsTW9kaWZpZXIobW9kaWZpZXJzLmNvbHVtbl9pbnZpc2libGUpO30KaWYoJ3JlYWRvbmx5J2luIG1vZGlmaWVycyl7cmVzdWx0LnJlYWRvbmx5PWV2YWxNb2RpZmllcihtb2RpZmllcnMucmVhZG9ubHkpO30KaWYoJ3JlcXVpcmVkJ2luIG1vZGlmaWVycyl7cmVzdWx0LnJlcXVpcmVkPWV2YWxNb2RpZmllcihtb2RpZmllcnMucmVxdWlyZWQpO30KcmV0dXJuIHJlc3VsdDt9LF9mZXRjaE1hbnkyT25lR3JvdXA6ZnVuY3Rpb24oZ3JvdXBzKXt2YXIgaWRzPV8udW5pcShfLnBsdWNrKF8ucGx1Y2soZ3JvdXBzLCdyZWNvcmQnKSwncmVzX2lkJykpO3JldHVybiB0aGlzLl9ycGMoe21vZGVsOmdyb3Vwc1swXS5yZWNvcmQubW9kZWwsbWV0aG9kOiduYW1lX2dldCcsYXJnczpbaWRzXSxjb250ZXh0Omdyb3Vwc1swXS5jb250ZXh0fSkudGhlbihmdW5jdGlvbihuYW1lX2dldHMpe18uZWFjaChncm91cHMsZnVuY3Rpb24ob2JqKXt2YXIgbmFtZUdldD1fLmZpbmQobmFtZV9nZXRzLGZ1bmN0aW9uKG4pe3JldHVybiBuWzBdPT09b2JqLnJlY29yZC5yZXNfaWQ7fSk7b2JqLnJlY29yZC5kYXRhLmRpc3BsYXlfbmFtZT1uYW1lR2V0WzFdO30pO30pO30sX2ZldGNoTmFtZUdldDpmdW5jdGlvbihkYXRhUG9pbnQpe3JldHVybiB0aGlzLl9ycGMoe21vZGVsOmRhdGFQb2ludC5tb2RlbCxtZXRob2Q6J25hbWVfZ2V0JyxhcmdzOltkYXRhUG9pbnQucmVzX2lkXSxjb250ZXh0OmRhdGFQb2ludC5nZXRDb250ZXh0KCksfSkudGhlbihmdW5jdGlvbihyZXN1bHQpe2RhdGFQb2ludC5kYXRhLmRpc3BsYXlfbmFtZT1yZXN1bHRbMF1bMV07fSk7fSxfZmV0Y2hOYW1lR2V0czpmdW5jdGlvbihsaXN0LGZpZWxkTmFtZSl7dmFyIHNlbGY9dGhpczt2YXIgbW9kZWw9bGlzdC5maWVsZHNbZmllbGROYW1lXS5yZWxhdGlvbjt2YXIgcmVjb3Jkcz1bXTt2YXIgaWRzPVtdO2xpc3Q9dGhpcy5fYXBwbHlYMk1hbnlPcGVyYXRpb25zKGxpc3QpO18uZWFjaChsaXN0LmRhdGEsZnVuY3Rpb24obG9jYWxJZCl7dmFyIHJlY29yZD1zZWxmLmxvY2FsRGF0YVtsb2NhbElkXTt2YXIgZGF0YT1yZWNvcmQuX2NoYW5nZXN8fHJlY29yZC5kYXRhO3ZhciBtYW55Mm9uZUlkPWRhdGFbZmllbGROYW1lXTtpZighbWFueTJvbmVJZCl7cmV0dXJuO30KdmFyIG1hbnkyb25lUmVjb3JkPXNlbGYubG9jYWxEYXRhW21hbnkyb25lSWRdO3JlY29yZHMucHVzaChtYW55Mm9uZVJlY29yZCk7aWRzLnB1c2gobWFueTJvbmVSZWNvcmQucmVzX2lkKTttb2RlbD1tYW55Mm9uZVJlY29yZC5tb2RlbDt9KTtpZighaWRzLmxlbmd0aCl7cmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO30KcmV0dXJuIHRoaXMuX3JwYyh7bW9kZWw6bW9kZWwsbWV0aG9kOiduYW1lX2dldCcsYXJnczpbXy51bmlxKGlkcyldLGNvbnRleHQ6bGlzdC5jb250ZXh0LH0pLnRoZW4oZnVuY3Rpb24obmFtZV9nZXRzKXtfLmVhY2gocmVjb3JkcyxmdW5jdGlvbihyZWNvcmQpe3ZhciBuYW1lR2V0PV8uZmluZChuYW1lX2dldHMsZnVuY3Rpb24obmFtZUdldCl7cmV0dXJuIG5hbWVHZXRbMF09PT1yZWNvcmQuZGF0YS5pZDt9KTtyZWNvcmQuZGF0YS5kaXNwbGF5X25hbWU9bmFtZUdldFsxXTt9KTt9KTt9LF9mZXRjaFJlY29yZDpmdW5jdGlvbihyZWNvcmQsb3B0aW9ucyl7dmFyIHNlbGY9dGhpcztvcHRpb25zPW9wdGlvbnN8fHt9O3ZhciBmaWVsZE5hbWVzPW9wdGlvbnMuZmllbGROYW1lc3x8cmVjb3JkLmdldEZpZWxkTmFtZXMob3B0aW9ucyk7ZmllbGROYW1lcz1fLnVuaXEoZmllbGROYW1lcy5jb25jYXQoWydkaXNwbGF5X25hbWUnXSkpO3JldHVybiB0aGlzLl9ycGMoe21vZGVsOnJlY29yZC5tb2RlbCxtZXRob2Q6J3JlYWQnLGFyZ3M6W1tyZWNvcmQucmVzX2lkXSxmaWVsZE5hbWVzXSxjb250ZXh0Ol8uZXh0ZW5kKHt9LHJlY29yZC5nZXRDb250ZXh0KCkse2Jpbl9zaXplOnRydWV9KSx9KS50aGVuKGZ1bmN0aW9uKHJlc3VsdCl7aWYocmVzdWx0Lmxlbmd0aD09PTApe3JldHVybiBQcm9taXNlLnJlamVjdCgpO30KcmVzdWx0PXJlc3VsdFswXTtyZWNvcmQuZGF0YT1fLmV4dGVuZCh7fSxyZWNvcmQuZGF0YSxyZXN1bHQpO30pLnRoZW4oZnVuY3Rpb24oKXtzZWxmLl9wYXJzZVNlcnZlckRhdGEoZmllbGROYW1lcyxyZWNvcmQscmVjb3JkLmRhdGEpO30pLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gUHJvbWlzZS5hbGwoW3NlbGYuX2ZldGNoWDJNYW55cyhyZWNvcmQsb3B0aW9ucyksc2VsZi5fZmV0Y2hSZWZlcmVuY2VzKHJlY29yZCxvcHRpb25zKV0pLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gc2VsZi5fcG9zdHByb2Nlc3MocmVjb3JkLG9wdGlvbnMpO30pO30pO30sX2ZldGNoUmVmZXJlbmNlOmZ1bmN0aW9uKHJlY29yZCxmaWVsZE5hbWUpe3ZhciBzZWxmPXRoaXM7dmFyIGRlZjt2YXIgdmFsdWU9cmVjb3JkLl9jaGFuZ2VzJiZyZWNvcmQuX2NoYW5nZXNbZmllbGROYW1lXXx8cmVjb3JkLmRhdGFbZmllbGROYW1lXTt2YXIgbW9kZWw9dmFsdWUmJnZhbHVlLnNwbGl0KCcsJylbMF07dmFyIHJlc0lEPXZhbHVlJiZwYXJzZUludCh2YWx1ZS5zcGxpdCgnLCcpWzFdKTtpZihtb2RlbCYmbW9kZWwhPT0nRmFsc2UnJiZyZXNJRCl7ZGVmPXNlbGYuX3JwYyh7bW9kZWw6bW9kZWwsbWV0aG9kOiduYW1lX2dldCcsYXJnczpbcmVzSURdLGNvbnRleHQ6cmVjb3JkLmdldENvbnRleHQoe2ZpZWxkTmFtZTpmaWVsZE5hbWV9KSx9KS50aGVuKGZ1bmN0aW9uKHJlc3VsdCl7cmV0dXJuIHNlbGYuX21ha2VEYXRhUG9pbnQoe2RhdGE6e2lkOnJlc3VsdFswXVswXSxkaXNwbGF5X25hbWU6cmVzdWx0WzBdWzFdLH0sbW9kZWxOYW1lOm1vZGVsLHBhcmVudElEOnJlY29yZC5pZCx9KTt9KTt9CnJldHVybiBQcm9taXNlLnJlc29sdmUoZGVmKTt9LF9mZXRjaFJlZmVyZW5jZURhdGE6ZnVuY3Rpb24oZGF0YXBvaW50cyxtb2RlbCxmaWVsZE5hbWUpe3ZhciBzZWxmPXRoaXM7dmFyIGlkcz1fLm1hcChPYmplY3Qua2V5cyhkYXRhcG9pbnRzKSxmdW5jdGlvbihpZCl7cmV0dXJuIHBhcnNlSW50KGlkKTt9KTt2YXIgcGFyZW50PWRhdGFwb2ludHNbaWRzWzBdXVswXTt2YXIgZGVmPXNlbGYuX3JwYyh7bW9kZWw6bW9kZWwsbWV0aG9kOiduYW1lX2dldCcsYXJnczpbaWRzXSxjb250ZXh0OnNlbGYubG9jYWxEYXRhW3BhcmVudF0uZ2V0Q29udGV4dCh7ZmllbGROYW1lOmZpZWxkTmFtZX0pLH0pLnRoZW4oZnVuY3Rpb24ocmVzdWx0KXtfLmVhY2gocmVzdWx0LGZ1bmN0aW9uKGVsKXt2YXIgcGFyZW50SURzPWRhdGFwb2ludHNbZWxbMF1dO18uZWFjaChwYXJlbnRJRHMsZnVuY3Rpb24ocGFyZW50SUQpe3ZhciBwYXJlbnQ9c2VsZi5sb2NhbERhdGFbcGFyZW50SURdO3ZhciByZWZlcmVuY2VEcD1zZWxmLl9tYWtlRGF0YVBvaW50KHtkYXRhOntpZDplbFswXSxkaXNwbGF5X25hbWU6ZWxbMV0sfSxtb2RlbE5hbWU6bW9kZWwscGFyZW50SUQ6cGFyZW50LH0pO3BhcmVudC5kYXRhW2ZpZWxkTmFtZV09cmVmZXJlbmNlRHAuaWQ7fSk7fSk7fSk7cmV0dXJuIGRlZjt9LF9mZXRjaFJlZmVyZW5jZXM6ZnVuY3Rpb24ocmVjb3JkLG9wdGlvbnMpe3ZhciBzZWxmPXRoaXM7dmFyIGRlZnM9W107dmFyIGZpZWxkTmFtZXM9b3B0aW9ucyYmb3B0aW9ucy5maWVsZE5hbWVzfHxyZWNvcmQuZ2V0RmllbGROYW1lcygpO18uZWFjaChmaWVsZE5hbWVzLGZ1bmN0aW9uKGZpZWxkTmFtZSl7dmFyIGZpZWxkPXJlY29yZC5maWVsZHNbZmllbGROYW1lXTtpZihmaWVsZC50eXBlPT09J3JlZmVyZW5jZScpe3ZhciBkZWY9c2VsZi5fZmV0Y2hSZWZlcmVuY2UocmVjb3JkLGZpZWxkTmFtZSkudGhlbihmdW5jdGlvbihkYXRhUG9pbnQpe2lmKGRhdGFQb2ludCl7cmVjb3JkLmRhdGFbZmllbGROYW1lXT1kYXRhUG9pbnQuaWQ7fX0pO2RlZnMucHVzaChkZWYpO319KTtyZXR1cm4gUHJvbWlzZS5hbGwoZGVmcyk7fSxfZmV0Y2hSZWZlcmVuY2VCYXRjaGVkOmZ1bmN0aW9uKGxpc3QsZmllbGROYW1lKXt2YXIgc2VsZj10aGlzO2xpc3Q9dGhpcy5fYXBwbHlYMk1hbnlPcGVyYXRpb25zKGxpc3QpO3RoaXMuX3NvcnRMaXN0KGxpc3QpO3ZhciB0b0ZldGNoPXRoaXMuX2dldERhdGFUb0ZldGNoQnlNb2RlbChsaXN0LGZpZWxkTmFtZSk7dmFyIGRlZnM9W107Xy5lYWNoKHRvRmV0Y2gsZnVuY3Rpb24oZGF0YXBvaW50cyxtb2RlbCl7ZGVmcy5wdXNoKHNlbGYuX2ZldGNoUmVmZXJlbmNlRGF0YShkYXRhcG9pbnRzLG1vZGVsLGZpZWxkTmFtZSkpO30pO3JldHVybiBQcm9taXNlLmFsbChkZWZzKTt9LF9mZXRjaFJlZmVyZW5jZXNCYXRjaGVkOmZ1bmN0aW9uKGxpc3Qpe3ZhciBkZWZzPVtdO3ZhciBmaWVsZE5hbWVzPWxpc3QuZ2V0RmllbGROYW1lcygpO2Zvcih2YXIgaT0wO2k8ZmllbGROYW1lcy5sZW5ndGg7aSsrKXt2YXIgZmllbGQ9bGlzdC5maWVsZHNbZmllbGROYW1lc1tpXV07aWYoZmllbGQudHlwZT09PSdyZWZlcmVuY2UnKXtkZWZzLnB1c2godGhpcy5fZmV0Y2hSZWZlcmVuY2VCYXRjaGVkKGxpc3QsZmllbGROYW1lc1tpXSkpO319CnJldHVybiBQcm9taXNlLmFsbChkZWZzKTt9LF9mZXRjaFJlZmVyZW5jZVNpbmdsZUJhdGNoOmZ1bmN0aW9uKGxpc3QsZmllbGROYW1lKXt2YXIgc2VsZj10aGlzO3ZhciB0b0ZldGNoPXt9O18uZWFjaChsaXN0LmRhdGEsZnVuY3Rpb24oZ3JvdXBJbmRleCl7dmFyIGdyb3VwPXNlbGYubG9jYWxEYXRhW2dyb3VwSW5kZXhdO18uZXh0ZW5kKHRvRmV0Y2gsc2VsZi5fZ2V0RGF0YVRvRmV0Y2hCeU1vZGVsKGdyb3VwLGZpZWxkTmFtZSkpO30pO3ZhciBkZWZzPVtdO18uZWFjaCh0b0ZldGNoLGZ1bmN0aW9uKGRhdGFwb2ludHMsbW9kZWwpe2RlZnMucHVzaChzZWxmLl9mZXRjaFJlZmVyZW5jZURhdGEoZGF0YXBvaW50cyxtb2RlbCxmaWVsZE5hbWUpKTt9KTtyZXR1cm4gUHJvbWlzZS5hbGwoZGVmcyk7fSxfZmV0Y2hSZWZlcmVuY2VzU2luZ2xlQmF0Y2g6ZnVuY3Rpb24obGlzdCl7dmFyIGRlZnM9W107dmFyIGZpZWxkTmFtZXM9bGlzdC5nZXRGaWVsZE5hbWVzKCk7Zm9yKHZhciBmSW5kZXggaW4gZmllbGROYW1lcyl7dmFyIGZpZWxkPWxpc3QuZmllbGRzW2ZpZWxkTmFtZXNbZkluZGV4XV07aWYoZmllbGQudHlwZT09PSdyZWZlcmVuY2UnKXtkZWZzLnB1c2godGhpcy5fZmV0Y2hSZWZlcmVuY2VTaW5nbGVCYXRjaChsaXN0LGZpZWxkTmFtZXNbZkluZGV4XSkpO319CnJldHVybiBQcm9taXNlLmFsbChkZWZzKTt9LF9mZXRjaFJlbGF0ZWREYXRhOmZ1bmN0aW9uKGxpc3QsdG9GZXRjaCxmaWVsZE5hbWUpe3ZhciBzZWxmPXRoaXM7dmFyIGlkcz1fLmtleXModG9GZXRjaCk7Zm9yKHZhciBpPTA7aTxpZHMubGVuZ3RoO2krKyl7aWRzW2ldPU51bWJlcihpZHNbaV0pO30KdmFyIGZpZWxkSW5mbz1saXN0LmZpZWxkc0luZm9bbGlzdC52aWV3VHlwZV1bZmllbGROYW1lXTtpZighaWRzLmxlbmd0aHx8ZmllbGRJbmZvLl9fbm9fZmV0Y2gpe3JldHVybiBQcm9taXNlLnJlc29sdmUoKTt9CnZhciBkZWY7dmFyIGZpZWxkTmFtZXM9Xy5rZXlzKGZpZWxkSW5mby5yZWxhdGVkRmllbGRzKTtpZihmaWVsZE5hbWVzLmxlbmd0aCl7dmFyIGZpZWxkPWxpc3QuZmllbGRzW2ZpZWxkTmFtZV07ZGVmPXRoaXMuX3JwYyh7bW9kZWw6ZmllbGQucmVsYXRpb24sbWV0aG9kOidyZWFkJyxhcmdzOltpZHMsZmllbGROYW1lc10sY29udGV4dDpsaXN0LmdldENvbnRleHQoKXx8e30sfSk7fWVsc2V7ZGVmPVByb21pc2UucmVzb2x2ZShfLm1hcChpZHMsZnVuY3Rpb24oaWQpe3JldHVybntpZDppZH07fSkpO30KcmV0dXJuIGRlZi50aGVuKGZ1bmN0aW9uKHJlc3VsdCl7dmFyIHJlY29yZHM9Xy51bmlxKF8uZmxhdHRlbihfLnZhbHVlcyh0b0ZldGNoKSkpO3NlbGYuX3VwZGF0ZVJlY29yZHNEYXRhKHJlY29yZHMsZmllbGROYW1lLHJlc3VsdCk7fSk7fSxfZmV0Y2hSZWxhdGlvbmFsRGF0YTpmdW5jdGlvbihyZWNvcmQpe3ZhciBzZWxmPXRoaXM7dmFyIHRvQmVGZXRjaGVkPVtdO18uZWFjaChyZWNvcmQuZ2V0RmllbGROYW1lcygpLGZ1bmN0aW9uKG5hbWUpe3ZhciBmaWVsZD1yZWNvcmQuZmllbGRzW25hbWVdO2lmKGZpZWxkLnR5cGU9PT0nbWFueTJvbmUnJiYhcmVjb3JkLmZpZWxkc0luZm9bcmVjb3JkLnZpZXdUeXBlXVtuYW1lXS5fX25vX2ZldGNoKXt2YXIgbG9jYWxJZD0ocmVjb3JkLl9jaGFuZ2VzJiZyZWNvcmQuX2NoYW5nZXNbbmFtZV0pfHxyZWNvcmQuZGF0YVtuYW1lXTt2YXIgcmVsYXRlZFJlY29yZD1zZWxmLmxvY2FsRGF0YVtsb2NhbElkXTtpZighcmVsYXRlZFJlY29yZHx8cmVsYXRlZFJlY29yZC5kYXRhLmRpc3BsYXlfbmFtZSl7cmV0dXJuO30KdG9CZUZldGNoZWQucHVzaCh7Y29udGV4dDpyZWNvcmQuZ2V0Q29udGV4dCh7ZmllbGROYW1lOm5hbWUsdmlld1R5cGU6cmVjb3JkLnZpZXdUeXBlfSkscmVjb3JkOnJlbGF0ZWRSZWNvcmR9KTt9fSk7dmFyIGdyb3Vwcz1fLmdyb3VwQnkodG9CZUZldGNoZWQsZnVuY3Rpb24oZWxlbSl7cmV0dXJuW2VsZW0ucmVjb3JkLm1vZGVsLEpTT04uc3RyaW5naWZ5KGVsZW0uY29udGV4dCldLmpvaW4oKTt9KTtyZXR1cm4gUHJvbWlzZS5hbGwoXy5tYXAoZ3JvdXBzLHRoaXMuX2ZldGNoTWFueTJPbmVHcm91cC5iaW5kKHRoaXMpKSk7fSxfZmV0Y2hTcGVjaWFsRGF0YTpmdW5jdGlvbihyZWNvcmQsb3B0aW9ucyl7dmFyIHNlbGY9dGhpczt2YXIgc3BlY2lhbEZpZWxkTmFtZXM9W107dmFyIGZpZWxkTmFtZXM9KG9wdGlvbnMmJm9wdGlvbnMuZmllbGROYW1lcyl8fHJlY29yZC5nZXRGaWVsZE5hbWVzKCk7cmV0dXJuIFByb21pc2UuYWxsKF8ubWFwKGZpZWxkTmFtZXMsZnVuY3Rpb24obmFtZSl7dmFyIHZpZXdUeXBlPShvcHRpb25zJiZvcHRpb25zLnZpZXdUeXBlKXx8cmVjb3JkLnZpZXdUeXBlO3ZhciBmaWVsZEluZm89cmVjb3JkLmZpZWxkc0luZm9bdmlld1R5cGVdW25hbWVdfHx7fTt2YXIgV2lkZ2V0PWZpZWxkSW5mby5XaWRnZXQ7aWYoV2lkZ2V0JiZXaWRnZXQucHJvdG90eXBlLnNwZWNpYWxEYXRhKXtyZXR1cm4gc2VsZltXaWRnZXQucHJvdG90eXBlLnNwZWNpYWxEYXRhXShyZWNvcmQsbmFtZSxmaWVsZEluZm8pLnRoZW4oZnVuY3Rpb24oZGF0YSl7aWYoZGF0YT09PXVuZGVmaW5lZCl7cmV0dXJuO30KcmVjb3JkLnNwZWNpYWxEYXRhW25hbWVdPWRhdGE7c3BlY2lhbEZpZWxkTmFtZXMucHVzaChuYW1lKTt9KTt9fSkpLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gc3BlY2lhbEZpZWxkTmFtZXM7fSk7fSxfZmV0Y2hTcGVjaWFsTWFueTJvbmVzOmZ1bmN0aW9uKHJlY29yZCxmaWVsZE5hbWUsZmllbGRJbmZvLGZpZWxkc1RvUmVhZCl7dmFyIGZpZWxkPXJlY29yZC5maWVsZHNbZmllbGROYW1lXTtpZihmaWVsZC50eXBlIT09Im1hbnkyb25lIil7cmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO30KdmFyIGNvbnRleHQ9cmVjb3JkLmdldENvbnRleHQoe2ZpZWxkTmFtZTpmaWVsZE5hbWV9KTt2YXIgZG9tYWluPXJlY29yZC5nZXREb21haW4oe2ZpZWxkTmFtZTpmaWVsZE5hbWV9KTtpZihkb21haW4ubGVuZ3RoKXt2YXIgbG9jYWxJRD0ocmVjb3JkLl9jaGFuZ2VzJiZmaWVsZE5hbWUgaW4gcmVjb3JkLl9jaGFuZ2VzKT9yZWNvcmQuX2NoYW5nZXNbZmllbGROYW1lXTpyZWNvcmQuZGF0YVtmaWVsZE5hbWVdO2lmKGxvY2FsSUQpe3ZhciBlbGVtZW50PXRoaXMubG9jYWxEYXRhW2xvY2FsSURdO2RvbWFpbj1bInwiLFsiaWQiLCI9IixlbGVtZW50LmRhdGEuaWRdXS5jb25jYXQoZG9tYWluKTt9fQp2YXIgaGFzQ2hhbmdlZD10aGlzLl9zYXZlU3BlY2lhbERhdGFDYWNoZShyZWNvcmQsZmllbGROYW1lLHtjb250ZXh0OmNvbnRleHQsZG9tYWluOmRvbWFpbix9KTtpZighaGFzQ2hhbmdlZCl7cmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO30KdmFyIHNlbGY9dGhpcztyZXR1cm4gdGhpcy5fcnBjKHttb2RlbDpmaWVsZC5yZWxhdGlvbixtZXRob2Q6J3NlYXJjaF9yZWFkJyxmaWVsZHM6WyJpZCJdLmNvbmNhdChmaWVsZHNUb1JlYWR8fFtdKSxjb250ZXh0OmNvbnRleHQsZG9tYWluOmRvbWFpbix9KS50aGVuKGZ1bmN0aW9uKHJlY29yZHMpe3ZhciBpZHM9Xy5wbHVjayhyZWNvcmRzLCdpZCcpO3JldHVybiBzZWxmLl9ycGMoe21vZGVsOmZpZWxkLnJlbGF0aW9uLG1ldGhvZDonbmFtZV9nZXQnLGFyZ3M6W2lkc10sY29udGV4dDpjb250ZXh0LH0pLnRoZW4oZnVuY3Rpb24obmFtZV9nZXRzKXtfLmVhY2gocmVjb3JkcyxmdW5jdGlvbihyZWMpe3ZhciBuYW1lX2dldD1fLmZpbmQobmFtZV9nZXRzLGZ1bmN0aW9uKG4pe3JldHVybiBuWzBdPT09cmVjLmlkO30pO3JlYy5kaXNwbGF5X25hbWU9bmFtZV9nZXRbMV07fSk7cmV0dXJuIHJlY29yZHM7fSk7fSk7fSxfZmV0Y2hTcGVjaWFsUmVsYXRpb246ZnVuY3Rpb24ocmVjb3JkLGZpZWxkTmFtZSl7dmFyIGZpZWxkPXJlY29yZC5maWVsZHNbZmllbGROYW1lXTtpZighXy5jb250YWlucyhbIm1hbnkyb25lIiwibWFueTJtYW55Iiwib25lMm1hbnkiXSxmaWVsZC50eXBlKSl7cmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO30KdmFyIGNvbnRleHQ9cmVjb3JkLmdldENvbnRleHQoe2ZpZWxkTmFtZTpmaWVsZE5hbWV9KTt2YXIgZG9tYWluPXJlY29yZC5nZXREb21haW4oe2ZpZWxkTmFtZTpmaWVsZE5hbWV9KTt2YXIgaGFzQ2hhbmdlZD10aGlzLl9zYXZlU3BlY2lhbERhdGFDYWNoZShyZWNvcmQsZmllbGROYW1lLHtjb250ZXh0OmNvbnRleHQsZG9tYWluOmRvbWFpbix9KTtpZighaGFzQ2hhbmdlZCl7cmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO30KcmV0dXJuIHRoaXMuX3JwYyh7bW9kZWw6ZmllbGQucmVsYXRpb24sbWV0aG9kOiduYW1lX3NlYXJjaCcsYXJnczpbIiIsZG9tYWluXSxjb250ZXh0OmNvbnRleHR9KTt9LF9mZXRjaFNwZWNpYWxSZWZlcmVuY2U6ZnVuY3Rpb24ocmVjb3JkLGZpZWxkTmFtZSl7dmFyIGRlZjt2YXIgZmllbGQ9cmVjb3JkLmZpZWxkc1tmaWVsZE5hbWVdO2lmKGZpZWxkLnR5cGU9PT0nY2hhcicpe2RlZj10aGlzLl9mZXRjaFJlZmVyZW5jZShyZWNvcmQsZmllbGROYW1lKTt9CnJldHVybiBQcm9taXNlLnJlc29sdmUoZGVmKTt9LF9mZXRjaFNwZWNpYWxTdGF0dXM6ZnVuY3Rpb24ocmVjb3JkLGZpZWxkTmFtZSxmaWVsZEluZm8pe3ZhciBmb2xkRmllbGQ9ZmllbGRJbmZvLm9wdGlvbnMuZm9sZF9maWVsZDt2YXIgZmllbGRzVG9SZWFkPWZvbGRGaWVsZD9bZm9sZEZpZWxkXTpbXTtyZXR1cm4gdGhpcy5fZmV0Y2hTcGVjaWFsTWFueTJvbmVzKHJlY29yZCxmaWVsZE5hbWUsZmllbGRJbmZvLGZpZWxkc1RvUmVhZCkudGhlbihmdW5jdGlvbihtMm9zKXtfLmVhY2gobTJvcyxmdW5jdGlvbihtMm8pe20yby5mb2xkPWZvbGRGaWVsZD9tMm9bZm9sZEZpZWxkXTpmYWxzZTt9KTtyZXR1cm4gbTJvczt9KTt9LF9mZXRjaFNwZWNpYWxEb21haW46ZnVuY3Rpb24ocmVjb3JkLGZpZWxkTmFtZSxmaWVsZEluZm8pe3ZhciBzZWxmPXRoaXM7dmFyIGNvbnRleHQ9cmVjb3JkLmdldENvbnRleHQoe2ZpZWxkTmFtZTpmaWVsZE5hbWV9KTt2YXIgZG9tYWluTW9kZWw9ZmllbGRJbmZvLm9wdGlvbnMubW9kZWw7aWYocmVjb3JkLmRhdGEuaGFzT3duUHJvcGVydHkoZG9tYWluTW9kZWwpKXtkb21haW5Nb2RlbD1yZWNvcmQuX2NoYW5nZXMmJnJlY29yZC5fY2hhbmdlc1tkb21haW5Nb2RlbF18fHJlY29yZC5kYXRhW2RvbWFpbk1vZGVsXTt9CnZhciBkb21haW5WYWx1ZT1yZWNvcmQuX2NoYW5nZXMmJnJlY29yZC5fY2hhbmdlc1tmaWVsZE5hbWVdfHxyZWNvcmQuZGF0YVtmaWVsZE5hbWVdfHxbXTt2YXIgaGFzQ2hhbmdlZD10aGlzLl9zYXZlU3BlY2lhbERhdGFDYWNoZShyZWNvcmQsZmllbGROYW1lLHtjb250ZXh0OmNvbnRleHQsZG9tYWluTW9kZWw6ZG9tYWluTW9kZWwsZG9tYWluVmFsdWU6ZG9tYWluVmFsdWUsfSk7aWYoIWhhc0NoYW5nZWQpe3JldHVybiBQcm9taXNlLnJlc29sdmUoKTt9ZWxzZSBpZighZG9tYWluTW9kZWwpe3JldHVybiBQcm9taXNlLnJlc29sdmUoe21vZGVsOmRvbWFpbk1vZGVsLG5iUmVjb3JkczowLH0pO30KcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUpe3ZhciBldmFsQ29udGV4dD1zZWxmLl9nZXRFdmFsQ29udGV4dChyZWNvcmQpO3NlbGYuX3JwYyh7bW9kZWw6ZG9tYWluTW9kZWwsbWV0aG9kOidzZWFyY2hfY291bnQnLGFyZ3M6W0RvbWFpbi5wcm90b3R5cGUuc3RyaW5nVG9BcnJheShkb21haW5WYWx1ZSxldmFsQ29udGV4dCldLGNvbnRleHQ6Y29udGV4dH0pLnRoZW4oZnVuY3Rpb24obmJSZWNvcmRzKXtyZXNvbHZlKHttb2RlbDpkb21haW5Nb2RlbCxuYlJlY29yZHM6bmJSZWNvcmRzLH0pO30pLmd1YXJkZWRDYXRjaChmdW5jdGlvbihyZWFzb24pe3ZhciBlPXJlYXNvbi5ldmVudDtlLnByZXZlbnREZWZhdWx0KCk7cmVzb2x2ZSh7bW9kZWw6ZG9tYWluTW9kZWwsbmJSZWNvcmRzOjAsfSk7fSk7fSk7fSxfZmV0Y2hVbmdyb3VwZWRMaXN0OmZ1bmN0aW9uKGxpc3Qsb3B0aW9ucyl7b3B0aW9ucz1fLmRlZmF1bHRzKG9wdGlvbnN8fHt9LHtlbmFibGVSZWxhdGlvbmFsRmV0Y2g6dHJ1ZX0pO3ZhciBzZWxmPXRoaXM7dmFyIGRlZjtpZihsaXN0LnN0YXRpYyl7ZGVmPXRoaXMuX3JlYWRVbmdyb3VwZWRMaXN0KGxpc3QpLnRoZW4oZnVuY3Rpb24oKXtpZihsaXN0LnBhcmVudElEJiZzZWxmLmlzTmV3KGxpc3QucGFyZW50SUQpKXt2YXIgbWFueTJvbmVzPXNlbGYuX2dldE1hbnkyT25lRmllbGROYW1lcyhsaXN0KTt2YXIgZGVmcz1fLm1hcChtYW55Mm9uZXMsZnVuY3Rpb24obmFtZSl7cmV0dXJuIHNlbGYuX2ZldGNoTmFtZUdldHMobGlzdCxuYW1lKTt9KTtyZXR1cm4gUHJvbWlzZS5hbGwoZGVmcyk7fX0pO31lbHNle2RlZj10aGlzLl9zZWFyY2hSZWFkVW5ncm91cGVkTGlzdChsaXN0KTt9CnJldHVybiBkZWYudGhlbihmdW5jdGlvbigpe2lmKG9wdGlvbnMuZW5hYmxlUmVsYXRpb25hbEZldGNoKXtyZXR1cm4gUHJvbWlzZS5hbGwoW3NlbGYuX2ZldGNoWDJNYW55c0JhdGNoZWQobGlzdCksc2VsZi5fZmV0Y2hSZWZlcmVuY2VzQmF0Y2hlZChsaXN0KV0pO319KS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIGxpc3Q7fSk7fSxfZmV0Y2hYMk1hbnlCYXRjaGVkOmZ1bmN0aW9uKGxpc3QsZmllbGROYW1lKXtsaXN0PXRoaXMuX2FwcGx5WDJNYW55T3BlcmF0aW9ucyhsaXN0KTt0aGlzLl9zb3J0TGlzdChsaXN0KTt2YXIgdG9GZXRjaD10aGlzLl9nZXREYXRhVG9GZXRjaChsaXN0LGZpZWxkTmFtZSk7cmV0dXJuIHRoaXMuX2ZldGNoUmVsYXRlZERhdGEobGlzdCx0b0ZldGNoLGZpZWxkTmFtZSk7fSxfZmV0Y2hYMk1hbnlzOmZ1bmN0aW9uKHJlY29yZCxvcHRpb25zKXt2YXIgc2VsZj10aGlzO3ZhciBkZWZzPVtdO29wdGlvbnM9b3B0aW9uc3x8e307dmFyIGZpZWxkTmFtZXM9b3B0aW9ucy5maWVsZE5hbWVzfHxyZWNvcmQuZ2V0RmllbGROYW1lcyhvcHRpb25zKTt2YXIgdmlld1R5cGU9b3B0aW9ucy52aWV3VHlwZXx8cmVjb3JkLnZpZXdUeXBlO18uZWFjaChmaWVsZE5hbWVzLGZ1bmN0aW9uKGZpZWxkTmFtZSl7dmFyIGZpZWxkPXJlY29yZC5maWVsZHNbZmllbGROYW1lXTtpZihmaWVsZC50eXBlPT09J29uZTJtYW55J3x8ZmllbGQudHlwZT09PSdtYW55Mm1hbnknKXt2YXIgZmllbGRJbmZvPXJlY29yZC5maWVsZHNJbmZvW3ZpZXdUeXBlXVtmaWVsZE5hbWVdO3ZhciByYXdDb250ZXh0PWZpZWxkSW5mbyYmZmllbGRJbmZvLmNvbnRleHQ7dmFyIHZpZXc9ZmllbGRJbmZvLnZpZXdzJiZmaWVsZEluZm8udmlld3NbZmllbGRJbmZvLm1vZGVdO3ZhciBmaWVsZHNJbmZvPXZpZXc/dmlldy5maWVsZHNJbmZvOihmaWVsZEluZm8uZmllbGRzSW5mb3x8e30pO3ZhciBpZHM9cmVjb3JkLmRhdGFbZmllbGROYW1lXXx8W107dmFyIGxpc3Q9c2VsZi5fbWFrZURhdGFQb2ludCh7Y291bnQ6aWRzLmxlbmd0aCxjb250ZXh0Ol8uZXh0ZW5kKHt9LHJlY29yZC5jb250ZXh0LGZpZWxkLmNvbnRleHQpLGZpZWxkc0luZm86ZmllbGRzSW5mbyxmaWVsZHM6dmlldz92aWV3LmZpZWxkczpmaWVsZEluZm8ucmVsYXRlZEZpZWxkcyxsaW1pdDpmaWVsZEluZm8ubGltaXQsbW9kZWxOYW1lOmZpZWxkLnJlbGF0aW9uLHJlc19pZHM6aWRzLHN0YXRpYzp0cnVlLHR5cGU6J2xpc3QnLG9yZGVyZWRCeTpmaWVsZEluZm8ub3JkZXJlZEJ5LHBhcmVudElEOnJlY29yZC5pZCxyYXdDb250ZXh0OnJhd0NvbnRleHQscmVsYXRpb25GaWVsZDpmaWVsZC5yZWxhdGlvbl9maWVsZCx2aWV3VHlwZTp2aWV3P3ZpZXcudHlwZTpmaWVsZEluZm8udmlld1R5cGUsfSk7cmVjb3JkLmRhdGFbZmllbGROYW1lXT1saXN0LmlkO2lmKCFmaWVsZEluZm8uX19ub19mZXRjaCl7dmFyIGRlZj1zZWxmLl9yZWFkVW5ncm91cGVkTGlzdChsaXN0KS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIFByb21pc2UuYWxsKFtzZWxmLl9mZXRjaFgyTWFueXNCYXRjaGVkKGxpc3QpLHNlbGYuX2ZldGNoUmVmZXJlbmNlc0JhdGNoZWQobGlzdCldKTt9KTtkZWZzLnB1c2goZGVmKTt9fX0pO3JldHVybiBQcm9taXNlLmFsbChkZWZzKTt9LF9mZXRjaFgyTWFueXNCYXRjaGVkOmZ1bmN0aW9uKGxpc3Qpe3ZhciBkZWZzPVtdO3ZhciBmaWVsZE5hbWVzPWxpc3QuZ2V0RmllbGROYW1lcygpO2Zvcih2YXIgaT0wO2k8ZmllbGROYW1lcy5sZW5ndGg7aSsrKXt2YXIgZmllbGQ9bGlzdC5maWVsZHNbZmllbGROYW1lc1tpXV07aWYoZmllbGQudHlwZT09PSdtYW55Mm1hbnknfHxmaWVsZC50eXBlPT09J29uZTJtYW55Jyl7ZGVmcy5wdXNoKHRoaXMuX2ZldGNoWDJNYW55QmF0Y2hlZChsaXN0LGZpZWxkTmFtZXNbaV0pKTt9fQpyZXR1cm4gUHJvbWlzZS5hbGwoZGVmcyk7fSxfZmV0Y2hYMk1hbnlTaW5nbGVCYXRjaDpmdW5jdGlvbihsaXN0LGZpZWxkTmFtZSl7dmFyIHNlbGY9dGhpczt2YXIgdG9GZXRjaD17fTtfLmVhY2gobGlzdC5kYXRhLGZ1bmN0aW9uKGdyb3VwSW5kZXgpe3ZhciBncm91cD1zZWxmLmxvY2FsRGF0YVtncm91cEluZGV4XTt2YXIgbmV4dERhdGFUb0ZldGNoPXNlbGYuX2dldERhdGFUb0ZldGNoKGdyb3VwLGZpZWxkTmFtZSk7Xy5lYWNoKF8ua2V5cyhuZXh0RGF0YVRvRmV0Y2gpLGZ1bmN0aW9uKGlkKXtpZih0b0ZldGNoW2lkXSl7dG9GZXRjaFtpZF09dG9GZXRjaFtpZF0uY29uY2F0KG5leHREYXRhVG9GZXRjaFtpZF0pO31lbHNle3RvRmV0Y2hbaWRdPW5leHREYXRhVG9GZXRjaFtpZF07fX0pO30pO3JldHVybiBzZWxmLl9mZXRjaFJlbGF0ZWREYXRhKGxpc3QsdG9GZXRjaCxmaWVsZE5hbWUpO30sX2ZldGNoWDJNYW55c1NpbmdsZUJhdGNoOmZ1bmN0aW9uKGxpc3Qpe3ZhciBkZWZzPVtdO3ZhciBmaWVsZE5hbWVzPWxpc3QuZ2V0RmllbGROYW1lcygpO2Zvcih2YXIgaT0wO2k8ZmllbGROYW1lcy5sZW5ndGg7aSsrKXt2YXIgZmllbGQ9bGlzdC5maWVsZHNbZmllbGROYW1lc1tpXV07aWYoZmllbGQudHlwZT09PSdtYW55Mm1hbnknfHxmaWVsZC50eXBlPT09J29uZTJtYW55Jyl7ZGVmcy5wdXNoKHRoaXMuX2ZldGNoWDJNYW55U2luZ2xlQmF0Y2gobGlzdCxmaWVsZE5hbWVzW2ldKSk7fX0KcmV0dXJuIFByb21pc2UuYWxsKGRlZnMpO30sX2dlbmVyYXRlQ2hhbmdlczpmdW5jdGlvbihyZWNvcmQsb3B0aW9ucyl7b3B0aW9ucz1vcHRpb25zfHx7fTt2YXIgdmlld1R5cGU9b3B0aW9ucy52aWV3VHlwZXx8cmVjb3JkLnZpZXdUeXBlO3ZhciBjaGFuZ2VzO2lmKCdjaGFuZ2VzT25seSdpbiBvcHRpb25zJiYhb3B0aW9ucy5jaGFuZ2VzT25seSl7Y2hhbmdlcz1fLmV4dGVuZCh7fSxyZWNvcmQuZGF0YSxyZWNvcmQuX2NoYW5nZXMpO31lbHNle2NoYW5nZXM9Xy5leHRlbmQoe30scmVjb3JkLl9jaGFuZ2VzKTt9CnZhciB3aXRoUmVhZG9ubHk9b3B0aW9ucy53aXRoUmVhZG9ubHl8fGZhbHNlO3ZhciBjb21tYW5kcz10aGlzLl9nZW5lcmF0ZVgyTWFueUNvbW1hbmRzKHJlY29yZCx7Y2hhbmdlc09ubHk6J2NoYW5nZXNPbmx5J2luIG9wdGlvbnM/b3B0aW9ucy5jaGFuZ2VzT25seTp0cnVlLHdpdGhSZWFkb25seTp3aXRoUmVhZG9ubHksfSk7Zm9yKHZhciBmaWVsZE5hbWUgaW4gcmVjb3JkLmZpZWxkcyl7aWYoIXdpdGhSZWFkb25seSYmZmllbGROYW1lIGluIGNoYW5nZXN8fGZpZWxkTmFtZSBpbiBjb21tYW5kcyl7dmFyIGVkaXRpb25WaWV3VHlwZT1yZWNvcmQuX2VkaXRpb25WaWV3VHlwZVtmaWVsZE5hbWVdfHx2aWV3VHlwZTtpZih0aGlzLl9pc0ZpZWxkUHJvdGVjdGVkKHJlY29yZCxmaWVsZE5hbWUsZWRpdGlvblZpZXdUeXBlKSl7ZGVsZXRlIGNoYW5nZXNbZmllbGROYW1lXTtjb250aW51ZTt9fQp2YXIgdHlwZT1yZWNvcmQuZmllbGRzW2ZpZWxkTmFtZV0udHlwZTt2YXIgdmFsdWU7aWYodHlwZT09PSdvbmUybWFueSd8fHR5cGU9PT0nbWFueTJtYW55Jyl7aWYoY29tbWFuZHNbZmllbGROYW1lXSYmY29tbWFuZHNbZmllbGROYW1lXS5sZW5ndGgpe2NoYW5nZXNbZmllbGROYW1lXT1jb21tYW5kc1tmaWVsZE5hbWVdO31lbHNle2RlbGV0ZSBjaGFuZ2VzW2ZpZWxkTmFtZV07fX1lbHNlIGlmKHR5cGU9PT0nbWFueTJvbmUnJiZmaWVsZE5hbWUgaW4gY2hhbmdlcyl7dmFsdWU9Y2hhbmdlc1tmaWVsZE5hbWVdO2NoYW5nZXNbZmllbGROYW1lXT12YWx1ZT90aGlzLmxvY2FsRGF0YVt2YWx1ZV0ucmVzX2lkOmZhbHNlO31lbHNlIGlmKHR5cGU9PT0ncmVmZXJlbmNlJyYmZmllbGROYW1lIGluIGNoYW5nZXMpe3ZhbHVlPWNoYW5nZXNbZmllbGROYW1lXTtjaGFuZ2VzW2ZpZWxkTmFtZV09dmFsdWU/dGhpcy5sb2NhbERhdGFbdmFsdWVdLm1vZGVsKycsJyt0aGlzLmxvY2FsRGF0YVt2YWx1ZV0ucmVzX2lkOmZhbHNlO31lbHNlIGlmKHR5cGU9PT0nY2hhcicmJmNoYW5nZXNbZmllbGROYW1lXT09PScnKXtjaGFuZ2VzW2ZpZWxkTmFtZV09ZmFsc2U7fWVsc2UgaWYoY2hhbmdlc1tmaWVsZE5hbWVdPT09bnVsbCl7Y2hhbmdlc1tmaWVsZE5hbWVdPWZhbHNlO319CnJldHVybiBjaGFuZ2VzO30sX2dlbmVyYXRlT25DaGFuZ2VEYXRhOmZ1bmN0aW9uKHJlY29yZCxvcHRpb25zKXtvcHRpb25zPV8uZXh0ZW5kKHt9LG9wdGlvbnN8fHt9LHt3aXRoUmVhZG9ubHk6dHJ1ZX0pO3ZhciBjb21tYW5kcz10aGlzLl9nZW5lcmF0ZVgyTWFueUNvbW1hbmRzKHJlY29yZCxvcHRpb25zKTt2YXIgZGF0YT1fLmV4dGVuZCh0aGlzLmdldChyZWNvcmQuaWQse3Jhdzp0cnVlfSkuZGF0YSxjb21tYW5kcyk7dmFyIGhhc0Rpc3BsYXlOYW1lPV8uc29tZShyZWNvcmQuZmllbGRzSW5mbyxmdW5jdGlvbihmaWVsZHNJbmZvKXtyZXR1cm4nZGlzcGxheV9uYW1lJ2luIGZpZWxkc0luZm87fSk7aWYoIWhhc0Rpc3BsYXlOYW1lKXtkZWxldGUgZGF0YS5kaXNwbGF5X25hbWU7fQppZihyZWNvcmQucGFyZW50SUQpe3ZhciBwYXJlbnQ9dGhpcy5sb2NhbERhdGFbcmVjb3JkLnBhcmVudElEXTtpZihwYXJlbnQucGFyZW50SUQmJnBhcmVudC5yZWxhdGlvbkZpZWxkKXt2YXIgcGFyZW50UmVjb3JkPXRoaXMubG9jYWxEYXRhW3BhcmVudC5wYXJlbnRJRF07ZGF0YVtwYXJlbnQucmVsYXRpb25GaWVsZF09dGhpcy5fZ2VuZXJhdGVPbkNoYW5nZURhdGEocGFyZW50UmVjb3JkKTt9fQpyZXR1cm4gZGF0YTt9LF9nZW5lcmF0ZVgyTWFueUNvbW1hbmRzOmZ1bmN0aW9uKHJlY29yZCxvcHRpb25zKXt2YXIgc2VsZj10aGlzO29wdGlvbnM9b3B0aW9uc3x8e307dmFyIGZpZWxkcz1yZWNvcmQuZmllbGRzO2lmKG9wdGlvbnMuZmllbGROYW1lcyl7ZmllbGRzPV8ucGljayhmaWVsZHMsb3B0aW9ucy5maWVsZE5hbWVzKTt9CnZhciBjb21tYW5kcz17fTt2YXIgZGF0YT1fLmV4dGVuZCh7fSxyZWNvcmQuZGF0YSxyZWNvcmQuX2NoYW5nZXMpO3ZhciB0eXBlO2Zvcih2YXIgZmllbGROYW1lIGluIGZpZWxkcyl7dHlwZT1maWVsZHNbZmllbGROYW1lXS50eXBlO2lmKHR5cGU9PT0nbWFueTJtYW55J3x8dHlwZT09PSdvbmUybWFueScpe2lmKCFkYXRhW2ZpZWxkTmFtZV0pe2NvbnRpbnVlO30KY29tbWFuZHNbZmllbGROYW1lXT1bXTt2YXIgbGlzdD10aGlzLmxvY2FsRGF0YVtkYXRhW2ZpZWxkTmFtZV1dO2lmKG9wdGlvbnMuY2hhbmdlc09ubHkmJighbGlzdC5fY2hhbmdlc3x8IWxpc3QuX2NoYW5nZXMubGVuZ3RoKSl7Y29udGludWU7fQp2YXIgb2xkUmVzSURzPWxpc3QucmVzX2lkcy5zbGljZSgwKTt2YXIgcmVsUmVjb3JkQWRkZWQ9W107dmFyIHJlbFJlY29yZFVwZGF0ZWQ9W107Xy5lYWNoKGxpc3QuX2NoYW5nZXMsZnVuY3Rpb24oY2hhbmdlKXtpZihjaGFuZ2Uub3BlcmF0aW9uPT09J0FERCcmJmNoYW5nZS5pZCl7cmVsUmVjb3JkQWRkZWQucHVzaChzZWxmLmxvY2FsRGF0YVtjaGFuZ2UuaWRdKTt9ZWxzZSBpZihjaGFuZ2Uub3BlcmF0aW9uPT09J1VQREFURScmJiFzZWxmLmlzTmV3KGNoYW5nZS5pZCkpe3JlbFJlY29yZFVwZGF0ZWQucHVzaChzZWxmLmxvY2FsRGF0YVtjaGFuZ2UuaWRdKTt9fSk7bGlzdD10aGlzLl9hcHBseVgyTWFueU9wZXJhdGlvbnMobGlzdCk7dGhpcy5fc29ydExpc3QobGlzdCk7aWYodHlwZT09PSdtYW55Mm1hbnknfHxsaXN0Ll9mb3JjZU0yTUxpbmspe3ZhciByZWxSZWNvcmRDcmVhdGVkPV8uZmlsdGVyKHJlbFJlY29yZEFkZGVkLGZ1bmN0aW9uKHJlYyl7cmV0dXJuIHR5cGVvZiByZWMucmVzX2lkPT09J3N0cmluZyc7fSk7dmFyIHJlYWxJRHM9Xy5kaWZmZXJlbmNlKGxpc3QucmVzX2lkcyxfLnBsdWNrKHJlbFJlY29yZENyZWF0ZWQsJ3Jlc19pZCcpKTtjb21tYW5kc1tmaWVsZE5hbWVdLnB1c2goeDJNYW55Q29tbWFuZHMucmVwbGFjZV93aXRoKHJlYWxJRHMpKTtfLmVhY2gocmVsUmVjb3JkQ3JlYXRlZCxmdW5jdGlvbihyZWxSZWNvcmQpe3ZhciBjaGFuZ2VzPXNlbGYuX2dlbmVyYXRlQ2hhbmdlcyhyZWxSZWNvcmQsb3B0aW9ucyk7Y29tbWFuZHNbZmllbGROYW1lXS5wdXNoKHgyTWFueUNvbW1hbmRzLmNyZWF0ZShyZWxSZWNvcmQucmVmLGNoYW5nZXMpKTt9KTtfLmVhY2gocmVsUmVjb3JkVXBkYXRlZCxmdW5jdGlvbihyZWxSZWNvcmQpe3ZhciBjaGFuZ2VzPXNlbGYuX2dlbmVyYXRlQ2hhbmdlcyhyZWxSZWNvcmQsb3B0aW9ucyk7aWYoIV8uaXNFbXB0eShjaGFuZ2VzKSl7dmFyIGNvbW1hbmQ9eDJNYW55Q29tbWFuZHMudXBkYXRlKHJlbFJlY29yZC5yZXNfaWQsY2hhbmdlcyk7Y29tbWFuZHNbZmllbGROYW1lXS5wdXNoKGNvbW1hbmQpO319KTt9ZWxzZSBpZih0eXBlPT09J29uZTJtYW55Jyl7dmFyIHJlbW92ZWRJZHM9Xy5kaWZmZXJlbmNlKG9sZFJlc0lEcyxsaXN0LnJlc19pZHMpO3ZhciBhZGRlZElkcz1fLmRpZmZlcmVuY2UobGlzdC5yZXNfaWRzLG9sZFJlc0lEcyk7dmFyIGtlcHRJZHM9Xy5pbnRlcnNlY3Rpb24ob2xkUmVzSURzLGxpc3QucmVzX2lkcyk7dmFyIGRpZENoYW5nZT1mYWxzZTt2YXIgY2hhbmdlcyxjb21tYW5kLHJlbFJlY29yZDtmb3IodmFyIGk9MDtpPGxpc3QucmVzX2lkcy5sZW5ndGg7aSsrKXtpZihfLmNvbnRhaW5zKGtlcHRJZHMsbGlzdC5yZXNfaWRzW2ldKSl7cmVsUmVjb3JkPV8uZmluZFdoZXJlKHJlbFJlY29yZFVwZGF0ZWQse3Jlc19pZDpsaXN0LnJlc19pZHNbaV19KTtjaGFuZ2VzPXJlbFJlY29yZD90aGlzLl9nZW5lcmF0ZUNoYW5nZXMocmVsUmVjb3JkLG9wdGlvbnMpOnt9O2lmKCFfLmlzRW1wdHkoY2hhbmdlcykpe2NvbW1hbmQ9eDJNYW55Q29tbWFuZHMudXBkYXRlKHJlbFJlY29yZC5yZXNfaWQsY2hhbmdlcyk7ZGlkQ2hhbmdlPXRydWU7fWVsc2V7Y29tbWFuZD14Mk1hbnlDb21tYW5kcy5saW5rX3RvKGxpc3QucmVzX2lkc1tpXSk7fQpjb21tYW5kc1tmaWVsZE5hbWVdLnB1c2goY29tbWFuZCk7fWVsc2UgaWYoXy5jb250YWlucyhhZGRlZElkcyxsaXN0LnJlc19pZHNbaV0pKXtyZWxSZWNvcmQ9Xy5maW5kV2hlcmUocmVsUmVjb3JkQWRkZWQse3Jlc19pZDpsaXN0LnJlc19pZHNbaV19KTtpZighcmVsUmVjb3JkKXtjb21tYW5kc1tmaWVsZE5hbWVdLnB1c2goeDJNYW55Q29tbWFuZHMubGlua190byhsaXN0LnJlc19pZHNbaV0pKTtjb250aW51ZTt9CmNoYW5nZXM9dGhpcy5fZ2VuZXJhdGVDaGFuZ2VzKHJlbFJlY29yZCxfLmV4dGVuZCh7fSxvcHRpb25zLHtjaGFuZ2VzT25seTp0cnVlfSkpO2lmKCF0aGlzLmlzTmV3KHJlbFJlY29yZC5pZCkpe2NvbW1hbmRzW2ZpZWxkTmFtZV0ucHVzaCh4Mk1hbnlDb21tYW5kcy5saW5rX3RvKHJlbFJlY29yZC5yZXNfaWQpKTtkZWxldGUgY2hhbmdlcy5pZDtpZighXy5pc0VtcHR5KGNoYW5nZXMpKXtjb21tYW5kc1tmaWVsZE5hbWVdLnB1c2goeDJNYW55Q29tbWFuZHMudXBkYXRlKHJlbFJlY29yZC5yZXNfaWQsY2hhbmdlcykpO319ZWxzZXtjb21tYW5kc1tmaWVsZE5hbWVdLnB1c2goeDJNYW55Q29tbWFuZHMuY3JlYXRlKHJlbFJlY29yZC5yZWYsY2hhbmdlcykpO319fQppZihvcHRpb25zLmNoYW5nZXNPbmx5JiYhZGlkQ2hhbmdlJiZhZGRlZElkcy5sZW5ndGg9PT0wJiZyZW1vdmVkSWRzLmxlbmd0aD09PTApe2NvbW1hbmRzW2ZpZWxkTmFtZV09W107fQpmb3IoaT0wO2k8cmVtb3ZlZElkcy5sZW5ndGg7aSsrKXtpZihsaXN0Ll9mb3JjZU0yTVVubGluayl7Y29tbWFuZHNbZmllbGROYW1lXS5wdXNoKHgyTWFueUNvbW1hbmRzLmZvcmdldChyZW1vdmVkSWRzW2ldKSk7fWVsc2V7Y29tbWFuZHNbZmllbGROYW1lXS5wdXNoKHgyTWFueUNvbW1hbmRzLmRlbGV0ZShyZW1vdmVkSWRzW2ldKSk7fX19fX0KcmV0dXJuIGNvbW1hbmRzO30sX2dldENvbnRleHQ6ZnVuY3Rpb24oZWxlbWVudCxvcHRpb25zKXtvcHRpb25zPW9wdGlvbnN8fHt9O3ZhciBjb250ZXh0PW5ldyBDb250ZXh0KHNlc3Npb24udXNlcl9jb250ZXh0KTtjb250ZXh0LnNldF9ldmFsX2NvbnRleHQodGhpcy5fZ2V0RXZhbENvbnRleHQoZWxlbWVudCkpO2lmKG9wdGlvbnMuZnVsbHx8IShvcHRpb25zLmZpZWxkTmFtZXx8b3B0aW9ucy5hZGRpdGlvbmFsQ29udGV4dCkpe2NvbnRleHQuYWRkKGVsZW1lbnQuY29udGV4dCk7fQppZihvcHRpb25zLmZpZWxkTmFtZSl7dmFyIHZpZXdUeXBlPW9wdGlvbnMudmlld1R5cGV8fGVsZW1lbnQudmlld1R5cGU7dmFyIGZpZWxkSW5mbz1lbGVtZW50LmZpZWxkc0luZm9bdmlld1R5cGVdW29wdGlvbnMuZmllbGROYW1lXTtpZihmaWVsZEluZm8mJmZpZWxkSW5mby5jb250ZXh0KXtjb250ZXh0LmFkZChmaWVsZEluZm8uY29udGV4dCk7fWVsc2V7dmFyIGZpZWxkUGFyYW1zPWVsZW1lbnQuZmllbGRzW29wdGlvbnMuZmllbGROYW1lXTtpZihmaWVsZFBhcmFtcy5jb250ZXh0KXtjb250ZXh0LmFkZChmaWVsZFBhcmFtcy5jb250ZXh0KTt9fX0KaWYob3B0aW9ucy5hZGRpdGlvbmFsQ29udGV4dCl7Y29udGV4dC5hZGQob3B0aW9ucy5hZGRpdGlvbmFsQ29udGV4dCk7fQppZihlbGVtZW50LnJhd0NvbnRleHQpe3ZhciByYXdDb250ZXh0PW5ldyBDb250ZXh0KGVsZW1lbnQucmF3Q29udGV4dCk7dmFyIGV2YWxDb250ZXh0PXRoaXMuX2dldEV2YWxDb250ZXh0KHRoaXMubG9jYWxEYXRhW2VsZW1lbnQucGFyZW50SURdKTtldmFsQ29udGV4dC5pZD1ldmFsQ29udGV4dC5pZHx8ZmFsc2U7cmF3Q29udGV4dC5zZXRfZXZhbF9jb250ZXh0KGV2YWxDb250ZXh0KTtjb250ZXh0LmFkZChyYXdDb250ZXh0KTt9CnJldHVybiBjb250ZXh0LmV2YWwoKTt9LF9nZXREYXRhVG9GZXRjaDpmdW5jdGlvbihsaXN0LGZpZWxkTmFtZSl7dmFyIHNlbGY9dGhpczt2YXIgZmllbGQ9bGlzdC5maWVsZHNbZmllbGROYW1lXTt2YXIgZmllbGRJbmZvPWxpc3QuZmllbGRzSW5mb1tsaXN0LnZpZXdUeXBlXVtmaWVsZE5hbWVdO3ZhciB2aWV3PWZpZWxkSW5mby52aWV3cyYmZmllbGRJbmZvLnZpZXdzW2ZpZWxkSW5mby5tb2RlXTt2YXIgZmllbGRzSW5mbz12aWV3P3ZpZXcuZmllbGRzSW5mbzpmaWVsZEluZm8uZmllbGRzSW5mbzt2YXIgZmllbGRzPXZpZXc/dmlldy5maWVsZHM6ZmllbGRJbmZvLnJlbGF0ZWRGaWVsZHM7dmFyIHZpZXdUeXBlPXZpZXc/dmlldy50eXBlOmZpZWxkSW5mby52aWV3VHlwZTt2YXIgdG9GZXRjaD17fTtsZXQgZGF0YVBvaW50SWRzPWxpc3QuZGF0YTtmb3IobGV0IGk9MDtpPGxpc3QuZ3JvdXBlZEJ5Lmxlbmd0aDtpKyspe2RhdGFQb2ludElkcz1kYXRhUG9pbnRJZHMucmVkdWNlKChhY2MsZ3JvdXBJZCk9PmFjYy5jb25jYXQodGhpcy5sb2NhbERhdGFbZ3JvdXBJZF0uZGF0YSksW10pO30KZGF0YVBvaW50SWRzLmZvckVhY2goZnVuY3Rpb24oZGF0YVBvaW50KXt2YXIgcmVjb3JkPXNlbGYubG9jYWxEYXRhW2RhdGFQb2ludF07aWYodHlwZW9mIHJlY29yZC5kYXRhW2ZpZWxkTmFtZV09PT0nc3RyaW5nJyl7cmV0dXJuO30KXy5lYWNoKHJlY29yZC5kYXRhW2ZpZWxkTmFtZV0sZnVuY3Rpb24oaWQpe3RvRmV0Y2hbaWRdPXRvRmV0Y2hbaWRdfHxbXTt0b0ZldGNoW2lkXS5wdXNoKHJlY29yZCk7fSk7dmFyIG0ybUxpc3Q9c2VsZi5fbWFrZURhdGFQb2ludCh7ZmllbGRzSW5mbzpmaWVsZHNJbmZvLGZpZWxkczpmaWVsZHMsbW9kZWxOYW1lOmZpZWxkLnJlbGF0aW9uLHBhcmVudElEOnJlY29yZC5pZCxyZXNfaWRzOnJlY29yZC5kYXRhW2ZpZWxkTmFtZV0sc3RhdGljOnRydWUsdHlwZTonbGlzdCcsdmlld1R5cGU6dmlld1R5cGUsfSk7cmVjb3JkLmRhdGFbZmllbGROYW1lXT1tMm1MaXN0LmlkO30pO3JldHVybiB0b0ZldGNoO30sX2dldERhdGFUb0ZldGNoQnlNb2RlbDpmdW5jdGlvbihsaXN0LGZpZWxkTmFtZSl7dmFyIHNlbGY9dGhpczt2YXIgdG9GZXRjaD17fTtfLmVhY2gobGlzdC5kYXRhLGZ1bmN0aW9uKGRhdGFQb2ludCl7dmFyIHJlY29yZD1zZWxmLmxvY2FsRGF0YVtkYXRhUG9pbnRdO3ZhciB2YWx1ZT1yZWNvcmQuZGF0YVtmaWVsZE5hbWVdO2lmKHZhbHVlJiYhc2VsZi5sb2NhbERhdGFbdmFsdWVdKXt2YXIgbW9kZWw9dmFsdWUuc3BsaXQoJywnKVswXTt2YXIgcmVzSUQ9dmFsdWUuc3BsaXQoJywnKVsxXTtpZighKG1vZGVsIGluIHRvRmV0Y2gpKXt0b0ZldGNoW21vZGVsXT17fTt9CmlmKHRvRmV0Y2hbbW9kZWxdW3Jlc0lEXSl7dG9GZXRjaFttb2RlbF1bcmVzSURdLnB1c2goZGF0YVBvaW50KTt9ZWxzZXt0b0ZldGNoW21vZGVsXVtyZXNJRF09W2RhdGFQb2ludF07fX19KTtyZXR1cm4gdG9GZXRjaDt9LF9nZXREZWZhdWx0Q29udGV4dDpmdW5jdGlvbihkYXRhUG9pbnQpe3ZhciBkZWZhdWx0Q29udGV4dD17fTt3aGlsZShkYXRhUG9pbnQucGFyZW50SUQpe3ZhciBwYXJlbnQ9dGhpcy5sb2NhbERhdGFbZGF0YVBvaW50LnBhcmVudElEXTt2YXIgZ3JvdXBCeUZpZWxkPXBhcmVudC5ncm91cGVkQnlbMF0uc3BsaXQoJzonKVswXTt2YXIgdmFsdWU9dmlld1V0aWxzLmdldEdyb3VwVmFsdWUoZGF0YVBvaW50LGdyb3VwQnlGaWVsZCk7aWYodmFsdWUpe2RlZmF1bHRDb250ZXh0WydkZWZhdWx0XycrZ3JvdXBCeUZpZWxkXT12YWx1ZTt9CmRhdGFQb2ludD1wYXJlbnQ7fQpyZXR1cm4gZGVmYXVsdENvbnRleHQ7fSxfZ2V0RG9tYWluOmZ1bmN0aW9uKGVsZW1lbnQsb3B0aW9ucyl7aWYob3B0aW9ucyYmb3B0aW9ucy5maWVsZE5hbWUpe2lmKGVsZW1lbnQuX2RvbWFpbnNbb3B0aW9ucy5maWVsZE5hbWVdKXtyZXR1cm4gRG9tYWluLnByb3RvdHlwZS5zdHJpbmdUb0FycmF5KGVsZW1lbnQuX2RvbWFpbnNbb3B0aW9ucy5maWVsZE5hbWVdLHRoaXMuX2dldEV2YWxDb250ZXh0KGVsZW1lbnQsdHJ1ZSkpO30KdmFyIHZpZXdUeXBlPW9wdGlvbnMudmlld1R5cGV8fGVsZW1lbnQudmlld1R5cGU7dmFyIGZpZWxkSW5mbz1lbGVtZW50LmZpZWxkc0luZm9bdmlld1R5cGVdW29wdGlvbnMuZmllbGROYW1lXTtpZihmaWVsZEluZm8mJmZpZWxkSW5mby5kb21haW4pe3JldHVybiBEb21haW4ucHJvdG90eXBlLnN0cmluZ1RvQXJyYXkoZmllbGRJbmZvLmRvbWFpbix0aGlzLl9nZXRFdmFsQ29udGV4dChlbGVtZW50LHRydWUpKTt9CnZhciBmaWVsZFBhcmFtcz1lbGVtZW50LmZpZWxkc1tvcHRpb25zLmZpZWxkTmFtZV07aWYoZmllbGRQYXJhbXMuZG9tYWluKXtyZXR1cm4gRG9tYWluLnByb3RvdHlwZS5zdHJpbmdUb0FycmF5KGZpZWxkUGFyYW1zLmRvbWFpbix0aGlzLl9nZXRFdmFsQ29udGV4dChlbGVtZW50LHRydWUpKTt9CnJldHVybltdO30KcmV0dXJuIERvbWFpbi5wcm90b3R5cGUuc3RyaW5nVG9BcnJheShlbGVtZW50LmRvbWFpbix0aGlzLl9nZXRFdmFsQ29udGV4dChlbGVtZW50LHRydWUpKTt9LF9nZXRFdmFsQ29udGV4dDpmdW5jdGlvbihlbGVtZW50LGZvckRvbWFpbil7dmFyIGV2YWxDb250ZXh0PWVsZW1lbnQudHlwZT09PSdyZWNvcmQnP3RoaXMuX2dldFJlY29yZEV2YWxDb250ZXh0KGVsZW1lbnQsZm9yRG9tYWluKTp7fTtpZihlbGVtZW50LnBhcmVudElEKXt2YXIgcGFyZW50PXRoaXMubG9jYWxEYXRhW2VsZW1lbnQucGFyZW50SURdO2lmKHBhcmVudC50eXBlPT09J2xpc3QnJiZwYXJlbnQucGFyZW50SUQpe3BhcmVudD10aGlzLmxvY2FsRGF0YVtwYXJlbnQucGFyZW50SURdO30KaWYocGFyZW50LnR5cGU9PT0ncmVjb3JkJyl7ZXZhbENvbnRleHQucGFyZW50PXRoaXMuX2dldFJlY29yZEV2YWxDb250ZXh0KHBhcmVudCxmb3JEb21haW4pO319CmlmKHNlc3Npb24udXNlcl9jb250ZXh0LmFsbG93ZWRfY29tcGFueV9pZHMpe3ZhciBjdXJyZW50X2NvbXBhbnk9c2Vzc2lvbi51c2VyX2NvbnRleHQuYWxsb3dlZF9jb21wYW55X2lkc1swXTt9ZWxzZXt2YXIgY3VycmVudF9jb21wYW55PXNlc3Npb24udXNlcl9jb21wYW5pZXM/c2Vzc2lvbi51c2VyX2NvbXBhbmllcy5jdXJyZW50X2NvbXBhbnlbMF06ZmFsc2U7fQpyZXR1cm4gXy5leHRlbmQoe2FjdGl2ZV9pZDpldmFsQ29udGV4dC5pZHx8ZmFsc2UsYWN0aXZlX2lkczpldmFsQ29udGV4dC5pZD9bZXZhbENvbnRleHQuaWRdOltdLGFjdGl2ZV9tb2RlbDplbGVtZW50Lm1vZGVsLGN1cnJlbnRfZGF0ZTptb21lbnQoKS5mb3JtYXQoJ1lZWVktTU0tREQnKSxpZDpldmFsQ29udGV4dC5pZHx8ZmFsc2UsY3VycmVudF9jb21wYW55X2lkOmN1cnJlbnRfY29tcGFueSx9LHNlc3Npb24udXNlcl9jb250ZXh0LGVsZW1lbnQuY29udGV4dCxldmFsQ29udGV4dCk7fSxfZ2V0RmllbGROYW1lczpmdW5jdGlvbihlbGVtZW50LG9wdGlvbnMpe3ZhciBmaWVsZHNJbmZvPWVsZW1lbnQuZmllbGRzSW5mbzt2YXIgdmlld1R5cGU9b3B0aW9ucyYmb3B0aW9ucy52aWV3VHlwZXx8ZWxlbWVudC52aWV3VHlwZTtyZXR1cm4gT2JqZWN0LmtleXMoZmllbGRzSW5mbyYmZmllbGRzSW5mb1t2aWV3VHlwZV18fHt9KTt9LF9nZXRNYW55Mk9uZUZpZWxkTmFtZXM6ZnVuY3Rpb24oZGF0YXBvaW50KXt2YXIgbWFueTJvbmVzPVtdO18uZWFjaChkYXRhcG9pbnQuZmllbGRzLGZ1bmN0aW9uKGZpZWxkLG5hbWUpe2lmKGZpZWxkLnR5cGU9PT0nbWFueTJvbmUnKXttYW55Mm9uZXMucHVzaChuYW1lKTt9fSk7cmV0dXJuIG1hbnkyb25lczt9LF9nZXRSZWNvcmRFdmFsQ29udGV4dDpmdW5jdGlvbihyZWNvcmQsZm9yRG9tYWluKXt2YXIgc2VsZj10aGlzO3ZhciByZWxEYXRhUG9pbnQ7dmFyIGNvbnRleHQ9Xy5leHRlbmQoe30scmVjb3JkLmRhdGEscmVjb3JkLl9jaGFuZ2VzKTtmdW5jdGlvbiBfZ2VuZXJhdGVYMk1hbnlDb21tYW5kcyhmaWVsZE5hbWUpe3ZhciBjb21tYW5kcz1zZWxmLl9nZW5lcmF0ZVgyTWFueUNvbW1hbmRzKHJlY29yZCx7ZmllbGROYW1lczpbZmllbGROYW1lXX0pO3JldHVybiBjb21tYW5kc1tmaWVsZE5hbWVdO30KZm9yKHZhciBmaWVsZE5hbWUgaW4gY29udGV4dCl7dmFyIGZpZWxkPXJlY29yZC5maWVsZHNbZmllbGROYW1lXTtpZihjb250ZXh0W2ZpZWxkTmFtZV09PT1udWxsKXtjb250ZXh0W2ZpZWxkTmFtZV09ZmFsc2U7fQppZighZmllbGR8fGZpZWxkLm5hbWU9PT0naWQnKXtjb250aW51ZTt9CmlmKGZpZWxkLnR5cGU9PT0nZGF0ZSd8fGZpZWxkLnR5cGU9PT0nZGF0ZXRpbWUnKXtpZihjb250ZXh0W2ZpZWxkTmFtZV0pe2NvbnRleHRbZmllbGROYW1lXT1KU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGNvbnRleHRbZmllbGROYW1lXSkpO30KY29udGludWU7fQppZihmaWVsZC50eXBlPT09J21hbnkyb25lJyl7cmVsRGF0YVBvaW50PXRoaXMubG9jYWxEYXRhW2NvbnRleHRbZmllbGROYW1lXV07Y29udGV4dFtmaWVsZE5hbWVdPXJlbERhdGFQb2ludD9yZWxEYXRhUG9pbnQucmVzX2lkOmZhbHNlO2NvbnRpbnVlO30KaWYoZmllbGQudHlwZT09PSdvbmUybWFueSd8fGZpZWxkLnR5cGU9PT0nbWFueTJtYW55Jyl7dmFyIGlkcztpZighY29udGV4dFtmaWVsZE5hbWVdfHxfLmlzQXJyYXkoY29udGV4dFtmaWVsZE5hbWVdKSl7aWRzPWNvbnRleHRbZmllbGROYW1lXT9jb250ZXh0W2ZpZWxkTmFtZV0uc2xpY2UoMCk6W107fWVsc2V7cmVsRGF0YVBvaW50PXRoaXMuX2FwcGx5WDJNYW55T3BlcmF0aW9ucyh0aGlzLmxvY2FsRGF0YVtjb250ZXh0W2ZpZWxkTmFtZV1dKTtpZHM9cmVsRGF0YVBvaW50LnJlc19pZHMuc2xpY2UoMCk7fQppZighZm9yRG9tYWluKXtpZHMudG9KU09OPV9nZW5lcmF0ZVgyTWFueUNvbW1hbmRzLmJpbmQobnVsbCxmaWVsZE5hbWUpO31lbHNlIGlmKGZpZWxkLnR5cGU9PT0nb25lMm1hbnknKXtpZHM9Xy5maWx0ZXIoaWRzLGZ1bmN0aW9uKGlkKXtyZXR1cm4gdHlwZW9mIGlkIT09J3N0cmluZyc7fSk7fQpjb250ZXh0W2ZpZWxkTmFtZV09aWRzO319CnJldHVybiBjb250ZXh0O30sX2ludmFsaWRhdGVDYWNoZTpmdW5jdGlvbihkYXRhUG9pbnQpe3doaWxlKGRhdGFQb2ludC5wYXJlbnRJRCl7ZGF0YVBvaW50PXRoaXMubG9jYWxEYXRhW2RhdGFQb2ludC5wYXJlbnRJRF07fQppZihkYXRhUG9pbnQubW9kZWw9PT0ncmVzLmN1cnJlbmN5Jyl7c2Vzc2lvbi5yZWxvYWRDdXJyZW5jaWVzKCk7fQppZihfLmNvbnRhaW5zKHRoaXMubm9DYWNoZU1vZGVscyxkYXRhUG9pbnQubW9kZWwpKXtjb3JlLmJ1cy50cmlnZ2VyKCdjbGVhcl9jYWNoZScpO319LF9pc0ZpZWxkUHJvdGVjdGVkOmZ1bmN0aW9uKHJlY29yZCxmaWVsZE5hbWUsdmlld1R5cGUpe3ZhciBmaWVsZEluZm89cmVjb3JkLmZpZWxkc0luZm8mJihyZWNvcmQuZmllbGRzSW5mb1t2aWV3VHlwZXx8cmVjb3JkLnZpZXdUeXBlXVtmaWVsZE5hbWVdKTtpZihmaWVsZEluZm8pe3ZhciByYXdNb2RpZmllcnM9ZmllbGRJbmZvLm1vZGlmaWVyc3x8e307dmFyIG1vZGlmaWVycz10aGlzLl9ldmFsTW9kaWZpZXJzKHJlY29yZCxfLnBpY2socmF3TW9kaWZpZXJzLCdyZWFkb25seScpKTtyZXR1cm4gbW9kaWZpZXJzLnJlYWRvbmx5JiYhZmllbGRJbmZvLmZvcmNlX3NhdmU7fWVsc2V7cmV0dXJuIGZhbHNlO319LF9pc0ZpZWxkU2V0OmZ1bmN0aW9uKHZhbHVlLGZpZWxkVHlwZSl7c3dpdGNoKGZpZWxkVHlwZSl7Y2FzZSdib29sZWFuJzpyZXR1cm4gdHJ1ZTtjYXNlJ29uZTJtYW55JzpjYXNlJ21hbnkybWFueSc6cmV0dXJuIHZhbHVlLmxlbmd0aD4wO2RlZmF1bHQ6cmV0dXJuIHZhbHVlIT09ZmFsc2U7fX0sX2lzWDJNYW55VmFsaWQ6ZnVuY3Rpb24oaWQpe3ZhciBzZWxmPXRoaXM7dmFyIGlzVmFsaWQ9dHJ1ZTt2YXIgZWxlbWVudD10aGlzLmxvY2FsRGF0YVtpZF07Xy5lYWNoKGVsZW1lbnQuX2NoYW5nZXMsZnVuY3Rpb24oY29tbWFuZCl7aWYoY29tbWFuZC5vcGVyYXRpb249PT0nREVMRVRFJ3x8Y29tbWFuZC5vcGVyYXRpb249PT0nRk9SR0VUJ3x8KGNvbW1hbmQub3BlcmF0aW9uPT09J0FERCcmJiFjb21tYW5kLmlzTmV3KXx8Y29tbWFuZC5vcGVyYXRpb249PT0nUkVNT1ZFX0FMTCcpe3JldHVybjt9CnZhciByZWNvcmREYXRhPXNlbGYuZ2V0KGNvbW1hbmQuaWQse3Jhdzp0cnVlfSkuZGF0YTt2YXIgcmVjb3JkPXNlbGYubG9jYWxEYXRhW2NvbW1hbmQuaWRdO18uZWFjaChlbGVtZW50LmdldEZpZWxkTmFtZXMoKSxmdW5jdGlvbihmaWVsZE5hbWUpe3ZhciBmaWVsZD1lbGVtZW50LmZpZWxkc1tmaWVsZE5hbWVdO3ZhciBmaWVsZEluZm89ZWxlbWVudC5maWVsZHNJbmZvW2VsZW1lbnQudmlld1R5cGVdW2ZpZWxkTmFtZV07dmFyIHJhd01vZGlmaWVycz1maWVsZEluZm8ubW9kaWZpZXJzfHx7fTt2YXIgbW9kaWZpZXJzPXNlbGYuX2V2YWxNb2RpZmllcnMocmVjb3JkLF8ucGljayhyYXdNb2RpZmllcnMsJ3JlcXVpcmVkJykpO2lmKG1vZGlmaWVycy5yZXF1aXJlZCYmIXNlbGYuX2lzRmllbGRTZXQocmVjb3JkRGF0YVtmaWVsZE5hbWVdLGZpZWxkLnR5cGUpKXtpc1ZhbGlkPWZhbHNlO319KTt9KTtyZXR1cm4gaXNWYWxpZDt9LF9sb2FkOmZ1bmN0aW9uKGRhdGFQb2ludCxvcHRpb25zKXtpZihvcHRpb25zJiZvcHRpb25zLm9ubHlHcm91cHMmJiEoZGF0YVBvaW50LnR5cGU9PT0nbGlzdCcmJmRhdGFQb2ludC5ncm91cGVkQnkubGVuZ3RoKSl7cmV0dXJuIFByb21pc2UucmVzb2x2ZShkYXRhUG9pbnQpO30KaWYoZGF0YVBvaW50LnR5cGU9PT0ncmVjb3JkJyl7cmV0dXJuIHRoaXMuX2ZldGNoUmVjb3JkKGRhdGFQb2ludCxvcHRpb25zKTt9CmlmKGRhdGFQb2ludC50eXBlPT09J2xpc3QnJiZkYXRhUG9pbnQuZ3JvdXBlZEJ5Lmxlbmd0aCl7cmV0dXJuIHRoaXMuX3JlYWRHcm91cChkYXRhUG9pbnQsb3B0aW9ucyk7fQppZihkYXRhUG9pbnQudHlwZT09PSdsaXN0JyYmIWRhdGFQb2ludC5ncm91cGVkQnkubGVuZ3RoKXtyZXR1cm4gdGhpcy5fZmV0Y2hVbmdyb3VwZWRMaXN0KGRhdGFQb2ludCxvcHRpb25zKTt9fSxfbWFrZURhdGFQb2ludDpmdW5jdGlvbihwYXJhbXMpe3ZhciB0eXBlPXBhcmFtcy50eXBlfHwoJ2RvbWFpbidpbiBwYXJhbXMmJidsaXN0Jyl8fCdyZWNvcmQnO3ZhciByZXNfaWQsdmFsdWU7dmFyIHJlc19pZHM9cGFyYW1zLnJlc19pZHN8fFtdO3ZhciBkYXRhPXBhcmFtcy5kYXRhfHwodHlwZT09PSdyZWNvcmQnP3t9OltdKTt2YXIgY29udGV4dD1wYXJhbXMuY29udGV4dDtpZih0eXBlPT09J3JlY29yZCcpe3Jlc19pZD1wYXJhbXMucmVzX2lkfHwocGFyYW1zLmRhdGEmJnBhcmFtcy5kYXRhLmlkKTtpZihyZXNfaWQpe2RhdGEuaWQ9cmVzX2lkO31lbHNle3Jlc19pZD1fLnVuaXF1ZUlkKCd2aXJ0dWFsXycpO30KY29udGV4dD1fLm9taXQoY29udGV4dCxbJ29yZGVyZWRCeScsJ2dyb3VwX2J5J10pO31lbHNle3ZhciBpc1ZhbHVlQXJyYXk9cGFyYW1zLnZhbHVlIGluc3RhbmNlb2YgQXJyYXk7cmVzX2lkPWlzVmFsdWVBcnJheT9wYXJhbXMudmFsdWVbMF06dW5kZWZpbmVkO3ZhbHVlPWlzVmFsdWVBcnJheT9wYXJhbXMudmFsdWVbMV06cGFyYW1zLnZhbHVlO30KdmFyIGZpZWxkcz1fLmV4dGVuZCh7ZGlzcGxheV9uYW1lOnt0eXBlOidjaGFyJ30saWQ6e3R5cGU6J2ludGVnZXInfSx9LHBhcmFtcy5maWVsZHMpO3ZhciBkYXRhUG9pbnQ9e19jYWNoZTp0eXBlPT09J2xpc3QnP3t9OnVuZGVmaW5lZCxfY2hhbmdlczpudWxsLF9kb21haW5zOnt9LF9yYXdDaGFuZ2VzOnt9LGFnZ3JlZ2F0ZVZhbHVlczpwYXJhbXMuYWdncmVnYXRlVmFsdWVzfHx7fSxjb250ZXh0OmNvbnRleHQsY291bnQ6cGFyYW1zLmNvdW50fHxyZXNfaWRzLmxlbmd0aCxkYXRhOmRhdGEsZG9tYWluOnBhcmFtcy5kb21haW58fFtdLGZpZWxkczpmaWVsZHMsZmllbGRzSW5mbzpwYXJhbXMuZmllbGRzSW5mbyxncm91cGVkQnk6cGFyYW1zLmdyb3VwZWRCeXx8W10sZ3JvdXBzQ291bnQ6MCxncm91cHNMaW1pdDp0eXBlPT09J2xpc3QnJiZwYXJhbXMuZ3JvdXBzTGltaXR8fG51bGwsZ3JvdXBzT2Zmc2V0OjAsaWQ6Xy51bmlxdWVJZChwYXJhbXMubW9kZWxOYW1lKydfJyksaXNPcGVuOnBhcmFtcy5pc09wZW4sbGltaXQ6dHlwZT09PSdyZWNvcmQnPzE6cGFyYW1zLmxpbWl0LGxvYWRNb3JlT2Zmc2V0OjAsbW9kZWw6cGFyYW1zLm1vZGVsTmFtZSxvZmZzZXQ6cGFyYW1zLm9mZnNldHx8KHR5cGU9PT0ncmVjb3JkJz9fLmluZGV4T2YocmVzX2lkcyxyZXNfaWQpOjApLG9wZW5Hcm91cEJ5RGVmYXVsdDpwYXJhbXMub3Blbkdyb3VwQnlEZWZhdWx0LG9yZGVyZWRCeTpwYXJhbXMub3JkZXJlZEJ5fHxbXSxvcmRlcmVkUmVzSURzOnBhcmFtcy5vcmRlcmVkUmVzSURzLHBhcmVudElEOnBhcmFtcy5wYXJlbnRJRCxyYXdDb250ZXh0OnBhcmFtcy5yYXdDb250ZXh0LHJlZjpwYXJhbXMucmVmfHxyZXNfaWQscmVsYXRpb25GaWVsZDpwYXJhbXMucmVsYXRpb25GaWVsZCxyZXNfaWQ6cmVzX2lkLHJlc19pZHM6cmVzX2lkcyxzcGVjaWFsRGF0YTp7fSxfc3BlY2lhbERhdGFDYWNoZTp7fSxzdGF0aWM6cGFyYW1zLnN0YXRpY3x8ZmFsc2UsdHlwZTp0eXBlLHZhbHVlOnZhbHVlLHZpZXdUeXBlOnBhcmFtcy52aWV3VHlwZSx9O2RhdGFQb2ludC5fZWRpdGlvblZpZXdUeXBlPXt9O2RhdGFQb2ludC5ldmFsTW9kaWZpZXJzPXRoaXMuX2V2YWxNb2RpZmllcnMuYmluZCh0aGlzLGRhdGFQb2ludCk7ZGF0YVBvaW50LmdldENvbnRleHQ9dGhpcy5fZ2V0Q29udGV4dC5iaW5kKHRoaXMsZGF0YVBvaW50KTtkYXRhUG9pbnQuZ2V0RG9tYWluPXRoaXMuX2dldERvbWFpbi5iaW5kKHRoaXMsZGF0YVBvaW50KTtkYXRhUG9pbnQuZ2V0RmllbGROYW1lcz10aGlzLl9nZXRGaWVsZE5hbWVzLmJpbmQodGhpcyxkYXRhUG9pbnQpO2RhdGFQb2ludC5pc0RpcnR5PXRoaXMuaXNEaXJ0eS5iaW5kKHRoaXMsZGF0YVBvaW50LmlkKTt0aGlzLmxvY2FsRGF0YVtkYXRhUG9pbnQuaWRdPWRhdGFQb2ludDtyZXR1cm4gZGF0YVBvaW50O30sX21ha2VEZWZhdWx0UmVjb3JkOmZ1bmN0aW9uKG1vZGVsTmFtZSxwYXJhbXMpe3ZhciBzZWxmPXRoaXM7dmFyIHRhcmdldFZpZXc9cGFyYW1zLnZpZXdUeXBlO3ZhciBmaWVsZHM9cGFyYW1zLmZpZWxkczt2YXIgZmllbGRzSW5mbz1wYXJhbXMuZmllbGRzSW5mbzt2YXIgZmllbGROYW1lcz1PYmplY3Qua2V5cyhmaWVsZHNJbmZvW3RhcmdldFZpZXddKTt2YXIgZmllbGRzX2tleT1fLndpdGhvdXQoZmllbGROYW1lcywnX19sYXN0X3VwZGF0ZScpO3ZhciBwYXJlbnRSZWNvcmQ9c2VsZi5sb2NhbERhdGFbcGFyYW1zLnBhcmVudElEXTtpZihwYXJlbnRSZWNvcmQpe3ZhciBvcmlnaW5WaWV3PXBhcmVudFJlY29yZC52aWV3VHlwZTtmaWVsZE5hbWVzPV8udW5pb24oZmllbGROYW1lcyxPYmplY3Qua2V5cyhwYXJlbnRSZWNvcmQuZmllbGRzSW5mb1tvcmlnaW5WaWV3XSkpO2ZpZWxkc0luZm9bdGFyZ2V0Vmlld109Xy5kZWZhdWx0cyh7fSxmaWVsZHNJbmZvW3RhcmdldFZpZXddLHBhcmVudFJlY29yZC5maWVsZHNJbmZvW29yaWdpblZpZXddKTtmaWVsZHM9Xy5kZWZhdWx0cyh7fSxmaWVsZHMscGFyZW50UmVjb3JkLmZpZWxkcyk7fQpyZXR1cm4gdGhpcy5fcnBjKHttb2RlbDptb2RlbE5hbWUsbWV0aG9kOidkZWZhdWx0X2dldCcsYXJnczpbZmllbGRzX2tleV0sY29udGV4dDpwYXJhbXMuY29udGV4dCx9KS50aGVuKGZ1bmN0aW9uKHJlc3VsdCl7dmFyIHJlY29yZD1zZWxmLl9tYWtlRGF0YVBvaW50KHttb2RlbE5hbWU6bW9kZWxOYW1lLGZpZWxkczpmaWVsZHMsZmllbGRzSW5mbzpmaWVsZHNJbmZvLGNvbnRleHQ6cGFyYW1zLmNvbnRleHQscGFyZW50SUQ6cGFyYW1zLnBhcmVudElELHJlc19pZHM6cGFyYW1zLnJlc19pZHMsdmlld1R5cGU6dGFyZ2V0Vmlldyx9KTt2YXIgb3ZlcnJpZGVEZWZhdWx0RmllbGRzPXNlbGYuX2NvbXB1dGVPdmVycmlkZURlZmF1bHRGaWVsZHMocGFyYW1zLnBhcmVudElELHBhcmFtcy5wb3NpdGlvbik7aWYob3ZlcnJpZGVEZWZhdWx0RmllbGRzKXtyZXN1bHRbb3ZlcnJpZGVEZWZhdWx0RmllbGRzLmZpZWxkXT1vdmVycmlkZURlZmF1bHRGaWVsZHMudmFsdWU7fQpyZXR1cm4gc2VsZi5hcHBseURlZmF1bHRWYWx1ZXMocmVjb3JkLmlkLHJlc3VsdCx7ZmllbGROYW1lczpmaWVsZE5hbWVzfSkudGhlbihmdW5jdGlvbigpe3ZhciBkZWY9bmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSxyZWplY3Qpe3ZhciBhbHdheXM9ZnVuY3Rpb24oKXtpZihyZWNvcmQuX3dhcm5pbmcpe2lmKHBhcmFtcy5hbGxvd1dhcm5pbmcpe2RlbGV0ZSByZWNvcmQuX3dhcm5pbmc7fWVsc2V7cmVqZWN0KCk7fX0KcmVzb2x2ZSgpO307c2VsZi5fcGVyZm9ybU9uQ2hhbmdlKHJlY29yZCxmaWVsZHNfa2V5KS50aGVuKGFsd2F5cykuZ3VhcmRlZENhdGNoKGFsd2F5cyk7fSk7cmV0dXJuIGRlZjt9KS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIHNlbGYuX2ZldGNoUmVsYXRpb25hbERhdGEocmVjb3JkKTt9KS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIHNlbGYuX3Bvc3Rwcm9jZXNzKHJlY29yZCk7fSkudGhlbihmdW5jdGlvbigpe3NlbGYuc2F2ZShyZWNvcmQuaWQse3NhdmVQb2ludDp0cnVlfSk7cmV0dXJuIHJlY29yZC5pZDt9KTt9KTt9LF9wYXJzZVNlcnZlckRhdGE6ZnVuY3Rpb24oZmllbGROYW1lcyxlbGVtZW50LGRhdGEpe3ZhciBzZWxmPXRoaXM7Xy5lYWNoKGZpZWxkTmFtZXMsZnVuY3Rpb24oZmllbGROYW1lKXt2YXIgZmllbGQ9ZWxlbWVudC5maWVsZHNbZmllbGROYW1lXTt2YXIgdmFsPWRhdGFbZmllbGROYW1lXTtpZihmaWVsZC50eXBlPT09J21hbnkyb25lJyl7aWYodmFsIT09ZmFsc2Upe3ZhciByPXNlbGYuX21ha2VEYXRhUG9pbnQoe21vZGVsTmFtZTpmaWVsZC5yZWxhdGlvbixmaWVsZHM6e2Rpc3BsYXlfbmFtZTp7dHlwZTonY2hhcid9LGlkOnt0eXBlOidpbnRlZ2VyJ30sfSxkYXRhOntkaXNwbGF5X25hbWU6dmFsWzFdLGlkOnZhbFswXSx9LHBhcmVudElEOmVsZW1lbnQuaWQsfSk7ZGF0YVtmaWVsZE5hbWVdPXIuaWQ7fWVsc2V7ZGF0YVtmaWVsZE5hbWVdPWZhbHNlO319ZWxzZXtkYXRhW2ZpZWxkTmFtZV09c2VsZi5fcGFyc2VTZXJ2ZXJWYWx1ZShmaWVsZCx2YWwpO319KTt9LF9wZXJmb3JtT25DaGFuZ2U6ZnVuY3Rpb24ocmVjb3JkLGZpZWxkcyx2aWV3VHlwZSl7dmFyIHNlbGY9dGhpczt2YXIgb25jaGFuZ2VTcGVjPXRoaXMuX2J1aWxkT25jaGFuZ2VTcGVjcyhyZWNvcmQsdmlld1R5cGUpO2lmKCFvbmNoYW5nZVNwZWMpe3JldHVybiBQcm9taXNlLnJlc29sdmUoKTt9CnZhciBpZExpc3Q9cmVjb3JkLmRhdGEuaWQ/W3JlY29yZC5kYXRhLmlkXTpbXTt2YXIgb3B0aW9ucz17ZnVsbDp0cnVlLH07aWYoZmllbGRzLmxlbmd0aD09PTEpe2ZpZWxkcz1maWVsZHNbMF07b3B0aW9ucy5maWVsZE5hbWU9ZmllbGRzO30KdmFyIGNvbnRleHQ9dGhpcy5fZ2V0Q29udGV4dChyZWNvcmQsb3B0aW9ucyk7dmFyIGN1cnJlbnREYXRhPXRoaXMuX2dlbmVyYXRlT25DaGFuZ2VEYXRhKHJlY29yZCx7Y2hhbmdlc09ubHk6ZmFsc2V9KTtyZXR1cm4gc2VsZi5fcnBjKHttb2RlbDpyZWNvcmQubW9kZWwsbWV0aG9kOidvbmNoYW5nZScsYXJnczpbaWRMaXN0LGN1cnJlbnREYXRhLGZpZWxkcyxvbmNoYW5nZVNwZWNdLGNvbnRleHQ6Y29udGV4dCx9KS50aGVuKGZ1bmN0aW9uKHJlc3VsdCl7aWYoIXJlY29yZC5fY2hhbmdlcyl7cmV0dXJuO30KaWYocmVzdWx0Lndhcm5pbmcpe3NlbGYudHJpZ2dlcl91cCgnd2FybmluZycscmVzdWx0Lndhcm5pbmcpO3JlY29yZC5fd2FybmluZz10cnVlO30KaWYocmVzdWx0LmRvbWFpbil7cmVjb3JkLl9kb21haW5zPV8uZXh0ZW5kKHJlY29yZC5fZG9tYWlucyxyZXN1bHQuZG9tYWluKTt9CnJldHVybiBzZWxmLl9hcHBseU9uQ2hhbmdlKHJlc3VsdC52YWx1ZSxyZWNvcmQpLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gcmVzdWx0O30pO30pO30sX3BlcmZvcm1SUEM6ZnVuY3Rpb24ocGFyYW1zKXt2YXIgc2VsZj10aGlzO3ZhciByZXF1ZXN0PV8uZXh0ZW5kKHt9LHBhcmFtcyk7dmFyIHByb209bmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSxyZWplY3Qpe3JlcXVlc3QucmVzb2x2ZT1yZXNvbHZlO3JlcXVlc3QucmVqZWN0PXJlamVjdDt9KTt0aGlzLmJhdGNoZWRSUENzUmVxdWVzdHMucHVzaChyZXF1ZXN0KTtQcm9taXNlLnJlc29sdmUoKS50aGVuKGZ1bmN0aW9uKCl7aWYoIXNlbGYuYmF0Y2hlZFJQQ3NSZXF1ZXN0cy5sZW5ndGgpe3JldHVybjt9CnZhciBiYXRjaGVkUlBDc1JlcXVlc3RzPXNlbGYuYmF0Y2hlZFJQQ3NSZXF1ZXN0cztzZWxmLmJhdGNoZWRSUENzUmVxdWVzdHM9W107dmFyIGJhdGNoZXM9e307dmFyIGtleTtmb3IodmFyIGk9MDtpPGJhdGNoZWRSUENzUmVxdWVzdHMubGVuZ3RoO2krKyl7dmFyIHJlcXVlc3Q9YmF0Y2hlZFJQQ3NSZXF1ZXN0c1tpXTtrZXk9cmVxdWVzdC5tb2RlbCsnLCcrSlNPTi5zdHJpbmdpZnkocmVxdWVzdC5jb250ZXh0KTtpZighYmF0Y2hlc1trZXldKXtiYXRjaGVzW2tleV09Xy5leHRlbmQoe30scmVxdWVzdCx7cmVxdWVzdHM6W3JlcXVlc3RdfSk7fWVsc2V7YmF0Y2hlc1trZXldLmlkcz1fLnVuaXEoYmF0Y2hlc1trZXldLmlkcy5jb25jYXQocmVxdWVzdC5pZHMpKTtiYXRjaGVzW2tleV0uZmllbGROYW1lcz1fLnVuaXEoYmF0Y2hlc1trZXldLmZpZWxkTmFtZXMuY29uY2F0KHJlcXVlc3QuZmllbGROYW1lcykpO2JhdGNoZXNba2V5XS5yZXF1ZXN0cy5wdXNoKHJlcXVlc3QpO319CmZ1bmN0aW9uIG9uU3VjY2VzcyhiYXRjaCxyZXN1bHRzKXtmb3IodmFyIGk9MDtpPGJhdGNoLnJlcXVlc3RzLmxlbmd0aDtpKyspe3ZhciByZXF1ZXN0PWJhdGNoLnJlcXVlc3RzW2ldO3ZhciBmaWVsZE5hbWVzPXJlcXVlc3QuZmllbGROYW1lcy5jb25jYXQoWydpZCddKTt2YXIgZmlsdGVyZWRSZXN1bHRzPXJlc3VsdHMuZmlsdGVyKGZ1bmN0aW9uKHJlY29yZCl7cmV0dXJuIHJlcXVlc3QuaWRzLmluZGV4T2YocmVjb3JkLmlkKT49MDt9KS5tYXAoZnVuY3Rpb24ocmVjb3JkKXtyZXR1cm4gXy5waWNrKHJlY29yZCxmaWVsZE5hbWVzKTt9KTtyZXF1ZXN0LnJlc29sdmUoZmlsdGVyZWRSZXN1bHRzKTt9fQpmdW5jdGlvbiBvbkZhaWx1cmUoYmF0Y2gsZXJyb3Ipe2Zvcih2YXIgaT0wO2k8YmF0Y2gucmVxdWVzdHMubGVuZ3RoO2krKyl7dmFyIHJlcXVlc3Q9YmF0Y2gucmVxdWVzdHNbaV07cmVxdWVzdC5yZWplY3QoZXJyb3IpO319CmZvcihrZXkgaW4gYmF0Y2hlcyl7dmFyIGJhdGNoPWJhdGNoZXNba2V5XTtzZWxmLl9ycGMoe21vZGVsOmJhdGNoLm1vZGVsLG1ldGhvZDoncmVhZCcsYXJnczpbYmF0Y2guaWRzLGJhdGNoLmZpZWxkTmFtZXNdLGNvbnRleHQ6YmF0Y2guY29udGV4dCx9KS50aGVuKG9uU3VjY2Vzcy5iaW5kKG51bGwsYmF0Y2gpKS5ndWFyZGVkQ2F0Y2gob25GYWlsdXJlLmJpbmQobnVsbCxiYXRjaCkpO319KTtyZXR1cm4gcHJvbTt9LF9wb3N0cHJvY2VzczpmdW5jdGlvbihyZWNvcmQsb3B0aW9ucyl7dmFyIHNlbGY9dGhpczt2YXIgdmlld1R5cGU9b3B0aW9ucyYmb3B0aW9ucy52aWV3VHlwZXx8cmVjb3JkLnZpZXdUeXBlO3ZhciBkZWZzPVtdO18uZWFjaChyZWNvcmQuZ2V0RmllbGROYW1lcyhvcHRpb25zKSxmdW5jdGlvbihuYW1lKXt2YXIgZmllbGQ9cmVjb3JkLmZpZWxkc1tuYW1lXTt2YXIgZmllbGRJbmZvPXJlY29yZC5maWVsZHNJbmZvW3ZpZXdUeXBlXVtuYW1lXXx8e307dmFyIG9wdGlvbnM9ZmllbGRJbmZvLm9wdGlvbnN8fHt9O2lmKG9wdGlvbnMuYWx3YXlzX3JlbG9hZCl7aWYocmVjb3JkLmZpZWxkc1tuYW1lXS50eXBlPT09J21hbnkyb25lJyYmcmVjb3JkLmRhdGFbbmFtZV0pe3ZhciBlbGVtZW50PXNlbGYubG9jYWxEYXRhW3JlY29yZC5kYXRhW25hbWVdXTtkZWZzLnB1c2goc2VsZi5fcnBjKHttb2RlbDpmaWVsZC5yZWxhdGlvbixtZXRob2Q6J25hbWVfZ2V0JyxhcmdzOltlbGVtZW50LmRhdGEuaWRdLGNvbnRleHQ6c2VsZi5fZ2V0Q29udGV4dChyZWNvcmQse2ZpZWxkTmFtZTpuYW1lLHZpZXdUeXBlOnZpZXdUeXBlfSksfSkudGhlbihmdW5jdGlvbihyZXN1bHQpe2VsZW1lbnQuZGF0YS5kaXNwbGF5X25hbWU9cmVzdWx0WzBdWzFdO30pKTt9fX0pO2RlZnMucHVzaCh0aGlzLl9mZXRjaFNwZWNpYWxEYXRhKHJlY29yZCxvcHRpb25zKSk7cmV0dXJuIFByb21pc2UuYWxsKGRlZnMpLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gcmVjb3JkO30pO30sX3Byb2Nlc3NYMk1hbnlDb21tYW5kczpmdW5jdGlvbihyZWNvcmQsZmllbGROYW1lLGNvbW1hbmRzLG9wdGlvbnMpe3ZhciBzZWxmPXRoaXM7b3B0aW9ucz1vcHRpb25zfHx7fTt2YXIgZGVmcz1bXTt2YXIgZmllbGQ9cmVjb3JkLmZpZWxkc1tmaWVsZE5hbWVdO3ZhciBmaWVsZEluZm89cmVjb3JkLmZpZWxkc0luZm9bb3B0aW9ucy52aWV3VHlwZXx8cmVjb3JkLnZpZXdUeXBlXVtmaWVsZE5hbWVdO3ZhciB2aWV3PWZpZWxkSW5mby52aWV3cyYmZmllbGRJbmZvLnZpZXdzW2ZpZWxkSW5mby5tb2RlXTt2YXIgZmllbGRzSW5mbz12aWV3P3ZpZXcuZmllbGRzSW5mbzpmaWVsZEluZm8uZmllbGRzSW5mbzt2YXIgZmllbGRzPXZpZXc/dmlldy5maWVsZHM6ZmllbGRJbmZvLnJlbGF0ZWRGaWVsZHM7dmFyIHZpZXdUeXBlPXZpZXc/dmlldy50eXBlOmZpZWxkSW5mby52aWV3VHlwZTt2YXIgeDJtYW55TGlzdD1zZWxmLl9tYWtlRGF0YVBvaW50KHtjb250ZXh0OnJlY29yZC5jb250ZXh0LGZpZWxkc0luZm86ZmllbGRzSW5mbyxmaWVsZHM6ZmllbGRzLGxpbWl0OmZpZWxkSW5mby5saW1pdCxtb2RlbE5hbWU6ZmllbGQucmVsYXRpb24scGFyZW50SUQ6cmVjb3JkLmlkLHJhd0NvbnRleHQ6ZmllbGRJbmZvJiZmaWVsZEluZm8uY29udGV4dCxyZWxhdGlvbkZpZWxkOmZpZWxkLnJlbGF0aW9uX2ZpZWxkLHJlc19pZHM6W10sc3RhdGljOnRydWUsdHlwZTonbGlzdCcsdmlld1R5cGU6dmlld1R5cGUsfSk7cmVjb3JkLl9jaGFuZ2VzW2ZpZWxkTmFtZV09eDJtYW55TGlzdC5pZDt4Mm1hbnlMaXN0Ll9jaGFuZ2VzPVtdO3ZhciBtYW55Mm9uZXM9e307dmFyIHI7Y29tbWFuZHM9Y29tbWFuZHN8fFtdO3ZhciBpc0NvbW1hbmRMaXN0PWNvbW1hbmRzLmxlbmd0aCYmXy5pc0FycmF5KGNvbW1hbmRzWzBdKTtpZighaXNDb21tYW5kTGlzdCl7Y29tbWFuZHM9W1s2LGZhbHNlLGNvbW1hbmRzXV07fQpfLmVhY2goY29tbWFuZHMsZnVuY3Rpb24odmFsdWUpe2lmKHZhbHVlWzBdPT09MCl7cj1zZWxmLl9tYWtlRGF0YVBvaW50KHttb2RlbE5hbWU6eDJtYW55TGlzdC5tb2RlbCxjb250ZXh0OngybWFueUxpc3QuY29udGV4dCxmaWVsZHNJbmZvOmZpZWxkc0luZm8sZmllbGRzOmZpZWxkcyxwYXJlbnRJRDp4Mm1hbnlMaXN0LmlkLHZpZXdUeXBlOnZpZXdUeXBlLH0pO3IuX25vQWJhbmRvbj10cnVlO3gybWFueUxpc3QuX2NoYW5nZXMucHVzaCh7b3BlcmF0aW9uOidBREQnLGlkOnIuaWR9KTt4Mm1hbnlMaXN0Ll9jYWNoZVtyLnJlc19pZF09ci5pZDtfLmVhY2goci5nZXRGaWVsZE5hbWVzKCksZnVuY3Rpb24oZmllbGROYW1lKXtyLmRhdGFbZmllbGROYW1lXT1udWxsO30pO3IuX2NoYW5nZXM9Xy5kZWZhdWx0cyh2YWx1ZVsyXSxyLmRhdGEpO2Zvcih2YXIgZmllbGROYW1lIGluIHIuX2NoYW5nZXMpe2lmKCFyLl9jaGFuZ2VzW2ZpZWxkTmFtZV0pe2NvbnRpbnVlO30KdmFyIGlzRmllbGRJblZpZXc9ZmllbGROYW1lIGluIHIuZmllbGRzO2lmKGlzRmllbGRJblZpZXcpe3ZhciBmaWVsZD1yLmZpZWxkc1tmaWVsZE5hbWVdO3ZhciBmaWVsZFR5cGU9ZmllbGQudHlwZTt2YXIgcmVjO2lmKGZpZWxkVHlwZT09PSdtYW55Mm9uZScpe3JlYz1zZWxmLl9tYWtlRGF0YVBvaW50KHtjb250ZXh0OnIuY29udGV4dCxtb2RlbE5hbWU6ZmllbGQucmVsYXRpb24sZGF0YTp7aWQ6ci5fY2hhbmdlc1tmaWVsZE5hbWVdfSxwYXJlbnRJRDpyLmlkLH0pO3IuX2NoYW5nZXNbZmllbGROYW1lXT1yZWMuaWQ7bWFueTJvbmVzW2ZpZWxkTmFtZV09dHJ1ZTt9ZWxzZSBpZihmaWVsZFR5cGU9PT0ncmVmZXJlbmNlJyl7dmFyIHJlZmVyZW5jZT1yLl9jaGFuZ2VzW2ZpZWxkTmFtZV0uc3BsaXQoJywnKTtyZWM9c2VsZi5fbWFrZURhdGFQb2ludCh7Y29udGV4dDpyLmNvbnRleHQsbW9kZWxOYW1lOnJlZmVyZW5jZVswXSxkYXRhOntpZDpwYXJzZUludChyZWZlcmVuY2VbMV0pfSxwYXJlbnRJRDpyLmlkLH0pO3IuX2NoYW5nZXNbZmllbGROYW1lXT1yZWMuaWQ7bWFueTJvbmVzW2ZpZWxkTmFtZV09dHJ1ZTt9ZWxzZSBpZihfLmNvbnRhaW5zKFsnb25lMm1hbnknLCdtYW55Mm1hbnknXSxmaWVsZFR5cGUpKXt2YXIgeDJtQ29tbWFuZHM9dmFsdWVbMl1bZmllbGROYW1lXTtkZWZzLnB1c2goc2VsZi5fcHJvY2Vzc1gyTWFueUNvbW1hbmRzKHIsZmllbGROYW1lLHgybUNvbW1hbmRzKSk7fWVsc2V7ci5fY2hhbmdlc1tmaWVsZE5hbWVdPXNlbGYuX3BhcnNlU2VydmVyVmFsdWUoZmllbGQsci5fY2hhbmdlc1tmaWVsZE5hbWVdKTt9fX19CmlmKHZhbHVlWzBdPT09Nil7Xy5lYWNoKHZhbHVlWzJdLGZ1bmN0aW9uKHJlc19pZCl7eDJtYW55TGlzdC5fY2hhbmdlcy5wdXNoKHtvcGVyYXRpb246J0FERCcscmVzSUQ6cmVzX2lkfSk7fSk7dmFyIGRlZj1zZWxmLl9yZWFkVW5ncm91cGVkTGlzdCh4Mm1hbnlMaXN0KS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIFByb21pc2UuYWxsKFtzZWxmLl9mZXRjaFgyTWFueXNCYXRjaGVkKHgybWFueUxpc3QpLHNlbGYuX2ZldGNoUmVmZXJlbmNlc0JhdGNoZWQoeDJtYW55TGlzdCldKTt9KTtkZWZzLnB1c2goZGVmKTt9fSk7Xy5lYWNoKF8ua2V5cyhtYW55Mm9uZXMpLGZ1bmN0aW9uKG5hbWUpe2RlZnMucHVzaChzZWxmLl9mZXRjaE5hbWVHZXRzKHgybWFueUxpc3QsbmFtZSkpO30pO3JldHVybiBQcm9taXNlLmFsbChkZWZzKTt9LF9yZWFkTWlzc2luZ0ZpZWxkczpmdW5jdGlvbihsaXN0LHJlc0lEcyxmaWVsZE5hbWVzKXt2YXIgc2VsZj10aGlzO3ZhciBtaXNzaW5nSURzPVtdO2Zvcih2YXIgaT0wLGxlbj1yZXNJRHMubGVuZ3RoO2k8bGVuO2krKyl7dmFyIHJlc0lkPXJlc0lEc1tpXTt2YXIgZGF0YVBvaW50SUQ9bGlzdC5fY2FjaGVbcmVzSWRdO2lmKCFkYXRhUG9pbnRJRCl7bWlzc2luZ0lEcy5wdXNoKHJlc0lkKTtjb250aW51ZTt9CnZhciByZWNvcmQ9c2VsZi5sb2NhbERhdGFbZGF0YVBvaW50SURdO3ZhciBkYXRhPV8uZXh0ZW5kKHt9LHJlY29yZC5kYXRhLHJlY29yZC5fY2hhbmdlcyk7aWYoXy5kaWZmZXJlbmNlKGZpZWxkTmFtZXMsXy5rZXlzKGRhdGEpKS5sZW5ndGgpe21pc3NpbmdJRHMucHVzaChyZXNJZCk7fX0KdmFyIGRlZjtpZihtaXNzaW5nSURzLmxlbmd0aCYmZmllbGROYW1lcy5sZW5ndGgpe2RlZj1zZWxmLl9wZXJmb3JtUlBDKHtjb250ZXh0Omxpc3QuZ2V0Q29udGV4dCgpLGZpZWxkTmFtZXM6ZmllbGROYW1lcyxpZHM6bWlzc2luZ0lEcyxtZXRob2Q6J3JlYWQnLG1vZGVsOmxpc3QubW9kZWwsfSk7fWVsc2V7ZGVmPVByb21pc2UucmVzb2x2ZShfLm1hcChtaXNzaW5nSURzLGZ1bmN0aW9uKGlkKXtyZXR1cm57aWQ6aWR9O30pKTt9CnJldHVybiBkZWYudGhlbihmdW5jdGlvbihyZWNvcmRzKXtfLmVhY2gocmVzSURzLGZ1bmN0aW9uKGlkKXt2YXIgZGF0YVBvaW50O3ZhciBkYXRhPV8uZmluZFdoZXJlKHJlY29yZHMse2lkOmlkfSk7aWYoaWQgaW4gbGlzdC5fY2FjaGUpe2RhdGFQb2ludD1zZWxmLmxvY2FsRGF0YVtsaXN0Ll9jYWNoZVtpZF1dO2lmKGRhdGEpe3NlbGYuX3BhcnNlU2VydmVyRGF0YShmaWVsZE5hbWVzLGRhdGFQb2ludCxkYXRhKTtfLmV4dGVuZChkYXRhUG9pbnQuZGF0YSxkYXRhKTt9fWVsc2V7ZGF0YVBvaW50PXNlbGYuX21ha2VEYXRhUG9pbnQoe2NvbnRleHQ6bGlzdC5nZXRDb250ZXh0KCksZGF0YTpkYXRhLGZpZWxkc0luZm86bGlzdC5maWVsZHNJbmZvLGZpZWxkczpsaXN0LmZpZWxkcyxtb2RlbE5hbWU6bGlzdC5tb2RlbCxwYXJlbnRJRDpsaXN0LmlkLHZpZXdUeXBlOmxpc3Qudmlld1R5cGUsfSk7c2VsZi5fcGFyc2VTZXJ2ZXJEYXRhKGZpZWxkTmFtZXMsZGF0YVBvaW50LGRhdGFQb2ludC5kYXRhKTtsaXN0Ll9jYWNoZVtpZF09ZGF0YVBvaW50LmlkO30KXy5lYWNoKGxpc3QuX2NoYW5nZXMsZnVuY3Rpb24oY2hhbmdlKXtpZihjaGFuZ2Uub3BlcmF0aW9uPT09J0FERCcmJiFjaGFuZ2UuaWQmJmNoYW5nZS5yZXNJRD09PWlkKXtjaGFuZ2UuaWQ9ZGF0YVBvaW50LmlkO319KTt9KTtyZXR1cm4gbGlzdDt9KTt9LF9yZWFkR3JvdXA6ZnVuY3Rpb24obGlzdCxvcHRpb25zKXt2YXIgc2VsZj10aGlzO29wdGlvbnM9b3B0aW9uc3x8e307dmFyIGdyb3VwQnlGaWVsZD1saXN0Lmdyb3VwZWRCeVswXTt2YXIgcmF3R3JvdXBCeT1ncm91cEJ5RmllbGQuc3BsaXQoJzonKVswXTt2YXIgZmllbGRzPV8udW5pcShsaXN0LmdldEZpZWxkTmFtZXMoKS5jb25jYXQocmF3R3JvdXBCeSkpO3ZhciBvcmRlcmVkQnk9Xy5maWx0ZXIobGlzdC5vcmRlcmVkQnksZnVuY3Rpb24ob3JkZXIpe3JldHVybiBvcmRlci5uYW1lPT09cmF3R3JvdXBCeXx8bGlzdC5maWVsZHNbb3JkZXIubmFtZV0uZ3JvdXBfb3BlcmF0b3IhPT11bmRlZmluZWQ7fSk7dmFyIG9wZW5Hcm91cHNMaW1pdD1saXN0Lmdyb3Vwc0xpbWl0fHxzZWxmLk9QRU5fR1JPVVBfTElNSVQ7dmFyIGV4cGFuZD1saXN0Lm9wZW5Hcm91cEJ5RGVmYXVsdCYmb3B0aW9ucy5mZXRjaFJlY29yZHNXaXRoR3JvdXBzO3JldHVybiB0aGlzLl9ycGMoe21vZGVsOmxpc3QubW9kZWwsbWV0aG9kOid3ZWJfcmVhZF9ncm91cCcsZmllbGRzOmZpZWxkcyxkb21haW46bGlzdC5kb21haW4sY29udGV4dDpsaXN0LmNvbnRleHQsZ3JvdXBCeTpsaXN0Lmdyb3VwZWRCeSxsaW1pdDpsaXN0Lmdyb3Vwc0xpbWl0LG9mZnNldDpsaXN0Lmdyb3Vwc09mZnNldCxvcmRlckJ5Om9yZGVyZWRCeSxsYXp5OnRydWUsZXhwYW5kOmV4cGFuZCxleHBhbmRfbGltaXQ6ZXhwYW5kP2xpc3QubGltaXQ6bnVsbCxleHBhbmRfb3JkZXJieTpleHBhbmQ/bGlzdC5vcmRlcmVkQnk6bnVsbCx9KS50aGVuKGZ1bmN0aW9uKHJlc3VsdCl7dmFyIGdyb3Vwcz1yZXN1bHQuZ3JvdXBzO2xpc3QuZ3JvdXBzQ291bnQ9cmVzdWx0Lmxlbmd0aDt2YXIgcHJldmlvdXNHcm91cHM9Xy5tYXAobGlzdC5kYXRhLGZ1bmN0aW9uKGdyb3VwSUQpe3JldHVybiBzZWxmLmxvY2FsRGF0YVtncm91cElEXTt9KTtsaXN0LmRhdGE9W107bGlzdC5jb3VudD0wO3ZhciBkZWZzPVtdO3ZhciBvcGVuR3JvdXBDb3VudD0wO18uZWFjaChncm91cHMsZnVuY3Rpb24oZ3JvdXApe3ZhciBhZ2dyZWdhdGVWYWx1ZXM9e307Xy5lYWNoKGdyb3VwLGZ1bmN0aW9uKHZhbHVlLGtleSl7aWYoXy5jb250YWlucyhmaWVsZHMsa2V5KSYma2V5IT09Z3JvdXBCeUZpZWxkJiZBR0dSRUdBVEFCTEVfVFlQRVMuaW5jbHVkZXMobGlzdC5maWVsZHNba2V5XS50eXBlKSl7YWdncmVnYXRlVmFsdWVzW2tleV09dmFsdWU7fX0pO3ZhciB2YWx1ZT1ncm91cFtncm91cEJ5RmllbGRdO2lmKGxpc3QuZmllbGRzW3Jhd0dyb3VwQnldLnR5cGU9PT0ic2VsZWN0aW9uIil7dmFyIGNob2ljZT1fLmZpbmQobGlzdC5maWVsZHNbcmF3R3JvdXBCeV0uc2VsZWN0aW9uLGZ1bmN0aW9uKGMpe3JldHVybiBjWzBdPT09dmFsdWU7fSk7dmFsdWU9Y2hvaWNlP2Nob2ljZVsxXTpmYWxzZTt9CnZhciBuZXdHcm91cD1zZWxmLl9tYWtlRGF0YVBvaW50KHttb2RlbE5hbWU6bGlzdC5tb2RlbCxjb3VudDpncm91cFtyYXdHcm91cEJ5KydfY291bnQnXSxkb21haW46Z3JvdXAuX19kb21haW4sY29udGV4dDpsaXN0LmNvbnRleHQsZmllbGRzOmxpc3QuZmllbGRzLGZpZWxkc0luZm86bGlzdC5maWVsZHNJbmZvLHZhbHVlOnZhbHVlLGFnZ3JlZ2F0ZVZhbHVlczphZ2dyZWdhdGVWYWx1ZXMsZ3JvdXBlZEJ5Omxpc3QuZ3JvdXBlZEJ5LnNsaWNlKDEpLG9yZGVyZWRCeTpsaXN0Lm9yZGVyZWRCeSxvcmRlcmVkUmVzSURzOmxpc3Qub3JkZXJlZFJlc0lEcyxsaW1pdDpsaXN0LmxpbWl0LG9wZW5Hcm91cEJ5RGVmYXVsdDpsaXN0Lm9wZW5Hcm91cEJ5RGVmYXVsdCxwYXJlbnRJRDpsaXN0LmlkLHR5cGU6J2xpc3QnLHZpZXdUeXBlOmxpc3Qudmlld1R5cGUsfSk7dmFyIG9sZEdyb3VwPV8uZmluZChwcmV2aW91c0dyb3VwcyxmdW5jdGlvbihnKXtyZXR1cm4gZy5yZXNfaWQ9PT1uZXdHcm91cC5yZXNfaWQmJmcudmFsdWU9PT1uZXdHcm91cC52YWx1ZTt9KTtpZihvbGRHcm91cCl7ZGVsZXRlIHNlbGYubG9jYWxEYXRhW25ld0dyb3VwLmlkXTt2YXIgdXBkYXRlZFByb3BzPV8ucGljayhvbGRHcm91cCwnaXNPcGVuJywnb2Zmc2V0JywnaWQnKTtpZihvcHRpb25zLm9ubHlHcm91cHN8fG9sZEdyb3VwLmlzT3BlbiYmbmV3R3JvdXAuZ3JvdXBlZEJ5Lmxlbmd0aCl7dXBkYXRlZFByb3BzLmRhdGE9b2xkR3JvdXAuZGF0YTt9Cl8uZXh0ZW5kKG5ld0dyb3VwLHVwZGF0ZWRQcm9wcyk7bmV3R3JvdXAubGltaXQ9b2xkR3JvdXAubGltaXQrb2xkR3JvdXAubG9hZE1vcmVPZmZzZXQ7c2VsZi5sb2NhbERhdGFbbmV3R3JvdXAuaWRdPW5ld0dyb3VwO31lbHNlIGlmKCFuZXdHcm91cC5vcGVuR3JvdXBCeURlZmF1bHR8fG9wZW5Hcm91cENvdW50Pj1vcGVuR3JvdXBzTGltaXQpe25ld0dyb3VwLmlzT3Blbj1mYWxzZTt9ZWxzZSBpZignX19mb2xkJ2luIGdyb3VwKXtuZXdHcm91cC5pc09wZW49IWdyb3VwLl9fZm9sZDt9ZWxzZXtuZXdHcm91cC5pc09wZW49IXNlbGYubG9jYWxEYXRhW25ld0dyb3VwLnBhcmVudElEXS5wYXJlbnRJRDt9Cmxpc3QuZGF0YS5wdXNoKG5ld0dyb3VwLmlkKTtsaXN0LmNvdW50Kz1uZXdHcm91cC5jb3VudDtpZihuZXdHcm91cC5pc09wZW4mJm5ld0dyb3VwLmNvdW50PjApe29wZW5Hcm91cENvdW50Kys7aWYoZ3JvdXAuX19kYXRhKXtuZXdHcm91cC5fX2RhdGE9Z3JvdXAuX19kYXRhO30Kb3B0aW9ucz1fLmRlZmF1bHRzKHtlbmFibGVSZWxhdGlvbmFsRmV0Y2g6ZmFsc2V9LG9wdGlvbnMpO2RlZnMucHVzaChzZWxmLl9sb2FkKG5ld0dyb3VwLG9wdGlvbnMpKTt9fSk7aWYob3B0aW9ucy5rZWVwRW1wdHlHcm91cHMpe3ZhciBlbXB0eUdyb3Vwc0lEcz1fLmRpZmZlcmVuY2UoXy5wbHVjayhwcmV2aW91c0dyb3VwcywnaWQnKSxsaXN0LmRhdGEpO18uZWFjaChlbXB0eUdyb3Vwc0lEcyxmdW5jdGlvbihncm91cElEKXtsaXN0LmRhdGEucHVzaChncm91cElEKTt2YXIgZW1wdHlHcm91cD1zZWxmLmxvY2FsRGF0YVtncm91cElEXTtlbXB0eUdyb3VwLmFnZ3JlZ2F0ZVZhbHVlcz17fTt9KTt9CnJldHVybiBQcm9taXNlLmFsbChkZWZzKS50aGVuKGZ1bmN0aW9uKGdyb3Vwcyl7aWYoIW9wdGlvbnMub25seUdyb3Vwcyl7bGlzdC5yZXNfaWRzPV8uZmxhdHRlbihfLm1hcChncm91cHMsZnVuY3Rpb24oZ3JvdXApe3JldHVybiBncm91cD9ncm91cC5yZXNfaWRzOltdO30pKTt9CnJldHVybiBsaXN0O30pLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gUHJvbWlzZS5hbGwoW3NlbGYuX2ZldGNoWDJNYW55c1NpbmdsZUJhdGNoKGxpc3QpLHNlbGYuX2ZldGNoUmVmZXJlbmNlc1NpbmdsZUJhdGNoKGxpc3QpXSkudGhlbihmdW5jdGlvbigpe3JldHVybiBsaXN0O30pO30pO30pO30sX3JlYWRVbmdyb3VwZWRMaXN0OmZ1bmN0aW9uKGxpc3Qpe3ZhciBzZWxmPXRoaXM7dmFyIGRlZj1Qcm9taXNlLnJlc29sdmUoKTtsaXN0PXRoaXMuX2FwcGx5WDJNYW55T3BlcmF0aW9ucyhsaXN0KTtpZihsaXN0LnJlc19pZHMubGVuZ3RoPmxpc3QubGltaXQmJmxpc3Qub3JkZXJlZEJ5Lmxlbmd0aCl7aWYoIWxpc3Qub3JkZXJlZFJlc0lEcyl7dmFyIGZpZWxkTmFtZXM9Xy5wbHVjayhsaXN0Lm9yZGVyZWRCeSwnbmFtZScpO2RlZj10aGlzLl9yZWFkTWlzc2luZ0ZpZWxkcyhsaXN0LF8uZmlsdGVyKGxpc3QucmVzX2lkcyxfLmlzTnVtYmVyKSxmaWVsZE5hbWVzKTt9CmRlZi50aGVuKGZ1bmN0aW9uKCl7c2VsZi5fc29ydExpc3QobGlzdCk7fSk7fQpyZXR1cm4gZGVmLnRoZW4oZnVuY3Rpb24oKXt2YXIgcmVzSURzPVtdO3ZhciBjdXJyZW50UmVzSURzPWxpc3QucmVzX2lkcztpZihsaXN0Lm9yZGVyZWRSZXNJRHMpe2N1cnJlbnRSZXNJRHM9bGlzdC5vcmRlcmVkUmVzSURzLmZpbHRlcihmdW5jdGlvbihyZXNJRCl7cmV0dXJuIGxpc3QucmVzX2lkcy5pbmRleE9mKHJlc0lEKT49MDt9KTt9CnZhciBjdXJyZW50Q291bnQ9Y3VycmVudFJlc0lEcy5sZW5ndGg7dmFyIHVwcGVyQm91bmQ9bGlzdC5saW1pdD9NYXRoLm1pbihsaXN0Lm9mZnNldCtsaXN0LmxpbWl0LGN1cnJlbnRDb3VudCk6Y3VycmVudENvdW50O3ZhciBmaWVsZE5hbWVzPWxpc3QuZ2V0RmllbGROYW1lcygpO2Zvcih2YXIgaT1saXN0Lm9mZnNldDtpPHVwcGVyQm91bmQ7aSsrKXt2YXIgcmVzSWQ9Y3VycmVudFJlc0lEc1tpXTtpZihfLmlzTnVtYmVyKHJlc0lkKSl7cmVzSURzLnB1c2gocmVzSWQpO319CnJldHVybiBzZWxmLl9yZWFkTWlzc2luZ0ZpZWxkcyhsaXN0LHJlc0lEcyxmaWVsZE5hbWVzKS50aGVuKGZ1bmN0aW9uKCl7aWYobGlzdC5yZXNfaWRzLmxlbmd0aDw9bGlzdC5saW1pdCl7c2VsZi5fc29ydExpc3QobGlzdCk7fWVsc2V7c2VsZi5fc2V0RGF0YUluUmFuZ2UobGlzdCk7fQpyZXR1cm4gbGlzdDt9KTt9KTt9LF9yZWxvYWQ6ZnVuY3Rpb24oaWQsb3B0aW9ucyl7b3B0aW9ucz1vcHRpb25zfHx7fTt2YXIgZWxlbWVudD10aGlzLmxvY2FsRGF0YVtpZF07aWYoZWxlbWVudC50eXBlPT09J3JlY29yZCcpe2lmKCFvcHRpb25zLmN1cnJlbnRJZCYmKCgnY3VycmVudElkJ2luIG9wdGlvbnMpfHx0aGlzLmlzTmV3KGlkKSkpe3ZhciBwYXJhbXM9e2NvbnRleHQ6ZWxlbWVudC5jb250ZXh0LGZpZWxkc0luZm86ZWxlbWVudC5maWVsZHNJbmZvLGZpZWxkczplbGVtZW50LmZpZWxkcyx2aWV3VHlwZTplbGVtZW50LnZpZXdUeXBlLH07cmV0dXJuIHRoaXMuX21ha2VEZWZhdWx0UmVjb3JkKGVsZW1lbnQubW9kZWwscGFyYW1zKTt9CmlmKCFvcHRpb25zLmtlZXBDaGFuZ2VzKXt0aGlzLmRpc2NhcmRDaGFuZ2VzKGlkLHtyb2xsYmFjazpmYWxzZX0pO319ZWxzZSBpZihlbGVtZW50Ll9jaGFuZ2VzKXtkZWxldGUgZWxlbWVudC50ZW1wTGltaXRJbmNyZW1lbnQ7Xy5lYWNoKGVsZW1lbnQuX2NoYW5nZXMsZnVuY3Rpb24oY2hhbmdlKXtkZWxldGUgY2hhbmdlLmlzTmV3O30pO30KaWYob3B0aW9ucy5jb250ZXh0IT09dW5kZWZpbmVkKXtlbGVtZW50LmNvbnRleHQ9b3B0aW9ucy5jb250ZXh0O30KaWYob3B0aW9ucy5vcmRlcmVkQnkhPT11bmRlZmluZWQpe2VsZW1lbnQub3JkZXJlZEJ5PW9wdGlvbnMub3JkZXJlZEJ5fHxlbGVtZW50Lm9yZGVyZWRCeTt9CmlmKG9wdGlvbnMuZG9tYWluIT09dW5kZWZpbmVkKXtlbGVtZW50LmRvbWFpbj1vcHRpb25zLmRvbWFpbjt9CmlmKG9wdGlvbnMuZ3JvdXBCeSE9PXVuZGVmaW5lZCl7ZWxlbWVudC5ncm91cGVkQnk9b3B0aW9ucy5ncm91cEJ5O30KaWYob3B0aW9ucy5saW1pdCE9PXVuZGVmaW5lZCl7ZWxlbWVudC5saW1pdD1vcHRpb25zLmxpbWl0O30KaWYob3B0aW9ucy5vZmZzZXQhPT11bmRlZmluZWQpe3RoaXMuX3NldE9mZnNldChlbGVtZW50LmlkLG9wdGlvbnMub2Zmc2V0KTt9CmlmKG9wdGlvbnMuZ3JvdXBzTGltaXQhPT11bmRlZmluZWQpe2VsZW1lbnQuZ3JvdXBzTGltaXQ9b3B0aW9ucy5ncm91cHNMaW1pdDt9CmlmKG9wdGlvbnMuZ3JvdXBzT2Zmc2V0IT09dW5kZWZpbmVkKXtlbGVtZW50Lmdyb3Vwc09mZnNldD1vcHRpb25zLmdyb3Vwc09mZnNldDt9CmlmKG9wdGlvbnMubG9hZE1vcmVPZmZzZXQhPT11bmRlZmluZWQpe2VsZW1lbnQubG9hZE1vcmVPZmZzZXQ9b3B0aW9ucy5sb2FkTW9yZU9mZnNldDt9ZWxzZXtlbGVtZW50LmxvYWRNb3JlT2Zmc2V0PTA7fQppZihvcHRpb25zLmN1cnJlbnRJZCE9PXVuZGVmaW5lZCl7ZWxlbWVudC5yZXNfaWQ9b3B0aW9ucy5jdXJyZW50SWQ7fQppZihvcHRpb25zLmlkcyE9PXVuZGVmaW5lZCl7ZWxlbWVudC5yZXNfaWRzPW9wdGlvbnMuaWRzO2VsZW1lbnQuY291bnQ9ZWxlbWVudC5yZXNfaWRzLmxlbmd0aDt9CmlmKGVsZW1lbnQudHlwZT09PSdyZWNvcmQnKXtlbGVtZW50Lm9mZnNldD1fLmluZGV4T2YoZWxlbWVudC5yZXNfaWRzLGVsZW1lbnQucmVzX2lkKTt9CnZhciBsb2FkT3B0aW9ucz1fLnBpY2sob3B0aW9ucywnZmllbGROYW1lcycsJ3ZpZXdUeXBlJyk7cmV0dXJuIHRoaXMuX2xvYWQoZWxlbWVudCxsb2FkT3B0aW9ucykudGhlbihmdW5jdGlvbihyZXN1bHQpe3JldHVybiByZXN1bHQuaWQ7fSk7fSxfc2F2ZVNwZWNpYWxEYXRhQ2FjaGU6ZnVuY3Rpb24ocmVjb3JkLGZpZWxkTmFtZSx2YWx1ZSl7aWYoXy5pc0VxdWFsKHJlY29yZC5fc3BlY2lhbERhdGFDYWNoZVtmaWVsZE5hbWVdLHZhbHVlKSl7cmV0dXJuIGZhbHNlO30KcmVjb3JkLl9zcGVjaWFsRGF0YUNhY2hlW2ZpZWxkTmFtZV09dmFsdWU7cmV0dXJuIHRydWU7fSxfc2VhcmNoUmVhZFVuZ3JvdXBlZExpc3Q6ZnVuY3Rpb24obGlzdCl7dmFyIHNlbGY9dGhpczt2YXIgZmllbGROYW1lcz1saXN0LmdldEZpZWxkTmFtZXMoKTt2YXIgcHJvbTtpZihsaXN0Ll9fZGF0YSl7cHJvbT1Qcm9taXNlLnJlc29sdmUobGlzdC5fX2RhdGEpO31lbHNle3Byb209dGhpcy5fcnBjKHtyb3V0ZTonL3dlYi9kYXRhc2V0L3NlYXJjaF9yZWFkJyxtb2RlbDpsaXN0Lm1vZGVsLGZpZWxkczpmaWVsZE5hbWVzLGNvbnRleHQ6Xy5leHRlbmQoe30sbGlzdC5nZXRDb250ZXh0KCkse2Jpbl9zaXplOnRydWV9KSxkb21haW46bGlzdC5kb21haW58fFtdLGxpbWl0Omxpc3QubGltaXQsb2Zmc2V0Omxpc3QubG9hZE1vcmVPZmZzZXQrbGlzdC5vZmZzZXQsb3JkZXJCeTpsaXN0Lm9yZGVyZWRCeSx9KTt9CnJldHVybiBwcm9tLnRoZW4oZnVuY3Rpb24ocmVzdWx0KXtkZWxldGUgbGlzdC5fX2RhdGE7bGlzdC5jb3VudD1yZXN1bHQubGVuZ3RoO3ZhciBpZHM9Xy5wbHVjayhyZXN1bHQucmVjb3JkcywnaWQnKTt2YXIgZGF0YT1fLm1hcChyZXN1bHQucmVjb3JkcyxmdW5jdGlvbihyZWNvcmQpe3ZhciBkYXRhUG9pbnQ9c2VsZi5fbWFrZURhdGFQb2ludCh7Y29udGV4dDpsaXN0LmNvbnRleHQsZGF0YTpyZWNvcmQsZmllbGRzOmxpc3QuZmllbGRzLGZpZWxkc0luZm86bGlzdC5maWVsZHNJbmZvLG1vZGVsTmFtZTpsaXN0Lm1vZGVsLHBhcmVudElEOmxpc3QuaWQsdmlld1R5cGU6bGlzdC52aWV3VHlwZSx9KTtzZWxmLl9wYXJzZVNlcnZlckRhdGEoZmllbGROYW1lcyxkYXRhUG9pbnQsZGF0YVBvaW50LmRhdGEpO3JldHVybiBkYXRhUG9pbnQuaWQ7fSk7aWYobGlzdC5sb2FkTW9yZU9mZnNldCl7bGlzdC5kYXRhPWxpc3QuZGF0YS5jb25jYXQoZGF0YSk7bGlzdC5yZXNfaWRzPWxpc3QucmVzX2lkcy5jb25jYXQoaWRzKTt9ZWxzZXtsaXN0LmRhdGE9ZGF0YTtsaXN0LnJlc19pZHM9aWRzO30Kc2VsZi5fdXBkYXRlUGFyZW50UmVzSURzKGxpc3QpO3JldHVybiBsaXN0O30pO30sX3NldERhdGFJblJhbmdlOmZ1bmN0aW9uKGxpc3Qpe3ZhciBpZHNJblJhbmdlO2lmKGxpc3QubGltaXQpe2lkc0luUmFuZ2U9bGlzdC5yZXNfaWRzLnNsaWNlKGxpc3Qub2Zmc2V0LGxpc3Qub2Zmc2V0K2xpc3QubGltaXQpO31lbHNle2lkc0luUmFuZ2U9bGlzdC5yZXNfaWRzO30KbGlzdC5kYXRhPVtdO18uZWFjaChpZHNJblJhbmdlLGZ1bmN0aW9uKGlkKXtpZihsaXN0Ll9jYWNoZVtpZF0pe2xpc3QuZGF0YS5wdXNoKGxpc3QuX2NhY2hlW2lkXSk7fX0pO2lmKGxpc3QubGltaXQpe2Zvcih2YXIgaT1saXN0Lm9mZnNldCtsaXN0LmxpbWl0O2k8bGlzdC5yZXNfaWRzLmxlbmd0aDtpKyspe3ZhciBpZD1saXN0LnJlc19pZHNbaV07dmFyIGRhdGFQb2ludElEPWxpc3QuX2NhY2hlW2lkXTtpZihfLmZpbmRXaGVyZShsaXN0Ll9jaGFuZ2VzLHtpc05ldzp0cnVlLGlkOmRhdGFQb2ludElEfSkpe2xpc3QuZGF0YS5wdXNoKGRhdGFQb2ludElEKTt9ZWxzZXticmVhazt9fX19LF9zZXRPZmZzZXQ6ZnVuY3Rpb24oZWxlbWVudElkLG9mZnNldCl7dmFyIGVsZW1lbnQ9dGhpcy5sb2NhbERhdGFbZWxlbWVudElkXTtlbGVtZW50Lm9mZnNldD1vZmZzZXQ7aWYoZWxlbWVudC50eXBlPT09J3JlY29yZCcmJmVsZW1lbnQucmVzX2lkcy5sZW5ndGgpe2VsZW1lbnQucmVzX2lkPWVsZW1lbnQucmVzX2lkc1tvZmZzZXRdO319LF9zb3J0TGlzdDpmdW5jdGlvbihsaXN0KXtpZighbGlzdC5zdGF0aWMpe3JldHVybjt9CnZhciBzZWxmPXRoaXM7aWYobGlzdC5vcmRlcmVkUmVzSURzKXt2YXIgb3JkZXJlZFJlc0lEcz17fTtmb3IodmFyIGs9MDtrPGxpc3Qub3JkZXJlZFJlc0lEcy5sZW5ndGg7aysrKXtvcmRlcmVkUmVzSURzW2xpc3Qub3JkZXJlZFJlc0lEc1trXV09azt9CnV0aWxzLnN0YWJsZVNvcnQobGlzdC5yZXNfaWRzLGZ1bmN0aW9uIGNvbXBhcmVSZXNJZEluZGV4ZXMocmVzSWQxLHJlc0lkMil7aWYoIShyZXNJZDEgaW4gb3JkZXJlZFJlc0lEcykmJiEocmVzSWQyIGluIG9yZGVyZWRSZXNJRHMpKXtyZXR1cm4gMDt9CmlmKCEocmVzSWQxIGluIG9yZGVyZWRSZXNJRHMpKXtyZXR1cm4gSW5maW5pdHk7fQppZighKHJlc0lkMiBpbiBvcmRlcmVkUmVzSURzKSl7cmV0dXJuLUluZmluaXR5O30KcmV0dXJuIG9yZGVyZWRSZXNJRHNbcmVzSWQxXS1vcmRlcmVkUmVzSURzW3Jlc0lkMl07fSk7fWVsc2UgaWYobGlzdC5vcmRlcmVkQnkubGVuZ3RoKXt2YXIgY29tcGFyZVJlY29yZHM9ZnVuY3Rpb24ocmVzSWQxLHJlc0lkMixsZXZlbCl7aWYoIWxldmVsKXtsZXZlbD0wO30KaWYobGlzdC5vcmRlcmVkQnkubGVuZ3RoPGxldmVsKzEpe3JldHVybiAwO30KdmFyIG9yZGVyPWxpc3Qub3JkZXJlZEJ5W2xldmVsXTt2YXIgcmVjb3JkMUlEPWxpc3QuX2NhY2hlW3Jlc0lkMV07dmFyIHJlY29yZDJJRD1saXN0Ll9jYWNoZVtyZXNJZDJdO2lmKCFyZWNvcmQxSUQmJiFyZWNvcmQySUQpe3JldHVybiAwO30KaWYoIXJlY29yZDFJRCl7cmV0dXJuIEluZmluaXR5O30KaWYoIXJlY29yZDJJRCl7cmV0dXJuLUluZmluaXR5O30KdmFyIHIxPXNlbGYubG9jYWxEYXRhW3JlY29yZDFJRF07dmFyIHIyPXNlbGYubG9jYWxEYXRhW3JlY29yZDJJRF07dmFyIGRhdGExPV8uZXh0ZW5kKHt9LHIxLmRhdGEscjEuX2NoYW5nZXMpO3ZhciBkYXRhMj1fLmV4dGVuZCh7fSxyMi5kYXRhLHIyLl9jaGFuZ2VzKTt2YXIgb3JkZXJEYXRhMT1kYXRhMVtvcmRlci5uYW1lXTt2YXIgb3JkZXJEYXRhMj1kYXRhMltvcmRlci5uYW1lXTtpZihsaXN0LmZpZWxkc1tvcmRlci5uYW1lXS50eXBlPT09J21hbnkyb25lJyl7b3JkZXJEYXRhMT1vcmRlckRhdGExP3NlbGYubG9jYWxEYXRhW29yZGVyRGF0YTFdLmRhdGEuZGlzcGxheV9uYW1lOiIiO29yZGVyRGF0YTI9b3JkZXJEYXRhMj9zZWxmLmxvY2FsRGF0YVtvcmRlckRhdGEyXS5kYXRhLmRpc3BsYXlfbmFtZToiIjt9CmlmKG9yZGVyRGF0YTE8b3JkZXJEYXRhMil7cmV0dXJuIG9yZGVyLmFzYz8tMToxO30KaWYob3JkZXJEYXRhMT5vcmRlckRhdGEyKXtyZXR1cm4gb3JkZXIuYXNjPzE6LTE7fQpyZXR1cm4gY29tcGFyZVJlY29yZHMocmVzSWQxLHJlc0lkMixsZXZlbCsxKTt9O3V0aWxzLnN0YWJsZVNvcnQobGlzdC5yZXNfaWRzLGNvbXBhcmVSZWNvcmRzKTt9CnRoaXMuX3NldERhdGFJblJhbmdlKGxpc3QpO30sX3VwZGF0ZVBhcmVudFJlc0lEczpmdW5jdGlvbihlbGVtZW50KXt2YXIgc2VsZj10aGlzO2lmKGVsZW1lbnQucGFyZW50SUQpe3ZhciBwYXJlbnQ9dGhpcy5sb2NhbERhdGFbZWxlbWVudC5wYXJlbnRJRF07cGFyZW50LnJlc19pZHM9Xy5mbGF0dGVuKF8ubWFwKHBhcmVudC5kYXRhLGZ1bmN0aW9uKGRhdGFQb2ludElEKXtyZXR1cm4gc2VsZi5sb2NhbERhdGFbZGF0YVBvaW50SURdLnJlc19pZHM7fSkpO3RoaXMuX3VwZGF0ZVBhcmVudFJlc0lEcyhwYXJlbnQpO319LF91cGRhdGVSZWNvcmRzRGF0YTpmdW5jdGlvbihyZWNvcmRzLGZpZWxkTmFtZSx2YWx1ZXMpe2lmKCFyZWNvcmRzLmxlbmd0aHx8IXZhbHVlcyl7cmV0dXJuO30KdmFyIHNlbGY9dGhpczt2YXIgZmllbGQ9cmVjb3Jkc1swXS5maWVsZHNbZmllbGROYW1lXTt2YXIgZmllbGRJbmZvPXJlY29yZHNbMF0uZmllbGRzSW5mb1tyZWNvcmRzWzBdLnZpZXdUeXBlXVtmaWVsZE5hbWVdO3ZhciB2aWV3PWZpZWxkSW5mby52aWV3cyYmZmllbGRJbmZvLnZpZXdzW2ZpZWxkSW5mby5tb2RlXTt2YXIgZmllbGRzSW5mbz12aWV3P3ZpZXcuZmllbGRzSW5mbzpmaWVsZEluZm8uZmllbGRzSW5mbzt2YXIgZmllbGRzPXZpZXc/dmlldy5maWVsZHM6ZmllbGRJbmZvLnJlbGF0ZWRGaWVsZHM7dmFyIHZpZXdUeXBlPXZpZXc/dmlldy50eXBlOmZpZWxkSW5mby52aWV3VHlwZTtfLmVhY2gocmVjb3JkcyxmdW5jdGlvbihyZWNvcmQpe3ZhciB4Mm1MaXN0PXNlbGYubG9jYWxEYXRhW3JlY29yZC5kYXRhW2ZpZWxkTmFtZV1dO3gybUxpc3QuZGF0YT1bXTtfLmVhY2goeDJtTGlzdC5yZXNfaWRzLGZ1bmN0aW9uKHJlc19pZCl7dmFyIGRhdGFQb2ludD1zZWxmLl9tYWtlRGF0YVBvaW50KHttb2RlbE5hbWU6ZmllbGQucmVsYXRpb24sZGF0YTpfLmZpbmRXaGVyZSh2YWx1ZXMse2lkOnJlc19pZH0pLGZpZWxkczpmaWVsZHMsZmllbGRzSW5mbzpmaWVsZHNJbmZvLHBhcmVudElEOngybUxpc3QuaWQsdmlld1R5cGU6dmlld1R5cGUsfSk7eDJtTGlzdC5kYXRhLnB1c2goZGF0YVBvaW50LmlkKTt4Mm1MaXN0Ll9jYWNoZVtyZXNfaWRdPWRhdGFQb2ludC5pZDt9KTt9KTt9LF92aXNpdENoaWxkcmVuOmZ1bmN0aW9uKGVsZW1lbnQsZm4pe3ZhciBzZWxmPXRoaXM7Zm4oZWxlbWVudCk7aWYoZWxlbWVudC50eXBlPT09J3JlY29yZCcpe2Zvcih2YXIgZmllbGROYW1lIGluIGVsZW1lbnQuZGF0YSl7dmFyIGZpZWxkPWVsZW1lbnQuZmllbGRzW2ZpZWxkTmFtZV07aWYoIWZpZWxkKXtjb250aW51ZTt9CmlmKF8uY29udGFpbnMoWydvbmUybWFueScsJ21hbnkyb25lJywnbWFueTJtYW55J10sZmllbGQudHlwZSkpe3ZhciBoYXNDaGFuZ2U9ZWxlbWVudC5fY2hhbmdlcyYmZmllbGROYW1lIGluIGVsZW1lbnQuX2NoYW5nZXM7dmFyIHZhbHVlPWhhc0NoYW5nZT9lbGVtZW50Ll9jaGFuZ2VzW2ZpZWxkTmFtZV06ZWxlbWVudC5kYXRhW2ZpZWxkTmFtZV07dmFyIHJlbGF0aW9uYWxFbGVtZW50PXRoaXMubG9jYWxEYXRhW3ZhbHVlXTtpZihyZWxhdGlvbmFsRWxlbWVudCl7c2VsZi5fdmlzaXRDaGlsZHJlbihyZWxhdGlvbmFsRWxlbWVudCxmbik7fX19fQppZihlbGVtZW50LnR5cGU9PT0nbGlzdCcpe2VsZW1lbnQ9dGhpcy5fYXBwbHlYMk1hbnlPcGVyYXRpb25zKGVsZW1lbnQpO18uZWFjaChlbGVtZW50LmRhdGEsZnVuY3Rpb24oZWxlbUlkKXt2YXIgZWxlbT1zZWxmLmxvY2FsRGF0YVtlbGVtSWRdO3NlbGYuX3Zpc2l0Q2hpbGRyZW4oZWxlbSxmbik7fSk7fX0sfSk7cmV0dXJuIEJhc2ljTW9kZWw7fSk7OwoKLyogL3dlYi9zdGF0aWMvc3JjL2pzL3ZpZXdzL2Jhc2ljL2Jhc2ljX3ZpZXcuanMgZGVmaW5lZCBpbiBidW5kbGUgJ3dlYi5hc3NldHNfYmFja2VuZCcgKi8Kb2Rvby5kZWZpbmUoJ3dlYi5CYXNpY1ZpZXcnLGZ1bmN0aW9uKHJlcXVpcmUpeyJ1c2Ugc3RyaWN0Ijt2YXIgQWJzdHJhY3RWaWV3PXJlcXVpcmUoJ3dlYi5BYnN0cmFjdFZpZXcnKTt2YXIgQmFzaWNDb250cm9sbGVyPXJlcXVpcmUoJ3dlYi5CYXNpY0NvbnRyb2xsZXInKTt2YXIgQmFzaWNNb2RlbD1yZXF1aXJlKCd3ZWIuQmFzaWNNb2RlbCcpO3ZhciBjb25maWc9cmVxdWlyZSgnd2ViLmNvbmZpZycpO3ZhciBmaWVsZFJlZ2lzdHJ5PXJlcXVpcmUoJ3dlYi5maWVsZF9yZWdpc3RyeScpO3ZhciBweVV0aWxzPXJlcXVpcmUoJ3dlYi5weV91dGlscycpO3ZhciB1dGlscz1yZXF1aXJlKCd3ZWIudXRpbHMnKTt2YXIgQmFzaWNWaWV3PUFic3RyYWN0Vmlldy5leHRlbmQoe2NvbmZpZzpfLmV4dGVuZCh7fSxBYnN0cmFjdFZpZXcucHJvdG90eXBlLmNvbmZpZyx7TW9kZWw6QmFzaWNNb2RlbCxDb250cm9sbGVyOkJhc2ljQ29udHJvbGxlcix9KSx2aWV3VHlwZTp1bmRlZmluZWQsaW5pdDpmdW5jdGlvbih2aWV3SW5mbyxwYXJhbXMpe3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLmZpZWxkc0luZm89e307dGhpcy5maWVsZHNJbmZvW3RoaXMudmlld1R5cGVdPXRoaXMuZmllbGRzVmlldy5maWVsZHNJbmZvW3RoaXMudmlld1R5cGVdO3RoaXMucmVuZGVyZXJQYXJhbXMudmlld1R5cGU9dGhpcy52aWV3VHlwZTt0aGlzLmNvbnRyb2xsZXJQYXJhbXMuY29uZmlybU9uRGVsZXRlPXRydWU7dGhpcy5jb250cm9sbGVyUGFyYW1zLmFyY2hpdmVFbmFibGVkPSdhY3RpdmUnaW4gdGhpcy5maWVsZHM7dGhpcy5jb250cm9sbGVyUGFyYW1zLmhhc0J1dHRvbnM9J2FjdGlvbl9idXR0b25zJ2luIHBhcmFtcz9wYXJhbXMuYWN0aW9uX2J1dHRvbnM6dHJ1ZTt0aGlzLmNvbnRyb2xsZXJQYXJhbXMudmlld0lkPXZpZXdJbmZvLnZpZXdfaWQ7dGhpcy5sb2FkUGFyYW1zLmZpZWxkc0luZm89dGhpcy5maWVsZHNJbmZvO3RoaXMubG9hZFBhcmFtcy5maWVsZHM9dGhpcy5maWVsZHM7dGhpcy5sb2FkUGFyYW1zLmxpbWl0PXBhcnNlSW50KHRoaXMuYXJjaC5hdHRycy5saW1pdCwxMCl8fHBhcmFtcy5saW1pdDt0aGlzLmxvYWRQYXJhbXMucGFyZW50SUQ9cGFyYW1zLnBhcmVudElEO3RoaXMubG9hZFBhcmFtcy52aWV3VHlwZT10aGlzLnZpZXdUeXBlO3RoaXMucmVjb3JkSUQ9cGFyYW1zLnJlY29yZElEO3RoaXMubW9kZWw9cGFyYW1zLm1vZGVsO30sX2dldEZpZWxkV2lkZ2V0Q2xhc3M6ZnVuY3Rpb24odmlld1R5cGUsZmllbGQsYXR0cnMpe3ZhciBGaWVsZFdpZGdldDtpZihhdHRycy53aWRnZXQpe0ZpZWxkV2lkZ2V0PWZpZWxkUmVnaXN0cnkuZ2V0QW55KFt2aWV3VHlwZSsiLiIrYXR0cnMud2lkZ2V0LGF0dHJzLndpZGdldF0pO2lmKCFGaWVsZFdpZGdldCl7Y29uc29sZS53YXJuKCJNaXNzaW5nIHdpZGdldDogIixhdHRycy53aWRnZXQsIiBmb3IgZmllbGQiLGF0dHJzLm5hbWUsIm9mIHR5cGUiLGZpZWxkLnR5cGUpO319ZWxzZSBpZih2aWV3VHlwZT09PSdrYW5iYW4nJiZmaWVsZC50eXBlPT09J21hbnkybWFueScpe0ZpZWxkV2lkZ2V0PWZpZWxkUmVnaXN0cnkuZ2V0KCdrYW5iYW4ubWFueTJtYW55X3RhZ3MnKTt9CnJldHVybiBGaWVsZFdpZGdldHx8ZmllbGRSZWdpc3RyeS5nZXRBbnkoW3ZpZXdUeXBlKyIuIitmaWVsZC50eXBlLGZpZWxkLnR5cGUsImFic3RyYWN0Il0pO30sX2xvYWREYXRhOmZ1bmN0aW9uKG1vZGVsKXtpZih0aGlzLnJlY29yZElEKXttb2RlbC5hZGRGaWVsZHNJbmZvKHRoaXMucmVjb3JkSUQse2ZpZWxkczp0aGlzLmZpZWxkcyxmaWVsZHNJbmZvOnRoaXMuZmllbGRzSW5mbyx9KTt2YXIgcmVjb3JkPW1vZGVsLmdldCh0aGlzLnJlY29yZElEKTt2YXIgdmlld1R5cGU9dGhpcy52aWV3VHlwZTt2YXIgdmlld0ZpZWxkcz1PYmplY3Qua2V5cyhyZWNvcmQuZmllbGRzSW5mb1t2aWV3VHlwZV0pO3ZhciBmaWVsZE5hbWVzPV8uZGlmZmVyZW5jZSh2aWV3RmllbGRzLE9iamVjdC5rZXlzKHJlY29yZC5kYXRhKSk7dmFyIGZpZWxkc0luZm89cmVjb3JkLmZpZWxkc0luZm9bdmlld1R5cGVdO18uZWFjaCh2aWV3RmllbGRzLGZ1bmN0aW9uKG5hbWUpe2lmKCFfLmNvbnRhaW5zKGZpZWxkTmFtZXMsbmFtZSkpe3ZhciBmaWVsZFR5cGU9cmVjb3JkLmZpZWxkc1tuYW1lXS50eXBlO3ZhciBmaWVsZEluZm89ZmllbGRzSW5mb1tuYW1lXTtpZihmaWVsZEluZm8uV2lkZ2V0KXt2YXIgcmVxdWlyZXNTcGVjaWFsRGF0YT1maWVsZEluZm8uV2lkZ2V0LnByb3RvdHlwZS5zcGVjaWFsRGF0YTtpZihyZXF1aXJlc1NwZWNpYWxEYXRhJiYhKG5hbWUgaW4gcmVjb3JkLnNwZWNpYWxEYXRhKSl7ZmllbGROYW1lcy5wdXNoKG5hbWUpO3JldHVybjt9fQppZigoZmllbGRUeXBlPT09J29uZTJtYW55J3x8ZmllbGRUeXBlPT09J21hbnkybWFueScpKXtpZighKCdmaWVsZHNJbmZvJ2luIHJlY29yZC5kYXRhW25hbWVdKSl7ZmllbGROYW1lcy5wdXNoKG5hbWUpO31lbHNle3ZhciBmaWVsZFZpZXdzPWZpZWxkSW5mby52aWV3c3x8ZmllbGRJbmZvLmZpZWxkc0luZm98fHt9O3ZhciBmaWVsZFZpZXdUeXBlcz1PYmplY3Qua2V5cyhmaWVsZFZpZXdzKTt2YXIgcmVjb3JkVmlld1R5cGVzPU9iamVjdC5rZXlzKHJlY29yZC5kYXRhW25hbWVdLmZpZWxkc0luZm8pO2lmKF8uZGlmZmVyZW5jZShmaWVsZFZpZXdUeXBlcyxyZWNvcmRWaWV3VHlwZXMpLmxlbmd0aCl7ZmllbGROYW1lcy5wdXNoKG5hbWUpO30KaWYocmVjb3JkLmRhdGFbbmFtZV0udmlld1R5cGU9PT0nZGVmYXVsdCcpe3ZhciBkZWZhdWx0RmllbGRJbmZvPXJlY29yZC5kYXRhW25hbWVdLmZpZWxkc0luZm8uZGVmYXVsdDtfLmVhY2goZmllbGRWaWV3cyxmdW5jdGlvbihmaWVsZFZpZXcpe18uZWFjaChmaWVsZFZpZXcuZmllbGRzSW5mbyxmdW5jdGlvbih4Mm1GaWVsZEluZm8pe18uZGVmYXVsdHMoeDJtRmllbGRJbmZvLGRlZmF1bHRGaWVsZEluZm8pO30pO30pO319fQppZihmaWVsZFR5cGU9PT0nbWFueTJvbmUnKXtpZihKU09OLnN0cmluZ2lmeShyZWNvcmQuZGF0YVtuYW1lXS5jb250ZXh0KSE9PUpTT04uc3RyaW5naWZ5KGZpZWxkSW5mby5jb250ZXh0KSl7ZmllbGROYW1lcy5wdXNoKG5hbWUpO319fX0pO3ZhciBkZWY7aWYoZmllbGROYW1lcy5sZW5ndGgpe2RlZj1tb2RlbC5hcHBseVJhd0NoYW5nZXMocmVjb3JkLmlkLHZpZXdUeXBlKS50aGVuKGZ1bmN0aW9uKCl7aWYobW9kZWwuaXNOZXcocmVjb3JkLmlkKSl7cmV0dXJuIG1vZGVsLmFwcGx5RGVmYXVsdFZhbHVlcyhyZWNvcmQuaWQse30se2ZpZWxkTmFtZXM6ZmllbGROYW1lcyx2aWV3VHlwZTp2aWV3VHlwZSx9KTt9ZWxzZXtyZXR1cm4gbW9kZWwucmVsb2FkKHJlY29yZC5pZCx7ZmllbGROYW1lczpmaWVsZE5hbWVzLGtlZXBDaGFuZ2VzOnRydWUsdmlld1R5cGU6dmlld1R5cGUsfSk7fX0pO30KcmV0dXJuIFByb21pc2UucmVzb2x2ZShkZWYpLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gbW9kZWwuZ2V0KHJlY29yZC5pZCk7fSk7fQpyZXR1cm4gdGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO30sX3Byb2Nlc3NBcmNoOmZ1bmN0aW9uKGFyY2gsZnYpe3ZhciBzZWxmPXRoaXM7dXRpbHMudHJhdmVyc2UoYXJjaCxmdW5jdGlvbihub2RlKXtyZXR1cm4gc2VsZi5fcHJvY2Vzc05vZGUobm9kZSxmdik7fSk7fSxfcHJvY2Vzc0ZpZWxkOmZ1bmN0aW9uKHZpZXdUeXBlLGZpZWxkLGF0dHJzKXt2YXIgc2VsZj10aGlzO2F0dHJzLldpZGdldD10aGlzLl9nZXRGaWVsZFdpZGdldENsYXNzKHZpZXdUeXBlLGZpZWxkLGF0dHJzKTtfLmVhY2goYXR0cnMsZnVuY3Rpb24odmFsdWUsa2V5KXt2YXIgc3BsaXRLZXk9a2V5LnNwbGl0KCctJyk7aWYoc3BsaXRLZXlbMF09PT0nZGVjb3JhdGlvbicpe2F0dHJzLmRlY29yYXRpb25zPWF0dHJzLmRlY29yYXRpb25zfHxbXTthdHRycy5kZWNvcmF0aW9ucy5wdXNoKHtjbGFzc05hbWU6J3RleHQtJytzcGxpdEtleVsxXSxleHByZXNzaW9uOnB5VXRpbHMuX2dldFB5SlNBU1QodmFsdWUpLH0pO319KTtpZighXy5pc09iamVjdChhdHRycy5vcHRpb25zKSl7YXR0cnMub3B0aW9ucz1hdHRycy5vcHRpb25zP3B5VXRpbHMucHlfZXZhbChhdHRycy5vcHRpb25zKTp7fTt9CmlmKGF0dHJzLm9uX2NoYW5nZSYmYXR0cnMub25fY2hhbmdlIT09IjAiJiYhZmllbGQub25DaGFuZ2Upe2ZpZWxkLm9uQ2hhbmdlPSIxIjt9CmlmKGF0dHJzLm1vZGlmaWVycy5pbnZpc2libGU9PT10cnVlfHxhdHRycy5tb2RpZmllcnMuY29sdW1uX2ludmlzaWJsZT09PXRydWUpe2F0dHJzLl9fbm9fZmV0Y2g9dHJ1ZTt9CmlmKCFfLmlzRW1wdHkoZmllbGQudmlld3MpKXthdHRycy52aWV3cz17fTtfLmVhY2goZmllbGQudmlld3MsZnVuY3Rpb24oaW5uZXJGaWVsZHNWaWV3LHZpZXdUeXBlKXt2aWV3VHlwZT12aWV3VHlwZT09PSd0cmVlJz8nbGlzdCc6dmlld1R5cGU7YXR0cnMudmlld3Nbdmlld1R5cGVdPXNlbGYuX3Byb2Nlc3NGaWVsZHNWaWV3KGlubmVyRmllbGRzVmlldyx2aWV3VHlwZSk7fSk7fQphdHRycy52aWV3cz1hdHRycy52aWV3c3x8e307YXR0cnMubW9kZT1hdHRycy5tb2RlPT09J3RyZWUnPydsaXN0JzphdHRycy5tb2RlO2lmKCFhdHRycy52aWV3cy5saXN0JiZhdHRycy52aWV3cy50cmVlKXthdHRycy52aWV3cy5saXN0PWF0dHJzLnZpZXdzLnRyZWU7fQppZihmaWVsZC50eXBlPT09J29uZTJtYW55J3x8ZmllbGQudHlwZT09PSdtYW55Mm1hbnknKXtpZihhdHRycy5XaWRnZXQucHJvdG90eXBlLnVzZVN1YnZpZXcpe3ZhciBtb2RlPWF0dHJzLm1vZGU7aWYoIW1vZGUpe2lmKGF0dHJzLnZpZXdzLmxpc3QmJiFhdHRycy52aWV3cy5rYW5iYW4pe21vZGU9J2xpc3QnO31lbHNlIGlmKCFhdHRycy52aWV3cy5saXN0JiZhdHRycy52aWV3cy5rYW5iYW4pe21vZGU9J2thbmJhbic7fWVsc2V7bW9kZT0nbGlzdCxrYW5iYW4nO319CmlmKG1vZGUuaW5kZXhPZignLCcpIT09LTEpe21vZGU9Y29uZmlnLmRldmljZS5pc01vYmlsZT8na2FuYmFuJzonbGlzdCc7fQphdHRycy5tb2RlPW1vZGU7aWYobW9kZSBpbiBhdHRycy52aWV3cyl7dmFyIHZpZXc9YXR0cnMudmlld3NbbW9kZV07dGhpcy5fcHJvY2Vzc1N1YlZpZXdBdHRycyh2aWV3LGF0dHJzKTt9fQppZihhdHRycy5XaWRnZXQucHJvdG90eXBlLmZpZWxkc1RvRmV0Y2gpe2F0dHJzLnZpZXdUeXBlPSdkZWZhdWx0JzthdHRycy5yZWxhdGVkRmllbGRzPV8uZXh0ZW5kKHt9LGF0dHJzLldpZGdldC5wcm90b3R5cGUuZmllbGRzVG9GZXRjaCk7YXR0cnMuZmllbGRzSW5mbz17ZGVmYXVsdDpfLm1hcE9iamVjdChhdHRycy5XaWRnZXQucHJvdG90eXBlLmZpZWxkc1RvRmV0Y2gsZnVuY3Rpb24oKXtyZXR1cm57fTt9KSx9O2lmKGF0dHJzLm9wdGlvbnMuY29sb3JfZmllbGQpe2F0dHJzLnJlbGF0ZWRGaWVsZHNbYXR0cnMub3B0aW9ucy5jb2xvcl9maWVsZF09e3R5cGU6J2ludGVnZXInfTthdHRycy5maWVsZHNJbmZvLmRlZmF1bHRbYXR0cnMub3B0aW9ucy5jb2xvcl9maWVsZF09e307fX19CmlmKGF0dHJzLldpZGdldC5wcm90b3R5cGUuZmllbGREZXBlbmRlbmNpZXMpe2F0dHJzLmZpZWxkRGVwZW5kZW5jaWVzPWF0dHJzLldpZGdldC5wcm90b3R5cGUuZmllbGREZXBlbmRlbmNpZXM7fQpyZXR1cm4gYXR0cnM7fSxfcHJvY2Vzc0ZpZWxkc1ZpZXc6ZnVuY3Rpb24oZmllbGRzVmlldyx2aWV3VHlwZSl7dmFyIGZ2PXRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt2aWV3VHlwZT12aWV3VHlwZXx8dGhpcy52aWV3VHlwZTtmdi50eXBlPXZpZXdUeXBlO2Z2LmZpZWxkc0luZm89T2JqZWN0LmNyZWF0ZShudWxsKTtmdi5maWVsZHNJbmZvW3ZpZXdUeXBlXT1PYmplY3QuY3JlYXRlKG51bGwpO3RoaXMuX3Byb2Nlc3NBcmNoKGZ2LmFyY2gsZnYpO3JldHVybiBmdjt9LF9wcm9jZXNzTm9kZTpmdW5jdGlvbihub2RlLGZ2KXtpZih0eXBlb2Ygbm9kZT09PSdzdHJpbmcnKXtyZXR1cm4gZmFsc2U7fQppZighXy5pc09iamVjdChub2RlLmF0dHJzLm1vZGlmaWVycykpe25vZGUuYXR0cnMubW9kaWZpZXJzPW5vZGUuYXR0cnMubW9kaWZpZXJzP0pTT04ucGFyc2Uobm9kZS5hdHRycy5tb2RpZmllcnMpOnt9O30KaWYoIV8uaXNPYmplY3Qobm9kZS5hdHRycy5vcHRpb25zKSYmbm9kZS50YWc9PT0nYnV0dG9uJyl7bm9kZS5hdHRycy5vcHRpb25zPW5vZGUuYXR0cnMub3B0aW9ucz9KU09OLnBhcnNlKG5vZGUuYXR0cnMub3B0aW9ucyk6e307fQppZihub2RlLnRhZz09PSdmaWVsZCcpe3ZhciB2aWV3VHlwZT1mdi50eXBlO3ZhciBmaWVsZHNJbmZvPWZ2LmZpZWxkc0luZm9bdmlld1R5cGVdO3ZhciBmaWVsZHM9ZnYudmlld0ZpZWxkcztmaWVsZHNJbmZvW25vZGUuYXR0cnMubmFtZV09dGhpcy5fcHJvY2Vzc0ZpZWxkKHZpZXdUeXBlLGZpZWxkc1tub2RlLmF0dHJzLm5hbWVdLG5vZGUuYXR0cnM/Xy5jbG9uZShub2RlLmF0dHJzKTp7fSk7aWYoZmllbGRzSW5mb1tub2RlLmF0dHJzLm5hbWVdLmZpZWxkRGVwZW5kZW5jaWVzKXt2YXIgZGVwcz1maWVsZHNJbmZvW25vZGUuYXR0cnMubmFtZV0uZmllbGREZXBlbmRlbmNpZXM7Zm9yKHZhciBkZXBlbmRlbmN5X25hbWUgaW4gZGVwcyl7dmFyIGRlcGVuZGVuY3lfZGljdD17bmFtZTpkZXBlbmRlbmN5X25hbWUsdHlwZTpkZXBzW2RlcGVuZGVuY3lfbmFtZV0udHlwZX07aWYoIShkZXBlbmRlbmN5X25hbWUgaW4gZmllbGRzSW5mbykpe2ZpZWxkc0luZm9bZGVwZW5kZW5jeV9uYW1lXT1fLmV4dGVuZCh7fSxkZXBlbmRlbmN5X2RpY3Qse29wdGlvbnM6ZGVwc1tkZXBlbmRlbmN5X25hbWVdLm9wdGlvbnN8fHt9LH0pO30KaWYoIShkZXBlbmRlbmN5X25hbWUgaW4gZmllbGRzKSl7ZmllbGRzW2RlcGVuZGVuY3lfbmFtZV09ZGVwZW5kZW5jeV9kaWN0O30KaWYoZnYuZmllbGRzJiYhKGRlcGVuZGVuY3lfbmFtZSBpbiBmdi5maWVsZHMpKXtmdi5maWVsZHNbZGVwZW5kZW5jeV9uYW1lXT1kZXBlbmRlbmN5X2RpY3Q7fX19CnJldHVybiBmYWxzZTt9CnJldHVybiBub2RlLnRhZyE9PSdhcmNoJzt9LF9wcm9jZXNzU3ViVmlld0F0dHJzOmZ1bmN0aW9uKHZpZXcsYXR0cnMpe3ZhciBkZWZhdWx0T3JkZXI9dmlldy5hcmNoLmF0dHJzLmRlZmF1bHRfb3JkZXI7aWYoZGVmYXVsdE9yZGVyKXthdHRycy5vcmRlcmVkQnk9Xy5tYXAoZGVmYXVsdE9yZGVyLnNwbGl0KCcsJyksZnVuY3Rpb24ob3JkZXIpe29yZGVyPW9yZGVyLnRyaW0oKS5zcGxpdCgnICcpO3JldHVybntuYW1lOm9yZGVyWzBdLGFzYzpvcmRlclsxXSE9PSdkZXNjJ307fSk7fWVsc2V7dmFyIGhhbmRsZUZpZWxkPV8uZmluZCh2aWV3LmFyY2guY2hpbGRyZW4sZnVuY3Rpb24oY2hpbGQpe3JldHVybiBjaGlsZC5hdHRycyYmY2hpbGQuYXR0cnMud2lkZ2V0PT09J2hhbmRsZSc7fSk7aWYoaGFuZGxlRmllbGQpe2F0dHJzLm9yZGVyZWRCeT1be25hbWU6aGFuZGxlRmllbGQuYXR0cnMubmFtZSxhc2M6dHJ1ZX1dO319CmF0dHJzLmNvbHVtbkludmlzaWJsZUZpZWxkcz17fTtfLmVhY2godmlldy5hcmNoLmNoaWxkcmVuLGZ1bmN0aW9uKGNoaWxkKXtpZihjaGlsZC5hdHRycyYmY2hpbGQuYXR0cnMubW9kaWZpZXJzKXthdHRycy5jb2x1bW5JbnZpc2libGVGaWVsZHNbY2hpbGQuYXR0cnMubmFtZV09Y2hpbGQuYXR0cnMubW9kaWZpZXJzLmNvbHVtbl9pbnZpc2libGV8fGZhbHNlO319KTt9LH0pO3JldHVybiBCYXNpY1ZpZXc7fSk7OwoKLyogL3dlYi9zdGF0aWMvc3JjL2pzL3ZpZXdzL2Jhc2ljL2Jhc2ljX2NvbnRyb2xsZXIuanMgZGVmaW5lZCBpbiBidW5kbGUgJ3dlYi5hc3NldHNfYmFja2VuZCcgKi8Kb2Rvby5kZWZpbmUoJ3dlYi5CYXNpY0NvbnRyb2xsZXInLGZ1bmN0aW9uKHJlcXVpcmUpeyJ1c2Ugc3RyaWN0Ijt2YXIgQWJzdHJhY3RDb250cm9sbGVyPXJlcXVpcmUoJ3dlYi5BYnN0cmFjdENvbnRyb2xsZXInKTt2YXIgY29yZT1yZXF1aXJlKCd3ZWIuY29yZScpO3ZhciBEaWFsb2c9cmVxdWlyZSgnd2ViLkRpYWxvZycpO3ZhciBGaWVsZE1hbmFnZXJNaXhpbj1yZXF1aXJlKCd3ZWIuRmllbGRNYW5hZ2VyTWl4aW4nKTt2YXIgUGFnZXI9cmVxdWlyZSgnd2ViLlBhZ2VyJyk7dmFyIFRyYW5zbGF0aW9uRGlhbG9nPXJlcXVpcmUoJ3dlYi5UcmFuc2xhdGlvbkRpYWxvZycpO3ZhciBfdD1jb3JlLl90O3ZhciBCYXNpY0NvbnRyb2xsZXI9QWJzdHJhY3RDb250cm9sbGVyLmV4dGVuZChGaWVsZE1hbmFnZXJNaXhpbix7Y3VzdG9tX2V2ZW50czpfLmV4dGVuZCh7fSxBYnN0cmFjdENvbnRyb2xsZXIucHJvdG90eXBlLmN1c3RvbV9ldmVudHMsRmllbGRNYW5hZ2VyTWl4aW4uY3VzdG9tX2V2ZW50cyx7ZGlzY2FyZF9jaGFuZ2VzOidfb25EaXNjYXJkQ2hhbmdlcycscmVsb2FkOidfb25SZWxvYWQnLHJlc2VxdWVuY2VfcmVjb3JkczonX29uUmVzZXF1ZW5jZVJlY29yZHMnLHNldF9kaXJ0eTonX29uU2V0RGlydHknLGxvYWRfb3B0aW9uYWxfZmllbGRzOidfb25Mb2FkT3B0aW9uYWxGaWVsZHMnLHNhdmVfb3B0aW9uYWxfZmllbGRzOidfb25TYXZlT3B0aW9uYWxGaWVsZHMnLHNpZGViYXJfZGF0YV9hc2tlZDonX29uU2lkZWJhckRhdGFBc2tlZCcsdHJhbnNsYXRlOidfb25UcmFuc2xhdGUnLH0pLGluaXQ6ZnVuY3Rpb24ocGFyZW50LG1vZGVsLHJlbmRlcmVyLHBhcmFtcyl7dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3RoaXMuYXJjaGl2ZUVuYWJsZWQ9cGFyYW1zLmFyY2hpdmVFbmFibGVkO3RoaXMuY29uZmlybU9uRGVsZXRlPXBhcmFtcy5jb25maXJtT25EZWxldGU7dGhpcy5oYXNCdXR0b25zPXBhcmFtcy5oYXNCdXR0b25zO0ZpZWxkTWFuYWdlck1peGluLmluaXQuY2FsbCh0aGlzLHRoaXMubW9kZWwpO3RoaXMubW9kZT1wYXJhbXMubW9kZXx8J3JlYWRvbmx5Jzt0aGlzLmhhbmRsZT10aGlzLmluaXRpYWxTdGF0ZS5pZDt0aGlzLnNhdmluZ0RlZj1Qcm9taXNlLnJlc29sdmUoKTt0aGlzLnZpZXdJZD1wYXJhbXMudmlld0lkO30sc3RhcnQ6ZnVuY3Rpb24oKXt0aGlzLiRlbC50b2dnbGVDbGFzcygnb19jYW5ub3RfY3JlYXRlJywhdGhpcy5hY3RpdmVBY3Rpb25zLmNyZWF0ZSk7cmV0dXJuIHRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKS50aGVuKHRoaXMuX3VwZGF0ZUVudi5iaW5kKHRoaXMpKTt9LGNhbkJlRGlzY2FyZGVkOmZ1bmN0aW9uKHJlY29yZElEKXt2YXIgc2VsZj10aGlzO2lmKCF0aGlzLmlzRGlydHkocmVjb3JkSUQpKXtyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGZhbHNlKTt9CnZhciBtZXNzYWdlPV90KCJUaGUgcmVjb3JkIGhhcyBiZWVuIG1vZGlmaWVkLCB5b3VyIGNoYW5nZXMgd2lsbCBiZSBkaXNjYXJkZWQuIERvIHlvdSB3YW50IHRvIHByb2NlZWQ/Iik7dmFyIGRlZjtkZWY9bmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSxyZWplY3Qpe3ZhciBkaWFsb2c9RGlhbG9nLmNvbmZpcm0oc2VsZixtZXNzYWdlLHt0aXRsZTpfdCgiV2FybmluZyIpLGNvbmZpcm1fY2FsbGJhY2s6cmVzb2x2ZS5iaW5kKHNlbGYsdHJ1ZSksY2FuY2VsX2NhbGxiYWNrOnJlamVjdCx9KTtkaWFsb2cub24oJ2Nsb3NlZCcsZGVmLHJlamVjdCk7fSk7cmV0dXJuIGRlZjt9LGNhbkJlU2F2ZWQ6ZnVuY3Rpb24ocmVjb3JkSUQpe3ZhciBmaWVsZE5hbWVzPXRoaXMucmVuZGVyZXIuY2FuQmVTYXZlZChyZWNvcmRJRHx8dGhpcy5oYW5kbGUpO2lmKGZpZWxkTmFtZXMubGVuZ3RoKXt0aGlzLl9ub3RpZnlJbnZhbGlkRmllbGRzKGZpZWxkTmFtZXMpO3JldHVybiBmYWxzZTt9CnJldHVybiB0cnVlO30sZGlzY2FyZENoYW5nZXM6ZnVuY3Rpb24ocmVjb3JkSUQsb3B0aW9ucyl7cmV0dXJuIFByb21pc2UuYWxsKFt0aGlzLm11dGV4LmdldFVubG9ja2VkRGVmKCksdGhpcy5zYXZpbmdEZWZdKS50aGVuKHRoaXMuX2Rpc2NhcmRDaGFuZ2VzLmJpbmQodGhpcyxyZWNvcmRJRHx8dGhpcy5oYW5kbGUsb3B0aW9ucykpO30sZ2V0U2VsZWN0ZWRJZHM6ZnVuY3Rpb24oKXtyZXR1cm5bXTt9LGdpdmVGb2N1czpmdW5jdGlvbigpe3RoaXMucmVuZGVyZXIuZ2l2ZUZvY3VzKCk7fSxpc0RpcnR5OmZ1bmN0aW9uKHJlY29yZElEKXtyZXR1cm4gdGhpcy5tb2RlbC5pc0RpcnR5KHJlY29yZElEfHx0aGlzLmhhbmRsZSk7fSxyZW5kZXJQYWdlcjpmdW5jdGlvbigkbm9kZSxvcHRpb25zKXt2YXIgc2VsZj10aGlzO3ZhciBwYXJhbXM9dGhpcy5fZ2V0UGFnZXJQYXJhbXMoKTt0aGlzLnBhZ2VyPW5ldyBQYWdlcih0aGlzLHBhcmFtcy5zaXplLHBhcmFtcy5jdXJyZW50X21pbixwYXJhbXMubGltaXQsb3B0aW9ucyk7dGhpcy5wYWdlci5vbigncGFnZXJfY2hhbmdlZCcsdGhpcyxmdW5jdGlvbihuZXdTdGF0ZSl7dGhpcy5wYWdlci5kaXNhYmxlKCk7dmFyIGRhdGE9dGhpcy5tb2RlbC5nZXQodGhpcy5oYW5kbGUse3Jhdzp0cnVlfSk7dmFyIGxpbWl0Q2hhbmdlZD0oZGF0YS5saW1pdCE9PW5ld1N0YXRlLmxpbWl0KTt2YXIgcmVsb2FkUGFyYW1zO2lmKGRhdGEuZ3JvdXBlZEJ5JiZkYXRhLmdyb3VwZWRCeS5sZW5ndGgpe3JlbG9hZFBhcmFtcz17Z3JvdXBzTGltaXQ6bmV3U3RhdGUubGltaXQsZ3JvdXBzT2Zmc2V0Om5ld1N0YXRlLmN1cnJlbnRfbWluLTF9O31lbHNle3JlbG9hZFBhcmFtcz17bGltaXQ6bmV3U3RhdGUubGltaXQsb2Zmc2V0Om5ld1N0YXRlLmN1cnJlbnRfbWluLTF9O30KdGhpcy5yZWxvYWQocmVsb2FkUGFyYW1zKS50aGVuKGZ1bmN0aW9uKCl7aWYoIWxpbWl0Q2hhbmdlZCl7c2VsZi50cmlnZ2VyX3VwKCdzY3JvbGxUbycse3RvcDowfSk7fX0pLnRoZW4odGhpcy5wYWdlci5lbmFibGUuYmluZCh0aGlzLnBhZ2VyKSk7fSk7cmV0dXJuIHRoaXMucGFnZXIuYXBwZW5kVG8oJG5vZGUpLnRoZW4oZnVuY3Rpb24oKXtzZWxmLl91cGRhdGVQYWdlcigpO30pO30sc2F2ZVJlY29yZDpmdW5jdGlvbihyZWNvcmRJRCxvcHRpb25zKXt2YXIgc2VsZj10aGlzO3ZhciB1bmxvY2tlZE11dGV4PXRoaXMubXV0ZXguZ2V0VW5sb2NrZWREZWYoKS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIHNlbGYucmVuZGVyZXIuY29tbWl0Q2hhbmdlcyhyZWNvcmRJRHx8c2VsZi5oYW5kbGUpO30pLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gc2VsZi5tdXRleC5leGVjKHNlbGYuX3NhdmVSZWNvcmQuYmluZChzZWxmLHJlY29yZElELG9wdGlvbnMpKTt9KTt0aGlzLnNhdmluZ0RlZj1uZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlKXt1bmxvY2tlZE11dGV4LnRoZW4ocmVzb2x2ZSkuZ3VhcmRlZENhdGNoKHJlc29sdmUpO30pO3JldHVybiB1bmxvY2tlZE11dGV4O30sdXBkYXRlOmZ1bmN0aW9uKHBhcmFtcyxvcHRpb25zKXt2YXIgc2VsZj10aGlzO3RoaXMubW9kZT1wYXJhbXMubW9kZXx8dGhpcy5tb2RlO3JldHVybiB0aGlzLl9zdXBlcihwYXJhbXMsb3B0aW9ucykudGhlbihmdW5jdGlvbigpe3NlbGYuX3VwZGF0ZUVudigpO3NlbGYuX3VwZGF0ZVBhZ2VyKCk7fSk7fSxyZWxvYWQ6ZnVuY3Rpb24ocGFyYW1zKXtpZihwYXJhbXMmJnBhcmFtcy5jb250cm9sbGVyU3RhdGUpe2lmKHBhcmFtcy5jb250cm9sbGVyU3RhdGUuY3VycmVudElkKXtwYXJhbXMuY3VycmVudElkPXBhcmFtcy5jb250cm9sbGVyU3RhdGUuY3VycmVudElkO30KcGFyYW1zLmlkcz1wYXJhbXMuY29udHJvbGxlclN0YXRlLnJlc0lkczt9CnJldHVybiB0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fSxfYWJhbmRvblJlY29yZDpmdW5jdGlvbihyZWNvcmRJRCl7cmVjb3JkSUQ9cmVjb3JkSUR8fHRoaXMuaGFuZGxlO2lmKHJlY29yZElEPT09dGhpcy5oYW5kbGUpe3RoaXMudHJpZ2dlcl91cCgnaGlzdG9yeV9iYWNrJyk7fWVsc2V7dGhpcy5tb2RlbC5yZW1vdmVMaW5lKHJlY29yZElEKTt9fSxfYXBwbHlDaGFuZ2VzOmZ1bmN0aW9uKGRhdGFQb2ludElELGNoYW5nZXMsZXZlbnQpe3ZhciBfc3VwZXI9RmllbGRNYW5hZ2VyTWl4aW4uX2FwcGx5Q2hhbmdlcy5iaW5kKHRoaXMpO3JldHVybiB0aGlzLm11dGV4LmV4ZWMoZnVuY3Rpb24oKXtyZXR1cm4gX3N1cGVyKGRhdGFQb2ludElELGNoYW5nZXMsZXZlbnQpO30pO30sX2NhbGxCdXR0b25BY3Rpb246ZnVuY3Rpb24oYXR0cnMscmVjb3JkKXt2YXIgc2VsZj10aGlzO3ZhciBkZWY9bmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSxyZWplY3Qpe3ZhciByZWxvYWQ9ZnVuY3Rpb24oKXtyZXR1cm4gc2VsZi5pc0Rlc3Ryb3llZCgpP1Byb21pc2UucmVzb2x2ZSgpOnNlbGYucmVsb2FkKCk7fTtyZWNvcmQ9cmVjb3JkfHxzZWxmLm1vZGVsLmdldChzZWxmLmhhbmRsZSk7c2VsZi50cmlnZ2VyX3VwKCdleGVjdXRlX2FjdGlvbicse2FjdGlvbl9kYXRhOl8uZXh0ZW5kKHt9LGF0dHJzLHtjb250ZXh0OnJlY29yZC5nZXRDb250ZXh0KHthZGRpdGlvbmFsQ29udGV4dDphdHRycy5jb250ZXh0fHx7fX0pLH0pLGVudjp7Y29udGV4dDpyZWNvcmQuZ2V0Q29udGV4dCgpLGN1cnJlbnRJRDpyZWNvcmQuZGF0YS5pZCxtb2RlbDpyZWNvcmQubW9kZWwscmVzSURzOnJlY29yZC5yZXNfaWRzLH0sb25fc3VjY2VzczpyZXNvbHZlLG9uX2ZhaWw6ZnVuY3Rpb24oKXtzZWxmLnVwZGF0ZSh7fSx7cmVsb2FkOmZhbHNlfSkudGhlbihyZWplY3QpLmd1YXJkZWRDYXRjaChyZWplY3QpO30sb25fY2xvc2VkOnJlbG9hZCx9KTt9KTtyZXR1cm4gdGhpcy5hbGl2ZShkZWYpO30sX2NvbmZpcm1DaGFuZ2U6ZnVuY3Rpb24oaWQsZmllbGRzLGUpe2lmKGUubmFtZT09PSdkaXNjYXJkX2NoYW5nZXMnJiZlLnRhcmdldC5yZXNldCl7cmV0dXJuIGUudGFyZ2V0LnJlc2V0KHRoaXMubW9kZWwuZ2V0KGUudGFyZ2V0LmRhdGFQb2ludElEKSxlLHRydWUpO30KdmFyIHN0YXRlPXRoaXMubW9kZWwuZ2V0KHRoaXMuaGFuZGxlKTtyZXR1cm4gdGhpcy5yZW5kZXJlci5jb25maXJtQ2hhbmdlKHN0YXRlLGlkLGZpZWxkcyxlKTt9LF9jb25maXJtU2F2ZU5ld1JlY29yZDpmdW5jdGlvbigpe3ZhciBzZWxmPXRoaXM7dmFyIGRlZj1uZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLHJlamVjdCl7dmFyIG1lc3NhZ2U9X3QoIllvdSBuZWVkIHRvIHNhdmUgdGhpcyBuZXcgcmVjb3JkIGJlZm9yZSBlZGl0aW5nIHRoZSB0cmFuc2xhdGlvbi4gRG8geW91IHdhbnQgdG8gcHJvY2VlZD8iKTt2YXIgZGlhbG9nPURpYWxvZy5jb25maXJtKHNlbGYsbWVzc2FnZSx7dGl0bGU6X3QoIldhcm5pbmciKSxjb25maXJtX2NhbGxiYWNrOnJlc29sdmUuYmluZChzZWxmLHRydWUpLGNhbmNlbF9jYWxsYmFjazpyZWplY3QsfSk7ZGlhbG9nLm9uKCdjbG9zZWQnLHNlbGYscmVqZWN0KTt9KTtyZXR1cm4gZGVmO30sX2RlbGV0ZVJlY29yZHM6ZnVuY3Rpb24oaWRzKXt2YXIgc2VsZj10aGlzO2Z1bmN0aW9uIGRvSXQoKXtyZXR1cm4gc2VsZi5tb2RlbC5kZWxldGVSZWNvcmRzKGlkcyxzZWxmLm1vZGVsTmFtZSkudGhlbihzZWxmLl9vbkRlbGV0ZWRSZWNvcmRzLmJpbmQoc2VsZixpZHMpKTt9CmlmKHRoaXMuY29uZmlybU9uRGVsZXRlKXtEaWFsb2cuY29uZmlybSh0aGlzLF90KCJBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gZGVsZXRlIHRoaXMgcmVjb3JkID8iKSx7Y29uZmlybV9jYWxsYmFjazpkb0l0LH0pO31lbHNle2RvSXQoKTt9fSxfZGlzYWJsZUJ1dHRvbnM6ZnVuY3Rpb24oKXtpZih0aGlzLiRidXR0b25zKXt0aGlzLiRidXR0b25zLmZpbmQoJ2J1dHRvbicpLmF0dHIoJ2Rpc2FibGVkJyx0cnVlKTt9fSxfZGlzY2FyZENoYW5nZXM6ZnVuY3Rpb24ocmVjb3JkSUQsb3B0aW9ucyl7dmFyIHNlbGY9dGhpcztyZWNvcmRJRD1yZWNvcmRJRHx8dGhpcy5oYW5kbGU7b3B0aW9ucz1vcHRpb25zfHx7fTtyZXR1cm4gdGhpcy5jYW5CZURpc2NhcmRlZChyZWNvcmRJRCkudGhlbihmdW5jdGlvbihuZWVkRGlzY2FyZCl7aWYob3B0aW9ucy5yZWFkb25seUlmUmVhbERpc2NhcmQmJiFuZWVkRGlzY2FyZCl7cmV0dXJuO30Kc2VsZi5tb2RlbC5kaXNjYXJkQ2hhbmdlcyhyZWNvcmRJRCk7aWYob3B0aW9ucy5ub0FiYW5kb24pe3JldHVybjt9CmlmKHNlbGYubW9kZWwuY2FuQmVBYmFuZG9uZWQocmVjb3JkSUQpKXtzZWxmLl9hYmFuZG9uUmVjb3JkKHJlY29yZElEKTtyZXR1cm47fQpyZXR1cm4gc2VsZi5fY29uZmlybVNhdmUocmVjb3JkSUQpO30pO30sX2VuYWJsZUJ1dHRvbnM6ZnVuY3Rpb24oKXtpZih0aGlzLiRidXR0b25zKXt0aGlzLiRidXR0b25zLmZpbmQoJ2J1dHRvbicpLnJlbW92ZUF0dHIoJ2Rpc2FibGVkJyk7fX0sZXhwb3J0U3RhdGU6ZnVuY3Rpb24oKXt2YXIgc3RhdGU9dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3ZhciBlbnY9dGhpcy5tb2RlbC5nZXQodGhpcy5oYW5kbGUse2Vudjp0cnVlfSk7cmV0dXJuIF8uZXh0ZW5kKHN0YXRlLHtjdXJyZW50SWQ6ZW52LmN1cnJlbnRJZCxyZXNJZHM6ZW52Lmlkcyx9KTt9LF9nZXRPcHRpb25hbEZpZWxkc0xvY2FsU3RvcmFnZUtleTpmdW5jdGlvbihrZXlQYXJ0cyl7a2V5UGFydHMubW9kZWw9dGhpcy5tb2RlbE5hbWU7a2V5UGFydHMudmlld1R5cGU9dGhpcy52aWV3VHlwZTtrZXlQYXJ0cy52aWV3SWQ9dGhpcy52aWV3SWQ7dmFyIHBhcnRzPVsnbW9kZWwnLCd2aWV3VHlwZScsJ3ZpZXdJZCcsJ3JlbGF0aW9uYWxGaWVsZCcsJ3N1YlZpZXdUeXBlJywnc3ViVmlld0lkJyxdO3ZhciB2aWV3SWRlbnRpZmllcj1wYXJ0cy5yZWR1Y2UoZnVuY3Rpb24oaWRlbnRpZmllcixwYXJ0TmFtZSl7aWYocGFydE5hbWUgaW4ga2V5UGFydHMpe3JldHVybiBpZGVudGlmaWVyKycsJytrZXlQYXJ0c1twYXJ0TmFtZV07fQpyZXR1cm4gaWRlbnRpZmllcjt9LCdvcHRpb25hbF9maWVsZHMnKTt2aWV3SWRlbnRpZmllcj1rZXlQYXJ0cy5maWVsZHMuc29ydCh0aGlzLl9uYW1lU29ydENvbXBhcmVyKS5yZWR1Y2UoZnVuY3Rpb24oaWRlbnRpZmllcixmaWVsZCl7cmV0dXJuIGlkZW50aWZpZXIrJywnK2ZpZWxkLm5hbWU7fSx2aWV3SWRlbnRpZmllcik7cmV0dXJuIHZpZXdJZGVudGlmaWVyO30sX2dldFBhZ2VyUGFyYW1zOmZ1bmN0aW9uKCl7dmFyIHN0YXRlPXRoaXMubW9kZWwuZ2V0KHRoaXMuaGFuZGxlLHtyYXc6dHJ1ZX0pO3ZhciBpc0dyb3VwZWQ9c3RhdGUuZ3JvdXBlZEJ5JiZzdGF0ZS5ncm91cGVkQnkubGVuZ3RoO3JldHVybntjdXJyZW50X21pbjooaXNHcm91cGVkP3N0YXRlLmdyb3Vwc09mZnNldDpzdGF0ZS5vZmZzZXQpKzEsbGltaXQ6aXNHcm91cGVkP3N0YXRlLmdyb3Vwc0xpbWl0OnN0YXRlLmxpbWl0LHNpemU6aXNHcm91cGVkP3N0YXRlLmdyb3Vwc0NvdW50OnN0YXRlLmNvdW50LH07fSxfZ2V0U2lkZWJhckVudjpmdW5jdGlvbigpe3JldHVybntjb250ZXh0OnRoaXMubW9kZWwuZ2V0KHRoaXMuaGFuZGxlKS5nZXRDb250ZXh0KCksYWN0aXZlSWRzOnRoaXMuZ2V0U2VsZWN0ZWRJZHMoKSxtb2RlbDp0aGlzLm1vZGVsTmFtZSx9O30sX2lzUGFnZXJWaXNpYmxlOmZ1bmN0aW9uKCl7cmV0dXJuIHRydWU7fSxfbmFtZVNvcnRDb21wYXJlcjpmdW5jdGlvbihsZWZ0LHJpZ2h0KXtyZXR1cm4gbGVmdC5uYW1lPHJpZ2h0Lm5hbWU/LTE6MTt9LF9ub3RpZnlJbnZhbGlkRmllbGRzOmZ1bmN0aW9uKGludmFsaWRGaWVsZHMpe3ZhciByZWNvcmQ9dGhpcy5tb2RlbC5nZXQodGhpcy5oYW5kbGUse3Jhdzp0cnVlfSk7dmFyIGZpZWxkcz1yZWNvcmQuZmllbGRzO3ZhciB3YXJuaW5ncz1pbnZhbGlkRmllbGRzLm1hcChmdW5jdGlvbihmaWVsZE5hbWUpe3ZhciBmaWVsZFN0cj1maWVsZHNbZmllbGROYW1lXS5zdHJpbmc7cmV0dXJuIF8uc3RyLnNwcmludGYoJzxsaT4lczwvbGk+JyxfLmVzY2FwZShmaWVsZFN0cikpO30pO3dhcm5pbmdzLnVuc2hpZnQoJzx1bD4nKTt3YXJuaW5ncy5wdXNoKCc8L3VsPicpO3RoaXMuZG9fd2FybihfdCgiVGhlIGZvbGxvd2luZyBmaWVsZHMgYXJlIGludmFsaWQ6Iiksd2FybmluZ3Muam9pbignJykpO30sX29uRGVsZXRlZFJlY29yZHM6ZnVuY3Rpb24oaWRzKXt0aGlzLnVwZGF0ZSh7fSk7fSxfc2F2ZVJlY29yZDpmdW5jdGlvbihyZWNvcmRJRCxvcHRpb25zKXtyZWNvcmRJRD1yZWNvcmRJRHx8dGhpcy5oYW5kbGU7b3B0aW9ucz1fLmRlZmF1bHRzKG9wdGlvbnN8fHt9LHtzdGF5SW5FZGl0OmZhbHNlLHJlbG9hZDp0cnVlLHNhdmVQb2ludDpmYWxzZSx9KTtpZih0aGlzLmNhbkJlU2F2ZWQocmVjb3JkSUQpKXt2YXIgc2VsZj10aGlzO3ZhciBzYXZlRGVmPXRoaXMubW9kZWwuc2F2ZShyZWNvcmRJRCx7cmVsb2FkOm9wdGlvbnMucmVsb2FkLHNhdmVQb2ludDpvcHRpb25zLnNhdmVQb2ludCx2aWV3VHlwZTpvcHRpb25zLnZpZXdUeXBlLH0pO2lmKCFvcHRpb25zLnN0YXlJbkVkaXQpe3NhdmVEZWY9c2F2ZURlZi50aGVuKGZ1bmN0aW9uKGZpZWxkTmFtZXMpe3ZhciBkZWY9ZmllbGROYW1lcy5sZW5ndGg/c2VsZi5fY29uZmlybVNhdmUocmVjb3JkSUQpOnNlbGYuX3NldE1vZGUoJ3JlYWRvbmx5JyxyZWNvcmRJRCk7cmV0dXJuIGRlZi50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIGZpZWxkTmFtZXM7fSk7fSk7fQpyZXR1cm4gc2F2ZURlZjt9ZWxzZXtyZXR1cm4gUHJvbWlzZS5yZWplY3QoIlNhdmVSZWNvcmQ6IHRoaXMuY2FuQmVTYXZlIGlzIGZhbHNlIik7fX0sX3NldE1vZGU6ZnVuY3Rpb24obW9kZSxyZWNvcmRJRCl7aWYoKHJlY29yZElEfHx0aGlzLmhhbmRsZSk9PT10aGlzLmhhbmRsZSl7cmV0dXJuIHRoaXMudXBkYXRlKHttb2RlOm1vZGV9LHtyZWxvYWQ6ZmFsc2V9KS50aGVuKGZ1bmN0aW9uKCl7Y29yZS5idXMudHJpZ2dlcignRE9NX3VwZGF0ZWQnKTt9KTt9CnJldHVybiBQcm9taXNlLnJlc29sdmUoKTt9LF91cGRhdGVFbnY6ZnVuY3Rpb24oKXt2YXIgZW52PXRoaXMubW9kZWwuZ2V0KHRoaXMuaGFuZGxlLHtlbnY6dHJ1ZX0pO2lmKHRoaXMuc2lkZWJhcil7dmFyIHNpZGViYXJFbnY9dGhpcy5fZ2V0U2lkZWJhckVudigpO3RoaXMuc2lkZWJhci51cGRhdGVFbnYoc2lkZWJhckVudik7fX0sX3VwZGF0ZVBhZ2VyOmZ1bmN0aW9uKCl7aWYodGhpcy5wYWdlcil7dGhpcy5wYWdlci51cGRhdGVTdGF0ZSh0aGlzLl9nZXRQYWdlclBhcmFtcygpKTt0aGlzLnBhZ2VyLmRvX3RvZ2dsZSh0aGlzLl9pc1BhZ2VyVmlzaWJsZSgpKTt9fSxfb25EaXNjYXJkQ2hhbmdlczpmdW5jdGlvbihldil7dmFyIHNlbGY9dGhpcztldi5zdG9wUHJvcGFnYXRpb24oKTt2YXIgcmVjb3JkSUQ9ZXYuZGF0YS5yZWNvcmRJRDt0aGlzLl9kaXNjYXJkQ2hhbmdlcyhyZWNvcmRJRCkudGhlbihmdW5jdGlvbigpe3NlbGYuX2NvbmZpcm1DaGFuZ2UocmVjb3JkSUQsW2V2LmRhdGEuZmllbGROYW1lXSxldikudGhlbihldi5kYXRhLm9uU3VjY2VzcykuZ3VhcmRlZENhdGNoKGV2LmRhdGEub25TdWNjZXNzKTt9KS5ndWFyZGVkQ2F0Y2goZXYuZGF0YS5vbkZhaWx1cmUpO30sX29uRmllbGRDaGFuZ2VkOmZ1bmN0aW9uKGV2KXtpZih0aGlzLm1vZGU9PT0ncmVhZG9ubHknKXtldi5kYXRhLmZvcmNlX3NhdmU9dHJ1ZTt9CkZpZWxkTWFuYWdlck1peGluLl9vbkZpZWxkQ2hhbmdlZC5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fSxfb25SZWxvYWQ6ZnVuY3Rpb24oZXYpe2V2LnN0b3BQcm9wYWdhdGlvbigpO3ZhciBkYXRhPWV2JiZldi5kYXRhfHx7fTt2YXIgaGFuZGxlPWRhdGEuZGJfaWQ7dmFyIHByb207aWYoaGFuZGxlKXtwcm9tPXRoaXMubW9kZWwucmVsb2FkKGhhbmRsZSkudGhlbih0aGlzLl9jb25maXJtU2F2ZS5iaW5kKHRoaXMsaGFuZGxlKSk7fWVsc2V7cHJvbT10aGlzLnJlbG9hZCh7ZmllbGROYW1lczpkYXRhLmZpZWxkTmFtZXMsa2VlcENoYW5nZXM6ZGF0YS5rZWVwQ2hhbmdlc3x8ZmFsc2UsfSk7fQpwcm9tLnRoZW4oZXYuZGF0YS5vblN1Y2Nlc3MpLmd1YXJkZWRDYXRjaChldi5kYXRhLm9uRmFpbHVyZSk7fSxfb25SZXNlcXVlbmNlUmVjb3JkczpmdW5jdGlvbihldil7dmFyIHNlbGY9dGhpczt0aGlzLnRyaWdnZXJfdXAoJ211dGV4aWZ5Jyx7YWN0aW9uOmZ1bmN0aW9uKCl7dmFyIHN0YXRlPXNlbGYubW9kZWwuZ2V0KHNlbGYuaGFuZGxlKTt2YXIgcmVzSURzPV8ubWFwKGV2LmRhdGEucmVjb3JkSWRzLGZ1bmN0aW9uKHJlY29yZElEKXtyZXR1cm4gXy5maW5kV2hlcmUoc3RhdGUuZGF0YSx7aWQ6cmVjb3JkSUR9KS5yZXNfaWQ7fSk7dmFyIG9wdGlvbnM9e29mZnNldDpldi5kYXRhLm9mZnNldCxmaWVsZDpldi5kYXRhLmhhbmRsZUZpZWxkLH07cmV0dXJuIHNlbGYubW9kZWwucmVzZXF1ZW5jZShzZWxmLm1vZGVsTmFtZSxyZXNJRHMsc2VsZi5oYW5kbGUsb3B0aW9ucykudGhlbihmdW5jdGlvbigpe3NlbGYuX3VwZGF0ZUVudigpO3N0YXRlPXNlbGYubW9kZWwuZ2V0KHNlbGYuaGFuZGxlKTtyZXR1cm4gc2VsZi5yZW5kZXJlci51cGRhdGVTdGF0ZShzdGF0ZSx7bm9SZW5kZXI6dHJ1ZX0pO30pO30sfSk7fSxfb25Mb2FkT3B0aW9uYWxGaWVsZHM6ZnVuY3Rpb24oZXYpe3ZhciByZXM9dGhpcy5jYWxsKCdsb2NhbF9zdG9yYWdlJywnZ2V0SXRlbScsdGhpcy5fZ2V0T3B0aW9uYWxGaWVsZHNMb2NhbFN0b3JhZ2VLZXkoZXYuZGF0YS5rZXlQYXJ0cykpO2V2LmRhdGEuY2FsbGJhY2socmVzKTt9LF9vblNhdmVPcHRpb25hbEZpZWxkczpmdW5jdGlvbihldil7dGhpcy5jYWxsKCdsb2NhbF9zdG9yYWdlJywnc2V0SXRlbScsdGhpcy5fZ2V0T3B0aW9uYWxGaWVsZHNMb2NhbFN0b3JhZ2VLZXkoZXYuZGF0YS5rZXlQYXJ0cyksZXYuZGF0YS5vcHRpb25hbENvbHVtbnNFbmFibGVkKTt9LF9vblNldERpcnR5OmZ1bmN0aW9uKGV2KXtldi5zdG9wUHJvcGFnYXRpb24oKTt0aGlzLm1vZGVsLnNldERpcnR5KGV2LmRhdGEuZGF0YVBvaW50SUQpO30sX29uU2lkZWJhckRhdGFBc2tlZDpmdW5jdGlvbihldil7dmFyIHNpZGViYXJFbnY9dGhpcy5fZ2V0U2lkZWJhckVudigpO2V2LmRhdGEuY2FsbGJhY2soc2lkZWJhckVudik7fSxfb25UcmFuc2xhdGU6YXN5bmMgZnVuY3Rpb24oZXYpe2V2LnN0b3BQcm9wYWdhdGlvbigpO2lmKHRoaXMubW9kZWwuaXNOZXcoZXYuZGF0YS5pZCkpe2F3YWl0IHRoaXMuX2NvbmZpcm1TYXZlTmV3UmVjb3JkKCk7dmFyIHVwZGF0ZWRGaWVsZHM9YXdhaXQgdGhpcy5zYXZlUmVjb3JkKGV2LmRhdGEuaWQse3N0YXlJbkVkaXQ6dHJ1ZX0pO2F3YWl0IHRoaXMuX2NvbmZpcm1DaGFuZ2UoZXYuZGF0YS5pZCx1cGRhdGVkRmllbGRzLGV2KTt9CnZhciByZWNvcmQ9dGhpcy5tb2RlbC5nZXQoZXYuZGF0YS5pZCx7cmF3OnRydWV9KTt2YXIgcmVzdWx0PWF3YWl0IHRoaXMuX3JwYyh7cm91dGU6Jy93ZWIvZGF0YXNldC9jYWxsX2J1dHRvbicscGFyYW1zOnttb2RlbDonaXIudHJhbnNsYXRpb24nLG1ldGhvZDondHJhbnNsYXRlX2ZpZWxkcycsYXJnczpbcmVjb3JkLm1vZGVsLHJlY29yZC5yZXNfaWQsZXYuZGF0YS5maWVsZE5hbWVdLGt3YXJnczp7Y29udGV4dDpyZWNvcmQuZ2V0Q29udGV4dCgpfSx9fSk7dGhpcy50cmFuc2xhdGlvbkRpYWxvZz1uZXcgVHJhbnNsYXRpb25EaWFsb2codGhpcyx7ZG9tYWluOnJlc3VsdC5kb21haW4sc2VhcmNoTmFtZTpyZXN1bHQuY29udGV4dC5zZWFyY2hfZGVmYXVsdF9uYW1lLGZpZWxkTmFtZTpyZWNvcmQuZmllbGRzSW5mb1tyZWNvcmQudmlld1R5cGVdW2V2LmRhdGEuZmllbGROYW1lXS5uYW1lLHVzZXJMYW5ndWFnZVZhbHVlOmV2LnRhcmdldC52YWx1ZXx8JycsZGF0YVBvaW50SUQ6cmVjb3JkLmlkLGlzQ29taW5nRnJvbVRyYW5zbGF0aW9uQWxlcnQ6ZXYuZGF0YS5pc0NvbWluZ0Zyb21UcmFuc2xhdGlvbkFsZXJ0LGlzVGV4dDpyZXN1bHQuY29udGV4dC50cmFuc2xhdGlvbl90eXBlPT09J3RleHQnLHNob3dTcmM6cmVzdWx0LmNvbnRleHQudHJhbnNsYXRpb25fc2hvd19zcmMsfSk7cmV0dXJuIHRoaXMudHJhbnNsYXRpb25EaWFsb2cub3BlbigpO30sfSk7cmV0dXJuIEJhc2ljQ29udHJvbGxlcjt9KTs7CgovKiAvd2ViL3N0YXRpYy9zcmMvanMvdmlld3MvYmFzaWMvYmFzaWNfcmVuZGVyZXIuanMgZGVmaW5lZCBpbiBidW5kbGUgJ3dlYi5hc3NldHNfYmFja2VuZCcgKi8Kb2Rvby5kZWZpbmUoJ3dlYi5CYXNpY1JlbmRlcmVyJyxmdW5jdGlvbihyZXF1aXJlKXsidXNlIHN0cmljdCI7dmFyIEFic3RyYWN0UmVuZGVyZXI9cmVxdWlyZSgnd2ViLkFic3RyYWN0UmVuZGVyZXInKTt2YXIgY29uZmlnPXJlcXVpcmUoJ3dlYi5jb25maWcnKTt2YXIgY29yZT1yZXF1aXJlKCd3ZWIuY29yZScpO3ZhciBkb209cmVxdWlyZSgnd2ViLmRvbScpO3ZhciB3aWRnZXRSZWdpc3RyeT1yZXF1aXJlKCd3ZWIud2lkZ2V0X3JlZ2lzdHJ5Jyk7dmFyIHF3ZWI9Y29yZS5xd2ViO3ZhciBCYXNpY1JlbmRlcmVyPUFic3RyYWN0UmVuZGVyZXIuZXh0ZW5kKHtjdXN0b21fZXZlbnRzOntuYXZpZ2F0aW9uX21vdmU6J19vbk5hdmlnYXRpb25Nb3ZlJyx9LGluaXQ6ZnVuY3Rpb24ocGFyZW50LHN0YXRlLHBhcmFtcyl7dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3RoaXMuYWN0aXZlQWN0aW9ucz1wYXJhbXMuYWN0aXZlQWN0aW9uczt0aGlzLnZpZXdUeXBlPXBhcmFtcy52aWV3VHlwZTt0aGlzLm1vZGU9cGFyYW1zLm1vZGV8fCdyZWFkb25seSc7dGhpcy53aWRnZXRzPVtdO3RoaXMuaGFuZGxlRmllbGQ9bnVsbDt9LGNhbkJlU2F2ZWQ6ZnVuY3Rpb24ocmVjb3JkSUQpe3ZhciBzZWxmPXRoaXM7dmFyIGludmFsaWRGaWVsZHM9W107Xy5lYWNoKHRoaXMuYWxsRmllbGRXaWRnZXRzW3JlY29yZElEXSxmdW5jdGlvbih3aWRnZXQpe3ZhciBjYW5CZVNhdmVkPXNlbGYuX2NhbldpZGdldEJlU2F2ZWQod2lkZ2V0KTtpZighY2FuQmVTYXZlZCl7aW52YWxpZEZpZWxkcy5wdXNoKHdpZGdldC5uYW1lKTt9CndpZGdldC4kZWwudG9nZ2xlQ2xhc3MoJ29fZmllbGRfaW52YWxpZCcsIWNhbkJlU2F2ZWQpO3dpZGdldC4kZWwuYXR0cignYXJpYS1pbnZhbGlkJywhY2FuQmVTYXZlZCk7fSk7cmV0dXJuIGludmFsaWRGaWVsZHM7fSxjb21taXRDaGFuZ2VzOmZ1bmN0aW9uKHJlY29yZElEKXt2YXIgZGVmcz1fLm1hcCh0aGlzLmFsbEZpZWxkV2lkZ2V0c1tyZWNvcmRJRF0sZnVuY3Rpb24od2lkZ2V0KXtyZXR1cm4gd2lkZ2V0LmNvbW1pdENoYW5nZXMoKTt9KTtyZXR1cm4gUHJvbWlzZS5hbGwoZGVmcyk7fSxjb25maXJtQ2hhbmdlOmZ1bmN0aW9uKHN0YXRlLGlkLGZpZWxkcyxldil7dGhpcy5zdGF0ZT1zdGF0ZTt2YXIgcmVjb3JkPXRoaXMuX2dldFJlY29yZChpZCk7aWYoIXJlY29yZCl7cmV0dXJuIHRoaXMuX3JlbmRlcigpLnRoZW4oXy5jb25zdGFudChbXSkpO30KXy5pbnZva2UodGhpcy53aWRnZXRzLCd1cGRhdGVTdGF0ZScsc3RhdGUpO3ZhciBkZWZzPVtdO3ZhciByZXNldFdpZGdldHM9W107Xy5lYWNoKHRoaXMuYWxsRmllbGRXaWRnZXRzW2lkXSxmdW5jdGlvbih3aWRnZXQpe3ZhciBmaWVsZENoYW5nZWQ9Xy5jb250YWlucyhmaWVsZHMsd2lkZ2V0Lm5hbWUpO2lmKGZpZWxkQ2hhbmdlZHx8d2lkZ2V0LnJlc2V0T25BbnlGaWVsZENoYW5nZSl7ZGVmcy5wdXNoKHdpZGdldC5yZXNldChyZWNvcmQsZXYsZmllbGRDaGFuZ2VkKSk7cmVzZXRXaWRnZXRzLnB1c2god2lkZ2V0KTt9fSk7ZGVmcy5wdXNoKHRoaXMuX3VwZGF0ZUFsbE1vZGlmaWVycyhyZWNvcmQpKTtyZXR1cm4gUHJvbWlzZS5hbGwoZGVmcykudGhlbihmdW5jdGlvbigpe3JldHVybiByZXNldFdpZGdldHM7fSk7fSxmb2N1c0ZpZWxkOmZ1bmN0aW9uKGlkLGZpZWxkTmFtZSxvZmZzZXQpe3RoaXMuZWRpdFJlY29yZChpZCk7aWYodHlwZW9mIG9mZnNldD09PSJudW1iZXIiKXt2YXIgZmllbGQ9Xy5maW5kV2hlcmUodGhpcy5hbGxGaWVsZFdpZGdldHNbaWRdLHtuYW1lOmZpZWxkTmFtZX0pO2RvbS5zZXRTZWxlY3Rpb25SYW5nZShmaWVsZC5nZXRGb2N1c2FibGVFbGVtZW50KCkuZ2V0KDApLHtzdGFydDpvZmZzZXQsZW5kOm9mZnNldH0pO319LF9hY3RpdmF0ZUZpZWxkV2lkZ2V0OmZ1bmN0aW9uKHJlY29yZCxjdXJyZW50SW5kZXgsb3B0aW9ucyl7b3B0aW9ucz1vcHRpb25zfHx7fTtfLmRlZmF1bHRzKG9wdGlvbnMse2luYzoxLHdyYXA6ZmFsc2V9KTtjdXJyZW50SW5kZXg9TWF0aC5tYXgoMCxjdXJyZW50SW5kZXgpO3ZhciByZWNvcmRXaWRnZXRzPXRoaXMuYWxsRmllbGRXaWRnZXRzW3JlY29yZC5pZF18fFtdO2Zvcih2YXIgaT0wO2k8cmVjb3JkV2lkZ2V0cy5sZW5ndGg7aSsrKXt2YXIgYWN0aXZhdGVkPXJlY29yZFdpZGdldHNbY3VycmVudEluZGV4XS5hY3RpdmF0ZSh7ZXZlbnQ6b3B0aW9ucy5ldmVudCxub0F1dG9tYXRpY0NyZWF0ZTpvcHRpb25zLm5vQXV0b21hdGljQ3JlYXRlfHxmYWxzZX0pO2lmKGFjdGl2YXRlZCl7cmV0dXJuIGN1cnJlbnRJbmRleDt9CmN1cnJlbnRJbmRleCs9b3B0aW9ucy5pbmM7aWYoY3VycmVudEluZGV4Pj1yZWNvcmRXaWRnZXRzLmxlbmd0aCl7aWYob3B0aW9ucy53cmFwKXtjdXJyZW50SW5kZXgtPXJlY29yZFdpZGdldHMubGVuZ3RoO31lbHNle3JldHVybi0xO319ZWxzZSBpZihjdXJyZW50SW5kZXg8MCl7aWYob3B0aW9ucy53cmFwKXtjdXJyZW50SW5kZXgrPXJlY29yZFdpZGdldHMubGVuZ3RoO31lbHNle3JldHVybi0xO319fQpyZXR1cm4tMTt9LF9hY3RpdmF0ZU5leHRGaWVsZFdpZGdldDpmdW5jdGlvbihyZWNvcmQsY3VycmVudEluZGV4LG9wdGlvbnMpe2N1cnJlbnRJbmRleD0oY3VycmVudEluZGV4KzEpJSh0aGlzLmFsbEZpZWxkV2lkZ2V0c1tyZWNvcmQuaWRdfHxbXSkubGVuZ3RoO3JldHVybiB0aGlzLl9hY3RpdmF0ZUZpZWxkV2lkZ2V0KHJlY29yZCxjdXJyZW50SW5kZXgsXy5leHRlbmQoe2luYzoxfSxvcHRpb25zKSk7fSxfYWN0aXZhdGVQcmV2aW91c0ZpZWxkV2lkZ2V0OmZ1bmN0aW9uKHJlY29yZCxjdXJyZW50SW5kZXgpe2N1cnJlbnRJbmRleD1jdXJyZW50SW5kZXg/KGN1cnJlbnRJbmRleC0xKTooKHRoaXMuYWxsRmllbGRXaWRnZXRzW3JlY29yZC5pZF18fFtdKS5sZW5ndGgtMSk7cmV0dXJuIHRoaXMuX2FjdGl2YXRlRmllbGRXaWRnZXQocmVjb3JkLGN1cnJlbnRJbmRleCx7aW5jOi0xfSk7fSxfYWRkRmllbGRUb29sdGlwOmZ1bmN0aW9uKHdpZGdldCwkbm9kZSl7JG5vZGU9JG5vZGUubGVuZ3RoPyRub2RlOndpZGdldC4kZWw7JG5vZGUudG9vbHRpcCh7dGl0bGU6ZnVuY3Rpb24oKXtyZXR1cm4gcXdlYi5yZW5kZXIoJ1dpZGdldExhYmVsLnRvb2x0aXAnLHtkZWJ1Zzpjb25maWcuaXNEZWJ1ZygpLHdpZGdldDp3aWRnZXQsfSk7fX0pO30sX2FwcGx5TW9kaWZpZXJzOmZ1bmN0aW9uKG1vZGlmaWVyc0RhdGEscmVjb3JkLGVsZW1lbnQpe3ZhciBzZWxmPXRoaXM7dmFyIG1vZGlmaWVycz1tb2RpZmllcnNEYXRhLmV2YWx1YXRlZE1vZGlmaWVyc1tyZWNvcmQuaWRdfHx7fTtpZihlbGVtZW50KXtfYXBwbHkoZWxlbWVudCk7fWVsc2V7Xy5lYWNoKF8uY2xvbmUobW9kaWZpZXJzRGF0YS5lbGVtZW50c0J5UmVjb3JkW3JlY29yZC5pZF0pLF9hcHBseSk7fQpmdW5jdGlvbiBfYXBwbHkoZWxlbWVudCl7aWYoJ3JlYWRvbmx5J2luIG1vZGlmaWVycyYmZWxlbWVudC53aWRnZXQpe3ZhciBtb2RlPW1vZGlmaWVycy5yZWFkb25seT8ncmVhZG9ubHknOm1vZGlmaWVyc0RhdGEuYmFzZU1vZGVCeVJlY29yZFtyZWNvcmQuaWRdO2lmKG1vZGUhPT1lbGVtZW50LndpZGdldC5tb2RlKXtzZWxmLl9yZXJlbmRlckZpZWxkV2lkZ2V0KGVsZW1lbnQud2lkZ2V0LHJlY29yZCx7a2VlcEJhc2VNb2RlOnRydWUsbW9kZTptb2RlLH0pO3JldHVybjt9fQplbGVtZW50LiRlbC50b2dnbGVDbGFzcygib19pbnZpc2libGVfbW9kaWZpZXIiLCEhbW9kaWZpZXJzLmludmlzaWJsZSk7ZWxlbWVudC4kZWwudG9nZ2xlQ2xhc3MoIm9fcmVhZG9ubHlfbW9kaWZpZXIiLCEhbW9kaWZpZXJzLnJlYWRvbmx5KTtlbGVtZW50LiRlbC50b2dnbGVDbGFzcygib19yZXF1aXJlZF9tb2RpZmllciIsISFtb2RpZmllcnMucmVxdWlyZWQpO2lmKGVsZW1lbnQud2lkZ2V0JiZlbGVtZW50LndpZGdldC51cGRhdGVNb2RpZmllcnNWYWx1ZSl7ZWxlbWVudC53aWRnZXQudXBkYXRlTW9kaWZpZXJzVmFsdWUobW9kaWZpZXJzKTt9CmlmKGVsZW1lbnQuY2FsbGJhY2spe2VsZW1lbnQuY2FsbGJhY2soZWxlbWVudCxtb2RpZmllcnMscmVjb3JkKTt9fX0sX2NhbldpZGdldEJlU2F2ZWQ6ZnVuY3Rpb24od2lkZ2V0KXt2YXIgbW9kaWZpZXJzPXRoaXMuX2dldEV2YWx1YXRlZE1vZGlmaWVycyh3aWRnZXQuX19ub2RlLHdpZGdldC5yZWNvcmQpO3JldHVybiB3aWRnZXQuaXNWYWxpZCgpJiYod2lkZ2V0LmlzU2V0KCl8fCFtb2RpZmllcnMucmVxdWlyZWQpO30sX2Rlc3Ryb3lGaWVsZFdpZGdldDpmdW5jdGlvbihyZWNvcmRJRCx3aWRnZXQpe3ZhciByZWNvcmRXaWRnZXRzPXRoaXMuYWxsRmllbGRXaWRnZXRzW3JlY29yZElEXTt2YXIgaW5kZXg9cmVjb3JkV2lkZ2V0cy5pbmRleE9mKHdpZGdldCk7aWYoaW5kZXg+PTApe3JlY29yZFdpZGdldHMuc3BsaWNlKGluZGV4LDEpO30KdGhpcy5fdW5yZWdpc3Rlck1vZGlmaWVyc0VsZW1lbnQod2lkZ2V0Ll9fbm9kZSxyZWNvcmRJRCx3aWRnZXQpO3dpZGdldC5kZXN0cm95KCk7cmV0dXJuIGluZGV4O30sX2dldEV2YWx1YXRlZE1vZGlmaWVyczpmdW5jdGlvbihub2RlLHJlY29yZCl7dmFyIGVsZW1lbnQ9dGhpcy5fZ2V0TW9kaWZpZXJzRGF0YShub2RlKTtpZighZWxlbWVudCl7cmV0dXJue307fQpyZXR1cm4gZWxlbWVudC5ldmFsdWF0ZWRNb2RpZmllcnNbcmVjb3JkLmlkXXx8e307fSxfZ2V0TW9kaWZpZXJzRGF0YTpmdW5jdGlvbihub2RlKXtyZXR1cm4gXy5maW5kV2hlcmUodGhpcy5hbGxNb2RpZmllcnNEYXRhLHtub2RlOm5vZGV9KTt9LF9nZXRSZWNvcmQ6ZnVuY3Rpb24ocmVjb3JkSWQpe3JldHVybiBudWxsO30sX2hhbmRsZUF0dHJpYnV0ZXM6ZnVuY3Rpb24oJGVsLG5vZGUpe2lmKCRlbC5pcygnYnV0dG9uJykpe3JldHVybjt9CmlmKG5vZGUuYXR0cnMuY2xhc3MpeyRlbC5hZGRDbGFzcyhub2RlLmF0dHJzLmNsYXNzKTt9CmlmKG5vZGUuYXR0cnMuc3R5bGUpeyRlbC5hdHRyKCdzdHlsZScsbm9kZS5hdHRycy5zdHlsZSk7fQppZihub2RlLmF0dHJzLnBsYWNlaG9sZGVyKXskZWwuYXR0cigncGxhY2Vob2xkZXInLG5vZGUuYXR0cnMucGxhY2Vob2xkZXIpO319LF9oYXNDb250ZW50OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc3RhdGUuY291bnQhPT0wO30sX21vdmVSZWNvcmQ6ZnVuY3Rpb24ocmVjb3JkSWQsdG9JbmRleCl7dmFyIHNlbGY9dGhpczt2YXIgcmVjb3Jkcz10aGlzLnN0YXRlLmRhdGE7dmFyIHJlY29yZD1fLmZpbmRXaGVyZShyZWNvcmRzLHtpZDpyZWNvcmRJZH0pO3ZhciBmcm9tSW5kZXg9cmVjb3Jkcy5pbmRleE9mKHJlY29yZCk7dmFyIGxvd2VySW5kZXg9TWF0aC5taW4oZnJvbUluZGV4LHRvSW5kZXgpO3ZhciB1cHBlckluZGV4PU1hdGgubWF4KGZyb21JbmRleCx0b0luZGV4KSsxO3ZhciBvcmRlcj1fLmZpbmRXaGVyZSh0aGlzLnN0YXRlLm9yZGVyZWRCeSx7bmFtZTp0aGlzLmhhbmRsZUZpZWxkfSk7dmFyIGFzYz0hb3JkZXJ8fG9yZGVyLmFzYzt2YXIgcmVvcmRlckFsbD1mYWxzZTt2YXIgc2VxdWVuY2U9KGFzYz8tMToxKSpJbmZpbml0eTtfLmVhY2gocmVjb3JkcyxmdW5jdGlvbihyZWNvcmQsaW5kZXgpe2lmKChpbmRleDxsb3dlckluZGV4fHxpbmRleD49dXBwZXJJbmRleCkmJigoYXNjJiZzZXF1ZW5jZT49cmVjb3JkLmRhdGFbc2VsZi5oYW5kbGVGaWVsZF0pfHwoIWFzYyYmc2VxdWVuY2U8PXJlY29yZC5kYXRhW3NlbGYuaGFuZGxlRmllbGRdKSkpe3Jlb3JkZXJBbGw9dHJ1ZTt9CnNlcXVlbmNlPXJlY29yZC5kYXRhW3NlbGYuaGFuZGxlRmllbGRdO30pO2lmKHJlb3JkZXJBbGwpe3JlY29yZHM9Xy53aXRob3V0KHJlY29yZHMscmVjb3JkKTtyZWNvcmRzLnNwbGljZSh0b0luZGV4LDAscmVjb3JkKTt9ZWxzZXtyZWNvcmRzPXJlY29yZHMuc2xpY2UobG93ZXJJbmRleCx1cHBlckluZGV4KTtyZWNvcmRzPV8ud2l0aG91dChyZWNvcmRzLHJlY29yZCk7aWYoZnJvbUluZGV4PnRvSW5kZXgpe3JlY29yZHMudW5zaGlmdChyZWNvcmQpO31lbHNle3JlY29yZHMucHVzaChyZWNvcmQpO319CnZhciBzZXF1ZW5jZXM9Xy5wbHVjayhfLnBsdWNrKHJlY29yZHMsJ2RhdGEnKSx0aGlzLmhhbmRsZUZpZWxkKTt2YXIgcmVjb3JkSWRzPV8ucGx1Y2socmVjb3JkcywnaWQnKTtpZighYXNjKXtyZWNvcmRJZHMucmV2ZXJzZSgpO30KdGhpcy50cmlnZ2VyX3VwKCdyZXNlcXVlbmNlX3JlY29yZHMnLHtoYW5kbGVGaWVsZDp0aGlzLmhhbmRsZUZpZWxkLG9mZnNldDpfLm1pbihzZXF1ZW5jZXMpLHJlY29yZElkczpyZWNvcmRJZHMsfSk7fSxfcG9zdFByb2Nlc3NGaWVsZDpmdW5jdGlvbih3aWRnZXQsbm9kZSl7dGhpcy5faGFuZGxlQXR0cmlidXRlcyh3aWRnZXQuJGVsLG5vZGUpO30sX3JlZ2lzdGVyTW9kaWZpZXJzOmZ1bmN0aW9uKG5vZGUscmVjb3JkLGVsZW1lbnQsb3B0aW9ucyl7b3B0aW9ucz1vcHRpb25zfHx7fTt2YXIgbW9kaWZpZXJzRGF0YT10aGlzLl9nZXRNb2RpZmllcnNEYXRhKG5vZGUpO2lmKCFtb2RpZmllcnNEYXRhKXt2YXIgbW9kaWZpZXJzPW5vZGUuYXR0cnMubW9kaWZpZXJzfHx7fTttb2RpZmllcnNEYXRhPXtub2RlOm5vZGUsbW9kaWZpZXJzOm1vZGlmaWVycyxldmFsdWF0ZWRNb2RpZmllcnM6e30sZWxlbWVudHNCeVJlY29yZDp7fSxiYXNlTW9kZUJ5UmVjb3JkOnt9LH07aWYoIV8uaXNFbXB0eShtb2RpZmllcnMpKXt0aGlzLmFsbE1vZGlmaWVyc0RhdGEucHVzaChtb2RpZmllcnNEYXRhKTt9fQppZighbW9kaWZpZXJzRGF0YS5iYXNlTW9kZUJ5UmVjb3JkW3JlY29yZC5pZF18fCFvcHRpb25zLmtlZXBCYXNlTW9kZSl7bW9kaWZpZXJzRGF0YS5iYXNlTW9kZUJ5UmVjb3JkW3JlY29yZC5pZF09b3B0aW9ucy5tb2RlfHx0aGlzLm1vZGU7fQppZighbW9kaWZpZXJzRGF0YS5ldmFsdWF0ZWRNb2RpZmllcnNbcmVjb3JkLmlkXSl7bW9kaWZpZXJzRGF0YS5ldmFsdWF0ZWRNb2RpZmllcnNbcmVjb3JkLmlkXT1yZWNvcmQuZXZhbE1vZGlmaWVycyhtb2RpZmllcnNEYXRhLm1vZGlmaWVycyk7fQppZihlbGVtZW50KXt2YXIgbmV3RWxlbWVudD17fTtpZihlbGVtZW50IGluc3RhbmNlb2YgalF1ZXJ5KXtuZXdFbGVtZW50LiRlbD1lbGVtZW50O31lbHNle25ld0VsZW1lbnQud2lkZ2V0PWVsZW1lbnQ7bmV3RWxlbWVudC4kZWw9ZWxlbWVudC4kZWw7fQppZihvcHRpb25zJiZvcHRpb25zLmNhbGxiYWNrKXtuZXdFbGVtZW50LmNhbGxiYWNrPW9wdGlvbnMuY2FsbGJhY2s7fQppZighbW9kaWZpZXJzRGF0YS5lbGVtZW50c0J5UmVjb3JkW3JlY29yZC5pZF0pe21vZGlmaWVyc0RhdGEuZWxlbWVudHNCeVJlY29yZFtyZWNvcmQuaWRdPVtdO30KbW9kaWZpZXJzRGF0YS5lbGVtZW50c0J5UmVjb3JkW3JlY29yZC5pZF0ucHVzaChuZXdFbGVtZW50KTt0aGlzLl9hcHBseU1vZGlmaWVycyhtb2RpZmllcnNEYXRhLHJlY29yZCxuZXdFbGVtZW50LG9wdGlvbnMpO30KcmV0dXJuIG1vZGlmaWVyc0RhdGEuZXZhbHVhdGVkTW9kaWZpZXJzW3JlY29yZC5pZF07fSxfcmVuZGVyOmZ1bmN0aW9uKCl7dmFyIG9sZEFsbEZpZWxkV2lkZ2V0cz10aGlzLmFsbEZpZWxkV2lkZ2V0czt0aGlzLmFsbEZpZWxkV2lkZ2V0cz17fTt0aGlzLmFsbE1vZGlmaWVyc0RhdGE9W107dmFyIG9sZFdpZGdldHM9dGhpcy53aWRnZXRzO3RoaXMud2lkZ2V0cz1bXTtyZXR1cm4gdGhpcy5fcmVuZGVyVmlldygpLnRoZW4oZnVuY3Rpb24oKXtfLmVhY2gob2xkQWxsRmllbGRXaWRnZXRzLGZ1bmN0aW9uKHJlY29yZFdpZGdldHMpe18uZWFjaChyZWNvcmRXaWRnZXRzLGZ1bmN0aW9uKHdpZGdldCl7d2lkZ2V0LmRlc3Ryb3koKTt9KTt9KTtfLmludm9rZShvbGRXaWRnZXRzLCdkZXN0cm95Jyk7fSk7fSxfcmVuZGVyRmllbGRXaWRnZXQ6ZnVuY3Rpb24obm9kZSxyZWNvcmQsb3B0aW9ucyl7b3B0aW9ucz1vcHRpb25zfHx7fTt2YXIgZmllbGROYW1lPW5vZGUuYXR0cnMubmFtZTt2YXIgbW9kZT1vcHRpb25zLm1vZGV8fHRoaXMubW9kZTt2YXIgbW9kaWZpZXJzPXRoaXMuX3JlZ2lzdGVyTW9kaWZpZXJzKG5vZGUscmVjb3JkLG51bGwsb3B0aW9ucyk7dmFyIFdpZGdldD1yZWNvcmQuZmllbGRzSW5mb1t0aGlzLnZpZXdUeXBlXVtmaWVsZE5hbWVdLldpZGdldDt2YXIgd2lkZ2V0PW5ldyBXaWRnZXQodGhpcyxmaWVsZE5hbWUscmVjb3JkLHttb2RlOm1vZGlmaWVycy5yZWFkb25seT8ncmVhZG9ubHknOm1vZGUsdmlld1R5cGU6dGhpcy52aWV3VHlwZSx9KTtpZih0aGlzLmFsbEZpZWxkV2lkZ2V0c1tyZWNvcmQuaWRdPT09dW5kZWZpbmVkKXt0aGlzLmFsbEZpZWxkV2lkZ2V0c1tyZWNvcmQuaWRdPVtdO30KdGhpcy5hbGxGaWVsZFdpZGdldHNbcmVjb3JkLmlkXS5wdXNoKHdpZGdldCk7d2lkZ2V0Ll9fbm9kZT1ub2RlO3ZhciBkZWY9d2lkZ2V0Ll93aWRnZXRSZW5kZXJBbmRJbnNlcnQoZnVuY3Rpb24oKXt9KTt2YXIgJGVsPSQoJzxkaXY+Jyk7dGhpcy5kZWZzLnB1c2goZGVmKTt2YXIgc2VsZj10aGlzO2RlZi50aGVuKGZ1bmN0aW9uKCl7d2lkZ2V0LiRlbC5hZGRDbGFzcygkZWwuYXR0cignY2xhc3MnKSk7JGVsLnJlcGxhY2VXaXRoKHdpZGdldC4kZWwpO3NlbGYuX3JlZ2lzdGVyTW9kaWZpZXJzKG5vZGUscmVjb3JkLHdpZGdldCx7Y2FsbGJhY2s6ZnVuY3Rpb24oZWxlbWVudCxtb2RpZmllcnMscmVjb3JkKXtlbGVtZW50LiRlbC50b2dnbGVDbGFzcygnb19maWVsZF9lbXB0eScsISEocmVjb3JkLmRhdGEuaWQmJihtb2RpZmllcnMucmVhZG9ubHl8fG1vZGU9PT0ncmVhZG9ubHknKSYmIWVsZW1lbnQud2lkZ2V0LmlzU2V0KCkpKTt9LGtlZXBCYXNlTW9kZTohIW9wdGlvbnMua2VlcEJhc2VNb2RlLG1vZGU6bW9kZSx9KTtzZWxmLl9wb3N0UHJvY2Vzc0ZpZWxkKHdpZGdldCxub2RlKTt9KTtyZXR1cm4gJGVsO30sX3JlbmRlck5vQ29udGVudEhlbHBlcjpmdW5jdGlvbigpe3ZhciAkbm9Db250ZW50PSQoJzxkaXY+JykuaHRtbCh0aGlzLm5vQ29udGVudEhlbHApLmFkZENsYXNzKCdvX25vY29udGVudF9oZWxwJyk7cmV0dXJuICQoJzxkaXY+JykuYWRkQ2xhc3MoJ29fdmlld19ub2NvbnRlbnQnKS5hcHBlbmQoJG5vQ29udGVudCk7fSxfcmVuZGVyVmlldzpmdW5jdGlvbigpe3JldHVybiBQcm9taXNlLnJlc29sdmUoKTt9LF9yZW5kZXJXaWRnZXQ6ZnVuY3Rpb24ocmVjb3JkLG5vZGUpe3ZhciBXaWRnZXQ9d2lkZ2V0UmVnaXN0cnkuZ2V0KG5vZGUuYXR0cnMubmFtZSk7dmFyIHdpZGdldD1uZXcgV2lkZ2V0KHRoaXMscmVjb3JkLG5vZGUpO3RoaXMud2lkZ2V0cy5wdXNoKHdpZGdldCk7dmFyIGRlZj13aWRnZXQuX3dpZGdldFJlbmRlckFuZEluc2VydChmdW5jdGlvbigpe30pO3RoaXMuZGVmcy5wdXNoKGRlZik7dmFyICRlbD0kKCc8ZGl2PicpO3ZhciBzZWxmPXRoaXM7ZGVmLnRoZW4oZnVuY3Rpb24oKXtzZWxmLl9oYW5kbGVBdHRyaWJ1dGVzKHdpZGdldC4kZWwsbm9kZSk7c2VsZi5fcmVnaXN0ZXJNb2RpZmllcnMobm9kZSxyZWNvcmQsd2lkZ2V0KTt3aWRnZXQuJGVsLmFkZENsYXNzKCdvX3dpZGdldCcpOyRlbC5yZXBsYWNlV2l0aCh3aWRnZXQuJGVsKTt9KTtyZXR1cm4gJGVsO30sX3JlcmVuZGVyRmllbGRXaWRnZXQ6ZnVuY3Rpb24od2lkZ2V0LHJlY29yZCxvcHRpb25zKXt2YXIgJGVsPXRoaXMuX3JlbmRlckZpZWxkV2lkZ2V0KHdpZGdldC5fX25vZGUscmVjb3JkLG9wdGlvbnMpO3dpZGdldC4kZWwucmVwbGFjZVdpdGgoJGVsKTt2YXIgb2xkSW5kZXg9dGhpcy5fZGVzdHJveUZpZWxkV2lkZ2V0KHJlY29yZC5pZCx3aWRnZXQpO3ZhciByZWNvcmRXaWRnZXRzPXRoaXMuYWxsRmllbGRXaWRnZXRzW3JlY29yZC5pZF07dmFyIG5ld1dpZGdldD1yZWNvcmRXaWRnZXRzLnBvcCgpO3JlY29yZFdpZGdldHMuc3BsaWNlKG9sZEluZGV4LDAsbmV3V2lkZ2V0KTt9LF91bnJlZ2lzdGVyTW9kaWZpZXJzRWxlbWVudDpmdW5jdGlvbihub2RlLHJlY29yZElELGVsZW1lbnQpe3ZhciBtb2RpZmllcnNEYXRhPXRoaXMuX2dldE1vZGlmaWVyc0RhdGEobm9kZSk7aWYobW9kaWZpZXJzRGF0YSl7dmFyIGVsZW1lbnRzPW1vZGlmaWVyc0RhdGEuZWxlbWVudHNCeVJlY29yZFtyZWNvcmRJRF07dmFyIGluZGV4PV8uZmluZEluZGV4KGVsZW1lbnRzLGZ1bmN0aW9uKG9sZEVsZW1lbnQpe3JldHVybiBvbGRFbGVtZW50LndpZGdldD09PWVsZW1lbnR8fG9sZEVsZW1lbnQuJGVsWzBdPT09ZWxlbWVudFswXTt9KTtpZihpbmRleD49MCl7ZWxlbWVudHMuc3BsaWNlKGluZGV4LDEpO319fSxfdXBkYXRlQWxsTW9kaWZpZXJzOmZ1bmN0aW9uKHJlY29yZCl7dmFyIHNlbGY9dGhpczt2YXIgZGVmcz1bXTt0aGlzLmRlZnM9ZGVmcztfLmVhY2godGhpcy5hbGxNb2RpZmllcnNEYXRhLGZ1bmN0aW9uKG1vZGlmaWVyc0RhdGEpe2lmKHJlY29yZC5pZCBpbiBtb2RpZmllcnNEYXRhLmV2YWx1YXRlZE1vZGlmaWVycyl7bW9kaWZpZXJzRGF0YS5ldmFsdWF0ZWRNb2RpZmllcnNbcmVjb3JkLmlkXT1yZWNvcmQuZXZhbE1vZGlmaWVycyhtb2RpZmllcnNEYXRhLm1vZGlmaWVycyk7c2VsZi5fYXBwbHlNb2RpZmllcnMobW9kaWZpZXJzRGF0YSxyZWNvcmQpO319KTtkZWxldGUgdGhpcy5kZWZzO3JldHVybiBQcm9taXNlLmFsbChkZWZzKTt9LF9vbk5hdmlnYXRpb25Nb3ZlOmZ1bmN0aW9uKGV2KXt9LH0pO3JldHVybiBCYXNpY1JlbmRlcmVyO30pOzsKCi8qIC93ZWIvc3RhdGljL3NyYy9qcy92aWV3cy9jb250cm9sX3BhbmVsL2NvbnRyb2xfcGFuZWxfY29udHJvbGxlci5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwpvZG9vLmRlZmluZSgnd2ViLkNvbnRyb2xQYW5lbENvbnRyb2xsZXInLGZ1bmN0aW9uKHJlcXVpcmUpeyJ1c2Ugc3RyaWN0Ijt2YXIgbXZjPXJlcXVpcmUoJ3dlYi5tdmMnKTt2YXIgQ29udHJvbFBhbmVsQ29udHJvbGxlcj1tdmMuQ29udHJvbGxlci5leHRlbmQoe2NsYXNzTmFtZTonb19jcF9jb250cm9sbGVyJyxjdXN0b21fZXZlbnRzOntmYWNldF9yZW1vdmVkOidfb25GYWNldFJlbW92ZWQnLGdldF9zZWFyY2hfcXVlcnk6J19vbkdldFNlYXJjaFF1ZXJ5JyxpdGVtX29wdGlvbl9jbGlja2VkOidfb25JdGVtT3B0aW9uQ2xpY2tlZCcsaXRlbV90cmFzaGVkOidfb25JdGVtVHJhc2hlZCcsbWVudV9pdGVtX2NsaWNrZWQ6J19vbk1lbnVJdGVtQ2xpY2tlZCcsbmV3X2Zhdm9yaXRlOidfb25OZXdGYXZvcml0ZScsbmV3X2ZpbHRlcnM6J19vbk5ld0ZpbHRlcnMnLG5ld19ncm91cEJ5Oidfb25OZXdHcm91cEJ5JyxhY3RpdmF0ZV90aW1lX3JhbmdlOidfb25BY3RpdmF0ZVRpbWVSYW5nZScsYXV0b2NvbXBsZXRpb25fZmlsdGVyOidfb25BdXRvQ29tcGxldGlvbkZpbHRlcicscmVsb2FkOidfb25SZWxvYWQnLHJlc2V0Oidfb25SZXNldCcsfSxpbml0OmZ1bmN0aW9uKHBhcmVudCxtb2RlbCxyZW5kZXJlcixwYXJhbXMpe3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLm1vZGVsTmFtZT1wYXJhbXMubW9kZWxOYW1lO30sb25fYXR0YWNoX2NhbGxiYWNrOmZ1bmN0aW9uKCl7dGhpcy5yZW5kZXJlci5vbl9hdHRhY2hfY2FsbGJhY2soKTt9LG9uX2RldGFjaF9jYWxsYmFjazpmdW5jdGlvbigpe3RoaXMucmVuZGVyZXIub25fZGV0YWNoX2NhbGxiYWNrKCk7fSxleHBvcnRTdGF0ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLm1vZGVsLmV4cG9ydFN0YXRlKCk7fSxmb2N1c1NlYXJjaEJhcjpmdW5jdGlvbigpe2lmKHRoaXMucmVuZGVyZXIuc2VhcmNoQmFyKXt0aGlzLnJlbmRlcmVyLnNlYXJjaEJhci5mb2N1cygpO319LGdldFNlYXJjaFF1ZXJ5OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubW9kZWwuZ2V0UXVlcnkoKTt9LGltcG9ydFN0YXRlOmZ1bmN0aW9uKHN0YXRlKXt2YXIgZGVmcz1bXTt0aGlzLm1vZGVsLmltcG9ydFN0YXRlKHN0YXRlKTtkZWZzLnB1c2godGhpcy5nZXRTZWFyY2hRdWVyeSgpKTtkZWZzLnB1c2godGhpcy5yZW5kZXJlci51cGRhdGVTdGF0ZSh0aGlzLm1vZGVsLmdldCgpKSk7cmV0dXJuIFByb21pc2UuYWxsKGRlZnMpLnRoZW4oZnVuY3Rpb24oZGVmc1Jlc3VsdHMpe3JldHVybiBkZWZzUmVzdWx0c1swXTt9KTt9LHNldENvbnRyb2xsZXJJRDpmdW5jdGlvbihjb250cm9sbGVySUQpe3RoaXMuY29udHJvbGxlcklEPWNvbnRyb2xsZXJJRDt9LHVwZGF0ZUNvbnRlbnRzOmZ1bmN0aW9uKHN0YXR1cyxvcHRpb25zKXt0aGlzLnJlbmRlcmVyLnVwZGF0ZUNvbnRlbnRzKHN0YXR1cyxvcHRpb25zKTt9LHVwZGF0ZUZpbHRlcnM6ZnVuY3Rpb24obmV3RmlsdGVycyxmaWx0ZXJzVG9SZW1vdmUpe3ZhciBuZXdGaWx0ZXJJRFM9dGhpcy5tb2RlbC5jcmVhdGVOZXdGaWx0ZXJzKG5ld0ZpbHRlcnMpO3RoaXMubW9kZWwuZGVhY3RpdmF0ZUZpbHRlcnMoZmlsdGVyc1RvUmVtb3ZlKTt0aGlzLl9yZXBvcnROZXdRdWVyeUFuZFJlbmRlcigpO3JldHVybiBuZXdGaWx0ZXJJRFM7fSxfZ2V0U3ViTWVudXM6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5yZW5kZXJlci4kc3ViTWVudXM7fSxfcmVwb3J0TmV3UXVlcnlBbmRSZW5kZXI6ZnVuY3Rpb24oKXt0aGlzLnRyaWdnZXJfdXAoJ3NlYXJjaCcsdGhpcy5tb2RlbC5nZXRRdWVyeSgpKTt2YXIgc3RhdGU9dGhpcy5tb2RlbC5nZXQoKTtyZXR1cm4gdGhpcy5yZW5kZXJlci51cGRhdGVTdGF0ZShzdGF0ZSk7fSxfb25BY3RpdmF0ZVRpbWVSYW5nZTpmdW5jdGlvbihldil7ZXYuc3RvcFByb3BhZ2F0aW9uKCk7dGhpcy5tb2RlbC5hY3RpdmF0ZVRpbWVSYW5nZShldi5kYXRhLmlkLGV2LmRhdGEudGltZVJhbmdlSWQsZXYuZGF0YS5jb21wYXJpc29uVGltZVJhbmdlSWQpO3RoaXMuX3JlcG9ydE5ld1F1ZXJ5QW5kUmVuZGVyKCk7fSxfb25BdXRvQ29tcGxldGlvbkZpbHRlcjpmdW5jdGlvbihldil7ZXYuc3RvcFByb3BhZ2F0aW9uKCk7dGhpcy5tb2RlbC50b2dnbGVBdXRvQ29tcGxldGlvbkZpbHRlcihldi5kYXRhKTt0aGlzLl9yZXBvcnROZXdRdWVyeUFuZFJlbmRlcigpO30sX29uRmFjZXRSZW1vdmVkOmZ1bmN0aW9uKGV2KXtldi5zdG9wUHJvcGFnYXRpb24oKTt2YXIgZ3JvdXA9ZXYuZGF0YS5ncm91cHx8dGhpcy5yZW5kZXJlci5nZXRMYXN0RmFjZXQoKTtpZihncm91cCl7dGhpcy5tb2RlbC5kZWFjdGl2YXRlR3JvdXAoZ3JvdXAuaWQpO3RoaXMuX3JlcG9ydE5ld1F1ZXJ5QW5kUmVuZGVyKCk7fX0sX29uR2V0U2VhcmNoUXVlcnk6ZnVuY3Rpb24oZXYpe2V2LnN0b3BQcm9wYWdhdGlvbigpO3ZhciBxdWVyeT10aGlzLmdldFNlYXJjaFF1ZXJ5KCk7ZXYuZGF0YS5jYWxsYmFjayhxdWVyeSk7fSxfb25JdGVtT3B0aW9uQ2xpY2tlZDpmdW5jdGlvbihldil7ZXYuc3RvcFByb3BhZ2F0aW9uKCk7dGhpcy5tb2RlbC50b2dnbGVGaWx0ZXJXaXRoT3B0aW9ucyhldi5kYXRhLmlkLGV2LmRhdGEub3B0aW9uSWQpO3RoaXMuX3JlcG9ydE5ld1F1ZXJ5QW5kUmVuZGVyKCk7fSxfb25JdGVtVHJhc2hlZDpmdW5jdGlvbihldil7ZXYuc3RvcFByb3BhZ2F0aW9uKCk7dmFyIGRlZj10aGlzLm1vZGVsLmRlbGV0ZUZpbHRlckV2ZXJ5d2hlcmUoZXYuZGF0YS5pZCk7ZGVmLnRoZW4odGhpcy5fcmVwb3J0TmV3UXVlcnlBbmRSZW5kZXIuYmluZCh0aGlzKSk7fSxfb25NZW51SXRlbUNsaWNrZWQ6ZnVuY3Rpb24oZXYpe2V2LnN0b3BQcm9wYWdhdGlvbigpO3RoaXMubW9kZWwudG9nZ2xlRmlsdGVyKGV2LmRhdGEuaWQpO3RoaXMuX3JlcG9ydE5ld1F1ZXJ5QW5kUmVuZGVyKCk7fSxfb25OZXdGYXZvcml0ZTpmdW5jdGlvbihldil7ZXYuc3RvcFByb3BhZ2F0aW9uKCk7dmFyIGRlZj10aGlzLm1vZGVsLmNyZWF0ZU5ld0Zhdm9yaXRlKGV2LmRhdGEpO2RlZi50aGVuKHRoaXMuX3JlcG9ydE5ld1F1ZXJ5QW5kUmVuZGVyLmJpbmQodGhpcykpO30sX29uTmV3RmlsdGVyczpmdW5jdGlvbihldil7ZXYuc3RvcFByb3BhZ2F0aW9uKCk7dGhpcy5tb2RlbC5jcmVhdGVOZXdGaWx0ZXJzKGV2LmRhdGEuZmlsdGVycyk7dGhpcy5fcmVwb3J0TmV3UXVlcnlBbmRSZW5kZXIoKTt9LF9vbk5ld0dyb3VwQnk6ZnVuY3Rpb24oZXYpe2V2LnN0b3BQcm9wYWdhdGlvbigpO3RoaXMubW9kZWwuY3JlYXRlTmV3R3JvdXBCeShldi5kYXRhKTt0aGlzLl9yZXBvcnROZXdRdWVyeUFuZFJlbmRlcigpO30sX29uUmVsb2FkOmZ1bmN0aW9uKGV2KXtldi5zdG9wUHJvcGFnYXRpb24oKTt0aGlzLnRyaWdnZXJfdXAoJ3NlYXJjaCcsdGhpcy5tb2RlbC5nZXRRdWVyeSgpKTt9LF9vblJlc2V0OmZ1bmN0aW9uKGV2KXtldi5zdG9wUHJvcGFnYXRpb24oKTt2YXIgc3RhdGU9dGhpcy5tb2RlbC5nZXQoKTt0aGlzLnJlbmRlcmVyLnVwZGF0ZVN0YXRlKHN0YXRlKTt9LH0pO3JldHVybiBDb250cm9sUGFuZWxDb250cm9sbGVyO30pOzsKCi8qIC93ZWIvc3RhdGljL3NyYy9qcy92aWV3cy9jb250cm9sX3BhbmVsL2NvbnRyb2xfcGFuZWxfbW9kZWwuanMgZGVmaW5lZCBpbiBidW5kbGUgJ3dlYi5hc3NldHNfYmFja2VuZCcgKi8Kb2Rvby5kZWZpbmUoJ3dlYi5Db250cm9sUGFuZWxNb2RlbCcsZnVuY3Rpb24ocmVxdWlyZSl7InVzZSBzdHJpY3QiO3ZhciBjb250cm9sUGFuZWxWaWV3UGFyYW1ldGVycz1yZXF1aXJlKCd3ZWIuY29udHJvbFBhbmVsVmlld1BhcmFtZXRlcnMnKTt2YXIgY29yZT1yZXF1aXJlKCd3ZWIuY29yZScpO3ZhciBEb21haW49cmVxdWlyZSgnd2ViLkRvbWFpbicpO3ZhciBtdmM9cmVxdWlyZSgnd2ViLm12YycpO3ZhciBweVV0aWxzPXJlcXVpcmUoJ3dlYi5weV91dGlscycpO3ZhciBzZWFyY2hCYXJBdXRvY29tcGxldGVSZWdpc3RyeT1yZXF1aXJlKCd3ZWIuc2VhcmNoX2Jhcl9hdXRvY29tcGxldGVfc291cmNlc19yZWdpc3RyeScpO3ZhciBzZXNzaW9uPXJlcXVpcmUoJ3dlYi5zZXNzaW9uJyk7dmFyIF90PWNvcmUuX3Q7Y29uc3QgREVGQVVMVF9USU1FUkFOR0U9Y29udHJvbFBhbmVsVmlld1BhcmFtZXRlcnMuREVGQVVMVF9USU1FUkFOR0U7bGV0IFRJTUVfUkFOR0VfT1BUSU9OUz1jb250cm9sUGFuZWxWaWV3UGFyYW1ldGVycy5USU1FX1JBTkdFX09QVElPTlM7bGV0IENPTVBBUklTT05fVElNRV9SQU5HRV9PUFRJT05TPWNvbnRyb2xQYW5lbFZpZXdQYXJhbWV0ZXJzLkNPTVBBUklTT05fVElNRV9SQU5HRV9PUFRJT05TO2NvbnN0IE9QVElPTl9HRU5FUkFUT1JTPWNvbnRyb2xQYW5lbFZpZXdQYXJhbWV0ZXJzLk9QVElPTl9HRU5FUkFUT1JTO2NvbnN0IFlFQVJfT1BUSU9OUz1jb250cm9sUGFuZWxWaWV3UGFyYW1ldGVycy5ZRUFSX09QVElPTlM7ZnVuY3Rpb24gaXNFcXVhbFRvKGFycmF5MSl7aWYoYXJyYXkxLmxlbmd0aD09PTEpe3JldHVybiBhcnJheTI9PmFycmF5Mi5sZW5ndGg9PT0xJiZhcnJheTJbMF09PT1hcnJheTFbMF07fWVsc2V7cmV0dXJuIGFycmF5Mj0+YXJyYXkyLmxlbmd0aD09PTImJmFycmF5MlswXT09PWFycmF5MVswXSYmYXJyYXkyWzFdPT09YXJyYXkxWzFdO319CnZhciBDb250cm9sUGFuZWxNb2RlbD1tdmMuTW9kZWwuZXh0ZW5kKHtpbml0OmZ1bmN0aW9uKHBhcmVudCxwYXJhbXMpe3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtUSU1FX1JBTkdFX09QVElPTlM9VElNRV9SQU5HRV9PUFRJT05TLm1hcChmdW5jdGlvbihvcHRpb24pe3JldHVybiBfLmV4dGVuZCh7fSxvcHRpb24se2Rlc2NyaXB0aW9uOm9wdGlvbi5kZXNjcmlwdGlvbi50b1N0cmluZygpfSk7fSk7Q09NUEFSSVNPTl9USU1FX1JBTkdFX09QVElPTlM9Q09NUEFSSVNPTl9USU1FX1JBTkdFX09QVElPTlMubWFwKGZ1bmN0aW9uKG9wdGlvbil7cmV0dXJuIF8uZXh0ZW5kKHt9LG9wdGlvbix7ZGVzY3JpcHRpb246b3B0aW9uLmRlc2NyaXB0aW9uLnRvU3RyaW5nKCl9KTt9KTt0aGlzLm1vZGVsTmFtZT1wYXJhbXMubW9kZWxOYW1lO3RoaXMuZmllbGRzPXBhcmFtcy5maWVsZHN8fHt9O3RoaXMuYWN0aW9uSWQ9cGFyYW1zLmFjdGlvbklkO3RoaXMuYWN0aW9uQ29udGV4dD1wYXJhbXMuY29udGV4dHx8e307dGhpcy5hY3Rpb25Eb21haW49cGFyYW1zLmRvbWFpbnx8W107dGhpcy5maWx0ZXJzPXt9O3RoaXMuZ3JvdXBzPXt9O3RoaXMucXVlcnk9W107fSxhY3RpdmF0ZVRpbWVSYW5nZTpmdW5jdGlvbihmaWx0ZXJJZCx0aW1lUmFuZ2VJZCxjb21wYXJpc29uVGltZVJhbmdlSWQpe3ZhciBmaWx0ZXI9dGhpcy5maWx0ZXJzW2ZpbHRlcklkXTtmaWx0ZXIudGltZVJhbmdlSWQ9dGltZVJhbmdlSWR8fGZpbHRlci5kZWZhdWx0VGltZVJhbmdlSWQ7ZmlsdGVyLmNvbXBhcmlzb25UaW1lUmFuZ2VJZD1jb21wYXJpc29uVGltZVJhbmdlSWQ7dmFyIGdyb3VwPXRoaXMuZ3JvdXBzW2ZpbHRlci5ncm91cElkXTt2YXIgZ3JvdXBBY3RpdmU9Z3JvdXAuYWN0aXZlRmlsdGVySWRzLmxlbmd0aDtpZihncm91cEFjdGl2ZSl7Z3JvdXAuYWN0aXZlRmlsdGVySWRzPVtbZmlsdGVySWRdXTt9ZWxzZXt0aGlzLnRvZ2dsZUZpbHRlcihmaWx0ZXJJZCk7fX0sY3JlYXRlTmV3RmF2b3JpdGU6ZnVuY3Rpb24obmV3RmF2b3JpdGUpe3JldHVybiB0aGlzLl9zYXZlUXVlcnkoXy5waWNrKG5ld0Zhdm9yaXRlLFsnZGVzY3JpcHRpb24nLCdpc0RlZmF1bHQnLCdpc1NoYXJlZCcsJ3R5cGUnXSkpLnRoZW4oZnVuY3Rpb24oKXtuZXdGYXZvcml0ZS5vbl9zdWNjZXNzKCk7fSk7fSxjcmVhdGVOZXdGaWx0ZXJzOmZ1bmN0aW9uKG5ld0ZpbHRlcnMpe3ZhciBzZWxmPXRoaXM7dmFyIGZpbHRlcklkcz1bXTt2YXIgZ3JvdXBOdW1iZXI9dGhpcy5fZ2VuZXJhdGVOZXdHcm91cE51bWJlcigpO3RoaXMuX2NyZWF0ZUdyb3VwT2ZGaWx0ZXJzKG5ld0ZpbHRlcnMpO25ld0ZpbHRlcnMuZm9yRWFjaChmdW5jdGlvbihmaWx0ZXIpe2ZpbHRlci5ncm91cE51bWJlcj1ncm91cE51bWJlcjtzZWxmLnRvZ2dsZUZpbHRlcihmaWx0ZXIuaWQpO2ZpbHRlcklkcy5wdXNoKGZpbHRlci5pZCk7fSk7cmV0dXJuIGZpbHRlcklkczt9LGNyZWF0ZU5ld0dyb3VwQnk6ZnVuY3Rpb24obmV3R3JvdXBCeSl7dmFyIGlkPV8udW5pcXVlSWQoJ19fZmlsdGVyX18nKTtuZXdHcm91cEJ5LmlkPWlkO25ld0dyb3VwQnkuZ3JvdXBJZD10aGlzLl9nZXRHcm91cElkT2ZUeXBlKCdncm91cEJ5Jyk7bmV3R3JvdXBCeS5ncm91cE51bWJlcj10aGlzLl9nZW5lcmF0ZU5ld0dyb3VwTnVtYmVyKCk7dGhpcy5maWx0ZXJzW2lkXT1uZXdHcm91cEJ5O2lmKF8uY29udGFpbnMoWydkYXRlJywnZGF0ZXRpbWUnXSxuZXdHcm91cEJ5LmZpZWxkVHlwZSkpe3RoaXMudG9nZ2xlRmlsdGVyV2l0aE9wdGlvbnMobmV3R3JvdXBCeS5pZCk7fWVsc2V7dGhpcy50b2dnbGVGaWx0ZXIobmV3R3JvdXBCeS5pZCk7fX0sZGVhY3RpdmF0ZUZpbHRlcnM6ZnVuY3Rpb24oZmlsdGVySWRzKXt2YXIgc2VsZj10aGlzO2ZpbHRlcklkcy5mb3JFYWNoKGZ1bmN0aW9uKGZpbHRlcklkKXt2YXIgZmlsdGVyPXNlbGYuZmlsdGVyc1tmaWx0ZXJJZF07dmFyIGdyb3VwPXNlbGYuZ3JvdXBzW2ZpbHRlci5ncm91cElkXTtpZihncm91cC5hY3RpdmVGaWx0ZXJJZHMuc29tZShpc0VxdWFsVG8oW2ZpbHRlcklkXSkpKXtzZWxmLnRvZ2dsZUZpbHRlcihmaWx0ZXJJZCk7fX0pO30sZGVhY3RpdmF0ZUdyb3VwOmZ1bmN0aW9uKGdyb3VwSWQpe3ZhciBzZWxmPXRoaXM7dmFyIGdyb3VwPXRoaXMuZ3JvdXBzW2dyb3VwSWRdO18uZWFjaChncm91cC5hY3RpdmVGaWx0ZXJJZHMsaWQ9Pnt2YXIgZmlsdGVyPXNlbGYuZmlsdGVyc1tpZFswXV07aWYoZmlsdGVyLmF1dG9Db21wbGV0ZVZhbHVlcyl7ZmlsdGVyLmF1dG9Db21wbGV0ZVZhbHVlcz1bXTt9CmlmKGZpbHRlci5jdXJyZW50T3B0aW9uSWRzKXtmaWx0ZXIuY3VycmVudE9wdGlvbklkcy5jbGVhcigpO319KTtncm91cC5hY3RpdmVGaWx0ZXJJZHM9W107dGhpcy5xdWVyeS5zcGxpY2UodGhpcy5xdWVyeS5pbmRleE9mKGdyb3VwSWQpLDEpO30sZGVsZXRlRmlsdGVyRXZlcnl3aGVyZTpmdW5jdGlvbihmaWx0ZXJJZCl7dmFyIHNlbGY9dGhpczt2YXIgZmlsdGVyPXRoaXMuZmlsdGVyc1tmaWx0ZXJJZF07dmFyIGRlZj10aGlzLmRlbGV0ZUZpbHRlcihmaWx0ZXIuc2VydmVyU2lkZUlkKS50aGVuKGZ1bmN0aW9uKCl7Y29uc3QgZ3JvdXBPZkZhdm9yaXRlcz1zZWxmLmdyb3Vwc1tmaWx0ZXIuZ3JvdXBJZF07Y29uc3QgaXNBY3RpdmU9Z3JvdXBPZkZhdm9yaXRlcy5hY3RpdmVGaWx0ZXJJZHMuc29tZShpc0VxdWFsVG8oW2ZpbHRlcklkXSkpO2lmKGlzQWN0aXZlKXtzZWxmLnRvZ2dsZUZpbHRlcihmaWx0ZXJJZCk7fQpkZWxldGUgc2VsZi5maWx0ZXJzW2ZpbHRlcklkXTt9KTtyZXR1cm4gZGVmO30sZXhwb3J0U3RhdGU6ZnVuY3Rpb24oKXtyZXR1cm57ZmlsdGVyczp0aGlzLmZpbHRlcnMsZ3JvdXBzOnRoaXMuZ3JvdXBzLHF1ZXJ5OnRoaXMucXVlcnksfTt9LGdldDpmdW5jdGlvbigpe3ZhciBzZWxmPXRoaXM7dmFyIGZpbHRlckZpZWxkcz1bXTt2YXIgZmlsdGVycz1bXTt2YXIgZ3JvdXBCeXM9W107dmFyIHRpbWVSYW5nZXM9W107dmFyIGZhdm9yaXRlcz1bXTtPYmplY3Qua2V5cyh0aGlzLmZpbHRlcnMpLmZvckVhY2goZnVuY3Rpb24oZmlsdGVySWQpe3ZhciBmaWx0ZXI9Xy5leHRlbmQoe30sc2VsZi5maWx0ZXJzW2ZpbHRlcklkXSk7dmFyIGdyb3VwPXNlbGYuZ3JvdXBzW2ZpbHRlci5ncm91cElkXTtmaWx0ZXIuaXNBY3RpdmU9Z3JvdXAuYWN0aXZlRmlsdGVySWRzLnNvbWUoaWQ9PmlkWzBdPT09ZmlsdGVySWQpO2lmKGZpbHRlci50eXBlPT09J2ZpZWxkJyl7ZmlsdGVyRmllbGRzLnB1c2goZmlsdGVyKTt9CmlmKGZpbHRlci50eXBlPT09J2ZpbHRlcicmJiFmaWx0ZXIuaW52aXNpYmxlKXtmaWx0ZXJzLnB1c2goZmlsdGVyKTt9CmlmKGZpbHRlci50eXBlPT09J2dyb3VwQnknKXtncm91cEJ5cy5wdXNoKGZpbHRlcik7fQppZihmaWx0ZXIudHlwZT09PSdmYXZvcml0ZScpe2Zhdm9yaXRlcy5wdXNoKGZpbHRlcik7fQppZihmaWx0ZXIudHlwZT09PSd0aW1lUmFuZ2UnKXt0aW1lUmFuZ2VzLnB1c2goZmlsdGVyKTt9fSk7dmFyIGZhY2V0cz10aGlzLl9nZXRGYWNldHMoKTtmYXZvcml0ZXM9Xy5zb3J0QnkoZmF2b3JpdGVzLCdncm91cE51bWJlcicpO3JldHVybntmYWNldHM6ZmFjZXRzLGZpbHRlckZpZWxkczpmaWx0ZXJGaWVsZHMsZmlsdGVyczpmaWx0ZXJzLGdyb3VwQnlzOmdyb3VwQnlzLHRpbWVSYW5nZXM6dGltZVJhbmdlcyxmYXZvcml0ZXM6ZmF2b3JpdGVzLGdyb3Vwczp0aGlzLmdyb3VwcyxxdWVyeTpfLmV4dGVuZChbXSx0aGlzLnF1ZXJ5KSxmaWVsZHM6dGhpcy5maWVsZHMsfTt9LGdldFF1ZXJ5OmZ1bmN0aW9uKCl7dmFyIHVzZXJDb250ZXh0PXNlc3Npb24udXNlcl9jb250ZXh0O3ZhciBjb250ZXh0PV8uZXh0ZW5kKHB5VXRpbHMuZXZhbCgnY29udGV4dHMnLHRoaXMuX2dldFF1ZXJ5Q29udGV4dCgpLHVzZXJDb250ZXh0KSx0aGlzLl9nZXRUaW1lUmFuZ2VNZW51RGF0YSh0cnVlKSk7dmFyIGRvbWFpbj1Eb21haW4ucHJvdG90eXBlLnN0cmluZ1RvQXJyYXkodGhpcy5fZ2V0RG9tYWluKCksdXNlckNvbnRleHQpO2lmKGNvbnRleHQudGltZVJhbmdlTWVudURhdGEpe2lmKHR5cGVvZiBjb250ZXh0LnRpbWVSYW5nZU1lbnVEYXRhLnRpbWVSYW5nZT09PSdzdHJpbmcnKXtjb250ZXh0LnRpbWVSYW5nZU1lbnVEYXRhLnRpbWVSYW5nZT1weVV0aWxzLmV2YWwoJ2RvbWFpbicsY29udGV4dC50aW1lUmFuZ2VNZW51RGF0YS50aW1lUmFuZ2UpO30KaWYodHlwZW9mIGNvbnRleHQudGltZVJhbmdlTWVudURhdGEuY29tcGFyaXNvblRpbWVSYW5nZT09PSdzdHJpbmcnKXtjb250ZXh0LnRpbWVSYW5nZU1lbnVEYXRhLmNvbXBhcmlzb25UaW1lUmFuZ2U9cHlVdGlscy5ldmFsKCdkb21haW4nLGNvbnRleHQudGltZVJhbmdlTWVudURhdGEuY29tcGFyaXNvblRpbWVSYW5nZSk7fX0KdmFyIGFjdGlvbl9jb250ZXh0PXRoaXMuYWN0aW9uQ29udGV4dDt2YXIgcmVzdWx0cz1weVV0aWxzLmV2YWxfZG9tYWluc19hbmRfY29udGV4dHMoe2RvbWFpbnM6W3RoaXMuYWN0aW9uRG9tYWluXS5jb25jYXQoW2RvbWFpbl18fFtdKSxjb250ZXh0czpbYWN0aW9uX2NvbnRleHRdLmNvbmNhdChjb250ZXh0fHxbXSksZXZhbF9jb250ZXh0OnNlc3Npb24udXNlcl9jb250ZXh0LH0pO2lmKHJlc3VsdHMuZXJyb3Ipe3Rocm93IG5ldyBFcnJvcihfLnN0ci5zcHJpbnRmKF90KCJGYWlsZWQgdG8gZXZhbHVhdGUgc2VhcmNoIGNyaXRlcmlvbnMiKSsiOiBcbiVzIixKU09OLnN0cmluZ2lmeShyZXN1bHRzLmVycm9yKSkpO30KdmFyIGdyb3VwQnlzPXRoaXMuX2dldEdyb3VwQnkoKTt2YXIgZ3JvdXBCeT1ncm91cEJ5cy5sZW5ndGg/Z3JvdXBCeXM6KHRoaXMuYWN0aW9uQ29udGV4dC5ncm91cF9ieXx8W10pO2dyb3VwQnk9KHR5cGVvZiBncm91cEJ5PT09J3N0cmluZycpP1tncm91cEJ5XTpncm91cEJ5O2NvbnRleHQ9Xy5vbWl0KHJlc3VsdHMuY29udGV4dCwndGltZV9yYW5nZXMnKTtyZXR1cm57Y29udGV4dDpjb250ZXh0LGRvbWFpbjpyZXN1bHRzLmRvbWFpbixncm91cEJ5Omdyb3VwQnksb3JkZXJlZEJ5OnRoaXMuX2dldE9yZGVyZWRCeSgpLH07fSxpbXBvcnRTdGF0ZTpmdW5jdGlvbihzdGF0ZSl7dGhpcy5maWx0ZXJzPXN0YXRlLmZpbHRlcnM7dGhpcy5ncm91cHM9c3RhdGUuZ3JvdXBzO3RoaXMucXVlcnk9c3RhdGUucXVlcnk7fSxsb2FkOmZ1bmN0aW9uKHBhcmFtcyl7dmFyIHNlbGY9dGhpczt0aGlzLnNlYXJjaE1lbnVUeXBlcz1wYXJhbXMuc2VhcmNoTWVudVR5cGVzfHxbXTt0aGlzLmFjdGl2YXRlRGVmYXVsdEZhdm9yaXRlPXBhcmFtcy5hY3RpdmF0ZURlZmF1bHRGYXZvcml0ZTtpZighcGFyYW1zLndpdGhTZWFyY2hCYXImJnBhcmFtcy5zZWFyY2hNZW51VHlwZXMubGVuZ3RoPT09MCl7cmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO30KaWYocGFyYW1zLmluaXRpYWxTdGF0ZSl7dGhpcy5pbXBvcnRTdGF0ZShwYXJhbXMuaW5pdGlhbFN0YXRlKTtyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7fWVsc2V7dmFyIGdyb3Vwcz1wYXJhbXMuZ3JvdXBzfHxbXTtncm91cHMuZm9yRWFjaChmdW5jdGlvbihncm91cCl7c2VsZi5fY3JlYXRlR3JvdXBPZkZpbHRlcnMoZ3JvdXApO30pO2lmKHRoaXMuX2dldEdyb3VwSWRPZlR5cGUoJ2dyb3VwQnknKT09PXVuZGVmaW5lZCl7dGhpcy5fY3JlYXRlRW1wdHlHcm91cCgnZ3JvdXBCeScpO30KdGhpcy5fY3JlYXRlR3JvdXBPZlRpbWVSYW5nZXMoKTtyZXR1cm4gUHJvbWlzZS5hbGwoc2VsZi5fbG9hZFNlYXJjaERlZmF1bHRzKCkpLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gc2VsZi5fbG9hZEZhdm9yaXRlcygpLnRoZW4oZnVuY3Rpb24oKXtpZihzZWxmLnF1ZXJ5Lmxlbmd0aD09PTApe3NlbGYuX2FjdGl2YXRlRGVmYXVsdEZpbHRlcnMoKTtzZWxmLl9hY3RpdmF0ZURlZmF1bHRUaW1lUmFuZ2VzKHBhcmFtcy50aW1lUmFuZ2VzKTt9fSk7fSk7fX0sdG9nZ2xlQXV0b0NvbXBsZXRpb25GaWx0ZXI6ZnVuY3Rpb24ocGFyYW1zKXt2YXIgZmlsdGVyPXRoaXMuZmlsdGVyc1twYXJhbXMuZmlsdGVySWRdO2lmKGZpbHRlci50eXBlPT09J2ZpZWxkJyl7ZmlsdGVyLmF1dG9Db21wbGV0ZVZhbHVlcz1wYXJhbXMuYXV0b0NvbXBsZXRlVmFsdWVzO2ZpbHRlci5kb21haW49dGhpcy5fZ2V0QXV0b0NvbXBsZXRpb25GaWx0ZXJEb21haW4oZmlsdGVyKTt2YXIgZ3JvdXA9dGhpcy5ncm91cHNbZmlsdGVyLmdyb3VwSWRdO2lmKCFncm91cC5hY3RpdmVGaWx0ZXJJZHMuc29tZShpc0VxdWFsVG8oW2ZpbHRlci5pZF0pKSl7Z3JvdXAuYWN0aXZlRmlsdGVySWRzLnB1c2goW2ZpbHRlci5pZF0pO3RoaXMucXVlcnkucHVzaChncm91cC5pZCk7fX1lbHNle2lmKGZpbHRlci5oYXNPcHRpb25zKXt0aGlzLnRvZ2dsZUZpbHRlcldpdGhPcHRpb25zKGZpbHRlci5pZCk7fWVsc2V7dGhpcy50b2dnbGVGaWx0ZXIoZmlsdGVyLmlkKTt9fX0sdG9nZ2xlRmlsdGVyOmZ1bmN0aW9uKGZpbHRlcklkKXt2YXIgc2VsZj10aGlzO3ZhciBmaWx0ZXI9dGhpcy5maWx0ZXJzW2ZpbHRlcklkXTt2YXIgZ3JvdXA9dGhpcy5ncm91cHNbZmlsdGVyLmdyb3VwSWRdO3ZhciBpbmRleD1ncm91cC5hY3RpdmVGaWx0ZXJJZHMuZmluZEluZGV4KGlzRXF1YWxUbyhbZmlsdGVySWRdKSk7dmFyIGluaXRpYUxlbmd0aD1ncm91cC5hY3RpdmVGaWx0ZXJJZHMubGVuZ3RoO2lmKGluZGV4PT09LTEpe2lmKGZpbHRlci50eXBlPT09J2Zhdm9yaXRlJyl7dGhpcy5xdWVyeS5mb3JFYWNoKGZ1bmN0aW9uKGdyb3VwSWQpe2NvbnN0IGdyb3VwPXNlbGYuZ3JvdXBzW2dyb3VwSWRdO2dyb3VwLmFjdGl2ZUZpbHRlcklkcy5mb3JFYWNoKGlkPT57Y29uc3QgZmlsdGVyPXNlbGYuZmlsdGVyc1tpZFswXV07aWYoZmlsdGVyLmF1dG9Db21wbGV0ZVZhbHVlcyl7ZmlsdGVyLmF1dG9Db21wbGV0ZVZhbHVlcz1bXTt9CmlmKGZpbHRlci5jdXJyZW50T3B0aW9uSWRzKXtmaWx0ZXIuY3VycmVudE9wdGlvbklkcy5jbGVhcigpO319KQpncm91cC5hY3RpdmVGaWx0ZXJJZHM9W107fSk7dGhpcy5xdWVyeT1bXTt9Cmdyb3VwLmFjdGl2ZUZpbHRlcklkcy5wdXNoKFtmaWx0ZXJJZF0pO2lmKGZpbHRlci50eXBlPT09J2Zhdm9yaXRlJ3x8aW5pdGlhTGVuZ3RoPT09MCl7dGhpcy5xdWVyeS5wdXNoKGdyb3VwLmlkKTt9fWVsc2V7aWYoZmlsdGVyLnR5cGU9PT0nZmllbGQnJiZmaWx0ZXIuYXV0b0NvbXBsZXRlVmFsdWVzKXtmaWx0ZXIuYXV0b0NvbXBsZXRlVmFsdWVzPVtdO30KZ3JvdXAuYWN0aXZlRmlsdGVySWRzLnNwbGljZShpbmRleCwxKTtpZihpbml0aWFMZW5ndGg9PT0xKXt0aGlzLnF1ZXJ5LnNwbGljZSh0aGlzLnF1ZXJ5LmluZGV4T2YoZ3JvdXAuaWQpLDEpO319fSx0b2dnbGVGaWx0ZXJXaXRoT3B0aW9uczpmdW5jdGlvbihmaWx0ZXJJZCxvcHRpb25JZCl7Y29uc3QgZmlsdGVyPXRoaXMuZmlsdGVyc1tmaWx0ZXJJZF07b3B0aW9uSWQ9b3B0aW9uSWR8fGZpbHRlci5kZWZhdWx0T3B0aW9uSWQ7Y29uc3QgZ3JvdXA9dGhpcy5ncm91cHNbZmlsdGVyLmdyb3VwSWRdO2NvbnN0IHNlbGVjdGVkWWVhcnM9KCk9PllFQVJfT1BUSU9OUy5yZWR1Y2UoKGFjYyx5KT0+e2lmKGZpbHRlci5jdXJyZW50T3B0aW9uSWRzLmhhcyh5Lm9wdGlvbklkKSl7YWNjLnB1c2goeS5vcHRpb25JZCk7fQpyZXR1cm4gYWNjO30sW10pO2lmKGZpbHRlci50eXBlPT09J2ZpbHRlcicpe2NvbnN0IGFscmVhZHlBY3RpdmU9Z3JvdXAuYWN0aXZlRmlsdGVySWRzLnNvbWUoaXNFcXVhbFRvKFtmaWx0ZXJJZF0pKTtpZihhbHJlYWR5QWN0aXZlKXtpZihmaWx0ZXIuY3VycmVudE9wdGlvbklkcy5oYXMob3B0aW9uSWQpKXtmaWx0ZXIuY3VycmVudE9wdGlvbklkcy5kZWxldGUob3B0aW9uSWQpO2lmKCFzZWxlY3RlZFllYXJzKCkubGVuZ3RoKXtmaWx0ZXIuY3VycmVudE9wdGlvbklkcy5jbGVhcigpO30KaWYoIWZpbHRlci5jdXJyZW50T3B0aW9uSWRzLnNpemUpe3RoaXMudG9nZ2xlRmlsdGVyKGZpbHRlcklkKTt9fWVsc2V7ZmlsdGVyLmN1cnJlbnRPcHRpb25JZHMuYWRkKG9wdGlvbklkKTt9fWVsc2V7dGhpcy50b2dnbGVGaWx0ZXIoZmlsdGVySWQpO2ZpbHRlci5jdXJyZW50T3B0aW9uSWRzLmFkZChvcHRpb25JZCk7aWYoIXNlbGVjdGVkWWVhcnMoKS5sZW5ndGgpe2ZpbHRlci5jdXJyZW50T3B0aW9uSWRzLmFkZCgndGhpc195ZWFyJyk7fX19ZWxzZSBpZihmaWx0ZXIudHlwZT09PSdncm91cEJ5Jyl7Y29uc3QgY29tYmluYXRpb25JZD1bZmlsdGVySWQsb3B0aW9uSWRdO2NvbnN0IGluaXRpYUxlbmd0aD1ncm91cC5hY3RpdmVGaWx0ZXJJZHMubGVuZ3RoO2NvbnN0IGluZGV4PWdyb3VwLmFjdGl2ZUZpbHRlcklkcy5maW5kSW5kZXgoaXNFcXVhbFRvKGNvbWJpbmF0aW9uSWQpKTtpZihpbmRleD09PS0xKXtncm91cC5hY3RpdmVGaWx0ZXJJZHMucHVzaChjb21iaW5hdGlvbklkKTtmaWx0ZXIuY3VycmVudE9wdGlvbklkcy5hZGQob3B0aW9uSWQpO2lmKGluaXRpYUxlbmd0aD09PTApe3RoaXMucXVlcnkucHVzaChncm91cC5pZCk7fX1lbHNle2dyb3VwLmFjdGl2ZUZpbHRlcklkcy5zcGxpY2UoaW5kZXgsMSk7ZmlsdGVyLmN1cnJlbnRPcHRpb25JZHMuZGVsZXRlKG9wdGlvbklkKTtpZihpbml0aWFMZW5ndGg9PT0xKXt0aGlzLnF1ZXJ5LnNwbGljZSh0aGlzLnF1ZXJ5LmluZGV4T2YoZ3JvdXAuaWQpLDEpO319fX0sX2FjdGl2YXRlRGVmYXVsdEZpbHRlcnM6ZnVuY3Rpb24oKXtPYmplY3QudmFsdWVzKHRoaXMuZmlsdGVycykuZmlsdGVyKGY9PmYuaXNEZWZhdWx0JiZmLnR5cGUhPT0nZmF2b3JpdGUnKS5zb3J0KChmMSxmMik9PihmMS5kZWZhdWx0UmFua3x8MTAwKS0oZjIuZGVmYXVsdFJhbmt8fDEwMCkpLmZvckVhY2goZj0+e2lmKGYuaGFzT3B0aW9ucyl7dGhpcy50b2dnbGVGaWx0ZXJXaXRoT3B0aW9ucyhmLmlkKTt9ZWxzZXt0aGlzLnRvZ2dsZUZpbHRlcihmLmlkKTt9fSk7fSxfYWN0aXZhdGVEZWZhdWx0VGltZVJhbmdlczpmdW5jdGlvbihkZWZhdWx0VGltZVJhbmdlcyl7aWYoZGVmYXVsdFRpbWVSYW5nZXMpe3ZhciBmaWx0ZXI9Xy5maW5kKHRoaXMuZmlsdGVycyxmdW5jdGlvbihmaWx0ZXIpe3JldHVybiBmaWx0ZXIudHlwZT09PSd0aW1lUmFuZ2UnJiZmaWx0ZXIuZmllbGROYW1lPT09ZGVmYXVsdFRpbWVSYW5nZXMuZmllbGQ7fSk7aWYoZmlsdGVyKXt0aGlzLmFjdGl2YXRlVGltZVJhbmdlKGZpbHRlci5pZCxkZWZhdWx0VGltZVJhbmdlcy5yYW5nZSxkZWZhdWx0VGltZVJhbmdlcy5jb21wYXJpc29uUmFuZ2UpO319fSxfYWRkTmV3RmF2b3JpdGU6ZnVuY3Rpb24oZmF2b3JpdGUpe3ZhciBpZD1fLnVuaXF1ZUlkKCdfX2ZpbHRlcl9fJyk7ZmF2b3JpdGUuaWQ9aWQ7ZmF2b3JpdGUuZ3JvdXBJZD10aGlzLl9nZXRHcm91cElkT2ZUeXBlKCdmYXZvcml0ZScpO3RoaXMuZmlsdGVyc1tpZF09ZmF2b3JpdGU7dGhpcy50b2dnbGVGaWx0ZXIoZmF2b3JpdGUuaWQpO30sX2NvbXB1dGVEYXRlRmlsdGVyRG9tYWluOmZ1bmN0aW9uKGZpbHRlcil7Y29uc3QgZG9tYWlucz1bXTtjb25zdCBwPV8ucGFydGl0aW9uKFsuLi5maWx0ZXIuY3VycmVudE9wdGlvbklkc10sb3B0aW9uSWQ9Pk9QVElPTl9HRU5FUkFUT1JTLmZpbmQobz0+by5vcHRpb25JZD09PW9wdGlvbklkKS5ncm91cElkPT09MSk7Y29uc3QgeWVhcklkcz1wWzFdO2NvbnN0IG90aGVyT3B0aW9uSWRzPXBbMF07aWYob3RoZXJPcHRpb25JZHMubGVuZ3RoPT09MCl7eWVhcklkcy5mb3JFYWNoKHllYXJJZD0+e2NvbnN0IGQ9ZmlsdGVyLmJhc2ljRG9tYWluc1t5ZWFySWRdO2RvbWFpbnMucHVzaChkLmRvbWFpbik7fSk7fWVsc2V7b3RoZXJPcHRpb25JZHMuZm9yRWFjaChvcHRpb25JZD0+e3llYXJJZHMuZm9yRWFjaCh5ZWFySWQ9Pntjb25zdCBkPWZpbHRlci5iYXNpY0RvbWFpbnNbeWVhcklkKydfXycrb3B0aW9uSWRdO2RvbWFpbnMucHVzaChkLmRvbWFpbik7fSk7fSk7fQpyZXR1cm4gcHlVdGlscy5hc3NlbWJsZURvbWFpbnMoZG9tYWlucywnT1InKTt9LF9jcmVhdGVFbXB0eUdyb3VwOmZ1bmN0aW9uKHR5cGUpe3ZhciBpZD1fLnVuaXF1ZUlkKCdfX2dyb3VwX18nKTt0aGlzLmdyb3Vwc1tpZF09e2lkOmlkLHR5cGU6dHlwZSxhY3RpdmVGaWx0ZXJJZHM6W10sfTt9LF9jcmVhdGVHcm91cE9mRmlsdGVyczpmdW5jdGlvbihncm91cCl7dmFyIHNlbGY9dGhpczt2YXIgdHlwZTt2YXIgZ3JvdXBJZD1fLnVuaXF1ZUlkKCdfX2dyb3VwX18nKTtncm91cC5mb3JFYWNoKGZ1bmN0aW9uKGZpbHRlcil7dmFyIGlkPV8udW5pcXVlSWQoJ19fZmlsdGVyX18nKTtmaWx0ZXIuaWQ9aWQ7ZmlsdGVyLmdyb3VwSWQ9Z3JvdXBJZDt0eXBlPWZpbHRlci50eXBlO3NlbGYuZmlsdGVyc1tpZF09ZmlsdGVyO30pO3RoaXMuZ3JvdXBzW2dyb3VwSWRdPXtpZDpncm91cElkLHR5cGU6dHlwZSxhY3RpdmVGaWx0ZXJJZHM6W10sfTt9LF9jcmVhdGVHcm91cE9mVGltZVJhbmdlczpmdW5jdGlvbigpe3ZhciBzZWxmPXRoaXM7dmFyIHRpbWVSYW5nZXM9W107T2JqZWN0LmtleXModGhpcy5maWVsZHMpLmZvckVhY2goZnVuY3Rpb24oZmllbGROYW1lKXt2YXIgZmllbGQ9c2VsZi5maWVsZHNbZmllbGROYW1lXTt2YXIgZmllbGRUeXBlPWZpZWxkLnR5cGU7aWYoXy5jb250YWlucyhbJ2RhdGUnLCdkYXRldGltZSddLGZpZWxkVHlwZSkmJmZpZWxkLnNvcnRhYmxlKXt0aW1lUmFuZ2VzLnB1c2goe3R5cGU6J3RpbWVSYW5nZScsZGVzY3JpcHRpb246ZmllbGQuc3RyaW5nLGZpZWxkTmFtZTpmaWVsZE5hbWUsZmllbGRUeXBlOmZpZWxkVHlwZSx0aW1lUmFuZ2VJZDpmYWxzZSxjb21wYXJpc29uVGltZVJhbmdlSWQ6ZmFsc2UsZGVmYXVsdFRpbWVSYW5nZUlkOkRFRkFVTFRfVElNRVJBTkdFLHRpbWVSYW5nZU9wdGlvbnM6VElNRV9SQU5HRV9PUFRJT05TLGNvbXBhcmlzb25UaW1lUmFuZ2VPcHRpb25zOkNPTVBBUklTT05fVElNRV9SQU5HRV9PUFRJT05TfSk7fX0pO2lmKHRpbWVSYW5nZXMubGVuZ3RoKXt0aGlzLl9jcmVhdGVHcm91cE9mRmlsdGVycyh0aW1lUmFuZ2VzKTt9ZWxzZXt0aGlzLl9jcmVhdGVFbXB0eUdyb3VwKCd0aW1lUmFuZ2UnKTt9fSxfZ2VuZXJhdGVOZXdHcm91cE51bWJlcjpmdW5jdGlvbigpe3ZhciBzZWxmPXRoaXM7dmFyIGdyb3VwTnVtYmVyPTErT2JqZWN0LmtleXModGhpcy5maWx0ZXJzKS5yZWR1Y2UoZnVuY3Rpb24obWF4LGZpbHRlcklkKXt2YXIgZmlsdGVyPXNlbGYuZmlsdGVyc1tmaWx0ZXJJZF07aWYoZmlsdGVyLmdyb3VwTnVtYmVyKXttYXg9TWF0aC5tYXgoZmlsdGVyLmdyb3VwTnVtYmVyLG1heCk7fQpyZXR1cm4gbWF4O30sMSk7cmV0dXJuIGdyb3VwTnVtYmVyO30sX2dldEF1dG9Db21wbGV0aW9uRmlsdGVyRG9tYWluOmZ1bmN0aW9uKGZpbHRlcil7dmFyIGRvbWFpbj0iIjt2YXIgZmllbGQ9dGhpcy5maWVsZHNbZmlsdGVyLmF0dHJzLm5hbWVdO3ZhciBPYmo9c2VhcmNoQmFyQXV0b2NvbXBsZXRlUmVnaXN0cnkuZ2V0QW55KFtmaWx0ZXIuYXR0cnMud2lkZ2V0LGZpZWxkLnR5cGVdKTtpZihPYmope3ZhciBvYmo9bmV3KE9iaikodGhpcyxmaWx0ZXIsZmllbGQsdGhpcy5hY3Rpb25Db250ZXh0KTtkb21haW49b2JqLmdldERvbWFpbihmaWx0ZXIuYXV0b0NvbXBsZXRlVmFsdWVzKTt9CnJldHVybiBkb21haW47fSxfZ2V0RG9tYWluOmZ1bmN0aW9uKCl7dmFyIHNlbGY9dGhpczt2YXIgZG9tYWlucz10aGlzLnF1ZXJ5Lm1hcChmdW5jdGlvbihncm91cElkKXt2YXIgZ3JvdXA9c2VsZi5ncm91cHNbZ3JvdXBJZF07cmV0dXJuIHNlbGYuX2dldEdyb3VwRG9tYWluKGdyb3VwKTt9KTtyZXR1cm4gcHlVdGlscy5hc3NlbWJsZURvbWFpbnMoZG9tYWlucywnQU5EJyk7fSxfZ2V0RmFjZXRzOmZ1bmN0aW9uKCl7dmFyIHNlbGY9dGhpcztyZXR1cm4gdGhpcy5xdWVyeS5tYXAoZ3JvdXBJZD0+e3ZhciBncm91cD1zZWxmLmdyb3Vwc1tncm91cElkXTt2YXIgZmFjZXQ9Xy5leHRlbmQoe30sZ3JvdXApO2lmKGdyb3VwLnR5cGU9PT0nZ3JvdXBCeScpe2ZhY2V0LmZpbHRlcnM9Z3JvdXAuYWN0aXZlRmlsdGVySWRzLm1hcChpZD0+e2xldCBmaWx0ZXI9Xy5leHRlbmQoe30sc2VsZi5maWx0ZXJzW2lkWzBdXSk7aWYoZmlsdGVyLmhhc09wdGlvbnMpe2ZpbHRlci5vcHRpb25JZD1pZFsxXTt9CnJldHVybiBmaWx0ZXI7fSk7fWVsc2V7ZmFjZXQuZmlsdGVycz1fLmNvbXBhY3QoZ3JvdXAuYWN0aXZlRmlsdGVySWRzLm1hcChpZD0+c2VsZi5maWx0ZXJzW2lkWzBdXSkpO30KcmV0dXJuIGZhY2V0O30pO30sX2dldEZpbHRlckNvbnRleHQ6ZnVuY3Rpb24oZmlsdGVyKXt2YXIgY29udGV4dD1maWx0ZXIuY29udGV4dHx8e307aWYoZmlsdGVyLnR5cGU9PT0nZmllbGQnJiZmaWx0ZXIuYXR0cnMuY29udGV4dCl7Y29udGV4dD1weVV0aWxzLmV2YWwoJ2NvbnRleHQnLGZpbHRlci5hdHRycy5jb250ZXh0LHtzZWxmOl8ubWFwKGZpbHRlci5hdXRvQ29tcGxldGVWYWx1ZXMsZnVuY3Rpb24oYXV0b0NvbXBsZXRlVmFsdWUpe3JldHVybiBhdXRvQ29tcGxldGVWYWx1ZS52YWx1ZTt9KSx9KTt9CmlmKGZpbHRlci50eXBlPT09J2ZpZWxkJyYmZmlsdGVyLmlzRGVmYXVsdCl7aWYodGhpcy5maWVsZHNbZmlsdGVyLmF0dHJzLm5hbWVdLnR5cGU9PT0nbWFueTJvbmUnKXt2YXIgdmFsdWU9ZmlsdGVyLmRlZmF1bHRWYWx1ZTtpZihfLmlzQXJyYXkoZmlsdGVyLmRlZmF1bHRWYWx1ZSkpe3ZhbHVlPWZpbHRlci5kZWZhdWx0VmFsdWVbMF07fQpjb250ZXh0WydkZWZhdWx0XycrZmlsdGVyLmF0dHJzLm5hbWVdPXZhbHVlO319CnJldHVybiBjb250ZXh0O30sX2dldEZpbHRlckRvbWFpbjpmdW5jdGlvbihmaWx0ZXIpe2xldCBkb21haW47aWYoZmlsdGVyLnR5cGU9PT0nZmlsdGVyJyl7ZG9tYWluPWZpbHRlci5kb21haW47aWYoZmlsdGVyLmhhc09wdGlvbnMpe2RvbWFpbj10aGlzLl9jb21wdXRlRGF0ZUZpbHRlckRvbWFpbihmaWx0ZXIpO319ZWxzZSBpZihmaWx0ZXIudHlwZT09PSdmYXZvcml0ZScpe2RvbWFpbj1maWx0ZXIuZG9tYWluO31lbHNlIGlmKGZpbHRlci50eXBlPT09J2ZpZWxkJyl7ZG9tYWluPWZpbHRlci5kb21haW47fQpyZXR1cm4gZG9tYWluO30sX2dldEZpbHRlckdyb3VwQnlzOmZ1bmN0aW9uKGZpbHRlcklkKXt2YXIgZ3JvdXBCeXM7dmFyIGZpbHRlcj10aGlzLmZpbHRlcnNbZmlsdGVySWRbMF1dO2lmKGZpbHRlci50eXBlPT09J2dyb3VwQnknKXt2YXIgb3B0aW9uSWQ9ZmlsdGVySWRbMV07dmFyIGdyb3VwQnk9ZmlsdGVyLmZpZWxkTmFtZTtpZihvcHRpb25JZCl7Z3JvdXBCeT1ncm91cEJ5Kyc6JytvcHRpb25JZDt9Cmdyb3VwQnlzPVtncm91cEJ5XTt9CmlmKGZpbHRlci50eXBlPT09J2Zhdm9yaXRlJyl7Z3JvdXBCeXM9ZmlsdGVyLmdyb3VwQnlzO30KcmV0dXJuIGdyb3VwQnlzO30sX2dldEdyb3VwQnk6ZnVuY3Rpb24oKXt2YXIgc2VsZj10aGlzO3ZhciBncm91cEJ5cz10aGlzLnF1ZXJ5LnJlZHVjZShmdW5jdGlvbihhY2MsZ3JvdXBJZCl7dmFyIGdyb3VwPXNlbGYuZ3JvdXBzW2dyb3VwSWRdO3JldHVybiBhY2MuY29uY2F0KHNlbGYuX2dldEdyb3VwR3JvdXBCeXMoZ3JvdXApKTt9LFtdKTtyZXR1cm4gZ3JvdXBCeXM7fSxfZ2V0R3JvdXBDb250ZXh0czpmdW5jdGlvbihncm91cCl7dmFyIHNlbGY9dGhpczt2YXIgY29udGV4dHM9Z3JvdXAuYWN0aXZlRmlsdGVySWRzLm1hcChmdW5jdGlvbihmaWx0ZXJJZCl7dmFyIGZpbHRlcj1zZWxmLmZpbHRlcnNbZmlsdGVySWRbMF1dO3JldHVybiBzZWxmLl9nZXRGaWx0ZXJDb250ZXh0KGZpbHRlcik7fSk7cmV0dXJuIF8uY29tcGFjdChjb250ZXh0cyk7fSxfZ2V0R3JvdXBEb21haW46ZnVuY3Rpb24oZ3JvdXApe3ZhciBzZWxmPXRoaXM7dmFyIGRvbWFpbnM9Z3JvdXAuYWN0aXZlRmlsdGVySWRzLm1hcChmdW5jdGlvbihmaWx0ZXJJZCl7dmFyIGZpbHRlcj1zZWxmLmZpbHRlcnNbZmlsdGVySWRbMF1dO3JldHVybiBzZWxmLl9nZXRGaWx0ZXJEb21haW4oZmlsdGVyKTt9KTtyZXR1cm4gcHlVdGlscy5hc3NlbWJsZURvbWFpbnMoXy5jb21wYWN0KGRvbWFpbnMpLCdPUicpO30sX2dldEdyb3VwR3JvdXBCeXM6ZnVuY3Rpb24oZ3JvdXApe3ZhciBzZWxmPXRoaXM7dmFyIGdyb3VwQnlzPWdyb3VwLmFjdGl2ZUZpbHRlcklkcy5yZWR1Y2UoZnVuY3Rpb24oYWNjLGZpbHRlcklkKXthY2M9YWNjLmNvbmNhdChzZWxmLl9nZXRGaWx0ZXJHcm91cEJ5cyhmaWx0ZXJJZCkpO3JldHVybiBhY2M7fSxbXSk7cmV0dXJuIF8uY29tcGFjdChncm91cEJ5cyk7fSxfZ2V0R3JvdXBJZE9mVHlwZTpmdW5jdGlvbih0eXBlKXt2YXIgc2VsZj10aGlzO3JldHVybiBfLmZpbmQoT2JqZWN0LmtleXModGhpcy5ncm91cHMpLGZ1bmN0aW9uKGdyb3VwSWQpe3ZhciBncm91cD1zZWxmLmdyb3Vwc1tncm91cElkXTtyZXR1cm4gZ3JvdXAudHlwZT09PXR5cGU7fSk7fSxfZ2V0T3JkZXJlZEJ5OmZ1bmN0aW9uKCl7dmFyIG9yZGVyZWRCeTt2YXIgaWQ9dGhpcy5fZ2V0R3JvdXBJZE9mVHlwZSgnZmF2b3JpdGUnKTtpZih0aGlzLnF1ZXJ5LmluZGV4T2YoaWQpIT09LTEpe3ZhciBncm91cD10aGlzLmdyb3Vwc1tpZF07dmFyIGFjdGl2ZUZhdm9yaXRlSWQ9Z3JvdXAuYWN0aXZlRmlsdGVySWRzWzBdWzBdO3ZhciBmYXZvcml0ZT10aGlzLmZpbHRlcnNbYWN0aXZlRmF2b3JpdGVJZF07aWYoZmF2b3JpdGUub3JkZXJlZEJ5JiZmYXZvcml0ZS5vcmRlcmVkQnkubGVuZ3RoKXtvcmRlcmVkQnk9ZmF2b3JpdGUub3JkZXJlZEJ5O319CnJldHVybiBvcmRlcmVkQnk7fSxfZ2V0UXVlcnlDb250ZXh0OmZ1bmN0aW9uKCl7dmFyIHNlbGY9dGhpczt2YXIgY29udGV4dHM9dGhpcy5xdWVyeS5yZWR1Y2UoZnVuY3Rpb24oYWNjLGdyb3VwSWQpe3ZhciBncm91cD1zZWxmLmdyb3Vwc1tncm91cElkXTthY2M9YWNjLmNvbmNhdChzZWxmLl9nZXRHcm91cENvbnRleHRzKGdyb3VwKSk7cmV0dXJuIGFjYzt9LFtdKTtyZXR1cm4gXy5jb21wYWN0KGNvbnRleHRzKTt9LF9nZXRUaW1lUmFuZ2VNZW51RGF0YTpmdW5jdGlvbihldmFsdWF0aW9uKXt2YXIgY29udGV4dD17fTt2YXIgZ3JvdXBPZlRpbWVSYW5nZXM9dGhpcy5ncm91cHNbdGhpcy5fZ2V0R3JvdXBJZE9mVHlwZSgndGltZVJhbmdlJyldO2lmKGdyb3VwT2ZUaW1lUmFuZ2VzJiZncm91cE9mVGltZVJhbmdlcy5hY3RpdmVGaWx0ZXJJZHMubGVuZ3RoKXt2YXIgZmlsdGVyPXRoaXMuZmlsdGVyc1tncm91cE9mVGltZVJhbmdlcy5hY3RpdmVGaWx0ZXJJZHNbMF1bMF1dO3ZhciBjb21wYXJpc29uVGltZVJhbmdlPSJbXSI7dmFyIGNvbXBhcmlzb25UaW1lUmFuZ2VEZXNjcmlwdGlvbjt2YXIgdGltZVJhbmdlPURvbWFpbi5wcm90b3R5cGUuY29uc3RydWN0RG9tYWluKGZpbHRlci5maWVsZE5hbWUsZmlsdGVyLnRpbWVSYW5nZUlkLGZpbHRlci5maWVsZFR5cGUpO3ZhciB0aW1lUmFuZ2VEZXNjcmlwdGlvbj1fLmZpbmQoZmlsdGVyLnRpbWVSYW5nZU9wdGlvbnMsZnVuY3Rpb24ob3B0aW9uKXtyZXR1cm4gb3B0aW9uLm9wdGlvbklkPT09ZmlsdGVyLnRpbWVSYW5nZUlkO30pLmRlc2NyaXB0aW9uLnRvU3RyaW5nKCk7aWYoZmlsdGVyLmNvbXBhcmlzb25UaW1lUmFuZ2VJZCl7Y29tcGFyaXNvblRpbWVSYW5nZT1Eb21haW4ucHJvdG90eXBlLmNvbnN0cnVjdERvbWFpbihmaWx0ZXIuZmllbGROYW1lLGZpbHRlci50aW1lUmFuZ2VJZCxmaWx0ZXIuZmllbGRUeXBlLGZpbHRlci5jb21wYXJpc29uVGltZVJhbmdlSWQpO2NvbXBhcmlzb25UaW1lUmFuZ2VEZXNjcmlwdGlvbj1fLmZpbmQoZmlsdGVyLmNvbXBhcmlzb25UaW1lUmFuZ2VPcHRpb25zLGZ1bmN0aW9uKGNvbXBhcmlzb25PcHRpb24pe3JldHVybiBjb21wYXJpc29uT3B0aW9uLm9wdGlvbklkPT09ZmlsdGVyLmNvbXBhcmlzb25UaW1lUmFuZ2VJZDt9KS5kZXNjcmlwdGlvbi50b1N0cmluZygpO30KaWYoZXZhbHVhdGlvbil7dGltZVJhbmdlPURvbWFpbi5wcm90b3R5cGUuc3RyaW5nVG9BcnJheSh0aW1lUmFuZ2UpO2NvbXBhcmlzb25UaW1lUmFuZ2U9RG9tYWluLnByb3RvdHlwZS5zdHJpbmdUb0FycmF5KGNvbXBhcmlzb25UaW1lUmFuZ2UpO30KY29udGV4dD17dGltZVJhbmdlTWVudURhdGE6e2NvbXBhcmlzb25GaWVsZDpmaWx0ZXIuZmllbGROYW1lLHRpbWVSYW5nZTp0aW1lUmFuZ2UsdGltZVJhbmdlRGVzY3JpcHRpb246dGltZVJhbmdlRGVzY3JpcHRpb24sY29tcGFyaXNvblRpbWVSYW5nZTpjb21wYXJpc29uVGltZVJhbmdlLGNvbXBhcmlzb25UaW1lUmFuZ2VEZXNjcmlwdGlvbjpjb21wYXJpc29uVGltZVJhbmdlRGVzY3JpcHRpb24sfX07fQpyZXR1cm4gY29udGV4dDt9LF9sb2FkRmF2b3JpdGVzOmZ1bmN0aW9uKCl7dmFyIHNlbGY9dGhpczt2YXIgZGVmPXRoaXMubG9hZEZpbHRlcnModGhpcy5tb2RlbE5hbWUsdGhpcy5hY3Rpb25JZCkudGhlbihmdW5jdGlvbihmYXZvcml0ZXMpe2lmKGZhdm9yaXRlcy5sZW5ndGgpe2Zhdm9yaXRlcz1mYXZvcml0ZXMubWFwKGZ1bmN0aW9uKGZhdm9yaXRlKXt2YXIgdXNlcklkPWZhdm9yaXRlLnVzZXJfaWQ/ZmF2b3JpdGUudXNlcl9pZFswXTpmYWxzZTt2YXIgZ3JvdXBOdW1iZXI9dXNlcklkPzE6Mjt2YXIgY29udGV4dD1weVV0aWxzLmV2YWwoJ2NvbnRleHQnLGZhdm9yaXRlLmNvbnRleHQsc2Vzc2lvbi51c2VyX2NvbnRleHQpO3ZhciBncm91cEJ5cz1bXTtpZihjb250ZXh0Lmdyb3VwX2J5KXtncm91cEJ5cz1jb250ZXh0Lmdyb3VwX2J5O2RlbGV0ZSBjb250ZXh0Lmdyb3VwX2J5O30KdmFyIHNvcnQ9SlNPTi5wYXJzZShmYXZvcml0ZS5zb3J0KTt2YXIgb3JkZXJlZEJ5PXNvcnQubWFwKGZ1bmN0aW9uKG9yZGVyKXt2YXIgZmllbGROYW1lO3ZhciBhc2M7dmFyIHNxbE5vdGF0aW9uPW9yZGVyLnNwbGl0KCcgJyk7aWYoc3FsTm90YXRpb24ubGVuZ3RoPjEpe2ZpZWxkTmFtZT1zcWxOb3RhdGlvblswXTthc2M9c3FsTm90YXRpb25bMV09PT0nYXNjJzt9ZWxzZXtmaWVsZE5hbWU9b3JkZXJbMF09PT0nLSc/b3JkZXIuc2xpY2UoMSk6b3JkZXI7YXNjPW9yZGVyWzBdPT09Jy0nP2ZhbHNlOnRydWU7fQpyZXR1cm57bmFtZTpmaWVsZE5hbWUsYXNjOmFzYyx9O30pO3JldHVybnt0eXBlOidmYXZvcml0ZScsZGVzY3JpcHRpb246ZmF2b3JpdGUubmFtZSxpc1JlbW92YWJsZTp0cnVlLGdyb3VwTnVtYmVyOmdyb3VwTnVtYmVyLGlzRGVmYXVsdDpmYXZvcml0ZS5pc19kZWZhdWx0LGRvbWFpbjpmYXZvcml0ZS5kb21haW4sZ3JvdXBCeXM6Z3JvdXBCeXMsY29udGV4dDpmYXZvcml0ZS5jb250ZXh0LG9yZGVyZWRCeTpvcmRlcmVkQnksdXNlcklkOnVzZXJJZCxzZXJ2ZXJTaWRlSWQ6ZmF2b3JpdGUuaWQsfTt9KTtzZWxmLl9jcmVhdGVHcm91cE9mRmlsdGVycyhmYXZvcml0ZXMpO2lmKHNlbGYuYWN0aXZhdGVEZWZhdWx0RmF2b3JpdGUpe3ZhciBkZWZhdWx0RmF2b3JpdGU9Xy5maW5kKHNlbGYuZmlsdGVycyxmdW5jdGlvbihmaWx0ZXIpe3JldHVybiBmaWx0ZXIudHlwZT09PSdmYXZvcml0ZScmJmZpbHRlci5pc0RlZmF1bHQ7fSk7aWYoZGVmYXVsdEZhdm9yaXRlKXtzZWxmLnRvZ2dsZUZpbHRlcihkZWZhdWx0RmF2b3JpdGUuaWQpO319fWVsc2V7c2VsZi5fY3JlYXRlRW1wdHlHcm91cCgnZmF2b3JpdGUnKTt9fSk7cmV0dXJuIGRlZjt9LF9sb2FkU2VhcmNoRGVmYXVsdHM6ZnVuY3Rpb24oKXt2YXIgc2VsZj10aGlzO3ZhciBkZWZzPVtdO18uZWFjaCh0aGlzLmZpbHRlcnMsZnVuY3Rpb24oZmlsdGVyKXtpZihmaWx0ZXIudHlwZT09PSdmaWVsZCcmJmZpbHRlci5pc0RlZmF1bHQpe3ZhciBkZWY7dmFyIGZpZWxkPXNlbGYuZmllbGRzW2ZpbHRlci5hdHRycy5uYW1lXTt2YXIgdmFsdWU9ZmlsdGVyLmRlZmF1bHRWYWx1ZTtpZihmaWVsZC50eXBlPT09J21hbnkyb25lJyl7aWYodmFsdWUgaW5zdGFuY2VvZiBBcnJheSl7dmFsdWU9dmFsdWVbMF07fQpkZWY9c2VsZi5fcnBjKHttb2RlbDpmaWVsZC5yZWxhdGlvbixtZXRob2Q6J25hbWVfZ2V0JyxhcmdzOlt2YWx1ZV0sY29udGV4dDpzZWxmLmFjdGlvbkNvbnRleHQsfSkudGhlbihmdW5jdGlvbihyZXN1bHQpe3ZhciBhdXRvY29tcGxldGVWYWx1ZT17bGFiZWw6cmVzdWx0WzBdWzFdLHZhbHVlOnZhbHVlLH07ZmlsdGVyLmF1dG9Db21wbGV0ZVZhbHVlcy5wdXNoKGF1dG9jb21wbGV0ZVZhbHVlKTtmaWx0ZXIuZG9tYWluPXNlbGYuX2dldEF1dG9Db21wbGV0aW9uRmlsdGVyRG9tYWluKGZpbHRlcik7fSk7fWVsc2V7dmFyIGF1dG9jb21wbGV0ZVZhbHVlO2lmKGZpZWxkLnR5cGU9PT0nc2VsZWN0aW9uJyl7dmFyIG1hdGNoPV8uZmluZChmaWVsZC5zZWxlY3Rpb24sZnVuY3Rpb24oc2VsKXtyZXR1cm4gc2VsWzBdPT09dmFsdWU7fSk7YXV0b2NvbXBsZXRlVmFsdWU9e2xhYmVsOm1hdGNoWzFdLHZhbHVlOm1hdGNoWzBdLH07fWVsc2V7YXV0b2NvbXBsZXRlVmFsdWU9e2xhYmVsOlN0cmluZyh2YWx1ZSksdmFsdWU6dmFsdWUsfTt9CmZpbHRlci5hdXRvQ29tcGxldGVWYWx1ZXMucHVzaChhdXRvY29tcGxldGVWYWx1ZSk7ZmlsdGVyLmRvbWFpbj1zZWxmLl9nZXRBdXRvQ29tcGxldGlvbkZpbHRlckRvbWFpbihmaWx0ZXIpO30KaWYoZGVmKXtkZWZzLnB1c2goZGVmKTt9fX0pO3JldHVybiBkZWZzO30sX3NhdmVRdWVyeTpmdW5jdGlvbihmYXZvcml0ZSl7dmFyIHNlbGY9dGhpczt2YXIgdXNlckNvbnRleHQ9c2Vzc2lvbi51c2VyX2NvbnRleHQ7dmFyIGNvbnRyb2xsZXJRdWVyeVBhcmFtczt0aGlzLnRyaWdnZXJfdXAoJ2dldF9jb250cm9sbGVyX3F1ZXJ5X3BhcmFtcycse2NhbGxiYWNrOmZ1bmN0aW9uKHN0YXRlKXtjb250cm9sbGVyUXVlcnlQYXJhbXM9c3RhdGU7fSx9KTt2YXIgcXVlcnlDb250ZXh0PXRoaXMuX2dldFF1ZXJ5Q29udGV4dCgpO3ZhciB0aW1lUmFuZ2VNZW51SW5mbz10aGlzLl9nZXRUaW1lUmFuZ2VNZW51RGF0YShmYWxzZSk7dmFyIGNvbnRleHQ9cHlVdGlscy5ldmFsKCdjb250ZXh0cycsW3VzZXJDb250ZXh0LGNvbnRyb2xsZXJRdWVyeVBhcmFtcy5jb250ZXh0LHRpbWVSYW5nZU1lbnVJbmZvXS5jb25jYXQocXVlcnlDb250ZXh0KSk7Y29udGV4dD1fLm9taXQoY29udGV4dCxPYmplY3Qua2V5cyh1c2VyQ29udGV4dCkpO3ZhciBncm91cEJ5cz10aGlzLl9nZXRHcm91cEJ5KCk7aWYoZ3JvdXBCeXMubGVuZ3RoKXtjb250ZXh0Lmdyb3VwX2J5PWdyb3VwQnlzO30KdmFyIGRvbWFpbj10aGlzLl9nZXREb21haW4oKTt2YXIgdXNlcklkPWZhdm9yaXRlLmlzU2hhcmVkP2ZhbHNlOnNlc3Npb24udWlkO3ZhciBvcmRlcmVkQnk9dGhpcy5fZ2V0T3JkZXJlZEJ5KCl8fFtdO2lmKGNvbnRyb2xsZXJRdWVyeVBhcmFtcy5vcmRlcmVkQnkpe29yZGVyZWRCeT1jb250cm9sbGVyUXVlcnlQYXJhbXMub3JkZXJlZEJ5O30KdmFyIHNvcnQ9b3JkZXJlZEJ5Lm1hcChmdW5jdGlvbihvcmRlcil7cmV0dXJuIG9yZGVyLm5hbWUrKChvcmRlci5hc2M9PT1mYWxzZSk/IiBkZXNjIjoiIik7fSk7dmFyIGlyRmlsdGVyPXtuYW1lOmZhdm9yaXRlLmRlc2NyaXB0aW9uLGNvbnRleHQ6Y29udGV4dCxkb21haW46ZG9tYWluLGlzX2RlZmF1bHQ6ZmF2b3JpdGUuaXNEZWZhdWx0LHVzZXJfaWQ6dXNlcklkLG1vZGVsX2lkOnRoaXMubW9kZWxOYW1lLGFjdGlvbl9pZDp0aGlzLmFjdGlvbklkLHNvcnQ6SlNPTi5zdHJpbmdpZnkoc29ydCksfTtyZXR1cm4gdGhpcy5jcmVhdGVGaWx0ZXIoaXJGaWx0ZXIpLnRoZW4oZnVuY3Rpb24oc2VydmVyU2lkZUlkKXtkZWxldGUgY29udGV4dC5ncm91cF9ieTtmYXZvcml0ZS5pc1JlbW92YWJsZT10cnVlO2Zhdm9yaXRlLmdyb3VwTnVtYmVyPXVzZXJJZD8xOjI7ZmF2b3JpdGUuY29udGV4dD1jb250ZXh0O2Zhdm9yaXRlLmdyb3VwQnlzPWdyb3VwQnlzO2Zhdm9yaXRlLmRvbWFpbj1kb21haW47ZmF2b3JpdGUub3JkZXJlZEJ5PW9yZGVyZWRCeTtmYXZvcml0ZS51c2VySWQ9dXNlcklkO2Zhdm9yaXRlLnNlcnZlclNpZGVJZD1zZXJ2ZXJTaWRlSWQ7c2VsZi5fYWRkTmV3RmF2b3JpdGUoZmF2b3JpdGUpO30pO30sfSk7cmV0dXJuIENvbnRyb2xQYW5lbE1vZGVsO30pOzsKCi8qIC93ZWIvc3RhdGljL3NyYy9qcy92aWV3cy9jb250cm9sX3BhbmVsL2NvbnRyb2xfcGFuZWxfcmVuZGVyZXIuanMgZGVmaW5lZCBpbiBidW5kbGUgJ3dlYi5hc3NldHNfYmFja2VuZCcgKi8Kb2Rvby5kZWZpbmUoJ3dlYi5Db250cm9sUGFuZWxSZW5kZXJlcicsZnVuY3Rpb24ocmVxdWlyZSl7InVzZSBzdHJpY3QiO3ZhciBjb25maWc9cmVxdWlyZSgnd2ViLmNvbmZpZycpO3ZhciBkYXRhPXJlcXVpcmUoJ3dlYi5kYXRhJyk7dmFyIEZhdm9yaXRlTWVudT1yZXF1aXJlKCd3ZWIuRmF2b3JpdGVNZW51Jyk7dmFyIEZpbHRlck1lbnU9cmVxdWlyZSgnd2ViLkZpbHRlck1lbnUnKTt2YXIgR3JvdXBCeU1lbnU9cmVxdWlyZSgnd2ViLkdyb3VwQnlNZW51Jyk7dmFyIG12Yz1yZXF1aXJlKCd3ZWIubXZjJyk7dmFyIFNlYXJjaEJhcj1yZXF1aXJlKCd3ZWIuU2VhcmNoQmFyJyk7dmFyIFRpbWVSYW5nZU1lbnU9cmVxdWlyZSgnd2ViLlRpbWVSYW5nZU1lbnUnKTt2YXIgUmVuZGVyZXI9bXZjLlJlbmRlcmVyO3ZhciBDb250cm9sUGFuZWxSZW5kZXJlcj1SZW5kZXJlci5leHRlbmQoe3RlbXBsYXRlOidDb250cm9sUGFuZWwnLGN1c3RvbV9ldmVudHM6e2dldF9hY3Rpb25faW5mbzonX29uR2V0QWN0aW9uSW5mbycsfSxldmVudHM6Xy5leHRlbmQoe30sUmVuZGVyZXIucHJvdG90eXBlLmV2ZW50cyx7J2NsaWNrIC5vX3NlYXJjaHZpZXdfbW9yZSc6J19vbk1vcmUnLH0pLGluaXQ6ZnVuY3Rpb24ocGFyZW50LHN0YXRlLHBhcmFtcyl7dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3RoaXMuX2JyZWFkY3J1bWJzPXBhcmFtcy5icmVhZGNydW1ic3x8W107dGhpcy5fdGl0bGU9cGFyYW1zLnRpdGxlfHwnJzt0aGlzLndpdGhCcmVhZGNydW1icz1wYXJhbXMud2l0aEJyZWFkY3J1bWJzO3RoaXMud2l0aFNlYXJjaEJhcj1wYXJhbXMud2l0aFNlYXJjaEJhcjtpZihwYXJhbXMudGVtcGxhdGUpe3RoaXMudGVtcGxhdGU9cGFyYW1zLnRlbXBsYXRlO30KdGhpcy5jb250ZXh0PXBhcmFtcy5jb250ZXh0O3RoaXMuJHN1Yk1lbnVzPW51bGw7dGhpcy5hY3Rpb249cGFyYW1zLmFjdGlvbjt0aGlzLmRpc3BsYXlTZWFyY2hNZW51PXRydWU7dGhpcy5pc01vYmlsZT1jb25maWcuZGV2aWNlLmlzTW9iaWxlO3RoaXMubWVudXNTZXR1cD1mYWxzZTt0aGlzLnNlYXJjaE1lbnVUeXBlcz1wYXJhbXMuc2VhcmNoTWVudVR5cGVzfHxbXTt0aGlzLnN1Yk1lbnVzPXt9O30sc3RhcnQ6ZnVuY3Rpb24oKXt2YXIgc2VsZj10aGlzO3RoaXMubm9kZXM9eyRidXR0b25zOnRoaXMuJCgnLm9fY3BfYnV0dG9ucycpLCRwYWdlcjp0aGlzLiQoJy5vX2NwX3BhZ2VyJyksJHNpZGViYXI6dGhpcy4kKCcub19jcF9zaWRlYmFyJyksJHN3aXRjaF9idXR0b25zOnRoaXMuJCgnLm9fY3Bfc3dpdGNoX2J1dHRvbnMnKSx9O2lmKCF0aGlzLndpdGhTZWFyY2hCYXIpe3RoaXMubm9kZXMuJHNlYXJjaHZpZXc9dGhpcy4kKCcub19jcF9zZWFyY2h2aWV3Jyk7fQppZih0aGlzLnNlYXJjaE1lbnVUeXBlcy5sZW5ndGg9PT0wKXt0aGlzLm5vZGVzLiRzZWFyY2h2aWV3X2J1dHRvbnM9dGhpcy4kKCcub19zZWFyY2hfb3B0aW9ucycpO30KaWYodGhpcy53aXRoQnJlYWRjcnVtYnMpe3RoaXMuX3JlbmRlckJyZWFkY3J1bWJzKCk7fQp2YXIgc3VwZXJEZWY9dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3ZhciBzZWFyY2hEZWY9dGhpcy5fcmVuZGVyU2VhcmNoKCk7cmV0dXJuIFByb21pc2UuYWxsKFtzdXBlckRlZixzZWFyY2hEZWZdKS50aGVuKGZ1bmN0aW9uKCl7c2VsZi5fc2V0U2VhcmNoTWVudXNWaXNpYmlsaXR5KCk7fSk7fSxvbl9hdHRhY2hfY2FsbGJhY2s6ZnVuY3Rpb24oKXt0aGlzLl9mb2N1c1NlYXJjaElucHV0KCk7fSxvbl9kZXRhY2hfY2FsbGJhY2s6ZnVuY3Rpb24oKXt9LGdldExhc3RGYWNldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnN0YXRlLmZhY2V0cy5zbGljZSgtMSlbMF07fSx1cGRhdGVDb250ZW50czpmdW5jdGlvbihzdGF0dXMsb3B0aW9ucyl7dmFyIG5ld19jcF9jb250ZW50PXN0YXR1cy5jcF9jb250ZW50fHx7fTt2YXIgY2xlYXI9J2NsZWFyJ2luKG9wdGlvbnN8fHt9KT9vcHRpb25zLmNsZWFyOnRydWU7aWYodGhpcy53aXRoQnJlYWRjcnVtYnMpe3RoaXMuX2JyZWFkY3J1bWJzPXN0YXR1cy5icmVhZGNydW1ic3x8dGhpcy5fYnJlYWRjcnVtYnM7dGhpcy5fdGl0bGU9c3RhdHVzLnRpdGxlfHx0aGlzLl90aXRsZTt0aGlzLl9yZW5kZXJCcmVhZGNydW1icygpO30KaWYoY2xlYXIpe3RoaXMuX2RldGFjaENvbnRlbnQodGhpcy5ub2Rlcyk7fWVsc2V7dGhpcy5fZGV0YWNoQ29udGVudChfLnBpY2sodGhpcy5ub2RlcyxfLmtleXMobmV3X2NwX2NvbnRlbnQpKSk7fQp0aGlzLl9hdHRhY2hDb250ZW50KG5ld19jcF9jb250ZW50KTt9LHVwZGF0ZVN0YXRlOmZ1bmN0aW9uKHN0YXRlKXt0aGlzLnN0YXRlPXN0YXRlO3JldHVybiB0aGlzLl9yZW5kZXJTZWFyY2goKTt9LF9hdHRhY2hDb250ZW50OmZ1bmN0aW9uKGNvbnRlbnQpe2Zvcih2YXIgJGVsZW1lbnQgaW4gY29udGVudCl7dmFyICRub2Rlc2V0PWNvbnRlbnRbJGVsZW1lbnRdO2lmKCRub2Rlc2V0JiZ0aGlzLm5vZGVzWyRlbGVtZW50XSl7dGhpcy5ub2Rlc1skZWxlbWVudF0uYXBwZW5kKCRub2Rlc2V0KTt9fX0sX2RldGFjaENvbnRlbnQ6ZnVuY3Rpb24oY29udGVudCl7Zm9yKHZhciAkZWxlbWVudCBpbiBjb250ZW50KXtjb250ZW50WyRlbGVtZW50XS5jb250ZW50cygpLmRldGFjaCgpO319LF9mb2N1c1NlYXJjaElucHV0OmZ1bmN0aW9uKCl7aWYodGhpcy53aXRoU2VhcmNoQmFyJiYhY29uZmlnLmRldmljZS5pc01vYmlsZSl7dGhpcy5zZWFyY2hCYXIuZm9jdXMoKTt9fSxfZ2V0TWVudUl0ZW1zOmZ1bmN0aW9uKG1lbnVUeXBlKXt2YXIgbWVudUl0ZW1zO2lmKG1lbnVUeXBlPT09J2ZpbHRlcicpe21lbnVJdGVtcz10aGlzLnN0YXRlLmZpbHRlcnM7fQppZihtZW51VHlwZT09PSdncm91cEJ5Jyl7bWVudUl0ZW1zPXRoaXMuc3RhdGUuZ3JvdXBCeXM7fQppZihtZW51VHlwZT09PSd0aW1lUmFuZ2UnKXttZW51SXRlbXM9dGhpcy5zdGF0ZS50aW1lUmFuZ2VzO30KaWYobWVudVR5cGU9PT0nZmF2b3JpdGUnKXttZW51SXRlbXM9dGhpcy5zdGF0ZS5mYXZvcml0ZXM7fQpyZXR1cm4gbWVudUl0ZW1zO30sX2dldFN1Yk1lbnVzUGxhY2U6ZnVuY3Rpb24oKXtyZXR1cm4gJCgnPGRpdj4nKS5hcHBlbmRUbyh0aGlzLiQoJy5vX3NlYXJjaF9vcHRpb25zJykpO30sX3JlbmRlckJyZWFkY3J1bWJzOmZ1bmN0aW9uKCl7dmFyIHNlbGY9dGhpczt2YXIgYnJlYWRjcnVtYnNEZXNjcmlwdG9ycz10aGlzLl9icmVhZGNydW1icy5jb25jYXQoe3RpdGxlOnRoaXMuX3RpdGxlfSk7dmFyIGJyZWFkY3J1bWJzPWJyZWFkY3J1bWJzRGVzY3JpcHRvcnMubWFwKGZ1bmN0aW9uKGJjLGluZGV4KXtyZXR1cm4gc2VsZi5fcmVuZGVyQnJlYWRjcnVtYnNJdGVtKGJjLGluZGV4LGJyZWFkY3J1bWJzRGVzY3JpcHRvcnMubGVuZ3RoKTt9KTt0aGlzLiQoJy5icmVhZGNydW1iJykuaHRtbChicmVhZGNydW1icyk7fSxfcmVuZGVyQnJlYWRjcnVtYnNJdGVtOmZ1bmN0aW9uKGJjLGluZGV4LGxlbmd0aCl7dmFyIHNlbGY9dGhpczt2YXIgaXNfbGFzdD0oaW5kZXg9PT1sZW5ndGgtMSk7dmFyIGxpX2NvbnRlbnQ9YmMudGl0bGUmJl8uZXNjYXBlKGJjLnRpdGxlLnRyaW0oKSl8fGRhdGEubm9EaXNwbGF5Q29udGVudDt2YXIgJGJjPSQoJzxsaT4nLHtjbGFzczonYnJlYWRjcnVtYi1pdGVtJ30pLmFwcGVuZChpc19sYXN0P2xpX2NvbnRlbnQ6JCgnPGE+Jyx7aHJlZjonIyd9KS5odG1sKGxpX2NvbnRlbnQpKS50b2dnbGVDbGFzcygnYWN0aXZlJyxpc19sYXN0KTtpZighaXNfbGFzdCl7JGJjLmNsaWNrKGZ1bmN0aW9uKGV2KXtldi5wcmV2ZW50RGVmYXVsdCgpO3NlbGYudHJpZ2dlcl91cCgnYnJlYWRjcnVtYl9jbGlja2VkJyx7Y29udHJvbGxlcklEOmJjLmNvbnRyb2xsZXJJRH0pO30pO30KdmFyIHNlY29uZExhc3Q9aW5kZXg9PT1sZW5ndGgtMjtpZihzZWNvbmRMYXN0KXskYmMuYXR0cignYWNjZXNzS2V5JywnYicpO30KcmV0dXJuICRiYzt9LF9yZW5kZXJTZWFyY2g6ZnVuY3Rpb24oKXt2YXIgZGVmcz1bXTtpZih0aGlzLm1lbnVzU2V0dXApe3RoaXMuX3VwZGF0ZU1lbnVzKCk7fWVsc2V7dGhpcy5tZW51c1NldHVwPXRydWU7ZGVmcz1kZWZzLmNvbmNhdCh0aGlzLl9zZXR1cE1lbnVzKCkpO30KaWYodGhpcy53aXRoU2VhcmNoQmFyKXtkZWZzLnB1c2godGhpcy5fcmVuZGVyU2VhcmNoQmFyKCkpO30KcmV0dXJuIFByb21pc2UuYWxsKGRlZnMpLnRoZW4odGhpcy5fZm9jdXNTZWFyY2hJbnB1dC5iaW5kKHRoaXMpKTt9LF9yZW5kZXJTZWFyY2hCYXI6ZnVuY3Rpb24oKXt2YXIgb2xkU2VhcmNoQmFyPXRoaXMuc2VhcmNoQmFyO3RoaXMuc2VhcmNoQmFyPW5ldyBTZWFyY2hCYXIodGhpcyx7Y29udGV4dDp0aGlzLmNvbnRleHQsZmFjZXRzOnRoaXMuc3RhdGUuZmFjZXRzLGZpZWxkczp0aGlzLnN0YXRlLmZpZWxkcyxmaWx0ZXJGaWVsZHM6dGhpcy5zdGF0ZS5maWx0ZXJGaWVsZHMsfSk7cmV0dXJuIHRoaXMuc2VhcmNoQmFyLmFwcGVuZFRvKHRoaXMuJCgnLm9fc2VhcmNodmlldycpKS50aGVuKGZ1bmN0aW9uKCl7aWYob2xkU2VhcmNoQmFyKXtvbGRTZWFyY2hCYXIuZGVzdHJveSgpO319KTt9LF9zZXRTZWFyY2hNZW51c1Zpc2liaWxpdHk6ZnVuY3Rpb24oKXt0aGlzLiQoJy5vX3NlYXJjaHZpZXdfbW9yZScpLnRvZ2dsZUNsYXNzKCdmYS1zZWFyY2gtcGx1cycsIXRoaXMuZGlzcGxheVNlYXJjaE1lbnUpLnRvZ2dsZUNsYXNzKCdmYS1zZWFyY2gtbWludXMnLHRoaXMuZGlzcGxheVNlYXJjaE1lbnUpO3RoaXMuJCgnLm9fc2VhcmNoX29wdGlvbnMnKS50b2dnbGVDbGFzcygnb19oaWRkZW4nLCF0aGlzLmRpc3BsYXlTZWFyY2hNZW51KTt9LF9zZXR1cE1lbnU6ZnVuY3Rpb24obWVudVR5cGUpe3ZhciBNZW51O3ZhciBtZW51O2lmKG1lbnVUeXBlPT09J2ZpbHRlcicpe01lbnU9RmlsdGVyTWVudTt9CmlmKG1lbnVUeXBlPT09J2dyb3VwQnknKXtNZW51PUdyb3VwQnlNZW51O30KaWYobWVudVR5cGU9PT0ndGltZVJhbmdlJyl7TWVudT1UaW1lUmFuZ2VNZW51O30KaWYobWVudVR5cGU9PT0nZmF2b3JpdGUnKXtNZW51PUZhdm9yaXRlTWVudTt9CmlmKF8uY29udGFpbnMoWydmaWx0ZXInLCdncm91cEJ5JywndGltZVJhbmdlJ10sbWVudVR5cGUpKXttZW51PW5ldyBNZW51KHRoaXMsdGhpcy5fZ2V0TWVudUl0ZW1zKG1lbnVUeXBlKSx0aGlzLnN0YXRlLmZpZWxkcyk7fQppZihtZW51VHlwZT09PSdmYXZvcml0ZScpe21lbnU9bmV3IE1lbnUodGhpcyx0aGlzLl9nZXRNZW51SXRlbXMobWVudVR5cGUpLHRoaXMuYWN0aW9uKTt9CnRoaXMuc3ViTWVudXNbbWVudVR5cGVdPW1lbnU7cmV0dXJuIG1lbnUuYXBwZW5kVG8odGhpcy4kc3ViTWVudXMpO30sX3NldHVwTWVudXM6ZnVuY3Rpb24oKXt0aGlzLiRzdWJNZW51cz10aGlzLl9nZXRTdWJNZW51c1BsYWNlKCk7cmV0dXJuIHRoaXMuc2VhcmNoTWVudVR5cGVzLm1hcCh0aGlzLl9zZXR1cE1lbnUuYmluZCh0aGlzKSk7fSxfdXBkYXRlTWVudXM6ZnVuY3Rpb24oKXt2YXIgc2VsZj10aGlzO3RoaXMuc2VhcmNoTWVudVR5cGVzLmZvckVhY2goZnVuY3Rpb24obWVudVR5cGUpe3NlbGYuc3ViTWVudXNbbWVudVR5cGVdLnVwZGF0ZShzZWxmLl9nZXRNZW51SXRlbXMobWVudVR5cGUpKTt9KTt9LF9vbk1vcmU6ZnVuY3Rpb24oKXt0aGlzLmRpc3BsYXlTZWFyY2hNZW51PSF0aGlzLmRpc3BsYXlTZWFyY2hNZW51O3RoaXMuX3NldFNlYXJjaE1lbnVzVmlzaWJpbGl0eSgpO30sfSk7cmV0dXJuIENvbnRyb2xQYW5lbFJlbmRlcmVyO30pOzsKCi8qIC93ZWIvc3RhdGljL3NyYy9qcy92aWV3cy9jb250cm9sX3BhbmVsL2NvbnRyb2xfcGFuZWxfdmlldy5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwpvZG9vLmRlZmluZSgnd2ViLkNvbnRyb2xQYW5lbFZpZXcnLGZ1bmN0aW9uKHJlcXVpcmUpeyJ1c2Ugc3RyaWN0Ijt2YXIgQ29udHJvbFBhbmVsQ29udHJvbGxlcj1yZXF1aXJlKCd3ZWIuQ29udHJvbFBhbmVsQ29udHJvbGxlcicpO3ZhciBDb250cm9sUGFuZWxNb2RlbD1yZXF1aXJlKCd3ZWIuQ29udHJvbFBhbmVsTW9kZWwnKTt2YXIgQ29udHJvbFBhbmVsUmVuZGVyZXI9cmVxdWlyZSgnd2ViLkNvbnRyb2xQYW5lbFJlbmRlcmVyJyk7dmFyIGNvbnRyb2xQYW5lbFZpZXdQYXJhbWV0ZXJzPXJlcXVpcmUoJ3dlYi5jb250cm9sUGFuZWxWaWV3UGFyYW1ldGVycycpO3ZhciBtdmM9cmVxdWlyZSgnd2ViLm12YycpO3ZhciBweVV0aWxzPXJlcXVpcmUoJ3dlYi5weV91dGlscycpO3ZhciB2aWV3VXRpbHM9cmVxdWlyZSgnd2ViLnZpZXdVdGlscycpO3ZhciBEb21haW49cmVxdWlyZSgnd2ViLkRvbWFpbicpO3ZhciBERUZBVUxUX0lOVEVSVkFMPWNvbnRyb2xQYW5lbFZpZXdQYXJhbWV0ZXJzLkRFRkFVTFRfSU5URVJWQUw7dmFyIERFRkFVTFRfUEVSSU9EPWNvbnRyb2xQYW5lbFZpZXdQYXJhbWV0ZXJzLkRFRkFVTFRfUEVSSU9EO3ZhciBJTlRFUlZBTF9PUFRJT05TPWNvbnRyb2xQYW5lbFZpZXdQYXJhbWV0ZXJzLklOVEVSVkFMX09QVElPTlM7dmFyIFBFUklPRF9PUFRJT05TPWNvbnRyb2xQYW5lbFZpZXdQYXJhbWV0ZXJzLlBFUklPRF9PUFRJT05TO2NvbnN0IE9QVElPTl9HRU5FUkFUT1JTPWNvbnRyb2xQYW5lbFZpZXdQYXJhbWV0ZXJzLk9QVElPTl9HRU5FUkFUT1JTO3ZhciBGYWN0b3J5PW12Yy5GYWN0b3J5O3ZhciBDb250cm9sUGFuZWxWaWV3PUZhY3RvcnkuZXh0ZW5kKHtjb25maWc6Xy5leHRlbmQoe30sRmFjdG9yeS5wcm90b3R5cGUuY29uZmlnLHtDb250cm9sbGVyOkNvbnRyb2xQYW5lbENvbnRyb2xsZXIsTW9kZWw6Q29udHJvbFBhbmVsTW9kZWwsUmVuZGVyZXI6Q29udHJvbFBhbmVsUmVuZGVyZXIsfSksaW5pdDpmdW5jdGlvbihwYXJhbXMpe3ZhciBzZWxmPXRoaXM7dGhpcy5fc3VwZXIoKTtwYXJhbXM9cGFyYW1zfHx7fTt2YXIgdmlld0luZm89cGFyYW1zLnZpZXdJbmZvfHx7YXJjaDonPHNlYXJjaC8+JyxmaWVsZHM6e319O3ZhciBjb250ZXh0PV8uZXh0ZW5kKHt9LHBhcmFtcy5jb250ZXh0KTt2YXIgZG9tYWluPXBhcmFtcy5kb21haW58fFtdO3ZhciBhY3Rpb249cGFyYW1zLmFjdGlvbnx8e307dGhpcy5zZWFyY2hEZWZhdWx0cz17fTtPYmplY3Qua2V5cyhjb250ZXh0KS5mb3JFYWNoKGZ1bmN0aW9uKGtleSl7dmFyIG1hdGNoPS9ec2VhcmNoX2RlZmF1bHRfKC4qKSQvLmV4ZWMoa2V5KTtpZihtYXRjaCl7c2VsZi5zZWFyY2hEZWZhdWx0c1ttYXRjaFsxXV09Y29udGV4dFtrZXldO2RlbGV0ZSBjb250ZXh0W2tleV07fX0pO3RoaXMuYXJjaD12aWV3VXRpbHMucGFyc2VBcmNoKHZpZXdJbmZvLmFyY2gpO3RoaXMuZmllbGRzPXZpZXdJbmZvLmZpZWxkczt0aGlzLnJlZmVyZW5jZU1vbWVudD1tb21lbnQoKTt0aGlzLm9wdGlvbkdlbmVyYXRvcnM9T1BUSU9OX0dFTkVSQVRPUlMubWFwKG89Pntjb25zdCBkZXNjcmlwdGlvbj1vLmRlc2NyaXB0aW9uP28uZGVzY3JpcHRpb24udG9TdHJpbmcoKTp0aGlzLnJlZmVyZW5jZU1vbWVudC5jbG9uZSgpLnNldChvLnNldFBhcmFtKS5hZGQoby5hZGRQYXJhbSkuZm9ybWF0KG8uZm9ybWF0KTtyZXR1cm4gXy5leHRlbmQoe30sbyx7ZGVzY3JpcHRpb246ZGVzY3JpcHRpb259KTt9KTtQRVJJT0RfT1BUSU9OUz1QRVJJT0RfT1BUSU9OUy5tYXAob3B0aW9uPT5fLmV4dGVuZCh7fSxvcHRpb24se2Rlc2NyaXB0aW9uOm9wdGlvbi5kZXNjcmlwdGlvbi50b1N0cmluZygpfSkpO0lOVEVSVkFMX09QVElPTlM9SU5URVJWQUxfT1BUSU9OUy5tYXAob3B0aW9uPT5fLmV4dGVuZCh7fSxvcHRpb24se2Rlc2NyaXB0aW9uOm9wdGlvbi5kZXNjcmlwdGlvbi50b1N0cmluZygpfSkpO3RoaXMuY29udHJvbGxlclBhcmFtcy5tb2RlbE5hbWU9cGFyYW1zLm1vZGVsTmFtZTt0aGlzLm1vZGVsUGFyYW1zLmNvbnRleHQ9Y29udGV4dDt0aGlzLm1vZGVsUGFyYW1zLmRvbWFpbj1kb21haW47dGhpcy5tb2RlbFBhcmFtcy5tb2RlbE5hbWU9cGFyYW1zLm1vZGVsTmFtZTt0aGlzLm1vZGVsUGFyYW1zLmFjdGlvbklkPWFjdGlvbi5pZDt0aGlzLm1vZGVsUGFyYW1zLmZpZWxkcz10aGlzLmZpZWxkczt0aGlzLnJlbmRlcmVyUGFyYW1zLmFjdGlvbj1hY3Rpb247dGhpcy5yZW5kZXJlclBhcmFtcy5icmVhZGNydW1icz1wYXJhbXMuYnJlYWRjcnVtYnM7dGhpcy5yZW5kZXJlclBhcmFtcy5jb250ZXh0PWNvbnRleHQ7dGhpcy5yZW5kZXJlclBhcmFtcy5zZWFyY2hNZW51VHlwZXM9cGFyYW1zLnNlYXJjaE1lbnVUeXBlc3x8W107dGhpcy5yZW5kZXJlclBhcmFtcy50ZW1wbGF0ZT1wYXJhbXMudGVtcGxhdGU7dGhpcy5yZW5kZXJlclBhcmFtcy50aXRsZT1wYXJhbXMudGl0bGU7dGhpcy5yZW5kZXJlclBhcmFtcy53aXRoQnJlYWRjcnVtYnM9cGFyYW1zLndpdGhCcmVhZGNydW1icyE9PWZhbHNlO3RoaXMucmVuZGVyZXJQYXJhbXMud2l0aFNlYXJjaEJhcj0nd2l0aFNlYXJjaEJhcidpbiBwYXJhbXM/cGFyYW1zLndpdGhTZWFyY2hCYXI6dHJ1ZTt0aGlzLmxvYWRQYXJhbXMud2l0aFNlYXJjaEJhcj0nd2l0aFNlYXJjaEJhcidpbiBwYXJhbXM/cGFyYW1zLndpdGhTZWFyY2hCYXI6dHJ1ZTt0aGlzLmxvYWRQYXJhbXMuc2VhcmNoTWVudVR5cGVzPXBhcmFtcy5zZWFyY2hNZW51VHlwZXN8fFtdO3RoaXMubG9hZFBhcmFtcy5hY3RpdmF0ZURlZmF1bHRGYXZvcml0ZT1wYXJhbXMuYWN0aXZhdGVEZWZhdWx0RmF2b3JpdGU7aWYodGhpcy5sb2FkUGFyYW1zLndpdGhTZWFyY2hCYXIpe2lmKHBhcmFtcy5zdGF0ZSl7dGhpcy5sb2FkUGFyYW1zLmluaXRpYWxTdGF0ZT1wYXJhbXMuc3RhdGU7fWVsc2V7dGhpcy5sb2FkUGFyYW1zLmdyb3Vwcz1bXTt0aGlzLmxvYWRQYXJhbXMudGltZVJhbmdlcz1jb250ZXh0LnRpbWVfcmFuZ2VzO3RoaXMuX3BhcnNlU2VhcmNoQXJjaCh0aGlzLmFyY2gpO319CmlmKHBhcmFtcy5keW5hbWljRmlsdGVycyYmcGFyYW1zLmR5bmFtaWNGaWx0ZXJzLmxlbmd0aCl7dmFyIGR5bmFtaWNGaWx0ZXJzR3JvdXA9cGFyYW1zLmR5bmFtaWNGaWx0ZXJzLm1hcChmdW5jdGlvbihmaWx0ZXIpe3JldHVybntkZXNjcmlwdGlvbjpmaWx0ZXIuZGVzY3JpcHRpb24sZG9tYWluOkpTT04uc3RyaW5naWZ5KGZpbHRlci5kb21haW4pLGlzRGVmYXVsdDp0cnVlLHR5cGU6J2ZpbHRlcicsfTt9KTt0aGlzLmxvYWRQYXJhbXMuZ3JvdXBzLnVuc2hpZnQoZHluYW1pY0ZpbHRlcnNHcm91cCk7fX0sX2V2YWxBcmNoQ2hpbGQ6ZnVuY3Rpb24oY2hpbGQpe2lmKGNoaWxkLmF0dHJzLmNvbnRleHQpe3RyeXt2YXIgY29udGV4dD1weVV0aWxzLmV2YWwoJ2NvbnRleHQnLGNoaWxkLmF0dHJzLmNvbnRleHQpO2lmKGNvbnRleHQuZ3JvdXBfYnkpe2NoaWxkLnRhZz0nZ3JvdXBCeSc7Y2hpbGQuYXR0cnMuZmllbGROYW1lPWNvbnRleHQuZ3JvdXBfYnkuc3BsaXQoJzonKVswXTtjaGlsZC5hdHRycy5kZWZhdWx0SW50ZXJ2YWw9Y29udGV4dC5ncm91cF9ieS5zcGxpdCgnOicpWzFdO319Y2F0Y2goZSl7fX0KcmV0dXJuIGNoaWxkO30sX2V4dHJhY3RBdHRyaWJ1dGVzOmZ1bmN0aW9uKGZpbHRlcixhdHRycyl7ZmlsdGVyLmlzRGVmYXVsdD10aGlzLnNlYXJjaERlZmF1bHRzW2F0dHJzLm5hbWVdP3RydWU6ZmFsc2U7ZmlsdGVyLmRlc2NyaXB0aW9uPWF0dHJzLnN0cmluZ3x8YXR0cnMuaGVscHx8YXR0cnMubmFtZXx8YXR0cnMuZG9tYWlufHwnzqknO2lmKGZpbHRlci50eXBlPT09J2ZpbHRlcicpe2lmKGZpbHRlci5pc0RlZmF1bHQpe2ZpbHRlci5kZWZhdWx0UmFuaz0tNTt9CmZpbHRlci5kb21haW49YXR0cnMuZG9tYWluO2ZpbHRlci5jb250ZXh0PXB5VXRpbHMuZXZhbCgnY29udGV4dCcsYXR0cnMuY29udGV4dCk7aWYoYXR0cnMuZGF0ZSl7ZmlsdGVyLmZpZWxkTmFtZT1hdHRycy5kYXRlO2ZpbHRlci5maWVsZFR5cGU9dGhpcy5maWVsZHNbYXR0cnMuZGF0ZV0udHlwZTtmaWx0ZXIuaGFzT3B0aW9ucz10cnVlO2ZpbHRlci5vcHRpb25zPXRoaXMub3B0aW9uR2VuZXJhdG9ycztmaWx0ZXIuZGVmYXVsdE9wdGlvbklkPWF0dHJzLmRlZmF1bHRfcGVyaW9kfHxERUZBVUxUX1BFUklPRDtmaWx0ZXIuY3VycmVudE9wdGlvbklkcz1uZXcgU2V0KCk7ZmlsdGVyLmJhc2ljRG9tYWlucz10aGlzLl9nZXREYXRlRmlsdGVyQmFzaWNEb21haW5zKGZpbHRlcik7fQppZihhdHRycy5pbnZpc2libGUpe2ZpbHRlci5pbnZpc2libGU9dHJ1ZTt9fWVsc2UgaWYoZmlsdGVyLnR5cGU9PT0nZ3JvdXBCeScpe2lmKGZpbHRlci5pc0RlZmF1bHQpe2NvbnN0IHZhbD10aGlzLnNlYXJjaERlZmF1bHRzW2F0dHJzLm5hbWVdO2ZpbHRlci5kZWZhdWx0UmFuaz10eXBlb2YgdmFsPT09J251bWJlcic/dmFsOjEwMDt9CmZpbHRlci5maWVsZE5hbWU9YXR0cnMuZmllbGROYW1lO2ZpbHRlci5maWVsZFR5cGU9dGhpcy5maWVsZHNbYXR0cnMuZmllbGROYW1lXS50eXBlO2lmKF8uY29udGFpbnMoWydkYXRlJywnZGF0ZXRpbWUnXSxmaWx0ZXIuZmllbGRUeXBlKSl7ZmlsdGVyLmhhc09wdGlvbnM9dHJ1ZTtmaWx0ZXIub3B0aW9ucz1JTlRFUlZBTF9PUFRJT05TO2ZpbHRlci5kZWZhdWx0T3B0aW9uSWQ9YXR0cnMuZGVmYXVsdEludGVydmFsfHxERUZBVUxUX0lOVEVSVkFMO2ZpbHRlci5jdXJyZW50T3B0aW9uSWRzPW5ldyBTZXQoKTt9fWVsc2UgaWYoZmlsdGVyLnR5cGU9PT0nZmllbGQnKXtpZihmaWx0ZXIuaXNEZWZhdWx0KXtmaWx0ZXIuZGVmYXVsdFJhbms9LTEwO30KdmFyIGZpZWxkPXRoaXMuZmllbGRzW2F0dHJzLm5hbWVdO2ZpbHRlci5hdHRycz1hdHRycztmaWx0ZXIuYXV0b0NvbXBsZXRlVmFsdWVzPVtdO2lmKGZpbHRlci5pc0RlZmF1bHQpe2ZpbHRlci5kZWZhdWx0VmFsdWU9dGhpcy5zZWFyY2hEZWZhdWx0c1tmaWx0ZXIuYXR0cnMubmFtZV07fQppZighYXR0cnMuc3RyaW5nKXthdHRycy5zdHJpbmc9ZmllbGQuc3RyaW5nO319fSxfZ2V0RGF0ZUZpbHRlckJhc2ljRG9tYWluczpmdW5jdGlvbihmaWx0ZXIpe2NvbnN0IF9jb25zdHJ1Y3RCYXNpY0RvbWFpbj0oeSxvKT0+e2NvbnN0IGFkZFBhcmFtPV8uZXh0ZW5kKHt9LHkuYWRkUGFyYW0sbz9vLmFkZFBhcmFtOnt9KTtjb25zdCBzZXRQYXJhbT1fLmV4dGVuZCh7fSx5LnNldFBhcmFtLG8/by5zZXRQYXJhbTp7fSk7Y29uc3QgZ3JhbnVsYXJpdHk9bz9vLmdyYW51bGFyaXR5OnkuZ3JhbnVsYXJpdHk7Y29uc3QgZGF0ZT10aGlzLnJlZmVyZW5jZU1vbWVudC5jbG9uZSgpLnNldChzZXRQYXJhbSkuYWRkKGFkZFBhcmFtKTtsZXQgbGVmdEJvdW5kPWRhdGUuY2xvbmUoKS5zdGFydE9mKGdyYW51bGFyaXR5KTtsZXQgcmlnaHRCb3VuZD1kYXRlLmNsb25lKCkuZW5kT2YoZ3JhbnVsYXJpdHkpO2lmKGZpbHRlci5maWVsZFR5cGU9PT0nZGF0ZScpe2xlZnRCb3VuZD1sZWZ0Qm91bmQuZm9ybWF0KCJZWVlZLU1NLUREIik7cmlnaHRCb3VuZD1yaWdodEJvdW5kLmZvcm1hdCgiWVlZWS1NTS1ERCIpO31lbHNle2xlZnRCb3VuZD1sZWZ0Qm91bmQudXRjKCkuZm9ybWF0KCJZWVlZLU1NLUREIEhIOm1tOnNzIik7cmlnaHRCb3VuZD1yaWdodEJvdW5kLnV0YygpLmZvcm1hdCgiWVlZWS1NTS1ERCBISDptbTpzcyIpO30KY29uc3QgZG9tYWluPURvbWFpbi5wcm90b3R5cGUuYXJyYXlUb1N0cmluZyhbJyYnLFtmaWx0ZXIuZmllbGROYW1lLCI+PSIsbGVmdEJvdW5kXSxbZmlsdGVyLmZpZWxkTmFtZSwiPD0iLHJpZ2h0Qm91bmRdXSk7bGV0IGRlc2NyaXB0aW9uO2lmKG8pe2Rlc2NyaXB0aW9uPW8uZGVzY3JpcHRpb24rIiAiK3kuZGVzY3JpcHRpb247fWVsc2V7ZGVzY3JpcHRpb249eS5kZXNjcmlwdGlvbjt9CnJldHVybntkb21haW4sZGVzY3JpcHRpb259O307Y29uc3QgZG9tYWlucz17fTt0aGlzLm9wdGlvbkdlbmVyYXRvcnMuZmlsdGVyKHk9PnkuZ3JvdXBJZD09PTIpLmZvckVhY2goeT0+e2RvbWFpbnNbeS5vcHRpb25JZF09X2NvbnN0cnVjdEJhc2ljRG9tYWluKHkpO3RoaXMub3B0aW9uR2VuZXJhdG9ycy5maWx0ZXIoeT0+eS5ncm91cElkPT09MSkuZm9yRWFjaChvPT57ZG9tYWluc1t5Lm9wdGlvbklkKyJfXyIrby5vcHRpb25JZF09X2NvbnN0cnVjdEJhc2ljRG9tYWluKHksbyk7fSk7fSk7cmV0dXJuIGRvbWFpbnM7fSxfcGFyc2VTZWFyY2hBcmNoOmZ1bmN0aW9uKGFyY2gpe3ZhciBzZWxmPXRoaXM7dmFyIGNoaWxkcmVuPWFyY2guY2hpbGRyZW4uZmlsdGVyKGZ1bmN0aW9uKGNoaWxkKXtyZXR1cm4gY2hpbGQudGFnIT09J3NlYXJjaHBhbmVsJzt9KTt2YXIgcHJlRmlsdGVycz1fLmZsYXR0ZW4oY2hpbGRyZW4ubWFwKGZ1bmN0aW9uKGNoaWxkKXtyZXR1cm4gY2hpbGQudGFnIT09J2dyb3VwJz9zZWxmLl9ldmFsQXJjaENoaWxkKGNoaWxkKTpjaGlsZC5jaGlsZHJlbi5tYXAoc2VsZi5fZXZhbEFyY2hDaGlsZCk7fSkpO3ByZUZpbHRlcnMucHVzaCh7dGFnOidzZXBhcmF0b3InfSk7dmFyIGZpbHRlcjt2YXIgY3VycmVudFRhZzt2YXIgY3VycmVudEdyb3VwPVtdO3ZhciBncm91cE9mR3JvdXBCeXM9W107dmFyIGdyb3VwTnVtYmVyPTE7Xy5lYWNoKHByZUZpbHRlcnMsZnVuY3Rpb24ocHJlRmlsdGVyKXtpZihwcmVGaWx0ZXIudGFnIT09Y3VycmVudFRhZ3x8Xy5jb250YWlucyhbJ3NlcGFyYXRvcicsJ2ZpZWxkJ10scHJlRmlsdGVyLnRhZykpe2lmKGN1cnJlbnRHcm91cC5sZW5ndGgpe2lmKGN1cnJlbnRUYWc9PT0nZ3JvdXBCeScpe2dyb3VwT2ZHcm91cEJ5cz1ncm91cE9mR3JvdXBCeXMuY29uY2F0KGN1cnJlbnRHcm91cCk7fWVsc2V7c2VsZi5sb2FkUGFyYW1zLmdyb3Vwcy5wdXNoKGN1cnJlbnRHcm91cCk7fX0KY3VycmVudFRhZz1wcmVGaWx0ZXIudGFnO2N1cnJlbnRHcm91cD1bXTtncm91cE51bWJlcisrO30KaWYocHJlRmlsdGVyLnRhZyE9PSdzZXBhcmF0b3InKXtmaWx0ZXI9e3R5cGU6cHJlRmlsdGVyLnRhZyx9O2lmKGZpbHRlci50eXBlPT09J2ZpbHRlcid8fGZpbHRlci50eXBlPT09J2dyb3VwQnknKXtmaWx0ZXIuZ3JvdXBOdW1iZXI9Z3JvdXBOdW1iZXI7fQpzZWxmLl9leHRyYWN0QXR0cmlidXRlcyhmaWx0ZXIscHJlRmlsdGVyLmF0dHJzKTtjdXJyZW50R3JvdXAucHVzaChmaWx0ZXIpO319KTtpZihncm91cE9mR3JvdXBCeXMubGVuZ3RoKXt0aGlzLmxvYWRQYXJhbXMuZ3JvdXBzLnB1c2goZ3JvdXBPZkdyb3VwQnlzKTt9fSx9KTtyZXR1cm4gQ29udHJvbFBhbmVsVmlldzt9KTs7CgovKiAvd2ViL3N0YXRpYy9zcmMvanMvdmlld3MvY29udHJvbF9wYW5lbC9tb2JpbGVfY29udHJvbF9wYW5lbF9jb250cm9sbGVyLmpzIGRlZmluZWQgaW4gYnVuZGxlICd3ZWIuYXNzZXRzX2JhY2tlbmQnICovCm9kb28uZGVmaW5lKCd3ZWIuTW9iaWxlQ29udHJvbFBhbmVsQ29udHJvbGxlcicsZnVuY3Rpb24ocmVxdWlyZSl7InVzZSBzdHJpY3QiO3ZhciBjb25maWc9cmVxdWlyZSgnd2ViLmNvbmZpZycpO3ZhciBDb250cm9sUGFuZWxDb250cm9sbGVyPXJlcXVpcmUoJ3dlYi5Db250cm9sUGFuZWxDb250cm9sbGVyJyk7aWYoIWNvbmZpZy5kZXZpY2UuaXNNb2JpbGUpe3JldHVybjt9CkNvbnRyb2xQYW5lbENvbnRyb2xsZXIuaW5jbHVkZSh7Y3VzdG9tX2V2ZW50czpfLmV4dGVuZCh7fSxDb250cm9sUGFuZWxDb250cm9sbGVyLnByb3RvdHlwZS5jdXN0b21fZXZlbnRzLHsnc2VhcmNoX2Jhcl9jbGVhcmVkJzonX29uU2VhcmNoQmFyQ2xlYXJlZCcsfSksX29uU2VhcmNoQmFyQ2xlYXJlZDpmdW5jdGlvbigpe3ZhciBzZWxmPXRoaXM7dGhpcy5tb2RlbC5nZXQoKS5xdWVyeS5mb3JFYWNoKGZ1bmN0aW9uKGdyb3VwSWQpe3NlbGYubW9kZWwuZGVhY3RpdmF0ZUdyb3VwKGdyb3VwSWQpO30pO3RoaXMuX3JlcG9ydE5ld1F1ZXJ5QW5kUmVuZGVyKCk7fSx9KTt9KTs7CgovKiAvd2ViL3N0YXRpYy9zcmMvanMvdmlld3MvY29udHJvbF9wYW5lbC9tb2JpbGVfY29udHJvbF9wYW5lbF9yZW5kZXJlci5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwpvZG9vLmRlZmluZSgnd2ViLk1vYmlsZUNvbnRyb2xQYW5lbFJlbmRlcmVyJyxmdW5jdGlvbihyZXF1aXJlKXsidXNlIHN0cmljdCI7dmFyIGNvbmZpZz1yZXF1aXJlKCd3ZWIuY29uZmlnJyk7dmFyIENvbnRyb2xQYW5lbFJlbmRlcmVyPXJlcXVpcmUoJ3dlYi5Db250cm9sUGFuZWxSZW5kZXJlcicpO2lmKCFjb25maWcuZGV2aWNlLmlzTW9iaWxlKXtyZXR1cm47fQpDb250cm9sUGFuZWxSZW5kZXJlci5pbmNsdWRlKHtldmVudHM6Xy5leHRlbmQoe30sQ29udHJvbFBhbmVsUmVuZGVyZXIucHJvdG90eXBlLmV2ZW50cyx7J2NsaWNrIC5vX21vYmlsZV9zZWFyY2hfY2xvc2UsIC5vX21vYmlsZV9zZWFyY2hfc2hvd19yZXN1bHQsIC5vX3RvZ2dsZV9zZWFyY2h2aWV3X2Z1bGwnOidfdG9nZ2xlTW9iaWxlU2VhcmNoVmlldycsJ2NsaWNrIC5vX2VuYWJsZV9zZWFyY2h2aWV3JzonX3RvZ2dsZU1vYmlsZVF1aWNrU2VhcmNoVmlldycsJ2NsaWNrIC5vX3RvZ2dsZV9zZWFyY2h2aWV3X2Z1bGwnOidfb25PcGVuTW9iaWxlU2VhcmNoVmlldycsJ2NsaWNrIC5vX21vYmlsZV9zZWFyY2hfY2xlYXJfZmFjZXRzJzonX29uRW1wdHlBbGwnLCdzaG93LmJzLmRyb3Bkb3duIC5vX21vYmlsZV9zZWFyY2hfZmlsdGVyIC5vX2Ryb3Bkb3duJzonX29uRHJvcGRvd25Ub2dnbGUnLCdoaWRlLmJzLmRyb3Bkb3duIC5vX21vYmlsZV9zZWFyY2hfZmlsdGVyIC5vX2Ryb3Bkb3duJzonX29uRHJvcGRvd25Ub2dnbGUnLH0pLF9nZXRTdWJNZW51c1BsYWNlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuJCgnLm9fbW9iaWxlX3NlYXJjaF9maWx0ZXInKTt9LF9yZW5kZXI6ZnVuY3Rpb24oKXt2YXIgc2VsZj10aGlzO3JldHVybiB0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cykudGhlbihmdW5jdGlvbigpe3NlbGYuJCgnLm9fbW9iaWxlX3NlYXJjaF9jbGVhcl9mYWNldHMnKS50b2dnbGVDbGFzcygnb19oaWRkZW4nLCFzZWxmLnN0YXRlLnF1ZXJ5Lmxlbmd0aCk7fSk7fSxfcmVuZGVyU2VhcmNoQmFyOmZ1bmN0aW9uKCl7dmFyIHNlbGY9dGhpcztyZXR1cm4gdGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpLnRoZW4oZnVuY3Rpb24oKXtzZWxmLl9yZW5kZXJTZWFyY2h2aWV3SW5wdXQoKTt9KTt9LF9yZW5kZXJTZWFyY2h2aWV3SW5wdXQ6ZnVuY3Rpb24oKXtpZih0aGlzLiQoJy5vX3RvZ2dsZV9zZWFyY2h2aWV3X2Z1bGwnKS5pcygnOnZpc2libGUnKSYmIXRoaXMuJCgnLm9fbW9iaWxlX3NlYXJjaCcpLmlzKCc6dmlzaWJsZScpKXt0aGlzLiQoJy5vX3RvZ2dsZV9zZWFyY2h2aWV3X2Z1bGwnKS50b2dnbGVDbGFzcygnYnRuLXNlY29uZGFyeScsISF0aGlzLnN0YXRlLnF1ZXJ5Lmxlbmd0aCk7dGhpcy5zZWFyY2hCYXIuJGVsLmRldGFjaCgpLmluc2VydEFmdGVyKHRoaXMuJCgnLm9fbW9iaWxlX3NlYXJjaCcpKTt9ZWxzZXt0aGlzLnNlYXJjaEJhci4kZWwuZGV0YWNoKCkuaW5zZXJ0QWZ0ZXIodGhpcy4kKCcub19tb2JpbGVfc2VhcmNoX2hlYWRlcicpKTt9fSxfdG9nZ2xlTW9iaWxlU2VhcmNoVmlldzpmdW5jdGlvbigpe3RoaXMuJCgnLm9fbW9iaWxlX3NlYXJjaCcpLnRvZ2dsZUNsYXNzKCdvX2hpZGRlbicpO3RoaXMuX3JlbmRlclNlYXJjaHZpZXdJbnB1dCgpO30sX3RvZ2dsZU1vYmlsZVF1aWNrU2VhcmNoVmlldzpmdW5jdGlvbigpe3RoaXMuJCgnLm9fY3Bfc2VhcmNodmlldycpLnRvZ2dsZUNsYXNzKCdvX3NlYXJjaHZpZXdfcXVpY2snKTt0aGlzLiQoJy5icmVhZGNydW1iJykudG9nZ2xlQ2xhc3MoJ29faGlkZGVuJyx0aGlzLiQoJy5vX2NwX3NlYXJjaHZpZXcnKS5oYXNDbGFzcygnb19zZWFyY2h2aWV3X3F1aWNrJykpO3RoaXMuJCgnLm9fdG9nZ2xlX3NlYXJjaHZpZXdfZnVsbCcpLnRvZ2dsZUNsYXNzKCdvX2hpZGRlbicpLnRvZ2dsZUNsYXNzKCdidG4tc2Vjb25kYXJ5JywhIXRoaXMuc3RhdGUucXVlcnkubGVuZ3RoKTt0aGlzLl9yZW5kZXJTZWFyY2h2aWV3SW5wdXQoKTt0aGlzLiQoJy5vX2VuYWJsZV9zZWFyY2h2aWV3JykudG9nZ2xlQ2xhc3MoImZhLXNlYXJjaCIpLnRvZ2dsZUNsYXNzKCJmYS1jbG9zZSIpO30sX29uRHJvcGRvd25Ub2dnbGU6ZnVuY3Rpb24oZXYpeyQoZXYuY3VycmVudFRhcmdldCkuZmluZCgnLmZhLWNoZXZyb24tcmlnaHQnKS50b2dnbGVDbGFzcygnZmEtY2hldnJvbi1kb3duJyk7fSxfb25FbXB0eUFsbDpmdW5jdGlvbigpe3RoaXMudHJpZ2dlcl91cCgnc2VhcmNoX2Jhcl9jbGVhcmVkJyk7fSxfb25PcGVuTW9iaWxlU2VhcmNoVmlldzpmdW5jdGlvbihldil7aWYoZXYudGFyZ2V0PT09dGhpcy5lbCl7dGhpcy5fdG9nZ2xlTW9iaWxlU2VhcmNoVmlldygpO319LH0pO30pOzsKCi8qIC93ZWIvc3RhdGljL3NyYy9qcy92aWV3cy9jb250cm9sX3BhbmVsL3NlYXJjaC9zZWFyY2hfYmFyX2F1dG9jb21wbGV0ZV9zb3VyY2VzLmpzIGRlZmluZWQgaW4gYnVuZGxlICd3ZWIuYXNzZXRzX2JhY2tlbmQnICovCm9kb28uZGVmaW5lKCd3ZWIuU2VhcmNoQmFyQXV0b0NvbXBsZXRlU291cmNlcycsZnVuY3Rpb24ocmVxdWlyZSl7InVzZSBzdHJpY3QiO3ZhciBDbGFzcz1yZXF1aXJlKCd3ZWIuQ2xhc3MnKTt2YXIgY29yZT1yZXF1aXJlKCd3ZWIuY29yZScpO3ZhciBEb21haW49cmVxdWlyZSgnd2ViLkRvbWFpbicpO3ZhciBmaWVsZF91dGlscz1yZXF1aXJlKCd3ZWIuZmllbGRfdXRpbHMnKTt2YXIgbWl4aW5zPXJlcXVpcmUoJ3dlYi5taXhpbnMnKTt2YXIgcHlVdGlscz1yZXF1aXJlKCd3ZWIucHlfdXRpbHMnKTt2YXIgU2VydmljZXNNaXhpbj1yZXF1aXJlKCd3ZWIuU2VydmljZXNNaXhpbicpO3ZhciB0aW1lPXJlcXVpcmUoJ3dlYi50aW1lJyk7dmFyIF90PWNvcmUuX3Q7dmFyIF9sdD1jb3JlLl9sdDt2YXIgRmlsdGVySW50ZXJmYWNlPUNsYXNzLmV4dGVuZChtaXhpbnMuRXZlbnREaXNwYXRjaGVyTWl4aW4se2NvbXBsZXRpb25fbGFiZWw6X2x0KCIlcyIpLGluaXQ6ZnVuY3Rpb24ocGFyZW50LGZpbHRlcil7bWl4aW5zLkV2ZW50RGlzcGF0Y2hlck1peGluLmluaXQuY2FsbCh0aGlzKTt0aGlzLnNldFBhcmVudChwYXJlbnQpO3RoaXMuZmlsdGVyPWZpbHRlcjt9LGdldEF1dG9jb21wbGV0aW9uVmFsdWVzOmZ1bmN0aW9uKHZhbHVlKXt2YXIgcmVzdWx0O3ZhbHVlPXZhbHVlLnRvTG93ZXJDYXNlKCk7aWYoZnV6enkudGVzdCh2YWx1ZSx0aGlzLmZpbHRlci5kZXNjcmlwdGlvbikpe3Jlc3VsdD1be2xhYmVsOl8uc3RyLnNwcmludGYodGhpcy5jb21wbGV0aW9uX2xhYmVsLnRvU3RyaW5nKCksXy5lc2NhcGUodGhpcy5maWx0ZXIuZGVzY3JpcHRpb24pKSxmYWNldDp7ZmlsdGVyOnRoaXMuZmlsdGVyLH0sfV07fQpyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHJlc3VsdCk7fSx9KTt2YXIgRmlsdGVyPUZpbHRlckludGVyZmFjZS5leHRlbmQoe2NvbXBsZXRpb25fbGFiZWw6X2x0KCJGaWx0ZXIgb246ICVzIiksfSk7dmFyIEdyb3VwQnk9RmlsdGVySW50ZXJmYWNlLmV4dGVuZCh7Y29tcGxldGlvbl9sYWJlbDpfbHQoIkdyb3VwIGJ5OiAlcyIpLH0pO3ZhciBGaWVsZD1GaWx0ZXJJbnRlcmZhY2UuZXh0ZW5kKFNlcnZpY2VzTWl4aW4se2RlZmF1bHRfb3BlcmF0b3I6Jz0nLGluaXQ6ZnVuY3Rpb24ocGFyZW50LGZpbHRlcixmaWVsZCxjb250ZXh0KXt0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy5maWVsZD1maWVsZDt0aGlzLmZpbHRlcj1maWx0ZXI7dGhpcy5hdHRycz1fLmV4dGVuZCh7fSxmaWVsZCxmaWx0ZXIuYXR0cnMpO3RoaXMuY29udGV4dD1jb250ZXh0O30sZ2V0QXV0b2NvbXBsZXRpb25WYWx1ZXM6ZnVuY3Rpb24odmFsdWUpe3JldHVybiBQcm9taXNlLnJlc29sdmUoW3tsYWJlbDp0aGlzLl9nZXRBdXRvY29tcGxldGlvbkxhYmVsKHZhbHVlKSxmYWNldDp0aGlzLl9nZXRGYWNldFZhbHVlKHZhbHVlKSx9XSk7fSxnZXREb21haW46ZnVuY3Rpb24odmFsdWVzKXtpZighdmFsdWVzLmxlbmd0aCl7cmV0dXJuO30KdmFyIHZhbHVlVG9Eb21haW47dmFyIHNlbGY9dGhpczt2YXIgZG9tYWluPXRoaXMuYXR0cnMuZmlsdGVyX2RvbWFpbjtpZihkb21haW4pe3ZhbHVlVG9Eb21haW49ZnVuY3Rpb24oZmFjZXRWYWx1ZSl7cmV0dXJuIERvbWFpbi5wcm90b3R5cGUuc3RyaW5nVG9BcnJheShkb21haW4se3NlbGY6c2VsZi5fdmFsdWVGcm9tKGZhY2V0VmFsdWUpLHJhd192YWx1ZTpmYWNldFZhbHVlLnZhbHVlLH0pO307fWVsc2V7dmFsdWVUb0RvbWFpbj1mdW5jdGlvbihmYWNldFZhbHVlKXtyZXR1cm4gc2VsZi5fbWFrZURvbWFpbihzZWxmLmF0dHJzLm5hbWUsc2VsZi5hdHRycy5vcGVyYXRvcnx8c2VsZi5kZWZhdWx0X29wZXJhdG9yLGZhY2V0VmFsdWUpO307fQp2YXIgZG9tYWlucz12YWx1ZXMubWFwKHZhbHVlVG9Eb21haW4pO2RvbWFpbnM9ZG9tYWlucy5tYXAoRG9tYWluLnByb3RvdHlwZS5hcnJheVRvU3RyaW5nKTtyZXR1cm4gcHlVdGlscy5hc3NlbWJsZURvbWFpbnMoZG9tYWlucywnT1InKTt9LF9nZXRBdXRvY29tcGxldGlvbkxhYmVsOmZ1bmN0aW9uKHZhbHVlKXtyZXR1cm4gXy5zdHIuc3ByaW50ZihfLnN0ci5lc2NhcGVIVE1MKF90KCJTZWFyY2ggJShmaWVsZClzIGZvcjogJSh2YWx1ZSlzIikpLHtmaWVsZDonPGVtPicrXy5lc2NhcGUodGhpcy5hdHRycy5zdHJpbmcpKyc8L2VtPicsdmFsdWU6JzxzdHJvbmc+JytfLmVzY2FwZSh2YWx1ZSkrJzwvc3Ryb25nPid9KTt9LF9nZXRGYWNldFZhbHVlOmZ1bmN0aW9uKHZhbHVlKXtyZXR1cm57ZmlsdGVyOnRoaXMuZmlsdGVyLHZhbHVlczpbe2xhYmVsOnZhbHVlLHZhbHVlOnZhbHVlfV0sfTt9LF9tYWtlRG9tYWluOmZ1bmN0aW9uKG5hbWUsb3BlcmF0b3IsZmFjZXQpe3JldHVybltbbmFtZSxvcGVyYXRvcix0aGlzLl92YWx1ZUZyb20oZmFjZXQpXV07fSxfdmFsdWVGcm9tOmZ1bmN0aW9uKGZhY2V0VmFsdWUpe3JldHVybiBmYWNldFZhbHVlLnZhbHVlO30sfSk7dmFyIENoYXJGaWVsZD1GaWVsZC5leHRlbmQoe2RlZmF1bHRfb3BlcmF0b3I6J2lsaWtlJyxnZXRBdXRvY29tcGxldGlvblZhbHVlczpmdW5jdGlvbih2YWx1ZSl7aWYoXy5pc0VtcHR5KHZhbHVlKSl7cmV0dXJuIFByb21pc2UucmVzb2x2ZShudWxsKTt9CnJldHVybiB0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fSx9KTt2YXIgTnVtYmVyRmllbGQ9RmllbGQuZXh0ZW5kKHtnZXRBdXRvY29tcGxldGlvblZhbHVlczpmdW5jdGlvbih2YWx1ZSl7dmFyIHZhbD10aGlzLnBhcnNlKHZhbHVlKTtpZihpc05hTih2YWwpKXtyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7fQpyZXR1cm4gdGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO30sfSk7dmFyIEludGVnZXJGaWVsZD1OdW1iZXJGaWVsZC5leHRlbmQoe2Vycm9yX21lc3NhZ2U6X3QoIm5vdCBhIHZhbGlkIGludGVnZXIiKSxwYXJzZTpmdW5jdGlvbih2YWx1ZSl7dHJ5e3JldHVybiBmaWVsZF91dGlscy5wYXJzZS5pbnRlZ2VyKHZhbHVlKTt9Y2F0Y2goZSl7cmV0dXJuIE5hTjt9fSx9KTt2YXIgRmxvYXRGaWVsZD1OdW1iZXJGaWVsZC5leHRlbmQoe2Vycm9yX21lc3NhZ2U6X3QoIm5vdCBhIHZhbGlkIG51bWJlciIpLHBhcnNlOmZ1bmN0aW9uKHZhbHVlKXt0cnl7cmV0dXJuIGZpZWxkX3V0aWxzLnBhcnNlLmZsb2F0KHZhbHVlKTt9Y2F0Y2goZSl7cmV0dXJuIE5hTjt9fSx9KTt2YXIgU2VsZWN0aW9uRmllbGQ9RmllbGQuZXh0ZW5kKHtnZXRBdXRvY29tcGxldGlvblZhbHVlczpmdW5jdGlvbih2YWx1ZSl7dmFyIHNlbGY9dGhpczt2YXIgcmVzdWx0cz1fKHRoaXMuYXR0cnMuc2VsZWN0aW9uKS5jaGFpbigpLmZpbHRlcihmdW5jdGlvbihzZWwpe3ZhciBzZWxWYWx1ZT1zZWxbMF0sbGFiZWw9c2VsWzFdO2lmKHNlbFZhbHVlPT09dW5kZWZpbmVkfHwhbGFiZWwpe3JldHVybiBmYWxzZTt9CnJldHVybiBsYWJlbC50b0xvd2VyQ2FzZSgpLmluZGV4T2YodmFsdWUudG9Mb3dlckNhc2UoKSkhPT0tMTt9KS5tYXAoZnVuY3Rpb24oc2VsKXtyZXR1cm57bGFiZWw6Xy5lc2NhcGUoc2VsWzFdKSxpbmRlbnQ6dHJ1ZSxmYWNldDpzZWxmLl9nZXRGYWNldFZhbHVlKHNlbCl9O30pLnZhbHVlKCk7aWYoXy5pc0VtcHR5KHJlc3VsdHMpKXtyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKG51bGwpO30KcmV0dXJuIFByb21pc2UucmVzb2x2ZShbe2xhYmVsOl8uZXNjYXBlKHRoaXMuYXR0cnMuc3RyaW5nKX1dLmNvbmNhdChyZXN1bHRzKSk7fSxfZ2V0RmFjZXRWYWx1ZTpmdW5jdGlvbih2YWx1ZSl7cmV0dXJue2ZpbHRlcjp0aGlzLmZpbHRlcix2YWx1ZXM6W3tsYWJlbDp2YWx1ZVsxXSx2YWx1ZTp2YWx1ZVswXX1dLH07fSx9KTt2YXIgQm9vbGVhbkZpZWxkPVNlbGVjdGlvbkZpZWxkLmV4dGVuZCh7aW5pdDpmdW5jdGlvbigpe3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLmF0dHJzLnNlbGVjdGlvbj1bW3RydWUsX3QoIlllcyIpXSxbZmFsc2UsX3QoIk5vIildXTt9LH0pO3ZhciBEYXRlRmllbGQ9RmllbGQuZXh0ZW5kKHtnZXRBdXRvY29tcGxldGlvblZhbHVlczpmdW5jdGlvbih2YWx1ZSl7dmFyIHQsdjt0cnl7dD0odGhpcy5hdHRycyYmdGhpcy5hdHRycy50eXBlPT09J2RhdGV0aW1lJyk/J2RhdGV0aW1lJzonZGF0ZSc7dj1maWVsZF91dGlscy5wYXJzZVt0XSh2YWx1ZSx7dHlwZTp0fSx7dGltZXpvbmU6dHJ1ZX0pO31jYXRjaChlKXtyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKG51bGwpO30KdmFyIG09bW9tZW50KHYsdD09PSdkYXRldGltZSc/J1lZWVktTU0tREQgSEg6bW06c3MnOidZWVlZLU1NLUREJyk7aWYoIW0uaXNWYWxpZCgpKXtyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKG51bGwpO30KdmFyIGRhdGVTdHJpbmc9ZmllbGRfdXRpbHMuZm9ybWF0W3RdKG0se3R5cGU6dH0pO3ZhciBsYWJlbD10aGlzLl9nZXRBdXRvY29tcGxldGlvbkxhYmVsKGRhdGVTdHJpbmcpO3ZhciBmYWNldD10aGlzLl9nZXRGYWNldFZhbHVlKGRhdGVTdHJpbmcsbS50b0RhdGUoKSk7cmV0dXJuIFByb21pc2UucmVzb2x2ZShbe2xhYmVsOmxhYmVsLGZhY2V0OmZhY2V0LH1dKTt9LF9nZXRBdXRvY29tcGxldGlvbkxhYmVsOmZ1bmN0aW9uKHZhbHVlKXtyZXR1cm4gXy5zdHIuc3ByaW50ZihfLnN0ci5lc2NhcGVIVE1MKF90KCJTZWFyY2ggJShmaWVsZClzIGF0OiAlKHZhbHVlKXMiKSkse2ZpZWxkOic8ZW0+JytfLmVzY2FwZSh0aGlzLmF0dHJzLnN0cmluZykrJzwvZW0+Jyx2YWx1ZTonPHN0cm9uZz4nK3ZhbHVlKyc8L3N0cm9uZz4nfSk7fSxfZ2V0RmFjZXRWYWx1ZTpmdW5jdGlvbih2YWx1ZSxyYXdWYWx1ZSl7dmFyIGZhY2V0PXRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtmYWNldC52YWx1ZXNbMF0udmFsdWU9cmF3VmFsdWU7cmV0dXJuIGZhY2V0O30sX3ZhbHVlRnJvbTpmdW5jdGlvbihmYWNldFZhbHVlKXtyZXR1cm4gdGltZS5kYXRlX3RvX3N0cihmYWNldFZhbHVlLnZhbHVlKTt9LH0pO3ZhciBEYXRlVGltZUZpZWxkPURhdGVGaWVsZC5leHRlbmQoe192YWx1ZUZyb206ZnVuY3Rpb24oZmFjZXRWYWx1ZSl7cmV0dXJuIHRpbWUuZGF0ZXRpbWVfdG9fc3RyKGZhY2V0VmFsdWUudmFsdWUpO30sfSk7dmFyIE1hbnlUb09uZUZpZWxkPUNoYXJGaWVsZC5leHRlbmQoe2RlZmF1bHRfb3BlcmF0b3I6e30sZ2V0QXV0b2NvbXBsZXRpb25WYWx1ZXM6ZnVuY3Rpb24odmFsdWUpe2lmKF8uaXNFbXB0eSh2YWx1ZSkpe3JldHVybiBQcm9taXNlLnJlc29sdmUobnVsbCk7fQp2YXIgbGFiZWw9dGhpcy5fZ2V0QXV0b2NvbXBsZXRpb25MYWJlbCh2YWx1ZSk7cmV0dXJuIFByb21pc2UucmVzb2x2ZShbe2xhYmVsOmxhYmVsLGZhY2V0OnRoaXMuX2dldEZhY2V0VmFsdWUodmFsdWUpLGV4cGFuZDp0aGlzLl9leHBhbmQuYmluZCh0aGlzKSx9XSk7fSxfZ2V0RXhwYW5kZWRGYWNldFZhbHVlOmZ1bmN0aW9uKHZhbHVlKXtyZXR1cm57ZmlsdGVyOnRoaXMuZmlsdGVyLHZhbHVlczpbe2xhYmVsOnZhbHVlWzFdLHZhbHVlOnZhbHVlWzBdfV0sfTt9LF9nZXRGYWNldFZhbHVlOmZ1bmN0aW9uKHZhbHVlKXtyZXR1cm57ZmlsdGVyOnRoaXMuZmlsdGVyLHZhbHVlczpbe2xhYmVsOnZhbHVlLHZhbHVlOnZhbHVlLG9wZXJhdG9yOidpbGlrZSd9XSx9O30sX2V4cGFuZDpmdW5jdGlvbih2YWx1ZSl7dmFyIHNlbGY9dGhpczt2YXIgYXJncz10aGlzLmF0dHJzLmRvbWFpbjtpZih0eXBlb2YgYXJncz09PSdzdHJpbmcnKXt0cnl7YXJncz1Eb21haW4ucHJvdG90eXBlLnN0cmluZ1RvQXJyYXkoYXJncyk7fWNhdGNoKGUpe2FyZ3M9W107fX0KcmV0dXJuIHRoaXMuX3JwYyh7bW9kZWw6dGhpcy5hdHRycy5yZWxhdGlvbixtZXRob2Q6J25hbWVfc2VhcmNoJyxrd2FyZ3M6e25hbWU6dmFsdWUsYXJnczphcmdzLGxpbWl0OjgsY29udGV4dDp0aGlzLmNvbnRleHQsfSx9KS50aGVuKGZ1bmN0aW9uKHJlc3VsdHMpe2lmKF8uaXNFbXB0eShyZXN1bHRzKSl7cmV0dXJuIG51bGw7fQpyZXR1cm4gXyhyZXN1bHRzKS5tYXAoZnVuY3Rpb24ocmVzdWx0KXtyZXR1cm57bGFiZWw6Xy5lc2NhcGUocmVzdWx0WzFdKSxmYWNldDpzZWxmLl9nZXRFeHBhbmRlZEZhY2V0VmFsdWUocmVzdWx0KX07fSk7fSk7fSxfbWFrZURvbWFpbjpmdW5jdGlvbihuYW1lLG9wZXJhdG9yLGZhY2V0VmFsdWUpe29wZXJhdG9yPWZhY2V0VmFsdWUub3BlcmF0b3J8fG9wZXJhdG9yO3N3aXRjaChvcGVyYXRvcil7Y2FzZSB0aGlzLmRlZmF1bHRfb3BlcmF0b3I6cmV0dXJuW1tuYW1lLCc9JyxmYWNldFZhbHVlLnZhbHVlXV07Y2FzZSdpbGlrZSc6cmV0dXJuW1tuYW1lLCdpbGlrZScsZmFjZXRWYWx1ZS52YWx1ZV1dO2Nhc2UnY2hpbGRfb2YnOnJldHVybltbbmFtZSwnY2hpbGRfb2YnLGZhY2V0VmFsdWUudmFsdWVdXTt9CnJldHVybiB0aGlzLl9zdXBlcihuYW1lLG9wZXJhdG9yLGZhY2V0VmFsdWUpO30sX3ZhbHVlRnJvbTpmdW5jdGlvbihmYWNldFZhbHVlKXtyZXR1cm4gZmFjZXRWYWx1ZS5sYWJlbDt9LH0pO3JldHVybntCb29sZWFuRmllbGQ6Qm9vbGVhbkZpZWxkLENoYXJGaWVsZDpDaGFyRmllbGQsRGF0ZUZpZWxkOkRhdGVGaWVsZCxEYXRlVGltZUZpZWxkOkRhdGVUaW1lRmllbGQsRmllbGQ6RmllbGQsRmlsdGVyOkZpbHRlcixGbG9hdEZpZWxkOkZsb2F0RmllbGQsR3JvdXBCeTpHcm91cEJ5LEludGVnZXJGaWVsZDpJbnRlZ2VyRmllbGQsTWFueVRvT25lRmllbGQ6TWFueVRvT25lRmllbGQsTnVtYmVyRmllbGQ6TnVtYmVyRmllbGQsU2VsZWN0aW9uRmllbGQ6U2VsZWN0aW9uRmllbGQsfTt9KTs7CgovKiAvd2ViL3N0YXRpYy9zcmMvanMvdmlld3MvY29udHJvbF9wYW5lbC9zZWFyY2gvc2VhcmNoX2Jhcl9hdXRvY29tcGxldGVfc291cmNlc19yZWdpc3RyeS5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwpvZG9vLmRlZmluZSgnd2ViLnNlYXJjaF9iYXJfYXV0b2NvbXBsZXRlX3NvdXJjZXNfcmVnaXN0cnknLGZ1bmN0aW9uKHJlcXVpcmUpeyJ1c2Ugc3RyaWN0Ijt2YXIgUmVnaXN0cnk9cmVxdWlyZSgnd2ViLlJlZ2lzdHJ5Jyk7cmV0dXJuIG5ldyBSZWdpc3RyeSgpO30pO29kb28uZGVmaW5lKCd3ZWIuX3NlYXJjaF9iYXJfYXV0b2NvbXBsZXRlX3NvdXJjZXNfcmVnaXN0cnknLGZ1bmN0aW9uKHJlcXVpcmUpeyJ1c2Ugc3RyaWN0Ijt2YXIgcmVnaXN0cnk9cmVxdWlyZSgnd2ViLnNlYXJjaF9iYXJfYXV0b2NvbXBsZXRlX3NvdXJjZXNfcmVnaXN0cnknKTt2YXIgU2VhcmNoQmFyQXV0b0NvbXBsZXRlU291cmNlcz1yZXF1aXJlKCd3ZWIuU2VhcmNoQmFyQXV0b0NvbXBsZXRlU291cmNlcycpO3JlZ2lzdHJ5LmFkZCgnY2hhcicsU2VhcmNoQmFyQXV0b0NvbXBsZXRlU291cmNlcy5DaGFyRmllbGQpLmFkZCgndGV4dCcsU2VhcmNoQmFyQXV0b0NvbXBsZXRlU291cmNlcy5DaGFyRmllbGQpLmFkZCgnaHRtbCcsU2VhcmNoQmFyQXV0b0NvbXBsZXRlU291cmNlcy5DaGFyRmllbGQpLmFkZCgnYm9vbGVhbicsU2VhcmNoQmFyQXV0b0NvbXBsZXRlU291cmNlcy5Cb29sZWFuRmllbGQpLmFkZCgnaW50ZWdlcicsU2VhcmNoQmFyQXV0b0NvbXBsZXRlU291cmNlcy5JbnRlZ2VyRmllbGQpLmFkZCgnaWQnLFNlYXJjaEJhckF1dG9Db21wbGV0ZVNvdXJjZXMuSW50ZWdlckZpZWxkKS5hZGQoJ2Zsb2F0JyxTZWFyY2hCYXJBdXRvQ29tcGxldGVTb3VyY2VzLkZsb2F0RmllbGQpLmFkZCgnbW9uZXRhcnknLFNlYXJjaEJhckF1dG9Db21wbGV0ZVNvdXJjZXMuRmxvYXRGaWVsZCkuYWRkKCdzZWxlY3Rpb24nLFNlYXJjaEJhckF1dG9Db21wbGV0ZVNvdXJjZXMuU2VsZWN0aW9uRmllbGQpLmFkZCgnZGF0ZXRpbWUnLFNlYXJjaEJhckF1dG9Db21wbGV0ZVNvdXJjZXMuRGF0ZVRpbWVGaWVsZCkuYWRkKCdkYXRlJyxTZWFyY2hCYXJBdXRvQ29tcGxldGVTb3VyY2VzLkRhdGVGaWVsZCkuYWRkKCdtYW55Mm9uZScsU2VhcmNoQmFyQXV0b0NvbXBsZXRlU291cmNlcy5NYW55VG9PbmVGaWVsZCkuYWRkKCdtYW55Mm1hbnknLFNlYXJjaEJhckF1dG9Db21wbGV0ZVNvdXJjZXMuQ2hhckZpZWxkKS5hZGQoJ29uZTJtYW55JyxTZWFyY2hCYXJBdXRvQ29tcGxldGVTb3VyY2VzLkNoYXJGaWVsZCk7cmVnaXN0cnkuYWRkKCdmaWx0ZXInLFNlYXJjaEJhckF1dG9Db21wbGV0ZVNvdXJjZXMuRmlsdGVyKTtyZWdpc3RyeS5hZGQoJ2dyb3VwYnknLFNlYXJjaEJhckF1dG9Db21wbGV0ZVNvdXJjZXMuR3JvdXBCeSk7fSk7OwoKLyogL3dlYi9zdGF0aWMvc3JjL2pzL3ZpZXdzL2NvbnRyb2xfcGFuZWwvc2VhcmNoL3NlYXJjaF9mYWNldC5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwpvZG9vLmRlZmluZSgnd2ViLlNlYXJjaEZhY2V0JyxmdW5jdGlvbihyZXF1aXJlKXsidXNlIHN0cmljdCI7dmFyIGNvcmU9cmVxdWlyZSgnd2ViLmNvcmUnKTt2YXIgV2lkZ2V0PXJlcXVpcmUoJ3dlYi5XaWRnZXQnKTt2YXIgX3Q9Y29yZS5fdDt2YXIgU2VhcmNoRmFjZXQ9V2lkZ2V0LmV4dGVuZCh7dGVtcGxhdGU6J1NlYXJjaFZpZXcuU2VhcmNoRmFjZXQnLGV2ZW50czpfLmV4dGVuZCh7fSxXaWRnZXQucHJvdG90eXBlLmV2ZW50cyx7J2NsaWNrIC5vX2ZhY2V0X3JlbW92ZSc6J19vbkZhY2V0UmVtb3ZlJywnY29tcG9zaXRpb25lbmQnOidfb25Db21wb3NpdGlvbmVuZCcsJ2NvbXBvc2l0aW9uc3RhcnQnOidfb25Db21wb3NpdGlvbnN0YXJ0Jywna2V5ZG93bic6J19vbktleWRvd24nLH0pLGluaXQ6ZnVuY3Rpb24ocGFyZW50LGZhY2V0KXt0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dmFyIHNlbGY9dGhpczt0aGlzLmZhY2V0PWZhY2V0O3RoaXMuZmFjZXRWYWx1ZXM9Xy5tYXAodGhpcy5mYWNldC5maWx0ZXJzLGZ1bmN0aW9uKGZpbHRlcil7cmV0dXJuIHNlbGYuX2dldEZpbHRlckRlc2NyaXB0aW9uKGZpbHRlcik7fSk7dGhpcy5zZXBhcmF0b3I9dGhpcy5fZ2V0U2VwYXJhdG9yKCk7dGhpcy5pY29uPXRoaXMuX2dldEljb24oKTt0aGlzLl9pc0NvbXBvc2luZz1mYWxzZTt9LF9nZXRGaWx0ZXJEZXNjcmlwdGlvbjpmdW5jdGlvbihmaWx0ZXIpe2lmKGZpbHRlci50eXBlPT09J2ZpZWxkJyl7dmFyIHZhbHVlcz1fLnBsdWNrKGZpbHRlci5hdXRvQ29tcGxldGVWYWx1ZXMsJ2xhYmVsJyk7cmV0dXJuIHZhbHVlcy5qb2luKF90KCcgb3IgJykpO30KdmFyIGRlc2NyaXB0aW9uPWZpbHRlci5kZXNjcmlwdGlvbjtpZihmaWx0ZXIuaGFzT3B0aW9ucyl7aWYoZmlsdGVyLnR5cGU9PT0nZmlsdGVyJyl7Y29uc3Qgb3B0aW9uRGVzY3JpcHRpb25zPVtdO2NvbnN0IHNvcnRGdW5jdGlvbj0obzEsbzIpPT5maWx0ZXIub3B0aW9ucy5maW5kSW5kZXgobz0+by5vcHRpb25JZD09PW8xKS1maWx0ZXIub3B0aW9ucy5maW5kSW5kZXgobz0+by5vcHRpb25JZD09PW8yKTtjb25zdCBwPV8ucGFydGl0aW9uKFsuLi5maWx0ZXIuY3VycmVudE9wdGlvbklkc10sb3B0aW9uSWQ9PmZpbHRlci5vcHRpb25zLmZpbmQobz0+by5vcHRpb25JZD09PW9wdGlvbklkKS5ncm91cElkPT09MSk7Y29uc3QgeWVhcklkcz1wWzFdLnNvcnQoc29ydEZ1bmN0aW9uKTtjb25zdCBvdGhlck9wdGlvbklkcz1wWzBdLnNvcnQoc29ydEZ1bmN0aW9uKTtpZihvdGhlck9wdGlvbklkcy5sZW5ndGg9PT0wKXt5ZWFySWRzLmZvckVhY2goeWVhcklkPT57Y29uc3QgZD1maWx0ZXIuYmFzaWNEb21haW5zW3llYXJJZF07b3B0aW9uRGVzY3JpcHRpb25zLnB1c2goZC5kZXNjcmlwdGlvbik7fSk7fWVsc2V7b3RoZXJPcHRpb25JZHMuZm9yRWFjaChvcHRpb25JZD0+e3llYXJJZHMuZm9yRWFjaCh5ZWFySWQ9Pntjb25zdCBkPWZpbHRlci5iYXNpY0RvbWFpbnNbeWVhcklkKydfXycrb3B0aW9uSWRdO29wdGlvbkRlc2NyaXB0aW9ucy5wdXNoKGQuZGVzY3JpcHRpb24pO30pO30pO30KZGVzY3JpcHRpb24rPSc6ICcrb3B0aW9uRGVzY3JpcHRpb25zLmpvaW4oJy8nKTt9ZWxzZXtkZXNjcmlwdGlvbj1kZXNjcmlwdGlvbis9JzogJysKZmlsdGVyLm9wdGlvbnMuZmluZChvPT5vLm9wdGlvbklkPT09ZmlsdGVyLm9wdGlvbklkKS5kZXNjcmlwdGlvbjt9fQppZihmaWx0ZXIudHlwZT09PSd0aW1lUmFuZ2UnKXt2YXIgdGltZVJhbmdlVmFsdWU9Xy5maW5kV2hlcmUoZmlsdGVyLnRpbWVSYW5nZU9wdGlvbnMse29wdGlvbklkOmZpbHRlci50aW1lUmFuZ2VJZCx9KTtkZXNjcmlwdGlvbis9JzogJyt0aW1lUmFuZ2VWYWx1ZS5kZXNjcmlwdGlvbjtpZihmaWx0ZXIuY29tcGFyaXNvblRpbWVSYW5nZUlkKXt2YXIgY29tcGFyaXNvblRpbWVSYW5nZVZhbHVlPV8uZmluZFdoZXJlKGZpbHRlci5jb21wYXJpc29uVGltZVJhbmdlT3B0aW9ucyx7b3B0aW9uSWQ6ZmlsdGVyLmNvbXBhcmlzb25UaW1lUmFuZ2VJZCx9KTtkZXNjcmlwdGlvbis9JyAvICcrY29tcGFyaXNvblRpbWVSYW5nZVZhbHVlLmRlc2NyaXB0aW9uO319CnJldHVybiBkZXNjcmlwdGlvbjt9LF9nZXRJY29uOmZ1bmN0aW9uKCl7dmFyIGljb247aWYodGhpcy5mYWNldC50eXBlPT09J2ZpbHRlcicpe2ljb249J2ZhLWZpbHRlcic7fWVsc2UgaWYodGhpcy5mYWNldC50eXBlPT09J2dyb3VwQnknKXtpY29uPSdmYS1iYXJzJzt9ZWxzZSBpZih0aGlzLmZhY2V0LnR5cGU9PT0nZmF2b3JpdGUnKXtpY29uPSdmYS1zdGFyJzt9ZWxzZSBpZih0aGlzLmZhY2V0LnR5cGU9PT0ndGltZVJhbmdlJyl7aWNvbj0nZmEtY2FsZW5kYXInO30KcmV0dXJuIGljb247fSxfZ2V0U2VwYXJhdG9yOmZ1bmN0aW9uKCl7dmFyIHNlcGFyYXRvcjtpZih0aGlzLmZhY2V0LnR5cGU9PT0nZmlsdGVyJyl7c2VwYXJhdG9yPV90KCdvcicpO31lbHNlIGlmKHRoaXMuZmFjZXQudHlwZT09PSdmaWVsZCcpe3NlcGFyYXRvcj1fdCgnb3InKTt9ZWxzZSBpZih0aGlzLmZhY2V0LnR5cGU9PT0nZ3JvdXBCeScpe3NlcGFyYXRvcj0nPic7fQpyZXR1cm4gc2VwYXJhdG9yO30sX29uQ29tcG9zaXRpb25lbmQ6ZnVuY3Rpb24oZXYpe3RoaXMuX2lzQ29tcG9zaW5nPWZhbHNlO30sX29uQ29tcG9zaXRpb25zdGFydDpmdW5jdGlvbihldil7dGhpcy5faXNDb21wb3Npbmc9dHJ1ZTt9LF9vbkZhY2V0UmVtb3ZlOmZ1bmN0aW9uKCl7dGhpcy50cmlnZ2VyX3VwKCdmYWNldF9yZW1vdmVkJyx7Z3JvdXA6dGhpcy5mYWNldH0pO30sX29uS2V5ZG93bjpmdW5jdGlvbihldil7aWYodGhpcy5faXNDb21wb3Npbmcpe3JldHVybjt9CnN3aXRjaChldi53aGljaCl7Y2FzZSAkLnVpLmtleUNvZGUuQkFDS1NQQUNFOnRoaXMudHJpZ2dlcl91cCgnZmFjZXRfcmVtb3ZlZCcse2dyb3VwOnRoaXMuZmFjZXR9KTticmVhazt9fSx9KTtyZXR1cm4gU2VhcmNoRmFjZXQ7fSk7OwoKLyogL3dlYi9zdGF0aWMvc3JjL2pzL3ZpZXdzL2NvbnRyb2xfcGFuZWwvc2VhcmNoL3NlYXJjaF9iYXIuanMgZGVmaW5lZCBpbiBidW5kbGUgJ3dlYi5hc3NldHNfYmFja2VuZCcgKi8Kb2Rvby5kZWZpbmUoJ3dlYi5TZWFyY2hCYXInLGZ1bmN0aW9uKHJlcXVpcmUpeyJ1c2Ugc3RyaWN0Ijt2YXIgQXV0b0NvbXBsZXRlPXJlcXVpcmUoJ3dlYi5BdXRvQ29tcGxldGUnKTt2YXIgc2VhcmNoQmFyQXV0b2NvbXBsZXRlUmVnaXN0cnk9cmVxdWlyZSgnd2ViLnNlYXJjaF9iYXJfYXV0b2NvbXBsZXRlX3NvdXJjZXNfcmVnaXN0cnknKTt2YXIgU2VhcmNoRmFjZXQ9cmVxdWlyZSgnd2ViLlNlYXJjaEZhY2V0Jyk7dmFyIFdpZGdldD1yZXF1aXJlKCd3ZWIuV2lkZ2V0Jyk7dmFyIFNlYXJjaEJhcj1XaWRnZXQuZXh0ZW5kKHt0ZW1wbGF0ZTonU2VhcmNoVmlldy5TZWFyY2hCYXInLGV2ZW50czpfLmV4dGVuZCh7fSxXaWRnZXQucHJvdG90eXBlLmV2ZW50cyx7J2NvbXBvc2l0aW9uZW5kIC5vX3NlYXJjaHZpZXdfaW5wdXQnOidfb25Db21wb3NpdGlvbmVuZElucHV0JywnY29tcG9zaXRpb25zdGFydCAub19zZWFyY2h2aWV3X2lucHV0JzonX29uQ29tcG9zaXRpb25zdGFydElucHV0Jywna2V5ZG93bic6J19vbktleWRvd24nLH0pLGluaXQ6ZnVuY3Rpb24ocGFyZW50LHBhcmFtcyl7dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3RoaXMuY29udGV4dD1wYXJhbXMuY29udGV4dDt0aGlzLmZhY2V0cz1wYXJhbXMuZmFjZXRzO3RoaXMuZmllbGRzPXBhcmFtcy5maWVsZHM7dGhpcy5maWx0ZXJGaWVsZHM9cGFyYW1zLmZpbHRlckZpZWxkczt0aGlzLmF1dG9Db21wbGV0ZVNvdXJjZXM9W107dGhpcy5zZWFyY2hGYWNldHM9W107dGhpcy5faXNJbnB1dENvbXBvc2luZz1mYWxzZTt9LHN0YXJ0OmZ1bmN0aW9uKCl7dGhpcy4kaW5wdXQ9dGhpcy4kKCdpbnB1dCcpO3ZhciBzZWxmPXRoaXM7dmFyIGRlZnM9W3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKV07Xy5lYWNoKHRoaXMuZmFjZXRzLGZ1bmN0aW9uKGZhY2V0KXtkZWZzLnB1c2goc2VsZi5fcmVuZGVyRmFjZXQoZmFjZXQpKTt9KTtkZWZzLnB1c2godGhpcy5fc2V0dXBBdXRvQ29tcGxldGlvbigpKTtyZXR1cm4gUHJvbWlzZS5hbGwoZGVmcyk7fSxmb2N1czpmdW5jdGlvbigpe3RoaXMuJGlucHV0LmZvY3VzKCk7fSxfZm9jdXNGb2xsb3dpbmc6ZnVuY3Rpb24oKXt2YXIgZm9jdXNlZEluZGV4PXRoaXMuX2dldEZvY3VzZWRGYWNldEluZGV4KCk7dmFyICR0b0ZvY3VzO2lmKGZvY3VzZWRJbmRleD09PXRoaXMuc2VhcmNoRmFjZXRzLmxlbmd0aC0xKXskdG9Gb2N1cz10aGlzLiRpbnB1dDt9ZWxzZXskdG9Gb2N1cz10aGlzLnNlYXJjaEZhY2V0cy5sZW5ndGgmJnRoaXMuc2VhcmNoRmFjZXRzW2ZvY3VzZWRJbmRleCsxXS4kZWw7fQppZigkdG9Gb2N1cy5sZW5ndGgpeyR0b0ZvY3VzLmZvY3VzKCk7fX0sX2ZvY3VzUHJlY2VkaW5nOmZ1bmN0aW9uKCl7dmFyIGZvY3VzZWRJbmRleD10aGlzLl9nZXRGb2N1c2VkRmFjZXRJbmRleCgpO3ZhciAkdG9Gb2N1cztpZihmb2N1c2VkSW5kZXg9PT0tMSl7JHRvRm9jdXM9dGhpcy5zZWFyY2hGYWNldHMubGVuZ3RoJiZfLmxhc3QodGhpcy5zZWFyY2hGYWNldHMpLiRlbDt9ZWxzZSBpZihmb2N1c2VkSW5kZXg9PT0wKXskdG9Gb2N1cz10aGlzLiRpbnB1dDt9ZWxzZXskdG9Gb2N1cz10aGlzLnNlYXJjaEZhY2V0cy5sZW5ndGgmJnRoaXMuc2VhcmNoRmFjZXRzW2ZvY3VzZWRJbmRleC0xXS4kZWw7fQppZigkdG9Gb2N1cy5sZW5ndGgpeyR0b0ZvY3VzLmZvY3VzKCk7fX0sX2dldEZvY3VzZWRGYWNldEluZGV4OmZ1bmN0aW9uKCl7cmV0dXJuIF8uZmluZEluZGV4KHRoaXMuc2VhcmNoRmFjZXRzLGZ1bmN0aW9uKHNlYXJjaEZhY2V0KXtyZXR1cm4gc2VhcmNoRmFjZXQuJGVsWzBdPT09ZG9jdW1lbnQuYWN0aXZlRWxlbWVudDt9KTt9LF9nZXRBdXRvQ29tcGxldGVTb3VyY2VzOmZ1bmN0aW9uKHJlcSxjYWxsYmFjayl7dmFyIGRlZnM9dGhpcy5hdXRvQ29tcGxldGVTb3VyY2VzLm1hcChmdW5jdGlvbihzb3VyY2Upe3JldHVybiBzb3VyY2UuZ2V0QXV0b2NvbXBsZXRpb25WYWx1ZXMocmVxLnRlcm0pO30pO1Byb21pc2UuYWxsKGRlZnMpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KXt2YXIgcmVzdWx0Q2xlYW5lZD1fKHJlc3VsdCkuY2hhaW4oKS5jb21wYWN0KCkuZmxhdHRlbih0cnVlKS52YWx1ZSgpO2NhbGxiYWNrKHJlc3VsdENsZWFuZWQpO30pO30sX3JlbmRlckZhY2V0OmZ1bmN0aW9uKGZhY2V0KXt2YXIgc2VhcmNoRmFjZXQ9bmV3IFNlYXJjaEZhY2V0KHRoaXMsZmFjZXQpO3RoaXMuc2VhcmNoRmFjZXRzLnB1c2goc2VhcmNoRmFjZXQpO3JldHVybiBzZWFyY2hGYWNldC5pbnNlcnRCZWZvcmUodGhpcy4kKCdpbnB1dCcpKTt9LF9zZXR1cEF1dG9Db21wbGV0aW9uOmZ1bmN0aW9uKCl7dmFyIHNlbGY9dGhpczt0aGlzLl9zZXR1cEF1dG9Db21wbGV0aW9uV2lkZ2V0cygpO3RoaXMuYXV0b0NvbXBsZXRlPW5ldyBBdXRvQ29tcGxldGUodGhpcyx7JGlucHV0OnRoaXMuJCgnaW5wdXQnKSxzb3VyY2U6dGhpcy5fZ2V0QXV0b0NvbXBsZXRlU291cmNlcy5iaW5kKHRoaXMpLHNlbGVjdDp0aGlzLl9vbkF1dG9Db21wbGV0ZVNlbGVjdGVkLmJpbmQodGhpcyksZ2V0X3NlYXJjaF9zdHJpbmc6ZnVuY3Rpb24oKXtyZXR1cm4gc2VsZi4kaW5wdXQudmFsKCkudHJpbSgpO30sfSk7cmV0dXJuIHRoaXMuYXV0b0NvbXBsZXRlLmFwcGVuZFRvKHRoaXMuJGVsKTt9LF9zZXR1cEF1dG9Db21wbGV0aW9uV2lkZ2V0czpmdW5jdGlvbigpe3ZhciBzZWxmPXRoaXM7dmFyIHJlZ2lzdHJ5PXNlYXJjaEJhckF1dG9jb21wbGV0ZVJlZ2lzdHJ5O18uZWFjaCh0aGlzLmZpbHRlckZpZWxkcyxmdW5jdGlvbihmaWx0ZXIpe3ZhciBmaWVsZD1zZWxmLmZpZWxkc1tmaWx0ZXIuYXR0cnMubmFtZV07dmFyIE9iaj1yZWdpc3RyeS5nZXRBbnkoW2ZpbHRlci5hdHRycy53aWRnZXQsZmllbGQudHlwZV0pO2lmKE9iail7c2VsZi5hdXRvQ29tcGxldGVTb3VyY2VzLnB1c2gobmV3KE9iaikoc2VsZixmaWx0ZXIsZmllbGQsc2VsZi5jb250ZXh0KSk7fX0pO30sX29uQXV0b0NvbXBsZXRlU2VsZWN0ZWQ6ZnVuY3Rpb24oZSx1aSl7ZS5wcmV2ZW50RGVmYXVsdCgpO3ZhciBmYWNldD11aS5pdGVtLmZhY2V0O2lmKCFmYWNldCl7dGhpcy50cmlnZ2VyX3VwKCdyZXNldCcpO3JldHVybjt9CnZhciBmaWx0ZXI9ZmFjZXQuZmlsdGVyO2lmKGZpbHRlci50eXBlPT09J2ZpZWxkJyl7dmFyIHZhbHVlcz1maWx0ZXIuYXV0b0NvbXBsZXRlVmFsdWVzO3ZhbHVlcy5wdXNoKGZhY2V0LnZhbHVlc1swXSk7dGhpcy50cmlnZ2VyX3VwKCdhdXRvY29tcGxldGlvbl9maWx0ZXInLHtmaWx0ZXJJZDpmaWx0ZXIuaWQsYXV0b0NvbXBsZXRlVmFsdWVzOnZhbHVlcyx9KTt9ZWxzZXt0aGlzLnRyaWdnZXJfdXAoJ2F1dG9jb21wbGV0aW9uX2ZpbHRlcicse2ZpbHRlcklkOmZpbHRlci5pZCx9KTt9fSxfb25Db21wb3NpdGlvbmVuZElucHV0OmZ1bmN0aW9uKCl7dGhpcy5faXNJbnB1dENvbXBvc2luZz1mYWxzZTt9LF9vbkNvbXBvc2l0aW9uc3RhcnRJbnB1dDpmdW5jdGlvbigpe3RoaXMuX2lzSW5wdXRDb21wb3Npbmc9dHJ1ZTt9LF9vbktleWRvd246ZnVuY3Rpb24oZSl7aWYodGhpcy5faXNJbnB1dENvbXBvc2luZyl7cmV0dXJuO30Kc3dpdGNoKGUud2hpY2gpe2Nhc2UgJC51aS5rZXlDb2RlLkxFRlQ6dGhpcy5fZm9jdXNQcmVjZWRpbmcoKTtlLnByZXZlbnREZWZhdWx0KCk7YnJlYWs7Y2FzZSAkLnVpLmtleUNvZGUuUklHSFQ6dGhpcy5fZm9jdXNGb2xsb3dpbmcoKTtlLnByZXZlbnREZWZhdWx0KCk7YnJlYWs7Y2FzZSAkLnVpLmtleUNvZGUuRE9XTjpjb25zdCAkZHJvcGRvd249dGhpcy4kKCcub19zZWFyY2h2aWV3X2F1dG9jb21wbGV0ZTp2aXNpYmxlJyk7aWYoISRkcm9wZG93bi5sZW5ndGgpe3RoaXMudHJpZ2dlcl91cCgnbmF2aWdhdGlvbl9tb3ZlJyx7ZGlyZWN0aW9uOidkb3duJ30pO2UucHJldmVudERlZmF1bHQoKTt9CmJyZWFrO2Nhc2UgJC51aS5rZXlDb2RlLkJBQ0tTUEFDRTppZih0aGlzLiRpbnB1dC52YWwoKT09PScnKXt0aGlzLnRyaWdnZXJfdXAoJ2ZhY2V0X3JlbW92ZWQnKTt9CmJyZWFrO2Nhc2UgJC51aS5rZXlDb2RlLkVOVEVSOmlmKHRoaXMuJGlucHV0LnZhbCgpPT09Jycpe3RoaXMudHJpZ2dlcl91cCgncmVsb2FkJyk7fQpicmVhazt9fSx9KTtyZXR1cm4gU2VhcmNoQmFyO30pOzsKCi8qIC93ZWIvc3RhdGljL3NyYy9qcy92aWV3cy9jb250cm9sX3BhbmVsL3NlYXJjaC9maWx0ZXJfbWVudS5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwpvZG9vLmRlZmluZSgnd2ViLkZpbHRlck1lbnUnLGZ1bmN0aW9uKHJlcXVpcmUpeyJ1c2Ugc3RyaWN0Ijt2YXIgY29uZmlnPXJlcXVpcmUoJ3dlYi5jb25maWcnKTt2YXIgY29yZT1yZXF1aXJlKCd3ZWIuY29yZScpO3ZhciBEb21haW49cmVxdWlyZSgnd2ViLkRvbWFpbicpO3ZhciBEcm9wZG93bk1lbnU9cmVxdWlyZSgnd2ViLkRyb3Bkb3duTWVudScpO3ZhciBzZWFyY2hfZmlsdGVycz1yZXF1aXJlKCd3ZWIuc2VhcmNoX2ZpbHRlcnMnKTt2YXIgX3Q9Y29yZS5fdDt2YXIgUVdlYj1jb3JlLnF3ZWI7dmFyIEZpbHRlck1lbnU9RHJvcGRvd25NZW51LmV4dGVuZCh7Y3VzdG9tX2V2ZW50czp7Y29uZmlybV9wcm9wb3NpdGlvbjonX29uQ29uZmlybVByb3Bvc2l0aW9uJyxyZW1vdmVfcHJvcG9zaXRpb246J19vblJlbW92ZVByb3Bvc2l0aW9uJyx9LGV2ZW50czpfLmV4dGVuZCh7fSxEcm9wZG93bk1lbnUucHJvdG90eXBlLmV2ZW50cyx7J2NsaWNrIC5vX2FkZF9jdXN0b21fZmlsdGVyJzonX29uQWRkQ3VzdG9tRmlsdGVyQ2xpY2snLCdjbGljayAub19hZGRfY29uZGl0aW9uJzonX29uQWRkQ29uZGl0aW9uJywnY2xpY2sgLm9fYXBwbHlfZmlsdGVyJzonX29uQXBwbHlDbGljaycsfSksaW5pdDpmdW5jdGlvbihwYXJlbnQsZmlsdGVycyxmaWVsZHMpe3RoaXMuX3N1cGVyKHBhcmVudCxmaWx0ZXJzKTt0aGlzLmlzTW9iaWxlPWNvbmZpZy5kZXZpY2UuaXNNb2JpbGU7dGhpcy5nZW5lcmF0b3JNZW51SXNPcGVuPWZhbHNlO3RoaXMucHJvcG9zaXRpb25zPVtdO3RoaXMuZmllbGRzPV8ucGljayhmaWVsZHMsZnVuY3Rpb24oZmllbGQsbmFtZSl7cmV0dXJuIGZpZWxkLnNlbGVjdGFibGUhPT1mYWxzZSYmbmFtZSE9PSdpZCc7fSk7dGhpcy5maWVsZHMuaWQ9e3N0cmluZzonSUQnLHR5cGU6J2lkJyxzZWFyY2hhYmxlOnRydWV9O3RoaXMuZHJvcGRvd25DYXRlZ29yeT0nZmlsdGVyJzt0aGlzLmRyb3Bkb3duVGl0bGU9X3QoJ0ZpbHRlcnMnKTt0aGlzLmRyb3Bkb3duSWNvbj0nZmEgZmEtZmlsdGVyJzt0aGlzLmRyb3Bkb3duU3ltYm9sPXRoaXMuaXNNb2JpbGU/J2ZhIGZhLWNoZXZyb24tcmlnaHQgZmxvYXQtcmlnaHQgbXQ0JzpmYWxzZTt0aGlzLmRyb3Bkb3duU3R5bGUubWFpbkJ1dHRvbi5jbGFzcz0nb19maWx0ZXJzX21lbnVfYnV0dG9uICcrCnRoaXMuZHJvcGRvd25TdHlsZS5tYWluQnV0dG9uLmNsYXNzO30sc3RhcnQ6ZnVuY3Rpb24oKXt0aGlzLiRtZW51PXRoaXMuJCgnLm9fZHJvcGRvd25fbWVudScpO3RoaXMuJG1lbnUuYWRkQ2xhc3MoJ29fZmlsdGVyc19tZW51Jyk7dGhpcy5fcmVuZGVyR2VuZXJhdG9yTWVudSgpO3JldHVybiB0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fSxfYXBwZW5kUHJvcG9zaXRpb246ZnVuY3Rpb24oKXt2YXIgcHJvcD1uZXcgc2VhcmNoX2ZpbHRlcnMuRXh0ZW5kZWRTZWFyY2hQcm9wb3NpdGlvbih0aGlzLHRoaXMuZmllbGRzKTt0aGlzLnByb3Bvc2l0aW9ucy5wdXNoKHByb3ApO3RoaXMuJCgnLm9fYXBwbHlfZmlsdGVyJykucHJvcCgnZGlzYWJsZWQnLGZhbHNlKTtyZXR1cm4gcHJvcC5pbnNlcnRCZWZvcmUodGhpcy4kYWRkRmlsdGVyTWVudSk7fSxfY29tbWl0U2VhcmNoOmZ1bmN0aW9uKCl7dmFyIGZpbHRlcnM9Xy5pbnZva2UodGhpcy5wcm9wb3NpdGlvbnMsJ2dldF9maWx0ZXInKS5tYXAoZnVuY3Rpb24ocHJlRmlsdGVyKXtyZXR1cm57dHlwZTonZmlsdGVyJyxkZXNjcmlwdGlvbjpwcmVGaWx0ZXIuYXR0cnMuc3RyaW5nLGRvbWFpbjpEb21haW4ucHJvdG90eXBlLmFycmF5VG9TdHJpbmcocHJlRmlsdGVyLmF0dHJzLmRvbWFpbiksfTt9KTt0aGlzLnRyaWdnZXJfdXAoJ25ld19maWx0ZXJzJyx7ZmlsdGVyczpmaWx0ZXJzfSk7Xy5pbnZva2UodGhpcy5wcm9wb3NpdGlvbnMsJ2Rlc3Ryb3knKTt0aGlzLnByb3Bvc2l0aW9ucz1bXTt0aGlzLl90b2dnbGVDdXN0b21GaWx0ZXJNZW51KCk7fSxfcmVuZGVyR2VuZXJhdG9yTWVudTpmdW5jdGlvbigpe3RoaXMuJGVsLmZpbmQoJy5vX2dlbmVyYXRvcl9tZW51JykucmVtb3ZlKCk7aWYoIXRoaXMuZ2VuZXJhdG9yTWVudUlzT3Blbil7Xy5pbnZva2UodGhpcy5wcm9wb3NpdGlvbnMsJ2Rlc3Ryb3knKTt0aGlzLnByb3Bvc2l0aW9ucz1bXTt9CnZhciAkZ2VuZXJhdG9yTWVudT1RV2ViLnJlbmRlcignRmlsdGVyTWVudUdlbmVyYXRvcicse3dpZGdldDp0aGlzfSk7dGhpcy4kbWVudS5hcHBlbmQoJGdlbmVyYXRvck1lbnUpO3RoaXMuJGFkZEZpbHRlck1lbnU9dGhpcy4kbWVudS5maW5kKCcub19hZGRfZmlsdGVyX21lbnUnKTtpZih0aGlzLmdlbmVyYXRvck1lbnVJc09wZW4mJiF0aGlzLnByb3Bvc2l0aW9ucy5sZW5ndGgpe3RoaXMuX2FwcGVuZFByb3Bvc2l0aW9uKCk7fX0sX3RvZ2dsZUN1c3RvbUZpbHRlck1lbnU6ZnVuY3Rpb24oKXt0aGlzLmdlbmVyYXRvck1lbnVJc09wZW49IXRoaXMuZ2VuZXJhdG9yTWVudUlzT3Blbjt0aGlzLl9yZW5kZXJHZW5lcmF0b3JNZW51KCk7fSxfb25BZGRDb25kaXRpb246ZnVuY3Rpb24oZXYpe2V2LnN0b3BQcm9wYWdhdGlvbigpO3RoaXMuX2FwcGVuZFByb3Bvc2l0aW9uKCk7fSxfb25BZGRDdXN0b21GaWx0ZXJDbGljazpmdW5jdGlvbihldil7ZXYucHJldmVudERlZmF1bHQoKTtldi5zdG9wUHJvcGFnYXRpb24oKTt0aGlzLl90b2dnbGVDdXN0b21GaWx0ZXJNZW51KCk7fSxfb25BcHBseUNsaWNrOmZ1bmN0aW9uKGV2KXtldi5zdG9wUHJvcGFnYXRpb24oKTt0aGlzLl9jb21taXRTZWFyY2goKTt9LF9vbkJvb3RzdHJhcENsb3NlOmZ1bmN0aW9uKCl7dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3RoaXMuZ2VuZXJhdG9yTWVudUlzT3Blbj1mYWxzZTt0aGlzLl9yZW5kZXJHZW5lcmF0b3JNZW51KCk7fSxfb25Db25maXJtUHJvcG9zaXRpb246ZnVuY3Rpb24oZXYpe2V2LnN0b3BQcm9wYWdhdGlvbigpO3RoaXMuX2NvbW1pdFNlYXJjaCgpO30sX29uUmVtb3ZlUHJvcG9zaXRpb246ZnVuY3Rpb24oZXYpe2V2LnN0b3BQcm9wYWdhdGlvbigpO3RoaXMucHJvcG9zaXRpb25zPV8ud2l0aG91dCh0aGlzLnByb3Bvc2l0aW9ucyxldi50YXJnZXQpO2lmKCF0aGlzLnByb3Bvc2l0aW9ucy5sZW5ndGgpe3RoaXMuJCgnLm9fYXBwbHlfZmlsdGVyJykucHJvcCgnZGlzYWJsZWQnLHRydWUpO30KZXYudGFyZ2V0LmRlc3Ryb3koKTt9LH0pO3JldHVybiBGaWx0ZXJNZW51O30pOzsKCi8qIC93ZWIvc3RhdGljL3NyYy9qcy92aWV3cy9jb250cm9sX3BhbmVsL3NlYXJjaC9ncm91cGJ5X21lbnUuanMgZGVmaW5lZCBpbiBidW5kbGUgJ3dlYi5hc3NldHNfYmFja2VuZCcgKi8Kb2Rvby5kZWZpbmUoJ3dlYi5Hcm91cEJ5TWVudScsZnVuY3Rpb24ocmVxdWlyZSl7InVzZSBzdHJpY3QiO3ZhciBjb25maWc9cmVxdWlyZSgnd2ViLmNvbmZpZycpO3ZhciBjb250cm9sUGFuZWxWaWV3UGFyYW1ldGVycz1yZXF1aXJlKCd3ZWIuY29udHJvbFBhbmVsVmlld1BhcmFtZXRlcnMnKTt2YXIgY29yZT1yZXF1aXJlKCd3ZWIuY29yZScpO3ZhciBEcm9wZG93bk1lbnU9cmVxdWlyZSgnd2ViLkRyb3Bkb3duTWVudScpO3ZhciBfdD1jb3JlLl90O3ZhciBRV2ViPWNvcmUucXdlYjt2YXIgREVGQVVMVF9JTlRFUlZBTD1jb250cm9sUGFuZWxWaWV3UGFyYW1ldGVycy5ERUZBVUxUX0lOVEVSVkFMO3ZhciBHUk9VUEFCTEVfVFlQRVM9Y29udHJvbFBhbmVsVmlld1BhcmFtZXRlcnMuR1JPVVBBQkxFX1RZUEVTO3ZhciBJTlRFUlZBTF9PUFRJT05TPWNvbnRyb2xQYW5lbFZpZXdQYXJhbWV0ZXJzLklOVEVSVkFMX09QVElPTlM7dmFyIEdyb3VwQnlNZW51PURyb3Bkb3duTWVudS5leHRlbmQoe2V2ZW50czpfLmV4dGVuZCh7fSxEcm9wZG93bk1lbnUucHJvdG90eXBlLmV2ZW50cyx7J2NsaWNrIC5vX2FkZF9jdXN0b21fZ3JvdXAnOidfb25BZGRDdXN0b21Hcm91cENsaWNrJywnY2xpY2sgYnV0dG9uLm9fYXBwbHlfZ3JvdXAnOidfb25CdXR0b25BcHBseUNsaWNrJywnY2xpY2sgLm9fZ3JvdXBfc2VsZWN0b3InOidfb25Hcm91cFNlbGVjdG9yQ2xpY2snLH0pLGluaXQ6ZnVuY3Rpb24ocGFyZW50LGdyb3VwQnlzLGZpZWxkcyxvcHRpb25zKXt2YXIgc2VsZj10aGlzO29wdGlvbnM9b3B0aW9uc3x8e307dGhpcy5fc3VwZXIocGFyZW50LGdyb3VwQnlzKTt0aGlzLmZpZWxkcz1maWVsZHM7dGhpcy5nZW5lcmF0b3JNZW51SXNPcGVuPWZhbHNlO3RoaXMuZ3JvdXBhYmxlRmllbGRzPVtdO18uZWFjaChmaWVsZHMsZnVuY3Rpb24oZmllbGQsbmFtZSl7aWYoZmllbGQuc29ydGFibGUmJm5hbWUhPT0iaWQiJiZfLmNvbnRhaW5zKEdST1VQQUJMRV9UWVBFUyxmaWVsZC50eXBlKSl7c2VsZi5ncm91cGFibGVGaWVsZHMucHVzaChfLmV4dGVuZCh7fSxmaWVsZCx7bmFtZTpuYW1lLH0pKTt9fSk7dGhpcy5ncm91cGFibGVGaWVsZHM9Xy5zb3J0QnkodGhpcy5ncm91cGFibGVGaWVsZHMsJ3N0cmluZycpO3RoaXMucHJlc2VudGVkRmllbGRzPXRoaXMuX3NldFByZXNlbnRlZEZpZWxkcyhncm91cEJ5cyk7dGhpcy5pc01vYmlsZT1jb25maWcuZGV2aWNlLmlzTW9iaWxlO3RoaXMuZHJvcGRvd25DYXRlZ29yeT0nZ3JvdXBieSc7dGhpcy5kcm9wZG93blRpdGxlPV90KCdHcm91cCBCeScpO3RoaXMuZHJvcGRvd25JY29uPSdmYSBmYS1iYXJzJzt0aGlzLmRyb3Bkb3duU3ltYm9sPXRoaXMuaXNNb2JpbGUmJiFvcHRpb25zLm5vU3ltYm9sPydmYSBmYS1jaGV2cm9uLXJpZ2h0IGZsb2F0LXJpZ2h0IG10NCc6ZmFsc2U7aWYob3B0aW9ucy5oZWFkZXJTdHlsZT09PSdwcmltYXJ5Jyl7dGhpcy5kcm9wZG93blN0eWxlPXtlbDp7Y2xhc3M6J2J0bi1ncm91cCBvX2dyb3VwX2J5X21lbnUgb19kcm9wZG93bicsYXR0cnM6eydyb2xlJzonZ3JvdXAnfX0sbWFpbkJ1dHRvbjp7Y2xhc3M6J2J0biBidG4tcHJpbWFyeSBkcm9wZG93bi10b2dnbGUnfSx9O30KSU5URVJWQUxfT1BUSU9OUz1JTlRFUlZBTF9PUFRJT05TLm1hcChmdW5jdGlvbihvcHRpb24pe3JldHVybiBfLmV4dGVuZChvcHRpb24se2Rlc2NyaXB0aW9uOm9wdGlvbi5kZXNjcmlwdGlvbi50b1N0cmluZygpfSk7fSk7fSxzdGFydDpmdW5jdGlvbigpe3RoaXMuJG1lbnU9dGhpcy4kKCcub19kcm9wZG93bl9tZW51Jyk7dGhpcy4kbWVudS5hZGRDbGFzcygnb19ncm91cF9ieV9tZW51Jyk7dGhpcy5fcmVuZGVyR2VuZXJhdG9yTWVudSgpO3JldHVybiB0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fSx1cGRhdGU6ZnVuY3Rpb24oZ3JvdXBCeXMpe3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLnByZXNlbnRlZEZpZWxkcz10aGlzLl9zZXRQcmVzZW50ZWRGaWVsZHMoZ3JvdXBCeXMpO3RoaXMuX3JlbmRlckdlbmVyYXRvck1lbnUoKTt9LF9hZGRHcm91cGJ5OmZ1bmN0aW9uKGZpZWxkTmFtZSl7dmFyIGZpZWxkPXRoaXMucHJlc2VudGVkRmllbGRzLmZpbmQoZnVuY3Rpb24oZmllbGQpe3JldHVybiBmaWVsZC5uYW1lPT09ZmllbGROYW1lO30pO3ZhciBncm91cEJ5PXt0eXBlOidncm91cEJ5JyxkZXNjcmlwdGlvbjpmaWVsZC5zdHJpbmcsZmllbGROYW1lOmZpZWxkTmFtZSxmaWVsZFR5cGU6ZmllbGQudHlwZSx9O2lmKF8uY29udGFpbnMoWydkYXRlJywnZGF0ZXRpbWUnXSxmaWVsZC50eXBlKSl7Z3JvdXBCeS5oYXNPcHRpb25zPXRydWU7Z3JvdXBCeS5vcHRpb25zPUlOVEVSVkFMX09QVElPTlM7Z3JvdXBCeS5kZWZhdWx0T3B0aW9uSWQ9REVGQVVMVF9JTlRFUlZBTDtncm91cEJ5LmN1cnJlbnRPcHRpb25JZHM9bmV3IFNldChbXSk7fQp0aGlzLnRyaWdnZXJfdXAoJ25ld19ncm91cEJ5Jyxncm91cEJ5KTt9LF9yZW5kZXJHZW5lcmF0b3JNZW51OmZ1bmN0aW9uKCl7dGhpcy4kZWwuZmluZCgnLm9fZ2VuZXJhdG9yX21lbnUnKS5yZW1vdmUoKTt2YXIgJGdlbmVyYXRvck1lbnU9UVdlYi5yZW5kZXIoJ0dyb3VwQnlNZW51R2VuZXJhdG9yJyx7d2lkZ2V0OnRoaXN9KTt0aGlzLiRtZW51LmFwcGVuZCgkZ2VuZXJhdG9yTWVudSk7dGhpcy4kYWRkQ3VzdG9tR3JvdXA9dGhpcy4kbWVudS5maW5kKCcub19hZGRfY3VzdG9tX2dyb3VwJyk7dGhpcy4kZ3JvdXBTZWxlY3Rvcj10aGlzLiRtZW51LmZpbmQoJy5vX2dyb3VwX3NlbGVjdG9yJyk7fSxfc2V0UHJlc2VudGVkRmllbGRzOmZ1bmN0aW9uKGdyb3VwQnlzKXtyZXR1cm4gdGhpcy5ncm91cGFibGVGaWVsZHMuZmlsdGVyKGZ1bmN0aW9uKGZpZWxkKXt2YXIgZ3JvdXBCeUZpZWxkcz1fLnBsdWNrKGdyb3VwQnlzLCdmaWVsZE5hbWUnKTtyZXR1cm4hXy5jb250YWlucyhncm91cEJ5RmllbGRzLGZpZWxkLm5hbWUpO30pO30sX3RvZ2dsZUN1c3RvbUdyb3VwTWVudTpmdW5jdGlvbigpe3RoaXMuZ2VuZXJhdG9yTWVudUlzT3Blbj0hdGhpcy5nZW5lcmF0b3JNZW51SXNPcGVuO3RoaXMuX3JlbmRlckdlbmVyYXRvck1lbnUoKTtpZih0aGlzLmdlbmVyYXRvck1lbnVJc09wZW4pe3RoaXMuJGdyb3VwU2VsZWN0b3IuZm9jdXMoKTt9fSxfb25BZGRDdXN0b21Hcm91cENsaWNrOmZ1bmN0aW9uKGV2KXtldi5wcmV2ZW50RGVmYXVsdCgpO2V2LnN0b3BQcm9wYWdhdGlvbigpO3RoaXMuX3RvZ2dsZUN1c3RvbUdyb3VwTWVudSgpO30sX29uQm9vdHN0cmFwQ2xvc2U6ZnVuY3Rpb24oKXt0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy5nZW5lcmF0b3JNZW51SXNPcGVuPWZhbHNlO3RoaXMuX3JlbmRlckdlbmVyYXRvck1lbnUoKTt9LF9vbkJ1dHRvbkFwcGx5Q2xpY2s6ZnVuY3Rpb24oZXYpe2V2LnN0b3BQcm9wYWdhdGlvbigpO3ZhciBmaWVsZE5hbWU9dGhpcy4kZ3JvdXBTZWxlY3Rvci52YWwoKTt0aGlzLmdlbmVyYXRvck1lbnVJc09wZW49ZmFsc2U7dGhpcy5fYWRkR3JvdXBieShmaWVsZE5hbWUpO30sX29uR3JvdXBTZWxlY3RvckNsaWNrOmZ1bmN0aW9uKGV2KXtldi5zdG9wUHJvcGFnYXRpb24oKTt9LH0pO3JldHVybiBHcm91cEJ5TWVudTt9KTs7CgovKiAvd2ViL3N0YXRpYy9zcmMvanMvdmlld3MvY29udHJvbF9wYW5lbC9zZWFyY2gvZ3JvdXBieV9tZW51X21peGluLmpzIGRlZmluZWQgaW4gYnVuZGxlICd3ZWIuYXNzZXRzX2JhY2tlbmQnICovCm9kb28uZGVmaW5lKCd3ZWIuR3JvdXBCeU1lbnVNaXhpbicsZnVuY3Rpb24ocmVxdWlyZSl7InVzZSBzdHJpY3QiO3ZhciBHcm91cEJ5TWVudT1yZXF1aXJlKCd3ZWIuR3JvdXBCeU1lbnUnKTt2YXIgY29udHJvbFBhbmVsVmlld1BhcmFtZXRlcnM9cmVxdWlyZSgnd2ViLmNvbnRyb2xQYW5lbFZpZXdQYXJhbWV0ZXJzJyk7dmFyIEdyb3VwQnlNZW51TWl4aW49e2luaXQ6ZnVuY3Rpb24oKXt0aGlzLmN1c3RvbV9ldmVudHM9Xy5leHRlbmQoe30sdGhpcy5jdXN0b21fZXZlbnRzLHttZW51X2l0ZW1fY2xpY2tlZDonX29uTWVudUl0ZW1DbGlja2VkJyxpdGVtX29wdGlvbl9jbGlja2VkOidfb25JdGVtT3B0aW9uQ2xpY2tlZCcsfSk7fSxfYWRkR3JvdXBCeU1lbnU6ZnVuY3Rpb24oJG5vZGUsZ3JvdXBhYmxlRmllbGRzKXt0aGlzLnNvcnRlZEZpZWxkTmFtZXM9T2JqZWN0LmtleXMoZ3JvdXBhYmxlRmllbGRzKS5zb3J0KCk7dGhpcy5ncm91cGFibGVGaWVsZHM9Z3JvdXBhYmxlRmllbGRzO2NvbnN0IGdyb3VwQnlzPXRoaXMuX2dldEdyb3VwQnlzKHRoaXMubW9kZWwuZ2V0KCkuZ3JvdXBCeSk7dGhpcy5ncm91cEJ5TWVudT1uZXcgR3JvdXBCeU1lbnUodGhpcyxncm91cEJ5cyx0aGlzLmdyb3VwYWJsZUZpZWxkcyx7bm9TeW1ib2w6dHJ1ZX0pO3JldHVybiB0aGlzLmdyb3VwQnlNZW51Lmluc2VydEFmdGVyKCRub2RlLmZpbmQoJ2RpdjpmaXJzdCcpKTt9LF9ub3JtYWxpemVBY3RpdmVHcm91cEJ5czpmdW5jdGlvbihhY3RpdmVHcm91cEJ5cyl7cmV0dXJuIGFjdGl2ZUdyb3VwQnlzLm1hcChnYj0+e2NvbnN0IGZpZWxkTmFtZT1nYi5zcGxpdCgnOicpWzBdO2NvbnN0IGZpZWxkPXRoaXMuZ3JvdXBhYmxlRmllbGRzW2ZpZWxkTmFtZV07Y29uc3QgbmdiPXtmaWVsZE5hbWU6ZmllbGROYW1lfTtpZihfLmNvbnRhaW5zKFsnZGF0ZScsJ2RhdGV0aW1lJ10sZmllbGQudHlwZSkpe25nYi5pbnRlcnZhbD1nYi5zcGxpdCgnOicpWzFdfHxjb250cm9sUGFuZWxWaWV3UGFyYW1ldGVycy5ERUZBVUxUX0lOVEVSVkFMO30KcmV0dXJuIG5nYjt9KTt9LF9zZXRHcm91cGJ5OmZ1bmN0aW9uKGdyb3VwQnlzKXt9LF9nZXRHcm91cEJ5czpmdW5jdGlvbihhY3RpdmVHcm91cEJ5cyl7Y29uc3QgZ3JvdXBCeXNOb3JtYWxpemVkPXRoaXMuX25vcm1hbGl6ZUFjdGl2ZUdyb3VwQnlzKGFjdGl2ZUdyb3VwQnlzKTtyZXR1cm4gdGhpcy5zb3J0ZWRGaWVsZE5hbWVzLm1hcChmaWVsZE5hbWU9Pntjb25zdCBmaWVsZD10aGlzLmdyb3VwYWJsZUZpZWxkc1tmaWVsZE5hbWVdO2NvbnN0IGdyb3VwQnlBY3Rpdml0eT1ncm91cEJ5c05vcm1hbGl6ZWQuZmlsdGVyKGdiPT4oZ2IuZmllbGROYW1lPT09ZmllbGROYW1lKSk7Y29uc3QgZ3JvdXBCeT17aWQ6ZmllbGROYW1lLGlzQWN0aXZlOmdyb3VwQnlBY3Rpdml0eS5sZW5ndGg/dHJ1ZTpmYWxzZSxkZXNjcmlwdGlvbjpmaWVsZC5zdHJpbmcsfTtpZihfLmNvbnRhaW5zKFsnZGF0ZScsJ2RhdGV0aW1lJ10sZmllbGQudHlwZSkpe2dyb3VwQnkuaGFzT3B0aW9ucz10cnVlO2dyb3VwQnkub3B0aW9ucz1jb250cm9sUGFuZWxWaWV3UGFyYW1ldGVycy5JTlRFUlZBTF9PUFRJT05TO2dyb3VwQnkuY3VycmVudE9wdGlvbklkcz1ncm91cEJ5QWN0aXZpdHkubGVuZ3RoP25ldyBTZXQoZ3JvdXBCeUFjdGl2aXR5Lm1hcChnYj0+Z2IuaW50ZXJ2YWwpKTpuZXcgU2V0KFtdKTt9CnJldHVybiBncm91cEJ5O30pO30sX29uSXRlbU9wdGlvbkNsaWNrZWQ6ZnVuY3Rpb24oZXYpe2NvbnN0IGZpZWxkTmFtZT1ldi5kYXRhLmlkO2NvbnN0IG9wdGlvbklkPWV2LmRhdGEub3B0aW9uSWQ7Y29uc3QgYWN0aXZlR3JvdXBCeXM9dGhpcy5tb2RlbC5nZXQoKS5ncm91cEJ5O2NvbnN0IGdyb3VwQnlzTm9ybWFsaXplZD10aGlzLl9ub3JtYWxpemVBY3RpdmVHcm91cEJ5cyhhY3RpdmVHcm91cEJ5cyk7Y29uc3QgaW5kZXg9Z3JvdXBCeXNOb3JtYWxpemVkLmZpbmRJbmRleChuZ2I9Pm5nYi5maWVsZE5hbWU9PT1maWVsZE5hbWUmJm5nYi5pbnRlcnZhbD09PW9wdGlvbklkKTtpZihpbmRleD09PS0xKXthY3RpdmVHcm91cEJ5cy5wdXNoKGZpZWxkTmFtZSsnOicrb3B0aW9uSWQpO31lbHNle2FjdGl2ZUdyb3VwQnlzLnNwbGljZShpbmRleCwxKTt9CnRoaXMuX3NldEdyb3VwYnkoYWN0aXZlR3JvdXBCeXMpO3RoaXMuZ3JvdXBCeU1lbnUudXBkYXRlKHRoaXMuX2dldEdyb3VwQnlzKGFjdGl2ZUdyb3VwQnlzKSk7fSxfb25NZW51SXRlbUNsaWNrZWQ6ZnVuY3Rpb24oZXYpe2NvbnN0IGZpZWxkTmFtZT1ldi5kYXRhLmlkO2NvbnN0IGFjdGl2ZUdyb3VwQnlzPXRoaXMubW9kZWwuZ2V0KCkuZ3JvdXBCeTtjb25zdCBncm91cEJ5RmllbGROYW1lcz1hY3RpdmVHcm91cEJ5cy5tYXAoZ2I9PmdiLnNwbGl0KCc6JylbMF0pO2NvbnN0IGluZGV4T2ZHcm91cGJ5PWdyb3VwQnlGaWVsZE5hbWVzLmluZGV4T2YoZmllbGROYW1lKTtpZihpbmRleE9mR3JvdXBieT09PS0xKXthY3RpdmVHcm91cEJ5cy5wdXNoKGZpZWxkTmFtZSk7fWVsc2V7YWN0aXZlR3JvdXBCeXMuc3BsaWNlKGluZGV4T2ZHcm91cGJ5LDEpO30KdGhpcy5fc2V0R3JvdXBieShhY3RpdmVHcm91cEJ5cyk7dGhpcy5ncm91cEJ5TWVudS51cGRhdGUodGhpcy5fZ2V0R3JvdXBCeXMoYWN0aXZlR3JvdXBCeXMpKTt9LH07cmV0dXJuIEdyb3VwQnlNZW51TWl4aW47fSk7OwoKLyogL3dlYi9zdGF0aWMvc3JjL2pzL3ZpZXdzL2NvbnRyb2xfcGFuZWwvc2VhcmNoL3RpbWVfcmFuZ2VfbWVudS5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwpvZG9vLmRlZmluZSgnd2ViLlRpbWVSYW5nZU1lbnUnLGZ1bmN0aW9uKHJlcXVpcmUpeyJ1c2Ugc3RyaWN0Ijt2YXIgY29uZmlnPXJlcXVpcmUoJ3dlYi5jb25maWcnKTt2YXIgY29udHJvbFBhbmVsVmlld1BhcmFtZXRlcnM9cmVxdWlyZSgnd2ViLmNvbnRyb2xQYW5lbFZpZXdQYXJhbWV0ZXJzJyk7dmFyIFdpZGdldD1yZXF1aXJlKCd3ZWIuV2lkZ2V0Jyk7dmFyIENPTVBBUklTT05fVElNRV9SQU5HRV9PUFRJT05TPWNvbnRyb2xQYW5lbFZpZXdQYXJhbWV0ZXJzLkNPTVBBUklTT05fVElNRV9SQU5HRV9PUFRJT05TO3ZhciBQRVJJT0RfT1BUSU9OUz1jb250cm9sUGFuZWxWaWV3UGFyYW1ldGVycy5QRVJJT0RfT1BUSU9OUzt2YXIgVGltZVJhbmdlTWVudT1XaWRnZXQuZXh0ZW5kKHt0ZW1wbGF0ZTond2ViLlRpbWVSYW5nZU1lbnUnLGV2ZW50czp7J2NsaWNrIC5vX2FwcGx5X3JhbmdlJzonX29uQXBwbHlCdXR0b25DbGljaycsJ2NsaWNrIC5vX2NvbXBhcmlzb25fY2hlY2tib3gnOidfb25DaGVja0JveENsaWNrJyx9LGluaXQ6ZnVuY3Rpb24ocGFyZW50LHRpbWVSYW5nZXMpe3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLmlzTW9iaWxlPWNvbmZpZy5kZXZpY2UuaXNNb2JpbGU7dGhpcy5zeW1ib2w9dGhpcy5pc01vYmlsZT8nZmEgZmEtY2hldnJvbi1yaWdodCBmbG9hdC1yaWdodCBtdDQnOidjYXJldCc7dGhpcy5wZXJpb2RPcHRpb25zPVBFUklPRF9PUFRJT05TO3RoaXMuY29tcGFyaXNvblRpbWVSYW5nZU9wdGlvbnM9Q09NUEFSSVNPTl9USU1FX1JBTkdFX09QVElPTlM7dGhpcy5wZXJpb2RHcm91cHM9Xy51bmlxKFBFUklPRF9PUFRJT05TLm1hcChmdW5jdGlvbihvcHRpb24pe3JldHVybiBvcHRpb24uZ3JvdXBJZDt9KSk7dGhpcy50aW1lUmFuZ2VzPXRpbWVSYW5nZXM7dGhpcy5jb25maWd1cmF0aW9uPXtjb21wYXJpc29uSXNTZWxlY3RlZDpmYWxzZSxjb21wYXJpc29uVGltZVJhbmdlSWQ6ZmFsc2UsaWQ6ZmFsc2UsdGltZVJhbmdlSWQ6ZmFsc2UsfTt0aGlzLl9jb25maWd1cmUoKTt9LHVwZGF0ZTpmdW5jdGlvbih0aW1lUmFuZ2VzKXt0aGlzLnRpbWVSYW5nZXM9dGltZVJhbmdlczt0aGlzLl9jb25maWd1cmUoKTt0aGlzLnJlbmRlckVsZW1lbnQoKTt9LF9jb25maWd1cmU6ZnVuY3Rpb24oKXt0aGlzLmNvbmZpZ3VyYXRpb249dGhpcy50aW1lUmFuZ2VzLmZpbmQoZnVuY3Rpb24odGltZVJhbmdlKXtyZXR1cm4gdGltZVJhbmdlLmlzQWN0aXZlO30pfHx0aGlzLmNvbmZpZ3VyYXRpb247dGhpcy5jb25maWd1cmF0aW9uLmNvbXBhcmlzb25Jc1NlbGVjdGVkPSEhdGhpcy5jb25maWd1cmF0aW9uLmNvbXBhcmlzb25UaW1lUmFuZ2VJZDt9LF9vbkFwcGx5QnV0dG9uQ2xpY2s6ZnVuY3Rpb24oKXt2YXIgaWQ9dGhpcy4kKCcub19kYXRlX2ZpZWxkX3NlbGVjdG9yJykudmFsKCk7dmFyIHRpbWVSYW5nZUlkPXRoaXMuJCgnLm9fdGltZV9yYW5nZV9zZWxlY3RvcicpLnZhbCgpO3ZhciBjb21wYXJpc29uVGltZVJhbmdlSWQ9ZmFsc2U7aWYodGhpcy5jb25maWd1cmF0aW9uLmNvbXBhcmlzb25Jc1NlbGVjdGVkKXtjb21wYXJpc29uVGltZVJhbmdlSWQ9dGhpcy4kKCcub19jb21wYXJpc29uX3RpbWVfcmFuZ2Vfc2VsZWN0b3InKS52YWwoKTt9CnRoaXMudHJpZ2dlcl91cCgnYWN0aXZhdGVfdGltZV9yYW5nZScse2lkOmlkLHRpbWVSYW5nZUlkOnRpbWVSYW5nZUlkLGNvbXBhcmlzb25UaW1lUmFuZ2VJZDpjb21wYXJpc29uVGltZVJhbmdlSWR9KTt9LF9vbkNoZWNrQm94Q2xpY2s6ZnVuY3Rpb24oZXYpe2V2LnN0b3BQcm9wYWdhdGlvbigpO3RoaXMuY29uZmlndXJhdGlvbi5jb21wYXJpc29uSXNTZWxlY3RlZD10aGlzLiQoJy5vX2NvbXBhcmlzb25fY2hlY2tib3gnKS5wcm9wKCdjaGVja2VkJyk7dGhpcy4kKCcub19jb21wYXJpc29uX3RpbWVfcmFuZ2Vfc2VsZWN0b3InKS50b2dnbGVDbGFzcygnb19oaWRkZW4nKTt0aGlzLiRlbC5hZGRDbGFzcygnb3BlbicpO319KTtyZXR1cm4gVGltZVJhbmdlTWVudTt9KTs7CgovKiAvd2ViL3N0YXRpYy9zcmMvanMvdmlld3MvY29udHJvbF9wYW5lbC9zZWFyY2gvZmF2b3JpdGVfbWVudS5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwpvZG9vLmRlZmluZSgnd2ViLkZhdm9yaXRlTWVudScsZnVuY3Rpb24ocmVxdWlyZSl7InVzZSBzdHJpY3QiO3ZhciBjb25maWc9cmVxdWlyZSgnd2ViLmNvbmZpZycpO3ZhciBjb3JlPXJlcXVpcmUoJ3dlYi5jb3JlJyk7dmFyIERpYWxvZz1yZXF1aXJlKCd3ZWIuRGlhbG9nJyk7dmFyIERyb3Bkb3duTWVudT1yZXF1aXJlKCd3ZWIuRHJvcGRvd25NZW51Jyk7dmFyIGZhdm9yaXRlc19zdWJtZW51c19yZWdpc3RyeT1yZXF1aXJlKCd3ZWIuZmF2b3JpdGVzX3N1Ym1lbnVzX3JlZ2lzdHJ5Jyk7dmFyIF90PWNvcmUuX3Q7dmFyIEZhdm9yaXRlTWVudT1Ecm9wZG93bk1lbnUuZXh0ZW5kKHtpbml0OmZ1bmN0aW9uKHBhcmVudCxmYXZvcml0ZXMsYWN0aW9uKXt0aGlzLl9zdXBlcihwYXJlbnQsZmF2b3JpdGVzKTt0aGlzLmFjdGlvbj1hY3Rpb247dGhpcy5pc01vYmlsZT1jb25maWcuZGV2aWNlLmlzTW9iaWxlO3RoaXMuZHJvcGRvd25DYXRlZ29yeT0nZmF2b3JpdGUnO3RoaXMuZHJvcGRvd25UaXRsZT1fdCgnRmF2b3JpdGVzJyk7dGhpcy5kcm9wZG93bkljb249J2ZhIGZhLXN0YXInO3RoaXMuZHJvcGRvd25TeW1ib2w9dGhpcy5pc01vYmlsZT8nZmEgZmEtY2hldnJvbi1yaWdodCBmbG9hdC1yaWdodCBtdDQnOmZhbHNlO3RoaXMuZHJvcGRvd25TdHlsZS5tYWluQnV0dG9uLmNsYXNzPSdvX2Zhdm9yaXRlc19tZW51X2J1dHRvbiAnKwp0aGlzLmRyb3Bkb3duU3R5bGUubWFpbkJ1dHRvbi5jbGFzczt9LHN0YXJ0OmZ1bmN0aW9uKCl7dmFyIHNlbGY9dGhpczt2YXIgcGFyYW1zPXtmYXZvcml0ZXM6dGhpcy5pdGVtcyxhY3Rpb246dGhpcy5hY3Rpb24sfTt0aGlzLiRtZW51PXRoaXMuJCgnLm9fZHJvcGRvd25fbWVudScpO3RoaXMuJG1lbnUuYWRkQ2xhc3MoJ29fZmF2b3JpdGVzX21lbnUnKTt0aGlzLnN1Yk1lbnVzPVtdO2Zhdm9yaXRlc19zdWJtZW51c19yZWdpc3RyeS52YWx1ZXMoKS5mb3JFYWNoKGZ1bmN0aW9uKFN1Yk1lbnUpe3ZhciBzdWJNZW51PW5ldyBTdWJNZW51KHNlbGYscGFyYW1zKTtzdWJNZW51LmFwcGVuZFRvKHNlbGYuJG1lbnUpO3NlbGYuc3ViTWVudXMucHVzaChzdWJNZW51KTt9KTt9LHVwZGF0ZTpmdW5jdGlvbihpdGVtcyl7dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO18uaW52b2tlKHRoaXMuc3ViTWVudXMsJ3VwZGF0ZScse2Zhdm9yaXRlczp0aGlzLml0ZW1zfSk7fSxfY2xvc2VTdWJNZW51czpmdW5jdGlvbigpe18uaW52b2tlKHRoaXMuc3ViTWVudXMsJ2Nsb3NlTWVudScpO30sX29uQm9vdHN0cmFwQ2xvc2U6ZnVuY3Rpb24oKXt0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy5fY2xvc2VTdWJNZW51cygpO30sX29uVHJhc2hCdXR0b25DbGljazpmdW5jdGlvbihldmVudCl7ZXZlbnQucHJldmVudERlZmF1bHQoKTtldmVudC5zdG9wUHJvcGFnYXRpb24oKTt2YXIgc2VsZj10aGlzO3ZhciBpZD0kKGV2ZW50LmN1cnJlbnRUYXJnZXQpLmRhdGEoJ2lkJyk7dmFyIGZhdm9yaXRlPXRoaXMuaXRlbXMuZmluZChmdW5jdGlvbihmYXZvcml0ZSl7cmV0dXJuIGZhdm9yaXRlLmlkPT09aWQ7fSk7dmFyIGdsb2JhbFdhcm5pbmc9X3QoIlRoaXMgZmlsdGVyIGlzIGdsb2JhbCBhbmQgd2lsbCBiZSByZW1vdmVkIGZvciBldmVyeWJvZHkgaWYgeW91IGNvbnRpbnVlLiIpO3ZhciB3YXJuaW5nPV90KCJBcmUgeW91IHN1cmUgdGhhdCB5b3Ugd2FudCB0byByZW1vdmUgdGhpcyBmaWx0ZXI/Iik7dmFyIG1lc3NhZ2U9ZmF2b3JpdGUudXNlcklkP3dhcm5pbmc6Z2xvYmFsV2FybmluZztEaWFsb2cuY29uZmlybShzZWxmLG1lc3NhZ2Use3RpdGxlOl90KCJXYXJuaW5nIiksY29uZmlybV9jYWxsYmFjazpmdW5jdGlvbigpe3NlbGYudHJpZ2dlcl91cCgnaXRlbV90cmFzaGVkJyx7aWQ6aWR9KTt9LH0pO30sfSk7cmV0dXJuIEZhdm9yaXRlTWVudTt9KTs7CgovKiAvd2ViL3N0YXRpYy9zcmMvanMvdmlld3MvY29udHJvbF9wYW5lbC9zZWFyY2gvYWRkX25ld19mYXZvcml0ZV9tZW51LmpzIGRlZmluZWQgaW4gYnVuZGxlICd3ZWIuYXNzZXRzX2JhY2tlbmQnICovCm9kb28uZGVmaW5lKCd3ZWIuQWRkTmV3RmF2b3JpdGVNZW51JyxmdW5jdGlvbihyZXF1aXJlKXsidXNlIHN0cmljdCI7dmFyIGNvcmU9cmVxdWlyZSgnd2ViLmNvcmUnKTt2YXIgZmF2b3JpdGVzU3VibWVudXNSZWdpc3RyeT1yZXF1aXJlKCd3ZWIuZmF2b3JpdGVzX3N1Ym1lbnVzX3JlZ2lzdHJ5Jyk7dmFyIFdpZGdldD1yZXF1aXJlKCd3ZWIuV2lkZ2V0Jyk7dmFyIF90PWNvcmUuX3Q7dmFyIEFkZE5ld0Zhdm9yaXRlTWVudT1XaWRnZXQuZXh0ZW5kKHt0ZW1wbGF0ZTonQWRkTmV3RmF2b3JpdGVNZW51JyxldmVudHM6Xy5leHRlbmQoe30sV2lkZ2V0LnByb3RvdHlwZS5ldmVudHMseydjbGljayAub19zYXZlX2Zhdm9yaXRlJzonX29uU2F2ZUZhdm9yaXRlQ2xpY2snLCdjbGljayAub19hZGRfZmF2b3JpdGUub19tZW51X2hlYWRlcic6J19vbk1lbnVIZWFkZXJDbGljaycsJ2NsaWNrIGlucHV0W3R5cGU9ImNoZWNrYm94Il0nOidfb25DaGVja2JveENsaWNrJywna2V5dXAgLm9fc2F2ZV9uYW1lIGlucHV0JzonX29uS2V5VXAnLH0pLGluaXQ6ZnVuY3Rpb24ocGFyZW50LHBhcmFtcyl7dGhpcy5fc3VwZXIocGFyZW50KTt0aGlzLmZhdm9yaXRlcz1wYXJhbXMuZmF2b3JpdGVzO3RoaXMuYWN0aW9uPXBhcmFtcy5hY3Rpb247dGhpcy5pc09wZW49ZmFsc2U7fSxzdGFydDpmdW5jdGlvbigpe3RoaXMuX3JlbmRlcigpO3JldHVybiB0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fSx1cGRhdGU6ZnVuY3Rpb24ocGFyYW1zKXt0aGlzLmZhdm9yaXRlcz1wYXJhbXMuZmF2b3JpdGVzO30sY2xvc2VNZW51OmZ1bmN0aW9uKCl7dGhpcy5pc09wZW49ZmFsc2U7dGhpcy5fcmVuZGVyKCk7fSxfcmVuZGVyOmZ1bmN0aW9uKCl7dGhpcy5yZW5kZXJFbGVtZW50KCk7aWYodGhpcy5pc09wZW4pe3ZhciAkaW5wdXQ9dGhpcy4kKCcub19mYXZvcml0ZV9uYW1lIGlucHV0Lm9faW5wdXQnKTskaW5wdXQudmFsKHRoaXMuYWN0aW9uLm5hbWUpOyRpbnB1dC5mb2N1cygpO319LF9zYXZlRmF2b3JpdGU6ZnVuY3Rpb24oKXt2YXIgc2VsZj10aGlzO3ZhciAkaW5wdXRzPXRoaXMuJCgnaW5wdXQnKTt2YXIgZGVzY3JpcHRpb249JGlucHV0c1swXS52YWx1ZTt2YXIgaXNEZWZhdWx0PSRpbnB1dHNbMV0uY2hlY2tlZDt2YXIgaXNTaGFyZWQ9JGlucHV0c1syXS5jaGVja2VkO2lmKCFkZXNjcmlwdGlvbi5sZW5ndGgpe3RoaXMuZG9fd2FybihfdCgiRXJyb3IiKSxfdCgiQSBuYW1lIGZvciB5b3VyIGZhdm9yaXRlIGlzIHJlcXVpcmVkLiIpKTskaW5wdXRzWzBdLmZvY3VzKCk7cmV0dXJuO30KdmFyIGRlc2NyaXB0aW9uQWxyZWFkeUV4aXN0cz0hIXRoaXMuZmF2b3JpdGVzLmZpbmQoZnVuY3Rpb24oZmF2b3JpdGUpe3JldHVybiBmYXZvcml0ZS5kZXNjcmlwdGlvbj09PWRlc2NyaXB0aW9uO30pO2lmKGRlc2NyaXB0aW9uQWxyZWFkeUV4aXN0cyl7dGhpcy5kb193YXJuKF90KCJFcnJvciIpLF90KCJGaWx0ZXIgd2l0aCBzYW1lIG5hbWUgYWxyZWFkeSBleGlzdHMuIikpOyRpbnB1dHNbMF0uZm9jdXMoKTtyZXR1cm47fQp0aGlzLnRyaWdnZXJfdXAoJ25ld19mYXZvcml0ZScse3R5cGU6J2Zhdm9yaXRlJyxkZXNjcmlwdGlvbjpkZXNjcmlwdGlvbixpc0RlZmF1bHQ6aXNEZWZhdWx0LGlzU2hhcmVkOmlzU2hhcmVkLG9uX3N1Y2Nlc3M6ZnVuY3Rpb24oKXtzZWxmLmdlbmVyYXRvck1lbnVJc09wZW49ZmFsc2U7fSx9KTt0aGlzLmNsb3NlTWVudSgpO30sX3RvZ2dsZU1lbnU6ZnVuY3Rpb24oKXt0aGlzLmlzT3Blbj0hdGhpcy5pc09wZW47dGhpcy5fcmVuZGVyKCk7fSxfb25DaGVja2JveENsaWNrOmZ1bmN0aW9uKGV2KXtmdW5jdGlvbiBtdXR1YWxseUV4Y2x1c2l2ZShlbGVtKXtpZighZWxlbS5pZClyZXR1cm4gZmFsc2U7cmV0dXJuWyd1c2VfYnlfZGVmYXVsdCcsJ3NoYXJlX2FsbF91c2VycyddLnNvbWUoZnVuY3Rpb24oc3RyKXtyZXR1cm4gZWxlbS5pZC5pbmRleE9mKHN0cik7fSk7fQp2YXIgJGNoZWNrYm94ZXM9dGhpcy4kKCdpbnB1dFt0eXBlPSJjaGVja2JveCJdJyk7dmFyIGN1cnJlbnRDaGVja0JveD1ldi50YXJnZXQ7aWYobXV0dWFsbHlFeGNsdXNpdmUoY3VycmVudENoZWNrQm94KSl7Zm9yKHZhciBpPTA7aTwkY2hlY2tib3hlcy5sZW5ndGg7aSsrKXt2YXIgY2hlY2tib3g9JGNoZWNrYm94ZXNbaV07aWYoY2hlY2tib3ghPT1jdXJyZW50Q2hlY2tCb3gmJm11dHVhbGx5RXhjbHVzaXZlKGNoZWNrYm94KSl7Y2hlY2tib3guY2hlY2tlZD1mYWxzZTt9fX19LF9vbktleVVwOmZ1bmN0aW9uKGV2KXtpZihldi53aGljaD09PSQudWkua2V5Q29kZS5FTlRFUil7dGhpcy5fc2F2ZUZhdm9yaXRlKCk7fX0sX29uTWVudUhlYWRlckNsaWNrOmZ1bmN0aW9uKGV2KXtldi5wcmV2ZW50RGVmYXVsdCgpO2V2LnN0b3BQcm9wYWdhdGlvbigpO3RoaXMuX3RvZ2dsZU1lbnUoKTt9LF9vblNhdmVGYXZvcml0ZUNsaWNrOmZ1bmN0aW9uKGV2KXtldi5zdG9wUHJvcGFnYXRpb24oKTt0aGlzLl9zYXZlRmF2b3JpdGUoKTt9LH0pO2Zhdm9yaXRlc1N1Ym1lbnVzUmVnaXN0cnkuYWRkKCdhZGRfbmV3X2Zhdm9yaXRlX21lbnUnLEFkZE5ld0Zhdm9yaXRlTWVudSwwKTtyZXR1cm4gQWRkTmV3RmF2b3JpdGVNZW51O30pOzsKCi8qIC93ZWIvc3RhdGljL3NyYy9qcy92aWV3cy9jb250cm9sX3BhbmVsL3NlYXJjaC9jb250cm9sX3BhbmVsX3ZpZXdfcGFyYW1ldGVycy5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwpvZG9vLmRlZmluZSgnd2ViLmNvbnRyb2xQYW5lbFZpZXdQYXJhbWV0ZXJzJyxmdW5jdGlvbihyZXF1aXJlKXsidXNlIHN0cmljdCI7dmFyIGNvcmU9cmVxdWlyZSgnd2ViLmNvcmUnKTt2YXIgX2x0PWNvcmUuX2x0O2NvbnN0IERFRkFVTFRfUEVSSU9EPSd0aGlzX21vbnRoJztjb25zdCBQRVJJT0RfT1BUSU9OUz1be2Rlc2NyaXB0aW9uOl9sdCgnTGFzdCA3IERheXMnKSxvcHRpb25JZDonbGFzdF83X2RheXMnLGdyb3VwSWQ6MX0se2Rlc2NyaXB0aW9uOl9sdCgnTGFzdCAzMCBEYXlzJyksb3B0aW9uSWQ6J2xhc3RfMzBfZGF5cycsZ3JvdXBJZDoxfSx7ZGVzY3JpcHRpb246X2x0KCdMYXN0IDM2NSBEYXlzJyksb3B0aW9uSWQ6J2xhc3RfMzY1X2RheXMnLGdyb3VwSWQ6MX0se2Rlc2NyaXB0aW9uOl9sdCgnTGFzdCA1IFllYXJzJyksb3B0aW9uSWQ6J2xhc3RfNV95ZWFycycsZ3JvdXBJZDoxfSx7ZGVzY3JpcHRpb246X2x0KCdUb2RheScpLG9wdGlvbklkOid0b2RheScsZ3JvdXBJZDoyfSx7ZGVzY3JpcHRpb246X2x0KCdUaGlzIFdlZWsnKSxvcHRpb25JZDondGhpc193ZWVrJyxncm91cElkOjJ9LHtkZXNjcmlwdGlvbjpfbHQoJ1RoaXMgTW9udGgnKSxvcHRpb25JZDondGhpc19tb250aCcsZ3JvdXBJZDoyfSx7ZGVzY3JpcHRpb246X2x0KCdUaGlzIFF1YXJ0ZXInKSxvcHRpb25JZDondGhpc19xdWFydGVyJyxncm91cElkOjJ9LHtkZXNjcmlwdGlvbjpfbHQoJ1RoaXMgWWVhcicpLG9wdGlvbklkOid0aGlzX3llYXInLGdyb3VwSWQ6Mn0se2Rlc2NyaXB0aW9uOl9sdCgnWWVzdGVyZGF5Jyksb3B0aW9uSWQ6J3llc3RlcmRheScsZ3JvdXBJZDozfSx7ZGVzY3JpcHRpb246X2x0KCdMYXN0IFdlZWsnKSxvcHRpb25JZDonbGFzdF93ZWVrJyxncm91cElkOjN9LHtkZXNjcmlwdGlvbjpfbHQoJ0xhc3QgTW9udGgnKSxvcHRpb25JZDonbGFzdF9tb250aCcsZ3JvdXBJZDozfSx7ZGVzY3JpcHRpb246X2x0KCdMYXN0IFF1YXJ0ZXInKSxvcHRpb25JZDonbGFzdF9xdWFydGVyJyxncm91cElkOjN9LHtkZXNjcmlwdGlvbjpfbHQoJ0xhc3QgWWVhcicpLG9wdGlvbklkOidsYXN0X3llYXInLGdyb3VwSWQ6M30sXTtjb25zdCBNT05USF9PUFRJT05TPVt7b3B0aW9uSWQ6J3RoaXNfbW9udGgnLGdyb3VwSWQ6MSxmb3JtYXQ6J01NTU0nLGFkZFBhcmFtOnt9LHNldFBhcmFtOnt9LGdyYW51bGFyaXR5Oidtb250aCd9LHtvcHRpb25JZDonbGFzdF9tb250aCcsZ3JvdXBJZDoxLGZvcm1hdDonTU1NTScsYWRkUGFyYW06e21vbnRoczotMX0sc2V0UGFyYW06e30sZ3JhbnVsYXJpdHk6J21vbnRoJ30se29wdGlvbklkOidhbnRlcGVudWx0aW1hdGVfbW9udGgnLGdyb3VwSWQ6MSxmb3JtYXQ6J01NTU0nLGFkZFBhcmFtOnttb250aHM6LTJ9LHNldFBhcmFtOnt9LGdyYW51bGFyaXR5Oidtb250aCd9XQpjb25zdCBRVUFSVEVSX09QVElPTlM9W3tvcHRpb25JZDonZm91cnRoX3F1YXJ0ZXInLGdyb3VwSWQ6MSxkZXNjcmlwdGlvbjpfbHQoIlE0IiksYWRkUGFyYW06e30sc2V0UGFyYW06e3F1YXJ0ZXI6NH0sZ3JhbnVsYXJpdHk6J3F1YXJ0ZXInfSx7b3B0aW9uSWQ6J3RoaXJkX3F1YXJ0ZXInLGdyb3VwSWQ6MSxkZXNjcmlwdGlvbjpfbHQoIlEzIiksYWRkUGFyYW06e30sc2V0UGFyYW06e3F1YXJ0ZXI6M30sZ3JhbnVsYXJpdHk6J3F1YXJ0ZXInfSx7b3B0aW9uSWQ6J3NlY29uZF9xdWFydGVyJyxncm91cElkOjEsZGVzY3JpcHRpb246X2x0KCJRMiIpLGFkZFBhcmFtOnt9LHNldFBhcmFtOntxdWFydGVyOjJ9LGdyYW51bGFyaXR5OidxdWFydGVyJ30se29wdGlvbklkOidmaXJzdF9xdWFydGVyJyxncm91cElkOjEsZGVzY3JpcHRpb246X2x0KCJRMSIpLGFkZFBhcmFtOnt9LHNldFBhcmFtOntxdWFydGVyOjF9LGdyYW51bGFyaXR5OidxdWFydGVyJ31dCmNvbnN0IFlFQVJfT1BUSU9OUz1be29wdGlvbklkOid0aGlzX3llYXInLGdyb3VwSWQ6Mixmb3JtYXQ6J1lZWVknLGFkZFBhcmFtOnt9LHNldFBhcmFtOnt9LGdyYW51bGFyaXR5Oid5ZWFyJ30se29wdGlvbklkOidsYXN0X3llYXInLGdyb3VwSWQ6Mixmb3JtYXQ6J1lZWVknLGFkZFBhcmFtOnt5ZWFyczotMX0sc2V0UGFyYW06e30sZ3JhbnVsYXJpdHk6J3llYXInfSx7b3B0aW9uSWQ6J2FudGVwZW51bHRpbWF0ZV95ZWFyJyxncm91cElkOjIsZm9ybWF0OidZWVlZJyxhZGRQYXJhbTp7eWVhcnM6LTJ9LHNldFBhcmFtOnt9LGdyYW51bGFyaXR5Oid5ZWFyJ30sXTtjb25zdCBPUFRJT05fR0VORVJBVE9SUz1bLi4uTU9OVEhfT1BUSU9OUywuLi5RVUFSVEVSX09QVElPTlMsLi4uWUVBUl9PUFRJT05TXTtjb25zdCBHUk9VUEFCTEVfVFlQRVM9WydtYW55Mm9uZScsJ2NoYXInLCdib29sZWFuJywnc2VsZWN0aW9uJywnZGF0ZScsJ2RhdGV0aW1lJywnaW50ZWdlciddO2NvbnN0IERFRkFVTFRfSU5URVJWQUw9J21vbnRoJztjb25zdCBJTlRFUlZBTF9PUFRJT05TPVt7ZGVzY3JpcHRpb246X2x0KCdZZWFyJyksb3B0aW9uSWQ6J3llYXInLGdyb3VwSWQ6MX0se2Rlc2NyaXB0aW9uOl9sdCgnUXVhcnRlcicpLG9wdGlvbklkOidxdWFydGVyJyxncm91cElkOjF9LHtkZXNjcmlwdGlvbjpfbHQoJ01vbnRoJyksb3B0aW9uSWQ6J21vbnRoJyxncm91cElkOjF9LHtkZXNjcmlwdGlvbjpfbHQoJ1dlZWsnKSxvcHRpb25JZDond2VlaycsZ3JvdXBJZDoxfSx7ZGVzY3JpcHRpb246X2x0KCdEYXknKSxvcHRpb25JZDonZGF5Jyxncm91cElkOjF9LF07Y29uc3QgREVGQVVMVF9USU1FUkFOR0U9REVGQVVMVF9QRVJJT0Q7Y29uc3QgVElNRV9SQU5HRV9PUFRJT05TPVBFUklPRF9PUFRJT05TO2NvbnN0IENPTVBBUklTT05fVElNRV9SQU5HRV9PUFRJT05TPVt7ZGVzY3JpcHRpb246X2x0KCdQcmV2aW91cyBQZXJpb2QnKSxvcHRpb25JZDoncHJldmlvdXNfcGVyaW9kJ30se2Rlc2NyaXB0aW9uOl9sdCgnUHJldmlvdXMgWWVhcicpLG9wdGlvbklkOidwcmV2aW91c195ZWFyJ31dO3JldHVybntDT01QQVJJU09OX1RJTUVfUkFOR0VfT1BUSU9OUzpDT01QQVJJU09OX1RJTUVfUkFOR0VfT1BUSU9OUyxERUZBVUxUX0lOVEVSVkFMOkRFRkFVTFRfSU5URVJWQUwsREVGQVVMVF9QRVJJT0Q6REVGQVVMVF9QRVJJT0QsREVGQVVMVF9USU1FUkFOR0U6REVGQVVMVF9USU1FUkFOR0UsR1JPVVBBQkxFX1RZUEVTOkdST1VQQUJMRV9UWVBFUyxJTlRFUlZBTF9PUFRJT05TOklOVEVSVkFMX09QVElPTlMsT1BUSU9OX0dFTkVSQVRPUlM6T1BUSU9OX0dFTkVSQVRPUlMsUEVSSU9EX09QVElPTlM6UEVSSU9EX09QVElPTlMsVElNRV9SQU5HRV9PUFRJT05TOlRJTUVfUkFOR0VfT1BUSU9OUyxZRUFSX09QVElPTlM6WUVBUl9PUFRJT05TLH07fSk7OwoKLyogL3dlYi9zdGF0aWMvc3JjL2pzL3ZpZXdzL2NvbnRyb2xfcGFuZWwvc2VhcmNoL2Zhdm9yaXRlc19zdWJtZW51c19yZWdpc3RyeS5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwpvZG9vLmRlZmluZSgnd2ViLmZhdm9yaXRlc19zdWJtZW51c19yZWdpc3RyeScsZnVuY3Rpb24ocmVxdWlyZSl7InVzZSBzdHJpY3QiO3ZhciBSZWdpc3RyeT1yZXF1aXJlKCd3ZWIuUmVnaXN0cnknKTtyZXR1cm4gbmV3IFJlZ2lzdHJ5KCk7fSk7OwoKLyogL3dlYi9zdGF0aWMvc3JjL2pzL3ZpZXdzL2NvbnRyb2xfcGFuZWwvc2VhcmNoL3NlYXJjaF9maWx0ZXJzLmpzIGRlZmluZWQgaW4gYnVuZGxlICd3ZWIuYXNzZXRzX2JhY2tlbmQnICovCm9kb28uZGVmaW5lKCd3ZWIuc2VhcmNoX2ZpbHRlcnMnLGZ1bmN0aW9uKHJlcXVpcmUpeyJ1c2Ugc3RyaWN0Ijt2YXIgY29yZT1yZXF1aXJlKCd3ZWIuY29yZScpO3ZhciBkYXRlcGlja2VyPXJlcXVpcmUoJ3dlYi5kYXRlcGlja2VyJyk7dmFyIGZpZWxkX3V0aWxzPXJlcXVpcmUoJ3dlYi5maWVsZF91dGlscycpO3ZhciBzZWFyY2hfZmlsdGVyc19yZWdpc3RyeT1yZXF1aXJlKCd3ZWIuc2VhcmNoX2ZpbHRlcnNfcmVnaXN0cnknKTt2YXIgV2lkZ2V0PXJlcXVpcmUoJ3dlYi5XaWRnZXQnKTt2YXIgX3Q9Y29yZS5fdDt2YXIgX2x0PWNvcmUuX2x0O3ZhciBFeHRlbmRlZFNlYXJjaFByb3Bvc2l0aW9uPVdpZGdldC5leHRlbmQoe3RlbXBsYXRlOidTZWFyY2hWaWV3LmV4dGVuZGVkX3NlYXJjaC5wcm9wb3NpdGlvbicsZXZlbnRzOnsnY2hhbmdlIC5vX3NlYXJjaHZpZXdfZXh0ZW5kZWRfcHJvcF9maWVsZCc6J2NoYW5nZWQnLCdjaGFuZ2UgLm9fc2VhcmNodmlld19leHRlbmRlZF9wcm9wX29wJzonb3BlcmF0b3JfY2hhbmdlZCcsJ2NsaWNrIC5vX3NlYXJjaHZpZXdfZXh0ZW5kZWRfZGVsZXRlX3Byb3AnOmZ1bmN0aW9uKGUpe2Uuc3RvcFByb3BhZ2F0aW9uKCk7dGhpcy50cmlnZ2VyX3VwKCdyZW1vdmVfcHJvcG9zaXRpb24nKTt9LCdrZXl1cCAub19zZWFyY2h2aWV3X2V4dGVuZGVkX3Byb3BfdmFsdWUnOmZ1bmN0aW9uKGV2KXtpZihldi53aGljaD09PSQudWkua2V5Q29kZS5FTlRFUil7dGhpcy50cmlnZ2VyX3VwKCdjb25maXJtX3Byb3Bvc2l0aW9uJyk7fX0sfSxpbml0OmZ1bmN0aW9uKHBhcmVudCxmaWVsZHMpe3RoaXMuX3N1cGVyKHBhcmVudCk7dGhpcy5maWVsZHM9XyhmaWVsZHMpLmNoYWluKCkubWFwKGZ1bmN0aW9uKHZhbCxrZXkpe3JldHVybiBfLmV4dGVuZCh7fSx2YWwseyduYW1lJzprZXl9KTt9KS5maWx0ZXIoZnVuY3Rpb24oZmllbGQpe3JldHVybiFmaWVsZC5kZXByZWNhdGVkJiZmaWVsZC5zZWFyY2hhYmxlO30pLnNvcnRCeShmdW5jdGlvbihmaWVsZCl7cmV0dXJuIGZpZWxkLnN0cmluZzt9KS52YWx1ZSgpO3RoaXMuYXR0cnM9e186XyxmaWVsZHM6dGhpcy5maWVsZHMsc2VsZWN0ZWQ6bnVsbH07dGhpcy52YWx1ZT1udWxsO30sc3RhcnQ6ZnVuY3Rpb24oKXt2YXIgcGFyZW50PXRoaXMuX3N1cGVyKCk7cGFyZW50LnRoZW4odGhpcy5wcm94eSgnY2hhbmdlZCcpKTtyZXR1cm4gcGFyZW50O30sY2hhbmdlZDpmdW5jdGlvbigpe3ZhciBudmFsPXRoaXMuJCgiLm9fc2VhcmNodmlld19leHRlbmRlZF9wcm9wX2ZpZWxkIikudmFsKCk7aWYodGhpcy5hdHRycy5zZWxlY3RlZD09PW51bGx8fHRoaXMuYXR0cnMuc2VsZWN0ZWQ9PT11bmRlZmluZWR8fG52YWwhPT10aGlzLmF0dHJzLnNlbGVjdGVkLm5hbWUpe3RoaXMuc2VsZWN0X2ZpZWxkKF8uZGV0ZWN0KHRoaXMuZmllbGRzLGZ1bmN0aW9uKHgpe3JldHVybiB4Lm5hbWU9PT1udmFsO30pKTt9fSxvcGVyYXRvcl9jaGFuZ2VkOmZ1bmN0aW9uKGUpe3RoaXMudmFsdWUuc2hvd19pbnB1dHMoJChlLnRhcmdldCkpO30sc2VsZWN0X2ZpZWxkOmZ1bmN0aW9uKGZpZWxkKXt2YXIgc2VsZj10aGlzO2lmKHRoaXMuYXR0cnMuc2VsZWN0ZWQhPT1udWxsJiZ0aGlzLmF0dHJzLnNlbGVjdGVkIT09dW5kZWZpbmVkKXt0aGlzLnZhbHVlLmRlc3Ryb3koKTt0aGlzLnZhbHVlPW51bGw7dGhpcy4kKCcub19zZWFyY2h2aWV3X2V4dGVuZGVkX3Byb3Bfb3AnKS5odG1sKCcnKTt9CnRoaXMuYXR0cnMuc2VsZWN0ZWQ9ZmllbGQ7aWYoZmllbGQ9PT1udWxsfHxmaWVsZD09PXVuZGVmaW5lZCl7cmV0dXJuO30KdmFyIHR5cGU9ZmllbGQudHlwZTt2YXIgRmllbGQ9c2VhcmNoX2ZpbHRlcnNfcmVnaXN0cnkuZ2V0QW55KFt0eXBlLCJjaGFyIl0pO3RoaXMudmFsdWU9bmV3IEZpZWxkKHRoaXMsZmllbGQpO18uZWFjaCh0aGlzLnZhbHVlLm9wZXJhdG9ycyxmdW5jdGlvbihvcGVyYXRvcil7JCgnPG9wdGlvbj4nLHt2YWx1ZTpvcGVyYXRvci52YWx1ZX0pLnRleHQoU3RyaW5nKG9wZXJhdG9yLnRleHQpKS5hcHBlbmRUbyhzZWxmLiQoJy5vX3NlYXJjaHZpZXdfZXh0ZW5kZWRfcHJvcF9vcCcpKTt9KTt2YXIgJHZhbHVlX2xvYz10aGlzLiQoJy5vX3NlYXJjaHZpZXdfZXh0ZW5kZWRfcHJvcF92YWx1ZScpLnNob3coKS5lbXB0eSgpO3RoaXMudmFsdWUuYXBwZW5kVG8oJHZhbHVlX2xvYyk7fSxnZXRfZmlsdGVyOmZ1bmN0aW9uKCl7aWYodGhpcy5hdHRycy5zZWxlY3RlZD09PW51bGx8fHRoaXMuYXR0cnMuc2VsZWN0ZWQ9PT11bmRlZmluZWQpe3JldHVybiBudWxsO30KdmFyIGZpZWxkPXRoaXMuYXR0cnMuc2VsZWN0ZWQsb3Bfc2VsZWN0PXRoaXMuJCgnLm9fc2VhcmNodmlld19leHRlbmRlZF9wcm9wX29wJylbMF0sb3BlcmF0b3I9b3Bfc2VsZWN0Lm9wdGlvbnNbb3Bfc2VsZWN0LnNlbGVjdGVkSW5kZXhdO3JldHVybnthdHRyczp7ZG9tYWluOnRoaXMudmFsdWUuZ2V0X2RvbWFpbihmaWVsZCxvcGVyYXRvciksc3RyaW5nOnRoaXMudmFsdWUuZ2V0X2xhYmVsKGZpZWxkLG9wZXJhdG9yKSx9LGNoaWxkcmVuOltdLHRhZzonZmlsdGVyJyx9O30sfSk7dmFyIEZpZWxkPVdpZGdldC5leHRlbmQoe2luaXQ6ZnVuY3Rpb24ocGFyZW50LGZpZWxkKXt0aGlzLl9zdXBlcihwYXJlbnQpO3RoaXMuZmllbGQ9ZmllbGQ7fSxnZXRfbGFiZWw6ZnVuY3Rpb24oZmllbGQsb3BlcmF0b3Ipe3ZhciBmb3JtYXQ7c3dpdGNoKG9wZXJhdG9yLnZhbHVlKXtjYXNlJ+KIgyc6Y2FzZSfiiIQnOmZvcm1hdD1fdCgnJShmaWVsZClzICUob3BlcmF0b3IpcycpO2JyZWFrO2RlZmF1bHQ6Zm9ybWF0PV90KCclKGZpZWxkKXMgJShvcGVyYXRvcilzICIlKHZhbHVlKXMiJyk7YnJlYWs7fQpyZXR1cm4gdGhpcy5mb3JtYXRfbGFiZWwoZm9ybWF0LGZpZWxkLG9wZXJhdG9yKTt9LGZvcm1hdF9sYWJlbDpmdW5jdGlvbihmb3JtYXQsZmllbGQsb3BlcmF0b3Ipe3JldHVybiBfLnN0ci5zcHJpbnRmKGZvcm1hdCx7ZmllbGQ6ZmllbGQuc3RyaW5nLG9wZXJhdG9yOm9wZXJhdG9yLmxhYmVsfHxvcGVyYXRvci50ZXh0LHZhbHVlOnRoaXN9KTt9LGdldF9kb21haW46ZnVuY3Rpb24oZmllbGQsb3BlcmF0b3Ipe3N3aXRjaChvcGVyYXRvci52YWx1ZSl7Y2FzZSfiiIMnOnJldHVybltbZmllbGQubmFtZSwnIT0nLGZhbHNlXV07Y2FzZSfiiIQnOnJldHVybltbZmllbGQubmFtZSwnPScsZmFsc2VdXTtkZWZhdWx0OnJldHVybltbZmllbGQubmFtZSxvcGVyYXRvci52YWx1ZSx0aGlzLmdldF92YWx1ZSgpXV07fX0sc2hvd19pbnB1dHM6ZnVuY3Rpb24oJG9wZXJhdG9yKXt2YXIgJHZhbHVlPXRoaXMuJGVsLnBhcmVudCgpO3N3aXRjaCgkb3BlcmF0b3IudmFsKCkpe2Nhc2Un4oiDJzpjYXNlJ+KIhCc6JHZhbHVlLmhpZGUoKTticmVhaztkZWZhdWx0OiR2YWx1ZS5zaG93KCk7fX0sdG9TdHJpbmc6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXRfdmFsdWUoKTt9fSk7dmFyIENoYXI9RmllbGQuZXh0ZW5kKHt0YWdOYW1lOidpbnB1dCcsY2xhc3NOYW1lOidvX2lucHV0JyxhdHRyaWJ1dGVzOnt0eXBlOid0ZXh0J30sb3BlcmF0b3JzOlt7dmFsdWU6ImlsaWtlIix0ZXh0Ol9sdCgiY29udGFpbnMiKX0se3ZhbHVlOiJub3QgaWxpa2UiLHRleHQ6X2x0KCJkb2Vzbid0IGNvbnRhaW4iKX0se3ZhbHVlOiI9Iix0ZXh0Ol9sdCgiaXMgZXF1YWwgdG8iKX0se3ZhbHVlOiIhPSIsdGV4dDpfbHQoImlzIG5vdCBlcXVhbCB0byIpfSx7dmFsdWU6IuKIgyIsdGV4dDpfbHQoImlzIHNldCIpfSx7dmFsdWU6IuKIhCIsdGV4dDpfbHQoImlzIG5vdCBzZXQiKX1dLGdldF92YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLiRlbC52YWwoKTt9fSk7dmFyIERhdGVUaW1lPUZpZWxkLmV4dGVuZCh7dGFnTmFtZTonc3BhbicsYXR0cmlidXRlczp7dHlwZTonZGF0ZXRpbWUnfSxvcGVyYXRvcnM6W3t2YWx1ZToiYmV0d2VlbiIsdGV4dDpfbHQoImlzIGJldHdlZW4iKX0se3ZhbHVlOiI9Iix0ZXh0Ol9sdCgiaXMgZXF1YWwgdG8iKX0se3ZhbHVlOiIhPSIsdGV4dDpfbHQoImlzIG5vdCBlcXVhbCB0byIpfSx7dmFsdWU6Ij4iLHRleHQ6X2x0KCJpcyBhZnRlciIpfSx7dmFsdWU6IjwiLHRleHQ6X2x0KCJpcyBiZWZvcmUiKX0se3ZhbHVlOiI+PSIsdGV4dDpfbHQoImlzIGFmdGVyIG9yIGVxdWFsIHRvIil9LHt2YWx1ZToiPD0iLHRleHQ6X2x0KCJpcyBiZWZvcmUgb3IgZXF1YWwgdG8iKX0se3ZhbHVlOiLiiIMiLHRleHQ6X2x0KCJpcyBzZXQiKX0se3ZhbHVlOiLiiIQiLHRleHQ6X2x0KCJpcyBub3Qgc2V0Iil9XSxnZXRfdmFsdWU6ZnVuY3Rpb24oaW5kZXgpe3ZhciB2YWx1ZT10aGlzWyJkYXRld2lkZ2V0XyIrKGluZGV4fHwwKV0uZ2V0VmFsdWUoKTtyZXR1cm4gdmFsdWUuYWRkKC10aGlzLmdldFNlc3Npb24oKS5nZXRUWk9mZnNldCh2YWx1ZSksJ21pbnV0ZXMnKTt9LGdldF9kb21haW46ZnVuY3Rpb24oZmllbGQsb3BlcmF0b3Ipe3N3aXRjaChvcGVyYXRvci52YWx1ZSl7Y2FzZSfiiIMnOnJldHVybltbZmllbGQubmFtZSwnIT0nLGZhbHNlXV07Y2FzZSfiiIQnOnJldHVybltbZmllbGQubmFtZSwnPScsZmFsc2VdXTtjYXNlJ2JldHdlZW4nOnJldHVybltbZmllbGQubmFtZSwnPj0nLHRoaXMuZ2V0X3ZhbHVlKCldLFtmaWVsZC5uYW1lLCc8PScsdGhpcy5nZXRfdmFsdWUoMSldXTtkZWZhdWx0OnJldHVybltbZmllbGQubmFtZSxvcGVyYXRvci52YWx1ZSx0aGlzLmdldF92YWx1ZSgpXV07fX0sc2hvd19pbnB1dHM6ZnVuY3Rpb24oJG9wZXJhdG9yKXt0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7aWYoJG9wZXJhdG9yLnZhbCgpPT09ImJldHdlZW4iKXt0aGlzLmRhdGV3aWRnZXRfMS5kb19zaG93KCk7fWVsc2V7dGhpcy5kYXRld2lkZ2V0XzEuZG9faGlkZSgpO319LHRvU3RyaW5nOmZ1bmN0aW9uKCl7dmFyIHN0cj1maWVsZF91dGlscy5mb3JtYXRbdGhpcy5hdHRyaWJ1dGVzLnR5cGVdKHRoaXMuZ2V0X3ZhbHVlKCkse3R5cGU6dGhpcy5hdHRyaWJ1dGVzLnR5cGV9KTt2YXIgZGF0ZV8xX3ZhbHVlPXRoaXMuZGF0ZXdpZGdldF8xJiZ0aGlzLmdldF92YWx1ZSgxKTtpZihkYXRlXzFfdmFsdWUpe3N0cis9X2x0KCIgYW5kICIpK2ZpZWxkX3V0aWxzLmZvcm1hdFt0aGlzLmF0dHJpYnV0ZXMudHlwZV0oZGF0ZV8xX3ZhbHVlLHt0eXBlOnRoaXMuYXR0cmlidXRlcy50eXBlfSk7fQpyZXR1cm4gc3RyO30sc3RhcnQ6ZnVuY3Rpb24oKXtyZXR1cm4gUHJvbWlzZS5hbGwoW3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKSx0aGlzLl9jcmVhdGVfbmV3X3dpZGdldCgiZGF0ZXdpZGdldF8wIiwnMDA6MDA6MDAnLCdoaDptbTpzcycpLHRoaXMuX2NyZWF0ZV9uZXdfd2lkZ2V0KCJkYXRld2lkZ2V0XzEiLCcyMzo1OTo1OScsJ2hoOm1tOnNzJyksXSkudGhlbigoKT0+e2lmKHRoaXMub3BlcmF0b3JzWzBdLnZhbHVlIT09ImJldHdlZW4iKXt0aGlzLmRhdGV3aWRnZXRfMS5kb19oaWRlKCk7fX0pO30sX2NyZWF0ZV9uZXdfd2lkZ2V0OmZ1bmN0aW9uKG5hbWUsLi4udGltZSl7dGhpc1tuYW1lXT1uZXcodGhpcy5fZ2V0X3dpZGdldF9jbGFzcygpKSh0aGlzKTtyZXR1cm4gdGhpc1tuYW1lXS5hcHBlbmRUbyh0aGlzLiRlbCkudGhlbigoZnVuY3Rpb24oKXt0aGlzW25hbWVdLnNldFZhbHVlKG1vbWVudCguLi50aW1lKSk7fSkuYmluZCh0aGlzKSk7fSxfZ2V0X3dpZGdldF9jbGFzczpmdW5jdGlvbigpe3JldHVybiBkYXRlcGlja2VyLkRhdGVUaW1lV2lkZ2V0O30sfSk7dmFyIERhdGU9RGF0ZVRpbWUuZXh0ZW5kKHthdHRyaWJ1dGVzOnt0eXBlOidkYXRlJ30sb3BlcmF0b3JzOlt7dmFsdWU6Ij0iLHRleHQ6X2x0KCJpcyBlcXVhbCB0byIpfSx7dmFsdWU6IiE9Iix0ZXh0Ol9sdCgiaXMgbm90IGVxdWFsIHRvIil9LHt2YWx1ZToiPiIsdGV4dDpfbHQoImlzIGFmdGVyIil9LHt2YWx1ZToiPCIsdGV4dDpfbHQoImlzIGJlZm9yZSIpfSx7dmFsdWU6Ij49Iix0ZXh0Ol9sdCgiaXMgYWZ0ZXIgb3IgZXF1YWwgdG8iKX0se3ZhbHVlOiI8PSIsdGV4dDpfbHQoImlzIGJlZm9yZSBvciBlcXVhbCB0byIpfSx7dmFsdWU6ImJldHdlZW4iLHRleHQ6X2x0KCJpcyBiZXR3ZWVuIil9LHt2YWx1ZToi4oiDIix0ZXh0Ol9sdCgiaXMgc2V0Iil9LHt2YWx1ZToi4oiEIix0ZXh0Ol9sdCgiaXMgbm90IHNldCIpfV0sZ2V0X3ZhbHVlOmZ1bmN0aW9uKGluZGV4KXtyZXR1cm4gdGhpc1siZGF0ZXdpZGdldF8iKyhpbmRleHx8MCldLmdldFZhbHVlKCk7fSxfZ2V0X3dpZGdldF9jbGFzczpmdW5jdGlvbigpe3JldHVybiBkYXRlcGlja2VyLkRhdGVXaWRnZXQ7fSx9KTt2YXIgSW50ZWdlcj1GaWVsZC5leHRlbmQoe3RhZ05hbWU6J2lucHV0JyxjbGFzc05hbWU6J29faW5wdXQnLGF0dHJpYnV0ZXM6e3R5cGU6J251bWJlcicsdmFsdWU6JzAnLH0sb3BlcmF0b3JzOlt7dmFsdWU6Ij0iLHRleHQ6X2x0KCJpcyBlcXVhbCB0byIpfSx7dmFsdWU6IiE9Iix0ZXh0Ol9sdCgiaXMgbm90IGVxdWFsIHRvIil9LHt2YWx1ZToiPiIsdGV4dDpfbHQoImdyZWF0ZXIgdGhhbiIpfSx7dmFsdWU6IjwiLHRleHQ6X2x0KCJsZXNzIHRoYW4iKX0se3ZhbHVlOiI+PSIsdGV4dDpfbHQoImdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byIpfSx7dmFsdWU6Ijw9Iix0ZXh0Ol9sdCgibGVzcyB0aGFuIG9yIGVxdWFsIHRvIil9LHt2YWx1ZToi4oiDIix0ZXh0Ol9sdCgiaXMgc2V0Iil9LHt2YWx1ZToi4oiEIix0ZXh0Ol9sdCgiaXMgbm90IHNldCIpfV0sdG9TdHJpbmc6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy4kZWwudmFsKCk7fSxnZXRfdmFsdWU6ZnVuY3Rpb24oKXt0cnl7dmFyIHZhbD10aGlzLiRlbC52YWwoKTtyZXR1cm4gZmllbGRfdXRpbHMucGFyc2UuaW50ZWdlcih2YWw9PT0iIj8wOnZhbCk7fWNhdGNoKGUpe3JldHVybiIiO319fSk7dmFyIElkPUludGVnZXIuZXh0ZW5kKHtvcGVyYXRvcnM6W3t2YWx1ZToiPSIsdGV4dDpfbHQoImlzIil9XX0pO3ZhciBGbG9hdD1GaWVsZC5leHRlbmQoe3RlbXBsYXRlOidTZWFyY2hWaWV3LmV4dGVuZGVkX3NlYXJjaC5wcm9wb3NpdGlvbi5mbG9hdCcsb3BlcmF0b3JzOlt7dmFsdWU6Ij0iLHRleHQ6X2x0KCJpcyBlcXVhbCB0byIpfSx7dmFsdWU6IiE9Iix0ZXh0Ol9sdCgiaXMgbm90IGVxdWFsIHRvIil9LHt2YWx1ZToiPiIsdGV4dDpfbHQoImdyZWF0ZXIgdGhhbiIpfSx7dmFsdWU6IjwiLHRleHQ6X2x0KCJsZXNzIHRoYW4iKX0se3ZhbHVlOiI+PSIsdGV4dDpfbHQoImdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byIpfSx7dmFsdWU6Ijw9Iix0ZXh0Ol9sdCgibGVzcyB0aGFuIG9yIGVxdWFsIHRvIil9LHt2YWx1ZToi4oiDIix0ZXh0Ol9sdCgiaXMgc2V0Iil9LHt2YWx1ZToi4oiEIix0ZXh0Ol9sdCgiaXMgbm90IHNldCIpfV0saW5pdDpmdW5jdGlvbihwYXJlbnQpe3RoaXMuX3N1cGVyKHBhcmVudCk7dGhpcy5kZWNpbWFsX3BvaW50PV90LmRhdGFiYXNlLnBhcmFtZXRlcnMuZGVjaW1hbF9wb2ludDt9LHRvU3RyaW5nOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuJGVsLnZhbCgpO30sZ2V0X3ZhbHVlOmZ1bmN0aW9uKCl7dHJ5e3ZhciB2YWw9dGhpcy4kZWwudmFsKCk7cmV0dXJuIGZpZWxkX3V0aWxzLnBhcnNlLmZsb2F0KHZhbD09PSIiPzAuMDp2YWwpO31jYXRjaChlKXtyZXR1cm4iIjt9fX0pO3ZhciBTZWxlY3Rpb249RmllbGQuZXh0ZW5kKHt0ZW1wbGF0ZTonU2VhcmNoVmlldy5leHRlbmRlZF9zZWFyY2gucHJvcG9zaXRpb24uc2VsZWN0aW9uJyxvcGVyYXRvcnM6W3t2YWx1ZToiPSIsdGV4dDpfbHQoImlzIil9LHt2YWx1ZToiIT0iLHRleHQ6X2x0KCJpcyBub3QiKX0se3ZhbHVlOiLiiIMiLHRleHQ6X2x0KCJpcyBzZXQiKX0se3ZhbHVlOiLiiIQiLHRleHQ6X2x0KCJpcyBub3Qgc2V0Iil9XSx0b1N0cmluZzpmdW5jdGlvbigpe3ZhciBzZWxlY3Q9dGhpcy4kZWxbMF07dmFyIG9wdGlvbj1zZWxlY3Qub3B0aW9uc1tzZWxlY3Quc2VsZWN0ZWRJbmRleF07cmV0dXJuIG9wdGlvbi5sYWJlbHx8b3B0aW9uLnRleHQ7fSxnZXRfdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy4kZWwudmFsKCk7fX0pO3ZhciBCb29sZWFuPUZpZWxkLmV4dGVuZCh7dGFnTmFtZTonc3Bhbicsb3BlcmF0b3JzOlt7dmFsdWU6Ij0iLHRleHQ6X2x0KCJpcyB0cnVlIil9LHt2YWx1ZToiIT0iLHRleHQ6X2x0KCJpcyBmYWxzZSIpfV0sZ2V0X2xhYmVsOmZ1bmN0aW9uKGZpZWxkLG9wZXJhdG9yKXtyZXR1cm4gdGhpcy5mb3JtYXRfbGFiZWwoX3QoJyUoZmllbGQpcyAlKG9wZXJhdG9yKXMnKSxmaWVsZCxvcGVyYXRvcik7fSxnZXRfdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gdHJ1ZTt9fSk7cmV0dXJue0Jvb2xlYW46Qm9vbGVhbixDaGFyOkNoYXIsRGF0ZTpEYXRlLERhdGVUaW1lOkRhdGVUaW1lLEV4dGVuZGVkU2VhcmNoUHJvcG9zaXRpb246RXh0ZW5kZWRTZWFyY2hQcm9wb3NpdGlvbixGaWVsZDpGaWVsZCxGbG9hdDpGbG9hdCxJZDpJZCxJbnRlZ2VyOkludGVnZXIsU2VsZWN0aW9uOlNlbGVjdGlvbix9O30pOzsKCi8qIC93ZWIvc3RhdGljL3NyYy9qcy92aWV3cy9jb250cm9sX3BhbmVsL3NlYXJjaC9zZWFyY2hfZmlsdGVyc19yZWdpc3RyeS5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwpvZG9vLmRlZmluZSgnd2ViLnNlYXJjaF9maWx0ZXJzX3JlZ2lzdHJ5JyxmdW5jdGlvbihyZXF1aXJlKXsidXNlIHN0cmljdCI7dmFyIFJlZ2lzdHJ5PXJlcXVpcmUoJ3dlYi5SZWdpc3RyeScpO3JldHVybiBuZXcgUmVnaXN0cnkoKTt9KTtvZG9vLmRlZmluZSgnd2ViLl9zZWFyY2hfZmlsdGVyc19yZWdpc3RyeScsZnVuY3Rpb24ocmVxdWlyZSl7InVzZSBzdHJpY3QiO3ZhciByZWdpc3RyeT1yZXF1aXJlKCd3ZWIuc2VhcmNoX2ZpbHRlcnNfcmVnaXN0cnknKTt2YXIgc2VhcmNoX2ZpbHRlcnM9cmVxdWlyZSgnd2ViLnNlYXJjaF9maWx0ZXJzJyk7cmVnaXN0cnkuYWRkKCdib29sZWFuJyxzZWFyY2hfZmlsdGVycy5Cb29sZWFuKS5hZGQoJ2NoYXInLHNlYXJjaF9maWx0ZXJzLkNoYXIpLmFkZCgnZGF0ZScsc2VhcmNoX2ZpbHRlcnMuRGF0ZSkuYWRkKCdkYXRldGltZScsc2VhcmNoX2ZpbHRlcnMuRGF0ZVRpbWUpLmFkZCgnZmxvYXQnLHNlYXJjaF9maWx0ZXJzLkZsb2F0KS5hZGQoJ2lkJyxzZWFyY2hfZmlsdGVycy5JZCkuYWRkKCdpbnRlZ2VyJyxzZWFyY2hfZmlsdGVycy5JbnRlZ2VyKS5hZGQoJ21hbnkybWFueScsc2VhcmNoX2ZpbHRlcnMuQ2hhcikuYWRkKCdtYW55Mm9uZScsc2VhcmNoX2ZpbHRlcnMuQ2hhcikuYWRkKCdtb25ldGFyeScsc2VhcmNoX2ZpbHRlcnMuRmxvYXQpLmFkZCgnb25lMm1hbnknLHNlYXJjaF9maWx0ZXJzLkNoYXIpLmFkZCgndGV4dCcsc2VhcmNoX2ZpbHRlcnMuQ2hhcikuYWRkKCdzZWxlY3Rpb24nLHNlYXJjaF9maWx0ZXJzLlNlbGVjdGlvbik7fSk7OwoKLyogL3dlYi9zdGF0aWMvc3JjL2pzL3ZpZXdzL3NlYXJjaF9wYW5lbC5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwpvZG9vLmRlZmluZSgnd2ViLlNlYXJjaFBhbmVsJyxmdW5jdGlvbihyZXF1aXJlKXsidXNlIHN0cmljdCI7dmFyIGNvcmU9cmVxdWlyZSgnd2ViLmNvcmUnKTt2YXIgRG9tYWluPXJlcXVpcmUoJ3dlYi5Eb21haW4nKTt2YXIgcHlVdGlscz1yZXF1aXJlKCd3ZWIucHlfdXRpbHMnKTt2YXIgdmlld1V0aWxzPXJlcXVpcmUoJ3dlYi52aWV3VXRpbHMnKTt2YXIgV2lkZ2V0PXJlcXVpcmUoJ3dlYi5XaWRnZXQnKTt2YXIgcXdlYj1jb3JlLnF3ZWI7dmFyIGRlZmF1bHRWaWV3VHlwZXM9WydrYW5iYW4nLCd0cmVlJ107ZnVuY3Rpb24gX3Byb2Nlc3NTZWFyY2hQYW5lbE5vZGUobm9kZSxmaWVsZHMpe3ZhciBzZWN0aW9ucz17fTtub2RlLmNoaWxkcmVuLmZvckVhY2goKGNoaWxkTm9kZSxpbmRleCk9PntpZihjaGlsZE5vZGUudGFnIT09J2ZpZWxkJyl7cmV0dXJuO30KaWYoY2hpbGROb2RlLmF0dHJzLmludmlzaWJsZT09PSIxIil7cmV0dXJuO30KdmFyIGZpZWxkTmFtZT1jaGlsZE5vZGUuYXR0cnMubmFtZTt2YXIgdHlwZT1jaGlsZE5vZGUuYXR0cnMuc2VsZWN0PT09J211bHRpJz8nZmlsdGVyJzonY2F0ZWdvcnknO3ZhciBzZWN0aW9uSWQ9Xy51bmlxdWVJZCgnc2VjdGlvbl8nKTt2YXIgc2VjdGlvbj17Y29sb3I6Y2hpbGROb2RlLmF0dHJzLmNvbG9yLGRlc2NyaXB0aW9uOmNoaWxkTm9kZS5hdHRycy5zdHJpbmd8fGZpZWxkc1tmaWVsZE5hbWVdLnN0cmluZyxmaWVsZE5hbWU6ZmllbGROYW1lLGljb246Y2hpbGROb2RlLmF0dHJzLmljb24saWQ6c2VjdGlvbklkLGluZGV4OmluZGV4LHR5cGU6dHlwZSx9O2lmKHNlY3Rpb24udHlwZT09PSdjYXRlZ29yeScpe3NlY3Rpb24uaWNvbj1zZWN0aW9uLmljb258fCdmYS1mb2xkZXInO31lbHNlIGlmKHNlY3Rpb24udHlwZT09PSdmaWx0ZXInKXtzZWN0aW9uLmRpc2FibGVDb3VudGVycz0hIXB5VXRpbHMucHlfZXZhbChjaGlsZE5vZGUuYXR0cnMuZGlzYWJsZV9jb3VudGVyc3x8JzAnKTtzZWN0aW9uLmRvbWFpbj1jaGlsZE5vZGUuYXR0cnMuZG9tYWlufHwnW10nO3NlY3Rpb24uZ3JvdXBCeT1jaGlsZE5vZGUuYXR0cnMuZ3JvdXBieTtzZWN0aW9uLmljb249c2VjdGlvbi5pY29ufHwnZmEtZmlsdGVyJzt9CnNlY3Rpb25zW3NlY3Rpb25JZF09c2VjdGlvbjt9KTtyZXR1cm4gc2VjdGlvbnM7fQp2YXIgU2VhcmNoUGFuZWw9V2lkZ2V0LmV4dGVuZCh7Y2xhc3NOYW1lOidvX3NlYXJjaF9wYW5lbCcsZXZlbnRzOnsnY2xpY2sgLm9fc2VhcmNoX3BhbmVsX2NhdGVnb3J5X3ZhbHVlIGhlYWRlcic6J19vbkNhdGVnb3J5VmFsdWVDbGlja2VkJywnY2xpY2sgLm9fc2VhcmNoX3BhbmVsX2NhdGVnb3J5X3ZhbHVlIC5vX3RvZ2dsZV9mb2xkJzonX29uVG9nZ2xlRm9sZENhdGVnb3J5JywnY2xpY2sgLm9fc2VhcmNoX3BhbmVsX2ZpbHRlcl9ncm91cCAub190b2dnbGVfZm9sZCc6J19vblRvZ2dsZUZvbGRGaWx0ZXJHcm91cCcsJ2NoYW5nZSAub19zZWFyY2hfcGFuZWxfZmlsdGVyX3ZhbHVlID4gZGl2ID4gaW5wdXQnOidfb25GaWx0ZXJWYWx1ZUNoYW5nZWQnLCdjaGFuZ2UgLm9fc2VhcmNoX3BhbmVsX2ZpbHRlcl9ncm91cCA+IGRpdiA+IGlucHV0JzonX29uRmlsdGVyR3JvdXBDaGFuZ2VkJyx9LGluaXQ6ZnVuY3Rpb24ocGFyZW50LHBhcmFtcyl7dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3RoaXMuY2F0ZWdvcmllcz1fLnBpY2socGFyYW1zLnNlY3Rpb25zLGZ1bmN0aW9uKHNlY3Rpb24pe3JldHVybiBzZWN0aW9uLnR5cGU9PT0nY2F0ZWdvcnknO30pO3RoaXMuZmlsdGVycz1fLnBpY2socGFyYW1zLnNlY3Rpb25zLGZ1bmN0aW9uKHNlY3Rpb24pe3JldHVybiBzZWN0aW9uLnR5cGU9PT0nZmlsdGVyJzt9KTt0aGlzLmluaXRpYWxTdGF0ZT1wYXJhbXMuc3RhdGU7dGhpcy5zY3JvbGxUb3A9dGhpcy5pbml0aWFsU3RhdGUmJnRoaXMuaW5pdGlhbFN0YXRlLnNjcm9sbFRvcHx8bnVsbDt0aGlzLmRlZmF1bHRWYWx1ZXM9cGFyYW1zLmRlZmF1bHRWYWx1ZXN8fHt9O2lmKHBhcmFtcy5kZWZhdWx0Tm9GaWx0ZXIpe09iamVjdC5rZXlzKHRoaXMuY2F0ZWdvcmllcykuZm9yRWFjaCgoY2F0ZWdvcnlJZCk9Pnt2YXIgZmllbGROYW1lPXRoaXMuY2F0ZWdvcmllc1tjYXRlZ29yeUlkXS5maWVsZE5hbWU7dGhpcy5kZWZhdWx0VmFsdWVzW2ZpZWxkTmFtZV09dGhpcy5kZWZhdWx0VmFsdWVzW2ZpZWxkTmFtZV18fGZhbHNlO30pO30KdGhpcy5maWVsZHM9cGFyYW1zLmZpZWxkczt0aGlzLm1vZGVsPXBhcmFtcy5tb2RlbDt0aGlzLmNsYXNzTmFtZT1wYXJhbXMuY2xhc3Nlcy5jb25jYXQoWydvX3NlYXJjaF9wYW5lbCddKS5qb2luKCcgJyk7dGhpcy5zZWFyY2hEb21haW49cGFyYW1zLnNlYXJjaERvbWFpbjt9LHdpbGxTdGFydDpmdW5jdGlvbigpe3ZhciBzZWxmPXRoaXM7dmFyIGxvYWRDYXRlZ29yaWVzUHJvbTtpZih0aGlzLmluaXRpYWxTdGF0ZSl7dGhpcy5maWx0ZXJzPXRoaXMuaW5pdGlhbFN0YXRlLmZpbHRlcnM7dGhpcy5jYXRlZ29yaWVzPXRoaXMuaW5pdGlhbFN0YXRlLmNhdGVnb3JpZXM7fWVsc2V7bG9hZENhdGVnb3JpZXNQcm9tPXRoaXMuX2ZldGNoQ2F0ZWdvcmllcygpLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gc2VsZi5fZmV0Y2hGaWx0ZXJzKCkudGhlbihzZWxmLl9hcHBseURlZmF1bHRGaWx0ZXJWYWx1ZXMuYmluZChzZWxmKSk7fSk7fQpyZXR1cm4gUHJvbWlzZS5hbGwoW2xvYWRDYXRlZ29yaWVzUHJvbSx0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyldKTt9LHN0YXJ0OmZ1bmN0aW9uKCl7dGhpcy5fcmVuZGVyKCk7cmV0dXJuIHRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9LG9uX2F0dGFjaF9jYWxsYmFjazpmdW5jdGlvbigpe2lmKHRoaXMuc2Nyb2xsVG9wIT09bnVsbCl7dGhpcy5lbC5zY3JvbGxUb3A9dGhpcy5zY3JvbGxUb3A7fX0sY29tcHV0ZVNlYXJjaFBhbmVsUGFyYW1zOmZ1bmN0aW9uKHZpZXdJbmZvLHZpZXdUeXBlKXt2YXIgc2VhcmNoUGFuZWxTZWN0aW9uczt2YXIgY2xhc3NlcztpZih2aWV3SW5mbyl7dmFyIGFyY2g9dmlld1V0aWxzLnBhcnNlQXJjaCh2aWV3SW5mby5hcmNoKTt2aWV3VHlwZT12aWV3VHlwZT09PSdsaXN0Jz8ndHJlZSc6dmlld1R5cGU7YXJjaC5jaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uKG5vZGUpe2lmKG5vZGUudGFnPT09J3NlYXJjaHBhbmVsJyl7dmFyIGF0dHJzPW5vZGUuYXR0cnM7dmFyIHZpZXdUeXBlcz1kZWZhdWx0Vmlld1R5cGVzO2lmKGF0dHJzLnZpZXdfdHlwZXMpe3ZpZXdUeXBlcz1hdHRycy52aWV3X3R5cGVzLnNwbGl0KCcsJyk7fQppZihhdHRycy5jbGFzcyl7Y2xhc3Nlcz1hdHRycy5jbGFzcy5zcGxpdCgnICcpO30KaWYodmlld1R5cGVzLmluZGV4T2Yodmlld1R5cGUpIT09LTEpe3NlYXJjaFBhbmVsU2VjdGlvbnM9X3Byb2Nlc3NTZWFyY2hQYW5lbE5vZGUobm9kZSx2aWV3SW5mby5maWVsZHMpO319fSk7fQpyZXR1cm57c2VjdGlvbnM6c2VhcmNoUGFuZWxTZWN0aW9ucyxjbGFzc2VzOmNsYXNzZXMsfTt9LGV4cG9ydFN0YXRlOmZ1bmN0aW9uKCl7cmV0dXJue2NhdGVnb3JpZXM6dGhpcy5jYXRlZ29yaWVzLGZpbHRlcnM6dGhpcy5maWx0ZXJzLHNjcm9sbFRvcDp0aGlzLmVsP3RoaXMuZWwuc2Nyb2xsVG9wOm51bGwsfTt9LGdldERvbWFpbjpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9nZXRDYXRlZ29yeURvbWFpbigpLmNvbmNhdCh0aGlzLl9nZXRGaWx0ZXJEb21haW4oKSk7fSxpbXBvcnRTdGF0ZTpmdW5jdGlvbihzdGF0ZSl7dGhpcy5jYXRlZ29yaWVzPXN0YXRlLmNhdGVnb3JpZXN8fHRoaXMuY2F0ZWdvcmllczt0aGlzLmZpbHRlcnM9c3RhdGUuZmlsdGVyc3x8dGhpcy5maWx0ZXJzO3RoaXMuc2Nyb2xsVG9wPXN0YXRlLnNjcm9sbFRvcDt0aGlzLl9yZW5kZXIoKTt9LHVwZGF0ZTpmdW5jdGlvbihwYXJhbXMpe3ZhciBjdXJyZW50U2VhcmNoRG9tYWluU3RyPUpTT04uc3RyaW5naWZ5KHRoaXMuc2VhcmNoRG9tYWluKTt2YXIgbmV3U2VhcmNoRG9tYWluU3RyPUpTT04uc3RyaW5naWZ5KHBhcmFtcy5zZWFyY2hEb21haW4pO3ZhciBmaWx0ZXJzUHJvbTtpZih0aGlzLm5lZWRSZWxvYWR8fChjdXJyZW50U2VhcmNoRG9tYWluU3RyIT09bmV3U2VhcmNoRG9tYWluU3RyKSl7dGhpcy5uZWVkUmVsb2FkPWZhbHNlO3RoaXMuc2VhcmNoRG9tYWluPXBhcmFtcy5zZWFyY2hEb21haW47ZmlsdGVyc1Byb209dGhpcy5fZmV0Y2hGaWx0ZXJzKCk7fQpyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGZpbHRlcnNQcm9tKS50aGVuKHRoaXMuX3JlbmRlci5iaW5kKHRoaXMpKTt9LF9hcHBseURlZmF1bHRGaWx0ZXJWYWx1ZXM6ZnVuY3Rpb24oKXt2YXIgc2VsZj10aGlzO09iamVjdC5rZXlzKHRoaXMuZmlsdGVycykuZm9yRWFjaChmdW5jdGlvbihmaWx0ZXJJZCl7dmFyIGZpbHRlcj1zZWxmLmZpbHRlcnNbZmlsdGVySWRdO3ZhciBkZWZhdWx0VmFsdWVzPXNlbGYuZGVmYXVsdFZhbHVlc1tmaWx0ZXIuZmllbGROYW1lXXx8W107ZGVmYXVsdFZhbHVlcy5mb3JFYWNoKGZ1bmN0aW9uKHZhbHVlKXtpZihmaWx0ZXIudmFsdWVzW3ZhbHVlXSl7ZmlsdGVyLnZhbHVlc1t2YWx1ZV0uY2hlY2tlZD10cnVlO319KTtPYmplY3Qua2V5cyhmaWx0ZXIuZ3JvdXBzfHxbXSkuZm9yRWFjaChmdW5jdGlvbihncm91cElkKXtzZWxmLl91cGRhdGVGaWx0ZXJHcm91cFN0YXRlKGZpbHRlci5ncm91cHNbZ3JvdXBJZF0pO30pO30pO30sX2NyZWF0ZUNhdGVnb3J5VHJlZTpmdW5jdGlvbihjYXRlZ29yeUlkLHZhbHVlcyl7dmFyIGNhdGVnb3J5PXRoaXMuY2F0ZWdvcmllc1tjYXRlZ29yeUlkXTt2YXIgcGFyZW50RmllbGQ9Y2F0ZWdvcnkucGFyZW50RmllbGQ7Y2F0ZWdvcnkudmFsdWVzPXt9O18uZWFjaCh2YWx1ZXMsZnVuY3Rpb24odmFsdWUpe2NhdGVnb3J5LnZhbHVlc1t2YWx1ZS5pZF09Xy5leHRlbmQoe30sdmFsdWUse2NoaWxkcmVuSWRzOltdLGZvbGRlZDp0cnVlLHBhcmVudElkOnZhbHVlW3BhcmVudEZpZWxkXSYmdmFsdWVbcGFyZW50RmllbGRdWzBdfHxmYWxzZSx9KTt9KTtfLm1hcCh2YWx1ZXMsZnVuY3Rpb24odmFsdWUpe3ZhciB2YWx1ZT1jYXRlZ29yeS52YWx1ZXNbdmFsdWUuaWRdO3ZhciBwYXJlbnRDYXRlZ29yeUlkPXZhbHVlLnBhcmVudElkO2lmKHBhcmVudENhdGVnb3J5SWQmJnBhcmVudENhdGVnb3J5SWQgaW4gY2F0ZWdvcnkudmFsdWVzKXtjYXRlZ29yeS52YWx1ZXNbcGFyZW50Q2F0ZWdvcnlJZF0uY2hpbGRyZW5JZHMucHVzaCh2YWx1ZS5pZCk7fX0pO2NhdGVnb3J5LnJvb3RJZHM9Xy5maWx0ZXIoXy5tYXAodmFsdWVzLGZ1bmN0aW9uKHZhbHVlKXtyZXR1cm4gdmFsdWUuaWQ7fSksZnVuY3Rpb24odmFsdWVJZCl7dmFyIHZhbHVlPWNhdGVnb3J5LnZhbHVlc1t2YWx1ZUlkXTtyZXR1cm4gdmFsdWUucGFyZW50SWQ9PT1mYWxzZTt9KTt2YXIgdmFsaWRWYWx1ZXM9Xy5wbHVjayhjYXRlZ29yeS52YWx1ZXMsJ2lkJykuY29uY2F0KFtmYWxzZV0pO3ZhciB2YWx1ZT10aGlzLl9nZXRDYXRlZ29yeURlZmF1bHRWYWx1ZShjYXRlZ29yeSx2YWxpZFZhbHVlcyk7Y2F0ZWdvcnkuYWN0aXZlVmFsdWVJZD1fLmNvbnRhaW5zKHZhbGlkVmFsdWVzLHZhbHVlKT92YWx1ZTpmYWxzZTtpZihjYXRlZ29yeS5hY3RpdmVWYWx1ZUlkKXt2YXIgcGFyZW50VmFsdWVJZHM9dGhpcy5fZ2V0QW5jZXN0b3JWYWx1ZUlkcyhjYXRlZ29yeSxjYXRlZ29yeS5hY3RpdmVWYWx1ZUlkKTtwYXJlbnRWYWx1ZUlkcy5mb3JFYWNoKGZ1bmN0aW9uKHBhcmVudFZhbHVlKXtjYXRlZ29yeS52YWx1ZXNbcGFyZW50VmFsdWVdLmZvbGRlZD1mYWxzZTt9KTt9fSxfY3JlYXRlRmlsdGVyVHJlZTpmdW5jdGlvbihmaWx0ZXJJZCx2YWx1ZXMpe3ZhciBmaWx0ZXI9dGhpcy5maWx0ZXJzW2ZpbHRlcklkXTt2YWx1ZXMuZm9yRWFjaChmdW5jdGlvbih2YWx1ZSl7dmFyIG9sZFZhbHVlPWZpbHRlci52YWx1ZXMmJmZpbHRlci52YWx1ZXNbdmFsdWUuaWRdO3ZhbHVlLmNoZWNrZWQ9b2xkVmFsdWUmJm9sZFZhbHVlLmNoZWNrZWR8fGZhbHNlO30pO2ZpbHRlci52YWx1ZXM9e307dmFyIGdyb3VwSWRzPVtdO2lmKGZpbHRlci5ncm91cEJ5KXt2YXIgZ3JvdXBzPXt9O3ZhbHVlcy5mb3JFYWNoKGZ1bmN0aW9uKHZhbHVlKXt2YXIgZ3JvdXBJZD12YWx1ZS5ncm91cF9pZDtpZighZ3JvdXBzW2dyb3VwSWRdKXtpZihncm91cElkKXtncm91cElkcy5wdXNoKGdyb3VwSWQpO30KZ3JvdXBzW2dyb3VwSWRdPXtmb2xkZWQ6ZmFsc2UsaWQ6Z3JvdXBJZCxuYW1lOnZhbHVlLmdyb3VwX25hbWUsdmFsdWVzOnt9LHRvb2x0aXA6dmFsdWUuZ3JvdXBfdG9vbHRpcCxzZXF1ZW5jZTp2YWx1ZS5ncm91cF9zZXF1ZW5jZSxoZXhfY29sb3I6dmFsdWUuZ3JvdXBfaGV4X2NvbG9yLHNvcnRlZFZhbHVlSWRzOltdLH07dmFyIG9sZEdyb3VwPWZpbHRlci5ncm91cHMmJmZpbHRlci5ncm91cHNbZ3JvdXBJZF07Z3JvdXBzW2dyb3VwSWRdLnN0YXRlPW9sZEdyb3VwJiZvbGRHcm91cC5zdGF0ZXx8ZmFsc2U7Z3JvdXBzW2dyb3VwSWRdLmZvbGRlZD1vbGRHcm91cCYmb2xkR3JvdXAuZm9sZGVkfHxmYWxzZTt9Cmdyb3Vwc1tncm91cElkXS52YWx1ZXNbdmFsdWUuaWRdPXZhbHVlO2dyb3Vwc1tncm91cElkXS5zb3J0ZWRWYWx1ZUlkcy5wdXNoKHZhbHVlLmlkKTt9KTtmaWx0ZXIuZ3JvdXBzPWdyb3VwcztmaWx0ZXIuc29ydGVkR3JvdXBJZHM9Xy5zb3J0QnkoZ3JvdXBJZHMsZnVuY3Rpb24oZ3JvdXBJZCl7cmV0dXJuIGdyb3Vwc1tncm91cElkXS5zZXF1ZW5jZXx8Z3JvdXBzW2dyb3VwSWRdLm5hbWU7fSk7T2JqZWN0LmtleXMoZmlsdGVyLmdyb3VwcykuZm9yRWFjaChmdW5jdGlvbihncm91cElkKXtmaWx0ZXIudmFsdWVzPV8uZXh0ZW5kKGZpbHRlci52YWx1ZXMsZmlsdGVyLmdyb3Vwc1tncm91cElkXS52YWx1ZXMpO30pO31lbHNle3ZhbHVlcy5mb3JFYWNoKGZ1bmN0aW9uKHZhbHVlKXtmaWx0ZXIudmFsdWVzW3ZhbHVlLmlkXT12YWx1ZTt9KTtmaWx0ZXIuc29ydGVkVmFsdWVJZHM9dmFsdWVzLm1hcChmdW5jdGlvbih2YWx1ZSl7cmV0dXJuIHZhbHVlLmlkO30pO319LF9mZXRjaENhdGVnb3JpZXM6ZnVuY3Rpb24oKXt2YXIgc2VsZj10aGlzO3ZhciBwcm9tcz1PYmplY3Qua2V5cyh0aGlzLmNhdGVnb3JpZXMpLm1hcChmdW5jdGlvbihjYXRlZ29yeUlkKXt2YXIgY2F0ZWdvcnk9c2VsZi5jYXRlZ29yaWVzW2NhdGVnb3J5SWRdO3ZhciBmaWVsZD1zZWxmLmZpZWxkc1tjYXRlZ29yeS5maWVsZE5hbWVdO3ZhciBjYXRlZ29yaWVzUHJvbTtpZihmaWVsZC50eXBlPT09J3NlbGVjdGlvbicpe3ZhciB2YWx1ZXM9ZmllbGQuc2VsZWN0aW9uLm1hcChmdW5jdGlvbih2YWx1ZSl7cmV0dXJue2lkOnZhbHVlWzBdLGRpc3BsYXlfbmFtZTp2YWx1ZVsxXX07fSk7Y2F0ZWdvcmllc1Byb209UHJvbWlzZS5yZXNvbHZlKHZhbHVlcyk7fWVsc2V7Y2F0ZWdvcmllc1Byb209c2VsZi5fcnBjKHttZXRob2Q6J3NlYXJjaF9wYW5lbF9zZWxlY3RfcmFuZ2UnLG1vZGVsOnNlbGYubW9kZWwsYXJnczpbY2F0ZWdvcnkuZmllbGROYW1lXSx9KS50aGVuKGZ1bmN0aW9uKHJlc3VsdCl7Y2F0ZWdvcnkucGFyZW50RmllbGQ9cmVzdWx0LnBhcmVudF9maWVsZDtyZXR1cm4gcmVzdWx0LnZhbHVlczt9KTt9CnJldHVybiBjYXRlZ29yaWVzUHJvbS50aGVuKGZ1bmN0aW9uKHZhbHVlcyl7c2VsZi5fY3JlYXRlQ2F0ZWdvcnlUcmVlKGNhdGVnb3J5SWQsdmFsdWVzKTt9KTt9KTtyZXR1cm4gUHJvbWlzZS5hbGwocHJvbXMpO30sX2ZldGNoRmlsdGVyczpmdW5jdGlvbigpe3ZhciBzZWxmPXRoaXM7dmFyIGV2YWxDb250ZXh0PXt9O09iamVjdC5rZXlzKHRoaXMuY2F0ZWdvcmllcykuZm9yRWFjaChmdW5jdGlvbihjYXRlZ29yeUlkKXt2YXIgY2F0ZWdvcnk9c2VsZi5jYXRlZ29yaWVzW2NhdGVnb3J5SWRdO2V2YWxDb250ZXh0W2NhdGVnb3J5LmZpZWxkTmFtZV09Y2F0ZWdvcnkuYWN0aXZlVmFsdWVJZDt9KTt2YXIgY2F0ZWdvcnlEb21haW49dGhpcy5fZ2V0Q2F0ZWdvcnlEb21haW4oKTt2YXIgZmlsdGVyRG9tYWluPXRoaXMuX2dldEZpbHRlckRvbWFpbigpO3ZhciBwcm9tcz1PYmplY3Qua2V5cyh0aGlzLmZpbHRlcnMpLm1hcChmdW5jdGlvbihmaWx0ZXJJZCl7dmFyIGZpbHRlcj1zZWxmLmZpbHRlcnNbZmlsdGVySWRdO3JldHVybiBzZWxmLl9ycGMoe21ldGhvZDonc2VhcmNoX3BhbmVsX3NlbGVjdF9tdWx0aV9yYW5nZScsbW9kZWw6c2VsZi5tb2RlbCxhcmdzOltmaWx0ZXIuZmllbGROYW1lXSxrd2FyZ3M6e2NhdGVnb3J5X2RvbWFpbjpjYXRlZ29yeURvbWFpbixjb21vZGVsX2RvbWFpbjpEb21haW4ucHJvdG90eXBlLnN0cmluZ1RvQXJyYXkoZmlsdGVyLmRvbWFpbixldmFsQ29udGV4dCksZGlzYWJsZV9jb3VudGVyczpmaWx0ZXIuZGlzYWJsZUNvdW50ZXJzLGZpbHRlcl9kb21haW46ZmlsdGVyRG9tYWluLGdyb3VwX2J5OmZpbHRlci5ncm91cEJ5fHxmYWxzZSxzZWFyY2hfZG9tYWluOnNlbGYuc2VhcmNoRG9tYWluLH0sfSkudGhlbihmdW5jdGlvbih2YWx1ZXMpe3NlbGYuX2NyZWF0ZUZpbHRlclRyZWUoZmlsdGVySWQsdmFsdWVzKTt9KTt9KTtyZXR1cm4gUHJvbWlzZS5hbGwocHJvbXMpO30sX2dldENhdGVnb3J5RGVmYXVsdFZhbHVlOmZ1bmN0aW9uKGNhdGVnb3J5LHZhbGlkVmFsdWVzKXt2YXIgdmFsdWU9dGhpcy5kZWZhdWx0VmFsdWVzW2NhdGVnb3J5LmZpZWxkTmFtZV07aWYoIV8uY29udGFpbnModmFsaWRWYWx1ZXMsdmFsdWUpKXt2YXIgc3RvcmFnZUtleT10aGlzLl9nZXRMb2NhbFN0b3JhZ2VLZXkoY2F0ZWdvcnkpO3JldHVybiB0aGlzLmNhbGwoJ2xvY2FsX3N0b3JhZ2UnLCdnZXRJdGVtJyxzdG9yYWdlS2V5KTt9CnJldHVybiB2YWx1ZTt9LF9nZXRDYXRlZ29yeURvbWFpbjpmdW5jdGlvbigpe3ZhciBzZWxmPXRoaXM7ZnVuY3Rpb24gY2F0ZWdvcnlUb0RvbWFpbihkb21haW4sY2F0ZWdvcnlJZCl7dmFyIGNhdGVnb3J5PXNlbGYuY2F0ZWdvcmllc1tjYXRlZ29yeUlkXTtpZihjYXRlZ29yeS5hY3RpdmVWYWx1ZUlkKXt2YXIgZmllbGQ9c2VsZi5maWVsZHNbY2F0ZWdvcnkuZmllbGROYW1lXTt2YXIgb3A9KGZpZWxkLnR5cGU9PT0nbWFueTJvbmUnJiZjYXRlZ29yeS5wYXJlbnRGaWVsZCk/J2NoaWxkX29mJzonPSc7ZG9tYWluLnB1c2goW2NhdGVnb3J5LmZpZWxkTmFtZSxvcCxjYXRlZ29yeS5hY3RpdmVWYWx1ZUlkXSk7fQpyZXR1cm4gZG9tYWluO30KcmV0dXJuIE9iamVjdC5rZXlzKHRoaXMuY2F0ZWdvcmllcykucmVkdWNlKGNhdGVnb3J5VG9Eb21haW4sW10pO30sX2dldEZpbHRlckRvbWFpbjpmdW5jdGlvbigpe3ZhciBzZWxmPXRoaXM7ZnVuY3Rpb24gZ2V0Q2hlY2tlZFZhbHVlSWRzKHZhbHVlcyl7cmV0dXJuIE9iamVjdC5rZXlzKHZhbHVlcykucmVkdWNlKGZ1bmN0aW9uKGNoZWNrZWRWYWx1ZXMsdmFsdWVJZCl7aWYodmFsdWVzW3ZhbHVlSWRdLmNoZWNrZWQpe2NoZWNrZWRWYWx1ZXMucHVzaCh2YWx1ZXNbdmFsdWVJZF0uaWQpO30KcmV0dXJuIGNoZWNrZWRWYWx1ZXM7fSxbXSk7fQpmdW5jdGlvbiBmaWx0ZXJUb0RvbWFpbihkb21haW4sZmlsdGVySWQpe3ZhciBmaWx0ZXI9c2VsZi5maWx0ZXJzW2ZpbHRlcklkXTtpZihmaWx0ZXIuZ3JvdXBzKXtPYmplY3Qua2V5cyhmaWx0ZXIuZ3JvdXBzKS5mb3JFYWNoKGZ1bmN0aW9uKGdyb3VwSWQpe3ZhciBncm91cD1maWx0ZXIuZ3JvdXBzW2dyb3VwSWRdO3ZhciBjaGVja2VkVmFsdWVzPWdldENoZWNrZWRWYWx1ZUlkcyhncm91cC52YWx1ZXMpO2lmKGNoZWNrZWRWYWx1ZXMubGVuZ3RoKXtkb21haW4ucHVzaChbZmlsdGVyLmZpZWxkTmFtZSwnaW4nLGNoZWNrZWRWYWx1ZXNdKTt9fSk7fWVsc2UgaWYoZmlsdGVyLnZhbHVlcyl7dmFyIGNoZWNrZWRWYWx1ZXM9Z2V0Q2hlY2tlZFZhbHVlSWRzKGZpbHRlci52YWx1ZXMpO2lmKGNoZWNrZWRWYWx1ZXMubGVuZ3RoKXtkb21haW4ucHVzaChbZmlsdGVyLmZpZWxkTmFtZSwnaW4nLGNoZWNrZWRWYWx1ZXNdKTt9fQpyZXR1cm4gZG9tYWluO30KcmV0dXJuIE9iamVjdC5rZXlzKHRoaXMuZmlsdGVycykucmVkdWNlKGZpbHRlclRvRG9tYWluLFtdKTt9LF9nZXRMb2NhbFN0b3JhZ2VLZXk6ZnVuY3Rpb24oY2F0ZWdvcnkpe3JldHVybidzZWFyY2hwYW5lbF8nK3RoaXMubW9kZWwrJ18nK2NhdGVnb3J5LmZpZWxkTmFtZTt9LF9nZXRBbmNlc3RvclZhbHVlSWRzOmZ1bmN0aW9uKGNhdGVnb3J5LGNhdGVnb3J5VmFsdWVJZCl7dmFyIGNhdGVnb3J5VmFsdWU9Y2F0ZWdvcnkudmFsdWVzW2NhdGVnb3J5VmFsdWVJZF07dmFyIHBhcmVudElkPWNhdGVnb3J5VmFsdWUucGFyZW50SWQ7aWYocGFyZW50SWQpe3JldHVybltwYXJlbnRJZF0uY29uY2F0KHRoaXMuX2dldEFuY2VzdG9yVmFsdWVJZHMoY2F0ZWdvcnkscGFyZW50SWQpKTt9CnJldHVybltdO30sX25vdGlmeURvbWFpblVwZGF0ZWQ6ZnVuY3Rpb24oKXt0aGlzLm5lZWRSZWxvYWQ9dHJ1ZTt0aGlzLnRyaWdnZXJfdXAoJ3NlYXJjaF9wYW5lbF9kb21haW5fdXBkYXRlZCcse2RvbWFpbjp0aGlzLmdldERvbWFpbigpLH0pO30sX3JlbmRlcjpmdW5jdGlvbigpe3ZhciBzZWxmPXRoaXM7dGhpcy4kZWwuZW1wdHkoKTt2YXIgY2F0ZWdvcmllcz1PYmplY3Qua2V5cyh0aGlzLmNhdGVnb3JpZXMpLm1hcChmdW5jdGlvbihjYXRlZ29yeUlkKXtyZXR1cm4gc2VsZi5jYXRlZ29yaWVzW2NhdGVnb3J5SWRdO30pO3ZhciBmaWx0ZXJzPU9iamVjdC5rZXlzKHRoaXMuZmlsdGVycykubWFwKGZ1bmN0aW9uKGZpbHRlcklkKXtyZXR1cm4gc2VsZi5maWx0ZXJzW2ZpbHRlcklkXTt9KTt2YXIgc2VjdGlvbnM9Y2F0ZWdvcmllcy5jb25jYXQoZmlsdGVycykuc29ydChmdW5jdGlvbihzMSxzMil7cmV0dXJuIHMxLmluZGV4LXMyLmluZGV4O30pO3NlY3Rpb25zLmZvckVhY2goZnVuY3Rpb24oc2VjdGlvbil7aWYoT2JqZWN0LmtleXMoc2VjdGlvbi52YWx1ZXMpLmxlbmd0aCl7aWYoc2VjdGlvbi50eXBlPT09J2NhdGVnb3J5Jyl7c2VsZi4kZWwuYXBwZW5kKHNlbGYuX3JlbmRlckNhdGVnb3J5KHNlY3Rpb24pKTt9ZWxzZXtzZWxmLiRlbC5hcHBlbmQoc2VsZi5fcmVuZGVyRmlsdGVyKHNlY3Rpb24pKTt9fX0pO30sX3JlbmRlckNhdGVnb3J5OmZ1bmN0aW9uKGNhdGVnb3J5KXtyZXR1cm4gcXdlYi5yZW5kZXIoJ1NlYXJjaFBhbmVsLkNhdGVnb3J5Jyx7Y2F0ZWdvcnk6Y2F0ZWdvcnl9KTt9LF9yZW5kZXJGaWx0ZXI6ZnVuY3Rpb24oZmlsdGVyKXt2YXIgJGZpbHRlcj0kKHF3ZWIucmVuZGVyKCdTZWFyY2hQYW5lbC5GaWx0ZXInLHtmaWx0ZXI6ZmlsdGVyfSkpO09iamVjdC5rZXlzKGZpbHRlci5ncm91cHN8fHt9KS5mb3JFYWNoKGZ1bmN0aW9uKGdyb3VwSWQpe3ZhciBzdGF0ZT1maWx0ZXIuZ3JvdXBzW2dyb3VwSWRdLnN0YXRlO2lmKGdyb3VwSWQhPT0nZmFsc2UnJiZzdGF0ZT09PSdpbmRldGVybWluYXRlJyl7JGZpbHRlci5maW5kKCcub19zZWFyY2hfcGFuZWxfZmlsdGVyX2dyb3VwW2RhdGEtZ3JvdXAtaWQ9Jytncm91cElkKyddIGlucHV0JykuZ2V0KDApLmluZGV0ZXJtaW5hdGU9dHJ1ZTt9fSk7cmV0dXJuICRmaWx0ZXI7fSxfdXBkYXRlRmlsdGVyR3JvdXBTdGF0ZTpmdW5jdGlvbihncm91cCl7dmFyIHZhbHVlUGFydGl0aW9uPV8ucGFydGl0aW9uKE9iamVjdC5rZXlzKGdyb3VwLnZhbHVlcyksZnVuY3Rpb24odmFsdWVJZCl7cmV0dXJuIGdyb3VwLnZhbHVlc1t2YWx1ZUlkXS5jaGVja2VkO30pO2lmKHZhbHVlUGFydGl0aW9uWzBdLmxlbmd0aCYmdmFsdWVQYXJ0aXRpb25bMV0ubGVuZ3RoKXtncm91cC5zdGF0ZT0naW5kZXRlcm1pbmF0ZSc7fWVsc2UgaWYodmFsdWVQYXJ0aXRpb25bMF0ubGVuZ3RoKXtncm91cC5zdGF0ZT0nY2hlY2tlZCc7fWVsc2V7Z3JvdXAuc3RhdGU9J3VuY2hlY2tlZCc7fX0sX29uQ2F0ZWdvcnlWYWx1ZUNsaWNrZWQ6ZnVuY3Rpb24oZXYpe2V2LnN0b3BQcm9wYWdhdGlvbigpO3ZhciAkaXRlbT0kKGV2LmN1cnJlbnRUYXJnZXQpLmNsb3Nlc3QoJy5vX3NlYXJjaF9wYW5lbF9jYXRlZ29yeV92YWx1ZScpO3ZhciBjYXRlZ29yeT10aGlzLmNhdGVnb3JpZXNbJGl0ZW0uZGF0YSgnY2F0ZWdvcnlJZCcpXTt2YXIgdmFsdWVJZD0kaXRlbS5kYXRhKCdpZCcpfHxmYWxzZTtjYXRlZ29yeS5hY3RpdmVWYWx1ZUlkPXZhbHVlSWQ7aWYoY2F0ZWdvcnkudmFsdWVzW3ZhbHVlSWRdKXtjYXRlZ29yeS52YWx1ZXNbdmFsdWVJZF0uZm9sZGVkPSFjYXRlZ29yeS52YWx1ZXNbdmFsdWVJZF0uZm9sZGVkO30KdmFyIHN0b3JhZ2VLZXk9dGhpcy5fZ2V0TG9jYWxTdG9yYWdlS2V5KGNhdGVnb3J5KTt0aGlzLmNhbGwoJ2xvY2FsX3N0b3JhZ2UnLCdzZXRJdGVtJyxzdG9yYWdlS2V5LHZhbHVlSWQpO3RoaXMuX25vdGlmeURvbWFpblVwZGF0ZWQoKTt9LF9vbkZpbHRlckdyb3VwQ2hhbmdlZDpmdW5jdGlvbihldil7ZXYuc3RvcFByb3BhZ2F0aW9uKCk7dmFyICRpdGVtPSQoZXYudGFyZ2V0KS5jbG9zZXN0KCcub19zZWFyY2hfcGFuZWxfZmlsdGVyX2dyb3VwJyk7dmFyIGZpbHRlcj10aGlzLmZpbHRlcnNbJGl0ZW0uZGF0YSgnZmlsdGVySWQnKV07dmFyIGdyb3VwSWQ9JGl0ZW0uZGF0YSgnZ3JvdXBJZCcpO3ZhciBncm91cD1maWx0ZXIuZ3JvdXBzW2dyb3VwSWRdO2dyb3VwLnN0YXRlPWdyb3VwLnN0YXRlPT09J2NoZWNrZWQnPyd1bmNoZWNrZWQnOidjaGVja2VkJztPYmplY3Qua2V5cyhncm91cC52YWx1ZXMpLmZvckVhY2goZnVuY3Rpb24odmFsdWVJZCl7Z3JvdXAudmFsdWVzW3ZhbHVlSWRdLmNoZWNrZWQ9Z3JvdXAuc3RhdGU9PT0nY2hlY2tlZCc7fSk7dGhpcy5fbm90aWZ5RG9tYWluVXBkYXRlZCgpO30sX29uRmlsdGVyVmFsdWVDaGFuZ2VkOmZ1bmN0aW9uKGV2KXtldi5zdG9wUHJvcGFnYXRpb24oKTt2YXIgJGl0ZW09JChldi50YXJnZXQpLmNsb3Nlc3QoJy5vX3NlYXJjaF9wYW5lbF9maWx0ZXJfdmFsdWUnKTt2YXIgdmFsdWVJZD0kaXRlbS5kYXRhKCd2YWx1ZUlkJyk7dmFyIGZpbHRlcj10aGlzLmZpbHRlcnNbJGl0ZW0uZGF0YSgnZmlsdGVySWQnKV07dmFyIHZhbHVlPWZpbHRlci52YWx1ZXNbdmFsdWVJZF07dmFsdWUuY2hlY2tlZD0hdmFsdWUuY2hlY2tlZDt2YXIgZ3JvdXA9ZmlsdGVyLmdyb3VwcyYmZmlsdGVyLmdyb3Vwc1t2YWx1ZS5ncm91cF9pZF07aWYoZ3JvdXApe3RoaXMuX3VwZGF0ZUZpbHRlckdyb3VwU3RhdGUoZ3JvdXApO30KdGhpcy5fbm90aWZ5RG9tYWluVXBkYXRlZCgpO30sX29uVG9nZ2xlRm9sZENhdGVnb3J5OmZ1bmN0aW9uKGV2KXtldi5wcmV2ZW50RGVmYXVsdCgpO2V2LnN0b3BQcm9wYWdhdGlvbigpO3ZhciAkaXRlbT0kKGV2LmN1cnJlbnRUYXJnZXQpLmNsb3Nlc3QoJy5vX3NlYXJjaF9wYW5lbF9jYXRlZ29yeV92YWx1ZScpO3ZhciBjYXRlZ29yeT10aGlzLmNhdGVnb3JpZXNbJGl0ZW0uZGF0YSgnY2F0ZWdvcnlJZCcpXTt2YXIgdmFsdWVJZD0kaXRlbS5kYXRhKCdpZCcpO2NhdGVnb3J5LnZhbHVlc1t2YWx1ZUlkXS5mb2xkZWQ9IWNhdGVnb3J5LnZhbHVlc1t2YWx1ZUlkXS5mb2xkZWQ7dGhpcy5fcmVuZGVyKCk7fSxfb25Ub2dnbGVGb2xkRmlsdGVyR3JvdXA6ZnVuY3Rpb24oZXYpe2V2LnByZXZlbnREZWZhdWx0KCk7ZXYuc3RvcFByb3BhZ2F0aW9uKCk7dmFyICRpdGVtPSQoZXYuY3VycmVudFRhcmdldCkuY2xvc2VzdCgnLm9fc2VhcmNoX3BhbmVsX2ZpbHRlcl9ncm91cCcpO3ZhciBmaWx0ZXI9dGhpcy5maWx0ZXJzWyRpdGVtLmRhdGEoJ2ZpbHRlcklkJyldO3ZhciBncm91cElkPSRpdGVtLmRhdGEoJ2dyb3VwSWQnKTtmaWx0ZXIuZ3JvdXBzW2dyb3VwSWRdLmZvbGRlZD0hZmlsdGVyLmdyb3Vwc1tncm91cElkXS5mb2xkZWQ7dGhpcy5fcmVuZGVyKCk7fSx9KTtyZXR1cm4gU2VhcmNoUGFuZWw7fSk7OwoKLyogL3dlYi9zdGF0aWMvc3JjL2pzL3ZpZXdzL2ZpZWxkX21hbmFnZXJfbWl4aW4uanMgZGVmaW5lZCBpbiBidW5kbGUgJ3dlYi5hc3NldHNfYmFja2VuZCcgKi8Kb2Rvby5kZWZpbmUoJ3dlYi5GaWVsZE1hbmFnZXJNaXhpbicsZnVuY3Rpb24ocmVxdWlyZSl7InVzZSBzdHJpY3QiO3ZhciBCYXNpY01vZGVsPXJlcXVpcmUoJ3dlYi5CYXNpY01vZGVsJyk7dmFyIGNvbmN1cnJlbmN5PXJlcXVpcmUoJ3dlYi5jb25jdXJyZW5jeScpO3ZhciBGaWVsZE1hbmFnZXJNaXhpbj17Y3VzdG9tX2V2ZW50czp7ZmllbGRfY2hhbmdlZDonX29uRmllbGRDaGFuZ2VkJyxsb2FkOidfb25Mb2FkJyxtdXRleGlmeTonX29uTXV0ZXhpZnknLH0saW5pdDpmdW5jdGlvbihtb2RlbCl7dGhpcy5tb2RlbD1tb2RlbHx8bmV3IEJhc2ljTW9kZWwodGhpcyk7dGhpcy5tdXRleD1uZXcgY29uY3VycmVuY3kuTXV0ZXgoKTt9LF9hcHBseUNoYW5nZXM6ZnVuY3Rpb24oZGF0YVBvaW50SUQsY2hhbmdlcyxldmVudCl7dmFyIHNlbGY9dGhpczt2YXIgb3B0aW9ucz1fLnBpY2soZXZlbnQuZGF0YSwnY29udGV4dCcsJ2RvTm90U2V0RGlydHknLCdub3RpZnlDaGFuZ2UnLCd2aWV3VHlwZScsJ2FsbG93V2FybmluZycpO3JldHVybiB0aGlzLm1vZGVsLm5vdGlmeUNoYW5nZXMoZGF0YVBvaW50SUQsY2hhbmdlcyxvcHRpb25zKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCl7aWYoZXZlbnQuZGF0YS5mb3JjZV9zYXZlKXtyZXR1cm4gc2VsZi5tb2RlbC5zYXZlKGRhdGFQb2ludElEKS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIHNlbGYuX2NvbmZpcm1TYXZlKGRhdGFQb2ludElEKTt9KS5ndWFyZGVkQ2F0Y2goZnVuY3Rpb24oKXtyZXR1cm4gc2VsZi5fcmVqZWN0U2F2ZShkYXRhUG9pbnRJRCk7fSk7fWVsc2UgaWYob3B0aW9ucy5ub3RpZnlDaGFuZ2UhPT1mYWxzZSl7cmV0dXJuIHNlbGYuX2NvbmZpcm1DaGFuZ2UoZGF0YVBvaW50SUQscmVzdWx0LGV2ZW50KTt9fSk7fSxfY29uZmlybUNoYW5nZTpmdW5jdGlvbihpZCxmaWVsZHMsZXZlbnQpe3JldHVybiBQcm9taXNlLnJlc29sdmUoKTt9LF9jb25maXJtU2F2ZTpmdW5jdGlvbihpZCl7cmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO30sX3JlamVjdFNhdmU6ZnVuY3Rpb24oaWQpe3JldHVybiBQcm9taXNlLnJlc29sdmUoKTt9LF9vbkZpZWxkQ2hhbmdlZDpmdW5jdGlvbihldmVudCl7ZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7cmV0dXJuIHRoaXMuX2FwcGx5Q2hhbmdlcyhldmVudC5kYXRhLmRhdGFQb2ludElELGV2ZW50LmRhdGEuY2hhbmdlcyxldmVudCkudGhlbihldmVudC5kYXRhLm9uU3VjY2Vzc3x8ZnVuY3Rpb24oKXt9KS5ndWFyZGVkQ2F0Y2goZXZlbnQuZGF0YS5vbkZhaWx1cmV8fGZ1bmN0aW9uKCl7fSk7fSxfb25Mb2FkOmZ1bmN0aW9uKGV2ZW50KXt2YXIgc2VsZj10aGlzO2V2ZW50LnN0b3BQcm9wYWdhdGlvbigpO3ZhciBkYXRhPWV2ZW50LmRhdGE7aWYoIWRhdGEub25fc3VjY2Vzcyl7cmV0dXJuO30KdmFyIHBhcmFtcz17fTtpZignbGltaXQnaW4gZGF0YSl7cGFyYW1zLmxpbWl0PWRhdGEubGltaXQ7fQppZignb2Zmc2V0J2luIGRhdGEpe3BhcmFtcy5vZmZzZXQ9ZGF0YS5vZmZzZXQ7fQp0aGlzLm11dGV4LmV4ZWMoZnVuY3Rpb24oKXtyZXR1cm4gc2VsZi5tb2RlbC5yZWxvYWQoZGF0YS5pZCxwYXJhbXMpLnRoZW4oZnVuY3Rpb24oZGJfaWQpe2RhdGEub25fc3VjY2VzcyhzZWxmLm1vZGVsLmdldChkYl9pZCkpO30pO30pO30sX29uTXV0ZXhpZnk6ZnVuY3Rpb24oZXYpe2V2LnN0b3BQcm9wYWdhdGlvbigpO3RoaXMubXV0ZXguZXhlYyhldi5kYXRhLmFjdGlvbik7fSx9O3JldHVybiBGaWVsZE1hbmFnZXJNaXhpbjt9KTs7CgovKiAvd2ViL3N0YXRpYy9zcmMvanMvdmlld3Mvc2VsZWN0X2NyZWF0ZV9jb250cm9sbGVyc19yZWdpc3RyeS5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwpvZG9vLmRlZmluZSgnd2ViLnNlbGVjdF9jcmVhdGVfY29udHJvbGxlcnNfcmVnaXN0cnknLGZ1bmN0aW9uKHJlcXVpcmUpeyJ1c2Ugc3RyaWN0IjtyZXR1cm57fTt9KTtvZG9vLmRlZmluZSgnd2ViLl9zZWxlY3RfY3JlYXRlX2NvbnRyb2xsZXJzX3JlZ2lzdHJ5JyxmdW5jdGlvbihyZXF1aXJlKXsidXNlIHN0cmljdCI7dmFyIEthbmJhbkNvbnRyb2xsZXI9cmVxdWlyZSgnd2ViLkthbmJhbkNvbnRyb2xsZXInKTt2YXIgTGlzdENvbnRyb2xsZXI9cmVxdWlyZSgnd2ViLkxpc3RDb250cm9sbGVyJyk7dmFyIHNlbGVjdF9jcmVhdGVfY29udHJvbGxlcnNfcmVnaXN0cnk9cmVxdWlyZSgnd2ViLnNlbGVjdF9jcmVhdGVfY29udHJvbGxlcnNfcmVnaXN0cnknKTt2YXIgU2VsZWN0Q3JlYXRlS2FuYmFuQ29udHJvbGxlcj1LYW5iYW5Db250cm9sbGVyLmV4dGVuZCh7X29uT3BlblJlY29yZDpmdW5jdGlvbihldil7dmFyIHNlbGVjdGVkUmVjb3JkPXRoaXMubW9kZWwuZ2V0KGV2LmRhdGEuaWQpO3RoaXMudHJpZ2dlcl91cCgnc2VsZWN0X3JlY29yZCcse2lkOnNlbGVjdGVkUmVjb3JkLnJlc19pZCxkaXNwbGF5X25hbWU6c2VsZWN0ZWRSZWNvcmQuZGF0YS5kaXNwbGF5X25hbWUsfSk7fSx9KTt2YXIgU2VsZWN0Q3JlYXRlTGlzdENvbnRyb2xsZXI9TGlzdENvbnRyb2xsZXIuZXh0ZW5kKHtfb25PcGVuUmVjb3JkOmZ1bmN0aW9uKGV2KXt2YXIgc2VsZWN0ZWRSZWNvcmQ9dGhpcy5tb2RlbC5nZXQoZXYuZGF0YS5pZCk7dGhpcy50cmlnZ2VyX3VwKCdzZWxlY3RfcmVjb3JkJyx7aWQ6c2VsZWN0ZWRSZWNvcmQucmVzX2lkLGRpc3BsYXlfbmFtZTpzZWxlY3RlZFJlY29yZC5kYXRhLmRpc3BsYXlfbmFtZSx9KTt9LH0pO18uZXh0ZW5kKHNlbGVjdF9jcmVhdGVfY29udHJvbGxlcnNfcmVnaXN0cnkse1NlbGVjdENyZWF0ZUxpc3RDb250cm9sbGVyOlNlbGVjdENyZWF0ZUxpc3RDb250cm9sbGVyLFNlbGVjdENyZWF0ZUthbmJhbkNvbnRyb2xsZXI6U2VsZWN0Q3JlYXRlS2FuYmFuQ29udHJvbGxlcix9KTt9KTs7CgovKiAvd2ViL3N0YXRpYy9zcmMvanMvdmlld3Mvc3RhbmRhbG9uZV9maWVsZF9tYW5hZ2VyX21peGluLmpzIGRlZmluZWQgaW4gYnVuZGxlICd3ZWIuYXNzZXRzX2JhY2tlbmQnICovCm9kb28uZGVmaW5lKCd3ZWIuU3RhbmRhbG9uZUZpZWxkTWFuYWdlck1peGluJyxmdW5jdGlvbihyZXF1aXJlKXsidXNlIHN0cmljdCI7dmFyIEZpZWxkTWFuYWdlck1peGluPXJlcXVpcmUoJ3dlYi5GaWVsZE1hbmFnZXJNaXhpbicpO3ZhciBTdGFuZGFsb25lRmllbGRNYW5hZ2VyTWl4aW49Xy5leHRlbmQoe30sRmllbGRNYW5hZ2VyTWl4aW4se2luaXQ6ZnVuY3Rpb24oKXtGaWVsZE1hbmFnZXJNaXhpbi5pbml0LmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLnJlZ2lzdGVyZWRXaWRnZXRzPXt9O30sX2NvbmZpcm1DaGFuZ2U6ZnVuY3Rpb24oaWQsZmllbGRzLGV2ZW50KXt2YXIgcmVzdWx0PUZpZWxkTWFuYWdlck1peGluLl9jb25maXJtQ2hhbmdlLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt2YXIgcmVjb3JkPXRoaXMubW9kZWwuZ2V0KGlkKTtfLmVhY2godGhpcy5yZWdpc3RlcmVkV2lkZ2V0c1tpZF0sZnVuY3Rpb24od2lkZ2V0LGZpZWxkTmFtZSl7aWYoXy5jb250YWlucyhmaWVsZHMsZmllbGROYW1lKSl7d2lkZ2V0LnJlc2V0KHJlY29yZCxldmVudCk7fX0pO3JldHVybiByZXN1bHQ7fSxfcmVnaXN0ZXJXaWRnZXQ6ZnVuY3Rpb24oZGF0YXBvaW50SUQsZmllbGROYW1lLHdpZGdldCl7aWYoIXRoaXMucmVnaXN0ZXJlZFdpZGdldHNbZGF0YXBvaW50SURdKXt0aGlzLnJlZ2lzdGVyZWRXaWRnZXRzW2RhdGFwb2ludElEXT17fTt9CnRoaXMucmVnaXN0ZXJlZFdpZGdldHNbZGF0YXBvaW50SURdW2ZpZWxkTmFtZV09d2lkZ2V0O30sfSk7cmV0dXJuIFN0YW5kYWxvbmVGaWVsZE1hbmFnZXJNaXhpbjt9KTs7CgovKiAvd2ViL3N0YXRpYy9zcmMvanMvdmlld3Mvdmlld19yZWdpc3RyeS5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwpvZG9vLmRlZmluZSgnd2ViLnZpZXdfcmVnaXN0cnknLGZ1bmN0aW9uKHJlcXVpcmUpeyJ1c2Ugc3RyaWN0Ijt2YXIgUmVnaXN0cnk9cmVxdWlyZSgnd2ViLlJlZ2lzdHJ5Jyk7cmV0dXJuIG5ldyBSZWdpc3RyeSgpO30pO29kb28uZGVmaW5lKCd3ZWIuX3ZpZXdfcmVnaXN0cnknLGZ1bmN0aW9uKHJlcXVpcmUpeyJ1c2Ugc3RyaWN0Ijt2YXIgRm9ybVZpZXc9cmVxdWlyZSgnd2ViLkZvcm1WaWV3Jyk7dmFyIEdyYXBoVmlldz1yZXF1aXJlKCd3ZWIuR3JhcGhWaWV3Jyk7dmFyIEthbmJhblZpZXc9cmVxdWlyZSgnd2ViLkthbmJhblZpZXcnKTt2YXIgTGlzdFZpZXc9cmVxdWlyZSgnd2ViLkxpc3RWaWV3Jyk7dmFyIFBpdm90Vmlldz1yZXF1aXJlKCd3ZWIuUGl2b3RWaWV3Jyk7dmFyIENhbGVuZGFyVmlldz1yZXF1aXJlKCd3ZWIuQ2FsZW5kYXJWaWV3Jyk7dmFyIHZpZXdfcmVnaXN0cnk9cmVxdWlyZSgnd2ViLnZpZXdfcmVnaXN0cnknKTt2aWV3X3JlZ2lzdHJ5LmFkZCgnZm9ybScsRm9ybVZpZXcpLmFkZCgnbGlzdCcsTGlzdFZpZXcpLmFkZCgna2FuYmFuJyxLYW5iYW5WaWV3KS5hZGQoJ2dyYXBoJyxHcmFwaFZpZXcpLmFkZCgncGl2b3QnLFBpdm90VmlldykuYWRkKCdjYWxlbmRhcicsQ2FsZW5kYXJWaWV3KTt9KTs7CgovKiAvd2ViL3N0YXRpYy9zcmMvanMvdmlld3Mvdmlld19kaWFsb2dzLmpzIGRlZmluZWQgaW4gYnVuZGxlICd3ZWIuYXNzZXRzX2JhY2tlbmQnICovCm9kb28uZGVmaW5lKCd3ZWIudmlld19kaWFsb2dzJyxmdW5jdGlvbihyZXF1aXJlKXsidXNlIHN0cmljdCI7dmFyIGNvbmZpZz1yZXF1aXJlKCd3ZWIuY29uZmlnJyk7dmFyIGNvcmU9cmVxdWlyZSgnd2ViLmNvcmUnKTt2YXIgRGlhbG9nPXJlcXVpcmUoJ3dlYi5EaWFsb2cnKTt2YXIgZG9tPXJlcXVpcmUoJ3dlYi5kb20nKTt2YXIgdmlld19yZWdpc3RyeT1yZXF1aXJlKCd3ZWIudmlld19yZWdpc3RyeScpO3ZhciBzZWxlY3RfY3JlYXRlX2NvbnRyb2xsZXJzX3JlZ2lzdHJ5PXJlcXVpcmUoJ3dlYi5zZWxlY3RfY3JlYXRlX2NvbnRyb2xsZXJzX3JlZ2lzdHJ5Jyk7dmFyIF90PWNvcmUuX3Q7dmFyIFZpZXdEaWFsb2c9RGlhbG9nLmV4dGVuZCh7Y3VzdG9tX2V2ZW50czpfLmV4dGVuZCh7fSxEaWFsb2cucHJvdG90eXBlLmN1c3RvbV9ldmVudHMse3B1c2hfc3RhdGU6J19vblB1c2hTdGF0ZScsfSksaW5pdDpmdW5jdGlvbihwYXJlbnQsb3B0aW9ucyl7b3B0aW9ucz1vcHRpb25zfHx7fTtvcHRpb25zLmZ1bGxzY3JlZW49Y29uZmlnLmRldmljZS5pc01vYmlsZTtvcHRpb25zLmRpYWxvZ0NsYXNzPW9wdGlvbnMuZGlhbG9nQ2xhc3N8fCcnKycgb19hY3Rfd2luZG93Jzt0aGlzLl9zdXBlcihwYXJlbnQsJC5leHRlbmQodHJ1ZSx7fSxvcHRpb25zKSk7dGhpcy5yZXNfbW9kZWw9b3B0aW9ucy5yZXNfbW9kZWx8fG51bGw7dGhpcy5kb21haW49b3B0aW9ucy5kb21haW58fFtdO3RoaXMuY29udGV4dD1vcHRpb25zLmNvbnRleHR8fHt9O3RoaXMub3B0aW9ucz1fLmV4dGVuZCh0aGlzLm9wdGlvbnN8fHt9LG9wdGlvbnN8fHt9KTt9LF9vblB1c2hTdGF0ZTpmdW5jdGlvbihldmVudCl7ZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7fSx9KTt2YXIgRm9ybVZpZXdEaWFsb2c9Vmlld0RpYWxvZy5leHRlbmQoe2luaXQ6ZnVuY3Rpb24ocGFyZW50LG9wdGlvbnMpe3ZhciBzZWxmPXRoaXM7b3B0aW9ucz1vcHRpb25zfHx7fTt0aGlzLnJlc19pZD1vcHRpb25zLnJlc19pZHx8bnVsbDt0aGlzLm9uX3NhdmVkPW9wdGlvbnMub25fc2F2ZWR8fChmdW5jdGlvbigpe30pO3RoaXMub25fcmVtb3ZlPW9wdGlvbnMub25fcmVtb3ZlfHwoZnVuY3Rpb24oKXt9KTt0aGlzLmNvbnRleHQ9b3B0aW9ucy5jb250ZXh0O3RoaXMubW9kZWw9b3B0aW9ucy5tb2RlbDt0aGlzLnBhcmVudElEPW9wdGlvbnMucGFyZW50SUQ7dGhpcy5yZWNvcmRJRD1vcHRpb25zLnJlY29yZElEO3RoaXMuc2hvdWxkU2F2ZUxvY2FsbHk9b3B0aW9ucy5zaG91bGRTYXZlTG9jYWxseTt0aGlzLnJlYWRvbmx5PW9wdGlvbnMucmVhZG9ubHk7dGhpcy5kZWxldGFibGU9b3B0aW9ucy5kZWxldGFibGU7dGhpcy5kaXNhYmxlX211bHRpcGxlX3NlbGVjdGlvbj1vcHRpb25zLmRpc2FibGVfbXVsdGlwbGVfc2VsZWN0aW9uO3ZhciBvQnRuUmVtb3ZlPSdvX2J0bl9yZW1vdmUnO3ZhciBtdWx0aV9zZWxlY3Q9IV8uaXNOdW1iZXIob3B0aW9ucy5yZXNfaWQpJiYhb3B0aW9ucy5kaXNhYmxlX211bHRpcGxlX3NlbGVjdGlvbjt2YXIgcmVhZG9ubHk9Xy5pc051bWJlcihvcHRpb25zLnJlc19pZCkmJm9wdGlvbnMucmVhZG9ubHk7aWYoIW9wdGlvbnMuYnV0dG9ucyl7b3B0aW9ucy5idXR0b25zPVt7dGV4dDoocmVhZG9ubHk/X3QoIkNsb3NlIik6X3QoIkRpc2NhcmQiKSksY2xhc3NlczoiYnRuLXNlY29uZGFyeSBvX2Zvcm1fYnV0dG9uX2NhbmNlbCIsY2xvc2U6dHJ1ZSxjbGljazpmdW5jdGlvbigpe2lmKCFyZWFkb25seSl7c2VsZi5mb3JtX3ZpZXcubW9kZWwuZGlzY2FyZENoYW5nZXMoc2VsZi5mb3JtX3ZpZXcuaGFuZGxlLHtyb2xsYmFjazpzZWxmLnNob3VsZFNhdmVMb2NhbGx5LH0pO319LH1dO2lmKCFyZWFkb25seSl7b3B0aW9ucy5idXR0b25zLnVuc2hpZnQoe3RleHQ6KG11bHRpX3NlbGVjdD9fdCgiU2F2ZSAmIENsb3NlIik6X3QoIlNhdmUiKSksY2xhc3NlczoiYnRuLXByaW1hcnkiLGNsaWNrOmZ1bmN0aW9uKCl7c2VsZi5fc2F2ZSgpLnRoZW4oc2VsZi5jbG9zZS5iaW5kKHNlbGYpKTt9fSk7aWYobXVsdGlfc2VsZWN0KXtvcHRpb25zLmJ1dHRvbnMuc3BsaWNlKDEsMCx7dGV4dDpfdCgiU2F2ZSAmIE5ldyIpLGNsYXNzZXM6ImJ0bi1wcmltYXJ5IixjbGljazpmdW5jdGlvbigpe3NlbGYuX3NhdmUoKS50aGVuKHNlbGYuZm9ybV92aWV3LmNyZWF0ZVJlY29yZC5iaW5kKHNlbGYuZm9ybV92aWV3LHNlbGYucGFyZW50SUQpKS50aGVuKGZ1bmN0aW9uKCl7aWYoIXNlbGYuZGVsZXRhYmxlKXtyZXR1cm47fQpzZWxmLmRlbGV0YWJsZT1mYWxzZTtzZWxmLmJ1dHRvbnM9c2VsZi5idXR0b25zLmZpbHRlcihmdW5jdGlvbihidXR0b24pe3JldHVybiBidXR0b24uY2xhc3Nlcy5zcGxpdCgnICcpLmluZGV4T2Yob0J0blJlbW92ZSk8MDt9KTtzZWxmLnNldF9idXR0b25zKHNlbGYuYnV0dG9ucyk7c2VsZi5zZXRfdGl0bGUoX3QoIkNyZWF0ZSAiKStfLnN0ci5zdHJSaWdodChzZWxmLnRpdGxlLF90KCJPcGVuOiAiKSkpO30pO30sfSk7fQp2YXIgbXVsdGk9b3B0aW9ucy5kaXNhYmxlX211bHRpcGxlX3NlbGVjdGlvbjtpZighbXVsdGkmJnRoaXMuZGVsZXRhYmxlKXt0aGlzLl9zZXRSZW1vdmVCdXR0b25PcHRpb24ob3B0aW9ucyxvQnRuUmVtb3ZlKTt9fX0KdGhpcy5fc3VwZXIocGFyZW50LG9wdGlvbnMpO30sb3BlbjpmdW5jdGlvbigpe3ZhciBzZWxmPXRoaXM7dmFyIF9zdXBlcj10aGlzLl9zdXBlci5iaW5kKHRoaXMpO3ZhciBGb3JtVmlldz12aWV3X3JlZ2lzdHJ5LmdldCgnZm9ybScpO3ZhciBmaWVsZHNfdmlld19kZWY7aWYodGhpcy5vcHRpb25zLmZpZWxkc192aWV3KXtmaWVsZHNfdmlld19kZWY9UHJvbWlzZS5yZXNvbHZlKHRoaXMub3B0aW9ucy5maWVsZHNfdmlldyk7fWVsc2V7ZmllbGRzX3ZpZXdfZGVmPXRoaXMubG9hZEZpZWxkVmlldyh0aGlzLnJlc19tb2RlbCx0aGlzLmNvbnRleHQsdGhpcy5vcHRpb25zLnZpZXdfaWQsJ2Zvcm0nKTt9CmZpZWxkc192aWV3X2RlZi50aGVuKGZ1bmN0aW9uKHZpZXdJbmZvKXt2YXIgcmVmaW5lZENvbnRleHQ9Xy5waWNrKHNlbGYuY29udGV4dCxmdW5jdGlvbih2YWx1ZSxrZXkpe3JldHVybiBrZXkuaW5kZXhPZignX3ZpZXdfcmVmJyk9PT0tMTt9KTt2YXIgZm9ybXZpZXc9bmV3IEZvcm1WaWV3KHZpZXdJbmZvLHttb2RlbE5hbWU6c2VsZi5yZXNfbW9kZWwsY29udGV4dDpyZWZpbmVkQ29udGV4dCxpZHM6c2VsZi5yZXNfaWQ/W3NlbGYucmVzX2lkXTpbXSxjdXJyZW50SWQ6c2VsZi5yZXNfaWR8fHVuZGVmaW5lZCxpbmRleDowLG1vZGU6c2VsZi5yZXNfaWQmJnNlbGYub3B0aW9ucy5yZWFkb25seT8ncmVhZG9ubHknOidlZGl0Jyxmb290ZXJUb0J1dHRvbnM6dHJ1ZSxkZWZhdWx0X2J1dHRvbnM6ZmFsc2Usd2l0aENvbnRyb2xQYW5lbDpmYWxzZSxtb2RlbDpzZWxmLm1vZGVsLHBhcmVudElEOnNlbGYucGFyZW50SUQscmVjb3JkSUQ6c2VsZi5yZWNvcmRJRCx9KTtyZXR1cm4gZm9ybXZpZXcuZ2V0Q29udHJvbGxlcihzZWxmKTt9KS50aGVuKGZ1bmN0aW9uKGZvcm1WaWV3KXtzZWxmLmZvcm1fdmlldz1mb3JtVmlldzt2YXIgZnJhZ21lbnQ9ZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO2lmKHNlbGYucmVjb3JkSUQmJnNlbGYuc2hvdWxkU2F2ZUxvY2FsbHkpe3NlbGYubW9kZWwuc2F2ZShzZWxmLnJlY29yZElELHtzYXZlUG9pbnQ6dHJ1ZX0pO30KcmV0dXJuIHNlbGYuZm9ybV92aWV3LmFwcGVuZFRvKGZyYWdtZW50KS50aGVuKGZ1bmN0aW9uKCl7c2VsZi5vcGVuZWQoKS50aGVuKGZ1bmN0aW9uKCl7dmFyICRidXR0b25zPSQoJzxkaXY+Jyk7c2VsZi5mb3JtX3ZpZXcucmVuZGVyQnV0dG9ucygkYnV0dG9ucyk7aWYoJGJ1dHRvbnMuY2hpbGRyZW4oKS5sZW5ndGgpe3NlbGYuJGZvb3Rlci5lbXB0eSgpLmFwcGVuZCgkYnV0dG9ucy5jb250ZW50cygpKTt9CmRvbS5hcHBlbmQoc2VsZi4kZWwsZnJhZ21lbnQse2NhbGxiYWNrczpbe3dpZGdldDpzZWxmLmZvcm1fdmlld31dLGluX0RPTTp0cnVlLH0pO30pO3JldHVybiBfc3VwZXIoKTt9KTt9KTtyZXR1cm4gdGhpczt9LF9mb2N1c09uQ2xvc2U6ZnVuY3Rpb24oKXt2YXIgaXNGb2N1c1NldD1mYWxzZTt0aGlzLnRyaWdnZXJfdXAoJ2Zvcm1fZGlhbG9nX2Rpc2NhcmRlZCcse2NhbGxiYWNrOmZ1bmN0aW9uKGlzRm9jdXNlZCl7aXNGb2N1c1NldD1pc0ZvY3VzZWQ7fSx9KTtyZXR1cm4gaXNGb2N1c1NldDt9LF9yZW1vdmU6ZnVuY3Rpb24oKXtyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHRoaXMub25fcmVtb3ZlKCkpO30sX3NhdmU6ZnVuY3Rpb24oKXt2YXIgc2VsZj10aGlzO3JldHVybiB0aGlzLmZvcm1fdmlldy5zYXZlUmVjb3JkKHRoaXMuZm9ybV92aWV3LmhhbmRsZSx7c3RheUluRWRpdDp0cnVlLHJlbG9hZDpmYWxzZSxzYXZlUG9pbnQ6dGhpcy5zaG91bGRTYXZlTG9jYWxseSx2aWV3VHlwZTonZm9ybScsfSkudGhlbihmdW5jdGlvbihjaGFuZ2VkRmllbGRzKXt2YXIgcmVjb3JkPXNlbGYuZm9ybV92aWV3Lm1vZGVsLmdldChzZWxmLmZvcm1fdmlldy5oYW5kbGUpO3JldHVybiBzZWxmLm9uX3NhdmVkKHJlY29yZCwhIWNoYW5nZWRGaWVsZHMubGVuZ3RoKTt9KTt9LF9zZXRSZW1vdmVCdXR0b25PcHRpb24ob3B0aW9ucyxidG5DbGFzc2VzKXtjb25zdCBzZWxmPXRoaXM7b3B0aW9ucy5idXR0b25zLnB1c2goe3RleHQ6X3QoIlJlbW92ZSIpLGNsYXNzZXM6J2J0bi1zZWNvbmRhcnkgJytidG5DbGFzc2VzLGNsaWNrOmZ1bmN0aW9uKCl7c2VsZi5fcmVtb3ZlKCkudGhlbihzZWxmLmNsb3NlLmJpbmQoc2VsZikpO319KTt9LH0pO3ZhciBTZWxlY3RDcmVhdGVEaWFsb2c9Vmlld0RpYWxvZy5leHRlbmQoe2N1c3RvbV9ldmVudHM6Xy5leHRlbmQoe30sVmlld0RpYWxvZy5wcm90b3R5cGUuY3VzdG9tX2V2ZW50cyx7c2VsZWN0X3JlY29yZDpmdW5jdGlvbihldmVudCl7aWYoIXRoaXMub3B0aW9ucy5yZWFkb25seSl7dGhpcy5vbl9zZWxlY3RlZChbZXZlbnQuZGF0YV0pO3RoaXMuY2xvc2UoKTt9fSxzZWxlY3Rpb25fY2hhbmdlZDpmdW5jdGlvbihldmVudCl7ZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7dGhpcy4kZm9vdGVyLmZpbmQoIi5vX3NlbGVjdF9idXR0b24iKS5wcm9wKCdkaXNhYmxlZCcsIWV2ZW50LmRhdGEuc2VsZWN0aW9uLmxlbmd0aCk7fSx9KSxpbml0OmZ1bmN0aW9uKCl7dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO18uZGVmYXVsdHModGhpcy5vcHRpb25zLHtpbml0aWFsX3ZpZXc6J3NlYXJjaCd9KTt0aGlzLm9uX3NlbGVjdGVkPXRoaXMub3B0aW9ucy5vbl9zZWxlY3RlZHx8KGZ1bmN0aW9uKCl7fSk7dGhpcy5vbl9jbG9zZWQ9dGhpcy5vcHRpb25zLm9uX2Nsb3NlZHx8KGZ1bmN0aW9uKCl7fSk7dGhpcy5pbml0aWFsSURzPXRoaXMub3B0aW9ucy5pbml0aWFsX2lkczt0aGlzLnZpZXdUeXBlPSdsaXN0Jzt9LG9wZW46ZnVuY3Rpb24oKXtpZih0aGlzLm9wdGlvbnMuaW5pdGlhbF92aWV3IT09InNlYXJjaCIpe3JldHVybiB0aGlzLmNyZWF0ZV9lZGl0X3JlY29yZCgpO30KdmFyIHNlbGY9dGhpczt2YXIgX3N1cGVyPXRoaXMuX3N1cGVyLmJpbmQodGhpcyk7dmFyIHZpZXdSZWZJRD10aGlzLnZpZXdUeXBlPT09J2thbmJhbic/KHRoaXMub3B0aW9ucy5rYW5iYW5fdmlld19yZWYmJkpTT04ucGFyc2UodGhpcy5vcHRpb25zLmthbmJhbl92aWV3X3JlZil8fGZhbHNlKTpmYWxzZTtyZXR1cm4gdGhpcy5sb2FkVmlld3ModGhpcy5yZXNfbW9kZWwsdGhpcy5jb250ZXh0LFtbdmlld1JlZklELHRoaXMudmlld1R5cGVdLFtmYWxzZSwnc2VhcmNoJ11dLHt9KS50aGVuKHRoaXMuc2V0dXAuYmluZCh0aGlzKSkudGhlbihmdW5jdGlvbihmcmFnbWVudCl7c2VsZi5vcGVuZWQoKS50aGVuKGZ1bmN0aW9uKCl7ZG9tLmFwcGVuZChzZWxmLiRlbCxmcmFnbWVudCx7Y2FsbGJhY2tzOlt7d2lkZ2V0OnNlbGYudmlld0NvbnRyb2xsZXJ9XSxpbl9ET006dHJ1ZSx9KTtzZWxmLnNldF9idXR0b25zKHNlbGYuX19idXR0b25zKTt9KTtyZXR1cm4gX3N1cGVyKCk7fSk7fSxzZXR1cDpmdW5jdGlvbihmaWVsZHNWaWV3cyl7dmFyIHNlbGY9dGhpczt2YXIgZnJhZ21lbnQ9ZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO3ZhciBkb21haW49dGhpcy5kb21haW47aWYodGhpcy5pbml0aWFsSURzKXtkb21haW49ZG9tYWluLmNvbmNhdChbWydpZCcsJ2luJyx0aGlzLmluaXRpYWxJRHNdXSk7fQp2YXIgVmlld0NsYXNzPXZpZXdfcmVnaXN0cnkuZ2V0KHRoaXMudmlld1R5cGUpO3ZhciB2aWV3T3B0aW9ucz17fTt2YXIgc2VsZWN0Q3JlYXRlQ29udHJvbGxlcjtpZih0aGlzLnZpZXdUeXBlPT09J2xpc3QnKXtfLmV4dGVuZCh2aWV3T3B0aW9ucyx7aGFzU2VsZWN0b3JzOiF0aGlzLm9wdGlvbnMuZGlzYWJsZV9tdWx0aXBsZV9zZWxlY3Rpb24scmVhZG9ubHk6dHJ1ZSx9LHRoaXMub3B0aW9ucy5saXN0X3ZpZXdfb3B0aW9ucyk7c2VsZWN0Q3JlYXRlQ29udHJvbGxlcj1zZWxlY3RfY3JlYXRlX2NvbnRyb2xsZXJzX3JlZ2lzdHJ5LlNlbGVjdENyZWF0ZUxpc3RDb250cm9sbGVyO30KaWYodGhpcy52aWV3VHlwZT09PSdrYW5iYW4nKXtfLmV4dGVuZCh2aWV3T3B0aW9ucyx7bm9EZWZhdWx0R3JvdXBieTp0cnVlLHNlbGVjdGlvbk1vZGU6dGhpcy5vcHRpb25zLnNlbGVjdGlvbk1vZGV8fGZhbHNlLH0pO3NlbGVjdENyZWF0ZUNvbnRyb2xsZXI9c2VsZWN0X2NyZWF0ZV9jb250cm9sbGVyc19yZWdpc3RyeS5TZWxlY3RDcmVhdGVLYW5iYW5Db250cm9sbGVyO30KdmFyIHZpZXc9bmV3IFZpZXdDbGFzcyhmaWVsZHNWaWV3c1t0aGlzLnZpZXdUeXBlXSxfLmV4dGVuZCh2aWV3T3B0aW9ucyx7YWN0aW9uOntjb250cm9sUGFuZWxGaWVsZHNWaWV3OmZpZWxkc1ZpZXdzLnNlYXJjaCxoZWxwOl8uc3RyLnNwcmludGYoIjxwPiVzPC9wPiIsX3QoIk5vIHJlY29yZHMgZm91bmQhIikpLH0sYWN0aW9uX2J1dHRvbnM6ZmFsc2UsZHluYW1pY0ZpbHRlcnM6dGhpcy5vcHRpb25zLmR5bmFtaWNGaWx0ZXJzLGNvbnRleHQ6dGhpcy5jb250ZXh0LGRvbWFpbjpkb21haW4sbW9kZWxOYW1lOnRoaXMucmVzX21vZGVsLHdpdGhCcmVhZGNydW1iczpmYWxzZSx3aXRoU2VhcmNoUGFuZWw6ZmFsc2UsfSkpO3ZpZXcuc2V0Q29udHJvbGxlcihzZWxlY3RDcmVhdGVDb250cm9sbGVyKTtyZXR1cm4gdmlldy5nZXRDb250cm9sbGVyKHRoaXMpLnRoZW4oZnVuY3Rpb24oY29udHJvbGxlcil7c2VsZi52aWV3Q29udHJvbGxlcj1jb250cm9sbGVyO3NlbGYuX3ByZXBhcmVCdXR0b25zKCk7cmV0dXJuIHNlbGYudmlld0NvbnRyb2xsZXIuYXBwZW5kVG8oZnJhZ21lbnQpO30pLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gZnJhZ21lbnQ7fSk7fSxjbG9zZTpmdW5jdGlvbigpe3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLm9uX2Nsb3NlZCgpO30sY3JlYXRlX2VkaXRfcmVjb3JkOmZ1bmN0aW9uKCl7dmFyIHNlbGY9dGhpczt2YXIgZGlhbG9nPW5ldyBGb3JtVmlld0RpYWxvZyh0aGlzLF8uZXh0ZW5kKHt9LHRoaXMub3B0aW9ucyx7b25fc2F2ZWQ6ZnVuY3Rpb24ocmVjb3JkKXt2YXIgdmFsdWVzPVt7aWQ6cmVjb3JkLnJlc19pZCxkaXNwbGF5X25hbWU6cmVjb3JkLmRhdGEuZGlzcGxheV9uYW1lfHxyZWNvcmQuZGF0YS5uYW1lLH1dO3NlbGYub25fc2VsZWN0ZWQodmFsdWVzKTt9LH0pKS5vcGVuKCk7ZGlhbG9nLm9uKCdjbG9zZWQnLHRoaXMsdGhpcy5jbG9zZSk7cmV0dXJuIGRpYWxvZzt9LF9mb2N1c09uQ2xvc2U6ZnVuY3Rpb24oKXt2YXIgaXNGb2N1c1NldD1mYWxzZTt0aGlzLnRyaWdnZXJfdXAoJ2Zvcm1fZGlhbG9nX2Rpc2NhcmRlZCcse2NhbGxiYWNrOmZ1bmN0aW9uKGlzRm9jdXNlZCl7aXNGb2N1c1NldD1pc0ZvY3VzZWQ7fSx9KTtyZXR1cm4gaXNGb2N1c1NldDt9LF9wcmVwYXJlQnV0dG9uczpmdW5jdGlvbigpe3RoaXMuX19idXR0b25zPVt7dGV4dDpfdCgiQ2FuY2VsIiksY2xhc3NlczonYnRuLXNlY29uZGFyeSBvX2Zvcm1fYnV0dG9uX2NhbmNlbCcsY2xvc2U6dHJ1ZSx9XTtpZighdGhpcy5vcHRpb25zLm5vX2NyZWF0ZSl7dGhpcy5fX2J1dHRvbnMudW5zaGlmdCh7dGV4dDpfdCgiQ3JlYXRlIiksY2xhc3NlczonYnRuLXByaW1hcnknLGNsaWNrOnRoaXMuY3JlYXRlX2VkaXRfcmVjb3JkLmJpbmQodGhpcyl9KTt9CmlmKCF0aGlzLm9wdGlvbnMuZGlzYWJsZV9tdWx0aXBsZV9zZWxlY3Rpb24pe3RoaXMuX19idXR0b25zLnVuc2hpZnQoe3RleHQ6X3QoIlNlbGVjdCIpLGNsYXNzZXM6J2J0bi1wcmltYXJ5IG9fc2VsZWN0X2J1dHRvbicsZGlzYWJsZWQ6dHJ1ZSxjbG9zZTp0cnVlLGNsaWNrOmZ1bmN0aW9uKCl7dmFyIHJlY29yZHM9dGhpcy52aWV3Q29udHJvbGxlci5nZXRTZWxlY3RlZFJlY29yZHMoKTt2YXIgdmFsdWVzPV8ubWFwKHJlY29yZHMsZnVuY3Rpb24ocmVjb3JkKXtyZXR1cm57aWQ6cmVjb3JkLnJlc19pZCxkaXNwbGF5X25hbWU6cmVjb3JkLmRhdGEuZGlzcGxheV9uYW1lLH07fSk7dGhpcy5vbl9zZWxlY3RlZCh2YWx1ZXMpO30sfSk7fX0sfSk7cmV0dXJue0Zvcm1WaWV3RGlhbG9nOkZvcm1WaWV3RGlhbG9nLFNlbGVjdENyZWF0ZURpYWxvZzpTZWxlY3RDcmVhdGVEaWFsb2csfTt9KTs7CgovKiAvd2ViL3N0YXRpYy9zcmMvanMvdmlld3Mvdmlld191dGlscy5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwpvZG9vLmRlZmluZSgnd2ViLnZpZXdVdGlscycsZnVuY3Rpb24ocmVxdWlyZSl7InVzZSBzdHJpY3QiO3ZhciBkb209cmVxdWlyZSgnd2ViLmRvbScpO3ZhciB1dGlscz1yZXF1aXJlKCd3ZWIudXRpbHMnKTt2YXIgdmlld1V0aWxzPXtnZXRHcm91cFZhbHVlOmZ1bmN0aW9uKGdyb3VwLGdyb3VwQnlGaWVsZCl7dmFyIGdyb3VwZWRCeUZpZWxkPWdyb3VwLmZpZWxkc1tncm91cEJ5RmllbGRdO3N3aXRjaChncm91cGVkQnlGaWVsZC50eXBlKXtjYXNlJ21hbnkyb25lJzpyZXR1cm4gZ3JvdXAucmVzX2lkfHxmYWxzZTtjYXNlJ3NlbGVjdGlvbic6dmFyIGRlc2NyaXB0b3I9Xy5maW5kKGdyb3VwZWRCeUZpZWxkLnNlbGVjdGlvbixmdW5jdGlvbihvcHRpb24pe3JldHVybiBvcHRpb25bMV09PT1ncm91cC52YWx1ZTt9KTtyZXR1cm4gZGVzY3JpcHRvciYmZGVzY3JpcHRvclswXTtjYXNlJ2NoYXInOmNhc2UnYm9vbGVhbic6cmV0dXJuIGdyb3VwLnZhbHVlO2RlZmF1bHQ6cmV0dXJuIGZhbHNlO319LGlzUXVpY2tDcmVhdGVFbmFibGVkOmZ1bmN0aW9uKGxpc3Qpe3ZhciBncm91cEJ5RmllbGQ9bGlzdC5ncm91cGVkQnlbMF0mJmxpc3QuZ3JvdXBlZEJ5WzBdLnNwbGl0KCc6JylbMF07aWYoIWdyb3VwQnlGaWVsZCl7cmV0dXJuIGZhbHNlO30KdmFyIGF2YWlsYWJsZVR5cGVzPVsnY2hhcicsJ2Jvb2xlYW4nLCdtYW55Mm9uZScsJ3NlbGVjdGlvbiddO2lmKCFfLmNvbnRhaW5zKGF2YWlsYWJsZVR5cGVzLGxpc3QuZmllbGRzW2dyb3VwQnlGaWVsZF0udHlwZSkpe3JldHVybiBmYWxzZTt9CnJldHVybiB0cnVlO30scGFyc2VBcmNoOmZ1bmN0aW9uKGFyY2gpe3ZhciBkb2M9JC5wYXJzZVhNTChhcmNoKS5kb2N1bWVudEVsZW1lbnQ7dmFyIHN0cmlwV2hpdGVzcGFjZXM9ZG9jLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkhPT0na2FuYmFuJztyZXR1cm4gdXRpbHMueG1sX3RvX2pzb24oZG9jLHN0cmlwV2hpdGVzcGFjZXMpO30scmVuZGVyQnV0dG9uRnJvbU5vZGU6ZnVuY3Rpb24obm9kZSxvcHRpb25zKXt2YXIgYnRuT3B0aW9ucz17YXR0cnM6Xy5vbWl0KG5vZGUuYXR0cnMsJ2ljb24nLCdzdHJpbmcnLCd0eXBlJywnYXR0cnMnLCdtb2RpZmllcnMnLCdvcHRpb25zJywnZWZmZWN0JyksaWNvbjpub2RlLmF0dHJzLmljb24sfTtpZihvcHRpb25zJiZvcHRpb25zLmV4dHJhQ2xhc3Mpe3ZhciBjbGFzc2VzPWJ0bk9wdGlvbnMuYXR0cnMuY2xhc3M/YnRuT3B0aW9ucy5hdHRycy5jbGFzcy5zcGxpdCgnICcpOltdO2J0bk9wdGlvbnMuYXR0cnMuY2xhc3M9Xy51bmlxKGNsYXNzZXMuY29uY2F0KG9wdGlvbnMuZXh0cmFDbGFzcy5zcGxpdCgnICcpKSkuam9pbignICcpO30KdmFyIHN0cj0obm9kZS5hdHRycy5zdHJpbmd8fCcnKS5yZXBsYWNlKC9fL2csJycpO2lmKHN0cil7aWYob3B0aW9ucyYmb3B0aW9ucy50ZXh0QXNUaXRsZSl7YnRuT3B0aW9ucy5hdHRycy50aXRsZT1zdHI7fWVsc2V7YnRuT3B0aW9ucy50ZXh0PXN0cjt9fQpyZXR1cm4gZG9tLnJlbmRlckJ1dHRvbihidG5PcHRpb25zKTt9LH07cmV0dXJuIHZpZXdVdGlsczt9KTs7CgovKiAvd2ViL3N0YXRpYy9zcmMvanMvdmlld3MvZm9ybS9mb3JtX3JlbmRlcmVyLmpzIGRlZmluZWQgaW4gYnVuZGxlICd3ZWIuYXNzZXRzX2JhY2tlbmQnICovCm9kb28uZGVmaW5lKCd3ZWIuRm9ybVJlbmRlcmVyJyxmdW5jdGlvbihyZXF1aXJlKXsidXNlIHN0cmljdCI7dmFyIEJhc2ljUmVuZGVyZXI9cmVxdWlyZSgnd2ViLkJhc2ljUmVuZGVyZXInKTt2YXIgY29uZmlnPXJlcXVpcmUoJ3dlYi5jb25maWcnKTt2YXIgY29yZT1yZXF1aXJlKCd3ZWIuY29yZScpO3ZhciBkb209cmVxdWlyZSgnd2ViLmRvbScpO3ZhciB2aWV3VXRpbHM9cmVxdWlyZSgnd2ViLnZpZXdVdGlscycpO3ZhciBfdD1jb3JlLl90O3ZhciBxd2ViPWNvcmUucXdlYjt2YXIgRm9ybVJlbmRlcmVyPUJhc2ljUmVuZGVyZXIuZXh0ZW5kKHtjbGFzc05hbWU6Im9fZm9ybV92aWV3IixldmVudHM6Xy5leHRlbmQoe30sQmFzaWNSZW5kZXJlci5wcm90b3R5cGUuZXZlbnRzLHsnY2xpY2sgLm9fbm90aWZpY2F0aW9uX2JveCAub2VfZmllbGRfdHJhbnNsYXRlJzonX29uVHJhbnNsYXRlJywnY2xpY2sgLm9fbm90aWZpY2F0aW9uX2JveCAuY2xvc2UnOidfb25UcmFuc2xhdGVOb3RpZmljYXRpb25DbG9zZScsJ2NsaWNrIC5vZV90aXRsZSwgLm9faW5uZXJfZ3JvdXAnOidfb25DbGljaycsJ3Nob3duLmJzLnRhYiBhW2RhdGEtdG9nZ2xlPSJ0YWIiXSc6J19vbk5vdGVib29rVGFiQ2hhbmdlZCcsfSksY3VzdG9tX2V2ZW50czpfLmV4dGVuZCh7fSxCYXNpY1JlbmRlcmVyLnByb3RvdHlwZS5jdXN0b21fZXZlbnRzLHsnbmF2aWdhdGlvbl9tb3ZlJzonX29uTmF2aWdhdGlvbk1vdmUnLCdhY3RpdmF0ZV9uZXh0X3dpZGdldCc6J19vbkFjdGl2YXRlTmV4dFdpZGdldCcsfSksSU5ORVJfR1JPVVBfQ09MOjIsT1VURVJfR1JPVVBfQ09MOjIsaW5pdDpmdW5jdGlvbigpe3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLmlkc0ZvckxhYmVscz17fTt0aGlzLmxhc3RBY3RpdmF0ZWRGaWVsZEluZGV4PS0xO3RoaXMuYWxlcnRGaWVsZHM9e307fSxzdGFydDpmdW5jdGlvbigpe2lmKGNvbmZpZy5kZXZpY2Uuc2l6ZV9jbGFzczw9Y29uZmlnLmRldmljZS5TSVpFUy5YUyl7dGhpcy4kZWwuYWRkQ2xhc3MoJ29feHhzX2Zvcm1fdmlldycpO30KcmV0dXJuIHRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9LG9uX2F0dGFjaF9jYWxsYmFjazpmdW5jdGlvbigpe3RoaXMuX2lzSW5Eb209dHJ1ZTtfLmZvckVhY2godGhpcy5hbGxGaWVsZFdpZGdldHMsZnVuY3Rpb24od2lkZ2V0cyl7Xy5pbnZva2Uod2lkZ2V0cywnb25fYXR0YWNoX2NhbGxiYWNrJyk7fSk7dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO30sb25fZGV0YWNoX2NhbGxiYWNrOmZ1bmN0aW9uKCl7dGhpcy5faXNJbkRvbT1mYWxzZTt0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fSxhdXRvZm9jdXM6ZnVuY3Rpb24oKXtpZih0aGlzLm1vZGU9PT0ncmVhZG9ubHknKXt2YXIgZmlyc3RQcmltYXJ5Rm9ybUJ1dHRvbj10aGlzLiRlbC5maW5kKCdidXR0b24uYnRuLXByaW1hcnk6ZW5hYmxlZDp2aXNpYmxlOmZpcnN0KCknKTtpZihmaXJzdFByaW1hcnlGb3JtQnV0dG9uLmxlbmd0aD4wKXtyZXR1cm4gZmlyc3RQcmltYXJ5Rm9ybUJ1dHRvbi5mb2N1cygpO31lbHNle3JldHVybjt9fQp2YXIgZm9jdXNXaWRnZXQ9dGhpcy5kZWZhdWx0Rm9jdXNGaWVsZDtpZighZm9jdXNXaWRnZXR8fCFmb2N1c1dpZGdldC5pc0ZvY3VzYWJsZSgpKXt2YXIgd2lkZ2V0cz10aGlzLmFsbEZpZWxkV2lkZ2V0c1t0aGlzLnN0YXRlLmlkXTtmb3IodmFyIGk9MDtpPCh3aWRnZXRzP3dpZGdldHMubGVuZ3RoOjApO2krKyl7dmFyIHdpZGdldD13aWRnZXRzW2ldO2lmKHdpZGdldC5pc0ZvY3VzYWJsZSgpKXtmb2N1c1dpZGdldD13aWRnZXQ7YnJlYWs7fX19CmlmKGZvY3VzV2lkZ2V0KXtyZXR1cm4gZm9jdXNXaWRnZXQuYWN0aXZhdGUoe25vc2VsZWN0OnRydWUsbm9BdXRvbWF0aWNDcmVhdGU6dHJ1ZX0pO319LGNhbkJlU2F2ZWQ6ZnVuY3Rpb24oKXt2YXIgc2VsZj10aGlzO3ZhciBmaWVsZE5hbWVzPXRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt2YXIgJGxhYmVscz10aGlzLiQoJ2xhYmVsJyk7JGxhYmVscy5yZW1vdmVDbGFzcygnb19maWVsZF9pbnZhbGlkJyk7Xy5lYWNoKGZpZWxkTmFtZXMsZnVuY3Rpb24oZmllbGROYW1lKXt2YXIgaWRGb3JMYWJlbD1zZWxmLmlkc0ZvckxhYmVsc1tmaWVsZE5hbWVdO2lmKGlkRm9yTGFiZWwpeyRsYWJlbHMuZmlsdGVyKCdbZm9yPScraWRGb3JMYWJlbCsnXScpLmFkZENsYXNzKCdvX2ZpZWxkX2ludmFsaWQnKTt9fSk7cmV0dXJuIGZpZWxkTmFtZXM7fSx1cGRhdGVBbGVydEZpZWxkczpmdW5jdGlvbihhbGVydEZpZWxkcyl7dGhpcy5hbGVydEZpZWxkc1t0aGlzLnN0YXRlLnJlc19pZF09Xy5leHRlbmQodGhpcy5hbGVydEZpZWxkc1t0aGlzLnN0YXRlLnJlc19pZF18fHt9LGFsZXJ0RmllbGRzKTt0aGlzLmRpc3BsYXlUcmFuc2xhdGlvbkFsZXJ0KCk7fSxkaXNwbGF5VHJhbnNsYXRpb25BbGVydDpmdW5jdGlvbigpe3RoaXMuJCgnLm9fbm90aWZpY2F0aW9uX2JveCcpLnJlbW92ZSgpO2lmKHRoaXMuYWxlcnRGaWVsZHNbdGhpcy5zdGF0ZS5yZXNfaWRdKXt2YXIgJG5vdGlmaWNhdGlvbj0kKHF3ZWIucmVuZGVyKCdub3RpZmljYXRpb24tYm94Jyx7dHlwZTonaW5mbyd9KSkuYXBwZW5kKHF3ZWIucmVuZGVyKCd0cmFuc2xhdGlvbi1hbGVydCcse2ZpZWxkczp0aGlzLmFsZXJ0RmllbGRzW3RoaXMuc3RhdGUucmVzX2lkXSxsYW5nOl90LmRhdGFiYXNlLnBhcmFtZXRlcnMubmFtZX0pKTtpZih0aGlzLiQoJy5vX2Zvcm1fc3RhdHVzYmFyJykubGVuZ3RoKXt0aGlzLiQoJy5vX2Zvcm1fc3RhdHVzYmFyJykuYWZ0ZXIoJG5vdGlmaWNhdGlvbik7fWVsc2V7dGhpcy4kZWwucHJlcGVuZCgkbm90aWZpY2F0aW9uKTt9fX0sY29uZmlybUNoYW5nZTpmdW5jdGlvbigpe3ZhciBzZWxmPXRoaXM7cmV0dXJuIHRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKS50aGVuKGZ1bmN0aW9uKHJlc2V0V2lkZ2V0cyl7Xy5lYWNoKHJlc2V0V2lkZ2V0cyxmdW5jdGlvbih3aWRnZXQpe3NlbGYuX3NldElERm9yTGFiZWwod2lkZ2V0LHNlbGYuaWRzRm9yTGFiZWxzW3dpZGdldC5uYW1lXSk7fSk7aWYoc2VsZi4kKCcub19maWVsZF9pbnZhbGlkJykubGVuZ3RoKXtzZWxmLmNhbkJlU2F2ZWQoc2VsZi5zdGF0ZS5pZCk7fQpyZXR1cm4gcmVzZXRXaWRnZXRzO30pO30sZGlzYWJsZUJ1dHRvbnM6ZnVuY3Rpb24oKXt0aGlzLiQoJy5vX3N0YXR1c2Jhcl9idXR0b25zIGJ1dHRvbiwgLm9lX2J1dHRvbl9ib3ggYnV0dG9uJykuYXR0cignZGlzYWJsZWQnLHRydWUpO30sZW5hYmxlQnV0dG9uczpmdW5jdGlvbigpe3RoaXMuJCgnLm9fc3RhdHVzYmFyX2J1dHRvbnMgYnV0dG9uLCAub2VfYnV0dG9uX2JveCBidXR0b24nKS5yZW1vdmVBdHRyKCdkaXNhYmxlZCcpO30sZm9jdXNMYXN0QWN0aXZhdGVkV2lkZ2V0OmZ1bmN0aW9uKCl7aWYodGhpcy5sYXN0QWN0aXZhdGVkRmllbGRJbmRleCE9PS0xKXtyZXR1cm4gdGhpcy5fYWN0aXZhdGVOZXh0RmllbGRXaWRnZXQodGhpcy5zdGF0ZSx0aGlzLmxhc3RBY3RpdmF0ZWRGaWVsZEluZGV4LTEse25vQXV0b21hdGljQ3JlYXRlOnRydWV9KTt9CnJldHVybiBmYWxzZTt9LGdldExvY2FsU3RhdGU6ZnVuY3Rpb24oKXt2YXIgc3RhdGU9e307dGhpcy4kKCdkaXYub19ub3RlYm9vaycpLmVhY2goZnVuY3Rpb24oKXt2YXIgJG5vdGVib29rPSQodGhpcyk7dmFyIG5hbWU9JG5vdGVib29rLmRhdGEoJ25hbWUnKTt2YXIgaW5kZXg9LTE7JG5vdGVib29rLmZpbmQoJy5uYXYtbGluaycpLmVhY2goZnVuY3Rpb24oaSl7aWYoJCh0aGlzKS5oYXNDbGFzcygnYWN0aXZlJykpe2luZGV4PWk7fX0pO3N0YXRlW25hbWVdPWluZGV4O30pO3JldHVybiBzdGF0ZTt9LHJlc2V0TGFzdEFjdGl2YXRlZEZpZWxkOmZ1bmN0aW9uKCl7dGhpcy5sYXN0QWN0aXZhdGVkRmllbGRJbmRleD0tMTt9LHNldExvY2FsU3RhdGU6ZnVuY3Rpb24oc3RhdGUpe3RoaXMuJCgnZGl2Lm9fbm90ZWJvb2snKS5lYWNoKGZ1bmN0aW9uKCl7dmFyICRub3RlYm9vaz0kKHRoaXMpO3ZhciBuYW1lPSRub3RlYm9vay5kYXRhKCduYW1lJyk7aWYobmFtZSBpbiBzdGF0ZSl7dmFyICRwYWdlPSRub3RlYm9vay5maW5kKCc+IHVsID4gbGknKS5lcShzdGF0ZVtuYW1lXSk7aWYoISRwYWdlLmhhc0NsYXNzKCdvX2ludmlzaWJsZV9tb2RpZmllcicpKXskcGFnZS5maW5kKCdhW2RhdGEtdG9nZ2xlPSJ0YWIiXScpLmNsaWNrKCk7fX19KTt9LHVwZGF0ZVN0YXRlOmZ1bmN0aW9uKHN0YXRlLHBhcmFtcyl7dGhpcy5tb2RlPShwYXJhbXMmJidtb2RlJ2luIHBhcmFtcyk/cGFyYW1zLm1vZGU6dGhpcy5tb2RlO2lmKHBhcmFtcy5maWVsZE5hbWVzKXtyZXR1cm4gdGhpcy5jb25maXJtQ2hhbmdlKHN0YXRlLHN0YXRlLmlkLHBhcmFtcy5maWVsZE5hbWVzKTt9CnJldHVybiB0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fSxfYWN0aXZhdGVOZXh0RmllbGRXaWRnZXQ6ZnVuY3Rpb24ocmVjb3JkLGN1cnJlbnRJbmRleCl7aWYoKGN1cnJlbnRJbmRleCsxKT49KHRoaXMuYWxsRmllbGRXaWRnZXRzW3JlY29yZC5pZF18fFtdKS5sZW5ndGgpe3RoaXMudHJpZ2dlcl91cCgnZm9jdXNfY29udHJvbF9idXR0b24nKTt0aGlzLmxhc3RBY3RpdmF0ZWRGaWVsZEluZGV4PS0xO31lbHNle3ZhciBhY3RpdmF0ZWRJbmRleD10aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7aWYoYWN0aXZhdGVkSW5kZXg9PT0tMSl7dGhpcy50cmlnZ2VyX3VwKCdmb2N1c19jb250cm9sX2J1dHRvbicpO3RoaXMubGFzdEFjdGl2YXRlZEZpZWxkSW5kZXg9LTE7fQplbHNle3RoaXMubGFzdEFjdGl2YXRlZEZpZWxkSW5kZXg9YWN0aXZhdGVkSW5kZXg7fX0KcmV0dXJuIHRoaXMubGFzdEFjdGl2YXRlZEZpZWxkSW5kZXg7fSxfYWRkQnV0dG9uVG9vbHRpcDpmdW5jdGlvbihub2RlLCRidXR0b24pe3ZhciBzZWxmPXRoaXM7JGJ1dHRvbi50b29sdGlwKHt0aXRsZTpmdW5jdGlvbigpe3JldHVybiBxd2ViLnJlbmRlcignV2lkZ2V0QnV0dG9uLnRvb2x0aXAnLHtkZWJ1Zzpjb25maWcuaXNEZWJ1ZygpLHN0YXRlOnNlbGYuc3RhdGUsbm9kZTpub2RlLH0pO30sfSk7fSxfYWRkT25DbGlja0FjdGlvbjpmdW5jdGlvbigkZWwsbm9kZSl7aWYobm9kZS5hdHRycy5zcGVjaWFsfHxub2RlLmF0dHJzLmNvbmZpcm18fG5vZGUuYXR0cnMudHlwZXx8JGVsLmhhc0NsYXNzKCdvZV9zdGF0X2J1dHRvbicpKXt2YXIgc2VsZj10aGlzOyRlbC5jbGljayhmdW5jdGlvbigpe3NlbGYudHJpZ2dlcl91cCgnYnV0dG9uX2NsaWNrZWQnLHthdHRyczpub2RlLmF0dHJzLHJlY29yZDpzZWxmLnN0YXRlLH0pO30pO319LF9nZXRJREZvckxhYmVsOmZ1bmN0aW9uKG5hbWUpe3ZhciBpZEZvckxhYmVsPXRoaXMuaWRzRm9yTGFiZWxzW25hbWVdO2lmKCFpZEZvckxhYmVsKXtpZEZvckxhYmVsPV8udW5pcXVlSWQoJ29fZmllbGRfaW5wdXRfJyk7dGhpcy5pZHNGb3JMYWJlbHNbbmFtZV09aWRGb3JMYWJlbDt9CnJldHVybiBpZEZvckxhYmVsO30sX2dldFJlY29yZDpmdW5jdGlvbihyZWNvcmRJZCl7cmV0dXJuIHRoaXMuc3RhdGUuaWQ9PT1yZWNvcmRJZD90aGlzLnN0YXRlOm51bGw7fSxfcG9zdFByb2Nlc3NGaWVsZDpmdW5jdGlvbih3aWRnZXQsbm9kZSl7dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3RoaXMuX3NldElERm9yTGFiZWwod2lkZ2V0LHRoaXMuX2dldElERm9yTGFiZWwobm9kZS5hdHRycy5uYW1lKSk7aWYoSlNPTi5wYXJzZShub2RlLmF0dHJzLmRlZmF1bHRfZm9jdXN8fCIwIikpe3RoaXMuZGVmYXVsdEZvY3VzRmllbGQ9d2lkZ2V0O319LF9yZW5kZXJCdXR0b25Cb3g6ZnVuY3Rpb24obm9kZSl7dmFyIHNlbGY9dGhpczt2YXIgJHJlc3VsdD0kKCc8Jytub2RlLnRhZysnPicse2NsYXNzOidvX25vdF9mdWxsJ30pO3ZhciBuZXh0RGVmSW5kZXg9dGhpcy5kZWZzLmxlbmd0aDt2YXIgYnV0dG9ucz1fLm1hcChub2RlLmNoaWxkcmVuLGZ1bmN0aW9uKGNoaWxkKXtpZihjaGlsZC50YWc9PT0nYnV0dG9uJyl7cmV0dXJuIHNlbGYuX3JlbmRlclN0YXRCdXR0b24oY2hpbGQpO31lbHNle3JldHVybiBzZWxmLl9yZW5kZXJOb2RlKGNoaWxkKTt9fSk7dmFyICR0ZW1wV3JhcHBlcj0kKCc8ZGl2PicpO18uZWFjaChidXR0b25zLGZ1bmN0aW9uKCRidXR0b24peyRidXR0b24uYXBwZW5kVG8oJHRlbXBXcmFwcGVyKTt9KTt2YXIgZGVmcz10aGlzLmRlZnMuc2xpY2UobmV4dERlZkluZGV4KTtQcm9taXNlLmFsbChkZWZzKS50aGVuKGZ1bmN0aW9uKCl7YnV0dG9ucz0kdGVtcFdyYXBwZXIuY2hpbGRyZW4oKTt2YXIgYnV0dG9uc19wYXJ0aXRpb249Xy5wYXJ0aXRpb24oYnV0dG9ucyxmdW5jdGlvbihidXR0b24pe3JldHVybiAkKGJ1dHRvbikuaXMoJy5vX2ludmlzaWJsZV9tb2RpZmllcicpO30pO3ZhciBpbnZpc2libGVfYnV0dG9ucz1idXR0b25zX3BhcnRpdGlvblswXTt2YXIgdmlzaWJsZV9idXR0b25zPWJ1dHRvbnNfcGFydGl0aW9uWzFdO3ZhciBuYl9idXR0b25zPXNlbGYuX3JlbmRlckJ1dHRvbkJveE5iQnV0dG9ucygpO3ZhciB1bmZvbGRlZF9idXR0b25zPXZpc2libGVfYnV0dG9ucy5zbGljZSgwLG5iX2J1dHRvbnMpLmNvbmNhdChpbnZpc2libGVfYnV0dG9ucyk7dmFyIGZvbGRlZF9idXR0b25zPXZpc2libGVfYnV0dG9ucy5zbGljZShuYl9idXR0b25zKTtpZihmb2xkZWRfYnV0dG9ucy5sZW5ndGg9PT0xKXt1bmZvbGRlZF9idXR0b25zPWJ1dHRvbnM7Zm9sZGVkX2J1dHRvbnM9W107fQp2YXIgZnVsbD0odmlzaWJsZV9idXR0b25zLmxlbmd0aD5uYl9idXR0b25zKTskcmVzdWx0LnRvZ2dsZUNsYXNzKCdvX2Z1bGwnLGZ1bGwpLnRvZ2dsZUNsYXNzKCdvX25vdF9mdWxsJywhZnVsbCk7Xy5lYWNoKHVuZm9sZGVkX2J1dHRvbnMsZnVuY3Rpb24oYnV0dG9uKXskKGJ1dHRvbikuYXBwZW5kVG8oJHJlc3VsdCk7fSk7aWYoZm9sZGVkX2J1dHRvbnMubGVuZ3RoKXskcmVzdWx0LmFwcGVuZChkb20ucmVuZGVyQnV0dG9uKHthdHRyczp7J2NsYXNzJzonb2Vfc3RhdF9idXR0b24gb19idXR0b25fbW9yZSBkcm9wZG93bi10b2dnbGUnLCdkYXRhLXRvZ2dsZSc6J2Ryb3Bkb3duJyx9LHRleHQ6X3QoIk1vcmUiKSx9KSk7dmFyICRkcm9wZG93bj0kKCI8ZGl2PiIse2NsYXNzOiJkcm9wZG93bi1tZW51IG9fZHJvcGRvd25fbW9yZSIscm9sZToibWVudSJ9KTtfLmVhY2goZm9sZGVkX2J1dHRvbnMsZnVuY3Rpb24oYnV0dG9uKXskKGJ1dHRvbikuYWRkQ2xhc3MoJ2Ryb3Bkb3duLWl0ZW0nKS5hcHBlbmRUbygkZHJvcGRvd24pO30pOyRkcm9wZG93bi5hcHBlbmRUbygkcmVzdWx0KTt9fSk7dGhpcy5faGFuZGxlQXR0cmlidXRlcygkcmVzdWx0LG5vZGUpO3RoaXMuX3JlZ2lzdGVyTW9kaWZpZXJzKG5vZGUsdGhpcy5zdGF0ZSwkcmVzdWx0KTtyZXR1cm4gJHJlc3VsdDt9LF9yZW5kZXJCdXR0b25Cb3hOYkJ1dHRvbnM6ZnVuY3Rpb24oKXtyZXR1cm5bMiwyLDQsNl1bY29uZmlnLmRldmljZS5zaXplX2NsYXNzXXx8Nzt9LF9yZW5kZXJHZW5lcmljVGFnOmZ1bmN0aW9uKG5vZGUpe3ZhciAkcmVzdWx0PSQoJzwnK25vZGUudGFnKyc+JyxfLm9taXQobm9kZS5hdHRycywnbW9kaWZpZXJzJykpO3RoaXMuX2hhbmRsZUF0dHJpYnV0ZXMoJHJlc3VsdCxub2RlKTt0aGlzLl9yZWdpc3Rlck1vZGlmaWVycyhub2RlLHRoaXMuc3RhdGUsJHJlc3VsdCk7JHJlc3VsdC5hcHBlbmQoXy5tYXAobm9kZS5jaGlsZHJlbix0aGlzLl9yZW5kZXJOb2RlLmJpbmQodGhpcykpKTtyZXR1cm4gJHJlc3VsdDt9LF9yZW5kZXJIZWFkZXJCdXR0b246ZnVuY3Rpb24obm9kZSl7dmFyICRidXR0b249dmlld1V0aWxzLnJlbmRlckJ1dHRvbkZyb21Ob2RlKG5vZGUpO2lmKCRidXR0b24ubm90KCcuYnRuLXByaW1hcnksIC5idG4tc2Vjb25kYXJ5LCAuYnRuLWxpbmssIC5idG4tc3VjY2VzcywgLmJ0bi1pbmZvLCAuYnRuLXdhcm5pbmcsIC5idG4tZGFuZ2VyJykubGVuZ3RoKXskYnV0dG9uLmFkZENsYXNzKCdidG4tc2Vjb25kYXJ5Jyk7fQp0aGlzLl9hZGRPbkNsaWNrQWN0aW9uKCRidXR0b24sbm9kZSk7dGhpcy5faGFuZGxlQXR0cmlidXRlcygkYnV0dG9uLG5vZGUpO3RoaXMuX3JlZ2lzdGVyTW9kaWZpZXJzKG5vZGUsdGhpcy5zdGF0ZSwkYnV0dG9uKTtpZihjb25maWcuaXNEZWJ1ZygpfHxub2RlLmF0dHJzLmhlbHApe3RoaXMuX2FkZEJ1dHRvblRvb2x0aXAobm9kZSwkYnV0dG9uKTt9CnJldHVybiAkYnV0dG9uO30sX3JlbmRlckhlYWRlckJ1dHRvbnM6ZnVuY3Rpb24obm9kZSl7dmFyIHNlbGY9dGhpczt2YXIgJGJ1dHRvbnM9JCgnPGRpdj4nLHtjbGFzczonb19zdGF0dXNiYXJfYnV0dG9ucyd9KTtfLmVhY2gobm9kZS5jaGlsZHJlbixmdW5jdGlvbihjaGlsZCl7aWYoY2hpbGQudGFnPT09J2J1dHRvbicpeyRidXR0b25zLmFwcGVuZChzZWxmLl9yZW5kZXJIZWFkZXJCdXR0b24oY2hpbGQpKTt9CmlmKGNoaWxkLnRhZz09PSd3aWRnZXQnKXskYnV0dG9ucy5hcHBlbmQoc2VsZi5fcmVuZGVyVGFnV2lkZ2V0KGNoaWxkKSk7fX0pO3JldHVybiAkYnV0dG9uczt9LF9yZW5kZXJJbm5lckdyb3VwOmZ1bmN0aW9uKG5vZGUpe3ZhciBzZWxmPXRoaXM7dmFyICRyZXN1bHQ9JCgnPHRhYmxlLz4nLHtjbGFzczonb19ncm91cCBvX2lubmVyX2dyb3VwJ30pO3ZhciAkdGJvZHk9JCgnPHRib2R5IC8+JykuYXBwZW5kVG8oJHJlc3VsdCk7dGhpcy5faGFuZGxlQXR0cmlidXRlcygkcmVzdWx0LG5vZGUpO3RoaXMuX3JlZ2lzdGVyTW9kaWZpZXJzKG5vZGUsdGhpcy5zdGF0ZSwkcmVzdWx0KTt2YXIgY29sPXBhcnNlSW50KG5vZGUuYXR0cnMuY29sLDEwKXx8dGhpcy5JTk5FUl9HUk9VUF9DT0w7aWYobm9kZS5hdHRycy5zdHJpbmcpe3ZhciAkc2VwPSQoJzx0cj48dGQgY29sc3Bhbj0iJytjb2wrJyIgc3R5bGU9IndpZHRoOiAxMDAlOyI+PGRpdiBjbGFzcz0ib19ob3Jpem9udGFsX3NlcGFyYXRvciI+Jytub2RlLmF0dHJzLnN0cmluZysnPC9kaXY+PC90ZD48L3RyPicpOyRyZXN1bHQuYXBwZW5kKCRzZXApO30KdmFyIHJvd3M9W107dmFyICRjdXJyZW50Um93PSQoJzx0ci8+Jyk7dmFyIGN1cnJlbnRDb2xzcGFuPTA7bm9kZS5jaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uKGNoaWxkKXtpZihjaGlsZC50YWc9PT0nbmV3bGluZScpe3Jvd3MucHVzaCgkY3VycmVudFJvdyk7JGN1cnJlbnRSb3c9JCgnPHRyLz4nKTtjdXJyZW50Q29sc3Bhbj0wO3JldHVybjt9CnZhciBjb2xzcGFuPXBhcnNlSW50KGNoaWxkLmF0dHJzLmNvbHNwYW4sMTApO3ZhciBpc0xhYmVsZWRGaWVsZD0oY2hpbGQudGFnPT09J2ZpZWxkJyYmY2hpbGQuYXR0cnMubm9sYWJlbCE9PScxJyk7aWYoIWNvbHNwYW4pe2lmKGlzTGFiZWxlZEZpZWxkKXtjb2xzcGFuPTI7fWVsc2V7Y29sc3Bhbj0xO319CnZhciBmaW5hbENvbHNwYW49Y29sc3Bhbi0oaXNMYWJlbGVkRmllbGQ/MTowKTtjdXJyZW50Q29sc3Bhbis9Y29sc3BhbjtpZihjdXJyZW50Q29sc3Bhbj5jb2wpe3Jvd3MucHVzaCgkY3VycmVudFJvdyk7JGN1cnJlbnRSb3c9JCgnPHRyLz4nKTtjdXJyZW50Q29sc3Bhbj1jb2xzcGFuO30KdmFyICR0ZHM7aWYoY2hpbGQudGFnPT09J2ZpZWxkJyl7JHRkcz1zZWxmLl9yZW5kZXJJbm5lckdyb3VwRmllbGQoY2hpbGQpO31lbHNlIGlmKGNoaWxkLnRhZz09PSdsYWJlbCcpeyR0ZHM9c2VsZi5fcmVuZGVySW5uZXJHcm91cExhYmVsKGNoaWxkKTt9ZWxzZXtpZihjaGlsZC50YWc9PT0nZGl2JyYmY2hpbGQuYXR0cnMuY2xhc3MhPT11bmRlZmluZWQmJmNoaWxkLmF0dHJzLmNsYXNzLmluY2x1ZGVzKCdvX3RkX2xhYmVsJykpCiR0ZHM9JCgnPHRkIGNsYXNzPSJvX3RkX2xhYmVsIi8+JykuYXBwZW5kKHNlbGYuX3JlbmRlck5vZGUoY2hpbGQpKTtlbHNlCiR0ZHM9JCgnPHRkLz4nKS5hcHBlbmQoc2VsZi5fcmVuZGVyTm9kZShjaGlsZCkpO30KaWYoZmluYWxDb2xzcGFuPjEpeyR0ZHMubGFzdCgpLmF0dHIoJ2NvbHNwYW4nLGZpbmFsQ29sc3Bhbik7fQokY3VycmVudFJvdy5hcHBlbmQoJHRkcyk7fSk7cm93cy5wdXNoKCRjdXJyZW50Um93KTtfLmVhY2gocm93cyxmdW5jdGlvbigkdHIpe3ZhciBub25MYWJlbENvbFNpemU9MTAwLyhjb2wtJHRyLmNoaWxkcmVuKCcub190ZF9sYWJlbCcpLmxlbmd0aCk7Xy5lYWNoKCR0ci5jaGlsZHJlbignOm5vdCgub190ZF9sYWJlbCknKSxmdW5jdGlvbihlbCl7dmFyICRlbD0kKGVsKTskZWwuY3NzKCd3aWR0aCcsKChwYXJzZUludCgkZWwuYXR0cignY29sc3BhbicpLDEwKXx8MSkqbm9uTGFiZWxDb2xTaXplKSsnJScpO30pOyR0Ym9keS5hcHBlbmQoJHRyKTt9KTtyZXR1cm4gJHJlc3VsdDt9LF9yZW5kZXJJbm5lckdyb3VwRmllbGQ6ZnVuY3Rpb24obm9kZSl7dmFyICRlbD10aGlzLl9yZW5kZXJGaWVsZFdpZGdldChub2RlLHRoaXMuc3RhdGUpO3ZhciAkdGRzPSQoJzx0ZC8+JykuYXBwZW5kKCRlbCk7aWYobm9kZS5hdHRycy5ub2xhYmVsIT09JzEnKXt2YXIgJGxhYmVsVGQ9dGhpcy5fcmVuZGVySW5uZXJHcm91cExhYmVsKG5vZGUpOyR0ZHM9JGxhYmVsVGQuYWRkKCR0ZHMpO30KcmV0dXJuICR0ZHM7fSxfcmVuZGVySW5uZXJHcm91cExhYmVsOmZ1bmN0aW9uKGxhYmVsKXtyZXR1cm4gJCgnPHRkLz4nLHtjbGFzczonb190ZF9sYWJlbCd9KS5hcHBlbmQodGhpcy5fcmVuZGVyVGFnTGFiZWwobGFiZWwpKTt9LF9yZW5kZXJOb2RlOmZ1bmN0aW9uKG5vZGUpe3ZhciByZW5kZXJlcj10aGlzWydfcmVuZGVyVGFnJytfLnN0ci5jYXBpdGFsaXplKG5vZGUudGFnKV07aWYocmVuZGVyZXIpe3JldHVybiByZW5kZXJlci5jYWxsKHRoaXMsbm9kZSk7fQppZihub2RlLnRhZz09PSdkaXYnJiZub2RlLmF0dHJzLm5hbWU9PT0nYnV0dG9uX2JveCcpe3JldHVybiB0aGlzLl9yZW5kZXJCdXR0b25Cb3gobm9kZSk7fQppZihfLmlzU3RyaW5nKG5vZGUpKXtyZXR1cm4gbm9kZTt9CnJldHVybiB0aGlzLl9yZW5kZXJHZW5lcmljVGFnKG5vZGUpO30sX3JlbmRlck91dGVyR3JvdXA6ZnVuY3Rpb24obm9kZSl7dmFyIHNlbGY9dGhpczt2YXIgJHJlc3VsdD0kKCc8ZGl2Lz4nLHtjbGFzczonb19ncm91cCd9KTt2YXIgbmJDb2xzPXBhcnNlSW50KG5vZGUuYXR0cnMuY29sLDEwKXx8dGhpcy5PVVRFUl9HUk9VUF9DT0w7dmFyIGNvbFNpemU9TWF0aC5tYXgoMSxNYXRoLnJvdW5kKDEyL25iQ29scykpO2lmKG5vZGUuYXR0cnMuc3RyaW5nKXt2YXIgJHNlcD0kKCc8ZGl2Lz4nLHtjbGFzczonb19ob3Jpem9udGFsX3NlcGFyYXRvcid9KS50ZXh0KG5vZGUuYXR0cnMuc3RyaW5nKTskcmVzdWx0LmFwcGVuZCgkc2VwKTt9CiRyZXN1bHQuYXBwZW5kKF8ubWFwKG5vZGUuY2hpbGRyZW4sZnVuY3Rpb24oY2hpbGQpe2lmKGNoaWxkLnRhZz09PSduZXdsaW5lJyl7cmV0dXJuICQoJzxici8+Jyk7fQp2YXIgJGNoaWxkPXNlbGYuX3JlbmRlck5vZGUoY2hpbGQpOyRjaGlsZC5hZGRDbGFzcygnb19ncm91cF9jb2xfJysoY29sU2l6ZSoocGFyc2VJbnQoY2hpbGQuYXR0cnMuY29sc3BhbiwxMCl8fDEpKSk7cmV0dXJuICRjaGlsZDt9KSk7dGhpcy5faGFuZGxlQXR0cmlidXRlcygkcmVzdWx0LG5vZGUpO3RoaXMuX3JlZ2lzdGVyTW9kaWZpZXJzKG5vZGUsdGhpcy5zdGF0ZSwkcmVzdWx0KTtyZXR1cm4gJHJlc3VsdDt9LF9yZW5kZXJTdGF0QnV0dG9uOmZ1bmN0aW9uKG5vZGUpe3ZhciAkYnV0dG9uPXZpZXdVdGlscy5yZW5kZXJCdXR0b25Gcm9tTm9kZShub2RlLHtleHRyYUNsYXNzOidvZV9zdGF0X2J1dHRvbicsfSk7JGJ1dHRvbi5hcHBlbmQoXy5tYXAobm9kZS5jaGlsZHJlbix0aGlzLl9yZW5kZXJOb2RlLmJpbmQodGhpcykpKTtpZihub2RlLmF0dHJzLmhlbHApe3RoaXMuX2FkZEJ1dHRvblRvb2x0aXAobm9kZSwkYnV0dG9uKTt9CnRoaXMuX2FkZE9uQ2xpY2tBY3Rpb24oJGJ1dHRvbixub2RlKTt0aGlzLl9oYW5kbGVBdHRyaWJ1dGVzKCRidXR0b24sbm9kZSk7dGhpcy5fcmVnaXN0ZXJNb2RpZmllcnMobm9kZSx0aGlzLnN0YXRlLCRidXR0b24pO3JldHVybiAkYnV0dG9uO30sX3JlbmRlclRhYkhlYWRlcjpmdW5jdGlvbihwYWdlLHBhZ2VfaWQpe3ZhciAkYT0kKCc8YT4nLHsnZGF0YS10b2dnbGUnOid0YWInLGRpc2FibGVfYW5jaG9yOid0cnVlJyxocmVmOicjJytwYWdlX2lkLGNsYXNzOiduYXYtbGluaycscm9sZTondGFiJyx0ZXh0OnBhZ2UuYXR0cnMuc3RyaW5nLH0pO3JldHVybiAkKCc8bGk+Jyx7Y2xhc3M6J25hdi1pdGVtJ30pLmFwcGVuZCgkYSk7fSxfcmVuZGVyVGFiUGFnZTpmdW5jdGlvbihwYWdlLHBhZ2VfaWQpe3ZhciAkcmVzdWx0PSQoJzxkaXYgY2xhc3M9InRhYi1wYW5lIiBpZD0iJytwYWdlX2lkKyciPicpOyRyZXN1bHQuYXBwZW5kKF8ubWFwKHBhZ2UuY2hpbGRyZW4sdGhpcy5fcmVuZGVyTm9kZS5iaW5kKHRoaXMpKSk7cmV0dXJuICRyZXN1bHQ7fSxfcmVuZGVyVGFnQnV0dG9uOmZ1bmN0aW9uKG5vZGUpe3ZhciAkYnV0dG9uPXZpZXdVdGlscy5yZW5kZXJCdXR0b25Gcm9tTm9kZShub2RlKTskYnV0dG9uLmFwcGVuZChfLm1hcChub2RlLmNoaWxkcmVuLHRoaXMuX3JlbmRlck5vZGUuYmluZCh0aGlzKSkpO3RoaXMuX2FkZE9uQ2xpY2tBY3Rpb24oJGJ1dHRvbixub2RlKTt0aGlzLl9oYW5kbGVBdHRyaWJ1dGVzKCRidXR0b24sbm9kZSk7dGhpcy5fcmVnaXN0ZXJNb2RpZmllcnMobm9kZSx0aGlzLnN0YXRlLCRidXR0b24pO2lmKGNvbmZpZy5pc0RlYnVnKCl8fG5vZGUuYXR0cnMuaGVscCl7dGhpcy5fYWRkQnV0dG9uVG9vbHRpcChub2RlLCRidXR0b24pO30KcmV0dXJuICRidXR0b247fSxfcmVuZGVyVGFnRmllbGQ6ZnVuY3Rpb24obm9kZSl7cmV0dXJuIHRoaXMuX3JlbmRlckZpZWxkV2lkZ2V0KG5vZGUsdGhpcy5zdGF0ZSk7fSxfcmVuZGVyVGFnRm9ybTpmdW5jdGlvbihub2RlKXt2YXIgJHJlc3VsdD0kKCc8ZGl2Lz4nKTtpZihub2RlLmF0dHJzLmNsYXNzKXskcmVzdWx0LmFkZENsYXNzKG5vZGUuYXR0cnMuY2xhc3MpO30KdmFyIGFsbE5vZGVzPW5vZGUuY2hpbGRyZW4ubWFwKHRoaXMuX3JlbmRlck5vZGUuYmluZCh0aGlzKSk7JHJlc3VsdC5hcHBlbmQoYWxsTm9kZXMpO3JldHVybiAkcmVzdWx0O30sX3JlbmRlclRhZ0dyb3VwOmZ1bmN0aW9uKG5vZGUpe3ZhciBpc091dGVyR3JvdXA9Xy5zb21lKG5vZGUuY2hpbGRyZW4sZnVuY3Rpb24oY2hpbGQpe3JldHVybiBjaGlsZC50YWc9PT0nZ3JvdXAnO30pO2lmKCFpc091dGVyR3JvdXApe3JldHVybiB0aGlzLl9yZW5kZXJJbm5lckdyb3VwKG5vZGUpO30KcmV0dXJuIHRoaXMuX3JlbmRlck91dGVyR3JvdXAobm9kZSk7fSxfcmVuZGVyVGFnSGVhZGVyOmZ1bmN0aW9uKG5vZGUpe3ZhciBzZWxmPXRoaXM7dmFyICRzdGF0dXNiYXI9JCgnPGRpdj4nLHtjbGFzczonb19mb3JtX3N0YXR1c2Jhcid9KTskc3RhdHVzYmFyLmFwcGVuZCh0aGlzLl9yZW5kZXJIZWFkZXJCdXR0b25zKG5vZGUpKTtfLmVhY2gobm9kZS5jaGlsZHJlbixmdW5jdGlvbihjaGlsZCl7aWYoY2hpbGQudGFnPT09J2ZpZWxkJyl7dmFyICRlbD1zZWxmLl9yZW5kZXJGaWVsZFdpZGdldChjaGlsZCxzZWxmLnN0YXRlKTskc3RhdHVzYmFyLmFwcGVuZCgkZWwpO319KTt0aGlzLl9oYW5kbGVBdHRyaWJ1dGVzKCRzdGF0dXNiYXIsbm9kZSk7dGhpcy5fcmVnaXN0ZXJNb2RpZmllcnMobm9kZSx0aGlzLnN0YXRlLCRzdGF0dXNiYXIpO3JldHVybiAkc3RhdHVzYmFyO30sX3JlbmRlclRhZ0xhYmVsOmZ1bmN0aW9uKG5vZGUpe3ZhciBzZWxmPXRoaXM7dmFyIHRleHQ7dmFyIGZpZWxkTmFtZT1ub2RlLnRhZz09PSdsYWJlbCc/bm9kZS5hdHRycy5mb3I6bm9kZS5hdHRycy5uYW1lO2lmKCdzdHJpbmcnaW4gbm9kZS5hdHRycyl7dGV4dD1ub2RlLmF0dHJzLnN0cmluZzt9ZWxzZSBpZihmaWVsZE5hbWUpe3RleHQ9dGhpcy5zdGF0ZS5maWVsZHNbZmllbGROYW1lXS5zdHJpbmc7fWVsc2V7cmV0dXJuIHRoaXMuX3JlbmRlckdlbmVyaWNUYWcobm9kZSk7fQp2YXIgJHJlc3VsdD0kKCc8bGFiZWw+Jyx7Y2xhc3M6J29fZm9ybV9sYWJlbCcsZm9yOnRoaXMuX2dldElERm9yTGFiZWwoZmllbGROYW1lKSx0ZXh0OnRleHQsfSk7aWYobm9kZS50YWc9PT0nbGFiZWwnKXt0aGlzLl9oYW5kbGVBdHRyaWJ1dGVzKCRyZXN1bHQsbm9kZSk7fQp2YXIgbW9kaWZpZXJzT3B0aW9ucztpZihmaWVsZE5hbWUpe21vZGlmaWVyc09wdGlvbnM9e2NhbGxiYWNrOmZ1bmN0aW9uKGVsZW1lbnQsbW9kaWZpZXJzLHJlY29yZCl7dmFyIHdpZGdldHM9c2VsZi5hbGxGaWVsZFdpZGdldHNbcmVjb3JkLmlkXTt2YXIgd2lkZ2V0PV8uZmluZFdoZXJlKHdpZGdldHMse25hbWU6ZmllbGROYW1lfSk7aWYoIXdpZGdldCl7cmV0dXJuO30KZWxlbWVudC4kZWwudG9nZ2xlQ2xhc3MoJ29fZm9ybV9sYWJlbF9lbXB0eScsISEocmVjb3JkLmRhdGEuaWQmJihtb2RpZmllcnMucmVhZG9ubHl8fHNlbGYubW9kZT09PSdyZWFkb25seScpJiYhd2lkZ2V0LmlzU2V0KCkpKTt9LH07fQp0aGlzLl9yZWdpc3Rlck1vZGlmaWVycyhub2RlLHRoaXMuc3RhdGUsJHJlc3VsdCxtb2RpZmllcnNPcHRpb25zKTtyZXR1cm4gJHJlc3VsdDt9LF9yZW5kZXJUYWdOb3RlYm9vazpmdW5jdGlvbihub2RlKXt2YXIgc2VsZj10aGlzO3ZhciAkaGVhZGVycz0kKCc8dWwgY2xhc3M9Im5hdiBuYXYtdGFicyI+Jyk7dmFyICRwYWdlcz0kKCc8ZGl2IGNsYXNzPSJ0YWItY29udGVudCI+Jyk7dmFyIGF1dG9mb2N1c1RhYj0tMTt2YXIgcmVuZGVyZWRUYWJzPV8ubWFwKG5vZGUuY2hpbGRyZW4sZnVuY3Rpb24oY2hpbGQsaW5kZXgpe3ZhciBwYWdlSUQ9Xy51bmlxdWVJZCgnbm90ZWJvb2tfcGFnZV8nKTt2YXIgJGhlYWRlcj1zZWxmLl9yZW5kZXJUYWJIZWFkZXIoY2hpbGQscGFnZUlEKTt2YXIgJHBhZ2U9c2VsZi5fcmVuZGVyVGFiUGFnZShjaGlsZCxwYWdlSUQpO2lmKGF1dG9mb2N1c1RhYj09PS0xJiZjaGlsZC5hdHRycy5hdXRvZm9jdXM9PT0nYXV0b2ZvY3VzJyl7YXV0b2ZvY3VzVGFiPWluZGV4O30Kc2VsZi5faGFuZGxlQXR0cmlidXRlcygkaGVhZGVyLGNoaWxkKTskaGVhZGVycy5hcHBlbmQoJGhlYWRlcik7JHBhZ2VzLmFwcGVuZCgkcGFnZSk7cmV0dXJueyRoZWFkZXI6JGhlYWRlciwkcGFnZTokcGFnZSxub2RlOmNoaWxkLH07fSk7aWYocmVuZGVyZWRUYWJzLmxlbmd0aCl7dmFyIHRhYlRvRm9jdXM9cmVuZGVyZWRUYWJzW01hdGgubWF4KDAsYXV0b2ZvY3VzVGFiKV07dGFiVG9Gb2N1cy4kaGVhZGVyLmZpbmQoJy5uYXYtbGluaycpLmFkZENsYXNzKCdhY3RpdmUnKTt0YWJUb0ZvY3VzLiRwYWdlLmFkZENsYXNzKCdhY3RpdmUnKTt9Cl8uZWFjaChyZW5kZXJlZFRhYnMsZnVuY3Rpb24odGFiKXtzZWxmLl9yZWdpc3Rlck1vZGlmaWVycyh0YWIubm9kZSxzZWxmLnN0YXRlLHRhYi4kaGVhZGVyLHtjYWxsYmFjazpmdW5jdGlvbihlbGVtZW50LG1vZGlmaWVycyl7dmFyICRsaW5rPWVsZW1lbnQuJGVsLmZpbmQoJy5uYXYtbGluaycpO2lmKG1vZGlmaWVycy5pbnZpc2libGUmJiRsaW5rLmhhc0NsYXNzKCdhY3RpdmUnKSl7JGxpbmsucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO3RhYi4kcGFnZS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7dmFyICRmaXJzdFZpc2libGVUYWI9JGhlYWRlcnMuZmluZCgnbGk6bm90KC5vX2ludmlzaWJsZV9tb2RpZmllcik6Zmlyc3QoKSA+IGEnKTskZmlyc3RWaXNpYmxlVGFiLmFkZENsYXNzKCdhY3RpdmUnKTskcGFnZXMuZmluZCgkZmlyc3RWaXNpYmxlVGFiLmF0dHIoJ2hyZWYnKSkuYWRkQ2xhc3MoJ2FjdGl2ZScpO319LH0pO30pO3ZhciAkbm90ZWJvb2s9JCgnPGRpdiBjbGFzcz0ib19ub3RlYm9vayI+JykuZGF0YSgnbmFtZScsbm9kZS5hdHRycy5uYW1lfHwnX2RlZmF1bHRfJykuYXBwZW5kKCRoZWFkZXJzLCRwYWdlcyk7dGhpcy5fcmVnaXN0ZXJNb2RpZmllcnMobm9kZSx0aGlzLnN0YXRlLCRub3RlYm9vayk7dGhpcy5faGFuZGxlQXR0cmlidXRlcygkbm90ZWJvb2ssbm9kZSk7cmV0dXJuICRub3RlYm9vazt9LF9yZW5kZXJUYWdTZXBhcmF0b3I6ZnVuY3Rpb24obm9kZSl7dmFyICRzZXBhcmF0b3I9JCgnPGRpdi8+JykuYWRkQ2xhc3MoJ29faG9yaXpvbnRhbF9zZXBhcmF0b3InKS50ZXh0KG5vZGUuYXR0cnMuc3RyaW5nKTt0aGlzLl9oYW5kbGVBdHRyaWJ1dGVzKCRzZXBhcmF0b3Isbm9kZSk7dGhpcy5fcmVnaXN0ZXJNb2RpZmllcnMobm9kZSx0aGlzLnN0YXRlLCRzZXBhcmF0b3IpO3JldHVybiAkc2VwYXJhdG9yO30sX3JlbmRlclRhZ1NoZWV0OmZ1bmN0aW9uKG5vZGUpe3RoaXMuaGFzX3NoZWV0PXRydWU7dmFyICRzaGVldD0kKCc8ZGl2Picse2NsYXNzOidjbGVhcmZpeCBwb3NpdGlvbi1yZWxhdGl2ZSBvX2Zvcm1fc2hlZXQnfSk7JHNoZWV0LmFwcGVuZChub2RlLmNoaWxkcmVuLm1hcCh0aGlzLl9yZW5kZXJOb2RlLmJpbmQodGhpcykpKTtyZXR1cm4gJHNoZWV0O30sX3JlbmRlclRhZ1dpZGdldDpmdW5jdGlvbihub2RlKXtyZXR1cm4gdGhpcy5fcmVuZGVyV2lkZ2V0KHRoaXMuc3RhdGUsbm9kZSk7fSxfcmVuZGVyVmlldzpmdW5jdGlvbigpe3ZhciBzZWxmPXRoaXM7dmFyIGRlZnM9W107dGhpcy5kZWZzPWRlZnM7dmFyICRmb3JtPXRoaXMuX3JlbmRlck5vZGUodGhpcy5hcmNoKS5hZGRDbGFzcyh0aGlzLmNsYXNzTmFtZSk7ZGVsZXRlIHRoaXMuZGVmcztyZXR1cm4gUHJvbWlzZS5hbGwoZGVmcykudGhlbihmdW5jdGlvbigpe3NlbGYuX3VwZGF0ZVZpZXcoJGZvcm0uY29udGVudHMoKSk7aWYoc2VsZi5zdGF0ZS5yZXNfaWQgaW4gc2VsZi5hbGVydEZpZWxkcyl7c2VsZi5kaXNwbGF5VHJhbnNsYXRpb25BbGVydCgpO319KS50aGVuKGZ1bmN0aW9uKCl7aWYoc2VsZi5sYXN0QWN0aXZhdGVkRmllbGRJbmRleD49MCl7c2VsZi5fYWN0aXZhdGVOZXh0RmllbGRXaWRnZXQoc2VsZi5zdGF0ZSxzZWxmLmxhc3RBY3RpdmF0ZWRGaWVsZEluZGV4KTt9CmlmKHNlbGYuX2lzSW5Eb20pe18uZm9yRWFjaChzZWxmLmFsbEZpZWxkV2lkZ2V0cyxmdW5jdGlvbih3aWRnZXRzKXtfLmludm9rZSh3aWRnZXRzLCdvbl9hdHRhY2hfY2FsbGJhY2snKTt9KTt9fSkuZ3VhcmRlZENhdGNoKGZ1bmN0aW9uKCl7JGZvcm0ucmVtb3ZlKCk7fSk7fSxfdXBkYXRlVmlldzpmdW5jdGlvbigkbmV3Q29udGVudCl7dmFyIHNlbGY9dGhpczt0aGlzLiRlbC5odG1sKCRuZXdDb250ZW50KTt0aGlzLiRlbC50b2dnbGVDbGFzcygnb19mb3JtX25vc2hlZXQnLCF0aGlzLmhhc19zaGVldCk7aWYodGhpcy5oYXNfc2hlZXQpe3RoaXMuJGVsLmNoaWxkcmVuKCkubm90KCcub2VfY2hhdHRlcicpLndyYXBBbGwoJCgnPGRpdi8+Jyx7Y2xhc3M6J29fZm9ybV9zaGVldF9iZyd9KSk7fQp0aGlzLiRlbC50b2dnbGVDbGFzcygnb19mb3JtX2VkaXRhYmxlJyx0aGlzLm1vZGU9PT0nZWRpdCcpO3RoaXMuJGVsLnRvZ2dsZUNsYXNzKCdvX2Zvcm1fcmVhZG9ubHknLHRoaXMubW9kZT09PSdyZWFkb25seScpO18uZWFjaCh0aGlzLmFsbEZpZWxkV2lkZ2V0c1t0aGlzLnN0YXRlLmlkXSxmdW5jdGlvbih3aWRnZXQpe3ZhciBpZEZvckxhYmVsPXNlbGYuaWRzRm9yTGFiZWxzW3dpZGdldC5uYW1lXTt2YXIgJHdpZGdldHM9c2VsZi4kKCcub19maWVsZF93aWRnZXRbbmFtZT0nK3dpZGdldC5uYW1lKyddJyk7dmFyICRsYWJlbD1pZEZvckxhYmVsP3NlbGYuJCgnLm9fZm9ybV9sYWJlbFtmb3I9JytpZEZvckxhYmVsKyddJyk6JCgpOyRsYWJlbD0kbGFiZWwuZXEoJHdpZGdldHMuaW5kZXgod2lkZ2V0LiRlbCkpO2lmKGNvbmZpZy5pc0RlYnVnKCl8fHdpZGdldC5hdHRycy5oZWxwfHx3aWRnZXQuZmllbGQuaGVscCl7c2VsZi5fYWRkRmllbGRUb29sdGlwKHdpZGdldCwkbGFiZWwpO30KaWYod2lkZ2V0LmF0dHJzLndpZGdldD09PSd1cGdyYWRlX2Jvb2xlYW4nKXt3aWRnZXQucmVuZGVyV2l0aExhYmVsKCRsYWJlbCk7fX0pO30sX3NldElERm9yTGFiZWw6ZnVuY3Rpb24od2lkZ2V0LGlkRm9yTGFiZWwpe3dpZGdldC5zZXRJREZvckxhYmVsKGlkRm9yTGFiZWwpO30sX29uQWN0aXZhdGVOZXh0V2lkZ2V0OmZ1bmN0aW9uKGV2KXtldi5zdG9wUHJvcGFnYXRpb24oKTt2YXIgaW5kZXg9dGhpcy5hbGxGaWVsZFdpZGdldHNbdGhpcy5zdGF0ZS5pZF0uaW5kZXhPZihldi5kYXRhLnRhcmdldCk7dGhpcy5fYWN0aXZhdGVOZXh0RmllbGRXaWRnZXQodGhpcy5zdGF0ZSxpbmRleCk7fSxfb25DbGljazpmdW5jdGlvbigpe2lmKHRoaXMubW9kZT09PSdyZWFkb25seScpe3RoaXMudHJpZ2dlcl91cCgnYm91bmNlX2VkaXQnKTt9fSxfb25OYXZpZ2F0aW9uTW92ZTpmdW5jdGlvbihldil7ZXYuc3RvcFByb3BhZ2F0aW9uKCk7dmFyIGluZGV4O2lmKGV2LmRhdGEuZGlyZWN0aW9uPT09Im5leHQiKXtpbmRleD10aGlzLmFsbEZpZWxkV2lkZ2V0c1t0aGlzLnN0YXRlLmlkXS5pbmRleE9mKGV2LmRhdGEudGFyZ2V0fHxldi50YXJnZXQpO3RoaXMuX2FjdGl2YXRlTmV4dEZpZWxkV2lkZ2V0KHRoaXMuc3RhdGUsaW5kZXgpO31lbHNlIGlmKGV2LmRhdGEuZGlyZWN0aW9uPT09InByZXZpb3VzIil7aW5kZXg9dGhpcy5hbGxGaWVsZFdpZGdldHNbdGhpcy5zdGF0ZS5pZF0uaW5kZXhPZihldi5kYXRhLnRhcmdldCk7dGhpcy5fYWN0aXZhdGVQcmV2aW91c0ZpZWxkV2lkZ2V0KHRoaXMuc3RhdGUsaW5kZXgpO319LF9vbk5vdGVib29rVGFiQ2hhbmdlZDpmdW5jdGlvbigpe2NvcmUuYnVzLnRyaWdnZXIoJ0RPTV91cGRhdGVkJyk7fSxfb25UcmFuc2xhdGU6ZnVuY3Rpb24oZXYpe2V2LnByZXZlbnREZWZhdWx0KCk7dGhpcy50cmlnZ2VyX3VwKCd0cmFuc2xhdGUnLHtmaWVsZE5hbWU6ZXYudGFyZ2V0Lm5hbWUsaWQ6dGhpcy5zdGF0ZS5pZCxpc0NvbWluZ0Zyb21UcmFuc2xhdGlvbkFsZXJ0OnRydWUsfSk7fSxfb25UcmFuc2xhdGVOb3RpZmljYXRpb25DbG9zZTpmdW5jdGlvbihldil7ZGVsZXRlIHRoaXMuYWxlcnRGaWVsZHNbdGhpcy5zdGF0ZS5yZXNfaWRdO30sfSk7cmV0dXJuIEZvcm1SZW5kZXJlcjt9KTs7CgovKiAvd2ViL3N0YXRpYy9zcmMvanMvdmlld3MvZm9ybS9mb3JtX2NvbnRyb2xsZXIuanMgZGVmaW5lZCBpbiBidW5kbGUgJ3dlYi5hc3NldHNfYmFja2VuZCcgKi8Kb2Rvby5kZWZpbmUoJ3dlYi5Gb3JtQ29udHJvbGxlcicsZnVuY3Rpb24ocmVxdWlyZSl7InVzZSBzdHJpY3QiO3ZhciBCYXNpY0NvbnRyb2xsZXI9cmVxdWlyZSgnd2ViLkJhc2ljQ29udHJvbGxlcicpO3ZhciBjb3JlPXJlcXVpcmUoJ3dlYi5jb3JlJyk7dmFyIERpYWxvZz1yZXF1aXJlKCd3ZWIuRGlhbG9nJyk7dmFyIGRpYWxvZ3M9cmVxdWlyZSgnd2ViLnZpZXdfZGlhbG9ncycpO3ZhciBTaWRlYmFyPXJlcXVpcmUoJ3dlYi5TaWRlYmFyJyk7dmFyIF90PWNvcmUuX3Q7dmFyIHF3ZWI9Y29yZS5xd2ViO3ZhciBGb3JtQ29udHJvbGxlcj1CYXNpY0NvbnRyb2xsZXIuZXh0ZW5kKHtjdXN0b21fZXZlbnRzOl8uZXh0ZW5kKHt9LEJhc2ljQ29udHJvbGxlci5wcm90b3R5cGUuY3VzdG9tX2V2ZW50cyx7Ym91bmNlX2VkaXQ6J19vbkJvdW5jZUVkaXQnLGJ1dHRvbl9jbGlja2VkOidfb25CdXR0b25DbGlja2VkJyxlZGl0ZWRfbGlzdDonX29uRWRpdGVkTGlzdCcsb3Blbl9vbmUybWFueV9yZWNvcmQ6J19vbk9wZW5PbmUyTWFueVJlY29yZCcsb3Blbl9yZWNvcmQ6J19vbk9wZW5SZWNvcmQnLHRvZ2dsZV9jb2x1bW5fb3JkZXI6J19vblRvZ2dsZUNvbHVtbk9yZGVyJyxmb2N1c19jb250cm9sX2J1dHRvbjonX29uRm9jdXNDb250cm9sQnV0dG9uJyxmb3JtX2RpYWxvZ19kaXNjYXJkZWQ6J19vbkZvcm1EaWFsb2dEaXNjYXJkZWQnLH0pLGluaXQ6ZnVuY3Rpb24ocGFyZW50LG1vZGVsLHJlbmRlcmVyLHBhcmFtcyl7dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3RoaXMuYWN0aW9uQnV0dG9ucz1wYXJhbXMuYWN0aW9uQnV0dG9uczt0aGlzLmRpc2FibGVBdXRvZm9jdXM9cGFyYW1zLmRpc2FibGVBdXRvZm9jdXM7dGhpcy5mb290ZXJUb0J1dHRvbnM9cGFyYW1zLmZvb3RlclRvQnV0dG9uczt0aGlzLmRlZmF1bHRCdXR0b25zPXBhcmFtcy5kZWZhdWx0QnV0dG9uczt0aGlzLmhhc1NpZGViYXI9cGFyYW1zLmhhc1NpZGViYXI7dGhpcy50b29sYmFyQWN0aW9ucz1wYXJhbXMudG9vbGJhckFjdGlvbnN8fHt9O30sb25fYXR0YWNoX2NhbGxiYWNrOmZ1bmN0aW9uKCl7dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3RoaXMuYXV0b2ZvY3VzKCk7fSx3aWxsUmVzdG9yZTpmdW5jdGlvbigpe3RoaXMubW9kZT10aGlzLm1vZGVsLmlzTmV3KHRoaXMuaGFuZGxlKT8nZWRpdCc6J3JlYWRvbmx5Jzt9LGF1dG9mb2N1czpmdW5jdGlvbigpe2lmKCF0aGlzLmRpc2FibGVBdXRvZm9jdXMpe3ZhciBpc0NvbnRyb2xBY3RpdnRlZD10aGlzLnJlbmRlcmVyLmF1dG9mb2N1cygpO2lmKCFpc0NvbnRyb2xBY3RpdnRlZCl7aWYodGhpcy4kYnV0dG9ucyYmdGhpcy5tb2RlPT09J3JlYWRvbmx5Jyl7cmV0dXJuIHRoaXMuJGJ1dHRvbnMuZmluZCgnLm9fZm9ybV9idXR0b25fZWRpdCcpLmZvY3VzKCk7fX19fSxjcmVhdGVSZWNvcmQ6ZnVuY3Rpb24ocGFyZW50SUQpe3ZhciBzZWxmPXRoaXM7dmFyIHJlY29yZD10aGlzLm1vZGVsLmdldCh0aGlzLmhhbmRsZSx7cmF3OnRydWV9KTtyZXR1cm4gdGhpcy5tb2RlbC5sb2FkKHtjb250ZXh0OnJlY29yZC5nZXRDb250ZXh0KCksZmllbGRzOnJlY29yZC5maWVsZHMsZmllbGRzSW5mbzpyZWNvcmQuZmllbGRzSW5mbyxtb2RlbE5hbWU6dGhpcy5tb2RlbE5hbWUscGFyZW50SUQ6cGFyZW50SUQscmVzX2lkczpyZWNvcmQucmVzX2lkcyx0eXBlOidyZWNvcmQnLHZpZXdUeXBlOidmb3JtJyx9KS50aGVuKGZ1bmN0aW9uKGhhbmRsZSl7c2VsZi5oYW5kbGU9aGFuZGxlO3NlbGYuX3VwZGF0ZUVudigpO3JldHVybiBzZWxmLl9zZXRNb2RlKCdlZGl0Jyk7fSk7fSxnZXRTZWxlY3RlZElkczpmdW5jdGlvbigpe3ZhciBlbnY9dGhpcy5tb2RlbC5nZXQodGhpcy5oYW5kbGUse2Vudjp0cnVlfSk7cmV0dXJuIGVudi5jdXJyZW50SWQ/W2Vudi5jdXJyZW50SWRdOltdO30sZ2V0VGl0bGU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tb2RlbC5nZXROYW1lKHRoaXMuaGFuZGxlKTt9LHJlbmRlckJ1dHRvbnM6ZnVuY3Rpb24oJG5vZGUpe3ZhciAkZm9vdGVyPXRoaXMuZm9vdGVyVG9CdXR0b25zP3RoaXMucmVuZGVyZXIuJCgnZm9vdGVyJyk6bnVsbDt2YXIgbXVzdFJlbmRlckZvb3RlckJ1dHRvbnM9JGZvb3RlciYmJGZvb3Rlci5sZW5ndGg7aWYoIXRoaXMuZGVmYXVsdEJ1dHRvbnMmJiFtdXN0UmVuZGVyRm9vdGVyQnV0dG9ucyl7cmV0dXJuO30KdGhpcy4kYnV0dG9ucz0kKCc8ZGl2Lz4nKTtpZihtdXN0UmVuZGVyRm9vdGVyQnV0dG9ucyl7dGhpcy4kYnV0dG9ucy5hcHBlbmQoJGZvb3Rlcik7fWVsc2V7dGhpcy4kYnV0dG9ucy5hcHBlbmQocXdlYi5yZW5kZXIoIkZvcm1WaWV3LmJ1dHRvbnMiLHt3aWRnZXQ6dGhpc30pKTt0aGlzLiRidXR0b25zLm9uKCdjbGljaycsJy5vX2Zvcm1fYnV0dG9uX2VkaXQnLHRoaXMuX29uRWRpdC5iaW5kKHRoaXMpKTt0aGlzLiRidXR0b25zLm9uKCdjbGljaycsJy5vX2Zvcm1fYnV0dG9uX2NyZWF0ZScsdGhpcy5fb25DcmVhdGUuYmluZCh0aGlzKSk7dGhpcy4kYnV0dG9ucy5vbignY2xpY2snLCcub19mb3JtX2J1dHRvbl9zYXZlJyx0aGlzLl9vblNhdmUuYmluZCh0aGlzKSk7dGhpcy4kYnV0dG9ucy5vbignY2xpY2snLCcub19mb3JtX2J1dHRvbl9jYW5jZWwnLHRoaXMuX29uRGlzY2FyZC5iaW5kKHRoaXMpKTt0aGlzLl9hc3NpZ25TYXZlQ2FuY2VsS2V5Ym9hcmRCZWhhdmlvcih0aGlzLiRidXR0b25zLmZpbmQoJy5vX2Zvcm1fYnV0dG9uc19lZGl0JykpO3RoaXMuJGJ1dHRvbnMuZmluZCgnLm9fZm9ybV9idXR0b25zX2VkaXQnKS50b29sdGlwKHtkZWxheTp7c2hvdzoyMDAsaGlkZTowfSx0aXRsZTpmdW5jdGlvbigpe3JldHVybiBxd2ViLnJlbmRlcignU2F2ZUNhbmNlbEJ1dHRvbi50b29sdGlwJyk7fSx0cmlnZ2VyOidtYW51YWwnLH0pO3RoaXMuX3VwZGF0ZUJ1dHRvbnMoKTt9CnRoaXMuJGJ1dHRvbnMuYXBwZW5kVG8oJG5vZGUpO30scmVuZGVyUGFnZXI6ZnVuY3Rpb24oJG5vZGUsb3B0aW9ucyl7b3B0aW9ucz1fLmV4dGVuZCh7fSxvcHRpb25zLHt2YWxpZGF0ZTp0aGlzLmNhbkJlRGlzY2FyZGVkLmJpbmQodGhpcyksfSk7cmV0dXJuIHRoaXMuX3N1cGVyKCRub2RlLG9wdGlvbnMpO30scmVuZGVyU2lkZWJhcjpmdW5jdGlvbigkbm9kZSl7dmFyIHNlbGY9dGhpcztpZih0aGlzLmhhc1NpZGViYXIpe3ZhciBvdGhlckl0ZW1zPVtdO2lmKHRoaXMuYXJjaGl2ZUVuYWJsZWQmJnRoaXMuaW5pdGlhbFN0YXRlLmRhdGEuYWN0aXZlIT09dW5kZWZpbmVkKXt2YXIgY2xhc3NuYW1lPSJvX3NpZGViYXJfaXRlbV9hcmNoaXZlIisodGhpcy5pbml0aWFsU3RhdGUuZGF0YS5hY3RpdmU/IiI6IiBvX2hpZGRlbiIpCm90aGVySXRlbXMucHVzaCh7bGFiZWw6X3QoIkFyY2hpdmUiKSxjYWxsYmFjazpmdW5jdGlvbigpe0RpYWxvZy5jb25maXJtKHNlbGYsX3QoIkFyZSB5b3Ugc3VyZSB0aGF0IHlvdSB3YW50IHRvIGFyY2hpdmUgdGhpcyByZWNvcmQ/Iikse2NvbmZpcm1fY2FsbGJhY2s6c2VsZi5fdG9nZ2xlQXJjaGl2ZVN0YXRlLmJpbmQoc2VsZix0cnVlKSx9KTt9LGNsYXNzbmFtZTpjbGFzc25hbWUsfSk7Y2xhc3NuYW1lPSJvX3NpZGViYXJfaXRlbV91bmFyY2hpdmUiKyh0aGlzLmluaXRpYWxTdGF0ZS5kYXRhLmFjdGl2ZT8iIG9faGlkZGVuIjoiIikKb3RoZXJJdGVtcy5wdXNoKHtsYWJlbDpfdCgiVW5hcmNoaXZlIiksY2FsbGJhY2s6dGhpcy5fdG9nZ2xlQXJjaGl2ZVN0YXRlLmJpbmQodGhpcyxmYWxzZSksY2xhc3NuYW1lOmNsYXNzbmFtZSx9KTt9CmlmKHRoaXMuaXNfYWN0aW9uX2VuYWJsZWQoJ2RlbGV0ZScpKXtvdGhlckl0ZW1zLnB1c2goe2xhYmVsOl90KCdEZWxldGUnKSxjYWxsYmFjazp0aGlzLl9vbkRlbGV0ZVJlY29yZC5iaW5kKHRoaXMpLH0pO30KaWYodGhpcy5pc19hY3Rpb25fZW5hYmxlZCgnY3JlYXRlJykmJnRoaXMuaXNfYWN0aW9uX2VuYWJsZWQoJ2R1cGxpY2F0ZScpKXtvdGhlckl0ZW1zLnB1c2goe2xhYmVsOl90KCdEdXBsaWNhdGUnKSxjYWxsYmFjazp0aGlzLl9vbkR1cGxpY2F0ZVJlY29yZC5iaW5kKHRoaXMpLH0pO30KdGhpcy5zaWRlYmFyPW5ldyBTaWRlYmFyKHRoaXMse2VkaXRhYmxlOnRoaXMuaXNfYWN0aW9uX2VuYWJsZWQoJ2VkaXQnKSx2aWV3VHlwZTonZm9ybScsZW52Ontjb250ZXh0OnRoaXMubW9kZWwuZ2V0KHRoaXMuaGFuZGxlKS5nZXRDb250ZXh0KCksYWN0aXZlSWRzOnRoaXMuZ2V0U2VsZWN0ZWRJZHMoKSxtb2RlbDp0aGlzLm1vZGVsTmFtZSx9LGFjdGlvbnM6Xy5leHRlbmQodGhpcy50b29sYmFyQWN0aW9ucyx7b3RoZXI6b3RoZXJJdGVtc30pLH0pO3JldHVybiB0aGlzLnNpZGViYXIuYXBwZW5kVG8oJG5vZGUpLnRoZW4oZnVuY3Rpb24oKXtzZWxmLl91cGRhdGVTaWRlYmFyKCk7fSk7fQpyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7fSxzYXZlUmVjb3JkOmZ1bmN0aW9uKCl7dmFyIHNlbGY9dGhpcztyZXR1cm4gdGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpLnRoZW4oZnVuY3Rpb24oY2hhbmdlZEZpZWxkcyl7c2VsZi5fc2V0VGl0bGUoc2VsZi5nZXRUaXRsZSgpKTtzZWxmLl91cGRhdGVFbnYoKTtpZihfdC5kYXRhYmFzZS5tdWx0aV9sYW5nJiZjaGFuZ2VkRmllbGRzLmxlbmd0aCl7dmFyIGZpZWxkcz1zZWxmLnJlbmRlcmVyLnN0YXRlLmZpZWxkczt2YXIgZGF0YT1zZWxmLnJlbmRlcmVyLnN0YXRlLmRhdGE7dmFyIGFsZXJ0RmllbGRzPXt9O2Zvcih2YXIgaz0wO2s8Y2hhbmdlZEZpZWxkcy5sZW5ndGg7aysrKXt2YXIgZmllbGQ9ZmllbGRzW2NoYW5nZWRGaWVsZHNba11dO3ZhciBmaWVsZERhdGE9ZGF0YVtjaGFuZ2VkRmllbGRzW2tdXTtpZihmaWVsZC50cmFuc2xhdGUmJmZpZWxkRGF0YSl7YWxlcnRGaWVsZHNbY2hhbmdlZEZpZWxkc1trXV09ZmllbGQ7fX0KaWYoIV8uaXNFbXB0eShhbGVydEZpZWxkcykpe3NlbGYucmVuZGVyZXIudXBkYXRlQWxlcnRGaWVsZHMoYWxlcnRGaWVsZHMpO319CnJldHVybiBjaGFuZ2VkRmllbGRzO30pO30sdXBkYXRlOmZ1bmN0aW9uKHBhcmFtcyxvcHRpb25zKXtpZignY3VycmVudElkJ2luIHBhcmFtcyYmIXBhcmFtcy5jdXJyZW50SWQpe3RoaXMubW9kZT0nZWRpdCc7fQpwYXJhbXM9Xy5leHRlbmQoe3ZpZXdUeXBlOidmb3JtJyxtb2RlOnRoaXMubW9kZX0scGFyYW1zKTtyZXR1cm4gdGhpcy5fc3VwZXIocGFyYW1zLG9wdGlvbnMpO30sX2FyY2hpdmU6ZnVuY3Rpb24oaWRzLGFyY2hpdmUpe2lmKGlkcy5sZW5ndGg9PT0wKXtyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7fQppZihhcmNoaXZlKXtyZXR1cm4gdGhpcy5tb2RlbC5hY3Rpb25BcmNoaXZlKGlkcyx0aGlzLmhhbmRsZSkudGhlbih0aGlzLnVwZGF0ZS5iaW5kKHRoaXMse30se3JlbG9hZDpmYWxzZX0pKTt9ZWxzZXtyZXR1cm4gdGhpcy5tb2RlbC5hY3Rpb25VbmFyY2hpdmUoaWRzLHRoaXMuaGFuZGxlKS50aGVuKHRoaXMudXBkYXRlLmJpbmQodGhpcyx7fSx7cmVsb2FkOmZhbHNlfSkpO319LF9hc3NpZ25TYXZlQ2FuY2VsS2V5Ym9hcmRCZWhhdmlvcjpmdW5jdGlvbigkc2F2ZUNhbmNlbEJ1dHRvbkNvbnRhaW5lcil7dmFyIHNlbGY9dGhpczskc2F2ZUNhbmNlbEJ1dHRvbkNvbnRhaW5lci5jaGlsZHJlbigpLm9uKCdrZXlkb3duJyxmdW5jdGlvbihlKXtzd2l0Y2goZS53aGljaCl7Y2FzZSAkLnVpLmtleUNvZGUuRU5URVI6ZS5wcmV2ZW50RGVmYXVsdCgpO3NlbGYuc2F2ZVJlY29yZCgpO2JyZWFrO2Nhc2UgJC51aS5rZXlDb2RlLkVTQ0FQRTplLnByZXZlbnREZWZhdWx0KCk7c2VsZi5fZGlzY2FyZENoYW5nZXMoKTticmVhaztjYXNlICQudWkua2V5Q29kZS5UQUI6aWYoIWUuc2hpZnRLZXkmJmUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnYnRuLXByaW1hcnknKSl7JHNhdmVDYW5jZWxCdXR0b25Db250YWluZXIudG9vbHRpcCgnc2hvdycpO2UucHJldmVudERlZmF1bHQoKTt9CmJyZWFrO319KTt9LF9jb25maXJtU2F2ZTpmdW5jdGlvbihpZCl7aWYoaWQ9PT10aGlzLmhhbmRsZSl7aWYodGhpcy5tb2RlPT09J3JlYWRvbmx5Jyl7cmV0dXJuIHRoaXMucmVsb2FkKCk7fWVsc2V7cmV0dXJuIHRoaXMuX3NldE1vZGUoJ3JlYWRvbmx5Jyk7fX1lbHNle3ZhciByZWNvcmQ9dGhpcy5tb2RlbC5nZXQodGhpcy5oYW5kbGUpO3ZhciBjb250YWluc0NoYW5nZWRSZWNvcmQ9ZnVuY3Rpb24odmFsdWUpe3JldHVybiBfLmlzT2JqZWN0KHZhbHVlKSYmKHZhbHVlLmlkPT09aWR8fF8uZmluZCh2YWx1ZS5kYXRhLGNvbnRhaW5zQ2hhbmdlZFJlY29yZCkpO307dmFyIGNoYW5nZWRGaWVsZHM9Xy5maW5kS2V5KHJlY29yZC5kYXRhLGNvbnRhaW5zQ2hhbmdlZFJlY29yZCk7cmV0dXJuIHRoaXMucmVuZGVyZXIuY29uZmlybUNoYW5nZShyZWNvcmQscmVjb3JkLmlkLFtjaGFuZ2VkRmllbGRzXSk7fX0sX2Rpc2FibGVCdXR0b25zOmZ1bmN0aW9uKCl7dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3RoaXMucmVuZGVyZXIuZGlzYWJsZUJ1dHRvbnMoKTt9LF9lbmFibGVCdXR0b25zOmZ1bmN0aW9uKCl7dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3RoaXMucmVuZGVyZXIuZW5hYmxlQnV0dG9ucygpO30sX2lzUGFnZXJWaXNpYmxlOmZ1bmN0aW9uKCl7cmV0dXJuIXRoaXMubW9kZWwuaXNOZXcodGhpcy5oYW5kbGUpO30sX29uRGVsZXRlZFJlY29yZHM6ZnVuY3Rpb24oKXt2YXIgc3RhdGU9dGhpcy5tb2RlbC5nZXQodGhpcy5oYW5kbGUse3Jhdzp0cnVlfSk7aWYoIXN0YXRlLnJlc19pZHMubGVuZ3RoKXt0aGlzLnRyaWdnZXJfdXAoJ2hpc3RvcnlfYmFjaycpO31lbHNle3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9fSxfcHVzaFN0YXRlOmZ1bmN0aW9uKHN0YXRlKXtzdGF0ZT1zdGF0ZXx8e307dmFyIGVudj10aGlzLm1vZGVsLmdldCh0aGlzLmhhbmRsZSx7ZW52OnRydWV9KTtzdGF0ZS5pZD1lbnYuY3VycmVudElkO3RoaXMuX3N1cGVyKHN0YXRlKTt9LF9yZWplY3RTYXZlOmZ1bmN0aW9uKCl7aWYodGhpcy5tb2RlPT09J3JlYWRvbmx5Jyl7cmV0dXJuIHRoaXMucmVsb2FkKCk7fQpyZXR1cm4gdGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO30sX3NldE1vZGU6ZnVuY3Rpb24obW9kZSxyZWNvcmRJRCl7aWYoKHJlY29yZElEfHx0aGlzLmhhbmRsZSk9PT10aGlzLmhhbmRsZSl7dGhpcy5tb2RlbC51bmZyZWV6ZU9yZGVyKHRoaXMuaGFuZGxlKTt9CmlmKHRoaXMubW9kZSE9PW1vZGUpe3RoaXMucmVuZGVyZXIucmVzZXRMYXN0QWN0aXZhdGVkRmllbGQoKTt9CnJldHVybiB0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fSxfdXBkYXRlOmZ1bmN0aW9uKCl7dmFyIHNlbGY9dGhpcztyZXR1cm4gdGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpLnRoZW4oZnVuY3Rpb24oKXt2YXIgdGl0bGU9c2VsZi5nZXRUaXRsZSgpO3NlbGYuX3NldFRpdGxlKHRpdGxlKTtzZWxmLl91cGRhdGVCdXR0b25zKCk7c2VsZi5fdXBkYXRlU2lkZWJhcigpO3NlbGYuYXV0b2ZvY3VzKCk7fSk7fSxfdXBkYXRlQnV0dG9uczpmdW5jdGlvbigpe2lmKHRoaXMuJGJ1dHRvbnMpe2lmKHRoaXMuZm9vdGVyVG9CdXR0b25zKXt2YXIgJGZvb3Rlcj10aGlzLnJlbmRlcmVyLiQoJ2Zvb3RlcicpO2lmKCRmb290ZXIubGVuZ3RoKXt0aGlzLiRidXR0b25zLmVtcHR5KCkuYXBwZW5kKCRmb290ZXIpO319CnZhciBlZGl0X21vZGU9KHRoaXMubW9kZT09PSdlZGl0Jyk7dGhpcy4kYnV0dG9ucy5maW5kKCcub19mb3JtX2J1dHRvbnNfZWRpdCcpLnRvZ2dsZUNsYXNzKCdvX2hpZGRlbicsIWVkaXRfbW9kZSk7dGhpcy4kYnV0dG9ucy5maW5kKCcub19mb3JtX2J1dHRvbnNfdmlldycpLnRvZ2dsZUNsYXNzKCdvX2hpZGRlbicsZWRpdF9tb2RlKTt9fSxfdXBkYXRlU2lkZWJhcjpmdW5jdGlvbigpe2lmKHRoaXMuc2lkZWJhcil7dGhpcy5zaWRlYmFyLmRvX3RvZ2dsZSh0aGlzLm1vZGU9PT0ncmVhZG9ubHknKTt2YXIgYXJjaGl2ZV9pdGVtPV8uZmluZCh0aGlzLnNpZGViYXIuaXRlbXMub3RoZXIsZnVuY3Rpb24oaXRlbSl7cmV0dXJuIGl0ZW0uY2xhc3NuYW1lJiZpdGVtLmNsYXNzbmFtZS5pbmNsdWRlcygnb19zaWRlYmFyX2l0ZW1fYXJjaGl2ZScpfSkKdmFyIHVuYXJjaGl2ZV9pdGVtPV8uZmluZCh0aGlzLnNpZGViYXIuaXRlbXMub3RoZXIsZnVuY3Rpb24oaXRlbSl7cmV0dXJuIGl0ZW0uY2xhc3NuYW1lJiZpdGVtLmNsYXNzbmFtZS5pbmNsdWRlcygnb19zaWRlYmFyX2l0ZW1fdW5hcmNoaXZlJyl9KQppZihhcmNoaXZlX2l0ZW0mJnVuYXJjaGl2ZV9pdGVtKXtpZih0aGlzLnJlbmRlcmVyLnN0YXRlLmRhdGEuYWN0aXZlKXthcmNoaXZlX2l0ZW0uY2xhc3NuYW1lPSdvX3NpZGViYXJfaXRlbV9hcmNoaXZlJzt1bmFyY2hpdmVfaXRlbS5jbGFzc25hbWU9J29fc2lkZWJhcl9pdGVtX3VuYXJjaGl2ZSBvX2hpZGRlbic7fWVsc2V7YXJjaGl2ZV9pdGVtLmNsYXNzbmFtZT0nb19zaWRlYmFyX2l0ZW1fYXJjaGl2ZSBvX2hpZGRlbic7dW5hcmNoaXZlX2l0ZW0uY2xhc3NuYW1lPSdvX3NpZGViYXJfaXRlbV91bmFyY2hpdmUnO319fX0sX29uQm91bmNlRWRpdDpmdW5jdGlvbigpe2lmKHRoaXMuJGJ1dHRvbnMpe3RoaXMuJGJ1dHRvbnMuZmluZCgnLm9fZm9ybV9idXR0b25fZWRpdCcpLm9kb29Cb3VuY2UoKTt9fSxfb25CdXR0b25DbGlja2VkOmZ1bmN0aW9uKGV2KXtldi5zdG9wUHJvcGFnYXRpb24oKTt2YXIgc2VsZj10aGlzO3ZhciBkZWY7dGhpcy5fZGlzYWJsZUJ1dHRvbnMoKTtmdW5jdGlvbiBzYXZlQW5kRXhlY3V0ZUFjdGlvbigpe3JldHVybiBzZWxmLnNhdmVSZWNvcmQoc2VsZi5oYW5kbGUse3N0YXlJbkVkaXQ6dHJ1ZSx9KS50aGVuKGZ1bmN0aW9uKCl7dmFyIHJlY29yZD1zZWxmLm1vZGVsLmdldChldi5kYXRhLnJlY29yZC5pZCk7cmV0dXJuIHNlbGYuX2NhbGxCdXR0b25BY3Rpb24oYXR0cnMscmVjb3JkKTt9KTt9CnZhciBhdHRycz1ldi5kYXRhLmF0dHJzO2lmKGF0dHJzLmNvbmZpcm0pe2RlZj1uZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLHJlamVjdCl7RGlhbG9nLmNvbmZpcm0odGhpcyxhdHRycy5jb25maXJtLHtjb25maXJtX2NhbGxiYWNrOnNhdmVBbmRFeGVjdXRlQWN0aW9uLH0pLm9uKCJjbG9zZWQiLG51bGwscmVzb2x2ZSk7fSk7fWVsc2UgaWYoYXR0cnMuc3BlY2lhbD09PSdjYW5jZWwnKXtkZWY9dGhpcy5fY2FsbEJ1dHRvbkFjdGlvbihhdHRycyxldi5kYXRhLnJlY29yZCk7fWVsc2UgaWYoIWF0dHJzLnNwZWNpYWx8fGF0dHJzLnNwZWNpYWw9PT0nc2F2ZScpe2RlZj1zYXZlQW5kRXhlY3V0ZUFjdGlvbigpO31lbHNle2NvbnNvbGUud2FybignVW5oYW5kbGVkIGJ1dHRvbiBldmVudCcsZXYpO3JldHVybjt9CmRlZi50aGVuKGZ1bmN0aW9uKCl7c2VsZi5fZW5hYmxlQnV0dG9ucygpO2lmKGF0dHJzLmNsb3NlKXtzZWxmLnRyaWdnZXJfdXAoJ2Nsb3NlX2RpYWxvZycpO319KS5ndWFyZGVkQ2F0Y2godGhpcy5fZW5hYmxlQnV0dG9ucy5iaW5kKHRoaXMpKTt9LF9vbkNyZWF0ZTpmdW5jdGlvbigpe3RoaXMuY3JlYXRlUmVjb3JkKCk7fSxfb25EZWxldGVSZWNvcmQ6ZnVuY3Rpb24oKXt0aGlzLl9kZWxldGVSZWNvcmRzKFt0aGlzLmhhbmRsZV0pO30sX29uRGlzY2FyZDpmdW5jdGlvbigpe3RoaXMuX2Rpc2NhcmRDaGFuZ2VzKCk7fSxfb25EdXBsaWNhdGVSZWNvcmQ6ZnVuY3Rpb24oKXt2YXIgc2VsZj10aGlzO3RoaXMubW9kZWwuZHVwbGljYXRlUmVjb3JkKHRoaXMuaGFuZGxlKS50aGVuKGZ1bmN0aW9uKGhhbmRsZSl7c2VsZi5oYW5kbGU9aGFuZGxlO3NlbGYuX3VwZGF0ZUVudigpO3NlbGYuX3NldE1vZGUoJ2VkaXQnKTt9KTt9LF9vbkVkaXQ6ZnVuY3Rpb24oKXt0aGlzLm11dGV4LmdldFVubG9ja2VkRGVmKCkudGhlbih0aGlzLl9zZXRNb2RlLmJpbmQodGhpcywnZWRpdCcpKTt9LF9vbkVkaXRlZExpc3Q6ZnVuY3Rpb24oZXYpe2V2LnN0b3BQcm9wYWdhdGlvbigpO2lmKGV2LmRhdGEuaWQpe3RoaXMubW9kZWwuc2F2ZShldi5kYXRhLmlkLHtzYXZlUG9pbnQ6dHJ1ZX0pO30KdGhpcy5tb2RlbC5mcmVlemVPcmRlcihldi5kYXRhLmlkKTt9LF9vbkZvY3VzQ29udHJvbEJ1dHRvbjpmdW5jdGlvbihlKXtpZih0aGlzLiRidXR0b25zKXtlLnN0b3BQcm9wYWdhdGlvbigpO3RoaXMuJGJ1dHRvbnMuZmluZCgnLmJ0bi1wcmltYXJ5OnZpc2libGU6Zmlyc3QoKScpLmZvY3VzKCk7fX0sX29uRm9ybURpYWxvZ0Rpc2NhcmRlZDpmdW5jdGlvbihldil7ZXYuc3RvcFByb3BhZ2F0aW9uKCk7dmFyIGlzRm9jdXNlZD10aGlzLnJlbmRlcmVyLmZvY3VzTGFzdEFjdGl2YXRlZFdpZGdldCgpO2lmKGV2LmRhdGEuY2FsbGJhY2spe2V2LmRhdGEuY2FsbGJhY2soXy5zdHIudG9Cb29sKGlzRm9jdXNlZCkpO319LF9vbk9wZW5PbmUyTWFueVJlY29yZDphc3luYyBmdW5jdGlvbihldil7ZXYuc3RvcFByb3BhZ2F0aW9uKCk7dmFyIGRhdGE9ZXYuZGF0YTt2YXIgcmVjb3JkO2lmKGRhdGEuaWQpe3JlY29yZD10aGlzLm1vZGVsLmdldChkYXRhLmlkLHtyYXc6dHJ1ZX0pO30KYXdhaXQgdGhpcy5tb2RlbC5tdXRleC5nZXRVbmxvY2tlZERlZigpO25ldyBkaWFsb2dzLkZvcm1WaWV3RGlhbG9nKHRoaXMse2NvbnRleHQ6ZGF0YS5jb250ZXh0LGRvbWFpbjpkYXRhLmRvbWFpbixmaWVsZHNfdmlldzpkYXRhLmZpZWxkc192aWV3LG1vZGVsOnRoaXMubW9kZWwsb25fc2F2ZWQ6ZGF0YS5vbl9zYXZlZCxvbl9yZW1vdmU6ZGF0YS5vbl9yZW1vdmUscGFyZW50SUQ6ZGF0YS5wYXJlbnRJRCxyZWFkb25seTpkYXRhLnJlYWRvbmx5LGRlbGV0YWJsZTpyZWNvcmQ/ZGF0YS5kZWxldGFibGU6ZmFsc2UscmVjb3JkSUQ6cmVjb3JkJiZyZWNvcmQuaWQscmVzX2lkOnJlY29yZCYmcmVjb3JkLnJlc19pZCxyZXNfbW9kZWw6ZGF0YS5maWVsZC5yZWxhdGlvbixzaG91bGRTYXZlTG9jYWxseTp0cnVlLHRpdGxlOihyZWNvcmQ/X3QoIk9wZW46ICIpOl90KCJDcmVhdGUgIikpKyhldi50YXJnZXQuc3RyaW5nfHxkYXRhLmZpZWxkLnN0cmluZyksfSkub3BlbigpO30sX29uT3BlblJlY29yZDpmdW5jdGlvbihldil7ZXYuc3RvcFByb3BhZ2F0aW9uKCk7dmFyIHNlbGY9dGhpczt2YXIgcmVjb3JkPXRoaXMubW9kZWwuZ2V0KGV2LmRhdGEuaWQse3Jhdzp0cnVlfSk7bmV3IGRpYWxvZ3MuRm9ybVZpZXdEaWFsb2coc2VsZix7Y29udGV4dDpldi5kYXRhLmNvbnRleHQsZmllbGRzX3ZpZXc6ZXYuZGF0YS5maWVsZHNfdmlldyxvbl9zYXZlZDpldi5kYXRhLm9uX3NhdmVkLG9uX3JlbW92ZTpldi5kYXRhLm9uX3JlbW92ZSxyZWFkb25seTpldi5kYXRhLnJlYWRvbmx5LGRlbGV0YWJsZTpldi5kYXRhLmRlbGV0YWJsZSxyZXNfaWQ6cmVjb3JkLnJlc19pZCxyZXNfbW9kZWw6cmVjb3JkLm1vZGVsLHRpdGxlOl90KCJPcGVuOiAiKStldi5kYXRhLnN0cmluZyx9KS5vcGVuKCk7fSxfb25TYXZlOmZ1bmN0aW9uKGV2KXtldi5zdG9wUHJvcGFnYXRpb24oKTt2YXIgc2VsZj10aGlzO3RoaXMuX2Rpc2FibGVCdXR0b25zKCk7dGhpcy5zYXZlUmVjb3JkKCkudGhlbih0aGlzLl9lbmFibGVCdXR0b25zLmJpbmQodGhpcykpLmd1YXJkZWRDYXRjaCh0aGlzLl9lbmFibGVCdXR0b25zLmJpbmQodGhpcykpO30sX29uVG9nZ2xlQ29sdW1uT3JkZXI6ZnVuY3Rpb24oZXYpe2V2LnN0b3BQcm9wYWdhdGlvbigpO3ZhciBzZWxmPXRoaXM7dGhpcy5tb2RlbC5zZXRTb3J0KGV2LmRhdGEuaWQsZXYuZGF0YS5uYW1lKS50aGVuKGZ1bmN0aW9uKCl7dmFyIGZpZWxkPWV2LmRhdGEuZmllbGQ7dmFyIHN0YXRlPXNlbGYubW9kZWwuZ2V0KHNlbGYuaGFuZGxlKTtzZWxmLnJlbmRlcmVyLmNvbmZpcm1DaGFuZ2Uoc3RhdGUsc3RhdGUuaWQsW2ZpZWxkXSk7fSk7fSxfdG9nZ2xlQXJjaGl2ZVN0YXRlOmZ1bmN0aW9uKGFyY2hpdmUpe3RoaXMuX2FyY2hpdmUoW3RoaXMuaGFuZGxlXSxhcmNoaXZlKTt9LH0pO3JldHVybiBGb3JtQ29udHJvbGxlcjt9KTs7CgovKiAvd2ViL3N0YXRpYy9zcmMvanMvdmlld3MvZm9ybS9mb3JtX3ZpZXcuanMgZGVmaW5lZCBpbiBidW5kbGUgJ3dlYi5hc3NldHNfYmFja2VuZCcgKi8Kb2Rvby5kZWZpbmUoJ3dlYi5Gb3JtVmlldycsZnVuY3Rpb24ocmVxdWlyZSl7InVzZSBzdHJpY3QiO3ZhciBCYXNpY1ZpZXc9cmVxdWlyZSgnd2ViLkJhc2ljVmlldycpO3ZhciBjb25maWc9cmVxdWlyZSgnd2ViLmNvbmZpZycpO3ZhciBDb250ZXh0PXJlcXVpcmUoJ3dlYi5Db250ZXh0Jyk7dmFyIGNvcmU9cmVxdWlyZSgnd2ViLmNvcmUnKTt2YXIgRm9ybUNvbnRyb2xsZXI9cmVxdWlyZSgnd2ViLkZvcm1Db250cm9sbGVyJyk7dmFyIEZvcm1SZW5kZXJlcj1yZXF1aXJlKCd3ZWIuRm9ybVJlbmRlcmVyJyk7dmFyIF9sdD1jb3JlLl9sdDt2YXIgRm9ybVZpZXc9QmFzaWNWaWV3LmV4dGVuZCh7Y29uZmlnOl8uZXh0ZW5kKHt9LEJhc2ljVmlldy5wcm90b3R5cGUuY29uZmlnLHtSZW5kZXJlcjpGb3JtUmVuZGVyZXIsQ29udHJvbGxlcjpGb3JtQ29udHJvbGxlcix9KSxkaXNwbGF5X25hbWU6X2x0KCdGb3JtJyksaWNvbjonZmEtZWRpdCcsbXVsdGlfcmVjb3JkOmZhbHNlLHdpdGhTZWFyY2hCYXI6ZmFsc2Usc2VhcmNoTWVudVR5cGVzOltdLHZpZXdUeXBlOidmb3JtJyxpbml0OmZ1bmN0aW9uKHZpZXdJbmZvLHBhcmFtcyl7dmFyIGhhc1NpZGViYXI9cGFyYW1zLmhhc1NpZGViYXI7dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3ZhciBtb2RlPXBhcmFtcy5tb2RlfHwocGFyYW1zLmN1cnJlbnRJZD8ncmVhZG9ubHknOidlZGl0Jyk7dGhpcy5sb2FkUGFyYW1zLnR5cGU9J3JlY29yZCc7aWYoaGFzU2lkZWJhcj09PXVuZGVmaW5lZCl7aGFzU2lkZWJhcj1wYXJhbXMuaGFzU2lkZWJhcjt9CnRoaXMuY29udHJvbGxlclBhcmFtcy5oYXNTaWRlYmFyPWhhc1NpZGViYXI7dGhpcy5jb250cm9sbGVyUGFyYW1zLmRpc2FibGVBdXRvZm9jdXM9cGFyYW1zLmRpc2FibGVfYXV0b2ZvY3VzO3RoaXMuY29udHJvbGxlclBhcmFtcy50b29sYmFyQWN0aW9ucz12aWV3SW5mby50b29sYmFyO3RoaXMuY29udHJvbGxlclBhcmFtcy5mb290ZXJUb0J1dHRvbnM9cGFyYW1zLmZvb3RlclRvQnV0dG9uczt2YXIgZGVmYXVsdEJ1dHRvbnM9J2RlZmF1bHRfYnV0dG9ucydpbiBwYXJhbXM/cGFyYW1zLmRlZmF1bHRfYnV0dG9uczp0cnVlO3RoaXMuY29udHJvbGxlclBhcmFtcy5kZWZhdWx0QnV0dG9ucz1kZWZhdWx0QnV0dG9uczt0aGlzLmNvbnRyb2xsZXJQYXJhbXMubW9kZT1tb2RlO3RoaXMucmVuZGVyZXJQYXJhbXMubW9kZT1tb2RlO30sZ2V0Q29udHJvbGxlcjpmdW5jdGlvbihwYXJlbnQpe3JldHVybiB0aGlzLl9sb2FkU3Vidmlld3MocGFyZW50KS50aGVuKHRoaXMuX3N1cGVyLmJpbmQodGhpcyxwYXJlbnQpKTt9LF9leHRyYWN0UGFyYW1zRnJvbUFjdGlvbjpmdW5jdGlvbihhY3Rpb24pe3ZhciBwYXJhbXM9dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3ZhciBpbkRpYWxvZz1hY3Rpb24udGFyZ2V0PT09J25ldyc7dmFyIGlubGluZT1hY3Rpb24udGFyZ2V0PT09J2lubGluZSc7dmFyIGZ1bGxzY3JlZW49YWN0aW9uLnRhcmdldD09PSdmdWxsc2NyZWVuJztwYXJhbXMud2l0aENvbnRyb2xQYW5lbD0hKGluRGlhbG9nfHxpbmxpbmUpO3BhcmFtcy5mb290ZXJUb0J1dHRvbnM9aW5EaWFsb2c7cGFyYW1zLmhhc1NlYXJjaFZpZXc9aW5EaWFsb2c/ZmFsc2U6cGFyYW1zLmhhc1NlYXJjaFZpZXc7cGFyYW1zLmhhc1NpZGViYXI9IWluRGlhbG9nJiYhaW5saW5lO3BhcmFtcy5zZWFyY2hNZW51VHlwZXM9aW5EaWFsb2c/W106cGFyYW1zLnNlYXJjaE1lbnVUeXBlcztpZihpbkRpYWxvZ3x8aW5saW5lfHxmdWxsc2NyZWVuKXtwYXJhbXMubW9kZT0nZWRpdCc7fWVsc2UgaWYoYWN0aW9uLmNvbnRleHQmJmFjdGlvbi5jb250ZXh0LmZvcm1fdmlld19pbml0aWFsX21vZGUpe3BhcmFtcy5tb2RlPWFjdGlvbi5jb250ZXh0LmZvcm1fdmlld19pbml0aWFsX21vZGU7fQpyZXR1cm4gcGFyYW1zO30sX2xvYWRTdWJ2aWV3czpmdW5jdGlvbihwYXJlbnQpe3ZhciBzZWxmPXRoaXM7dmFyIGRlZnM9W107aWYodGhpcy5sb2FkUGFyYW1zJiZ0aGlzLmxvYWRQYXJhbXMuZmllbGRzSW5mbyl7dmFyIGZpZWxkcz10aGlzLmxvYWRQYXJhbXMuZmllbGRzO18uZWFjaCh0aGlzLmxvYWRQYXJhbXMuZmllbGRzSW5mby5mb3JtLGZ1bmN0aW9uKGF0dHJzLGZpZWxkTmFtZSl7dmFyIGZpZWxkPWZpZWxkc1tmaWVsZE5hbWVdO2lmKCFmaWVsZCl7cmV0dXJuO30KaWYoZmllbGQudHlwZSE9PSdvbmUybWFueScmJmZpZWxkLnR5cGUhPT0nbWFueTJtYW55Jyl7cmV0dXJuO30KaWYoYXR0cnMuV2lkZ2V0LnByb3RvdHlwZS51c2VTdWJ2aWV3JiYhYXR0cnMuX19ub19mZXRjaCYmIWF0dHJzLnZpZXdzW2F0dHJzLm1vZGVdKXt2YXIgY29udGV4dD17fTt2YXIgcmVnZXg9LycoW2Etel0qX3ZpZXdfcmVmKScgKjogKicoLio/KScvZzt2YXIgbWF0Y2hlczt3aGlsZShtYXRjaGVzPXJlZ2V4LmV4ZWMoYXR0cnMuY29udGV4dCkpe2NvbnRleHRbbWF0Y2hlc1sxXV09bWF0Y2hlc1syXTt9CnZhciByZWZpbmVkQ29udGV4dD1fLnBpY2soc2VsZi5sb2FkUGFyYW1zLmNvbnRleHQsZnVuY3Rpb24odmFsdWUsa2V5KXtyZXR1cm4ga2V5LmluZGV4T2YoJ192aWV3X3JlZicpPT09LTE7fSk7cmVmaW5lZENvbnRleHQuYmFzZV9tb2RlbF9uYW1lPXNlbGYuY29udHJvbGxlclBhcmFtcy5tb2RlbE5hbWU7ZGVmcy5wdXNoKHBhcmVudC5sb2FkVmlld3MoZmllbGQucmVsYXRpb24sbmV3IENvbnRleHQoY29udGV4dCxzZWxmLnVzZXJDb250ZXh0LHJlZmluZWRDb250ZXh0KS5ldmFsKCksW1tudWxsLGF0dHJzLm1vZGU9PT0ndHJlZSc/J2xpc3QnOmF0dHJzLm1vZGVdXSkudGhlbihmdW5jdGlvbih2aWV3cyl7Zm9yKHZhciB2aWV3TmFtZSBpbiB2aWV3cyl7YXR0cnMudmlld3Nbdmlld05hbWVdPXNlbGYuX3Byb2Nlc3NGaWVsZHNWaWV3KHZpZXdzW3ZpZXdOYW1lXSx2aWV3TmFtZSk7YXR0cnMudmlld3Nbdmlld05hbWVdLmZpZWxkcz1hdHRycy52aWV3c1t2aWV3TmFtZV0udmlld0ZpZWxkcztzZWxmLl9wcm9jZXNzU3ViVmlld0F0dHJzKGF0dHJzLnZpZXdzW3ZpZXdOYW1lXSxhdHRycyk7fQpzZWxmLl9zZXRTdWJWaWV3TGltaXQoYXR0cnMpO30pKTt9ZWxzZXtzZWxmLl9zZXRTdWJWaWV3TGltaXQoYXR0cnMpO319KTt9CnJldHVybiBQcm9taXNlLmFsbChkZWZzKTt9LF9zZXRTdWJWaWV3TGltaXQ6ZnVuY3Rpb24oYXR0cnMpe3ZhciB2aWV3PWF0dHJzLnZpZXdzJiZhdHRycy52aWV3c1thdHRycy5tb2RlXTt2YXIgbGltaXQ9dmlldyYmdmlldy5hcmNoLmF0dHJzLmxpbWl0JiZwYXJzZUludCh2aWV3LmFyY2guYXR0cnMubGltaXQpO2lmKCFsaW1pdCYmYXR0cnMud2lkZ2V0PT09J21hbnkybWFueV90YWdzJyl7bGltaXQ9MTAwMDt9CmF0dHJzLmxpbWl0PWxpbWl0fHw0MDt9LH0pO3JldHVybiBGb3JtVmlldzt9KTs7CgovKiAvd2ViL3N0YXRpYy9zcmMvanMvdmlld3MvZ3JhcGgvZ3JhcGhfbW9kZWwuanMgZGVmaW5lZCBpbiBidW5kbGUgJ3dlYi5hc3NldHNfYmFja2VuZCcgKi8Kb2Rvby5kZWZpbmUoJ3dlYi5HcmFwaE1vZGVsJyxmdW5jdGlvbihyZXF1aXJlKXsidXNlIHN0cmljdCI7dmFyIGNvcmU9cmVxdWlyZSgnd2ViLmNvcmUnKTt2YXIgX3Q9Y29yZS5fdDt2YXIgQWJzdHJhY3RNb2RlbD1yZXF1aXJlKCd3ZWIuQWJzdHJhY3RNb2RlbCcpO3JldHVybiBBYnN0cmFjdE1vZGVsLmV4dGVuZCh7aW5pdDpmdW5jdGlvbigpe3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLmNoYXJ0PW51bGw7fSxnZXQ6ZnVuY3Rpb24oKXt2YXIgc2VsZj10aGlzO3JldHVybiBfLmV4dGVuZCh7fSx0aGlzLmNoYXJ0LHtjb21wYXJpc29uRmllbGRJbmRleDpzZWxmLl9nZXRDb21wYXJpc29uRmllbGRJbmRleCgpLH0pO30sbG9hZDpmdW5jdGlvbihwYXJhbXMpe3ZhciBncm91cEJ5cz1wYXJhbXMuY29udGV4dC5ncmFwaF9ncm91cGJ5c3x8cGFyYW1zLmdyb3VwQnlzO3RoaXMuaW5pdGlhbEdyb3VwQnlzPWdyb3VwQnlzO3RoaXMuZmllbGRzPXBhcmFtcy5maWVsZHM7dGhpcy5tb2RlbE5hbWU9cGFyYW1zLm1vZGVsTmFtZTt0aGlzLmNoYXJ0PXtjb21wYXJpc29uRmllbGQ6cGFyYW1zLmNvbXBhcmlzb25GaWVsZCxjb21wYXJpc29uVGltZVJhbmdlOnBhcmFtcy5jb21wYXJpc29uVGltZVJhbmdlLGNvbXBhcmlzb25UaW1lUmFuZ2VEZXNjcmlwdGlvbjpwYXJhbXMuY29tcGFyaXNvblRpbWVSYW5nZURlc2NyaXB0aW9uLGNvbXBhcmU6cGFyYW1zLmNvbXBhcmUsY29udGV4dDpwYXJhbXMuY29udGV4dCxkYXRhUG9pbnRzOltdLGRvbWFpbjpwYXJhbXMuZG9tYWluLGdyb3VwQnk6cGFyYW1zLmdyb3VwZWRCeS5sZW5ndGg/cGFyYW1zLmdyb3VwZWRCeTpncm91cEJ5cyxtZWFzdXJlOnBhcmFtcy5jb250ZXh0LmdyYXBoX21lYXN1cmV8fHBhcmFtcy5tZWFzdXJlLG1vZGU6cGFyYW1zLmNvbnRleHQuZ3JhcGhfbW9kZXx8cGFyYW1zLm1vZGUsb3JpZ2luczpbXSxzdGFja2VkOnBhcmFtcy5zdGFja2VkLHRpbWVSYW5nZTpwYXJhbXMudGltZVJhbmdlLHRpbWVSYW5nZURlc2NyaXB0aW9uOnBhcmFtcy50aW1lUmFuZ2VEZXNjcmlwdGlvbix9O3JldHVybiB0aGlzLl9sb2FkR3JhcGgodGhpcy5fZ2V0RG9tYWlucygpKTt9LHJlbG9hZDpmdW5jdGlvbihoYW5kbGUscGFyYW1zKXtpZignY29udGV4dCdpbiBwYXJhbXMpe3RoaXMuY2hhcnQuY29udGV4dD1wYXJhbXMuY29udGV4dDt0aGlzLmNoYXJ0Lmdyb3VwQnk9cGFyYW1zLmNvbnRleHQuZ3JhcGhfZ3JvdXBieXN8fHRoaXMuY2hhcnQuZ3JvdXBCeTt0aGlzLmNoYXJ0Lm1lYXN1cmU9cGFyYW1zLmNvbnRleHQuZ3JhcGhfbWVhc3VyZXx8dGhpcy5jaGFydC5tZWFzdXJlO3RoaXMuY2hhcnQubW9kZT1wYXJhbXMuY29udGV4dC5ncmFwaF9tb2RlfHx0aGlzLmNoYXJ0Lm1vZGU7dmFyIHRpbWVSYW5nZU1lbnVEYXRhPXBhcmFtcy5jb250ZXh0LnRpbWVSYW5nZU1lbnVEYXRhO2lmKHRpbWVSYW5nZU1lbnVEYXRhKXt0aGlzLmNoYXJ0LmNvbXBhcmlzb25GaWVsZD10aW1lUmFuZ2VNZW51RGF0YS5jb21wYXJpc29uRmllbGR8fHVuZGVmaW5lZDt0aGlzLmNoYXJ0LmNvbXBhcmlzb25UaW1lUmFuZ2U9dGltZVJhbmdlTWVudURhdGEuY29tcGFyaXNvblRpbWVSYW5nZXx8W107dGhpcy5jaGFydC5jb21wYXJlPXRoaXMuY2hhcnQuY29tcGFyaXNvblRpbWVSYW5nZS5sZW5ndGg+MDt0aGlzLmNoYXJ0LmNvbXBhcmlzb25UaW1lUmFuZ2VEZXNjcmlwdGlvbj10aW1lUmFuZ2VNZW51RGF0YS5jb21wYXJpc29uVGltZVJhbmdlRGVzY3JpcHRpb247dGhpcy5jaGFydC50aW1lUmFuZ2U9dGltZVJhbmdlTWVudURhdGEudGltZVJhbmdlfHxbXTt0aGlzLmNoYXJ0LnRpbWVSYW5nZURlc2NyaXB0aW9uPXRpbWVSYW5nZU1lbnVEYXRhLnRpbWVSYW5nZURlc2NyaXB0aW9uO31lbHNle3RoaXMuY2hhcnQuY29tcGFyaXNvbkZpZWxkPXVuZGVmaW5lZDt0aGlzLmNoYXJ0LmNvbXBhcmlzb25UaW1lUmFuZ2U9W107dGhpcy5jaGFydC5jb21wYXJlPWZhbHNlO3RoaXMuY2hhcnQuY29tcGFyaXNvblRpbWVSYW5nZURlc2NyaXB0aW9uPXVuZGVmaW5lZDt0aGlzLmNoYXJ0LnRpbWVSYW5nZT1bXTt0aGlzLmNoYXJ0LnRpbWVSYW5nZURlc2NyaXB0aW9uPXVuZGVmaW5lZDt9fQppZignZG9tYWluJ2luIHBhcmFtcyl7dGhpcy5jaGFydC5kb21haW49cGFyYW1zLmRvbWFpbjt9CmlmKCdncm91cEJ5J2luIHBhcmFtcyl7dGhpcy5jaGFydC5ncm91cEJ5PXBhcmFtcy5ncm91cEJ5Lmxlbmd0aD9wYXJhbXMuZ3JvdXBCeTp0aGlzLmluaXRpYWxHcm91cEJ5czt9CmlmKCdtZWFzdXJlJ2luIHBhcmFtcyl7dGhpcy5jaGFydC5tZWFzdXJlPXBhcmFtcy5tZWFzdXJlO30KaWYoJ21vZGUnaW4gcGFyYW1zKXt0aGlzLmNoYXJ0Lm1vZGU9cGFyYW1zLm1vZGU7cmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO30KaWYoJ3N0YWNrZWQnaW4gcGFyYW1zKXt0aGlzLmNoYXJ0LnN0YWNrZWQ9cGFyYW1zLnN0YWNrZWQ7cmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO30KcmV0dXJuIHRoaXMuX2xvYWRHcmFwaCh0aGlzLl9nZXREb21haW5zKCkpO30sX2dldENvbXBhcmlzb25GaWVsZEluZGV4OmZ1bmN0aW9uKCl7dmFyIGdyb3VwQnlzPXRoaXMuY2hhcnQuZ3JvdXBCeS5tYXAoZnVuY3Rpb24oZ2Ipe3JldHVybiBnYi5zcGxpdCgiOiIpWzBdO30pO3JldHVybiBncm91cEJ5cy5pbmRleE9mKHRoaXMuY2hhcnQuY29tcGFyaXNvbkZpZWxkKTt9LF9nZXREb21haW5zOmZ1bmN0aW9uKCl7dmFyIGRvbWFpbnM9W3RoaXMuY2hhcnQuZG9tYWluLmNvbmNhdCh0aGlzLmNoYXJ0LnRpbWVSYW5nZSldO3RoaXMuY2hhcnQub3JpZ2lucz1bdGhpcy5jaGFydC50aW1lUmFuZ2VEZXNjcmlwdGlvbnx8IiJdO2lmKHRoaXMuY2hhcnQuY29tcGFyZSl7ZG9tYWlucy5wdXNoKHRoaXMuY2hhcnQuZG9tYWluLmNvbmNhdCh0aGlzLmNoYXJ0LmNvbXBhcmlzb25UaW1lUmFuZ2UpKTt0aGlzLmNoYXJ0Lm9yaWdpbnMucHVzaCh0aGlzLmNoYXJ0LmNvbXBhcmlzb25UaW1lUmFuZ2VEZXNjcmlwdGlvbik7fQpyZXR1cm4gZG9tYWluczt9LF9sb2FkR3JhcGg6ZnVuY3Rpb24oZG9tYWlucyl7dmFyIHNlbGY9dGhpczt0aGlzLmNoYXJ0LmRhdGFQb2ludHM9W107dmFyIGdyb3VwQnk9dGhpcy5jaGFydC5ncm91cEJ5O3ZhciBmaWVsZHM9Xy5tYXAoZ3JvdXBCeSxmdW5jdGlvbihncm91cEJ5KXtyZXR1cm4gZ3JvdXBCeS5zcGxpdCgnOicpWzBdO30pO2lmKHRoaXMuY2hhcnQubWVhc3VyZSE9PSdfX2NvdW50X18nKXtpZih0aGlzLmZpZWxkc1t0aGlzLmNoYXJ0Lm1lYXN1cmVdLnR5cGU9PT0nbWFueTJvbmUnKXtmaWVsZHM9ZmllbGRzLmNvbmNhdCh0aGlzLmNoYXJ0Lm1lYXN1cmUrIjpjb3VudF9kaXN0aW5jdCIpO30KZWxzZXtmaWVsZHM9ZmllbGRzLmNvbmNhdCh0aGlzLmNoYXJ0Lm1lYXN1cmUpO319CnZhciBjb250ZXh0PV8uZXh0ZW5kKHtmaWxsX3RlbXBvcmFsOnRydWV9LHRoaXMuY2hhcnQuY29udGV4dCk7dmFyIGRlZnM9W107ZG9tYWlucy5mb3JFYWNoKGZ1bmN0aW9uKGRvbWFpbixvcmlnaW5JbmRleCl7ZGVmcy5wdXNoKHNlbGYuX3JwYyh7bW9kZWw6c2VsZi5tb2RlbE5hbWUsbWV0aG9kOidyZWFkX2dyb3VwJyxjb250ZXh0OmNvbnRleHQsZG9tYWluOmRvbWFpbixmaWVsZHM6ZmllbGRzLGdyb3VwQnk6Z3JvdXBCeSxsYXp5OmZhbHNlLH0pLnRoZW4oc2VsZi5fcHJvY2Vzc0RhdGEuYmluZChzZWxmLG9yaWdpbkluZGV4KSkpO30pO3JldHVybiBQcm9taXNlLmFsbChkZWZzKTt9LF9wcm9jZXNzRGF0YTpmdW5jdGlvbihvcmlnaW5JbmRleCxyYXdEYXRhKXt2YXIgc2VsZj10aGlzO3ZhciBpc0NvdW50PXRoaXMuY2hhcnQubWVhc3VyZT09PSdfX2NvdW50X18nO3ZhciBsYWJlbHM7ZnVuY3Rpb24gZ2V0TGFiZWxzKGRhdGFQdCl7cmV0dXJuIHNlbGYuY2hhcnQuZ3JvdXBCeS5tYXAoZnVuY3Rpb24oZmllbGQpe3JldHVybiBzZWxmLl9zYW5pdGl6ZVZhbHVlKGRhdGFQdFtmaWVsZF0sZmllbGQuc3BsaXQoIjoiKVswXSk7fSk7fQpyYXdEYXRhLmZvckVhY2goZnVuY3Rpb24oZGF0YVB0KXtsYWJlbHM9Z2V0TGFiZWxzKGRhdGFQdCk7dmFyIGNvdW50PWRhdGFQdC5fX2NvdW50fHxkYXRhUHRbc2VsZi5jaGFydC5ncm91cEJ5WzBdKydfY291bnQnXXx8MDt2YXIgdmFsdWU9aXNDb3VudD9jb3VudDpkYXRhUHRbc2VsZi5jaGFydC5tZWFzdXJlXTtpZih2YWx1ZSBpbnN0YW5jZW9mIEFycmF5KXt2YWx1ZT0xO30Kc2VsZi5jaGFydC5kYXRhUG9pbnRzLnB1c2goe2NvdW50OmNvdW50LHZhbHVlOnZhbHVlLGxhYmVsczpsYWJlbHMsb3JpZ2luSW5kZXg6b3JpZ2luSW5kZXgsfSk7fSk7fSxfc2FuaXRpemVWYWx1ZTpmdW5jdGlvbih2YWx1ZSxmaWVsZE5hbWUpe2lmKHZhbHVlPT09ZmFsc2UmJnRoaXMuZmllbGRzW2ZpZWxkTmFtZV0udHlwZSE9PSdib29sZWFuJyl7cmV0dXJuIF90KCJVbmRlZmluZWQiKTt9CmlmKHZhbHVlIGluc3RhbmNlb2YgQXJyYXkpe3JldHVybiB2YWx1ZVsxXTt9CmlmKGZpZWxkTmFtZSYmKHRoaXMuZmllbGRzW2ZpZWxkTmFtZV0udHlwZT09PSdzZWxlY3Rpb24nKSl7dmFyIHNlbGVjdGVkPV8ud2hlcmUodGhpcy5maWVsZHNbZmllbGROYW1lXS5zZWxlY3Rpb24sezA6dmFsdWV9KVswXTtyZXR1cm4gc2VsZWN0ZWQ/c2VsZWN0ZWRbMV06dmFsdWU7fQpyZXR1cm4gdmFsdWU7fSx9KTt9KTs7CgovKiAvd2ViL3N0YXRpYy9zcmMvanMvdmlld3MvZ3JhcGgvZ3JhcGhfY29udHJvbGxlci5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwpvZG9vLmRlZmluZSgnd2ViLkdyYXBoQ29udHJvbGxlcicsZnVuY3Rpb24ocmVxdWlyZSl7InVzZSBzdHJpY3QiO3ZhciBjb3JlPXJlcXVpcmUoJ3dlYi5jb3JlJyk7dmFyIEFic3RyYWN0Q29udHJvbGxlcj1yZXF1aXJlKCd3ZWIuQWJzdHJhY3RDb250cm9sbGVyJyk7dmFyIEdyb3VwQnlNZW51TWl4aW49cmVxdWlyZSgnd2ViLkdyb3VwQnlNZW51TWl4aW4nKTt2YXIgcXdlYj1jb3JlLnF3ZWI7dmFyIEdyYXBoQ29udHJvbGxlcj1BYnN0cmFjdENvbnRyb2xsZXIuZXh0ZW5kKEdyb3VwQnlNZW51TWl4aW4se2luaXQ6ZnVuY3Rpb24ocGFyZW50LG1vZGVsLHJlbmRlcmVyLHBhcmFtcyl7R3JvdXBCeU1lbnVNaXhpbi5pbml0LmNhbGwodGhpcyk7dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3RoaXMubWVhc3VyZXM9cGFyYW1zLm1lYXN1cmVzO3RoaXMuaXNFbWJlZGRlZD1wYXJhbXMuaXNFbWJlZGRlZDt0aGlzLmdyb3VwYWJsZUZpZWxkcz1wYXJhbXMuZ3JvdXBhYmxlRmllbGRzO30sc3RhcnQ6ZnVuY3Rpb24oKXt0aGlzLiRlbC5hZGRDbGFzcygnb19ncmFwaF9jb250cm9sbGVyJyk7cmV0dXJuIHRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9LGRlc3Ryb3k6ZnVuY3Rpb24oKXtpZih0aGlzLiRidXR0b25zKXt0aGlzLiRidXR0b25zLmZpbmQoJ2J1dHRvbicpLm9mZigpLnRvb2x0aXAoJ2Rpc3Bvc2UnKTt9CnRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9LGdldE93bmVkUXVlcnlQYXJhbXM6ZnVuY3Rpb24oKXt2YXIgc3RhdGU9dGhpcy5tb2RlbC5nZXQoKTtyZXR1cm57Y29udGV4dDp7Z3JhcGhfbWVhc3VyZTpzdGF0ZS5tZWFzdXJlLGdyYXBoX21vZGU6c3RhdGUubW9kZSxncmFwaF9ncm91cGJ5czpzdGF0ZS5ncm91cEJ5LH19O30scmVuZGVyQnV0dG9uczpmdW5jdGlvbigkbm9kZSl7aWYoJG5vZGUpe3ZhciBjb250ZXh0PXttZWFzdXJlczpfLnNvcnRCeShfLnBhaXJzKF8ub21pdCh0aGlzLm1lYXN1cmVzLCdfX2NvdW50X18nKSksZnVuY3Rpb24oeCl7cmV0dXJuIHhbMV0uc3RyaW5nLnRvTG93ZXJDYXNlKCk7fSksfTt0aGlzLiRidXR0b25zPSQocXdlYi5yZW5kZXIoJ0dyYXBoVmlldy5idXR0b25zJyxjb250ZXh0KSk7dGhpcy4kbWVhc3VyZUxpc3Q9dGhpcy4kYnV0dG9ucy5maW5kKCcub19ncmFwaF9tZWFzdXJlc19saXN0Jyk7dGhpcy4kYnV0dG9ucy5maW5kKCdidXR0b24nKS50b29sdGlwKCk7dGhpcy4kYnV0dG9ucy5jbGljayh0aGlzLl9vbkJ1dHRvbkNsaWNrLmJpbmQodGhpcykpO3RoaXMuX3VwZGF0ZUJ1dHRvbnMoKTt0aGlzLiRidXR0b25zLmFwcGVuZFRvKCRub2RlKTtpZih0aGlzLmlzRW1iZWRkZWQpe3RoaXMuX2FkZEdyb3VwQnlNZW51KCRub2RlLHRoaXMuZ3JvdXBhYmxlRmllbGRzKS50aGVuKGZ1bmN0aW9uKCl7dmFyIGdyb3VwQnlCdXR0b249JG5vZGUuZmluZCgnLm9fZHJvcGRvd25fdG9nZ2xlcl9idG4nKTtncm91cEJ5QnV0dG9uLnJlbW92ZUNsYXNzKCJvX2Ryb3Bkb3duX3RvZ2dsZXJfYnRuIGJ0biBidG4tc2Vjb25kYXJ5IGRyb3Bkb3duLXRvZ2dsZSIpO2dyb3VwQnlCdXR0b24uYWRkQ2xhc3MoImJ0biBkcm9wZG93bi10b2dnbGUgYnRuLW91dGxpbmUtc2Vjb25kYXJ5Iik7fSk7fX19LF9zZXRHcm91cGJ5OmZ1bmN0aW9uKGdyb3VwQnkpe3RoaXMudXBkYXRlKHtncm91cEJ5Omdyb3VwQnl9KTt9LF9zZXRNb2RlOmZ1bmN0aW9uKG1vZGUpe3RoaXMudXBkYXRlKHttb2RlOm1vZGV9KTt0aGlzLl91cGRhdGVCdXR0b25zKCk7fSxfc2V0TWVhc3VyZTpmdW5jdGlvbihtZWFzdXJlKXt2YXIgc2VsZj10aGlzO3RoaXMudXBkYXRlKHttZWFzdXJlOm1lYXN1cmV9KS50aGVuKGZ1bmN0aW9uKCl7c2VsZi5fdXBkYXRlQnV0dG9ucygpO30pO30sX3RvZ2dsZVN0YWNrTW9kZTpmdW5jdGlvbihzdGFja2VkKXt0aGlzLnVwZGF0ZSh7c3RhY2tlZDpzdGFja2VkfSk7dGhpcy5fdXBkYXRlQnV0dG9ucygpO30sX3VwZGF0ZTpmdW5jdGlvbigpe3RoaXMuX3VwZGF0ZUJ1dHRvbnMoKTtyZXR1cm4gdGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO30sX3VwZGF0ZUJ1dHRvbnM6ZnVuY3Rpb24oKXtpZighdGhpcy4kYnV0dG9ucyl7cmV0dXJuO30KdmFyIHN0YXRlPXRoaXMubW9kZWwuZ2V0KCk7dGhpcy4kYnV0dG9ucy5maW5kKCcub19ncmFwaF9idXR0b24nKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7dGhpcy4kYnV0dG9ucy5maW5kKCcub19ncmFwaF9idXR0b25bZGF0YS1tb2RlPSInK3N0YXRlLm1vZGUrJyJdJykuYWRkQ2xhc3MoJ2FjdGl2ZScpO3RoaXMuJGJ1dHRvbnMuZmluZCgnLm9fZ3JhcGhfYnV0dG9uW2RhdGEtbW9kZT0ic3RhY2siXScpLmRhdGEoJ3N0YWNrZWQnLHN0YXRlLnN0YWNrZWQpLnRvZ2dsZUNsYXNzKCdhY3RpdmUnLHN0YXRlLnN0YWNrZWQpLnRvZ2dsZUNsYXNzKCdvX2hpZGRlbicsc3RhdGUubW9kZSE9PSdiYXInKTtfLmVhY2godGhpcy4kbWVhc3VyZUxpc3QuZmluZCgnLmRyb3Bkb3duLWl0ZW0nKSxmdW5jdGlvbihpdGVtKXt2YXIgJGl0ZW09JChpdGVtKTskaXRlbS50b2dnbGVDbGFzcygnc2VsZWN0ZWQnLCRpdGVtLmRhdGEoJ2ZpZWxkJyk9PT1zdGF0ZS5tZWFzdXJlKTt9KTt9LF9vbkJ1dHRvbkNsaWNrOmZ1bmN0aW9uKGV2KXt2YXIgJHRhcmdldD0kKGV2LnRhcmdldCk7dmFyIGZpZWxkO2lmKCR0YXJnZXQuaGFzQ2xhc3MoJ29fZ3JhcGhfYnV0dG9uJykpe2lmKF8uY29udGFpbnMoWydiYXInLCdsaW5lJywncGllJ10sJHRhcmdldC5kYXRhKCdtb2RlJykpKXt0aGlzLl9zZXRNb2RlKCR0YXJnZXQuZGF0YSgnbW9kZScpKTt9ZWxzZSBpZigkdGFyZ2V0LmRhdGEoJ21vZGUnKT09PSdzdGFjaycpe3RoaXMuX3RvZ2dsZVN0YWNrTW9kZSghJHRhcmdldC5kYXRhKCdzdGFja2VkJykpO319ZWxzZSBpZigkdGFyZ2V0LnBhcmVudHMoJy5vX2dyYXBoX21lYXN1cmVzX2xpc3QnKS5sZW5ndGgpe2V2LnByZXZlbnREZWZhdWx0KCk7ZXYuc3RvcFByb3BhZ2F0aW9uKCk7ZmllbGQ9JHRhcmdldC5kYXRhKCdmaWVsZCcpO3RoaXMuX3NldE1lYXN1cmUoZmllbGQpO319LH0pO3JldHVybiBHcmFwaENvbnRyb2xsZXI7fSk7OwoKLyogL3dlYi9zdGF0aWMvc3JjL2pzL3ZpZXdzL2dyYXBoL2dyYXBoX3JlbmRlcmVyLmpzIGRlZmluZWQgaW4gYnVuZGxlICd3ZWIuYXNzZXRzX2JhY2tlbmQnICovCm9kb28uZGVmaW5lKCd3ZWIuR3JhcGhSZW5kZXJlcicsZnVuY3Rpb24ocmVxdWlyZSl7InVzZSBzdHJpY3QiO3ZhciBBYnN0cmFjdFJlbmRlcmVyPXJlcXVpcmUoJ3dlYi5BYnN0cmFjdFJlbmRlcmVyJyk7dmFyIGNvbmZpZz1yZXF1aXJlKCd3ZWIuY29uZmlnJyk7dmFyIGNvcmU9cmVxdWlyZSgnd2ViLmNvcmUnKTt2YXIgZGF0YUNvbXBhcmlzb25VdGlscz1yZXF1aXJlKCd3ZWIuZGF0YUNvbXBhcmlzb25VdGlscycpO3ZhciBmaWVsZFV0aWxzPXJlcXVpcmUoJ3dlYi5maWVsZF91dGlscycpO3ZhciBfdD1jb3JlLl90O3ZhciBEYXRlQ2xhc3Nlcz1kYXRhQ29tcGFyaXNvblV0aWxzLkRhdGVDbGFzc2VzO3ZhciBxd2ViPWNvcmUucXdlYjt2YXIgQ0hBUlRfVFlQRVM9WydwaWUnLCdiYXInLCdsaW5lJ107dmFyIENPTE9SUz1bIiMxZjc3YjQiLCIjZmY3ZjBlIiwiI2FlYzdlOCIsIiNmZmJiNzgiLCIjMmNhMDJjIiwiIzk4ZGY4YSIsIiNkNjI3MjgiLCIjZmY5ODk2IiwiIzk0NjdiZCIsIiNjNWIwZDUiLCIjOGM1NjRiIiwiI2M0OWM5NCIsIiNlMzc3YzIiLCIjZjdiNmQyIiwiIzdmN2Y3ZiIsIiNjN2M3YzciLCIjYmNiZDIyIiwiI2RiZGI4ZCIsIiMxN2JlY2YiLCIjOWVkYWU1Il07dmFyIENPTE9SX05CPUNPTE9SUy5sZW5ndGg7ZnVuY3Rpb24gaGV4VG9SR0JBKGhleCxvcGFjaXR5KXt2YXIgcmVzdWx0PS9eIz8oW2EtZlxkXXsyfSkoW2EtZlxkXXsyfSkoW2EtZlxkXXsyfSkkL2kuZXhlYyhoZXgpO3ZhciByZ2I9cmVzdWx0LnNsaWNlKDEsNCkubWFwKGZ1bmN0aW9uKG4pe3JldHVybiBwYXJzZUludChuLDE2KTt9KS5qb2luKCcsJyk7cmV0dXJuJ3JnYmEoJytyZ2IrJywnK29wYWNpdHkrJyknO30KdmFyIEZPUk1BVF9PUFRJT05TPXtodW1hblJlYWRhYmxlOmZ1bmN0aW9uKHZhbHVlKXtyZXR1cm4gTWF0aC5hYnModmFsdWUpPj0xMDAwO30sbWluRGlnaXRzOjEsZGVjaW1hbHM6Mixmb3JtYXR0ZXJDYWxsYmFjazpmdW5jdGlvbihzdHIpe3JldHVybiBzdHI7fSx9O3ZhciBOT19EQVRBPVtfdCgnTm8gZGF0YScpXTtOT19EQVRBLmlzTm9EYXRhPXRydWU7dmFyIE1BWF9MRUdFTkRfTEVOR1RIPTQqKE1hdGgubWF4KDEsY29uZmlnLmRldmljZS5zaXplX2NsYXNzKSk7cmV0dXJuIEFic3RyYWN0UmVuZGVyZXIuZXh0ZW5kKHtjbGFzc05hbWU6Im9fZ3JhcGhfcmVuZGVyZXIiLGluaXQ6ZnVuY3Rpb24ocGFyZW50LHN0YXRlLHBhcmFtcyl7dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3RoaXMuaXNFbWJlZGRlZD1wYXJhbXMuaXNFbWJlZGRlZHx8ZmFsc2U7dGhpcy50aXRsZT1wYXJhbXMudGl0bGV8fCcnO3RoaXMuZmllbGRzPXBhcmFtcy5maWVsZHN8fHt9O3RoaXMuY2hhcnQ9bnVsbDt0aGlzLmNoYXJ0SWQ9Xy51bmlxdWVJZCgnY2hhcnQnKTt0aGlzLiRsZWdlbmRUb29sdGlwPW51bGw7dGhpcy4kdG9vbHRpcD1udWxsO30sdXBkYXRlU3RhdGU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO30sb25fYXR0YWNoX2NhbGxiYWNrOmZ1bmN0aW9uKCl7dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3RoaXMuaXNJbkRPTT10cnVlO3RoaXMuX3JlbmRlcigpO30sb25fZGV0YWNoX2NhbGxiYWNrOmZ1bmN0aW9uKCl7dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3RoaXMuaXNJbkRPTT1mYWxzZTt9LF9hZGp1c3RUb29sdGlwSGVpZ2h0OmZ1bmN0aW9uKG1heFRvb2x0aXBIZWlnaHQpe3ZhciBzaXplT25lTGluZT10aGlzLiR0b29sdGlwLmZpbmQoJ3Rib2R5IHRyJylbMF0uY2xpZW50SGVpZ2h0O3ZhciB0Ym9keVNpemU9dGhpcy4kdG9vbHRpcC5maW5kKCd0Ym9keScpWzBdLmNsaWVudEhlaWdodDt2YXIgdG9LZWVwPU1hdGguZmxvb3IoKG1heFRvb2x0aXBIZWlnaHQtKHRoaXMuJHRvb2x0aXBbMF0uY2xpZW50SGVpZ2h0LXRib2R5U2l6ZSkpL3NpemVPbmVMaW5lKS0xO3ZhciAkbGluZXM9dGhpcy4kdG9vbHRpcC5maW5kKCd0Ym9keSB0cicpO3ZhciB0b1JlbW92ZT0kbGluZXMubGVuZ3RoLXRvS2VlcDtpZih0b1JlbW92ZT4wKXskbGluZXMuc2xpY2UodG9LZWVwKS5yZW1vdmUoKTt2YXIgdHI9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndHInKTt2YXIgdGQ9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGQnKTt0ci5jbGFzc0xpc3QuYWRkKCdvX3Nob3dfbW9yZScpO3RkLmlubmVySFRNTD1fdCgiLi4uIik7dHIuYXBwZW5kQ2hpbGQodGQpO3RoaXMuJHRvb2x0aXAuZmluZCgndGJvZHknKS5hcHBlbmQodHIpO319LF9jdXN0b21Ub29sdGlwOmZ1bmN0aW9uKHRvb2x0aXBNb2RlbCl7aWYodGhpcy4kdG9vbHRpcCl7dGhpcy4kdG9vbHRpcC5yZW1vdmUoKTt9CmlmKHRvb2x0aXBNb2RlbC5vcGFjaXR5PT09MCl7cmV0dXJuO30KaWYodG9vbHRpcE1vZGVsLmRhdGFQb2ludHMubGVuZ3RoPT09MCl7cmV0dXJuO30KY29uc3QgY2hhcnRBcmVhPXRoaXMuY2hhcnQuY2hhcnRBcmVhO2NvbnN0IGNoYXJ0QXJlYUxlZnQ9Y2hhcnRBcmVhLmxlZnQ7Y29uc3QgY2hhcnRBcmVhUmlnaHQ9Y2hhcnRBcmVhLnJpZ2h0O2NvbnN0IGNoYXJ0QXJlYVRvcD1jaGFydEFyZWEudG9wO2NvbnN0IHJlbmRlcmVyVG9wPXRoaXMuJGVsWzBdLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnRvcDtjb25zdCBtYXhUb29sdGlwTGFiZWxXaWR0aD1NYXRoLmZsb29yKChjaGFydEFyZWFSaWdodC1jaGFydEFyZWFMZWZ0KS8xLjY4KSsncHgnO2NvbnN0IHRvb2x0aXBJdGVtcz10aGlzLl9nZXRUb29sdGlwSXRlbXModG9vbHRpcE1vZGVsKTt0aGlzLiR0b29sdGlwPSQocXdlYi5yZW5kZXIoJ0dyYXBoVmlldy5DdXN0b21Ub29sdGlwJyx7bWVhc3VyZTp0aGlzLmZpZWxkc1t0aGlzLnN0YXRlLm1lYXN1cmVdLnN0cmluZyx0b29sdGlwSXRlbXM6dG9vbHRpcEl0ZW1zLG1heFdpZHRoOm1heFRvb2x0aXBMYWJlbFdpZHRoLH0pKS5jc3Moe3RvcDonMnB4JyxsZWZ0OicycHgnfSk7Y29uc3QgJGNvbnRhaW5lcj10aGlzLiRlbC5maW5kKCcub19ncmFwaF9jYW52YXNfY29udGFpbmVyJyk7JGNvbnRhaW5lci5hcHBlbmQodGhpcy4kdG9vbHRpcCk7bGV0IHRvcDtjb25zdCB0b29sdGlwSGVpZ2h0PXRoaXMuJHRvb2x0aXBbMF0uY2xpZW50SGVpZ2h0O2NvbnN0IG1pblRvcEFsbG93ZWQ9TWF0aC5mbG9vcihjaGFydEFyZWFUb3ApO2NvbnN0IG1heFRvcEFsbG93ZWQ9TWF0aC5mbG9vcih3aW5kb3cuaW5uZXJIZWlnaHQtcmVuZGVyZXJUb3AtdG9vbHRpcEhlaWdodCktMjtjb25zdCB5PU1hdGguZmxvb3IodG9vbHRpcE1vZGVsLnkpO2lmKG1pblRvcEFsbG93ZWQ8PW1heFRvcEFsbG93ZWQpe2lmKHk8PW1heFRvcEFsbG93ZWQpe2lmKHk+PW1pblRvcEFsbG93ZWQpe3RvcD15O31lbHNle3RvcD1taW5Ub3BBbGxvd2VkO319ZWxzZXt0b3A9bWF4VG9wQWxsb3dlZDt9fWVsc2V7dG9wPW1pblRvcEFsbG93ZWQ7Y29uc3QgbWF4VG9vbHRpcEhlaWdodD13aW5kb3cuaW5uZXJIZWlnaHQtKHJlbmRlcmVyVG9wK2NoYXJ0QXJlYVRvcCktMjt0aGlzLl9hZGp1c3RUb29sdGlwSGVpZ2h0KG1heFRvb2x0aXBIZWlnaHQpO30KdGhpcy4kdG9vbHRpcFswXS5zdHlsZS50b3A9TWF0aC5mbG9vcih0b3ApKydweCc7dGhpcy5fZml4VG9vbHRpcExlZnRQb3NpdGlvbih0aGlzLiR0b29sdGlwWzBdLHRvb2x0aXBNb2RlbC54KTt9LF9maWx0ZXJEYXRhUG9pbnRzOmZ1bmN0aW9uKCl7dmFyIGRhdGFQb2ludHM9W107aWYoXy5jb250YWlucyhbJ2JhcicsJ3BpZSddLHRoaXMuc3RhdGUubW9kZSkpe2RhdGFQb2ludHM9dGhpcy5zdGF0ZS5kYXRhUG9pbnRzLmZpbHRlcihmdW5jdGlvbihkYXRhUHQpe3JldHVybiBkYXRhUHQuY291bnQ+MDt9KTt9ZWxzZSBpZih0aGlzLnN0YXRlLm1vZGU9PT0nbGluZScpe3ZhciBjb3VudHM9MDt0aGlzLnN0YXRlLmRhdGFQb2ludHMuZm9yRWFjaChmdW5jdGlvbihkYXRhUHQpe2lmKGRhdGFQdC5sYWJlbHNbMF0hPT1fdCgiVW5kZWZpbmVkIikpe2RhdGFQb2ludHMucHVzaChkYXRhUHQpO30KY291bnRzKz1kYXRhUHQuY291bnQ7fSk7aWYoY291bnRzPT09MCl7ZGF0YVBvaW50cz1bXTt9fQpyZXR1cm4gZGF0YVBvaW50czt9LF9maXhUb29sdGlwTGVmdFBvc2l0aW9uOmZ1bmN0aW9uKHRvb2x0aXAseCl7bGV0IGxlZnQ7Y29uc3QgdG9vbHRpcFdpZHRoPXRvb2x0aXAuY2xpZW50V2lkdGg7Y29uc3QgbWluTGVmdEFsbG93ZWQ9TWF0aC5mbG9vcih0aGlzLmNoYXJ0LmNoYXJ0QXJlYS5sZWZ0KzIpO2NvbnN0IG1heExlZnRBbGxvd2VkPU1hdGguZmxvb3IodGhpcy5jaGFydC5jaGFydEFyZWEucmlnaHQtdG9vbHRpcFdpZHRoLTIpO3g9TWF0aC5mbG9vcih4KTtpZih4PD1tYXhMZWZ0QWxsb3dlZCl7aWYoeD49bWluTGVmdEFsbG93ZWQpe2xlZnQ9eDt9ZWxzZXtsZWZ0PW1pbkxlZnRBbGxvd2VkO319ZWxzZXtsZWZ0PW1heExlZnRBbGxvd2VkO30KdG9vbHRpcC5zdHlsZS5sZWZ0PWxlZnQrJ3B4Jzt9LF9mb3JtYXRWYWx1ZTpmdW5jdGlvbih2YWx1ZSl7dmFyIG1lYXN1cmVGaWVsZD10aGlzLmZpZWxkc1t0aGlzLnN0YXRlLm1lYXN1cmVdO3ZhciBmb3JtYXR0ZXI9ZmllbGRVdGlscy5mb3JtYXQuZmxvYXQ7dmFyIGZvcm1hdGVkVmFsdWU9Zm9ybWF0dGVyKHZhbHVlLG1lYXN1cmVGaWVsZCxGT1JNQVRfT1BUSU9OUyk7cmV0dXJuIGZvcm1hdGVkVmFsdWU7fSxfZ2V0Q29sb3I6ZnVuY3Rpb24oaW5kZXgpe3JldHVybiBDT0xPUlNbaW5kZXglQ09MT1JfTkJdO30sX2dldERhdGFzZXREYXRhTGVuZ3RoOmZ1bmN0aW9uKG9yaWdpbkluZGV4LGRlZmF1bHRMZW5ndGgpe2lmKF8uY29udGFpbnMoWydiYXInLCdsaW5lJ10sdGhpcy5zdGF0ZS5tb2RlKSYmdGhpcy5zdGF0ZS5jb21wYXJpc29uRmllbGRJbmRleD09PTApe3JldHVybiB0aGlzLmRhdGVDbGFzc2VzLmRhdGVTZXRzW29yaWdpbkluZGV4XS5sZW5ndGg7fQpyZXR1cm4gZGVmYXVsdExlbmd0aDt9LF9nZXREYXRhc2V0TGFiZWw6ZnVuY3Rpb24oZGF0YVB0KXtpZihfLmNvbnRhaW5zKFsnYmFyJywnbGluZSddLHRoaXMuc3RhdGUubW9kZSkpe3ZhciBkYXRhc2V0TGFiZWw9ZGF0YVB0LmxhYmVscy5zbGljZSgxKS5qb2luKCIvIik7aWYodGhpcy5zdGF0ZS5vcmlnaW5zLmxlbmd0aD4xKXtkYXRhc2V0TGFiZWw9dGhpcy5zdGF0ZS5vcmlnaW5zW2RhdGFQdC5vcmlnaW5JbmRleF0rCihkYXRhc2V0TGFiZWw/KCcvJytkYXRhc2V0TGFiZWwpOicnKTt9CmRhdGFzZXRMYWJlbD1kYXRhc2V0TGFiZWx8fHRoaXMuZmllbGRzW3RoaXMuc3RhdGUubWVhc3VyZV0uc3RyaW5nO3JldHVybiBkYXRhc2V0TGFiZWw7fQpyZXR1cm4gdGhpcy5zdGF0ZS5vcmlnaW5zW2RhdGFQdC5vcmlnaW5JbmRleF07fSxfZ2V0RWxlbWVudE9wdGlvbnM6ZnVuY3Rpb24oKXt2YXIgZWxlbWVudE9wdGlvbnM9e307aWYodGhpcy5zdGF0ZS5tb2RlPT09J2Jhcicpe2VsZW1lbnRPcHRpb25zLnJlY3RhbmdsZT17Ym9yZGVyV2lkdGg6MX07fWVsc2UgaWYodGhpcy5zdGF0ZS5tb2RlPT09J2xpbmUnKXtlbGVtZW50T3B0aW9ucy5saW5lPXt0ZW5zaW9uOjAsZmlsbDpmYWxzZSx9O30KcmV0dXJuIGVsZW1lbnRPcHRpb25zO30sX2dldERhdGVDbGFzc2VzOmZ1bmN0aW9uKGRhdGFQb2ludHMpe3ZhciBzZWxmPXRoaXM7dmFyIGRhdGVTZXRzPXRoaXMuc3RhdGUub3JpZ2lucy5tYXAoZnVuY3Rpb24oKXtyZXR1cm5bXTt9KTtkYXRhUG9pbnRzLmZvckVhY2goZnVuY3Rpb24oZGF0YVB0KXtkYXRlU2V0c1tkYXRhUHQub3JpZ2luSW5kZXhdLnB1c2goZGF0YVB0LmxhYmVsc1tzZWxmLnN0YXRlLmNvbXBhcmlzb25GaWVsZEluZGV4XSk7fSk7ZGF0ZVNldHM9ZGF0ZVNldHMubWFwKGZ1bmN0aW9uKGRhdGVTZXQpe3JldHVybiBfLnVuaXEoZGF0ZVNldCk7fSk7cmV0dXJuIG5ldyBEYXRlQ2xhc3NlcyhkYXRlU2V0cyk7fSxfZ2V0TGFiZWw6ZnVuY3Rpb24oZGF0YVB0KXt2YXIgaT10aGlzLnN0YXRlLmNvbXBhcmlzb25GaWVsZEluZGV4O2lmKF8uY29udGFpbnMoWydiYXInLCdsaW5lJ10sdGhpcy5zdGF0ZS5tb2RlKSl7aWYoaT09PTApe3JldHVyblt0aGlzLmRhdGVDbGFzc2VzLmRhdGVDbGFzcyhkYXRhUHQub3JpZ2luSW5kZXgsZGF0YVB0LmxhYmVsc1tpXSldO31lbHNle3JldHVybiBkYXRhUHQubGFiZWxzLnNsaWNlKDAsMSk7fX1lbHNlIGlmKGk9PT0wKXtyZXR1cm4gQXJyYXkucHJvdG90eXBlLmNvbmNhdC5hcHBseShbXSxbdGhpcy5kYXRlQ2xhc3Nlcy5kYXRlQ2xhc3MoZGF0YVB0Lm9yaWdpbkluZGV4LGRhdGFQdC5sYWJlbHNbaV0pLGRhdGFQdC5sYWJlbHMuc2xpY2UoaSsxKV0pO31lbHNle3JldHVybiBkYXRhUHQubGFiZWxzO319LF9nZXRMZWdlbmRPcHRpb25zOmZ1bmN0aW9uKGRhdGFzZXRzQ291bnQpe3ZhciBsZWdlbmRPcHRpb25zPXtkaXNwbGF5OmRhdGFzZXRzQ291bnQ8PU1BWF9MRUdFTkRfTEVOR1RILHBvc2l0aW9uOid0b3AnLG9uSG92ZXI6dGhpcy5fb25sZWdlbmRUb29sdGlwSG92ZXIuYmluZCh0aGlzKSxvbkxlYXZlOnRoaXMuX29uTGVnZW5kVG9vdGlwTGVhdmUuYmluZCh0aGlzKSx9O3ZhciBzZWxmPXRoaXM7aWYoXy5jb250YWlucyhbJ2JhcicsJ2xpbmUnXSx0aGlzLnN0YXRlLm1vZGUpKXt2YXIgcmVmZXJlbmNlQ29sb3I7aWYodGhpcy5zdGF0ZS5tb2RlPT09J2Jhcicpe3JlZmVyZW5jZUNvbG9yPSdiYWNrZ3JvdW5kQ29sb3InO31lbHNle3JlZmVyZW5jZUNvbG9yPSdib3JkZXJDb2xvcic7fQpsZWdlbmRPcHRpb25zLmxhYmVscz17Z2VuZXJhdGVMYWJlbHM6ZnVuY3Rpb24oY2hhcnQpe3ZhciBkYXRhPWNoYXJ0LmRhdGE7cmV0dXJuIGRhdGEuZGF0YXNldHMubWFwKGZ1bmN0aW9uKGRhdGFzZXQsaSl7cmV0dXJue3RleHQ6c2VsZi5fc2hvcnRlbkxhYmVsKGRhdGFzZXQubGFiZWwpLGZ1bGxUZXh0OmRhdGFzZXQubGFiZWwsZmlsbFN0eWxlOmRhdGFzZXRbcmVmZXJlbmNlQ29sb3JdLGhpZGRlbjohY2hhcnQuaXNEYXRhc2V0VmlzaWJsZShpKSxsaW5lQ2FwOmRhdGFzZXQuYm9yZGVyQ2FwU3R5bGUsbGluZURhc2g6ZGF0YXNldC5ib3JkZXJEYXNoLGxpbmVEYXNoT2Zmc2V0OmRhdGFzZXQuYm9yZGVyRGFzaE9mZnNldCxsaW5lSm9pbjpkYXRhc2V0LmJvcmRlckpvaW5TdHlsZSxsaW5lV2lkdGg6ZGF0YXNldC5ib3JkZXJXaWR0aCxzdHJva2VTdHlsZTpkYXRhc2V0W3JlZmVyZW5jZUNvbG9yXSxwb2ludFN0eWxlOmRhdGFzZXQucG9pbnRTdHlsZSxkYXRhc2V0SW5kZXg6aSx9O30pO30sfTt9ZWxzZXtsZWdlbmRPcHRpb25zLmxhYmVscz17Z2VuZXJhdGVMYWJlbHM6ZnVuY3Rpb24oY2hhcnQpe3ZhciBkYXRhPWNoYXJ0LmRhdGE7dmFyIG1ldGFEYXRhPWRhdGEuZGF0YXNldHMubWFwKGZ1bmN0aW9uKGRhdGFzZXQsaW5kZXgpe3JldHVybiBjaGFydC5nZXREYXRhc2V0TWV0YShpbmRleCkuZGF0YTt9KTtyZXR1cm4gZGF0YS5sYWJlbHMubWFwKGZ1bmN0aW9uKGxhYmVsLGkpe3ZhciBoaWRkZW49bWV0YURhdGEucmVkdWNlKGZ1bmN0aW9uKGhpZGRlbixkYXRhKXtpZihkYXRhW2ldKXtoaWRkZW49aGlkZGVufHxkYXRhW2ldLmhpZGRlbjt9CnJldHVybiBoaWRkZW47fSxmYWxzZSk7dmFyIGZ1bGxUZXh0PXNlbGYuX3JlbGFiZWxsaW5nKGxhYmVsKTt2YXIgdGV4dD1zZWxmLl9zaG9ydGVuTGFiZWwoZnVsbFRleHQpO3JldHVybnt0ZXh0OnRleHQsZnVsbFRleHQ6ZnVsbFRleHQsZmlsbFN0eWxlOmxhYmVsLmlzTm9EYXRhPycjZDNkM2QzJzpzZWxmLl9nZXRDb2xvcihpKSxoaWRkZW46aGlkZGVuLGluZGV4OmksfTt9KTt9LH07fQpyZXR1cm4gbGVnZW5kT3B0aW9uczt9LF9nZXRTY2FsZU9wdGlvbnM6ZnVuY3Rpb24oKXt2YXIgc2VsZj10aGlzO2lmKF8uY29udGFpbnMoWydiYXInLCdsaW5lJ10sdGhpcy5zdGF0ZS5tb2RlKSl7cmV0dXJue3hBeGVzOlt7dHlwZTonY2F0ZWdvcnknLHNjYWxlTGFiZWw6e2Rpc3BsYXk6dGhpcy5zdGF0ZS5ncm91cEJ5Lmxlbmd0aCYmIXRoaXMuaXNFbWJlZGRlZCxsYWJlbFN0cmluZzp0aGlzLnN0YXRlLmdyb3VwQnkubGVuZ3RoP3RoaXMuZmllbGRzW3RoaXMuc3RhdGUuZ3JvdXBCeVswXS5zcGxpdCgnOicpWzBdXS5zdHJpbmc6JycsfSx0aWNrczp7Y2FsbGJhY2s6ZnVuY3Rpb24obGFiZWwpe3JldHVybiBzZWxmLl9yZWxhYmVsbGluZyhsYWJlbCk7fSx9LH1dLHlBeGVzOlt7dHlwZTonbGluZWFyJyxzY2FsZUxhYmVsOntkaXNwbGF5OiF0aGlzLmlzRW1iZWRkZWQsbGFiZWxTdHJpbmc6dGhpcy5maWVsZHNbdGhpcy5zdGF0ZS5tZWFzdXJlXS5zdHJpbmcsfSx0aWNrczp7Y2FsbGJhY2s6dGhpcy5fZm9ybWF0VmFsdWUuYmluZCh0aGlzKSxzdWdnZXN0ZWRNYXg6MCxzdWdnZXN0ZWRNaW46MCx9fV0sfTt9CnJldHVybnt9O30sX2dldFRvb2x0aXBJdGVtQ29udGVudDpmdW5jdGlvbihpdGVtLGRhdGEpe3ZhciBkYXRhc2V0PWRhdGEuZGF0YXNldHNbaXRlbS5kYXRhc2V0SW5kZXhdO3ZhciBsYWJlbD1kYXRhLmxhYmVsc1tpdGVtLmluZGV4XTt2YXIgdmFsdWU7dmFyIGJveENvbG9yO2lmKHRoaXMuc3RhdGUubW9kZT09PSdiYXInKXtsYWJlbD10aGlzLl9yZWxhYmVsbGluZyhsYWJlbCxkYXRhc2V0Lm9yaWdpbkluZGV4KTtpZih0aGlzLnN0YXRlLmdyb3VwQnkubGVuZ3RoPjF8fHRoaXMuc3RhdGUub3JpZ2lucy5sZW5ndGg+MSl7bGFiZWw9bGFiZWwrIi8iK2RhdGFzZXQubGFiZWw7fQp2YWx1ZT10aGlzLl9mb3JtYXRWYWx1ZShpdGVtLnlMYWJlbCk7Ym94Q29sb3I9ZGF0YXNldC5iYWNrZ3JvdW5kQ29sb3I7fWVsc2UgaWYodGhpcy5zdGF0ZS5tb2RlPT09J2xpbmUnKXtsYWJlbD10aGlzLl9yZWxhYmVsbGluZyhsYWJlbCxkYXRhc2V0Lm9yaWdpbkluZGV4KTtpZih0aGlzLnN0YXRlLmdyb3VwQnkubGVuZ3RoPjF8fHRoaXMuc3RhdGUub3JpZ2lucy5sZW5ndGg+MSl7bGFiZWw9bGFiZWwrIi8iK2RhdGFzZXQubGFiZWw7fQp2YWx1ZT10aGlzLl9mb3JtYXRWYWx1ZShpdGVtLnlMYWJlbCk7Ym94Q29sb3I9ZGF0YXNldC5ib3JkZXJDb2xvcjt9ZWxzZXtpZihsYWJlbC5pc05vRGF0YSl7dmFsdWU9dGhpcy5fZm9ybWF0VmFsdWUoMCk7fWVsc2V7dmFsdWU9dGhpcy5fZm9ybWF0VmFsdWUoZGF0YXNldC5kYXRhW2l0ZW0uaW5kZXhdKTt9CmxhYmVsPXRoaXMuX3JlbGFiZWxsaW5nKGxhYmVsLGRhdGFzZXQub3JpZ2luSW5kZXgpO2lmKHRoaXMuc3RhdGUub3JpZ2lucy5sZW5ndGg+MSl7bGFiZWw9ZGF0YXNldC5sYWJlbCsiLyIrbGFiZWw7fQpib3hDb2xvcj1kYXRhc2V0LmJhY2tncm91bmRDb2xvcltpdGVtLmluZGV4XTt9CnJldHVybntsYWJlbDpsYWJlbCx2YWx1ZTp2YWx1ZSxib3hDb2xvcjpib3hDb2xvcix9O30sX2dldFRvb2x0aXBJdGVtczpmdW5jdGlvbih0b29sdGlwTW9kZWwpe3ZhciBzZWxmPXRoaXM7dmFyIGRhdGE9dGhpcy5jaGFydC5jb25maWcuZGF0YTt2YXIgb3JkZXJlZEl0ZW1zPXRvb2x0aXBNb2RlbC5kYXRhUG9pbnRzLnNvcnQoZnVuY3Rpb24oZFB0MSxkUHQyKXtyZXR1cm4gZFB0Mi55TGFiZWwtZFB0MS55TGFiZWw7fSk7cmV0dXJuIG9yZGVyZWRJdGVtcy5yZWR1Y2UoZnVuY3Rpb24oYWNjLGl0ZW0pe2FjYy5wdXNoKHNlbGYuX2dldFRvb2x0aXBJdGVtQ29udGVudChpdGVtLGRhdGEpKTtyZXR1cm4gYWNjO30sW10pO30sX2dldFRvb2x0aXBPcHRpb25zOmZ1bmN0aW9uKCl7dmFyIHRvb2x0aXBPcHRpb25zPXtlbmFibGVkOmZhbHNlLGN1c3RvbTp0aGlzLl9jdXN0b21Ub29sdGlwLmJpbmQodGhpcyksfTtpZih0aGlzLnN0YXRlLm1vZGU9PT0nbGluZScpe3Rvb2x0aXBPcHRpb25zLm1vZGU9J2luZGV4Jzt0b29sdGlwT3B0aW9ucy5pbnRlcnNlY3Q9ZmFsc2U7fQpyZXR1cm4gdG9vbHRpcE9wdGlvbnM7fSxfaW5kZXhPZjpmdW5jdGlvbihsaXN0LGxhYmVsKXt2YXIgaW5kZXg9LTE7Zm9yKHZhciBqPTA7ajxsaXN0Lmxlbmd0aDtqKyspe3ZhciBvdGhlckxhYmVsPWxpc3Rbal07aWYobGFiZWwubGVuZ3RoPT09b3RoZXJMYWJlbC5sZW5ndGgpe3ZhciBlcXVhbD10cnVlO2Zvcih2YXIgaT0wO2k8bGFiZWwubGVuZ3RoO2krKyl7aWYobGFiZWxbaV0hPT1vdGhlckxhYmVsW2ldKXtlcXVhbD1mYWxzZTt9fQppZihlcXVhbCl7aW5kZXg9ajticmVhazt9fX0KcmV0dXJuIGluZGV4O30sX3ByZXBhcmVEYXRhOmZ1bmN0aW9uKGRhdGFQb2ludHMpe3ZhciBzZWxmPXRoaXM7dmFyIGxhYmVscz1kYXRhUG9pbnRzLnJlZHVjZShmdW5jdGlvbihhY2MsZGF0YVB0KXt2YXIgbGFiZWw9c2VsZi5fZ2V0TGFiZWwoZGF0YVB0KTt2YXIgaW5kZXg9c2VsZi5faW5kZXhPZihhY2MsbGFiZWwpO2lmKGluZGV4PT09LTEpe2FjYy5wdXNoKGxhYmVsKTt9CnJldHVybiBhY2M7fSxbXSk7dmFyIG5ld0RhdGFzZXQ9ZnVuY3Rpb24oZGF0YXNldExhYmVsLG9yaWdpbkluZGV4KXt2YXIgZGF0YT1uZXcgQXJyYXkoc2VsZi5fZ2V0RGF0YXNldERhdGFMZW5ndGgob3JpZ2luSW5kZXgsbGFiZWxzLmxlbmd0aCkpLmZpbGwoMCk7cmV0dXJue2xhYmVsOmRhdGFzZXRMYWJlbCxkYXRhOmRhdGEsb3JpZ2luSW5kZXg6b3JpZ2luSW5kZXgsfTt9O3ZhciBkYXRhc2V0cz1fLnZhbHVlcyhkYXRhUG9pbnRzLnJlZHVjZShmdW5jdGlvbihhY2MsZGF0YVB0KXt2YXIgZGF0YXNldExhYmVsPXNlbGYuX2dldERhdGFzZXRMYWJlbChkYXRhUHQpO2lmKCEoZGF0YXNldExhYmVsIGluIGFjYykpe2FjY1tkYXRhc2V0TGFiZWxdPW5ld0RhdGFzZXQoZGF0YXNldExhYmVsLGRhdGFQdC5vcmlnaW5JbmRleCk7fQp2YXIgbGFiZWw9c2VsZi5fZ2V0TGFiZWwoZGF0YVB0KTt2YXIgbGFiZWxJbmRleD1zZWxmLl9pbmRleE9mKGxhYmVscyxsYWJlbCk7YWNjW2RhdGFzZXRMYWJlbF0uZGF0YVtsYWJlbEluZGV4XT1kYXRhUHQudmFsdWU7cmV0dXJuIGFjYzt9LHt9KSk7ZGF0YXNldHM9ZGF0YXNldHMuc29ydChmdW5jdGlvbihkYXRhc2V0MSxkYXRhc2V0Mil7cmV0dXJuIGRhdGFzZXQxLm9yaWdpbkluZGV4LWRhdGFzZXQyLm9yaWdpbkluZGV4O30pO3JldHVybntkYXRhc2V0czpkYXRhc2V0cyxsYWJlbHM6bGFiZWxzLH07fSxfcHJlcGFyZU9wdGlvbnM6ZnVuY3Rpb24oZGF0YXNldHNDb3VudCl7cmV0dXJue21haW50YWluQXNwZWN0UmF0aW86ZmFsc2Usc2NhbGVzOnRoaXMuX2dldFNjYWxlT3B0aW9ucygpLGxlZ2VuZDp0aGlzLl9nZXRMZWdlbmRPcHRpb25zKGRhdGFzZXRzQ291bnQpLHRvb2x0aXBzOnRoaXMuX2dldFRvb2x0aXBPcHRpb25zKCksZWxlbWVudHM6dGhpcy5fZ2V0RWxlbWVudE9wdGlvbnMoKSx9O30sX3JlbGFiZWxsaW5nOmZ1bmN0aW9uKGxhYmVsLG9yaWdpbkluZGV4KXtpZihsYWJlbC5pc05vRGF0YSl7cmV0dXJuIGxhYmVsWzBdO30KdmFyIGk9dGhpcy5zdGF0ZS5jb21wYXJpc29uRmllbGRJbmRleDtpZihfLmNvbnRhaW5zKFsnYmFyJywnbGluZSddLHRoaXMuc3RhdGUubW9kZSkmJmk9PT0wKXtyZXR1cm4gdGhpcy5kYXRlQ2xhc3Nlcy5yZXByZXNlbnRhdGl2ZShsYWJlbCxvcmlnaW5JbmRleCl8fCcnO31lbHNlIGlmKHRoaXMuc3RhdGUubW9kZT09PSdwaWUnJiZpPT09MCl7dmFyIGxhYmVsQ29weT1sYWJlbC5zbGljZSgwKTtpZihvcmlnaW5JbmRleCE9PXVuZGVmaW5lZCl7bGFiZWxDb3B5LnNwbGljZShpLDEsdGhpcy5kYXRlQ2xhc3Nlcy5yZXByZXNlbnRhdGl2ZShsYWJlbFtpXSxvcmlnaW5JbmRleCkpO31lbHNle2xhYmVsQ29weS5zcGxpY2UoaSwxLHRoaXMuZGF0ZUNsYXNzZXMuZGF0ZUNsYXNzTWVtYmVycyhsYWJlbFtpXSkpO30KcmV0dXJuIGxhYmVsQ29weS5qb2luKCcvJyk7fQpyZXR1cm4gbGFiZWwuam9pbignLycpfHxfdCgnVG90YWwnKTt9LF9yZW5kZXI6ZnVuY3Rpb24oKXtpZih0aGlzLmNoYXJ0KXt0aGlzLmNoYXJ0LmRlc3Ryb3koKTt9CnRoaXMuJGVsLmVtcHR5KCk7aWYoIV8uY29udGFpbnMoQ0hBUlRfVFlQRVMsdGhpcy5zdGF0ZS5tb2RlKSl7dGhpcy50cmlnZ2VyX3VwKCd3YXJuaW5nJyx7dGl0bGU6X3QoJ0ludmFsaWQgbW9kZSBmb3IgY2hhcnQnKSxtZXNzYWdlOl90KCdDYW5ub3QgcmVuZGVyIGNoYXJ0IHdpdGggbW9kZSA6ICcpK3RoaXMuc3RhdGUubW9kZX0pO30KdmFyIGRhdGFQb2ludHM9dGhpcy5fZmlsdGVyRGF0YVBvaW50cygpO2lmKCFkYXRhUG9pbnRzLmxlbmd0aCYmdGhpcy5zdGF0ZS5tb2RlIT09J3BpZScpe3RoaXMuJGVsLmFwcGVuZChxd2ViLnJlbmRlcignVmlldy5Ob0NvbnRlbnRIZWxwZXInKSk7fWVsc2UgaWYodGhpcy5pc0luRE9NKXt2YXIgJGNhbnZhc0NvbnRhaW5lcj0kKCc8ZGl2Lz4nLHtjbGFzczonb19ncmFwaF9jYW52YXNfY29udGFpbmVyJ30pO3ZhciAkY2FudmFzPSQoJzxjYW52YXMvPicpLmF0dHIoJ2lkJyx0aGlzLmNoYXJ0SWQpOyRjYW52YXNDb250YWluZXIuYXBwZW5kKCRjYW52YXMpO3RoaXMuJGVsLmFwcGVuZCgkY2FudmFzQ29udGFpbmVyKTt2YXIgaT10aGlzLnN0YXRlLmNvbXBhcmlzb25GaWVsZEluZGV4O2lmKGk9PT0wKXt0aGlzLmRhdGVDbGFzc2VzPXRoaXMuX2dldERhdGVDbGFzc2VzKGRhdGFQb2ludHMpO30KaWYodGhpcy5zdGF0ZS5tb2RlPT09J2Jhcicpe3RoaXMuX3JlbmRlckJhckNoYXJ0KGRhdGFQb2ludHMpO31lbHNlIGlmKHRoaXMuc3RhdGUubW9kZT09PSdsaW5lJyl7dGhpcy5fcmVuZGVyTGluZUNoYXJ0KGRhdGFQb2ludHMpO31lbHNlIGlmKHRoaXMuc3RhdGUubW9kZT09PSdwaWUnKXt0aGlzLl9yZW5kZXJQaWVDaGFydChkYXRhUG9pbnRzKTt9CnRoaXMuX3JlbmRlclRpdGxlKCk7fQpyZXR1cm4gdGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO30sX3JlbmRlckJhckNoYXJ0OmZ1bmN0aW9uKGRhdGFQb2ludHMpe3ZhciBzZWxmPXRoaXM7dmFyIGRhdGE9dGhpcy5fcHJlcGFyZURhdGEoZGF0YVBvaW50cyk7ZGF0YS5kYXRhc2V0cy5mb3JFYWNoKGZ1bmN0aW9uKGRhdGFzZXQsaW5kZXgpe2RhdGFzZXQuc3RhY2s9c2VsZi5zdGF0ZS5zdGFja2VkP3NlbGYuc3RhdGUub3JpZ2luc1tkYXRhc2V0Lm9yaWdpbkluZGV4XTp1bmRlZmluZWQ7dmFyIGNvbG9yPXNlbGYuX2dldENvbG9yKGluZGV4KTtkYXRhc2V0LmJhY2tncm91bmRDb2xvcj1jb2xvcjt9KTt2YXIgb3B0aW9ucz10aGlzLl9wcmVwYXJlT3B0aW9ucyhkYXRhLmRhdGFzZXRzLmxlbmd0aCk7dmFyIGN0eD1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0aGlzLmNoYXJ0SWQpO3RoaXMuY2hhcnQ9bmV3IENoYXJ0KGN0eCx7dHlwZTonYmFyJyxkYXRhOmRhdGEsb3B0aW9uczpvcHRpb25zLH0pO30sX3JlbmRlckxpbmVDaGFydDpmdW5jdGlvbihkYXRhUG9pbnRzKXt2YXIgc2VsZj10aGlzO3ZhciBkYXRhPXRoaXMuX3ByZXBhcmVEYXRhKGRhdGFQb2ludHMpO2RhdGEuZGF0YXNldHMuZm9yRWFjaChmdW5jdGlvbihkYXRhc2V0LGluZGV4KXtpZihzZWxmLnN0YXRlLmdyb3VwQnkubGVuZ3RoPD0xJiZzZWxmLnN0YXRlLm9yaWdpbnMubGVuZ3RoPjEpe2lmKGRhdGFzZXQub3JpZ2luSW5kZXg9PT0wKXtkYXRhc2V0LmZpbGw9J29yaWdpbic7ZGF0YXNldC5iYWNrZ3JvdW5kQ29sb3I9aGV4VG9SR0JBKENPTE9SU1swXSwwLjQpO2RhdGFzZXQuYm9yZGVyQ29sb3I9aGV4VG9SR0JBKENPTE9SU1swXSwxKTt9ZWxzZSBpZihkYXRhc2V0Lm9yaWdpbkluZGV4PT09MSl7ZGF0YXNldC5ib3JkZXJDb2xvcj1oZXhUb1JHQkEoQ09MT1JTWzFdLDEpO31lbHNle2RhdGFzZXQuYm9yZGVyQ29sb3I9c2VsZi5fZ2V0Q29sb3IoaW5kZXgpO319ZWxzZXtkYXRhc2V0LmJvcmRlckNvbG9yPXNlbGYuX2dldENvbG9yKGluZGV4KTt9CmlmKGRhdGEubGFiZWxzLmxlbmd0aD09PTEpe2RhdGFzZXQuZGF0YS51bnNoaWZ0KHVuZGVmaW5lZCk7fQpkYXRhc2V0LnBvaW50QmFja2dyb3VuZENvbG9yPWRhdGFzZXQuYm9yZGVyQ29sb3I7ZGF0YXNldC5wb2ludEJvcmRlckNvbG9yPSdyZ2JhKDAsMCwwLDAuMiknO30pO2lmKGRhdGEuZGF0YXNldHMubGVuZ3RoPT09MSl7Y29uc3QgZGF0YXNldD1kYXRhLmRhdGFzZXRzWzBdO2RhdGFzZXQuZmlsbD0nb3JpZ2luJztkYXRhc2V0LmJhY2tncm91bmRDb2xvcj1oZXhUb1JHQkEoQ09MT1JTWzBdLDAuNCk7fQpkYXRhLmxhYmVscz1kYXRhLmxhYmVscy5sZW5ndGg+MT9kYXRhLmxhYmVsczpBcnJheS5wcm90b3R5cGUuY29uY2F0LmFwcGx5KFtdLFtbWycnXV0sZGF0YS5sYWJlbHMsW1snJ11dXSk7dmFyIG9wdGlvbnM9dGhpcy5fcHJlcGFyZU9wdGlvbnMoZGF0YS5kYXRhc2V0cy5sZW5ndGgpO3ZhciBjdHg9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGhpcy5jaGFydElkKTt0aGlzLmNoYXJ0PW5ldyBDaGFydChjdHgse3R5cGU6J2xpbmUnLGRhdGE6ZGF0YSxvcHRpb25zOm9wdGlvbnMsfSk7fSxfcmVuZGVyUGllQ2hhcnQ6ZnVuY3Rpb24oZGF0YVBvaW50cyl7dmFyIHNlbGY9dGhpczt2YXIgYWxsTmVnYXRpdmU9dHJ1ZTt2YXIgc29tZU5lZ2F0aXZlPWZhbHNlO3ZhciBhbGxaZXJvPXRydWU7ZGF0YVBvaW50cy5mb3JFYWNoKGZ1bmN0aW9uKGRhdGFwdCl7YWxsTmVnYXRpdmU9YWxsTmVnYXRpdmUmJihkYXRhcHQudmFsdWU8MCk7c29tZU5lZ2F0aXZlPXNvbWVOZWdhdGl2ZXx8KGRhdGFwdC52YWx1ZTwwKTthbGxaZXJvPWFsbFplcm8mJihkYXRhcHQudmFsdWU9PT0wKTt9KTtpZihzb21lTmVnYXRpdmUmJiFhbGxOZWdhdGl2ZSl7dGhpcy4kZWwuZW1wdHkoKTt0aGlzLiRlbC5hcHBlbmQocXdlYi5yZW5kZXIoJ1ZpZXcuTm9Db250ZW50SGVscGVyJyx7dGl0bGU6X3QoIkludmFsaWQgZGF0YSIpLGRlc2NyaXB0aW9uOl90KCJQaWUgY2hhcnQgY2Fubm90IG1peCBwb3NpdGl2ZSBhbmQgbmVnYXRpdmUgbnVtYmVycy4gIisiVHJ5IHRvIGNoYW5nZSB5b3VyIGRvbWFpbiB0byBvbmx5IGRpc3BsYXkgcG9zaXRpdmUgcmVzdWx0cyIpLH0pKTtyZXR1cm47fQppZihhbGxaZXJvJiYhdGhpcy5pc0VtYmVkZGVkJiZ0aGlzLnN0YXRlLm9yaWdpbnMubGVuZ3RoPT09MSl7dGhpcy4kZWwuZW1wdHkoKTt0aGlzLiRlbC5hcHBlbmQocXdlYi5yZW5kZXIoJ1ZpZXcuTm9Db250ZW50SGVscGVyJyx7dGl0bGU6X3QoIkludmFsaWQgZGF0YSIpLGRlc2NyaXB0aW9uOl90KCJQaWUgY2hhcnQgY2Fubm90IGRpc3BsYXkgYWxsIHplcm8gbnVtYmVycy4uICIrIlRyeSB0byBjaGFuZ2UgeW91ciBkb21haW4gdG8gZGlzcGxheSBwb3NpdGl2ZSByZXN1bHRzIiksfSkpO3JldHVybjt9CnZhciBkYXRhPXt9O3ZhciBjb2xvcnM9W107aWYoYWxsWmVybyl7ZGF0YS5sYWJlbHM9W05PX0RBVEFdO2RhdGEuZGF0YXNldHM9dGhpcy5zdGF0ZS5vcmlnaW5zLm1hcChmdW5jdGlvbihvcmlnaW4pe3JldHVybntsYWJlbDpvcmlnaW4sZGF0YTpbMV0sYmFja2dyb3VuZENvbG9yOlsnI2QzZDNkMyddLH07fSk7fWVsc2V7ZGF0YT10aGlzLl9wcmVwYXJlRGF0YShkYXRhUG9pbnRzKTtjb2xvcnM9ZGF0YS5sYWJlbHMubWFwKGZ1bmN0aW9uKGxhYmVsLGluZGV4KXtyZXR1cm4gc2VsZi5fZ2V0Q29sb3IoaW5kZXgpO30pO2RhdGEuZGF0YXNldHMuZm9yRWFjaChmdW5jdGlvbihkYXRhc2V0KXtkYXRhc2V0LmJhY2tncm91bmRDb2xvcj1jb2xvcnM7ZGF0YXNldC5ib3JkZXJDb2xvcj0ncmdiYSgyNTUsMjU1LDI1NSwwLjYpJzt9KTt2YXIgcmVwcmVzZW50ZWRPcmlnaW5JbmRleGVzPWRhdGEuZGF0YXNldHMubWFwKGZ1bmN0aW9uKGRhdGFzZXQpe3JldHVybiBkYXRhc2V0Lm9yaWdpbkluZGV4O30pO3ZhciBhZGROb0RhdGFUb0xlZ2VuZD1mYWxzZTt2YXIgZmFrZURhdGE9KG5ldyBBcnJheShkYXRhLmxhYmVscy5sZW5ndGgpKS5jb25jYXQoWzFdKTt0aGlzLnN0YXRlLm9yaWdpbnMuZm9yRWFjaChmdW5jdGlvbihvcmlnaW4sb3JpZ2luSW5kZXgpe2lmKCFfLmNvbnRhaW5zKHJlcHJlc2VudGVkT3JpZ2luSW5kZXhlcyxvcmlnaW5JbmRleCkpe2RhdGEuZGF0YXNldHMuc3BsaWNlKG9yaWdpbkluZGV4LDAse2xhYmVsOm9yaWdpbixkYXRhOmZha2VEYXRhLGJhY2tncm91bmRDb2xvcjpjb2xvcnMuY29uY2F0KFsnI2QzZDNkMyddKSx9KTthZGROb0RhdGFUb0xlZ2VuZD10cnVlO319KTtpZihhZGROb0RhdGFUb0xlZ2VuZCl7ZGF0YS5sYWJlbHMucHVzaChOT19EQVRBKTt9fQp2YXIgb3B0aW9ucz10aGlzLl9wcmVwYXJlT3B0aW9ucyhkYXRhLmRhdGFzZXRzLmxlbmd0aCk7dmFyIGN0eD1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0aGlzLmNoYXJ0SWQpO3RoaXMuY2hhcnQ9bmV3IENoYXJ0KGN0eCx7dHlwZToncGllJyxkYXRhOmRhdGEsb3B0aW9uczpvcHRpb25zLH0pO30sX3JlbmRlclRpdGxlOmZ1bmN0aW9uKCl7aWYodGhpcy50aXRsZSl7dGhpcy4kZWwucHJlcGVuZCgkKCc8bGFiZWwvPicse3RleHQ6dGhpcy50aXRsZSx9KSk7fX0sX3Nob3J0ZW5MYWJlbDpmdW5jdGlvbihsYWJlbCl7dmFyIGdyb3Vwcz1sYWJlbC5zcGxpdCgiLyIpO3ZhciBzaG9ydExhYmVsPWdyb3Vwcy5zbGljZSgwLDMpLmpvaW4oIi8iKTtpZihzaG9ydExhYmVsLmxlbmd0aD4zMCl7c2hvcnRMYWJlbD1zaG9ydExhYmVsLnNsaWNlKDAsMzApKycuLi4nO31lbHNlIGlmKGdyb3Vwcy5sZW5ndGg+Myl7c2hvcnRMYWJlbD1zaG9ydExhYmVsKycvLi4uJzt9CnJldHVybiBzaG9ydExhYmVsO30sX29ubGVnZW5kVG9vbHRpcEhvdmVyOmZ1bmN0aW9uKGUsbGVnZW5kSXRlbSl7aWYobGVnZW5kSXRlbS50ZXh0PT09bGVnZW5kSXRlbS5mdWxsVGV4dHx8dGhpcy4kbGVnZW5kVG9vbHRpcCl7cmV0dXJuO30KY29uc3QgY2hhcnRBcmVhTGVmdD10aGlzLmNoYXJ0LmNoYXJ0QXJlYS5sZWZ0O2NvbnN0IGNoYXJ0QXJlYVJpZ2h0PXRoaXMuY2hhcnQuY2hhcnRBcmVhLnJpZ2h0O2NvbnN0IHJlbmRlcmVyVG9wPXRoaXMuJGVsWzBdLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnRvcDt0aGlzLiRsZWdlbmRUb29sdGlwPSQoJzxkaXY+Jyx7Y2xhc3M6Im9fdG9vbHRpcF9sZWdlbmQiLHRleHQ6bGVnZW5kSXRlbS5mdWxsVGV4dCxjc3M6e21heFdpZHRoOk1hdGguZmxvb3IoKGNoYXJ0QXJlYVJpZ2h0LWNoYXJ0QXJlYUxlZnQpLzEuNjgpKydweCcsdG9wOihlLmNsaWVudFktcmVuZGVyZXJUb3ApKydweCcsfX0pO2NvbnN0ICRjb250YWluZXI9dGhpcy4kZWwuZmluZCgnLm9fZ3JhcGhfY2FudmFzX2NvbnRhaW5lcicpOyRjb250YWluZXIuYXBwZW5kKHRoaXMuJGxlZ2VuZFRvb2x0aXApO3RoaXMuX2ZpeFRvb2x0aXBMZWZ0UG9zaXRpb24odGhpcy4kbGVnZW5kVG9vbHRpcFswXSxlLmNsaWVudFgpO30sX29uTGVnZW5kVG9vdGlwTGVhdmU6ZnVuY3Rpb24oKXtpZih0aGlzLiRsZWdlbmRUb29sdGlwKXt0aGlzLiRsZWdlbmRUb29sdGlwLnJlbW92ZSgpO3RoaXMuJGxlZ2VuZFRvb2x0aXA9bnVsbDt9fSx9KTt9KTs7CgovKiAvd2ViL3N0YXRpYy9zcmMvanMvdmlld3MvZ3JhcGgvZ3JhcGhfdmlldy5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwpvZG9vLmRlZmluZSgnd2ViLkdyYXBoVmlldycsZnVuY3Rpb24ocmVxdWlyZSl7InVzZSBzdHJpY3QiO3ZhciBBYnN0cmFjdFZpZXc9cmVxdWlyZSgnd2ViLkFic3RyYWN0VmlldycpO3ZhciBjb3JlPXJlcXVpcmUoJ3dlYi5jb3JlJyk7dmFyIEdyYXBoTW9kZWw9cmVxdWlyZSgnd2ViLkdyYXBoTW9kZWwnKTt2YXIgQ29udHJvbGxlcj1yZXF1aXJlKCd3ZWIuR3JhcGhDb250cm9sbGVyJyk7dmFyIEdyYXBoUmVuZGVyZXI9cmVxdWlyZSgnd2ViLkdyYXBoUmVuZGVyZXInKTt2YXIgX3Q9Y29yZS5fdDt2YXIgX2x0PWNvcmUuX2x0O3ZhciBjb250cm9sUGFuZWxWaWV3UGFyYW1ldGVycz1yZXF1aXJlKCd3ZWIuY29udHJvbFBhbmVsVmlld1BhcmFtZXRlcnMnKTt2YXIgR1JPVVBBQkxFX1RZUEVTPWNvbnRyb2xQYW5lbFZpZXdQYXJhbWV0ZXJzLkdST1VQQUJMRV9UWVBFUzt2YXIgR3JhcGhWaWV3PUFic3RyYWN0Vmlldy5leHRlbmQoe2Rpc3BsYXlfbmFtZTpfbHQoJ0dyYXBoJyksaWNvbjonZmEtYmFyLWNoYXJ0Jyxqc0xpYnM6Wycvd2ViL3N0YXRpYy9saWIvQ2hhcnQvQ2hhcnQuanMnLF0sY29uZmlnOl8uZXh0ZW5kKHt9LEFic3RyYWN0Vmlldy5wcm90b3R5cGUuY29uZmlnLHtNb2RlbDpHcmFwaE1vZGVsLENvbnRyb2xsZXI6Q29udHJvbGxlcixSZW5kZXJlcjpHcmFwaFJlbmRlcmVyLH0pLHZpZXdUeXBlOidncmFwaCcsc2VhcmNoTWVudVR5cGVzOlsnZmlsdGVyJywnZ3JvdXBCeScsJ3RpbWVSYW5nZScsJ2Zhdm9yaXRlJ10saW5pdDpmdW5jdGlvbih2aWV3SW5mbyxwYXJhbXMpe3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt2YXIgc2VsZj10aGlzO3ZhciBtZWFzdXJlO3ZhciBncm91cEJ5cz1bXTt2YXIgbWVhc3VyZXM9e19fY291bnRfXzp7c3RyaW5nOl90KCJDb3VudCIpLHR5cGU6ImludGVnZXIifX07dmFyIGdyb3VwYWJsZUZpZWxkcz17fTt0aGlzLmZpZWxkcy5fX2NvdW50X189e3N0cmluZzpfdCgiQ291bnQiKSx0eXBlOiJpbnRlZ2VyIn07dGhpcy5hcmNoLmNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24oZmllbGQpe3ZhciBmaWVsZE5hbWU9ZmllbGQuYXR0cnMubmFtZTtpZihmaWVsZE5hbWU9PT0iaWQiKXtyZXR1cm47fQp2YXIgaW50ZXJ2YWw9ZmllbGQuYXR0cnMuaW50ZXJ2YWw7aWYoaW50ZXJ2YWwpe2ZpZWxkTmFtZT1maWVsZE5hbWUrJzonK2ludGVydmFsO30KaWYoZmllbGQuYXR0cnMudHlwZT09PSdtZWFzdXJlJyl7bWVhc3VyZT1maWVsZE5hbWU7bWVhc3VyZXNbZmllbGROYW1lXT1zZWxmLmZpZWxkc1tmaWVsZE5hbWVdO31lbHNle2dyb3VwQnlzLnB1c2goZmllbGROYW1lKTt9fSk7Xy5lYWNoKHRoaXMuZmllbGRzLGZ1bmN0aW9uKGZpZWxkLG5hbWUpe2lmKG5hbWUhPT0naWQnJiZmaWVsZC5zdG9yZT09PXRydWUpe2lmKF8uY29udGFpbnMoWydpbnRlZ2VyJywnZmxvYXQnLCdtb25ldGFyeSddLGZpZWxkLnR5cGUpfHxfLmNvbnRhaW5zKHBhcmFtcy5hZGRpdGlvbmFsTWVhc3VyZXMsbmFtZSkpe21lYXN1cmVzW25hbWVdPWZpZWxkO30KaWYoXy5jb250YWlucyhHUk9VUEFCTEVfVFlQRVMsZmllbGQudHlwZSkpe2dyb3VwYWJsZUZpZWxkc1tuYW1lXT1maWVsZDt9fX0pO3RoaXMuY29udHJvbGxlclBhcmFtcy5tZWFzdXJlcz1tZWFzdXJlczt0aGlzLmNvbnRyb2xsZXJQYXJhbXMuZ3JvdXBhYmxlRmllbGRzPWdyb3VwYWJsZUZpZWxkczt0aGlzLnJlbmRlcmVyUGFyYW1zLmZpZWxkcz10aGlzLmZpZWxkczt0aGlzLnJlbmRlcmVyUGFyYW1zLnRpdGxlPXRoaXMuYXJjaC5hdHRycy50aXRsZTt0aGlzLmxvYWRQYXJhbXMubW9kZT10aGlzLmFyY2guYXR0cnMudHlwZXx8J2Jhcic7dGhpcy5sb2FkUGFyYW1zLm1lYXN1cmU9bWVhc3VyZXx8J19fY291bnRfXyc7dGhpcy5sb2FkUGFyYW1zLmdyb3VwQnlzPWdyb3VwQnlzO3RoaXMubG9hZFBhcmFtcy5maWVsZHM9dGhpcy5maWVsZHM7dGhpcy5sb2FkUGFyYW1zLmNvbXBhcmlzb25Eb21haW49cGFyYW1zLmNvbXBhcmlzb25Eb21haW47dGhpcy5sb2FkUGFyYW1zLnN0YWNrZWQ9dGhpcy5hcmNoLmF0dHJzLnN0YWNrZWQhPT0iRmFsc2UiO30sfSk7cmV0dXJuIEdyYXBoVmlldzt9KTs7CgovKiAvd2ViL3N0YXRpYy9zcmMvanMvdmlld3Mva2FuYmFuL2thbmJhbl9jb2x1bW4uanMgZGVmaW5lZCBpbiBidW5kbGUgJ3dlYi5hc3NldHNfYmFja2VuZCcgKi8Kb2Rvby5kZWZpbmUoJ3dlYi5LYW5iYW5Db2x1bW4nLGZ1bmN0aW9uKHJlcXVpcmUpeyJ1c2Ugc3RyaWN0Ijt2YXIgY29uZmlnPXJlcXVpcmUoJ3dlYi5jb25maWcnKTt2YXIgY29yZT1yZXF1aXJlKCd3ZWIuY29yZScpO3ZhciBEaWFsb2c9cmVxdWlyZSgnd2ViLkRpYWxvZycpO3ZhciBLYW5iYW5SZWNvcmQ9cmVxdWlyZSgnd2ViLkthbmJhblJlY29yZCcpO3ZhciBSZWNvcmRRdWlja0NyZWF0ZT1yZXF1aXJlKCd3ZWIua2FuYmFuX3JlY29yZF9xdWlja19jcmVhdGUnKTt2YXIgdmlld19kaWFsb2dzPXJlcXVpcmUoJ3dlYi52aWV3X2RpYWxvZ3MnKTt2YXIgdmlld1V0aWxzPXJlcXVpcmUoJ3dlYi52aWV3VXRpbHMnKTt2YXIgV2lkZ2V0PXJlcXVpcmUoJ3dlYi5XaWRnZXQnKTt2YXIgS2FuYmFuQ29sdW1uUHJvZ3Jlc3NCYXI9cmVxdWlyZSgnd2ViLkthbmJhbkNvbHVtblByb2dyZXNzQmFyJyk7dmFyIF90PWNvcmUuX3Q7dmFyIFFXZWI9Y29yZS5xd2ViO3ZhciBLYW5iYW5Db2x1bW49V2lkZ2V0LmV4dGVuZCh7dGVtcGxhdGU6J0thbmJhblZpZXcuR3JvdXAnLGN1c3RvbV9ldmVudHM6e2NhbmNlbF9xdWlja19jcmVhdGU6J19vbkNhbmNlbFF1aWNrQ3JlYXRlJyxxdWlja19jcmVhdGVfYWRkX3JlY29yZDonX29uUXVpY2tDcmVhdGVBZGRSZWNvcmQnLHR3ZWFrX2NvbHVtbjonX29uVHdlYWtDb2x1bW4nLHR3ZWFrX2NvbHVtbl9yZWNvcmRzOidfb25Ud2Vha0NvbHVtblJlY29yZHMnLH0sZXZlbnRzOnsnY2xpY2sgLm9fY29sdW1uX2VkaXQnOidfb25FZGl0Q29sdW1uJywnY2xpY2sgLm9fY29sdW1uX2RlbGV0ZSc6J19vbkRlbGV0ZUNvbHVtbicsJ2NsaWNrIC5vX2thbmJhbl9xdWlja19hZGQnOidfb25BZGRRdWlja0NyZWF0ZScsJ2NsaWNrIC5vX2thbmJhbl9sb2FkX21vcmUnOidfb25Mb2FkTW9yZScsJ2NsaWNrIC5vX2thbmJhbl90b2dnbGVfZm9sZCc6J19vblRvZ2dsZUZvbGQnLCdjbGljayAub19jb2x1bW5fYXJjaGl2ZV9yZWNvcmRzJzonX29uQXJjaGl2ZVJlY29yZHMnLCdjbGljayAub19jb2x1bW5fdW5hcmNoaXZlX3JlY29yZHMnOidfb25VbmFyY2hpdmVSZWNvcmRzJ30saW5pdDpmdW5jdGlvbihwYXJlbnQsZGF0YSxvcHRpb25zLHJlY29yZE9wdGlvbnMpe3RoaXMuX3N1cGVyKHBhcmVudCk7dGhpcy5kYl9pZD1kYXRhLmlkO3RoaXMuZGF0YV9yZWNvcmRzPWRhdGEuZGF0YTt0aGlzLmRhdGE9ZGF0YTt2YXIgdmFsdWU9ZGF0YS52YWx1ZTt0aGlzLmlkPWRhdGEucmVzX2lkO3RoaXMuZm9sZGVkPSFkYXRhLmlzT3Blbjt0aGlzLmhhc19hY3RpdmVfZmllbGQ9J2FjdGl2ZSdpbiBkYXRhLmZpZWxkczt0aGlzLmZpZWxkcz1kYXRhLmZpZWxkczt0aGlzLnJlY29yZHM9W107dGhpcy5tb2RlbE5hbWU9ZGF0YS5tb2RlbDt0aGlzLnF1aWNrX2NyZWF0ZT1vcHRpb25zLnF1aWNrX2NyZWF0ZTt0aGlzLnF1aWNrQ3JlYXRlVmlldz1vcHRpb25zLnF1aWNrQ3JlYXRlVmlldzt0aGlzLmdyb3VwZWRCeT1vcHRpb25zLmdyb3VwZWRCeTt0aGlzLmdyb3VwZWRfYnlfbTJvPW9wdGlvbnMuZ3JvdXBlZF9ieV9tMm87dGhpcy5lZGl0YWJsZT1vcHRpb25zLmVkaXRhYmxlO3RoaXMuZGVsZXRhYmxlPW9wdGlvbnMuZGVsZXRhYmxlO3RoaXMuYXJjaGl2YWJsZT1vcHRpb25zLmFyY2hpdmFibGU7dGhpcy5kcmFnZ2FibGU9b3B0aW9ucy5kcmFnZ2FibGU7dGhpcy5LYW5iYW5SZWNvcmQ9b3B0aW9ucy5LYW5iYW5SZWNvcmR8fEthbmJhblJlY29yZDt0aGlzLnJlY29yZHNfZWRpdGFibGU9b3B0aW9ucy5yZWNvcmRzX2VkaXRhYmxlO3RoaXMucmVjb3Jkc19kZWxldGFibGU9b3B0aW9ucy5yZWNvcmRzX2RlbGV0YWJsZTt0aGlzLnJlY29yZHNEcmFnZ2FibGU9b3B0aW9ucy5yZWNvcmRzRHJhZ2dhYmxlO3RoaXMucmVsYXRpb249b3B0aW9ucy5yZWxhdGlvbjt0aGlzLm9mZnNldD0wO3RoaXMucmVtYWluaW5nPWRhdGEuY291bnQtdGhpcy5kYXRhX3JlY29yZHMubGVuZ3RoO2lmKG9wdGlvbnMuaGFzUHJvZ3Jlc3NCYXIpe3RoaXMuYmFyT3B0aW9ucz17Y29sdW1uSUQ6dGhpcy5kYl9pZCxwcm9ncmVzc0JhclN0YXRlczpvcHRpb25zLnByb2dyZXNzQmFyU3RhdGVzLH07fQp0aGlzLnJlY29yZF9vcHRpb25zPV8uY2xvbmUocmVjb3JkT3B0aW9ucyk7aWYob3B0aW9ucy5ncm91cGVkX2J5X20ybyl7dGhpcy50aXRsZT12YWx1ZT92YWx1ZTpfdCgnVW5kZWZpbmVkJyk7fWVsc2V7dGhpcy50aXRsZT12YWx1ZT09PXVuZGVmaW5lZD9fdCgnVW5kZWZpbmVkJyk6dmFsdWU7fQppZihvcHRpb25zLmdyb3VwX2J5X3Rvb2x0aXApe3RoaXMudG9vbHRpcEluZm89Xy5jb21wYWN0KF8ubWFwKG9wdGlvbnMuZ3JvdXBfYnlfdG9vbHRpcCxmdW5jdGlvbihoZWxwLGZpZWxkKXtoZWxwPWhlbHA/aGVscCsiPC9icj4iOicnO3JldHVybihkYXRhLnRvb2x0aXBEYXRhJiZkYXRhLnRvb2x0aXBEYXRhW2ZpZWxkXSYmIjxkaXY+IitoZWxwK2RhdGEudG9vbHRpcERhdGFbZmllbGRdKyI8L2Rpdj4iKXx8Jyc7fSkpO3RoaXMudG9vbHRpcEluZm89dGhpcy50b29sdGlwSW5mby5qb2luKCI8ZGl2IGNsYXNzPSdkcm9wZG93bi1kaXZpZGVyJyByb2xlPSdzZXBhcmF0b3InIC8+Iik7fX0sc3RhcnQ6ZnVuY3Rpb24oKXt2YXIgc2VsZj10aGlzO3ZhciBkZWZzPVt0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyldO3RoaXMuJGhlYWRlcj10aGlzLiQoJy5vX2thbmJhbl9oZWFkZXInKTtmb3IodmFyIGk9MDtpPHRoaXMuZGF0YV9yZWNvcmRzLmxlbmd0aDtpKyspe2RlZnMucHVzaCh0aGlzLl9hZGRSZWNvcmQodGhpcy5kYXRhX3JlY29yZHNbaV0pKTt9CmlmKHRoaXMucmVjb3Jkc0RyYWdnYWJsZSYmIWNvbmZpZy5kZXZpY2UuaXNNb2JpbGUpe3RoaXMuJGVsLnNvcnRhYmxlKHtjb25uZWN0V2l0aDonLm9fa2FuYmFuX2dyb3VwJyxjb250YWlubWVudDp0aGlzLmRyYWdnYWJsZT9mYWxzZToncGFyZW50JyxyZXZlcnQ6MCxkZWxheTowLGl0ZW1zOic+IC5vX2thbmJhbl9yZWNvcmQ6bm90KC5vX3VwZGF0aW5nKScsY3Vyc29yOidtb3ZlJyxvdmVyOmZ1bmN0aW9uKCl7c2VsZi4kZWwuYWRkQ2xhc3MoJ29fa2FuYmFuX2hvdmVyJyk7fSxvdXQ6ZnVuY3Rpb24oKXtzZWxmLiRlbC5yZW1vdmVDbGFzcygnb19rYW5iYW5faG92ZXInKTt9LHN0YXJ0OmZ1bmN0aW9uKGV2ZW50LHVpKXt1aS5pdGVtLmFkZENsYXNzKCdvX2N1cnJlbnRseV9kcmFnZ2VkJyk7fSxzdG9wOmZ1bmN0aW9uKGV2ZW50LHVpKXt2YXIgaXRlbT11aS5pdGVtO3NldFRpbWVvdXQoZnVuY3Rpb24oKXtpdGVtLnJlbW92ZUNsYXNzKCdvX2N1cnJlbnRseV9kcmFnZ2VkJyk7fSk7fSx1cGRhdGU6ZnVuY3Rpb24oZXZlbnQsdWkpe3ZhciByZWNvcmQ9dWkuaXRlbS5kYXRhKCdyZWNvcmQnKTt2YXIgaW5kZXg9c2VsZi5yZWNvcmRzLmluZGV4T2YocmVjb3JkKTtyZWNvcmQuJGVsLnJlbW92ZUF0dHIoJ3N0eWxlJyk7aWYoaW5kZXg+PTApe2lmKCQuY29udGFpbnMoc2VsZi4kZWxbMF0scmVjb3JkLiRlbFswXSkpe3NlbGYudHJpZ2dlcl91cCgna2FuYmFuX2NvbHVtbl9yZXNlcXVlbmNlJyx7aWRzOnNlbGYuX2dldElEcygpfSk7fX1lbHNle3VpLml0ZW0uYWRkQ2xhc3MoJ29fdXBkYXRpbmcnKTtzZWxmLnRyaWdnZXJfdXAoJ2thbmJhbl9jb2x1bW5fYWRkX3JlY29yZCcse3JlY29yZDpyZWNvcmQsaWRzOnNlbGYuX2dldElEcygpfSk7fX19KTt9CnRoaXMuJGVsLmNsaWNrKGZ1bmN0aW9uKGV2ZW50KXtpZihzZWxmLmZvbGRlZCl7c2VsZi5fb25Ub2dnbGVGb2xkKGV2ZW50KTt9fSk7aWYodGhpcy5iYXJPcHRpb25zKXt0aGlzLiRlbC5hZGRDbGFzcygnb19rYW5iYW5faGFzX3Byb2dyZXNzYmFyJyk7dGhpcy5wcm9ncmVzc0Jhcj1uZXcgS2FuYmFuQ29sdW1uUHJvZ3Jlc3NCYXIodGhpcyx0aGlzLmJhck9wdGlvbnMsdGhpcy5kYXRhKTtkZWZzLnB1c2godGhpcy5wcm9ncmVzc0Jhci5hcHBlbmRUbyh0aGlzLiRoZWFkZXIpKTt9CnZhciB0aXRsZT10aGlzLmZvbGRlZD90aGlzLnRpdGxlKycgKCcrdGhpcy5kYXRhLmNvdW50KycpJzp0aGlzLnRpdGxlO3RoaXMuJGhlYWRlci5maW5kKCcub19jb2x1bW5fdGl0bGUnKS50ZXh0KHRpdGxlKTt0aGlzLiRlbC50b2dnbGVDbGFzcygnb19jb2x1bW5fZm9sZGVkJyx0aGlzLmZvbGRlZCYmIWNvbmZpZy5kZXZpY2UuaXNNb2JpbGUpO2lmKHRoaXMudG9vbHRpcEluZm8pe3RoaXMuJGhlYWRlci5maW5kKCcub19rYW5iYW5faGVhZGVyX3RpdGxlJykudG9vbHRpcCh7fSkuYXR0cignZGF0YS1vcmlnaW5hbC10aXRsZScsdGhpcy50b29sdGlwSW5mbyk7fQppZighdGhpcy5yZW1haW5pbmcpe3RoaXMuJCgnLm9fa2FuYmFuX2xvYWRfbW9yZScpLnJlbW92ZSgpO31lbHNle3RoaXMuJCgnLm9fa2FuYmFuX2xvYWRfbW9yZScpLmh0bWwoUVdlYi5yZW5kZXIoJ0thbmJhblZpZXcuTG9hZE1vcmUnLHt3aWRnZXQ6dGhpc30pKTt9CnJldHVybiBQcm9taXNlLmFsbChkZWZzKTt9LG9uX2F0dGFjaF9jYWxsYmFjazpmdW5jdGlvbigpe18uaW52b2tlKHRoaXMucmVjb3Jkcywnb25fYXR0YWNoX2NhbGxiYWNrJyk7aWYodGhpcy5xdWlja0NyZWF0ZVdpZGdldCl7dGhpcy5xdWlja0NyZWF0ZVdpZGdldC5vbl9hdHRhY2hfY2FsbGJhY2soKTt9fSxhZGRRdWlja0NyZWF0ZTpmdW5jdGlvbigpe2lmKHRoaXMuZm9sZGVkKXt0aGlzLnRyaWdnZXJfdXAoJ2NvbHVtbl90b2dnbGVfZm9sZCcse29wZW5RdWlja0NyZWF0ZTp0cnVlLH0pO3JldHVybjt9CmlmKHRoaXMucXVpY2tDcmVhdGVXaWRnZXQpe3JldHVybiBQcm9taXNlLnJlamVjdCgpO30KdGhpcy50cmlnZ2VyX3VwKCdjbG9zZV9xdWlja19jcmVhdGUnKTt0aGlzLnRyaWdnZXJfdXAoJ3N0YXJ0X3F1aWNrX2NyZWF0ZScpO3ZhciBjb250ZXh0PXRoaXMuZGF0YS5nZXRDb250ZXh0KCk7Y29udGV4dFsnZGVmYXVsdF8nK3RoaXMuZ3JvdXBlZEJ5XT12aWV3VXRpbHMuZ2V0R3JvdXBWYWx1ZSh0aGlzLmRhdGEsdGhpcy5ncm91cGVkQnkpO3RoaXMucXVpY2tDcmVhdGVXaWRnZXQ9bmV3IFJlY29yZFF1aWNrQ3JlYXRlKHRoaXMse2NvbnRleHQ6Y29udGV4dCxmb3JtVmlld1JlZjp0aGlzLnF1aWNrQ3JlYXRlVmlldyxtb2RlbDp0aGlzLm1vZGVsTmFtZSx9KTtyZXR1cm4gdGhpcy5xdWlja0NyZWF0ZVdpZGdldC5pbnNlcnRBZnRlcih0aGlzLiRoZWFkZXIpO30sY2FuY2VsUXVpY2tDcmVhdGU6ZnVuY3Rpb24oKXtpZih0aGlzLnF1aWNrQ3JlYXRlV2lkZ2V0KXt0aGlzLnF1aWNrQ3JlYXRlV2lkZ2V0LmNhbmNlbCgpO319LGlzRW1wdHk6ZnVuY3Rpb24oKXtyZXR1cm4hdGhpcy5yZWNvcmRzLmxlbmd0aDt9LF9hZGRSZWNvcmQ6ZnVuY3Rpb24ocmVjb3JkU3RhdGUsb3B0aW9ucyl7dmFyIHJlY29yZD1uZXcgdGhpcy5LYW5iYW5SZWNvcmQodGhpcyxyZWNvcmRTdGF0ZSx0aGlzLnJlY29yZF9vcHRpb25zKTt0aGlzLnJlY29yZHMucHVzaChyZWNvcmQpO2lmKG9wdGlvbnMmJm9wdGlvbnMucG9zaXRpb249PT0nYmVmb3JlJyl7cmV0dXJuIHJlY29yZC5pbnNlcnRBZnRlcih0aGlzLnF1aWNrQ3JlYXRlV2lkZ2V0P3RoaXMucXVpY2tDcmVhdGVXaWRnZXQuJGVsOnRoaXMuJGhlYWRlcik7fWVsc2V7dmFyICRsb2FkX21vcmU9dGhpcy4kKCcub19rYW5iYW5fbG9hZF9tb3JlJyk7aWYoJGxvYWRfbW9yZS5sZW5ndGgpe3JldHVybiByZWNvcmQuaW5zZXJ0QmVmb3JlKCRsb2FkX21vcmUpO31lbHNle3JldHVybiByZWNvcmQuYXBwZW5kVG8odGhpcy4kZWwpO319fSxfY2FuY2VsUXVpY2tDcmVhdGU6ZnVuY3Rpb24oKXt0aGlzLnF1aWNrQ3JlYXRlV2lkZ2V0LmRlc3Ryb3koKTt0aGlzLnF1aWNrQ3JlYXRlV2lkZ2V0PXVuZGVmaW5lZDt9LF9nZXRJRHM6ZnVuY3Rpb24oKXt2YXIgaWRzPVtdO3RoaXMuJCgnLm9fa2FuYmFuX3JlY29yZCcpLmVhY2goZnVuY3Rpb24oaW5kZXgscil7aWRzLnB1c2goJChyKS5kYXRhKCdyZWNvcmQnKS5pZCk7fSk7cmV0dXJuIGlkczt9LF9vbkFkZFF1aWNrQ3JlYXRlOmZ1bmN0aW9uKCl7dGhpcy5hZGRRdWlja0NyZWF0ZSgpO30sX29uQ2FuY2VsUXVpY2tDcmVhdGU6ZnVuY3Rpb24oKXt0aGlzLl9jYW5jZWxRdWlja0NyZWF0ZSgpO30sX29uRGVsZXRlQ29sdW1uOmZ1bmN0aW9uKGV2ZW50KXtldmVudC5wcmV2ZW50RGVmYXVsdCgpO3ZhciBidXR0b25zPVt7dGV4dDpfdCgiT2siKSxjbGFzc2VzOididG4tcHJpbWFyeScsY2xvc2U6dHJ1ZSxjbGljazp0aGlzLnRyaWdnZXJfdXAuYmluZCh0aGlzLCdrYW5iYW5fY29sdW1uX2RlbGV0ZScpLH0se3RleHQ6X3QoIkNhbmNlbCIpLGNsb3NlOnRydWV9XTtuZXcgRGlhbG9nKHRoaXMse3NpemU6J21lZGl1bScsYnV0dG9uczpidXR0b25zLCRjb250ZW50OiQoJzxkaXY+Jyx7dGV4dDpfdCgiQXJlIHlvdSBzdXJlIHRoYXQgeW91IHdhbnQgdG8gcmVtb3ZlIHRoaXMgY29sdW1uID8iKX0pLH0pLm9wZW4oKTt9LF9vbkVkaXRDb2x1bW46ZnVuY3Rpb24oZXZlbnQpe2V2ZW50LnByZXZlbnREZWZhdWx0KCk7bmV3IHZpZXdfZGlhbG9ncy5Gb3JtVmlld0RpYWxvZyh0aGlzLHtyZXNfbW9kZWw6dGhpcy5yZWxhdGlvbixyZXNfaWQ6dGhpcy5pZCx0aXRsZTpfdCgiRWRpdCBDb2x1bW4iKSxvbl9zYXZlZDp0aGlzLnRyaWdnZXJfdXAuYmluZCh0aGlzLCdyZWxvYWQnKSx9KS5vcGVuKCk7fSxfb25Mb2FkTW9yZTpmdW5jdGlvbihldmVudCl7ZXZlbnQucHJldmVudERlZmF1bHQoKTt0aGlzLnRyaWdnZXJfdXAoJ2thbmJhbl9sb2FkX21vcmUnKTt9LF9vblF1aWNrQ3JlYXRlQWRkUmVjb3JkOmZ1bmN0aW9uKGV2ZW50KXt0aGlzLnRyaWdnZXJfdXAoJ3F1aWNrX2NyZWF0ZV9yZWNvcmQnLGV2ZW50LmRhdGEpO30sX29uVG9nZ2xlRm9sZDpmdW5jdGlvbihldmVudCl7ZXZlbnQucHJldmVudERlZmF1bHQoKTt0aGlzLnRyaWdnZXJfdXAoJ2NvbHVtbl90b2dnbGVfZm9sZCcpO30sX29uVHdlYWtDb2x1bW46ZnVuY3Rpb24oZXYpe2V2LmRhdGEuY2FsbGJhY2sodGhpcy4kZWwpO30sX29uVHdlYWtDb2x1bW5SZWNvcmRzOmZ1bmN0aW9uKGV2KXtfLmVhY2godGhpcy5yZWNvcmRzLGZ1bmN0aW9uKHJlY29yZCl7ZXYuZGF0YS5jYWxsYmFjayhyZWNvcmQuJGVsLHJlY29yZC5zdGF0ZS5kYXRhKTt9KTt9LF9vbkFyY2hpdmVSZWNvcmRzOmZ1bmN0aW9uKGV2ZW50KXtldmVudC5wcmV2ZW50RGVmYXVsdCgpO0RpYWxvZy5jb25maXJtKHRoaXMsX3QoIkFyZSB5b3Ugc3VyZSB0aGF0IHlvdSB3YW50IHRvIGFyY2hpdmUgYWxsIHRoZSByZWNvcmRzIGZyb20gdGhpcyBjb2x1bW4/Iikse2NvbmZpcm1fY2FsbGJhY2s6dGhpcy50cmlnZ2VyX3VwLmJpbmQodGhpcywna2FuYmFuX2NvbHVtbl9yZWNvcmRzX3RvZ2dsZV9hY3RpdmUnLHthcmNoaXZlOnRydWUsfSksfSk7fSxfb25VbmFyY2hpdmVSZWNvcmRzOmZ1bmN0aW9uKGV2ZW50KXtldmVudC5wcmV2ZW50RGVmYXVsdCgpO3RoaXMudHJpZ2dlcl91cCgna2FuYmFuX2NvbHVtbl9yZWNvcmRzX3RvZ2dsZV9hY3RpdmUnLHthcmNoaXZlOmZhbHNlLH0pO319KTtyZXR1cm4gS2FuYmFuQ29sdW1uO30pOzsKCi8qIC93ZWIvc3RhdGljL3NyYy9qcy92aWV3cy9rYW5iYW4va2FuYmFuX2NvbHVtbl9wcm9ncmVzc2Jhci5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwpvZG9vLmRlZmluZSgnd2ViLkthbmJhbkNvbHVtblByb2dyZXNzQmFyJyxmdW5jdGlvbihyZXF1aXJlKXsndXNlIHN0cmljdCc7Y29uc3QgY29yZT1yZXF1aXJlKCd3ZWIuY29yZScpO3ZhciBzZXNzaW9uPXJlcXVpcmUoJ3dlYi5zZXNzaW9uJyk7dmFyIHV0aWxzPXJlcXVpcmUoJ3dlYi51dGlscycpO3ZhciBXaWRnZXQ9cmVxdWlyZSgnd2ViLldpZGdldCcpO2NvbnN0IF90PWNvcmUuX3Q7dmFyIEthbmJhbkNvbHVtblByb2dyZXNzQmFyPVdpZGdldC5leHRlbmQoe3RlbXBsYXRlOidLYW5iYW5WaWV3LkNvbHVtblByb2dyZXNzQmFyJyxldmVudHM6eydjbGljayAub19rYW5iYW5fY291bnRlcl9wcm9ncmVzcyc6J19vblByb2dyZXNzQmFyUGFyZW50Q2xpY2snLCdjbGljayAucHJvZ3Jlc3MtYmFyJzonX29uUHJvZ3Jlc3NCYXJDbGljaycsfSxBTklNQVRFOnRydWUsaW5pdDpmdW5jdGlvbihwYXJlbnQsb3B0aW9ucyxjb2x1bW5TdGF0ZSl7dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3RoaXMuY29sdW1uSUQ9b3B0aW9ucy5jb2x1bW5JRDt0aGlzLmNvbHVtblN0YXRlPWNvbHVtblN0YXRlO3RoaXMuZmllbGROYW1lPWNvbHVtblN0YXRlLnByb2dyZXNzQmFyVmFsdWVzLmZpZWxkO3RoaXMuY29sb3JzPV8uZXh0ZW5kKHt9LGNvbHVtblN0YXRlLnByb2dyZXNzQmFyVmFsdWVzLmNvbG9ycyx7X19mYWxzZTonbXV0ZWQnLH0pO3RoaXMuc3VtRmllbGQ9Y29sdW1uU3RhdGUucHJvZ3Jlc3NCYXJWYWx1ZXMuc3VtX2ZpZWxkO3ZhciBzdGF0ZT1vcHRpb25zLnByb2dyZXNzQmFyU3RhdGVzW3RoaXMuY29sdW1uSURdO2lmKHN0YXRlKXt0aGlzLmdyb3VwQ291bnQ9c3RhdGUuZ3JvdXBDb3VudDt0aGlzLnN1Ymdyb3VwQ291bnRzPXN0YXRlLnN1Ymdyb3VwQ291bnRzO3RoaXMudG90YWxDb3VudGVyVmFsdWU9c3RhdGUudG90YWxDb3VudGVyVmFsdWU7dGhpcy5hY3RpdmVGaWx0ZXI9c3RhdGUuYWN0aXZlRmlsdGVyO30KdmFyIHN1bUZpZWxkSW5mbz10aGlzLnN1bUZpZWxkJiZjb2x1bW5TdGF0ZS5maWVsZHNJbmZvLmthbmJhblt0aGlzLnN1bUZpZWxkXTt2YXIgY3VycmVuY3lGaWVsZD1zdW1GaWVsZEluZm8mJnN1bUZpZWxkSW5mby5vcHRpb25zJiZzdW1GaWVsZEluZm8ub3B0aW9ucy5jdXJyZW5jeV9maWVsZDtpZihjdXJyZW5jeUZpZWxkJiZjb2x1bW5TdGF0ZS5kYXRhLmxlbmd0aCl7dGhpcy5jdXJyZW5jeT1zZXNzaW9uLmN1cnJlbmNpZXNbY29sdW1uU3RhdGUuZGF0YVswXS5kYXRhW2N1cnJlbmN5RmllbGRdLnJlc19pZF07fX0sc3RhcnQ6ZnVuY3Rpb24oKXt2YXIgc2VsZj10aGlzO3RoaXMuJGJhcnM9e307Xy5lYWNoKHRoaXMuY29sb3JzLGZ1bmN0aW9uKHZhbCxrZXkpe3NlbGYuJGJhcnNba2V5XT1zZWxmLiQoYC5wcm9ncmVzcy1iYXJbZGF0YS1maWx0ZXI9JHtrZXl9XWApO30pO3RoaXMuJGNvdW50ZXI9dGhpcy4kKCcub19rYW5iYW5fY291bnRlcl9zaWRlJyk7dGhpcy4kbnVtYmVyPXRoaXMuJGNvdW50ZXIuZmluZCgnYicpO2lmKHRoaXMuY3VycmVuY3kpe3ZhciAkY3VycmVuY3k9JCgnPHNwYW4vPicse3RleHQ6dGhpcy5jdXJyZW5jeS5zeW1ib2wsfSk7aWYodGhpcy5jdXJyZW5jeS5wb3NpdGlvbj09PSdiZWZvcmUnKXskY3VycmVuY3kucHJlcGVuZFRvKHRoaXMuJGNvdW50ZXIpO31lbHNleyRjdXJyZW5jeS5hcHBlbmRUbyh0aGlzLiRjb3VudGVyKTt9fQpyZXR1cm4gdGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpLnRoZW4oZnVuY3Rpb24oKXt2YXIgc3ViZ3JvdXBDb3VudHM9e307bGV0IGFsbFN1Ymdyb3VwQ291bnQ9MDtfLmVhY2goc2VsZi5jb2xvcnMsZnVuY3Rpb24odmFsLGtleSl7dmFyIHN1Ymdyb3VwQ291bnQ9c2VsZi5jb2x1bW5TdGF0ZS5wcm9ncmVzc0JhclZhbHVlcy5jb3VudHNba2V5XXx8MDtpZihzZWxmLmFjdGl2ZUZpbHRlcj09PWtleSYmc3ViZ3JvdXBDb3VudD09PTApe3NlbGYuYWN0aXZlRmlsdGVyPWZhbHNlO30Kc3ViZ3JvdXBDb3VudHNba2V5XT1zdWJncm91cENvdW50O2FsbFN1Ymdyb3VwQ291bnQrPXN1Ymdyb3VwQ291bnQ7fSk7c3ViZ3JvdXBDb3VudHMuX19mYWxzZT1zZWxmLmNvbHVtblN0YXRlLmNvdW50LWFsbFN1Ymdyb3VwQ291bnQ7c2VsZi5ncm91cENvdW50PXNlbGYuY29sdW1uU3RhdGUuY291bnQ7c2VsZi5zdWJncm91cENvdW50cz1zdWJncm91cENvdW50cztzZWxmLnByZXZUb3RhbENvdW50ZXJWYWx1ZT1zZWxmLnRvdGFsQ291bnRlclZhbHVlO3NlbGYudG90YWxDb3VudGVyVmFsdWU9c2VsZi5zdW1GaWVsZD8oc2VsZi5jb2x1bW5TdGF0ZS5hZ2dyZWdhdGVWYWx1ZXNbc2VsZi5zdW1GaWVsZF18fDApOnNlbGYuY29sdW1uU3RhdGUuY291bnQ7c2VsZi5fbm90aWZ5U3RhdGUoKTtzZWxmLl9yZW5kZXIoKTt9KTt9LF9yZW5kZXI6ZnVuY3Rpb24oKXt2YXIgc2VsZj10aGlzO3RoaXMudHJpZ2dlcl91cCgndHdlYWtfY29sdW1uJyx7Y2FsbGJhY2s6ZnVuY3Rpb24oJGVsKXskZWwucmVtb3ZlQ2xhc3MoJ29fa2FuYmFuX2dyb3VwX3Nob3cnKTtfLmVhY2goc2VsZi5jb2xvcnMsZnVuY3Rpb24odmFsLGtleSl7JGVsLnJlbW92ZUNsYXNzKCdvX2thbmJhbl9ncm91cF9zaG93XycrdmFsKTt9KTtpZihzZWxmLmFjdGl2ZUZpbHRlcil7JGVsLmFkZENsYXNzKCdvX2thbmJhbl9ncm91cF9zaG93IG9fa2FuYmFuX2dyb3VwX3Nob3dfJytzZWxmLmNvbG9yc1tzZWxmLmFjdGl2ZUZpbHRlcl0pO319LH0pO3RoaXMudHJpZ2dlcl91cCgndHdlYWtfY29sdW1uX3JlY29yZHMnLHtjYWxsYmFjazpmdW5jdGlvbigkZWwscmVjb3JkRGF0YSl7dmFyIGNhdGVnb3J5VmFsdWU9cmVjb3JkRGF0YVtzZWxmLmZpZWxkTmFtZV0/cmVjb3JkRGF0YVtzZWxmLmZpZWxkTmFtZV06J19fZmFsc2UnO18uZWFjaChzZWxmLmNvbG9ycyxmdW5jdGlvbih2YWwsa2V5KXskZWwucmVtb3ZlQ2xhc3MoJ29lX2thbmJhbl9jYXJkXycrdmFsKTt9KTtpZihzZWxmLmNvbG9yc1tjYXRlZ29yeVZhbHVlXSl7JGVsLmFkZENsYXNzKCdvZV9rYW5iYW5fY2FyZF8nK3NlbGYuY29sb3JzW2NhdGVnb3J5VmFsdWVdKTt9fSx9KTt2YXIgYmFyTnVtYmVyPTA7dmFyIGJhck1pbldpZHRoPTY7Y29uc3Qgc2VsZWN0aW9uPXNlbGYuY29sdW1uU3RhdGUuZmllbGRzW3NlbGYuZmllbGROYW1lXS5zZWxlY3Rpb247Xy5lYWNoKHNlbGYuY29sb3JzLGZ1bmN0aW9uKHZhbCxrZXkpe3ZhciAkYmFyPXNlbGYuJGJhcnNba2V5XTt2YXIgY291bnQ9c2VsZi5zdWJncm91cENvdW50cyYmc2VsZi5zdWJncm91cENvdW50c1trZXldfHwwO2lmKCEkYmFyKXtyZXR1cm47fQpsZXQgdmFsdWU7aWYoc2VsZWN0aW9uKXtjb25zdCBvcHRpb249c2VsZWN0aW9uLmZpbmQob3B0aW9uPT5vcHRpb25bMF09PT1rZXkpO3ZhbHVlPW9wdGlvbiYmb3B0aW9uWzFdfHxfdCgnT3RoZXInKTt9ZWxzZXt2YWx1ZT1rZXk7fQokYmFyLmF0dHIoJ2RhdGEtb3JpZ2luYWwtdGl0bGUnLGNvdW50KycgJyt2YWx1ZSk7JGJhci50b29sdGlwKHtkZWxheTowLHRyaWdnZXI6J2hvdmVyJyx9KTskYmFyLnRvZ2dsZUNsYXNzKCdwcm9ncmVzcy1iYXItYW5pbWF0ZWQgcHJvZ3Jlc3MtYmFyLXN0cmlwZWQnLGtleT09PXNlbGYuYWN0aXZlRmlsdGVyKTskYmFyLnJlbW92ZUNsYXNzKCdvX2Jhcl9oYXNfcmVjb3JkcyB0cmFuc2l0aW9uLW9mZicpO3dpbmRvdy5nZXRDb21wdXRlZFN0eWxlKCRiYXJbMF0pLmdldFByb3BlcnR5VmFsdWUoJ3dpZHRoJyk7aWYoY291bnQ+MCl7JGJhci5hZGRDbGFzcygnb19iYXJfaGFzX3JlY29yZHMnKTt2YXIgbWF4V2lkdGg9MTAwLWJhck1pbldpZHRoKmJhck51bWJlcjtzZWxmLiQoJy5wcm9ncmVzcy1iYXIub19iYXJfaGFzX3JlY29yZHMnKS5jc3MoJ21heC13aWR0aCcsbWF4V2lkdGgrJyUnKTskYmFyLmNzcygnd2lkdGgnLChjb3VudCoxMDAvc2VsZi5ncm91cENvdW50KSsnJScpO2Jhck51bWJlcisrOyRiYXIuYXR0cignYXJpYS12YWx1ZW1pbicsMCk7JGJhci5hdHRyKCdhcmlhLXZhbHVlbWF4JyxzZWxmLmdyb3VwQ291bnQpOyRiYXIuYXR0cignYXJpYS12YWx1ZW5vdycsY291bnQpO31lbHNleyRiYXIuY3NzKCd3aWR0aCcsJycpO319KTt0aGlzLiQoJy5wcm9ncmVzcy1iYXIub19iYXJfaGFzX3JlY29yZHMnKS5jc3MoJ21pbi13aWR0aCcsYmFyTWluV2lkdGgrJyUnKTt2YXIgc3RhcnQ9dGhpcy5wcmV2VG90YWxDb3VudGVyVmFsdWU7dmFyIGVuZD10aGlzLnRvdGFsQ291bnRlclZhbHVlO2lmKHRoaXMuYWN0aXZlRmlsdGVyKXtpZih0aGlzLnN1bUZpZWxkKXtlbmQ9MDtfLmVhY2goc2VsZi5jb2x1bW5TdGF0ZS5kYXRhLGZ1bmN0aW9uKHJlY29yZCl7dmFyIHJlY29yZERhdGE9cmVjb3JkLmRhdGE7aWYoc2VsZi5hY3RpdmVGaWx0ZXI9PT1yZWNvcmREYXRhW3NlbGYuZmllbGROYW1lXXx8KHNlbGYuYWN0aXZlRmlsdGVyPT09J19fZmFsc2UnJiYhcmVjb3JkRGF0YVtzZWxmLmZpZWxkTmFtZV0pKXtlbmQrPXBhcnNlRmxvYXQocmVjb3JkRGF0YVtzZWxmLnN1bUZpZWxkXSk7fX0pO31lbHNle2VuZD10aGlzLnN1Ymdyb3VwQ291bnRzW3RoaXMuYWN0aXZlRmlsdGVyXTt9fQp0aGlzLnByZXZUb3RhbENvdW50ZXJWYWx1ZT1lbmQ7dmFyIGFuaW1hdGlvbkNsYXNzPXN0YXJ0Pjk5OT8nb19rYW5iYW5fZ3Jvdyc6J29fa2FuYmFuX2dyb3dfaHVnZSc7aWYoc3RhcnQhPT11bmRlZmluZWQmJihlbmQ+c3RhcnR8fHRoaXMuYWN0aXZlRmlsdGVyKSYmdGhpcy5BTklNQVRFKXskKHtjdXJyZW50VmFsdWU6c3RhcnR9KS5hbmltYXRlKHtjdXJyZW50VmFsdWU6ZW5kfSx7ZHVyYXRpb246MTAwMCxzdGFydDpmdW5jdGlvbigpe3NlbGYuJGNvdW50ZXIuYWRkQ2xhc3MoYW5pbWF0aW9uQ2xhc3MpO30sc3RlcDpmdW5jdGlvbigpe3NlbGYuJG51bWJlci5odG1sKF9nZXRDb3VudGVySFRNTCh0aGlzLmN1cnJlbnRWYWx1ZSkpO30sY29tcGxldGU6ZnVuY3Rpb24oKXtzZWxmLiRudW1iZXIuaHRtbChfZ2V0Q291bnRlckhUTUwodGhpcy5jdXJyZW50VmFsdWUpKTtzZWxmLiRjb3VudGVyLnJlbW92ZUNsYXNzKGFuaW1hdGlvbkNsYXNzKTt9LH0pO31lbHNle3RoaXMuJG51bWJlci5odG1sKF9nZXRDb3VudGVySFRNTChlbmQpKTt9CmZ1bmN0aW9uIF9nZXRDb3VudGVySFRNTCh2YWx1ZSl7cmV0dXJuIHV0aWxzLmh1bWFuX251bWJlcih2YWx1ZSwwLDMpO319LF9ub3RpZnlTdGF0ZTpmdW5jdGlvbigpe3RoaXMudHJpZ2dlcl91cCgnc2V0X3Byb2dyZXNzX2Jhcl9zdGF0ZScse2NvbHVtbklEOnRoaXMuY29sdW1uSUQsdmFsdWVzOntncm91cENvdW50OnRoaXMuZ3JvdXBDb3VudCxzdWJncm91cENvdW50czp0aGlzLnN1Ymdyb3VwQ291bnRzLHRvdGFsQ291bnRlclZhbHVlOnRoaXMudG90YWxDb3VudGVyVmFsdWUsYWN0aXZlRmlsdGVyOnRoaXMuYWN0aXZlRmlsdGVyLH0sfSk7fSxfb25Qcm9ncmVzc0JhckNsaWNrOmZ1bmN0aW9uKGV2KXt0aGlzLiRjbGlja2VkQmFyPSQoZXYuY3VycmVudFRhcmdldCk7dmFyIGZpbHRlcj10aGlzLiRjbGlja2VkQmFyLmRhdGEoJ2ZpbHRlcicpO3RoaXMuYWN0aXZlRmlsdGVyPSh0aGlzLmFjdGl2ZUZpbHRlcj09PWZpbHRlcj9mYWxzZTpmaWx0ZXIpO3RoaXMuX25vdGlmeVN0YXRlKCk7dGhpcy5fcmVuZGVyKCk7fSxfb25Qcm9ncmVzc0JhclBhcmVudENsaWNrOmZ1bmN0aW9uKGV2KXtpZihldi50YXJnZXQhPT1ldi5jdXJyZW50VGFyZ2V0KXtyZXR1cm47fQp0aGlzLmFjdGl2ZUZpbHRlcj1mYWxzZTt0aGlzLl9ub3RpZnlTdGF0ZSgpO3RoaXMuX3JlbmRlcigpO30sfSk7cmV0dXJuIEthbmJhbkNvbHVtblByb2dyZXNzQmFyO30pOzsKCi8qIC93ZWIvc3RhdGljL3NyYy9qcy92aWV3cy9rYW5iYW4va2FuYmFuX2NvbHVtbl9xdWlja19jcmVhdGUuanMgZGVmaW5lZCBpbiBidW5kbGUgJ3dlYi5hc3NldHNfYmFja2VuZCcgKi8Kb2Rvby5kZWZpbmUoJ3dlYi5rYW5iYW5fY29sdW1uX3F1aWNrX2NyZWF0ZScsZnVuY3Rpb24ocmVxdWlyZSl7InVzZSBzdHJpY3QiO3ZhciBjb3JlPXJlcXVpcmUoJ3dlYi5jb3JlJyk7dmFyIERpYWxvZz1yZXF1aXJlKCd3ZWIuRGlhbG9nJyk7dmFyIFdpZGdldD1yZXF1aXJlKCd3ZWIuV2lkZ2V0Jyk7dmFyIF90PWNvcmUuX3Q7dmFyIFFXZWI9Y29yZS5xd2ViO3ZhciBDb2x1bW5RdWlja0NyZWF0ZT1XaWRnZXQuZXh0ZW5kKHt0ZW1wbGF0ZTonS2FuYmFuVmlldy5Db2x1bW5RdWlja0NyZWF0ZScsZXZlbnRzOnsnY2xpY2sgLm9fcXVpY2tfY3JlYXRlX2ZvbGRlZCc6J19vblVuZm9sZCcsJ2NsaWNrIC5vX2thbmJhbl9hZGQnOidfb25BZGRDbGlja2VkJywnY2xpY2sgLm9fa2FuYmFuX2V4YW1wbGVzJzonX29uU2hvd0V4YW1wbGVzJywna2V5ZG93bic6J19vbktleWRvd24nLCdrZXlwcmVzcyBpbnB1dCc6J19vbktleXByZXNzJywnYmx1ciBpbnB1dCc6J19vbklucHV0Qmx1cicsJ2ZvY3VzIGlucHV0JzonX29uSW5wdXRGb2N1cycsfSxpbml0OmZ1bmN0aW9uKHBhcmVudCxvcHRpb25zKXt0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy5leGFtcGxlcz1vcHRpb25zLmV4YW1wbGVzO3RoaXMuZm9sZGVkPXRydWU7fSxzdGFydDpmdW5jdGlvbigpe3RoaXMuJHF1aWNrQ3JlYXRlRm9sZGVkPXRoaXMuJCgnLm9fcXVpY2tfY3JlYXRlX2ZvbGRlZCcpO3RoaXMuJHF1aWNrQ3JlYXRlVW5mb2xkZWQ9dGhpcy4kKCcub19xdWlja19jcmVhdGVfdW5mb2xkZWQnKTt0aGlzLiRpbnB1dD10aGlzLiQoJ2lucHV0Jyk7Y29yZS5idXMub24oJ2NsaWNrJyx0aGlzLHRoaXMuX29uV2luZG93Q2xpY2tlZCk7dGhpcy5fdXBkYXRlKCk7cmV0dXJuIHRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9LG9uX2F0dGFjaF9jYWxsYmFjazpmdW5jdGlvbigpe2lmKCF0aGlzLmZvbGRlZCl7dGhpcy4kaW5wdXQuZm9jdXMoKTt9fSx0b2dnbGVGb2xkOmZ1bmN0aW9uKCl7dGhpcy5mb2xkZWQ9IXRoaXMuZm9sZGVkO3RoaXMuX3VwZGF0ZSgpO2lmKCF0aGlzLmZvbGRlZCl7dGhpcy4kaW5wdXQuZm9jdXMoKTt0aGlzLnRyaWdnZXJfdXAoJ3Njcm9sbFRvJyx7c2VsZWN0b3I6Jy5vX2NvbHVtbl9xdWlja19jcmVhdGUnfSk7fX0sX2FkZDpmdW5jdGlvbigpe3ZhciB2YWx1ZT10aGlzLiRpbnB1dC52YWwoKS50cmltKCk7aWYoIXZhbHVlLmxlbmd0aCl7dGhpcy5fY2FuY2VsKCk7cmV0dXJuO30KdGhpcy4kaW5wdXQudmFsKCcnKTt0aGlzLnRyaWdnZXJfdXAoJ3F1aWNrX2NyZWF0ZV9hZGRfY29sdW1uJyx7dmFsdWU6dmFsdWV9KTt0aGlzLiRpbnB1dC5mb2N1cygpO30sX2NhbmNlbDpmdW5jdGlvbigpe2lmKCF0aGlzLmZvbGRlZCl7dGhpcy5mb2xkZWQ9dHJ1ZTt0aGlzLiRpbnB1dC52YWwoJycpO3RoaXMuX3VwZGF0ZSgpO319LF91cGRhdGU6ZnVuY3Rpb24oKXt0aGlzLiRxdWlja0NyZWF0ZUZvbGRlZC50b2dnbGUodGhpcy5mb2xkZWQpO3RoaXMuJHF1aWNrQ3JlYXRlVW5mb2xkZWQudG9nZ2xlKCF0aGlzLmZvbGRlZCk7dGhpcy50cmlnZ2VyX3VwKCdxdWlja19jcmVhdGVfY29sdW1uX3VwZGF0ZWQnKTt9LF9vbkFkZENsaWNrZWQ6ZnVuY3Rpb24oZXZlbnQpe2V2ZW50LnN0b3BQcm9wYWdhdGlvbigpO3RoaXMuX2FkZCgpO30sX29uSW5wdXRCbHVyOmZ1bmN0aW9uKCl7dGhpcy4kKCcub19kaXNjYXJkX21zZycpLmhpZGUoKTt9LF9vbklucHV0Rm9jdXM6ZnVuY3Rpb24oKXt0aGlzLiQoJy5vX2Rpc2NhcmRfbXNnJykuc2hvdygpO30sX29uS2V5ZG93bjpmdW5jdGlvbihldmVudCl7aWYoZXZlbnQua2V5Q29kZT09PSQudWkua2V5Q29kZS5FU0NBUEUpe3RoaXMuX2NhbmNlbCgpO319LF9vbktleXByZXNzOmZ1bmN0aW9uKGV2ZW50KXtpZihldmVudC5rZXlDb2RlPT09JC51aS5rZXlDb2RlLkVOVEVSKXt0aGlzLl9hZGQoKTt9fSxfb25TaG93RXhhbXBsZXM6ZnVuY3Rpb24oKXt2YXIgc2VsZj10aGlzO3ZhciBkaWFsb2c9bmV3IERpYWxvZyh0aGlzLHskY29udGVudDokKFFXZWIucmVuZGVyKCdLYW5iYW5WaWV3LkV4YW1wbGVzRGlhbG9nJyx7ZXhhbXBsZXM6dGhpcy5leGFtcGxlcyx9KSksYnV0dG9uczpbe2NsYXNzZXM6J2J0bi1wcmltYXJ5IGZsb2F0LXJpZ2h0JyxjbG9zZTp0cnVlLHRleHQ6X3QoJ0dvdCBpdCcpLH1dLHNpemU6ImxhcmdlIix0aXRsZToiS2FuYmFuIEV4YW1wbGVzIix9KS5vcGVuKCk7ZGlhbG9nLm9uKCdjbG9zZWQnLHRoaXMsZnVuY3Rpb24oKXtzZWxmLiRpbnB1dC5mb2N1cygpO30pO30sX29uVW5mb2xkOmZ1bmN0aW9uKCl7aWYodGhpcy5mb2xkZWQpe3RoaXMudG9nZ2xlRm9sZCgpO319LF9vbldpbmRvd0NsaWNrZWQ6ZnVuY3Rpb24oZXZlbnQpe2lmKCFkb2N1bWVudC5jb250YWlucyh0aGlzLmVsKSl7cmV0dXJuO30KaWYoJChldmVudC50YXJnZXQpLmNsb3Nlc3QoJy5tb2RhbCcpLmxlbmd0aCl7cmV0dXJuO30KaWYodGhpcy5lbC5jb250YWlucyhldmVudC50YXJnZXQpKXtyZXR1cm47fQp0aGlzLl9jYW5jZWwoKTt9LH0pO3JldHVybiBDb2x1bW5RdWlja0NyZWF0ZTt9KTs7CgovKiAvd2ViL3N0YXRpYy9zcmMvanMvdmlld3Mva2FuYmFuL2thbmJhbl9tb2RlbC5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwpvZG9vLmRlZmluZSgnd2ViLkthbmJhbk1vZGVsJyxmdW5jdGlvbihyZXF1aXJlKXsidXNlIHN0cmljdCI7dmFyIEJhc2ljTW9kZWw9cmVxdWlyZSgnd2ViLkJhc2ljTW9kZWwnKTt2YXIgdmlld1V0aWxzPXJlcXVpcmUoJ3dlYi52aWV3VXRpbHMnKTt2YXIgS2FuYmFuTW9kZWw9QmFzaWNNb2RlbC5leHRlbmQoe2FkZFJlY29yZFRvR3JvdXA6ZnVuY3Rpb24oZ3JvdXBJRCxyZXNJZCl7dmFyIHNlbGY9dGhpczt2YXIgZ3JvdXA9dGhpcy5sb2NhbERhdGFbZ3JvdXBJRF07dmFyIG5ld19yZWNvcmQ9dGhpcy5fbWFrZURhdGFQb2ludCh7cmVzX2lkOnJlc0lkLG1vZGVsTmFtZTpncm91cC5tb2RlbCxmaWVsZHM6Z3JvdXAuZmllbGRzLGZpZWxkc0luZm86Z3JvdXAuZmllbGRzSW5mbyx2aWV3VHlwZTpncm91cC52aWV3VHlwZSxwYXJlbnRJRDpncm91cElELH0pO3ZhciBkZWY9dGhpcy5fZmV0Y2hSZWNvcmQobmV3X3JlY29yZCkudGhlbihmdW5jdGlvbihyZXN1bHQpe2dyb3VwLmRhdGEudW5zaGlmdChuZXdfcmVjb3JkLmlkKTtncm91cC5yZXNfaWRzLnVuc2hpZnQocmVzSWQpO2dyb3VwLmNvdW50Kys7c2VsZi5sb2NhbERhdGFbZ3JvdXAucGFyZW50SURdLmNvdW50Kys7c2VsZi5fdXBkYXRlUGFyZW50UmVzSURzKGdyb3VwKTtyZXR1cm4gcmVzdWx0LmlkO30pO3JldHVybiB0aGlzLl9yZWxvYWRQcm9ncmVzc0Jhckdyb3VwRnJvbVJlY29yZChuZXdfcmVjb3JkLmlkLGRlZik7fSxjcmVhdGVHcm91cDpmdW5jdGlvbihuYW1lLHBhcmVudElEKXt2YXIgc2VsZj10aGlzO3ZhciBwYXJlbnQ9dGhpcy5sb2NhbERhdGFbcGFyZW50SURdO3ZhciBncm91cEJ5PXBhcmVudC5ncm91cGVkQnlbMF07dmFyIGdyb3VwQnlGaWVsZD1wYXJlbnQuZmllbGRzW2dyb3VwQnldO2lmKCFncm91cEJ5RmllbGR8fGdyb3VwQnlGaWVsZC50eXBlIT09J21hbnkyb25lJyl7cmV0dXJuIFByb21pc2UucmVqZWN0KCk7fQpyZXR1cm4gdGhpcy5fcnBjKHttb2RlbDpncm91cEJ5RmllbGQucmVsYXRpb24sbWV0aG9kOiduYW1lX2NyZWF0ZScsYXJnczpbbmFtZV0sY29udGV4dDpwYXJlbnQuY29udGV4dCx9KS50aGVuKGZ1bmN0aW9uKHJlc3VsdCl7dmFyIG5ld0dyb3VwPXNlbGYuX21ha2VEYXRhUG9pbnQoe21vZGVsTmFtZTpwYXJlbnQubW9kZWwsY29udGV4dDpwYXJlbnQuY29udGV4dCxkb21haW46cGFyZW50LmRvbWFpbi5jb25jYXQoW1tncm91cEJ5LCI9IixyZXN1bHRbMF1dXSksZmllbGRzOnBhcmVudC5maWVsZHMsZmllbGRzSW5mbzpwYXJlbnQuZmllbGRzSW5mbyxpc09wZW46dHJ1ZSxsaW1pdDpwYXJlbnQubGltaXQscGFyZW50SUQ6cGFyZW50LmlkLG9wZW5Hcm91cEJ5RGVmYXVsdDp0cnVlLG9yZGVyZWRCeTpwYXJlbnQub3JkZXJlZEJ5LHZhbHVlOnJlc3VsdCx2aWV3VHlwZTpwYXJlbnQudmlld1R5cGUsfSk7aWYocGFyZW50LnByb2dyZXNzQmFyKXtuZXdHcm91cC5wcm9ncmVzc0JhclZhbHVlcz1fLmV4dGVuZCh7Y291bnRzOnt9LH0scGFyZW50LnByb2dyZXNzQmFyKTt9CnBhcmVudC5kYXRhLnB1c2gobmV3R3JvdXAuaWQpO3JldHVybiBuZXdHcm91cC5pZDt9KTt9LGNyZWF0ZVJlY29yZEluR3JvdXA6ZnVuY3Rpb24oZ3JvdXBJRCx2YWx1ZXMpe3ZhciBzZWxmPXRoaXM7dmFyIGdyb3VwPXRoaXMubG9jYWxEYXRhW2dyb3VwSURdO3ZhciBjb250ZXh0PXRoaXMuX2dldENvbnRleHQoZ3JvdXApO3ZhciBwYXJlbnQ9dGhpcy5sb2NhbERhdGFbZ3JvdXAucGFyZW50SURdO3ZhciBncm91cGVkQnk9cGFyZW50Lmdyb3VwZWRCeTtjb250ZXh0WydkZWZhdWx0XycrZ3JvdXBlZEJ5XT12aWV3VXRpbHMuZ2V0R3JvdXBWYWx1ZShncm91cCxncm91cGVkQnkpO3ZhciBkZWY7aWYoT2JqZWN0LmtleXModmFsdWVzKS5sZW5ndGg9PT0xJiYnZGlzcGxheV9uYW1lJ2luIHZhbHVlcyl7ZGVmPXRoaXMuX3JwYyh7bW9kZWw6cGFyZW50Lm1vZGVsLG1ldGhvZDonbmFtZV9jcmVhdGUnLGFyZ3M6W3ZhbHVlcy5kaXNwbGF5X25hbWVdLGNvbnRleHQ6Y29udGV4dCx9KS50aGVuKGZ1bmN0aW9uKHJlY29yZHMpe3JldHVybiByZWNvcmRzWzBdO30pO31lbHNle2RlZj10aGlzLl9ycGMoe21vZGVsOnBhcmVudC5tb2RlbCxtZXRob2Q6J2NyZWF0ZScsYXJnczpbdmFsdWVzXSxjb250ZXh0OmNvbnRleHQsfSk7fQpyZXR1cm4gZGVmLnRoZW4oZnVuY3Rpb24ocmVzSUQpe3JldHVybiBzZWxmLmFkZFJlY29yZFRvR3JvdXAoZ3JvdXAuaWQscmVzSUQpO30pO30sZ2V0OmZ1bmN0aW9uKCl7dmFyIHJlc3VsdD10aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dmFyIGRwPXJlc3VsdCYmdGhpcy5sb2NhbERhdGFbcmVzdWx0LmlkXTtpZihkcCl7aWYoZHAudG9vbHRpcERhdGEpe3Jlc3VsdC50b29sdGlwRGF0YT0kLmV4dGVuZCh0cnVlLHt9LGRwLnRvb2x0aXBEYXRhKTt9CmlmKGRwLnByb2dyZXNzQmFyVmFsdWVzKXtyZXN1bHQucHJvZ3Jlc3NCYXJWYWx1ZXM9JC5leHRlbmQodHJ1ZSx7fSxkcC5wcm9ncmVzc0JhclZhbHVlcyk7fQppZihkcC5maWVsZHNbZHAuZ3JvdXBlZEJ5WzBdXSl7dmFyIGdyb3VwZWRCeU0yTz1kcC5maWVsZHNbZHAuZ3JvdXBlZEJ5WzBdXS50eXBlPT09J21hbnkyb25lJztyZXN1bHQuaXNHcm91cGVkQnlNMk9Ob0NvbHVtbj0hZHAuZGF0YS5sZW5ndGgmJmdyb3VwZWRCeU0yTzt9ZWxzZXtyZXN1bHQuaXNHcm91cGVkQnlNMk9Ob0NvbHVtbj1mYWxzZTt9fQpyZXR1cm4gcmVzdWx0O30sZ2V0Q29sdW1uOmZ1bmN0aW9uKGlkKXt2YXIgZWxlbWVudD10aGlzLmxvY2FsRGF0YVtpZF07aWYoZWxlbWVudCl7cmV0dXJuIHRoaXMuZ2V0KGVsZW1lbnQucGFyZW50SUQpO30KcmV0dXJuIG51bGw7fSxsb2FkOmZ1bmN0aW9uKHBhcmFtcyl7dGhpcy5kZWZhdWx0R3JvdXBlZEJ5PXBhcmFtcy5ncm91cEJ5O3BhcmFtcy5ncm91cGVkQnk9KHBhcmFtcy5ncm91cGVkQnkmJnBhcmFtcy5ncm91cGVkQnkubGVuZ3RoKT9wYXJhbXMuZ3JvdXBlZEJ5OnRoaXMuZGVmYXVsdEdyb3VwZWRCeTtyZXR1cm4gdGhpcy5fc3VwZXIocGFyYW1zKTt9LGxvYWRDb2x1bW5SZWNvcmRzOmZ1bmN0aW9uKGdyb3VwSUQpe3ZhciBkYXRhUG9pbnQ9dGhpcy5sb2NhbERhdGFbZ3JvdXBJRF07ZGF0YVBvaW50LmlzT3Blbj10cnVlO3JldHVybiB0aGlzLnJlbG9hZChncm91cElEKTt9LGxvYWRNb3JlOmZ1bmN0aW9uKGdyb3VwSUQpe3ZhciBncm91cD10aGlzLmxvY2FsRGF0YVtncm91cElEXTt2YXIgb2Zmc2V0PWdyb3VwLmxvYWRNb3JlT2Zmc2V0K2dyb3VwLmxpbWl0O3JldHVybiB0aGlzLnJlbG9hZChncm91cC5pZCx7bG9hZE1vcmVPZmZzZXQ6b2Zmc2V0LH0pO30sbW92ZVJlY29yZDpmdW5jdGlvbihyZWNvcmRJRCxncm91cElELHBhcmVudElEKXt2YXIgc2VsZj10aGlzO3ZhciBwYXJlbnQ9dGhpcy5sb2NhbERhdGFbcGFyZW50SURdO3ZhciBuZXdfZ3JvdXA9dGhpcy5sb2NhbERhdGFbZ3JvdXBJRF07dmFyIGNoYW5nZXM9e307dmFyIGdyb3VwZWRGaWVsZE5hbWU9cGFyZW50Lmdyb3VwZWRCeVswXTt2YXIgZ3JvdXBlZEZpZWxkPXBhcmVudC5maWVsZHNbZ3JvdXBlZEZpZWxkTmFtZV07aWYoZ3JvdXBlZEZpZWxkLnR5cGU9PT0nbWFueTJvbmUnKXtjaGFuZ2VzW2dyb3VwZWRGaWVsZE5hbWVdPXtpZDpuZXdfZ3JvdXAucmVzX2lkLGRpc3BsYXlfbmFtZTpuZXdfZ3JvdXAudmFsdWUsfTt9ZWxzZSBpZihncm91cGVkRmllbGQudHlwZT09PSdzZWxlY3Rpb24nKXt2YXIgdmFsdWU9Xy5maW5kV2hlcmUoZ3JvdXBlZEZpZWxkLnNlbGVjdGlvbix7MTpuZXdfZ3JvdXAudmFsdWV9KTtjaGFuZ2VzW2dyb3VwZWRGaWVsZE5hbWVdPXZhbHVlJiZ2YWx1ZVswXXx8ZmFsc2U7fWVsc2V7Y2hhbmdlc1tncm91cGVkRmllbGROYW1lXT1uZXdfZ3JvdXAudmFsdWU7fQp2YXIgcmVjb3JkPXNlbGYubG9jYWxEYXRhW3JlY29yZElEXTt2YXIgcmVzSUQ9cmVjb3JkLnJlc19pZDt2YXIgb2xkX2dyb3VwO2Zvcih2YXIgaT0wO2k8cGFyZW50LmRhdGEubGVuZ3RoO2krKyl7b2xkX2dyb3VwPXNlbGYubG9jYWxEYXRhW3BhcmVudC5kYXRhW2ldXTt2YXIgaW5kZXg9Xy5pbmRleE9mKG9sZF9ncm91cC5kYXRhLHJlY29yZElEKTtpZihpbmRleD49MCl7b2xkX2dyb3VwLmRhdGEuc3BsaWNlKGluZGV4LDEpO29sZF9ncm91cC5jb3VudC0tO29sZF9ncm91cC5yZXNfaWRzPV8ud2l0aG91dChvbGRfZ3JvdXAucmVzX2lkcyxyZXNJRCk7c2VsZi5fdXBkYXRlUGFyZW50UmVzSURzKG9sZF9ncm91cCk7YnJlYWs7fX0KbmV3X2dyb3VwLmRhdGEucHVzaChyZWNvcmRJRCk7bmV3X2dyb3VwLnJlc19pZHMucHVzaChyZXNJRCk7bmV3X2dyb3VwLmNvdW50Kys7cmV0dXJuIHRoaXMubm90aWZ5Q2hhbmdlcyhyZWNvcmRJRCxjaGFuZ2VzKS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIHNlbGYuc2F2ZShyZWNvcmRJRCk7fSkudGhlbihmdW5jdGlvbigpe3JlY29yZC5wYXJlbnRJRD1uZXdfZ3JvdXAuaWQ7cmV0dXJuW29sZF9ncm91cC5pZCxuZXdfZ3JvdXAuaWRdO30pO30scmVsb2FkOmZ1bmN0aW9uKGlkLG9wdGlvbnMpe2lmKG9wdGlvbnMmJm9wdGlvbnMuZ3JvdXBCeSYmIW9wdGlvbnMuZ3JvdXBCeS5sZW5ndGgpe29wdGlvbnMuZ3JvdXBCeT10aGlzLmRlZmF1bHRHcm91cGVkQnk7fQp2YXIgZGVmPXRoaXMuX3N1cGVyKGlkLG9wdGlvbnMpO2lmKG9wdGlvbnMmJm9wdGlvbnMubG9hZE1vcmVPZmZzZXQpe3JldHVybiBkZWY7fQpyZXR1cm4gdGhpcy5fcmVsb2FkUHJvZ3Jlc3NCYXJHcm91cEZyb21SZWNvcmQoaWQsZGVmKTt9LHNhdmU6ZnVuY3Rpb24ocmVjb3JkSUQpe3ZhciBkZWY9dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3JldHVybiB0aGlzLl9yZWxvYWRQcm9ncmVzc0Jhckdyb3VwRnJvbVJlY29yZChyZWNvcmRJRCxkZWYpO30sX21ha2VEYXRhUG9pbnQ6ZnVuY3Rpb24ocGFyYW1zKXt2YXIgZGF0YVBvaW50PXRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtpZihwYXJhbXMucHJvZ3Jlc3NCYXIpe2RhdGFQb2ludC5wcm9ncmVzc0Jhcj1wYXJhbXMucHJvZ3Jlc3NCYXI7fQpyZXR1cm4gZGF0YVBvaW50O30sX2xvYWQ6ZnVuY3Rpb24oZGF0YVBvaW50LG9wdGlvbnMpe2lmKGRhdGFQb2ludC5ncm91cGVkQnkubGVuZ3RoJiZkYXRhUG9pbnQucHJvZ3Jlc3NCYXIpe3JldHVybiB0aGlzLl9yZWFkUHJvZ3Jlc3NCYXJHcm91cChkYXRhUG9pbnQsb3B0aW9ucyk7fQpyZXR1cm4gdGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO30sX3JlYWRHcm91cDpmdW5jdGlvbihsaXN0KXt2YXIgc2VsZj10aGlzO2lmKGxpc3QuZ3JvdXBlZEJ5Lmxlbmd0aD4xKXtsaXN0Lmdyb3VwZWRCeT1bbGlzdC5ncm91cGVkQnlbMF1dO30KcmV0dXJuIHRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCl7cmV0dXJuIHNlbGYuX3JlYWRUb29sdGlwRmllbGRzKGxpc3QpLnRoZW4oXy5jb25zdGFudChyZXN1bHQpKTt9KTt9LF9yZWFkUHJvZ3Jlc3NCYXJHcm91cDpmdW5jdGlvbihsaXN0LG9wdGlvbnMpe3ZhciBzZWxmPXRoaXM7dmFyIGdyb3Vwc0RlZj10aGlzLl9yZWFkR3JvdXAobGlzdCxvcHRpb25zKTt2YXIgcHJvZ3Jlc3NCYXJEZWY9dGhpcy5fcnBjKHttb2RlbDpsaXN0Lm1vZGVsLG1ldGhvZDoncmVhZF9wcm9ncmVzc19iYXInLGt3YXJnczp7ZG9tYWluOmxpc3QuZG9tYWluLGdyb3VwX2J5Omxpc3QuZ3JvdXBlZEJ5WzBdLHByb2dyZXNzX2JhcjpsaXN0LnByb2dyZXNzQmFyLGNvbnRleHQ6bGlzdC5jb250ZXh0LH0sfSk7cmV0dXJuIFByb21pc2UuYWxsKFtncm91cHNEZWYscHJvZ3Jlc3NCYXJEZWZdKS50aGVuKGZ1bmN0aW9uKHJlc3VsdHMpe3ZhciBkYXRhPXJlc3VsdHNbMV07Xy5lYWNoKGxpc3QuZGF0YSxmdW5jdGlvbihncm91cElEKXt2YXIgZ3JvdXA9c2VsZi5sb2NhbERhdGFbZ3JvdXBJRF07Z3JvdXAucHJvZ3Jlc3NCYXJWYWx1ZXM9Xy5leHRlbmQoe2NvdW50czpkYXRhW2dyb3VwLnZhbHVlXXx8e30sfSxsaXN0LnByb2dyZXNzQmFyKTt9KTtyZXR1cm4gbGlzdDt9KTt9LF9yZWFkVG9vbHRpcEZpZWxkczpmdW5jdGlvbihsaXN0KXt2YXIgc2VsZj10aGlzO3ZhciBncm91cGVkQnlGaWVsZD1saXN0LmZpZWxkc1tsaXN0Lmdyb3VwZWRCeVswXS5zcGxpdCgnOicpWzBdXTtpZihncm91cGVkQnlGaWVsZC50eXBlIT09J21hbnkyb25lJyl7cmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO30KdmFyIGdyb3VwSWRzPV8ucmVkdWNlKGxpc3QuZGF0YSxmdW5jdGlvbihncm91cElkcyxpZCl7dmFyIHJlc19pZD1zZWxmLmdldChpZCx7cmF3OnRydWV9KS5yZXNfaWQ7aWYocmVzX2lkKXtncm91cElkcy5wdXNoKHJlc19pZCk7fQpyZXR1cm4gZ3JvdXBJZHM7fSxbXSk7dmFyIHRvb2x0aXBGaWVsZHM9W107dmFyIGdyb3VwZWRCeUZpZWxkSW5mbz1saXN0LmZpZWxkc0luZm8ua2FuYmFuW2xpc3QuZ3JvdXBlZEJ5WzBdXTtpZihncm91cGVkQnlGaWVsZEluZm8mJmdyb3VwZWRCeUZpZWxkSW5mby5vcHRpb25zKXt0b29sdGlwRmllbGRzPU9iamVjdC5rZXlzKGdyb3VwZWRCeUZpZWxkSW5mby5vcHRpb25zLmdyb3VwX2J5X3Rvb2x0aXB8fHt9KTt9CmlmKGdyb3VwSWRzLmxlbmd0aCYmdG9vbHRpcEZpZWxkcy5sZW5ndGgpe3ZhciBmaWVsZE5hbWVzPV8udW5pb24oWydkaXNwbGF5X25hbWUnXSx0b29sdGlwRmllbGRzKTtyZXR1cm4gdGhpcy5fcnBjKHttb2RlbDpncm91cGVkQnlGaWVsZC5yZWxhdGlvbixtZXRob2Q6J3JlYWQnLGFyZ3M6W2dyb3VwSWRzLGZpZWxkTmFtZXNdLGNvbnRleHQ6bGlzdC5jb250ZXh0LH0pLnRoZW4oZnVuY3Rpb24ocmVzdWx0KXtfLmVhY2gobGlzdC5kYXRhLGZ1bmN0aW9uKGlkKXt2YXIgZHA9c2VsZi5sb2NhbERhdGFbaWRdO2RwLnRvb2x0aXBEYXRhPV8uZmluZFdoZXJlKHJlc3VsdCx7aWQ6ZHAucmVzX2lkfSk7fSk7fSk7fQpyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7fSxfcmVsb2FkUHJvZ3Jlc3NCYXJHcm91cEZyb21SZWNvcmQ6ZnVuY3Rpb24ocmVjb3JkSUQsZGVmKXt2YXIgZWxlbWVudD10aGlzLmxvY2FsRGF0YVtyZWNvcmRJRF07aWYoZWxlbWVudC50eXBlPT09J2xpc3QnJiYhZWxlbWVudC5wYXJlbnRJRCl7cmV0dXJuIGRlZjt9CnZhciBzZWxmPXRoaXM7d2hpbGUoZWxlbWVudCl7aWYoZWxlbWVudC5wcm9ncmVzc0Jhcil7cmV0dXJuIGRlZi50aGVuKGZ1bmN0aW9uKGRhdGEpe3JldHVybiBzZWxmLl9sb2FkKGVsZW1lbnQse2tlZXBFbXB0eUdyb3Vwczp0cnVlLG9ubHlHcm91cHM6dHJ1ZSx9KS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIGRhdGE7fSk7fSk7fQplbGVtZW50PXRoaXMubG9jYWxEYXRhW2VsZW1lbnQucGFyZW50SURdO30KcmV0dXJuIGRlZjt9LH0pO3JldHVybiBLYW5iYW5Nb2RlbDt9KTs7CgovKiAvd2ViL3N0YXRpYy9zcmMvanMvdmlld3Mva2FuYmFuL2thbmJhbl9jb250cm9sbGVyLmpzIGRlZmluZWQgaW4gYnVuZGxlICd3ZWIuYXNzZXRzX2JhY2tlbmQnICovCm9kb28uZGVmaW5lKCd3ZWIuS2FuYmFuQ29udHJvbGxlcicsZnVuY3Rpb24ocmVxdWlyZSl7InVzZSBzdHJpY3QiO3ZhciBCYXNpY0NvbnRyb2xsZXI9cmVxdWlyZSgnd2ViLkJhc2ljQ29udHJvbGxlcicpO3ZhciBDb250ZXh0PXJlcXVpcmUoJ3dlYi5Db250ZXh0Jyk7dmFyIGNvcmU9cmVxdWlyZSgnd2ViLmNvcmUnKTt2YXIgRGlhbG9nPXJlcXVpcmUoJ3dlYi5EaWFsb2cnKTt2YXIgRG9tYWluPXJlcXVpcmUoJ3dlYi5Eb21haW4nKTt2YXIgdmlld19kaWFsb2dzPXJlcXVpcmUoJ3dlYi52aWV3X2RpYWxvZ3MnKTt2YXIgdmlld1V0aWxzPXJlcXVpcmUoJ3dlYi52aWV3VXRpbHMnKTt2YXIgX3Q9Y29yZS5fdDt2YXIgcXdlYj1jb3JlLnF3ZWI7dmFyIEthbmJhbkNvbnRyb2xsZXI9QmFzaWNDb250cm9sbGVyLmV4dGVuZCh7YnV0dG9uc190ZW1wbGF0ZTonS2FuYmFuVmlldy5idXR0b25zJyxjdXN0b21fZXZlbnRzOl8uZXh0ZW5kKHt9LEJhc2ljQ29udHJvbGxlci5wcm90b3R5cGUuY3VzdG9tX2V2ZW50cyx7cXVpY2tfY3JlYXRlX2FkZF9jb2x1bW46J19vbkFkZENvbHVtbicscXVpY2tfY3JlYXRlX3JlY29yZDonX29uUXVpY2tDcmVhdGVSZWNvcmQnLHJlc2VxdWVuY2VfY29sdW1uczonX29uUmVzZXF1ZW5jZUNvbHVtbicsYnV0dG9uX2NsaWNrZWQ6J19vbkJ1dHRvbkNsaWNrZWQnLGthbmJhbl9yZWNvcmRfZGVsZXRlOidfb25SZWNvcmREZWxldGUnLGthbmJhbl9yZWNvcmRfdXBkYXRlOidfb25VcGRhdGVSZWNvcmQnLGthbmJhbl9jb2x1bW5fZGVsZXRlOidfb25EZWxldGVDb2x1bW4nLGthbmJhbl9jb2x1bW5fYWRkX3JlY29yZDonX29uQWRkUmVjb3JkVG9Db2x1bW4nLGthbmJhbl9jb2x1bW5fcmVzZXF1ZW5jZTonX29uQ29sdW1uUmVzZXF1ZW5jZScsa2FuYmFuX2xvYWRfbW9yZTonX29uTG9hZE1vcmUnLGthbmJhbl9sb2FkX3JlY29yZHM6J19vbkxvYWRDb2x1bW5SZWNvcmRzJyxjb2x1bW5fdG9nZ2xlX2ZvbGQ6J19vblRvZ2dsZUNvbHVtbicsa2FuYmFuX2NvbHVtbl9yZWNvcmRzX3RvZ2dsZV9hY3RpdmU6J19vblRvZ2dsZUFjdGl2ZVJlY29yZHMnLH0pLGV2ZW50czpfLmV4dGVuZCh7fSxCYXNpY0NvbnRyb2xsZXIucHJvdG90eXBlLmV2ZW50cyx7Y2xpY2s6J19vbkNsaWNrJyx9KSxpbml0OmZ1bmN0aW9uKHBhcmVudCxtb2RlbCxyZW5kZXJlcixwYXJhbXMpe3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLm9uX2NyZWF0ZT1wYXJhbXMub25fY3JlYXRlO3RoaXMuaGFzQnV0dG9ucz1wYXJhbXMuaGFzQnV0dG9uczt0aGlzLnF1aWNrQ3JlYXRlRW5hYmxlZD1wYXJhbXMucXVpY2tDcmVhdGVFbmFibGVkO30scmVuZGVyQnV0dG9uczpmdW5jdGlvbigkbm9kZSl7aWYodGhpcy5oYXNCdXR0b25zJiZ0aGlzLmlzX2FjdGlvbl9lbmFibGVkKCdjcmVhdGUnKSl7dGhpcy4kYnV0dG9ucz0kKHF3ZWIucmVuZGVyKHRoaXMuYnV0dG9uc190ZW1wbGF0ZSx7YnRuQ2xhc3M6J2J0bi1wcmltYXJ5Jyx3aWRnZXQ6dGhpcyx9KSk7dGhpcy4kYnV0dG9ucy5vbignY2xpY2snLCdidXR0b24uby1rYW5iYW4tYnV0dG9uLW5ldycsdGhpcy5fb25CdXR0b25OZXcuYmluZCh0aGlzKSk7dGhpcy4kYnV0dG9ucy5vbigna2V5ZG93bicsdGhpcy5fb25CdXR0b25zS2V5RG93bi5iaW5kKHRoaXMpKTt0aGlzLl91cGRhdGVCdXR0b25zKCk7cmV0dXJuIFByb21pc2UucmVzb2x2ZSh0aGlzLiRidXR0b25zLmFwcGVuZFRvKCRub2RlKSk7fQpyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7fSxfY29uZmlybVNhdmU6ZnVuY3Rpb24oaWQpe3ZhciBkYXRhPXRoaXMubW9kZWwuZ2V0KHRoaXMuaGFuZGxlLHtyYXc6dHJ1ZX0pO3ZhciBncm91cGVkPWRhdGEuZ3JvdXBlZEJ5Lmxlbmd0aDtpZihncm91cGVkKXt2YXIgY29sdW1uU3RhdGU9dGhpcy5tb2RlbC5nZXRDb2x1bW4oaWQpO3JldHVybiB0aGlzLnJlbmRlcmVyLnVwZGF0ZUNvbHVtbihjb2x1bW5TdGF0ZS5pZCxjb2x1bW5TdGF0ZSk7fQpyZXR1cm4gdGhpcy5yZW5kZXJlci51cGRhdGVSZWNvcmQodGhpcy5tb2RlbC5nZXQoaWQpKTt9LF9pc1BhZ2VyVmlzaWJsZTpmdW5jdGlvbigpe3ZhciBzdGF0ZT10aGlzLm1vZGVsLmdldCh0aGlzLmhhbmRsZSx7cmF3OnRydWV9KTtyZXR1cm4hIShzdGF0ZS5jb3VudCYmIXN0YXRlLmdyb3VwZWRCeS5sZW5ndGgpO30sX3JlbG9hZEFmdGVyQnV0dG9uQ2xpY2s6ZnVuY3Rpb24oa2FuYmFuUmVjb3JkLHBhcmFtcyl7dmFyIHNlbGY9dGhpczt2YXIgcmVjb3JkTW9kZWw9dGhpcy5tb2RlbC5sb2NhbERhdGFbcGFyYW1zLnJlY29yZC5pZF07dmFyIGdyb3VwPXRoaXMubW9kZWwubG9jYWxEYXRhW3JlY29yZE1vZGVsLnBhcmVudElEXTt2YXIgcGFyZW50PXRoaXMubW9kZWwubG9jYWxEYXRhW2dyb3VwLnBhcmVudElEXTt0aGlzLm1vZGVsLnJlbG9hZChwYXJhbXMucmVjb3JkLmlkKS50aGVuKGZ1bmN0aW9uKGRiX2lkKXt2YXIgZGF0YT1zZWxmLm1vZGVsLmdldChkYl9pZCk7a2FuYmFuUmVjb3JkLnVwZGF0ZShkYXRhKTt2YXIgZG9tYWluPShwYXJlbnQ/cGFyZW50LmRvbWFpbjpncm91cC5kb21haW4pfHxbXTt2YXIgZG9tSW5EYXRhPV8uZXZlcnkoZG9tYWluLGZ1bmN0aW9uKGQpe3JldHVybiBkWzBdaW4gZGF0YS5kYXRhO30pO3ZhciBhY3RpdmVJbkRvbWFpbj1fLnBsdWNrKGRvbWFpbiwwKS5pbmRleE9mKCdhY3RpdmUnKSE9PS0xO3ZhciBhY3RpdmVJbkRhdGE9J2FjdGl2ZSdpbiBkYXRhLmRhdGE7aWYoZG9tSW5EYXRhJiYhYWN0aXZlSW5Eb21haW4mJmFjdGl2ZUluRGF0YSl7ZG9tYWluPWRvbWFpbi5jb25jYXQoW1snYWN0aXZlJywnPScsdHJ1ZV1dKTt9ZWxzZSBpZighZG9tSW5EYXRhJiYhYWN0aXZlSW5Eb21haW4mJmFjdGl2ZUluRGF0YSl7ZG9tYWluPVtbJ2FjdGl2ZScsJz0nLHRydWVdXTt9CnRyeXt2YXIgdmlzaWJsZT1uZXcgRG9tYWluKGRvbWFpbikuY29tcHV0ZShkYXRhLmV2YWxDb250ZXh0KTt9Y2F0Y2goZSl7cmV0dXJuO30KaWYoIXZpc2libGUpe2thbmJhblJlY29yZC5kZXN0cm95KCk7fX0pO30sX3Jlc2VxdWVuY2VDb2x1bW5zOmZ1bmN0aW9uKGlkcyl7dmFyIHN0YXRlPXRoaXMubW9kZWwuZ2V0KHRoaXMuaGFuZGxlLHtyYXc6dHJ1ZX0pO3ZhciBtb2RlbD1zdGF0ZS5maWVsZHNbc3RhdGUuZ3JvdXBlZEJ5WzBdXS5yZWxhdGlvbjtyZXR1cm4gdGhpcy5tb2RlbC5yZXNlcXVlbmNlKG1vZGVsLGlkcyx0aGlzLmhhbmRsZSk7fSxfcmVzZXF1ZW5jZVJlY29yZHM6ZnVuY3Rpb24oY29sdW1uX2lkLGlkcyl7dmFyIHNlbGY9dGhpcztyZXR1cm4gdGhpcy5tb2RlbC5yZXNlcXVlbmNlKHRoaXMubW9kZWxOYW1lLGlkcyxjb2x1bW5faWQpLnRoZW4oZnVuY3Rpb24oKXtzZWxmLl91cGRhdGVFbnYoKTt9KTt9LF91cGRhdGU6ZnVuY3Rpb24oKXt0aGlzLl91cGRhdGVCdXR0b25zKCk7cmV0dXJuIHRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9LF91cGRhdGVCdXR0b25zOmZ1bmN0aW9uKCl7aWYodGhpcy4kYnV0dG9ucyl7dmFyIHN0YXRlPXRoaXMubW9kZWwuZ2V0KHRoaXMuaGFuZGxlLHtyYXc6dHJ1ZX0pO3ZhciBjcmVhdGVIaWRkZW49dGhpcy5pc19hY3Rpb25fZW5hYmxlZCgnZ3JvdXBfY3JlYXRlJykmJnN0YXRlLmlzR3JvdXBlZEJ5TTJPTm9Db2x1bW47dGhpcy4kYnV0dG9ucy5maW5kKCcuby1rYW5iYW4tYnV0dG9uLW5ldycpLnRvZ2dsZUNsYXNzKCdvX2hpZGRlbicsY3JlYXRlSGlkZGVuKTt9fSxfb25BZGRDb2x1bW46ZnVuY3Rpb24oZXYpe3ZhciBzZWxmPXRoaXM7dGhpcy5tdXRleC5leGVjKGZ1bmN0aW9uKCl7cmV0dXJuIHNlbGYubW9kZWwuY3JlYXRlR3JvdXAoZXYuZGF0YS52YWx1ZSxzZWxmLmhhbmRsZSkudGhlbihmdW5jdGlvbigpe3ZhciBzdGF0ZT1zZWxmLm1vZGVsLmdldChzZWxmLmhhbmRsZSx7cmF3OnRydWV9KTt2YXIgaWRzPV8ucGx1Y2soc3RhdGUuZGF0YSwncmVzX2lkJykuZmlsdGVyKF8uaXNOdW1iZXIpO3JldHVybiBzZWxmLl9yZXNlcXVlbmNlQ29sdW1ucyhpZHMpO30pLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gc2VsZi51cGRhdGUoe30se3JlbG9hZDpmYWxzZX0pO30pLnRoZW4oZnVuY3Rpb24oKXtzZWxmLl91cGRhdGVCdXR0b25zKCk7c2VsZi5yZW5kZXJlci5xdWlja0NyZWF0ZVRvZ2dsZUZvbGQoKTt9KTt9KTt9LF9vbkFkZFJlY29yZFRvQ29sdW1uOmZ1bmN0aW9uKGV2KXt2YXIgc2VsZj10aGlzO3ZhciByZWNvcmQ9ZXYuZGF0YS5yZWNvcmQ7dmFyIGNvbHVtbj1ldi50YXJnZXQ7dGhpcy5hbGl2ZSh0aGlzLm1vZGVsLm1vdmVSZWNvcmQocmVjb3JkLmRiX2lkLGNvbHVtbi5kYl9pZCx0aGlzLmhhbmRsZSkpLnRoZW4oZnVuY3Rpb24oY29sdW1uX2RiX2lkcyl7cmV0dXJuIHNlbGYuX3Jlc2VxdWVuY2VSZWNvcmRzKGNvbHVtbi5kYl9pZCxldi5kYXRhLmlkcykudGhlbihmdW5jdGlvbigpe18uZWFjaChjb2x1bW5fZGJfaWRzLGZ1bmN0aW9uKGRiX2lkKXt2YXIgZGF0YT1zZWxmLm1vZGVsLmdldChkYl9pZCk7c2VsZi5yZW5kZXJlci51cGRhdGVDb2x1bW4oZGJfaWQsZGF0YSk7fSk7fSk7fSkuZ3VhcmRlZENhdGNoKHRoaXMucmVsb2FkLmJpbmQodGhpcykpO30sX29uQnV0dG9uQ2xpY2tlZDpmdW5jdGlvbihldil7dmFyIHNlbGY9dGhpcztldi5zdG9wUHJvcGFnYXRpb24oKTt2YXIgYXR0cnM9ZXYuZGF0YS5hdHRyczt2YXIgcmVjb3JkPWV2LmRhdGEucmVjb3JkO3ZhciBkZWY9UHJvbWlzZS5yZXNvbHZlKCk7aWYoYXR0cnMuY29udGV4dCl7YXR0cnMuY29udGV4dD1uZXcgQ29udGV4dChhdHRycy5jb250ZXh0KS5zZXRfZXZhbF9jb250ZXh0KHthY3RpdmVfaWQ6cmVjb3JkLnJlc19pZCxhY3RpdmVfaWRzOltyZWNvcmQucmVzX2lkXSxhY3RpdmVfbW9kZWw6cmVjb3JkLm1vZGVsLH0pO30KaWYoYXR0cnMuY29uZmlybSl7ZGVmPW5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUscmVqZWN0KXtEaWFsb2cuY29uZmlybSh0aGlzLGF0dHJzLmNvbmZpcm0se2NvbmZpcm1fY2FsbGJhY2s6cmVzb2x2ZSxjYW5jZWxfY2FsbGJhY2s6cmVqZWN0LH0pLm9uKCJjbG9zZWQiLG51bGwscmVqZWN0KTt9KTt9CmRlZi50aGVuKGZ1bmN0aW9uKCl7c2VsZi50cmlnZ2VyX3VwKCdleGVjdXRlX2FjdGlvbicse2FjdGlvbl9kYXRhOmF0dHJzLGVudjp7Y29udGV4dDpyZWNvcmQuZ2V0Q29udGV4dCgpLGN1cnJlbnRJRDpyZWNvcmQucmVzX2lkLG1vZGVsOnJlY29yZC5tb2RlbCxyZXNJRHM6cmVjb3JkLnJlc19pZHMsfSxvbl9jbG9zZWQ6c2VsZi5fcmVsb2FkQWZ0ZXJCdXR0b25DbGljay5iaW5kKHNlbGYsZXYudGFyZ2V0LGV2LmRhdGEpLH0pO30pO30sX29uQnV0dG9uTmV3OmZ1bmN0aW9uKCl7dmFyIHNlbGY9dGhpczt2YXIgc3RhdGU9dGhpcy5tb2RlbC5nZXQodGhpcy5oYW5kbGUse3Jhdzp0cnVlfSk7dmFyIHF1aWNrQ3JlYXRlRW5hYmxlZD10aGlzLnF1aWNrQ3JlYXRlRW5hYmxlZCYmdmlld1V0aWxzLmlzUXVpY2tDcmVhdGVFbmFibGVkKHN0YXRlKTtpZih0aGlzLm9uX2NyZWF0ZT09PSdxdWlja19jcmVhdGUnJiZxdWlja0NyZWF0ZUVuYWJsZWQmJnN0YXRlLmRhdGEubGVuZ3RoKXt0aGlzLm11dGV4LmdldFVubG9ja2VkRGVmKCkudGhlbihmdW5jdGlvbigpe3NlbGYucmVuZGVyZXIuYWRkUXVpY2tDcmVhdGUoKTt9KTt9ZWxzZSBpZih0aGlzLm9uX2NyZWF0ZSYmdGhpcy5vbl9jcmVhdGUhPT0ncXVpY2tfY3JlYXRlJyl7dGhpcy5kb19hY3Rpb24odGhpcy5vbl9jcmVhdGUse29uX2Nsb3NlOnRoaXMucmVsb2FkLmJpbmQodGhpcyx7fSksYWRkaXRpb25hbF9jb250ZXh0OnN0YXRlLmNvbnRleHQsfSk7fWVsc2V7dGhpcy50cmlnZ2VyX3VwKCdzd2l0Y2hfdmlldycse3ZpZXdfdHlwZTonZm9ybScscmVzX2lkOnVuZGVmaW5lZH0pO319LF9vbkJ1dHRvbnNLZXlEb3duOmZ1bmN0aW9uKGV2KXtzd2l0Y2goZXYua2V5Q29kZSl7Y2FzZSAkLnVpLmtleUNvZGUuRE9XTjp0aGlzLiQoJy5vX2thbmJhbl9yZWNvcmQ6Zmlyc3QnKS5mb2N1cygpO319LF9vbkNsaWNrOmZ1bmN0aW9uKGV2KXt2YXIgc3RhdGU9dGhpcy5tb2RlbC5nZXQodGhpcy5oYW5kbGUse3Jhdzp0cnVlfSk7aWYoIXN0YXRlLmNvdW50JiZ0aGlzLmJ1dHRvbnMpe3ZhciBjbGFzc2VzTGlzdD1bJ29fa2FuYmFuX3ZpZXcnLCdvX2thbmJhbl9ncm91cCcsJ29fY29sdW1uX3F1aWNrX2NyZWF0ZScsJ29fdmlld19ub2NvbnRlbnRfc21pbGluZ19mYWNlJ107dmFyICR0YXJnZXQ9JChldi50YXJnZXQpO3ZhciBoYXNDbGFzc0xpc3Q9Xy5tYXAoY2xhc3Nlc0xpc3QsZnVuY3Rpb24oa2xhc3Mpe3JldHVybiAkdGFyZ2V0Lmhhc0NsYXNzKGtsYXNzKX0pO2lmKF8uc29tZShoYXNDbGFzc0xpc3QpKXt0aGlzLiRidXR0b25zLmZpbmQoJy5vLWthbmJhbi1idXR0b24tbmV3Jykub2Rvb0JvdW5jZSgpO319fSxfb25Db2x1bW5SZXNlcXVlbmNlOmZ1bmN0aW9uKGV2KXt0aGlzLl9yZXNlcXVlbmNlUmVjb3Jkcyhldi50YXJnZXQuZGJfaWQsZXYuZGF0YS5pZHMpO30sX29uRGVsZXRlQ29sdW1uOmZ1bmN0aW9uKGV2KXt2YXIgc2VsZj10aGlzO3ZhciBjb2x1bW49ZXYudGFyZ2V0O3ZhciBzdGF0ZT10aGlzLm1vZGVsLmdldCh0aGlzLmhhbmRsZSx7cmF3OnRydWV9KTt2YXIgcmVsYXRlZE1vZGVsTmFtZT1zdGF0ZS5maWVsZHNbc3RhdGUuZ3JvdXBlZEJ5WzBdXS5yZWxhdGlvbjt0aGlzLm1vZGVsLmRlbGV0ZVJlY29yZHMoW2NvbHVtbi5kYl9pZF0scmVsYXRlZE1vZGVsTmFtZSkudGhlbihmdW5jdGlvbigpe3NlbGYudXBkYXRlKHt9LHtyZWxvYWQ6IWNvbHVtbi5pc0VtcHR5KCl9KTt9KTt9LF9vbkxvYWRDb2x1bW5SZWNvcmRzOmZ1bmN0aW9uKGV2KXt2YXIgc2VsZj10aGlzO3RoaXMubW9kZWwubG9hZENvbHVtblJlY29yZHMoZXYuZGF0YS5jb2x1bW5JRCkudGhlbihmdW5jdGlvbihkYklEKXt2YXIgZGF0YT1zZWxmLm1vZGVsLmdldChkYklEKTtyZXR1cm4gc2VsZi5yZW5kZXJlci51cGRhdGVDb2x1bW4oZGJJRCxkYXRhKS50aGVuKGZ1bmN0aW9uKCl7c2VsZi5fdXBkYXRlRW52KCk7aWYoZXYuZGF0YS5vblN1Y2Nlc3Mpe2V2LmRhdGEub25TdWNjZXNzKCk7fX0pO30pO30sX29uTG9hZE1vcmU6ZnVuY3Rpb24oZXYpe3ZhciBzZWxmPXRoaXM7dmFyIGNvbHVtbj1ldi50YXJnZXQ7dGhpcy5tb2RlbC5sb2FkTW9yZShjb2x1bW4uZGJfaWQpLnRoZW4oZnVuY3Rpb24oZGJfaWQpe3ZhciBkYXRhPXNlbGYubW9kZWwuZ2V0KGRiX2lkKTtzZWxmLnJlbmRlcmVyLnVwZGF0ZUNvbHVtbihkYl9pZCxkYXRhKTtzZWxmLl91cGRhdGVFbnYoKTt9KTt9LF9vblF1aWNrQ3JlYXRlUmVjb3JkOmZ1bmN0aW9uKGV2KXt2YXIgc2VsZj10aGlzO3ZhciB2YWx1ZXM9ZXYuZGF0YS52YWx1ZXM7dmFyIGNvbHVtbj1ldi50YXJnZXQ7dmFyIG9uRmFpbHVyZT1ldi5kYXRhLm9uRmFpbHVyZXx8ZnVuY3Rpb24oKXt9O3ZhciB1cGRhdGU9ZnVuY3Rpb24oZGJfaWQpe3NlbGYuX3VwZGF0ZUVudigpO3ZhciBjb2x1bW5TdGF0ZT1zZWxmLm1vZGVsLmdldENvbHVtbihkYl9pZCk7dmFyIHN0YXRlPXNlbGYubW9kZWwuZ2V0KHNlbGYuaGFuZGxlKTtyZXR1cm4gc2VsZi5yZW5kZXJlci51cGRhdGVDb2x1bW4oY29sdW1uU3RhdGUuaWQsY29sdW1uU3RhdGUse29wZW5RdWlja0NyZWF0ZTp0cnVlLHN0YXRlOnN0YXRlfSkudGhlbihmdW5jdGlvbigpe2lmKGV2LmRhdGEub3BlblJlY29yZCl7c2VsZi50cmlnZ2VyX3VwKCdvcGVuX3JlY29yZCcse2lkOmRiX2lkLG1vZGU6J2VkaXQnfSk7fX0pO307dGhpcy5tb2RlbC5jcmVhdGVSZWNvcmRJbkdyb3VwKGNvbHVtbi5kYl9pZCx2YWx1ZXMpLnRoZW4odXBkYXRlKS5ndWFyZGVkQ2F0Y2goZnVuY3Rpb24ocmVhc29uKXtyZWFzb24uZXZlbnQucHJldmVudERlZmF1bHQoKTt2YXIgY29sdW1uU3RhdGU9c2VsZi5tb2RlbC5nZXQoY29sdW1uLmRiX2lkLHtyYXc6dHJ1ZX0pO3ZhciBjb250ZXh0PWNvbHVtblN0YXRlLmdldENvbnRleHQoKTt2YXIgc3RhdGU9c2VsZi5tb2RlbC5nZXQoc2VsZi5oYW5kbGUse3Jhdzp0cnVlfSk7dmFyIGdyb3VwZWRCeT1zdGF0ZS5ncm91cGVkQnlbMF07Y29udGV4dFsnZGVmYXVsdF8nK2dyb3VwZWRCeV09dmlld1V0aWxzLmdldEdyb3VwVmFsdWUoY29sdW1uU3RhdGUsZ3JvdXBlZEJ5KTtuZXcgdmlld19kaWFsb2dzLkZvcm1WaWV3RGlhbG9nKHNlbGYse3Jlc19tb2RlbDpzdGF0ZS5tb2RlbCxjb250ZXh0Ol8uZXh0ZW5kKHtkZWZhdWx0X25hbWU6dmFsdWVzLm5hbWV8fHZhbHVlcy5kaXNwbGF5X25hbWV9LGNvbnRleHQpLHRpdGxlOl90KCJDcmVhdGUiKSxkaXNhYmxlX211bHRpcGxlX3NlbGVjdGlvbjp0cnVlLG9uX3NhdmVkOmZ1bmN0aW9uKHJlY29yZCl7c2VsZi5tb2RlbC5hZGRSZWNvcmRUb0dyb3VwKGNvbHVtbi5kYl9pZCxyZWNvcmQucmVzX2lkKS50aGVuKHVwZGF0ZSk7fSx9KS5vcGVuKCkub3BlbmVkKG9uRmFpbHVyZSk7fSk7fSxfb25SZWNvcmREZWxldGU6ZnVuY3Rpb24oZXYpe3RoaXMuX2RlbGV0ZVJlY29yZHMoW2V2LmRhdGEuaWRdKTt9LF9vblJlc2VxdWVuY2VDb2x1bW46ZnVuY3Rpb24oZXYpe3ZhciBzZWxmPXRoaXM7dGhpcy5fcmVzZXF1ZW5jZUNvbHVtbnMoZXYuZGF0YS5pZHMpLnRoZW4oZnVuY3Rpb24oKXtzZWxmLl91cGRhdGVFbnYoKTt9KTt9LF9vblRvZ2dsZUNvbHVtbjpmdW5jdGlvbihldil7dmFyIHNlbGY9dGhpczt2YXIgY29sdW1uPWV2LnRhcmdldDt0aGlzLm1vZGVsLnRvZ2dsZUdyb3VwKGNvbHVtbi5kYl9pZCkudGhlbihmdW5jdGlvbihkYl9pZCl7dmFyIGRhdGE9c2VsZi5tb2RlbC5nZXQoZGJfaWQpO3ZhciBvcHRpb25zPXtvcGVuUXVpY2tDcmVhdGU6ISFldi5kYXRhLm9wZW5RdWlja0NyZWF0ZSx9O3NlbGYucmVuZGVyZXIudXBkYXRlQ29sdW1uKGRiX2lkLGRhdGEsb3B0aW9ucyk7c2VsZi5fdXBkYXRlRW52KCk7fSk7fSxfb25VcGRhdGVSZWNvcmQ6ZnVuY3Rpb24oZXYpe3ZhciBvblN1Y2Nlc3M9ZXYuZGF0YS5vblN1Y2Nlc3M7ZGVsZXRlIGV2LmRhdGEub25TdWNjZXNzO3ZhciBjaGFuZ2VzPV8uY2xvbmUoZXYuZGF0YSk7ZXYuZGF0YS5mb3JjZV9zYXZlPXRydWU7dGhpcy5fYXBwbHlDaGFuZ2VzKGV2LnRhcmdldC5kYl9pZCxjaGFuZ2VzLGV2KS50aGVuKG9uU3VjY2Vzcyk7fSxfb25Ub2dnbGVBY3RpdmVSZWNvcmRzOmZ1bmN0aW9uKGV2KXt2YXIgc2VsZj10aGlzO3ZhciBjb2x1bW49ZXYudGFyZ2V0O3ZhciByZWNvcmRJZHM9Xy5wbHVjayhjb2x1bW4ucmVjb3JkcywnZGJfaWQnKTtpZihyZWNvcmRJZHMubGVuZ3RoKXt0aGlzLm1vZGVsLnRvZ2dsZUFjdGl2ZShyZWNvcmRJZHMsY29sdW1uLmRiX2lkKS50aGVuKGZ1bmN0aW9uKGRiSUQpe3ZhciBkYXRhPXNlbGYubW9kZWwuZ2V0KGRiSUQpO3NlbGYucmVuZGVyZXIudXBkYXRlQ29sdW1uKGRiSUQsZGF0YSk7c2VsZi5fdXBkYXRlRW52KCk7fSk7fX0sfSk7cmV0dXJuIEthbmJhbkNvbnRyb2xsZXI7fSk7OwoKLyogL3dlYi9zdGF0aWMvc3JjL2pzL3ZpZXdzL2thbmJhbi9rYW5iYW5fZXhhbXBsZXNfcmVnaXN0cnkuanMgZGVmaW5lZCBpbiBidW5kbGUgJ3dlYi5hc3NldHNfYmFja2VuZCcgKi8Kb2Rvby5kZWZpbmUoJ3dlYi5rYW5iYW5fZXhhbXBsZXNfcmVnaXN0cnknLGZ1bmN0aW9uKHJlcXVpcmUpeyJ1c2Ugc3RyaWN0Ijt2YXIgUmVnaXN0cnk9cmVxdWlyZSgnd2ViLlJlZ2lzdHJ5Jyk7cmV0dXJuIG5ldyBSZWdpc3RyeSgpO30pOzsKCi8qIC93ZWIvc3RhdGljL3NyYy9qcy92aWV3cy9rYW5iYW4va2FuYmFuX3JlY29yZC5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwpvZG9vLmRlZmluZSgnd2ViLkthbmJhblJlY29yZCcsZnVuY3Rpb24ocmVxdWlyZSl7InVzZSBzdHJpY3QiO3ZhciBjb25maWc9cmVxdWlyZSgnd2ViLmNvbmZpZycpO3ZhciBjb3JlPXJlcXVpcmUoJ3dlYi5jb3JlJyk7dmFyIERvbWFpbj1yZXF1aXJlKCd3ZWIuRG9tYWluJyk7dmFyIERpYWxvZz1yZXF1aXJlKCd3ZWIuRGlhbG9nJyk7dmFyIGZpZWxkX3V0aWxzPXJlcXVpcmUoJ3dlYi5maWVsZF91dGlscycpO3ZhciB1dGlscz1yZXF1aXJlKCd3ZWIudXRpbHMnKTt2YXIgV2lkZ2V0PXJlcXVpcmUoJ3dlYi5XaWRnZXQnKTt2YXIgd2lkZ2V0UmVnaXN0cnk9cmVxdWlyZSgnd2ViLndpZGdldF9yZWdpc3RyeScpO3ZhciBfdD1jb3JlLl90O3ZhciBRV2ViPWNvcmUucXdlYjt2YXIgS0FOQkFOX1JFQ09SRF9DT0xPUlM9W190KCdObyBjb2xvcicpLF90KCdSZWQnKSxfdCgnT3JhbmdlJyksX3QoJ1llbGxvdycpLF90KCdMaWdodCBibHVlJyksX3QoJ0RhcmsgcHVycGxlJyksX3QoJ1NhbG1vbiBwaW5rJyksX3QoJ01lZGl1bSBibHVlJyksX3QoJ0RhcmsgYmx1ZScpLF90KCdGdXNoaWEnKSxfdCgnR3JlZW4nKSxfdCgnUHVycGxlJyksXTt2YXIgTkJfS0FOQkFOX1JFQ09SRF9DT0xPUlM9S0FOQkFOX1JFQ09SRF9DT0xPUlMubGVuZ3RoO3ZhciBLYW5iYW5SZWNvcmQ9V2lkZ2V0LmV4dGVuZCh7ZXZlbnRzOnsnY2xpY2sgLm9lX2thbmJhbl9hY3Rpb24nOidfb25LYW5iYW5BY3Rpb25DbGlja2VkJywnY2xpY2sgLm9fa2FuYmFuX21hbmFnZV90b2dnbGVfYnV0dG9uJzonX29uTWFuYWdlVG9nZ2xlckNsaWNrZWQnLH0saW5pdDpmdW5jdGlvbihwYXJlbnQsc3RhdGUsb3B0aW9ucyl7dGhpcy5fc3VwZXIocGFyZW50KTt0aGlzLmZpZWxkcz1zdGF0ZS5maWVsZHM7dGhpcy5maWVsZHNJbmZvPXN0YXRlLmZpZWxkc0luZm8ua2FuYmFuO3RoaXMubW9kZWxOYW1lPXN0YXRlLm1vZGVsO3RoaXMub3B0aW9ucz1vcHRpb25zO3RoaXMuZWRpdGFibGU9b3B0aW9ucy5lZGl0YWJsZTt0aGlzLmRlbGV0YWJsZT1vcHRpb25zLmRlbGV0YWJsZTt0aGlzLnJlYWRfb25seV9tb2RlPW9wdGlvbnMucmVhZF9vbmx5X21vZGU7dGhpcy5zZWxlY3Rpb25Nb2RlPW9wdGlvbnMuc2VsZWN0aW9uTW9kZTt0aGlzLnF3ZWI9b3B0aW9ucy5xd2ViO3RoaXMuc3ViV2lkZ2V0cz17fTt0aGlzLl9zZXRTdGF0ZShzdGF0ZSk7dGhpcy5fb25LYW5iYW5BY3Rpb25DbGlja2VkPV8uZGVib3VuY2UodGhpcy5fb25LYW5iYW5BY3Rpb25DbGlja2VkLDMwMCx0cnVlKTt9LHN0YXJ0OmZ1bmN0aW9uKCl7cmV0dXJuIFByb21pc2UuYWxsKFt0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyksdGhpcy5fcmVuZGVyKCldKTt9LG9uX2F0dGFjaF9jYWxsYmFjazpmdW5jdGlvbigpe3RoaXMuaXNJbkRPTT10cnVlO18uaW52b2tlKHRoaXMuc3ViV2lkZ2V0cywnb25fYXR0YWNoX2NhbGxiYWNrJyk7fSxvbl9kZXRhY2hfY2FsbGJhY2s6ZnVuY3Rpb24oKXt0aGlzLmlzSW5ET009ZmFsc2U7Xy5pbnZva2UodGhpcy5zdWJXaWRnZXRzLCdvbl9kZXRhY2hfY2FsbGJhY2snKTt9LHVwZGF0ZTpmdW5jdGlvbihzdGF0ZSl7Xy5pbnZva2UoXy5wbHVjayh0aGlzLnN1YldpZGdldHMsJyRlbCcpLCdkZXRhY2gnKTt0aGlzLl9zZXRTdGF0ZShzdGF0ZSk7cmV0dXJuIHRoaXMuX3JlbmRlcigpO30sX2F0dGFjaFRvb2x0aXA6ZnVuY3Rpb24oKXt2YXIgc2VsZj10aGlzO3RoaXMuJCgnW3Rvb2x0aXBdJykuZWFjaChmdW5jdGlvbigpe3ZhciAkZWw9JCh0aGlzKTt2YXIgdG9vbHRpcD0kZWwuYXR0cigndG9vbHRpcCcpO2lmKHRvb2x0aXApeyRlbC50b29sdGlwKHt0aXRsZTpzZWxmLnF3ZWIucmVuZGVyKHRvb2x0aXAsc2VsZi5xd2ViX2NvbnRleHQpfSk7fX0pO30sX2NvbXB1dGVEb21haW46ZnVuY3Rpb24oZCl7cmV0dXJuIG5ldyBEb21haW4oZCkuY29tcHV0ZSh0aGlzLnN0YXRlLmV2YWxDb250ZXh0KTt9LF9nZXRDb2xvckNsYXNzbmFtZTpmdW5jdGlvbih2YXJpYWJsZSl7dmFyIGNvbG9yPXRoaXMuX2dldENvbG9ySUQodmFyaWFibGUpO3JldHVybidvZV9rYW5iYW5fY29sb3JfJytjb2xvcjt9LF9nZXRDb2xvcklEOmZ1bmN0aW9uKHZhcmlhYmxlKXtpZih0eXBlb2YgdmFyaWFibGU9PT0nbnVtYmVyJyl7cmV0dXJuIE1hdGgucm91bmQodmFyaWFibGUpJU5CX0tBTkJBTl9SRUNPUkRfQ09MT1JTO30KaWYodHlwZW9mIHZhcmlhYmxlPT09J3N0cmluZycpe3ZhciBpbmRleD0wO2Zvcih2YXIgaT0wO2k8dmFyaWFibGUubGVuZ3RoO2krKyl7aW5kZXgrPXZhcmlhYmxlLmNoYXJDb2RlQXQoaSk7fQpyZXR1cm4gaW5kZXglTkJfS0FOQkFOX1JFQ09SRF9DT0xPUlM7fQpyZXR1cm4gMDt9LF9nZXRDb2xvcm5hbWU6ZnVuY3Rpb24odmFyaWFibGUpe3ZhciBjb2xvcklEPXRoaXMuX2dldENvbG9ySUQodmFyaWFibGUpO3JldHVybiBLQU5CQU5fUkVDT1JEX0NPTE9SU1tjb2xvcklEXTt9LGZpbGVfdHlwZV9tYWdpY193b3JkOnsnLyc6J2pwZycsJ1InOidnaWYnLCdpJzoncG5nJywnUCc6J3N2Zyt4bWwnLH0sX2dldEltYWdlVVJMOmZ1bmN0aW9uKG1vZGVsLGZpZWxkLGlkLHBsYWNlaG9sZGVyKXtpZD0oXy5pc0FycmF5KGlkKT9pZFswXTppZCl8fGZhbHNlO3BsYWNlaG9sZGVyPXBsYWNlaG9sZGVyfHwiL3dlYi9zdGF0aWMvc3JjL2ltZy9wbGFjZWhvbGRlci5wbmciO3ZhciBpc0N1cnJlbnRSZWNvcmQ9dGhpcy5tb2RlbE5hbWU9PT1tb2RlbCYmdGhpcy5yZWNvcmREYXRhLmlkPT09aWQ7dmFyIHVybDtpZihpc0N1cnJlbnRSZWNvcmQmJnRoaXMucmVjb3JkW2ZpZWxkXSYmdGhpcy5yZWNvcmRbZmllbGRdLnJhd192YWx1ZSYmIXV0aWxzLmlzX2Jpbl9zaXplKHRoaXMucmVjb3JkW2ZpZWxkXS5yYXdfdmFsdWUpKXt1cmw9J2RhdGE6aW1hZ2UvJyt0aGlzLmZpbGVfdHlwZV9tYWdpY193b3JkW3RoaXMucmVjb3JkW2ZpZWxkXS5yYXdfdmFsdWVbMF1dKyc7YmFzZTY0LCcrdGhpcy5yZWNvcmRbZmllbGRdLnJhd192YWx1ZTt9ZWxzZSBpZighbW9kZWx8fCFmaWVsZHx8IWlkfHwoaXNDdXJyZW50UmVjb3JkJiZ0aGlzLnJlY29yZFtmaWVsZF0mJiF0aGlzLnJlY29yZFtmaWVsZF0ucmF3X3ZhbHVlKSl7dXJsPXBsYWNlaG9sZGVyO31lbHNle3ZhciBzZXNzaW9uPXRoaXMuZ2V0U2Vzc2lvbigpO3ZhciBwYXJhbXM9e21vZGVsOm1vZGVsLGZpZWxkOmZpZWxkLGlkOmlkfTtpZihpc0N1cnJlbnRSZWNvcmQpe3BhcmFtcy51bmlxdWU9dGhpcy5yZWNvcmQuX19sYXN0X3VwZGF0ZSYmdGhpcy5yZWNvcmQuX19sYXN0X3VwZGF0ZS52YWx1ZS5yZXBsYWNlKC9bXjAtOV0vZywnJyk7fQp1cmw9c2Vzc2lvbi51cmwoJy93ZWIvaW1hZ2UnLHBhcmFtcyk7fQpyZXR1cm4gdXJsO30sX29wZW5SZWNvcmQ6ZnVuY3Rpb24oKXtpZih0aGlzLiRlbC5oYXNDbGFzcygnb19jdXJyZW50bHlfZHJhZ2dlZCcpKXtyZXR1cm47fQp2YXIgZWRpdE1vZGU9dGhpcy4kZWwuaGFzQ2xhc3MoJ29lX2thbmJhbl9nbG9iYWxfY2xpY2tfZWRpdCcpO3RoaXMudHJpZ2dlcl91cCgnb3Blbl9yZWNvcmQnLHtpZDp0aGlzLmRiX2lkLG1vZGU6ZWRpdE1vZGU/J2VkaXQnOidyZWFkb25seScsfSk7fSxfcHJvY2Vzc0ZpZWxkczpmdW5jdGlvbigpe3ZhciBzZWxmPXRoaXM7dGhpcy4kKCJmaWVsZCIpLmVhY2goZnVuY3Rpb24oKXt2YXIgJGZpZWxkPSQodGhpcyk7dmFyIGZpZWxkX25hbWU9JGZpZWxkLmF0dHIoIm5hbWUiKTt2YXIgZmllbGRfd2lkZ2V0PSRmaWVsZC5hdHRyKCJ3aWRnZXQiKTtpZihmaWVsZF93aWRnZXR8fHNlbGYuZmllbGRzW2ZpZWxkX25hbWVdLnR5cGU9PT0nbWFueTJtYW55Jyl7dmFyIHdpZGdldD1zZWxmLnN1YldpZGdldHNbZmllbGRfbmFtZV07aWYoIXdpZGdldCl7dmFyIFdpZGdldD1zZWxmLmZpZWxkc0luZm9bZmllbGRfbmFtZV0uV2lkZ2V0O2lmKFdpZGdldCl7d2lkZ2V0PXNlbGYuX3Byb2Nlc3NXaWRnZXQoJGZpZWxkLGZpZWxkX25hbWUsV2lkZ2V0KTtzZWxmLnN1YldpZGdldHNbZmllbGRfbmFtZV09d2lkZ2V0O31lbHNlIGlmKGNvbmZpZy5pc0RlYnVnKCkpeyRmaWVsZC5yZXBsYWNlV2l0aCgkKCc8c3Bhbj4nLHt0ZXh0Ol8uc3RyLnNwcmludGYoX3QoJ1tObyB3aWRnZXQgJXNdJyksZmllbGRfd2lkZ2V0KSx9KSk7fX1lbHNle3dpZGdldC5yZXNldChzZWxmLnN0YXRlKTskZmllbGQucmVwbGFjZVdpdGgod2lkZ2V0LiRlbCk7aWYoc2VsZi5pc0luRE9NJiZ3aWRnZXQub25fYXR0YWNoX2NhbGxiYWNrKXt3aWRnZXQub25fYXR0YWNoX2NhbGxiYWNrKCk7fX19ZWxzZXtzZWxmLl9wcm9jZXNzRmllbGQoJGZpZWxkLGZpZWxkX25hbWUpO319KTt9LF9wcm9jZXNzRmllbGQ6ZnVuY3Rpb24oJGZpZWxkLGZpZWxkX25hbWUpe3ZhciBmaWVsZD10aGlzLmZpZWxkc1tmaWVsZF9uYW1lXTt2YXIgdmFsdWU9dGhpcy5yZWNvcmREYXRhW2ZpZWxkX25hbWVdO3ZhciBvcHRpb25zPXtkYXRhOnRoaXMucmVjb3JkRGF0YX07dmFyIGZvcm1hdHRlZF92YWx1ZT1maWVsZF91dGlscy5mb3JtYXRbZmllbGQudHlwZV0odmFsdWUsZmllbGQsb3B0aW9ucyk7dmFyICRyZXN1bHQ9JCgnPHNwYW4+Jyx7dGV4dDpmb3JtYXR0ZWRfdmFsdWUsfSk7JGZpZWxkLnJlcGxhY2VXaXRoKCRyZXN1bHQpO3RoaXMuX3NldEZpZWxkRGlzcGxheSgkcmVzdWx0LGZpZWxkX25hbWUpO3JldHVybiAkcmVzdWx0O30sX3Byb2Nlc3NXaWRnZXQ6ZnVuY3Rpb24oJGZpZWxkLGZpZWxkX25hbWUsV2lkZ2V0KXt2YXIgc2VsZj10aGlzO3ZhciBhdHRycz1PYmplY3QuY3JlYXRlKG51bGwpO18uZWFjaCh0aGlzLmZpZWxkc0luZm9bZmllbGRfbmFtZV0sZnVuY3Rpb24odmFsdWUsa2V5KXtpZihfLnN0ci5zdGFydHNXaXRoKGtleSwndC1hdHQtJykpe2tleT1rZXkuc2xpY2UoNik7dmFsdWU9JGZpZWxkLmF0dHIoa2V5KTt9CmF0dHJzW2tleV09dmFsdWU7fSk7dmFyIG9wdGlvbnM9Xy5leHRlbmQoe30sdGhpcy5vcHRpb25zLHthdHRyczphdHRyc30pO3ZhciB3aWRnZXQ9bmV3IFdpZGdldCh0aGlzLGZpZWxkX25hbWUsdGhpcy5zdGF0ZSxvcHRpb25zKTt2YXIgZGVmPXdpZGdldC5yZXBsYWNlKCRmaWVsZCk7dGhpcy5kZWZzLnB1c2goZGVmKTtkZWYudGhlbihmdW5jdGlvbigpe3NlbGYuX3NldEZpZWxkRGlzcGxheSh3aWRnZXQuJGVsLGZpZWxkX25hbWUpO30pO3JldHVybiB3aWRnZXQ7fSxfcHJvY2Vzc1dpZGdldHM6ZnVuY3Rpb24oKXt2YXIgc2VsZj10aGlzO3RoaXMuJCgid2lkZ2V0IikuZWFjaChmdW5jdGlvbigpe3ZhciAkZmllbGQ9JCh0aGlzKTt2YXIgV2lkZ2V0PXdpZGdldFJlZ2lzdHJ5LmdldCgkZmllbGQuYXR0cignbmFtZScpKTt2YXIgd2lkZ2V0PW5ldyBXaWRnZXQoc2VsZixzZWxmLnN0YXRlKTt2YXIgZGVmPXdpZGdldC5fd2lkZ2V0UmVuZGVyQW5kSW5zZXJ0KGZ1bmN0aW9uKCl7fSk7c2VsZi5kZWZzLnB1c2goZGVmKTtkZWYudGhlbihmdW5jdGlvbigpeyRmaWVsZC5yZXBsYWNlV2l0aCh3aWRnZXQuJGVsKTt3aWRnZXQuJGVsLmFkZENsYXNzKCdvX3dpZGdldCcpO30pO30pO30sX3JlbmRlcjpmdW5jdGlvbigpe3RoaXMuZGVmcz1bXTtfLmludm9rZSh0aGlzLnN1YldpZGdldHMsJ29uX2RldGFjaF9jYWxsYmFjaycpO3RoaXMuX3JlcGxhY2VFbGVtZW50KHRoaXMucXdlYi5yZW5kZXIoJ2thbmJhbi1ib3gnLHRoaXMucXdlYl9jb250ZXh0KSk7dGhpcy4kZWwuYWRkQ2xhc3MoJ29fa2FuYmFuX3JlY29yZCcpLmF0dHIoInRhYmluZGV4IiwwKTt0aGlzLiRlbC5hdHRyKCdyb2xlJywnYXJ0aWNsZScpO3RoaXMuJGVsLmRhdGEoJ3JlY29yZCcsdGhpcyk7aWYodGhpcy5zZWxlY3Rpb25Nb2RlKXt0aGlzLiRlbC5hZGRDbGFzcygnb2Vfa2FuYmFuX2dsb2JhbF9jbGljaycpO30KaWYodGhpcy4kZWwuaGFzQ2xhc3MoJ29lX2thbmJhbl9nbG9iYWxfY2xpY2snKXx8dGhpcy4kZWwuaGFzQ2xhc3MoJ29lX2thbmJhbl9nbG9iYWxfY2xpY2tfZWRpdCcpKXt0aGlzLiRlbC5vbignY2xpY2snLHRoaXMuX29uR2xvYmFsQ2xpY2suYmluZCh0aGlzKSk7dGhpcy4kZWwub24oJ2tleWRvd24nLHRoaXMuX29uS2V5RG93bkNhcmQuYmluZCh0aGlzKSk7fWVsc2V7dGhpcy4kZWwub24oJ2tleWRvd24nLHRoaXMuX29uS2V5RG93bk9wZW5GaXJzdExpbmsuYmluZCh0aGlzKSk7fQp0aGlzLl9wcm9jZXNzRmllbGRzKCk7dGhpcy5fcHJvY2Vzc1dpZGdldHMoKTt0aGlzLl9zZXR1cENvbG9yKCk7dGhpcy5fc2V0dXBDb2xvclBpY2tlcigpO3RoaXMuX2F0dGFjaFRvb2x0aXAoKTt0aGlzLiQoJ3NwYW4ub190YWcnKS50b29sdGlwKHtkZWxheTp7J3Nob3cnOjUwfX0pO3JldHVybiBQcm9taXNlLmFsbCh0aGlzLmRlZnMpO30sX3NldENvdmVySW1hZ2U6ZnVuY3Rpb24oZmllbGROYW1lKXt2YXIgc2VsZj10aGlzO3RoaXMuX3JwYyh7bW9kZWw6J2lyLmF0dGFjaG1lbnQnLG1ldGhvZDonc2VhcmNoX3JlYWQnLGRvbWFpbjpbWydyZXNfbW9kZWwnLCc9Jyx0aGlzLm1vZGVsTmFtZV0sWydyZXNfaWQnLCc9Jyx0aGlzLmlkXSxbJ21pbWV0eXBlJywnaWxpa2UnLCdpbWFnZSddXSxmaWVsZHM6WydpZCcsJ25hbWUnXSx9KS50aGVuKGZ1bmN0aW9uKGF0dGFjaG1lbnRJZHMpe3NlbGYuaW1hZ2VVcGxvYWRJRD1fLnVuaXF1ZUlkKCdvX2NvdmVyX2ltYWdlX3VwbG9hZCcpO3NlbGYuaW1hZ2Vfb25seT10cnVlO3ZhciBjb3ZlcklkPXNlbGYucmVjb3JkW2ZpZWxkTmFtZV0mJnNlbGYucmVjb3JkW2ZpZWxkTmFtZV0ucmF3X3ZhbHVlO3ZhciAkY29udGVudD0kKFFXZWIucmVuZGVyKCdLYW5iYW5WaWV3LlNldENvdmVyTW9kYWwnLHtjb3ZlcklkOmNvdmVySWQsYXR0YWNobWVudElkczphdHRhY2htZW50SWRzLHdpZGdldDpzZWxmLH0pKTt2YXIgJGltZ3M9JGNvbnRlbnQuZmluZCgnLm9fa2FuYmFuX2NvdmVyX2ltYWdlJyk7dmFyIGRpYWxvZz1uZXcgRGlhbG9nKHNlbGYse3RpdGxlOl90KCJTZXQgYSBDb3ZlciBJbWFnZSIpLCRjb250ZW50OiRjb250ZW50LGJ1dHRvbnM6W3t0ZXh0Ol90KCJTZWxlY3QiKSxjbGFzc2VzOmF0dGFjaG1lbnRJZHMubGVuZ3RoPydidG4tcHJpbWFyeSc6J2Qtbm9uZScsY2xvc2U6dHJ1ZSxkaXNhYmxlZDohY292ZXJJZCxjbGljazpmdW5jdGlvbigpe3ZhciAkaW1nPSRpbWdzLmZpbHRlcignLm9fc2VsZWN0ZWQnKS5maW5kKCdpbWcnKTt2YXIgZGF0YT17fTtkYXRhW2ZpZWxkTmFtZV09e2lkOiRpbWcuZGF0YSgnaWQnKSxkaXNwbGF5X25hbWU6JGltZy5kYXRhKCduYW1lJyl9O3NlbGYudHJpZ2dlcl91cCgna2FuYmFuX3JlY29yZF91cGRhdGUnLGRhdGEpO30sfSx7dGV4dDpfdCgnVXBsb2FkIGFuZCBTZXQnKSxjbGFzc2VzOmF0dGFjaG1lbnRJZHMubGVuZ3RoPycnOididG4tcHJpbWFyeScsY2xvc2U6ZmFsc2UsY2xpY2s6ZnVuY3Rpb24oKXskY29udGVudC5maW5kKCdpbnB1dC5vX2lucHV0X2ZpbGUnKS5jbGljaygpO30sfSx7dGV4dDpfdCgiUmVtb3ZlIENvdmVyIEltYWdlIiksY2xhc3Nlczpjb3ZlcklkPycnOidkLW5vbmUnLGNsb3NlOnRydWUsY2xpY2s6ZnVuY3Rpb24oKXt2YXIgZGF0YT17fTtkYXRhW2ZpZWxkTmFtZV09ZmFsc2U7c2VsZi50cmlnZ2VyX3VwKCdrYW5iYW5fcmVjb3JkX3VwZGF0ZScsZGF0YSk7fSx9LHt0ZXh0Ol90KCJEaXNjYXJkIiksY2xvc2U6dHJ1ZSx9XSx9KTtkaWFsb2cub3BlbmVkKCkudGhlbihmdW5jdGlvbigpe3ZhciAkc2VsZWN0QnRuPWRpYWxvZy4kZm9vdGVyLmZpbmQoJy5idG4tcHJpbWFyeScpOyRjb250ZW50Lm9uKCdjbGljaycsJy5vX2thbmJhbl9jb3Zlcl9pbWFnZScsZnVuY3Rpb24oZXYpeyRpbWdzLm5vdChldi5jdXJyZW50VGFyZ2V0KS5yZW1vdmVDbGFzcygnb19zZWxlY3RlZCcpOyRzZWxlY3RCdG4ucHJvcCgnZGlzYWJsZWQnLCEkKGV2LmN1cnJlbnRUYXJnZXQpLnRvZ2dsZUNsYXNzKCdvX3NlbGVjdGVkJykuaGFzQ2xhc3MoJ29fc2VsZWN0ZWQnKSk7fSk7JGNvbnRlbnQub24oJ2RibGNsaWNrJywnLm9fa2FuYmFuX2NvdmVyX2ltYWdlJyxmdW5jdGlvbihldil7dmFyICRpbWc9JChldi5jdXJyZW50VGFyZ2V0KS5maW5kKCdpbWcnKTt2YXIgZGF0YT17fTtkYXRhW2ZpZWxkTmFtZV09e2lkOiRpbWcuZGF0YSgnaWQnKSxkaXNwbGF5X25hbWU6JGltZy5kYXRhKCduYW1lJyl9O3NlbGYudHJpZ2dlcl91cCgna2FuYmFuX3JlY29yZF91cGRhdGUnLGRhdGEpO2RpYWxvZy5jbG9zZSgpO30pOyRjb250ZW50Lm9uKCdjaGFuZ2UnLCdpbnB1dC5vX2lucHV0X2ZpbGUnLGZ1bmN0aW9uKCl7JGNvbnRlbnQuZmluZCgnZm9ybS5vX2Zvcm1fYmluYXJ5X2Zvcm0nKS5zdWJtaXQoKTt9KTskKHdpbmRvdykub24oc2VsZi5pbWFnZVVwbG9hZElELGZ1bmN0aW9uKCl7dmFyIGltYWdlcz1BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMSk7dmFyIGRhdGE9e307ZGF0YVtmaWVsZE5hbWVdPXtpZDppbWFnZXNbMF0uaWQsZGlzcGxheV9uYW1lOmltYWdlc1swXS5maWxlbmFtZX07c2VsZi50cmlnZ2VyX3VwKCdrYW5iYW5fcmVjb3JkX3VwZGF0ZScsZGF0YSk7ZGlhbG9nLmNsb3NlKCk7fSk7fSk7ZGlhbG9nLm9wZW4oKTt9KTt9LF9zZXRGaWVsZERpc3BsYXk6ZnVuY3Rpb24oJGVsLGZpZWxkTmFtZSl7aWYodGhpcy5maWVsZHNJbmZvW2ZpZWxkTmFtZV0uZGlzcGxheT09PSdyaWdodCcpeyRlbC5hZGRDbGFzcygnZmxvYXQtcmlnaHQnKTt9ZWxzZSBpZih0aGlzLmZpZWxkc0luZm9bZmllbGROYW1lXS5kaXNwbGF5PT09J2Z1bGwnKXskZWwuYWRkQ2xhc3MoJ29fdGV4dF9ibG9jaycpO30KaWYodGhpcy5maWVsZHNJbmZvW2ZpZWxkTmFtZV0uYm9sZCl7JGVsLmFkZENsYXNzKCdvX3RleHRfYm9sZCcpO319LF9zZXRTdGF0ZTpmdW5jdGlvbihyZWNvcmRTdGF0ZSl7dGhpcy5zdGF0ZT1yZWNvcmRTdGF0ZTt0aGlzLmlkPXJlY29yZFN0YXRlLnJlc19pZDt0aGlzLmRiX2lkPXJlY29yZFN0YXRlLmlkO3RoaXMucmVjb3JkRGF0YT1yZWNvcmRTdGF0ZS5kYXRhO3RoaXMucmVjb3JkPXRoaXMuX3RyYW5zZm9ybVJlY29yZChyZWNvcmRTdGF0ZS5kYXRhKTt0aGlzLnF3ZWJfY29udGV4dD17Y29udGV4dDp0aGlzLnN0YXRlLmdldENvbnRleHQoKSxrYW5iYW5faW1hZ2U6dGhpcy5fZ2V0SW1hZ2VVUkwuYmluZCh0aGlzKSxrYW5iYW5fY29sb3I6dGhpcy5fZ2V0Q29sb3JDbGFzc25hbWUuYmluZCh0aGlzKSxrYW5iYW5fZ2V0Y29sb3I6dGhpcy5fZ2V0Q29sb3JJRC5iaW5kKHRoaXMpLGthbmJhbl9nZXRjb2xvcm5hbWU6dGhpcy5fZ2V0Q29sb3JuYW1lLmJpbmQodGhpcyksa2FuYmFuX2NvbXB1dGVfZG9tYWluOnRoaXMuX2NvbXB1dGVEb21haW4uYmluZCh0aGlzKSxzZWxlY3Rpb25fbW9kZTp0aGlzLnNlbGVjdGlvbk1vZGUscmVhZF9vbmx5X21vZGU6dGhpcy5yZWFkX29ubHlfbW9kZSxyZWNvcmQ6dGhpcy5yZWNvcmQsdXNlcl9jb250ZXh0OnRoaXMuZ2V0U2Vzc2lvbigpLnVzZXJfY29udGV4dCx3aWRnZXQ6dGhpcyx9O30sX3NldHVwQ29sb3I6ZnVuY3Rpb24oKXt2YXIgY29sb3JfZmllbGQ9dGhpcy4kZWwuYXR0cignY29sb3InKTtpZihjb2xvcl9maWVsZCYmY29sb3JfZmllbGQgaW4gdGhpcy5maWVsZHMpe3ZhciBjb2xvckhlbHA9Xy5zdHIuc3ByaW50ZihfdCgiQ2FyZCBjb2xvcjogJXMiKSx0aGlzLl9nZXRDb2xvcm5hbWUodGhpcy5yZWNvcmREYXRhW2NvbG9yX2ZpZWxkXSkpO3ZhciBjb2xvckNsYXNzPXRoaXMuX2dldENvbG9yQ2xhc3NuYW1lKHRoaXMucmVjb3JkRGF0YVtjb2xvcl9maWVsZF0pO3RoaXMuJGVsLmFkZENsYXNzKGNvbG9yQ2xhc3MpO3RoaXMuJGVsLnByZXBlbmQoJzxzcGFuIHRpdGxlPSInK2NvbG9ySGVscCsnIiBhcmlhLWxhYmVsPSInK2NvbG9ySGVscCsnIiByb2xlPSJpbWciIGNsYXNzPSJvZV9rYW5iYW5fY29sb3JfaGVscCIvPicpO319LF9zZXR1cENvbG9yUGlja2VyOmZ1bmN0aW9uKCl7dmFyICRjb2xvcnBpY2tlcj10aGlzLiQoJ3VsLm9lX2thbmJhbl9jb2xvcnBpY2tlcicpO2lmKCEkY29sb3JwaWNrZXIubGVuZ3RoKXtyZXR1cm47fQokY29sb3JwaWNrZXIuaHRtbChRV2ViLnJlbmRlcignS2FuYmFuQ29sb3JQaWNrZXInKSk7JGNvbG9ycGlja2VyLm9uKCdjbGljaycsJ2EnLHRoaXMuX29uQ29sb3JDaGFuZ2VkLmJpbmQodGhpcykpO30sX3RyYW5zZm9ybVJlY29yZDpmdW5jdGlvbihyZWNvcmREYXRhKXt2YXIgc2VsZj10aGlzO3ZhciBuZXdfcmVjb3JkPXt9O18uZWFjaCh0aGlzLnN0YXRlLmdldEZpZWxkTmFtZXMoKSxmdW5jdGlvbihuYW1lKXt2YXIgdmFsdWU9cmVjb3JkRGF0YVtuYW1lXTt2YXIgcj1fLmNsb25lKHNlbGYuZmllbGRzW25hbWVdfHx7fSk7aWYoKHIudHlwZT09PSdkYXRlJ3x8ci50eXBlPT09J2RhdGV0aW1lJykmJnZhbHVlKXtyLnJhd192YWx1ZT12YWx1ZS50b0RhdGUoKTt9ZWxzZSBpZihyLnR5cGU9PT0nb25lMm1hbnknfHxyLnR5cGU9PT0nbWFueTJtYW55Jyl7ci5yYXdfdmFsdWU9dmFsdWUuY291bnQ/dmFsdWUucmVzX2lkczpbXTt9ZWxzZSBpZihyLnR5cGU9PT0nbWFueTJvbmUnKXtyLnJhd192YWx1ZT12YWx1ZSYmdmFsdWUucmVzX2lkfHxmYWxzZTt9ZWxzZXtyLnJhd192YWx1ZT12YWx1ZTt9CmlmKHIudHlwZSl7dmFyIGZvcm1hdHRlcj1maWVsZF91dGlscy5mb3JtYXRbci50eXBlXTtyLnZhbHVlPWZvcm1hdHRlcih2YWx1ZSxzZWxmLmZpZWxkc1tuYW1lXSxyZWNvcmREYXRhLHNlbGYuc3RhdGUpO31lbHNle3IudmFsdWU9dmFsdWU7fQpuZXdfcmVjb3JkW25hbWVdPXI7fSk7cmV0dXJuIG5ld19yZWNvcmQ7fSxfdXBkYXRlUmVjb3JkOmZ1bmN0aW9uKGRhdGEpe3RoaXMudHJpZ2dlcl91cCgna2FuYmFuX3JlY29yZF91cGRhdGUnLGRhdGEpO30sX29uQ29sb3JDaGFuZ2VkOmZ1bmN0aW9uKGV2ZW50KXtldmVudC5wcmV2ZW50RGVmYXVsdCgpO3ZhciBkYXRhPXt9O3ZhciBjb2xvcl9maWVsZD0kKGV2ZW50LmRlbGVnYXRlVGFyZ2V0KS5kYXRhKCdmaWVsZCcpfHwnY29sb3InO2RhdGFbY29sb3JfZmllbGRdPSQoZXZlbnQuY3VycmVudFRhcmdldCkuZGF0YSgnY29sb3InKTt0aGlzLnRyaWdnZXJfdXAoJ2thbmJhbl9yZWNvcmRfdXBkYXRlJyxkYXRhKTt9LF9vbkdsb2JhbENsaWNrOmZ1bmN0aW9uKGV2ZW50KXtpZigkKGV2ZW50LnRhcmdldCkucGFyZW50cygnLm9fZHJvcGRvd25fa2FuYmFuJykubGVuZ3RoKXtyZXR1cm47fQp2YXIgdHJpZ2dlcj10cnVlO3ZhciBlbGVtPWV2ZW50LnRhcmdldDt2YXIgaXNjaGlsZD10cnVlO3ZhciBjaGlsZHJlbj1bXTt3aGlsZShlbGVtKXt2YXIgZXZlbnRzPSQuX2RhdGEoZWxlbSwnZXZlbnRzJyk7aWYoZWxlbT09PWV2ZW50LmN1cnJlbnRUYXJnZXQpe2lzY2hpbGQ9ZmFsc2U7fQp2YXIgdGVzdF9ldmVudD1ldmVudHMmJmV2ZW50cy5jbGljayYmKGV2ZW50cy5jbGljay5sZW5ndGg+MXx8ZXZlbnRzLmNsaWNrWzBdLm5hbWVzcGFjZSE9PSdicy50b29sdGlwJyk7dmFyIHRlc3RMaW5rV2l0aEhyZWY9ZWxlbS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpPT09J2EnJiZlbGVtLmhyZWY7aWYoaXNjaGlsZCl7Y2hpbGRyZW4ucHVzaChlbGVtKTtpZih0ZXN0X2V2ZW50fHx0ZXN0TGlua1dpdGhIcmVmKXt0cmlnZ2VyPWZhbHNlO319CmlmKHRyaWdnZXImJnRlc3RfZXZlbnQpe18uZWFjaChldmVudHMuY2xpY2ssZnVuY3Rpb24oY2xpY2tfZXZlbnQpe2lmKGNsaWNrX2V2ZW50LnNlbGVjdG9yKXtfLmVhY2goY2hpbGRyZW4sZnVuY3Rpb24oY2hpbGQpe2lmKCQoY2hpbGQpLmlzKGNsaWNrX2V2ZW50LnNlbGVjdG9yKSl7dHJpZ2dlcj1mYWxzZTt9fSk7fX0pO30KZWxlbT1lbGVtLnBhcmVudEVsZW1lbnQ7fQppZih0cmlnZ2VyKXt0aGlzLl9vcGVuUmVjb3JkKCk7fX0sX29uS2FuYmFuQWN0aW9uQ2xpY2tlZDpmdW5jdGlvbihldmVudCl7ZXZlbnQucHJldmVudERlZmF1bHQoKTt2YXIgJGFjdGlvbj0kKGV2ZW50LmN1cnJlbnRUYXJnZXQpO3ZhciB0eXBlPSRhY3Rpb24uZGF0YSgndHlwZScpfHwnYnV0dG9uJztzd2l0Y2godHlwZSl7Y2FzZSdlZGl0Jzp0aGlzLnRyaWdnZXJfdXAoJ29wZW5fcmVjb3JkJyx7aWQ6dGhpcy5kYl9pZCxtb2RlOidlZGl0J30pO2JyZWFrO2Nhc2Unb3Blbic6dGhpcy50cmlnZ2VyX3VwKCdvcGVuX3JlY29yZCcse2lkOnRoaXMuZGJfaWR9KTticmVhaztjYXNlJ2RlbGV0ZSc6dGhpcy50cmlnZ2VyX3VwKCdrYW5iYW5fcmVjb3JkX2RlbGV0ZScse2lkOnRoaXMuZGJfaWQscmVjb3JkOnRoaXN9KTticmVhaztjYXNlJ2FjdGlvbic6Y2FzZSdvYmplY3QnOnZhciBhdHRycz0kYWN0aW9uLmRhdGEoKTthdHRycy5jb25maXJtPSRhY3Rpb24uYXR0cignY29uZmlybScpO3RoaXMudHJpZ2dlcl91cCgnYnV0dG9uX2NsaWNrZWQnLHthdHRyczphdHRycyxyZWNvcmQ6dGhpcy5zdGF0ZSx9KTticmVhaztjYXNlJ3NldF9jb3Zlcic6dmFyIGZpZWxkTmFtZT0kYWN0aW9uLmRhdGEoJ2ZpZWxkJyk7aWYodGhpcy5maWVsZHNbZmllbGROYW1lXS50eXBlPT09J21hbnkyb25lJyYmdGhpcy5maWVsZHNbZmllbGROYW1lXS5yZWxhdGlvbj09PSdpci5hdHRhY2htZW50JyYmdGhpcy5maWVsZHNJbmZvW2ZpZWxkTmFtZV0ud2lkZ2V0PT09J2F0dGFjaG1lbnRfaW1hZ2UnKXt0aGlzLl9zZXRDb3ZlckltYWdlKGZpZWxkTmFtZSk7fWVsc2V7dmFyIHdhcm5pbmc9Xy5zdHIuc3ByaW50ZihfdCgnQ291bGQgbm90IHNldCB0aGUgY292ZXIgaW1hZ2U6IGluY29ycmVjdCBmaWVsZCAoIiVzIikgaXMgcHJvdmlkZWQgaW4gdGhlIHZpZXcuJyksZmllbGROYW1lKTt0aGlzLmRvX3dhcm4od2FybmluZyk7fQpicmVhaztkZWZhdWx0OnRoaXMuZG9fd2FybigiS2FuYmFuOiBubyBhY3Rpb24gZm9yIHR5cGUgOiAiK3R5cGUpO319LF9vbktleURvd25DYXJkOmZ1bmN0aW9uKGV2ZW50KXtzd2l0Y2goZXZlbnQua2V5Q29kZSl7Y2FzZSAkLnVpLmtleUNvZGUuRU5URVI6aWYoJChldmVudC50YXJnZXQpLmhhc0NsYXNzKCdvZV9rYW5iYW5fZ2xvYmFsX2NsaWNrJykpe2V2ZW50LnByZXZlbnREZWZhdWx0KCk7dGhpcy5fb25HbG9iYWxDbGljayhldmVudCk7YnJlYWs7fX19LF9vbktleURvd25PcGVuRmlyc3RMaW5rOmZ1bmN0aW9uKGV2ZW50KXtzd2l0Y2goZXZlbnQua2V5Q29kZSl7Y2FzZSAkLnVpLmtleUNvZGUuRU5URVI6ZXZlbnQucHJldmVudERlZmF1bHQoKTskKGV2ZW50LnRhcmdldCkuZmluZCgnYSwgYnV0dG9uJykuZmlyc3QoKS5jbGljaygpO2JyZWFrO319LF9vbk1hbmFnZVRvZ2dsZXJDbGlja2VkOmZ1bmN0aW9uKGV2ZW50KXtldmVudC5wcmV2ZW50RGVmYXVsdCgpO3RoaXMuJGVsLnRvZ2dsZUNsYXNzKCdvX2Ryb3Bkb3duX29wZW4nKTt2YXIgY29sb3JDbGFzcz10aGlzLl9nZXRDb2xvckNsYXNzbmFtZSh0aGlzLnJlY29yZERhdGEuY29sb3J8fDApO3RoaXMuJCgnLm9fa2FuYmFuX21hbmFnZV9idXR0b25fc2VjdGlvbicpLnRvZ2dsZUNsYXNzKGNvbG9yQ2xhc3MpO30sfSk7cmV0dXJuIEthbmJhblJlY29yZDt9KTs7CgovKiAvd2ViL3N0YXRpYy9zcmMvanMvdmlld3Mva2FuYmFuL2thbmJhbl9yZWNvcmRfcXVpY2tfY3JlYXRlLmpzIGRlZmluZWQgaW4gYnVuZGxlICd3ZWIuYXNzZXRzX2JhY2tlbmQnICovCm9kb28uZGVmaW5lKCd3ZWIua2FuYmFuX3JlY29yZF9xdWlja19jcmVhdGUnLGZ1bmN0aW9uKHJlcXVpcmUpeyJ1c2Ugc3RyaWN0Ijt2YXIgY29yZT1yZXF1aXJlKCd3ZWIuY29yZScpO3ZhciBRdWlja0NyZWF0ZUZvcm1WaWV3PXJlcXVpcmUoJ3dlYi5RdWlja0NyZWF0ZUZvcm1WaWV3Jyk7dmFyIFdpZGdldD1yZXF1aXJlKCd3ZWIuV2lkZ2V0Jyk7dmFyIHF3ZWI9Y29yZS5xd2ViO3ZhciBSZWNvcmRRdWlja0NyZWF0ZT1XaWRnZXQuZXh0ZW5kKHtjbGFzc05hbWU6J29fa2FuYmFuX3F1aWNrX2NyZWF0ZScsY3VzdG9tX2V2ZW50czp7YWRkOidfb25BZGQnLGNhbmNlbDonX29uQ2FuY2VsJyx9LGV2ZW50czp7J2NsaWNrIC5vX2thbmJhbl9hZGQnOidfb25BZGRDbGlja2VkJywnY2xpY2sgLm9fa2FuYmFuX2VkaXQnOidfb25FZGl0Q2xpY2tlZCcsJ2NsaWNrIC5vX2thbmJhbl9jYW5jZWwnOidfb25DYW5jZWxDbGlja2VkJyx9LGluaXQ6ZnVuY3Rpb24ocGFyZW50LG9wdGlvbnMpe3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLmNvbnRleHQ9b3B0aW9ucy5jb250ZXh0O3RoaXMuZm9ybVZpZXdSZWY9b3B0aW9ucy5mb3JtVmlld1JlZjt0aGlzLm1vZGVsPW9wdGlvbnMubW9kZWw7dGhpcy5fZGlzYWJsZWQ9ZmFsc2U7fSx3aWxsU3RhcnQ6ZnVuY3Rpb24oKXt2YXIgc2VsZj10aGlzO3ZhciBzdXBlcldpbGxTdGFydD10aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dmFyIHZpZXdzTG9hZGVkO2lmKHRoaXMuZm9ybVZpZXdSZWYpe3ZhciB2aWV3cz1bW2ZhbHNlLCdmb3JtJ11dO3ZhciBjb250ZXh0PV8uZXh0ZW5kKHt9LHRoaXMuY29udGV4dCx7Zm9ybV92aWV3X3JlZjp0aGlzLmZvcm1WaWV3UmVmLH0pO3ZpZXdzTG9hZGVkPXRoaXMubG9hZFZpZXdzKHRoaXMubW9kZWwsY29udGV4dCx2aWV3cyk7fWVsc2V7dmFyIGZpZWxkc1ZpZXc9e307ZmllbGRzVmlldy5hcmNoPSc8Zm9ybT4nKyc8ZmllbGQgbmFtZT0iZGlzcGxheV9uYW1lIiBwbGFjZWhvbGRlcj0iVGl0bGUiIG1vZGlmaWVycz1cJ3sicmVxdWlyZWQiOiB0cnVlfVwnLz4nKyc8L2Zvcm0+Jzt2YXIgZmllbGRzPXtkaXNwbGF5X25hbWU6e3N0cmluZzonRGlzcGxheSBuYW1lJyx0eXBlOidjaGFyJ30sfTtmaWVsZHNWaWV3LmZpZWxkcz1maWVsZHM7ZmllbGRzVmlldy52aWV3RmllbGRzPWZpZWxkczt2aWV3c0xvYWRlZD1Qcm9taXNlLnJlc29sdmUoe2Zvcm06ZmllbGRzVmlld30pO30Kdmlld3NMb2FkZWQ9dmlld3NMb2FkZWQudGhlbihmdW5jdGlvbihmaWVsZHNWaWV3cyl7dmFyIGZvcm1WaWV3PW5ldyBRdWlja0NyZWF0ZUZvcm1WaWV3KGZpZWxkc1ZpZXdzLmZvcm0se2NvbnRleHQ6c2VsZi5jb250ZXh0LG1vZGVsTmFtZTpzZWxmLm1vZGVsLHVzZXJDb250ZXh0OnNlbGYuZ2V0U2Vzc2lvbigpLnVzZXJfY29udGV4dCx9KTtyZXR1cm4gZm9ybVZpZXcuZ2V0Q29udHJvbGxlcihzZWxmKS50aGVuKGZ1bmN0aW9uKGNvbnRyb2xsZXIpe3NlbGYuY29udHJvbGxlcj1jb250cm9sbGVyO3JldHVybiBzZWxmLmNvbnRyb2xsZXIuYXBwZW5kVG8oZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpKTt9KTt9KTtyZXR1cm4gUHJvbWlzZS5hbGwoW3N1cGVyV2lsbFN0YXJ0LHZpZXdzTG9hZGVkXSk7fSxzdGFydDpmdW5jdGlvbigpe3RoaXMuJGVsLmFwcGVuZCh0aGlzLmNvbnRyb2xsZXIuJGVsKTt0aGlzLiRlbC5hcHBlbmQocXdlYi5yZW5kZXIoJ0thbmJhblZpZXcuUmVjb3JkUXVpY2tDcmVhdGUuYnV0dG9ucycpKTt0aGlzLmNvbnRyb2xsZXIuYXV0b2ZvY3VzKCk7Y29yZS5idXMub24oJ2NsaWNrJyx0aGlzLHRoaXMuX29uV2luZG93Q2xpY2tlZCk7cmV0dXJuIHRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9LG9uX2F0dGFjaF9jYWxsYmFjazpmdW5jdGlvbigpe2lmKHRoaXMuY29udHJvbGxlcil7dGhpcy5jb250cm9sbGVyLmF1dG9mb2N1cygpO319LGNhbmNlbDpmdW5jdGlvbigpe3ZhciBzZWxmPXRoaXM7cmV0dXJuIHRoaXMuY29udHJvbGxlci5jb21taXRDaGFuZ2VzKCkudGhlbihmdW5jdGlvbigpe2lmKCFzZWxmLmNvbnRyb2xsZXIuaXNEaXJ0eSgpKXtzZWxmLl9jYW5jZWwoKTt9fSk7fSxfYWRkOmZ1bmN0aW9uKG9wdGlvbnMpe3ZhciBzZWxmPXRoaXM7aWYodGhpcy5fZGlzYWJsZWQpe3JldHVybjt9CnRoaXMuX2Rpc2FibGVRdWlja0NyZWF0ZSgpO3RoaXMuY29udHJvbGxlci5jb21taXRDaGFuZ2VzKCkudGhlbihmdW5jdGlvbigpe3ZhciBjYW5CZVNhdmVkPXNlbGYuY29udHJvbGxlci5jYW5CZVNhdmVkKCk7aWYoY2FuQmVTYXZlZCl7c2VsZi50cmlnZ2VyX3VwKCdxdWlja19jcmVhdGVfYWRkX3JlY29yZCcse29wZW5SZWNvcmQ6b3B0aW9ucyYmb3B0aW9ucy5vcGVuUmVjb3JkfHxmYWxzZSx2YWx1ZXM6c2VsZi5jb250cm9sbGVyLmdldENoYW5nZXMoKSxvbkZhaWx1cmU6c2VsZi5fZW5hYmxlUXVpY2tDcmVhdGUuYmluZChzZWxmKSx9KTt9ZWxzZXtzZWxmLl9lbmFibGVRdWlja0NyZWF0ZSgpO319KS5ndWFyZGVkQ2F0Y2godGhpcy5fZW5hYmxlUXVpY2tDcmVhdGUuYmluZCh0aGlzKSk7fSxfY2FuY2VsOmZ1bmN0aW9uKCl7dGhpcy50cmlnZ2VyX3VwKCdjYW5jZWxfcXVpY2tfY3JlYXRlJyk7fSxfZGlzYWJsZVF1aWNrQ3JlYXRlOmZ1bmN0aW9uKCl7dGhpcy5fZGlzYWJsZWQ9dHJ1ZTt0aGlzLiRlbC5hZGRDbGFzcygnb19kaXNhYmxlZCcpO3RoaXMuJCgnaW5wdXQ6bm90KDpkaXNhYmxlZCknKS5hZGRDbGFzcygnb190ZW1wb3JhcmlseV9kaXNhYmxlZCcpLmF0dHIoJ2Rpc2FibGVkJywnZGlzYWJsZWQnKTt9LF9lbmFibGVRdWlja0NyZWF0ZTpmdW5jdGlvbigpe3RoaXMuX2Rpc2FibGVkPWZhbHNlO3RoaXMuJGVsLnJlbW92ZUNsYXNzKCdvX2Rpc2FibGVkJyk7dGhpcy4kKCdpbnB1dC5vX3RlbXBvcmFyaWx5X2Rpc2FibGVkJykucmVtb3ZlQ2xhc3MoJ29fdGVtcG9yYXJpbHlfZGlzYWJsZWQnKS5hdHRyKCdkaXNhYmxlZCcsZmFsc2UpO30sX29uQWRkOmZ1bmN0aW9uKGV2KXtldi5zdG9wUHJvcGFnYXRpb24oKTt0aGlzLl9hZGQoKTt9LF9vbkFkZENsaWNrZWQ6ZnVuY3Rpb24oZXYpe2V2LnN0b3BQcm9wYWdhdGlvbigpO3RoaXMuX2FkZCgpO30sX29uQ2FuY2VsOmZ1bmN0aW9uKGV2KXtldi5zdG9wUHJvcGFnYXRpb24oKTt0aGlzLl9jYW5jZWwoKTt9LF9vbkNhbmNlbENsaWNrZWQ6ZnVuY3Rpb24oZXYpe2V2LnN0b3BQcm9wYWdhdGlvbigpO3RoaXMuX2NhbmNlbCgpO30sX29uRWRpdENsaWNrZWQ6ZnVuY3Rpb24oZXYpe2V2LnN0b3BQcm9wYWdhdGlvbigpO3RoaXMuX2FkZCh7b3BlblJlY29yZDp0cnVlfSk7fSxfb25XaW5kb3dDbGlja2VkOmZ1bmN0aW9uKGV2KXtpZighZG9jdW1lbnQuY29udGFpbnModGhpcy5lbCkpe3JldHVybjt9CmlmKCQoZXYudGFyZ2V0KS5jbG9zZXN0KCcuby1rYW5iYW4tYnV0dG9uLW5ldywgLm9fa2FuYmFuX3F1aWNrX2FkZCcpLmxlbmd0aCl7cmV0dXJuO30KaWYoJChldi50YXJnZXQpLnBhcmVudHMoJy51aS1hdXRvY29tcGxldGUnKS5sZW5ndGgpe3JldHVybjt9CmlmKCQoZXYudGFyZ2V0KS5jbG9zZXN0KCcubW9kYWwnKS5sZW5ndGgpe3JldHVybjt9CmlmKCFkb2N1bWVudC5jb250YWlucyhldi50YXJnZXQpKXtyZXR1cm47fQppZih0aGlzLmVsLmNvbnRhaW5zKGV2LnRhcmdldCkmJnRoaXMuZWwhPT1ldi50YXJnZXQpe3JldHVybjt9CnRoaXMuY2FuY2VsKCk7fSx9KTtyZXR1cm4gUmVjb3JkUXVpY2tDcmVhdGU7fSk7OwoKLyogL3dlYi9zdGF0aWMvc3JjL2pzL3ZpZXdzL2thbmJhbi9rYW5iYW5fcmVuZGVyZXIuanMgZGVmaW5lZCBpbiBidW5kbGUgJ3dlYi5hc3NldHNfYmFja2VuZCcgKi8Kb2Rvby5kZWZpbmUoJ3dlYi5LYW5iYW5SZW5kZXJlcicsZnVuY3Rpb24ocmVxdWlyZSl7InVzZSBzdHJpY3QiO3ZhciBCYXNpY1JlbmRlcmVyPXJlcXVpcmUoJ3dlYi5CYXNpY1JlbmRlcmVyJyk7dmFyIENvbHVtblF1aWNrQ3JlYXRlPXJlcXVpcmUoJ3dlYi5rYW5iYW5fY29sdW1uX3F1aWNrX2NyZWF0ZScpO3ZhciBjb25maWc9cmVxdWlyZSgnd2ViLmNvbmZpZycpO3ZhciBjb3JlPXJlcXVpcmUoJ3dlYi5jb3JlJyk7dmFyIEthbmJhbkNvbHVtbj1yZXF1aXJlKCd3ZWIuS2FuYmFuQ29sdW1uJyk7dmFyIEthbmJhblJlY29yZD1yZXF1aXJlKCd3ZWIuS2FuYmFuUmVjb3JkJyk7dmFyIFFXZWI9cmVxdWlyZSgnd2ViLlFXZWInKTt2YXIgc2Vzc2lvbj1yZXF1aXJlKCd3ZWIuc2Vzc2lvbicpO3ZhciB1dGlscz1yZXF1aXJlKCd3ZWIudXRpbHMnKTt2YXIgdmlld1V0aWxzPXJlcXVpcmUoJ3dlYi52aWV3VXRpbHMnKTt2YXIgcXdlYj1jb3JlLnF3ZWI7dmFyIF90PWNvcmUuX3Q7ZnVuY3Rpb24gZmluZEluTm9kZShub2RlLHByZWRpY2F0ZSl7aWYocHJlZGljYXRlKG5vZGUpKXtyZXR1cm4gbm9kZTt9CmlmKCFub2RlLmNoaWxkcmVuKXtyZXR1cm4gdW5kZWZpbmVkO30KZm9yKHZhciBpPTA7aTxub2RlLmNoaWxkcmVuLmxlbmd0aDtpKyspe2lmKGZpbmRJbk5vZGUobm9kZS5jaGlsZHJlbltpXSxwcmVkaWNhdGUpKXtyZXR1cm4gbm9kZS5jaGlsZHJlbltpXTt9fX0KZnVuY3Rpb24gcXdlYkFkZElmKG5vZGUsY29uZGl0aW9uKXtpZihub2RlLmF0dHJzW3F3ZWIucHJlZml4KyctaWYnXSl7Y29uZGl0aW9uPV8uc3RyLnNwcmludGYoIiglcykgYW5kICglcykiLG5vZGUuYXR0cnNbcXdlYi5wcmVmaXgrJy1pZiddLGNvbmRpdGlvbik7fQpub2RlLmF0dHJzW3F3ZWIucHJlZml4KyctaWYnXT1jb25kaXRpb247fQpmdW5jdGlvbiB0cmFuc2Zvcm1Rd2ViVGVtcGxhdGUobm9kZSxmaWVsZHMpe2lmKG5vZGUudGFnJiZub2RlLmF0dHJzLm1vZGlmaWVycyl7dmFyIG1vZGlmaWVycz1ub2RlLmF0dHJzLm1vZGlmaWVyc3x8e307aWYobW9kaWZpZXJzLmludmlzaWJsZSl7cXdlYkFkZElmKG5vZGUsXy5zdHIuc3ByaW50ZigiIWthbmJhbl9jb21wdXRlX2RvbWFpbiglcykiLEpTT04uc3RyaW5naWZ5KG1vZGlmaWVycy5pbnZpc2libGUpKSk7fX0Kc3dpdGNoKG5vZGUudGFnKXtjYXNlJ2J1dHRvbic6Y2FzZSdhJzp2YXIgdHlwZT1ub2RlLmF0dHJzLnR5cGV8fCcnO2lmKF8uaW5kZXhPZignYWN0aW9uLG9iamVjdCxlZGl0LG9wZW4sZGVsZXRlLHVybCxzZXRfY292ZXInLnNwbGl0KCcsJyksdHlwZSkhPT0tMSl7Xy5lYWNoKG5vZGUuYXR0cnMsZnVuY3Rpb24odixrKXtpZihfLmluZGV4T2YoJ2ljb24sdHlwZSxuYW1lLGFyZ3Msc3RyaW5nLGNvbnRleHQsc3RhdGVzLGthbmJhbl9zdGF0ZXMnLnNwbGl0KCcsJyksaykhPT0tMSl7bm9kZS5hdHRyc1snZGF0YS0nK2tdPXY7ZGVsZXRlKG5vZGUuYXR0cnNba10pO319KTtpZihub2RlLmF0dHJzWydkYXRhLXN0cmluZyddKXtub2RlLmF0dHJzLnRpdGxlPW5vZGUuYXR0cnNbJ2RhdGEtc3RyaW5nJ107fQppZihub2RlLnRhZz09PSdhJyYmbm9kZS5hdHRyc1snZGF0YS10eXBlJ10hPT0idXJsIil7bm9kZS5hdHRycy5ocmVmPScjJzt9ZWxzZXtub2RlLmF0dHJzLnR5cGU9J2J1dHRvbic7fQp2YXIgYWN0aW9uX2NsYXNzZXM9IiBvZV9rYW5iYW5fYWN0aW9uIG9lX2thbmJhbl9hY3Rpb25fIitub2RlLnRhZztpZihub2RlLmF0dHJzWyd0LWF0dGYtY2xhc3MnXSl7bm9kZS5hdHRyc1sndC1hdHRmLWNsYXNzJ10rPWFjdGlvbl9jbGFzc2VzO31lbHNlIGlmKG5vZGUuYXR0cnNbJ3QtYXR0LWNsYXNzJ10pe25vZGUuYXR0cnNbJ3QtYXR0LWNsYXNzJ10rPSIgKyAnIithY3Rpb25fY2xhc3NlcysiJyI7fWVsc2V7bm9kZS5hdHRyc1snY2xhc3MnXT0obm9kZS5hdHRyc1snY2xhc3MnXXx8JycpK2FjdGlvbl9jbGFzc2VzO319CmJyZWFrO30KaWYobm9kZS5jaGlsZHJlbil7Zm9yKHZhciBpPTAsaWk9bm9kZS5jaGlsZHJlbi5sZW5ndGg7aTxpaTtpKyspe3RyYW5zZm9ybVF3ZWJUZW1wbGF0ZShub2RlLmNoaWxkcmVuW2ldLGZpZWxkcyk7fX19CnZhciBLYW5iYW5SZW5kZXJlcj1CYXNpY1JlbmRlcmVyLmV4dGVuZCh7Y2xhc3NOYW1lOidvX2thbmJhbl92aWV3Jyxjb25maWc6e0thbmJhbkNvbHVtbjpLYW5iYW5Db2x1bW4sS2FuYmFuUmVjb3JkOkthbmJhblJlY29yZCx9LGN1c3RvbV9ldmVudHM6Xy5leHRlbmQoe30sQmFzaWNSZW5kZXJlci5wcm90b3R5cGUuY3VzdG9tX2V2ZW50c3x8e30se2Nsb3NlX3F1aWNrX2NyZWF0ZTonX29uQ2xvc2VRdWlja0NyZWF0ZScsY2FuY2VsX3F1aWNrX2NyZWF0ZTonX29uQ2xvc2VRdWlja0NyZWF0ZScsc2V0X3Byb2dyZXNzX2Jhcl9zdGF0ZTonX29uU2V0UHJvZ3Jlc3NCYXJTdGF0ZScsc3RhcnRfcXVpY2tfY3JlYXRlOidfb25TdGFydFF1aWNrQ3JlYXRlJyxxdWlja19jcmVhdGVfY29sdW1uX3VwZGF0ZWQ6J19vblF1aWNrQ3JlYXRlQ29sdW1uVXBkYXRlZCcsfSksZXZlbnRzOl8uZXh0ZW5kKHt9LEJhc2ljUmVuZGVyZXIucHJvdG90eXBlLmV2ZW50c3x8e30seydrZXlkb3duIC5vX2thbmJhbl9yZWNvcmQnOidfb25SZWNvcmRLZXlEb3duJ30pLGluaXQ6ZnVuY3Rpb24ocGFyZW50LHN0YXRlLHBhcmFtcyl7dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3RoaXMud2lkZ2V0cz1bXTt0aGlzLnF3ZWI9bmV3IFFXZWIoY29uZmlnLmlzRGVidWcoKSx7X3M6c2Vzc2lvbi5vcmlnaW59LGZhbHNlKTt2YXIgdGVtcGxhdGVzPWZpbmRJbk5vZGUodGhpcy5hcmNoLGZ1bmN0aW9uKG4pe3JldHVybiBuLnRhZz09PSd0ZW1wbGF0ZXMnO30pO3RyYW5zZm9ybVF3ZWJUZW1wbGF0ZSh0ZW1wbGF0ZXMsc3RhdGUuZmllbGRzKTt0aGlzLnF3ZWIuYWRkX3RlbXBsYXRlKHV0aWxzLmpzb25fbm9kZV90b194bWwodGVtcGxhdGVzKSk7dGhpcy5leGFtcGxlcz1wYXJhbXMuZXhhbXBsZXM7dGhpcy5yZWNvcmRPcHRpb25zPV8uZXh0ZW5kKHt9LHBhcmFtcy5yZWNvcmRfb3B0aW9ucyx7cXdlYjp0aGlzLnF3ZWIsdmlld1R5cGU6J2thbmJhbicsfSk7dGhpcy5jb2x1bW5PcHRpb25zPV8uZXh0ZW5kKHtLYW5iYW5SZWNvcmQ6dGhpcy5jb25maWcuS2FuYmFuUmVjb3JkfSxwYXJhbXMuY29sdW1uX29wdGlvbnMpO2lmKHRoaXMuY29sdW1uT3B0aW9ucy5oYXNQcm9ncmVzc0Jhcil7dGhpcy5jb2x1bW5PcHRpb25zLnByb2dyZXNzQmFyU3RhdGVzPXt9O30KdGhpcy5xdWlja0NyZWF0ZUVuYWJsZWQ9cGFyYW1zLnF1aWNrQ3JlYXRlRW5hYmxlZDtpZighcGFyYW1zLnJlYWRPbmx5TW9kZSl7dmFyIGhhbmRsZUZpZWxkPV8uZmluZFdoZXJlKHRoaXMuc3RhdGUuZmllbGRzSW5mby5rYW5iYW4se3dpZGdldDonaGFuZGxlJ30pO3RoaXMuaGFuZGxlRmllbGQ9aGFuZGxlRmllbGQmJmhhbmRsZUZpZWxkLm5hbWU7fQp0aGlzLl9zZXRTdGF0ZShzdGF0ZSk7fSxvbl9hdHRhY2hfY2FsbGJhY2s6ZnVuY3Rpb24oKXt0aGlzLl9pc0luRG9tPXRydWU7Xy5pbnZva2UodGhpcy53aWRnZXRzLCdvbl9hdHRhY2hfY2FsbGJhY2snKTtpZih0aGlzLnF1aWNrQ3JlYXRlKXt0aGlzLnF1aWNrQ3JlYXRlLm9uX2F0dGFjaF9jYWxsYmFjaygpO319LG9uX2RldGFjaF9jYWxsYmFjazpmdW5jdGlvbigpe3RoaXMuX2lzSW5Eb209ZmFsc2U7Xy5pbnZva2UodGhpcy53aWRnZXRzLCdvbl9kZXRhY2hfY2FsbGJhY2snKTt9LGFkZFF1aWNrQ3JlYXRlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMud2lkZ2V0c1swXS5hZGRRdWlja0NyZWF0ZSgpO30sZ2l2ZUZvY3VzOmZ1bmN0aW9uKCl7dGhpcy4kKCcub19rYW5iYW5fcmVjb3JkOmZpcnN0JykuZm9jdXMoKTt9LHF1aWNrQ3JlYXRlVG9nZ2xlRm9sZDpmdW5jdGlvbigpe3RoaXMucXVpY2tDcmVhdGUudG9nZ2xlRm9sZCgpO3RoaXMuX3RvZ2dsZU5vQ29udGVudEhlbHBlcigpO30sdXBkYXRlQ29sdW1uOmZ1bmN0aW9uKGxvY2FsSUQsY29sdW1uU3RhdGUsb3B0aW9ucyl7dmFyIHNlbGY9dGhpczt2YXIgS2FuYmFuQ29sdW1uPXRoaXMuY29uZmlnLkthbmJhbkNvbHVtbjt2YXIgbmV3Q29sdW1uPW5ldyBLYW5iYW5Db2x1bW4odGhpcyxjb2x1bW5TdGF0ZSx0aGlzLmNvbHVtbk9wdGlvbnMsdGhpcy5yZWNvcmRPcHRpb25zKTt2YXIgaW5kZXg9Xy5maW5kSW5kZXgodGhpcy53aWRnZXRzLHtkYl9pZDpsb2NhbElEfSk7dmFyIGNvbHVtbj10aGlzLndpZGdldHNbaW5kZXhdO3RoaXMud2lkZ2V0c1tpbmRleF09bmV3Q29sdW1uO2lmKG9wdGlvbnMmJm9wdGlvbnMuc3RhdGUpe3RoaXMuc3RhdGU9b3B0aW9ucy5zdGF0ZTt9CnJldHVybiBuZXdDb2x1bW4uYXBwZW5kVG8oZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpKS50aGVuKGZ1bmN0aW9uKCl7dmFyIGRlZjtpZihvcHRpb25zJiZvcHRpb25zLm9wZW5RdWlja0NyZWF0ZSl7ZGVmPW5ld0NvbHVtbi5hZGRRdWlja0NyZWF0ZSgpO30KcmV0dXJuIFByb21pc2UucmVzb2x2ZShkZWYpLnRoZW4oZnVuY3Rpb24oKXtuZXdDb2x1bW4uJGVsLmluc2VydEFmdGVyKGNvbHVtbi4kZWwpO3NlbGYuX3RvZ2dsZU5vQ29udGVudEhlbHBlcigpO25ld0NvbHVtbi5vbl9hdHRhY2hfY2FsbGJhY2soKTtjb2x1bW4uZGVzdHJveSgpO30pO30pO30sdXBkYXRlUmVjb3JkOmZ1bmN0aW9uKHJlY29yZFN0YXRlKXt2YXIgaXNHcm91cGVkPSEhdGhpcy5zdGF0ZS5ncm91cGVkQnkubGVuZ3RoO3ZhciByZWNvcmQ7aWYoaXNHcm91cGVkKXtfLmVhY2godGhpcy53aWRnZXRzLGZ1bmN0aW9uKHdpZGdldCl7cmVjb3JkPXJlY29yZHx8Xy5maW5kV2hlcmUod2lkZ2V0LnJlY29yZHMse2RiX2lkOnJlY29yZFN0YXRlLmlkLH0pO30pO31lbHNle3JlY29yZD1fLmZpbmRXaGVyZSh0aGlzLndpZGdldHMse2RiX2lkOnJlY29yZFN0YXRlLmlkfSk7fQppZihyZWNvcmQpe3JldHVybiByZWNvcmQudXBkYXRlKHJlY29yZFN0YXRlKTt9CnJldHVybiBQcm9taXNlLnJlc29sdmUoKTt9LHVwZGF0ZVN0YXRlOmZ1bmN0aW9uKHN0YXRlKXt0aGlzLl9zZXRTdGF0ZShzdGF0ZSk7cmV0dXJuIHRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9LF9mb2N1c09uTmV4dENhcmQ6ZnVuY3Rpb24oY3VycmVudENhcmRFbGVtZW50KXt2YXIgbmV4dENhcmQ9Y3VycmVudENhcmRFbGVtZW50Lm5leHRFbGVtZW50U2libGluZztpZihuZXh0Q2FyZCl7bmV4dENhcmQuZm9jdXMoKTt9fSxfZm9jdXNPblByZXZpb3VzQ2FyZDpmdW5jdGlvbihjdXJyZW50Q2FyZEVsZW1lbnQpe3ZhciBwcmV2aW91c0NhcmQ9Y3VycmVudENhcmRFbGVtZW50LnByZXZpb3VzRWxlbWVudFNpYmxpbmc7aWYocHJldmlvdXNDYXJkJiZwcmV2aW91c0NhcmQuY2xhc3NMaXN0LmNvbnRhaW5zKCJvX2thbmJhbl9yZWNvcmQiKSl7cHJldmlvdXNDYXJkLmZvY3VzKCk7cmV0dXJuIHRydWU7fX0sX2dldEdob3N0Q29sdW1uczpmdW5jdGlvbigpe2lmKHRoaXMuZXhhbXBsZXMmJnRoaXMuZXhhbXBsZXMuZ2hvc3RDb2x1bW5zKXtyZXR1cm4gdGhpcy5leGFtcGxlcy5naG9zdENvbHVtbnM7fQpyZXR1cm4gXy5tYXAoXy5yYW5nZSgxLDUpLGZ1bmN0aW9uKG51bSl7cmV0dXJuIF8uc3RyLnNwcmludGYoX3QoIkNvbHVtbiAlcyIpLG51bSk7fSk7fSxfcmVuZGVyRXhhbXBsZUJhY2tncm91bmQ6ZnVuY3Rpb24oZnJhZ21lbnQpe3ZhciAkYmFja2dyb3VuZD0kKHF3ZWIucmVuZGVyKCdLYW5iYW5WaWV3LkV4YW1wbGVzQmFja2dyb3VuZCcse2dob3N0Q29sdW1uczp0aGlzLl9nZXRHaG9zdENvbHVtbnMoKX0pKTskYmFja2dyb3VuZC5hcHBlbmRUbyhmcmFnbWVudCk7fSxfcmVuZGVyR2hvc3REaXZzOmZ1bmN0aW9uKGZyYWdtZW50LG5iRGl2cyxvcHRpb25zKXt2YXIgZ2hvc3REZWZzPVtdO2Zvcih2YXIgJGdob3N0LGk9MDtpPG5iRGl2cztpKyspeyRnaG9zdD0kKCc8ZGl2PicpLmFkZENsYXNzKCdvX2thbmJhbl9yZWNvcmQgb19rYW5iYW5fZ2hvc3QnKTtpZihvcHRpb25zJiZvcHRpb25zLmlubGluZVN0eWxlKXskZ2hvc3QuYXR0cignc3R5bGUnLG9wdGlvbnMuaW5saW5lU3R5bGUpO30KdmFyIGRlZj0kZ2hvc3QuYXBwZW5kVG8oZnJhZ21lbnQpO2dob3N0RGVmcy5wdXNoKGRlZik7fQpyZXR1cm4gUHJvbWlzZS5hbGwoZ2hvc3REZWZzKTt9LF9yZW5kZXJHcm91cGVkOmZ1bmN0aW9uKGZyYWdtZW50KXt2YXIgc2VsZj10aGlzO3ZhciBLYW5iYW5Db2x1bW49dGhpcy5jb25maWcuS2FuYmFuQ29sdW1uO18uZWFjaCh0aGlzLnN0YXRlLmRhdGEsZnVuY3Rpb24oZ3JvdXApe3ZhciBjb2x1bW49bmV3IEthbmJhbkNvbHVtbihzZWxmLGdyb3VwLHNlbGYuY29sdW1uT3B0aW9ucyxzZWxmLnJlY29yZE9wdGlvbnMpO3ZhciBkZWY7aWYoIWdyb3VwLnZhbHVlKXtkZWY9Y29sdW1uLnByZXBlbmRUbyhmcmFnbWVudCk7c2VsZi53aWRnZXRzLnVuc2hpZnQoY29sdW1uKTt9ZWxzZXtkZWY9Y29sdW1uLmFwcGVuZFRvKGZyYWdtZW50KTtzZWxmLndpZGdldHMucHVzaChjb2x1bW4pO30Kc2VsZi5kZWZzLnB1c2goZGVmKTt9KTtpZih0aGlzLiRlbC5zb3J0YWJsZSgnaW5zdGFuY2UnKSE9PXVuZGVmaW5lZCl7dGhpcy4kZWwuc29ydGFibGUoJ2Rlc3Ryb3knKTt9CmlmKHRoaXMuZ3JvdXBlZEJ5TTJPKXt0aGlzLiRlbC5zb3J0YWJsZSh7YXhpczoneCcsaXRlbXM6Jz4gLm9fa2FuYmFuX2dyb3VwJyxoYW5kbGU6Jy5vX2thbmJhbl9oZWFkZXJfdGl0bGUnLGN1cnNvcjonbW92ZScscmV2ZXJ0OjE1MCxkZWxheToxMDAsdG9sZXJhbmNlOidwb2ludGVyJyxmb3JjZVBsYWNlaG9sZGVyU2l6ZTp0cnVlLHN0b3A6ZnVuY3Rpb24oKXt2YXIgaWRzPVtdO3NlbGYuJCgnLm9fa2FuYmFuX2dyb3VwJykuZWFjaChmdW5jdGlvbihpbmRleCx1KXtpZihfLmlzTnVtYmVyKCQodSkuZGF0YSgnaWQnKSkpe2lkcy5wdXNoKCQodSkuZGF0YSgnaWQnKSk7fX0pO3NlbGYudHJpZ2dlcl91cCgncmVzZXF1ZW5jZV9jb2x1bW5zJyx7aWRzOmlkc30pO30sfSk7aWYodGhpcy5jcmVhdGVDb2x1bW5FbmFibGVkKXt0aGlzLnF1aWNrQ3JlYXRlPW5ldyBDb2x1bW5RdWlja0NyZWF0ZSh0aGlzLHtleGFtcGxlczp0aGlzLmV4YW1wbGVzJiZ0aGlzLmV4YW1wbGVzLmV4YW1wbGVzLH0pO3RoaXMuZGVmcy5wdXNoKHRoaXMucXVpY2tDcmVhdGUuYXBwZW5kVG8oZnJhZ21lbnQpLnRoZW4oZnVuY3Rpb24oKXtpZighc2VsZi5zdGF0ZS5kYXRhLmxlbmd0aCl7c2VsZi5xdWlja0NyZWF0ZS50b2dnbGVGb2xkKCk7c2VsZi5fcmVuZGVyRXhhbXBsZUJhY2tncm91bmQoZnJhZ21lbnQpO319KSk7fX19LF9yZW5kZXJVbmdyb3VwZWQ6ZnVuY3Rpb24oZnJhZ21lbnQpe3ZhciBzZWxmPXRoaXM7dmFyIEthbmJhblJlY29yZD10aGlzLmNvbmZpZy5LYW5iYW5SZWNvcmQ7dmFyIGthbmJhblJlY29yZDtfLmVhY2godGhpcy5zdGF0ZS5kYXRhLGZ1bmN0aW9uKHJlY29yZCl7a2FuYmFuUmVjb3JkPW5ldyBLYW5iYW5SZWNvcmQoc2VsZixyZWNvcmQsc2VsZi5yZWNvcmRPcHRpb25zKTtzZWxmLndpZGdldHMucHVzaChrYW5iYW5SZWNvcmQpO3ZhciBkZWY9a2FuYmFuUmVjb3JkLmFwcGVuZFRvKGZyYWdtZW50KTtzZWxmLmRlZnMucHVzaChkZWYpO30pO3ZhciBvcmRlcmVkQnk9dGhpcy5zdGF0ZS5vcmRlcmVkQnk7dmFyIGhhc0hhbmRsZT10aGlzLmhhbmRsZUZpZWxkJiYob3JkZXJlZEJ5Lmxlbmd0aD09PTB8fG9yZGVyZWRCeVswXS5uYW1lPT09dGhpcy5oYW5kbGVGaWVsZCk7aWYoaGFzSGFuZGxlKXt0aGlzLiRlbC5zb3J0YWJsZSh7aXRlbXM6Jy5vX2thbmJhbl9yZWNvcmQ6bm90KC5vX2thbmJhbl9naG9zdCknLGN1cnNvcjonbW92ZScscmV2ZXJ0OjAsZGVsYXk6MCx0b2xlcmFuY2U6J3BvaW50ZXInLGZvcmNlUGxhY2Vob2xkZXJTaXplOnRydWUsc3RvcDpmdW5jdGlvbihldmVudCx1aSl7c2VsZi5fbW92ZVJlY29yZCh1aS5pdGVtLmRhdGEoJ3JlY29yZCcpLmRiX2lkLHVpLml0ZW0uaW5kZXgoKSk7fSx9KTt9CnZhciBwcm9tPVByb21pc2UuYWxsKHNlbGYuZGVmcykudGhlbihmdW5jdGlvbigpe3ZhciBvcHRpb25zPXt9O2lmKGthbmJhblJlY29yZCl7b3B0aW9ucy5pbmxpbmVTdHlsZT1rYW5iYW5SZWNvcmQuJGVsLmF0dHIoJ3N0eWxlJyk7fQpyZXR1cm4gc2VsZi5fcmVuZGVyR2hvc3REaXZzKGZyYWdtZW50LDYsb3B0aW9ucyk7fSk7dGhpcy5kZWZzLnB1c2gocHJvbSk7fSxfcmVuZGVyVmlldzpmdW5jdGlvbigpe3ZhciBzZWxmPXRoaXM7dmFyIGlzR3JvdXBlZD0hIXRoaXMuc3RhdGUuZ3JvdXBlZEJ5Lmxlbmd0aDt2YXIgZnJhZ21lbnQ9ZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO3ZhciBkZWZzPVtdO3RoaXMuZGVmcz1kZWZzO2lmKGlzR3JvdXBlZCl7dGhpcy5fcmVuZGVyR3JvdXBlZChmcmFnbWVudCk7fWVsc2V7dGhpcy5fcmVuZGVyVW5ncm91cGVkKGZyYWdtZW50KTt9CmRlbGV0ZSB0aGlzLmRlZnM7cmV0dXJuIHRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIFByb21pc2UuYWxsKGRlZnMpLnRoZW4oZnVuY3Rpb24oKXtzZWxmLiRlbC5lbXB0eSgpO3NlbGYuJGVsLnRvZ2dsZUNsYXNzKCdvX2thbmJhbl9ncm91cGVkJyxpc0dyb3VwZWQpO3NlbGYuJGVsLnRvZ2dsZUNsYXNzKCdvX2thbmJhbl91bmdyb3VwZWQnLCFpc0dyb3VwZWQpO3NlbGYuJGVsLmFwcGVuZChmcmFnbWVudCk7c2VsZi5fdG9nZ2xlTm9Db250ZW50SGVscGVyKCk7aWYoc2VsZi5faXNJbkRvbSl7Xy5pbnZva2Uoc2VsZi53aWRnZXRzLCdvbl9hdHRhY2hfY2FsbGJhY2snKTt9fSk7fSk7fSxfdG9nZ2xlTm9Db250ZW50SGVscGVyOmZ1bmN0aW9uKHJlbW92ZSl7dmFyIGRpc3BsYXlOb0NvbnRlbnRIZWxwZXI9IXJlbW92ZSYmIXRoaXMuX2hhc0NvbnRlbnQoKSYmISF0aGlzLm5vQ29udGVudEhlbHAmJiEodGhpcy5xdWlja0NyZWF0ZSYmIXRoaXMucXVpY2tDcmVhdGUuZm9sZGVkKSYmIXRoaXMuc3RhdGUuaXNHcm91cGVkQnlNMk9Ob0NvbHVtbjt2YXIgJG5vQ29udGVudEhlbHBlcj10aGlzLiQoJy5vX3ZpZXdfbm9jb250ZW50Jyk7aWYoZGlzcGxheU5vQ29udGVudEhlbHBlciYmISRub0NvbnRlbnRIZWxwZXIubGVuZ3RoKXt0aGlzLiRlbC5hcHBlbmQodGhpcy5fcmVuZGVyTm9Db250ZW50SGVscGVyKCkpO30KaWYoIWRpc3BsYXlOb0NvbnRlbnRIZWxwZXImJiRub0NvbnRlbnRIZWxwZXIubGVuZ3RoKXskbm9Db250ZW50SGVscGVyLnJlbW92ZSgpO319LF9zZXRTdGF0ZTpmdW5jdGlvbihzdGF0ZSl7dGhpcy5zdGF0ZT1zdGF0ZTt2YXIgZ3JvdXBCeUZpZWxkPXN0YXRlLmdyb3VwZWRCeVswXTt2YXIgY2xlYW5Hcm91cEJ5RmllbGQ9dGhpcy5fY2xlYW5Hcm91cEJ5RmllbGQoZ3JvdXBCeUZpZWxkKTt2YXIgZ3JvdXBCeUZpZWxkQXR0cnM9c3RhdGUuZmllbGRzW2NsZWFuR3JvdXBCeUZpZWxkXTt2YXIgZ3JvdXBCeUZpZWxkSW5mbz1zdGF0ZS5maWVsZHNJbmZvLmthbmJhbltjbGVhbkdyb3VwQnlGaWVsZF07dmFyIGRyYWdnYWJsZT10cnVlO2lmKGdyb3VwQnlGaWVsZEF0dHJzKXtpZihncm91cEJ5RmllbGRBdHRycy50eXBlPT09ImRhdGUifHxncm91cEJ5RmllbGRBdHRycy50eXBlPT09ImRhdGV0aW1lIil7ZHJhZ2dhYmxlPWZhbHNlO31lbHNlIGlmKGdyb3VwQnlGaWVsZEF0dHJzLnJlYWRvbmx5IT09dW5kZWZpbmVkKXtkcmFnZ2FibGU9IShncm91cEJ5RmllbGRBdHRycy5yZWFkb25seSk7fX0KaWYoZ3JvdXBCeUZpZWxkSW5mbyl7aWYoZHJhZ2dhYmxlJiZncm91cEJ5RmllbGRJbmZvLnJlYWRvbmx5IT09dW5kZWZpbmVkKXtkcmFnZ2FibGU9IShncm91cEJ5RmllbGRJbmZvLnJlYWRvbmx5KTt9fQp0aGlzLmdyb3VwZWRCeU0yTz1ncm91cEJ5RmllbGRBdHRycyYmKGdyb3VwQnlGaWVsZEF0dHJzLnR5cGU9PT0nbWFueTJvbmUnKTt2YXIgcmVsYXRpb249dGhpcy5ncm91cGVkQnlNMk8mJmdyb3VwQnlGaWVsZEF0dHJzLnJlbGF0aW9uO3ZhciBncm91cEJ5VG9vbHRpcD1ncm91cEJ5RmllbGRJbmZvJiZncm91cEJ5RmllbGRJbmZvLm9wdGlvbnMuZ3JvdXBfYnlfdG9vbHRpcDt0aGlzLmNvbHVtbk9wdGlvbnM9Xy5leHRlbmQodGhpcy5jb2x1bW5PcHRpb25zLHtkcmFnZ2FibGU6ZHJhZ2dhYmxlLGdyb3VwX2J5X3Rvb2x0aXA6Z3JvdXBCeVRvb2x0aXAsZ3JvdXBlZEJ5Omdyb3VwQnlGaWVsZCxncm91cGVkX2J5X20ybzp0aGlzLmdyb3VwZWRCeU0yTyxyZWxhdGlvbjpyZWxhdGlvbixxdWlja19jcmVhdGU6dGhpcy5xdWlja0NyZWF0ZUVuYWJsZWQmJnZpZXdVdGlscy5pc1F1aWNrQ3JlYXRlRW5hYmxlZChzdGF0ZSksfSk7dGhpcy5jcmVhdGVDb2x1bW5FbmFibGVkPXRoaXMuZ3JvdXBlZEJ5TTJPJiZ0aGlzLmNvbHVtbk9wdGlvbnMuZ3JvdXBfY3JlYXRhYmxlO30sX2NsZWFuR3JvdXBCeUZpZWxkOmZ1bmN0aW9uKGdyb3VwQnlGaWVsZCl7dmFyIGNsZWFuR3JvdXBCeUZpZWxkPWdyb3VwQnlGaWVsZDtpZihjbGVhbkdyb3VwQnlGaWVsZCYmY2xlYW5Hcm91cEJ5RmllbGQuaW5kZXhPZignOicpPi0xKXtjbGVhbkdyb3VwQnlGaWVsZD1jbGVhbkdyb3VwQnlGaWVsZC5zdWJzdHJpbmcoMCxjbGVhbkdyb3VwQnlGaWVsZC5pbmRleE9mKCc6JykpO30KcmV0dXJuIGNsZWFuR3JvdXBCeUZpZWxkO30sX2ZvY3VzT25DYXJkSW5Db2x1bW46ZnVuY3Rpb24oZXZlbnRUYXJnZXQsZGlyZWN0aW9uKXt2YXIgY3VycmVudENvbHVtbj1ldmVudFRhcmdldC5wYXJlbnRFbGVtZW50O3ZhciBoYXNTZWxlY3RlZEFDYXJkPWZhbHNlO3ZhciBjYW5ub3RTZWxlY3RBQ29sdW1uPWZhbHNlO3doaWxlKCFoYXNTZWxlY3RlZEFDYXJkJiYhY2Fubm90U2VsZWN0QUNvbHVtbil7dmFyIGNhbmRpZGF0ZUNvbHVtbj1kaXJlY3Rpb249PT0nTEVGVCc/Y3VycmVudENvbHVtbi5wcmV2aW91c0VsZW1lbnRTaWJsaW5nOmN1cnJlbnRDb2x1bW4ubmV4dEVsZW1lbnRTaWJsaW5nO2N1cnJlbnRDb2x1bW49Y2FuZGlkYXRlQ29sdW1uO2lmKGNhbmRpZGF0ZUNvbHVtbil7dmFyIGFsbENhcmRzT2ZDYW5kaWRhdGVDb2x1bW49Y2FuZGlkYXRlQ29sdW1uLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ29fa2FuYmFuX3JlY29yZCcpO2lmKGFsbENhcmRzT2ZDYW5kaWRhdGVDb2x1bW4ubGVuZ3RoKXthbGxDYXJkc09mQ2FuZGlkYXRlQ29sdW1uWzBdLmZvY3VzKCk7aGFzU2VsZWN0ZWRBQ2FyZD10cnVlO319CmVsc2V7ZGlyZWN0aW9uPT09J0xFRlQnP3RoaXMuX2ZvY3VzT25QcmV2aW91c0NhcmQoZXZlbnRUYXJnZXQpOnRoaXMuX2ZvY3VzT25OZXh0Q2FyZChldmVudFRhcmdldCk7Y2Fubm90U2VsZWN0QUNvbHVtbj10cnVlO319fSxfb25DbG9zZVF1aWNrQ3JlYXRlOmZ1bmN0aW9uKCl7aWYodGhpcy5zdGF0ZS5ncm91cGVkQnkubGVuZ3RoKXtfLmludm9rZSh0aGlzLndpZGdldHMsJ2NhbmNlbFF1aWNrQ3JlYXRlJyk7fQp0aGlzLl90b2dnbGVOb0NvbnRlbnRIZWxwZXIoKTt9LF9vblF1aWNrQ3JlYXRlQ29sdW1uVXBkYXRlZDpmdW5jdGlvbihldil7ZXYuc3RvcFByb3BhZ2F0aW9uKCk7dGhpcy5fdG9nZ2xlTm9Db250ZW50SGVscGVyKCk7dGhpcy5fdXBkYXRlRXhhbXBsZUJhY2tncm91bmQoKTt9LF9vblJlY29yZEtleURvd246ZnVuY3Rpb24oZSl7c3dpdGNoKGUud2hpY2gpe2Nhc2UgJC51aS5rZXlDb2RlLkRPV046dGhpcy5fZm9jdXNPbk5leHRDYXJkKGUuY3VycmVudFRhcmdldCk7ZS5zdG9wUHJvcGFnYXRpb24oKTtlLnByZXZlbnREZWZhdWx0KCk7YnJlYWs7Y2FzZSAkLnVpLmtleUNvZGUuVVA6Y29uc3QgcHJldmlvdXNGb2N1c2VkPXRoaXMuX2ZvY3VzT25QcmV2aW91c0NhcmQoZS5jdXJyZW50VGFyZ2V0KTtpZighcHJldmlvdXNGb2N1c2VkKXt0aGlzLnRyaWdnZXJfdXAoJ25hdmlnYXRpb25fbW92ZScse2RpcmVjdGlvbjondXAnfSk7fQplLnN0b3BQcm9wYWdhdGlvbigpO2UucHJldmVudERlZmF1bHQoKTticmVhaztjYXNlICQudWkua2V5Q29kZS5SSUdIVDp0aGlzLl9mb2N1c09uQ2FyZEluQ29sdW1uKGUuY3VycmVudFRhcmdldCwnUklHSFQnKTtlLnN0b3BQcm9wYWdhdGlvbigpO2UucHJldmVudERlZmF1bHQoKTticmVhaztjYXNlICQudWkua2V5Q29kZS5MRUZUOnRoaXMuX2ZvY3VzT25DYXJkSW5Db2x1bW4oZS5jdXJyZW50VGFyZ2V0LCdMRUZUJyk7ZS5zdG9wUHJvcGFnYXRpb24oKTtlLnByZXZlbnREZWZhdWx0KCk7YnJlYWs7fX0sX29uU2V0UHJvZ3Jlc3NCYXJTdGF0ZTpmdW5jdGlvbihldil7aWYoIXRoaXMuY29sdW1uT3B0aW9ucy5wcm9ncmVzc0JhclN0YXRlc1tldi5kYXRhLmNvbHVtbklEXSl7dGhpcy5jb2x1bW5PcHRpb25zLnByb2dyZXNzQmFyU3RhdGVzW2V2LmRhdGEuY29sdW1uSURdPXt9O30KXy5leHRlbmQodGhpcy5jb2x1bW5PcHRpb25zLnByb2dyZXNzQmFyU3RhdGVzW2V2LmRhdGEuY29sdW1uSURdLGV2LmRhdGEudmFsdWVzKTt9LF9vblN0YXJ0UXVpY2tDcmVhdGU6ZnVuY3Rpb24oKXt0aGlzLl90b2dnbGVOb0NvbnRlbnRIZWxwZXIodHJ1ZSk7fSxfdXBkYXRlRXhhbXBsZUJhY2tncm91bmQ6ZnVuY3Rpb24oKXt2YXIgJGVsZW09dGhpcy4kKCcub19rYW5iYW5fZXhhbXBsZV9iYWNrZ3JvdW5kX2NvbnRhaW5lcicpO2lmKCF0aGlzLnN0YXRlLmRhdGEubGVuZ3RoJiYhJGVsZW0ubGVuZ3RoKXt0aGlzLl9yZW5kZXJFeGFtcGxlQmFja2dyb3VuZCh0aGlzLiRlbCk7fWVsc2V7JGVsZW0ucmVtb3ZlKCk7fX0sfSk7cmV0dXJuIEthbmJhblJlbmRlcmVyO30pOzsKCi8qIC93ZWIvc3RhdGljL3NyYy9qcy92aWV3cy9rYW5iYW4va2FuYmFuX3JlbmRlcmVyX21vYmlsZS5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwpvZG9vLmRlZmluZSgnd2ViLkthbmJhblJlbmRlcmVyTW9iaWxlJyxmdW5jdGlvbihyZXF1aXJlKXsidXNlIHN0cmljdCI7dmFyIGNvbmZpZz1yZXF1aXJlKCd3ZWIuY29uZmlnJyk7dmFyIGNvcmU9cmVxdWlyZSgnd2ViLmNvcmUnKTt2YXIgS2FuYmFuUmVuZGVyZXI9cmVxdWlyZSgnd2ViLkthbmJhblJlbmRlcmVyJyk7dmFyIF90PWNvcmUuX3Q7dmFyIHF3ZWI9Y29yZS5xd2ViO2lmKCFjb25maWcuZGV2aWNlLmlzTW9iaWxlKXtyZXR1cm47fQpLYW5iYW5SZW5kZXJlci5pbmNsdWRlKHtldmVudHM6Xy5leHRlbmQoe30sS2FuYmFuUmVuZGVyZXIucHJvdG90eXBlLmV2ZW50cyx7J2NsaWNrIC5vX2thbmJhbl9tb2JpbGVfdGFiJzonX29uTW9iaWxlVGFiQ2xpY2tlZCcsfSksQU5JTUFURTp0cnVlLGluaXQ6ZnVuY3Rpb24oKXt0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy5hY3RpdmVDb2x1bW5JbmRleD0wO3RoaXMuX3Njcm9sbFBvc2l0aW9uPW51bGw7fSxvbl9hdHRhY2hfY2FsbGJhY2s6ZnVuY3Rpb24oKXtpZih0aGlzLl9zY3JvbGxQb3NpdGlvbiYmdGhpcy5zdGF0ZS5ncm91cGVkQnkubGVuZ3RoJiZ0aGlzLndpZGdldHMubGVuZ3RoKXt2YXIgJGNvbHVtbj10aGlzLndpZGdldHNbdGhpcy5hY3RpdmVDb2x1bW5JbmRleF0uJGVsOyRjb2x1bW4uc2Nyb2xsTGVmdCh0aGlzLl9zY3JvbGxQb3NpdGlvbi5sZWZ0KTskY29sdW1uLnNjcm9sbFRvcCh0aGlzLl9zY3JvbGxQb3NpdGlvbi50b3ApO30KdGhpcy5fY29tcHV0ZVRhYlBvc2l0aW9uKCk7dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO30sb25fZGV0YWNoX2NhbGxiYWNrOmZ1bmN0aW9uKCl7aWYodGhpcy5zdGF0ZS5ncm91cGVkQnkubGVuZ3RoJiZ0aGlzLndpZGdldHMubGVuZ3RoKXt2YXIgJGNvbHVtbj10aGlzLndpZGdldHNbdGhpcy5hY3RpdmVDb2x1bW5JbmRleF0uJGVsO3RoaXMuX3Njcm9sbFBvc2l0aW9uPXtsZWZ0OiRjb2x1bW4uc2Nyb2xsTGVmdCgpLHRvcDokY29sdW1uLnNjcm9sbFRvcCgpLH07fWVsc2V7dGhpcy5fc2Nyb2xsUG9zaXRpb249bnVsbDt9CnRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9LGFkZFF1aWNrQ3JlYXRlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMud2lkZ2V0c1t0aGlzLmFjdGl2ZUNvbHVtbkluZGV4XS5hZGRRdWlja0NyZWF0ZSgpO30sdXBkYXRlQ29sdW1uOmZ1bmN0aW9uKGxvY2FsSUQpe3ZhciBzZWxmPXRoaXM7dmFyIGluZGV4PV8uZmluZEluZGV4KHRoaXMud2lkZ2V0cyx7ZGJfaWQ6bG9jYWxJRH0pO3ZhciAkY29sdW1uPXRoaXMud2lkZ2V0c1tpbmRleF0uJGVsO3ZhciBsZWZ0PSRjb2x1bW4uY3NzKCdsZWZ0Jyk7dmFyIHJpZ2h0PSRjb2x1bW4uY3NzKCdyaWdodCcpO3ZhciBzY3JvbGxUb3A9JGNvbHVtbi5zY3JvbGxUb3AoKTtyZXR1cm4gdGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpLnRoZW4oZnVuY3Rpb24oKXskY29sdW1uPXNlbGYud2lkZ2V0c1tpbmRleF0uJGVsO2lmKF90LmRhdGFiYXNlLnBhcmFtZXRlcnMuZGlyZWN0aW9uPT09J3J0bCcpeyRjb2x1bW4uY3NzKHtyaWdodDpyaWdodH0pO31lbHNleyRjb2x1bW4uY3NzKHtsZWZ0OmxlZnR9KTt9CiRjb2x1bW4uc2Nyb2xsVG9wKHNjcm9sbFRvcCk7c2VsZi5fZW5hYmxlU3dpcGUoKTt9KTt9LF9jb21wdXRlQ29sdW1uUG9zaXRpb246ZnVuY3Rpb24oYW5pbWF0ZSl7aWYodGhpcy53aWRnZXRzLmxlbmd0aCl7dmFyIHNlbGY9dGhpczt2YXIgbW92ZVRvSW5kZXg9dGhpcy5hY3RpdmVDb2x1bW5JbmRleDt2YXIgdXBkYXRlRnVuYz1hbmltYXRlPydhbmltYXRlJzonY3NzJzt2YXIgcnRsPV90LmRhdGFiYXNlLnBhcmFtZXRlcnMuZGlyZWN0aW9uPT09J3J0bCc7Xy5lYWNoKHRoaXMud2lkZ2V0cyxmdW5jdGlvbihjb2x1bW4saW5kZXgpe3ZhciBjb2x1bW5JRD1jb2x1bW4uaWR8fGNvbHVtbi5kYl9pZDt2YXIgJGNvbHVtbj1zZWxmLiQoJy5vX2thbmJhbl9ncm91cFtkYXRhLWlkPSInK2NvbHVtbklEKyciXScpO2lmKGluZGV4PT09bW92ZVRvSW5kZXgtMSl7aWYocnRsKXskY29sdW1uW3VwZGF0ZUZ1bmNdKHtyaWdodDonLTEwMCUnfSk7fWVsc2V7JGNvbHVtblt1cGRhdGVGdW5jXSh7bGVmdDonLTEwMCUnfSk7fX1lbHNlIGlmKGluZGV4PT09bW92ZVRvSW5kZXgrMSl7aWYocnRsKXskY29sdW1uW3VwZGF0ZUZ1bmNdKHtyaWdodDonMTAwJSd9KTt9ZWxzZXskY29sdW1uW3VwZGF0ZUZ1bmNdKHtsZWZ0OicxMDAlJ30pO319ZWxzZSBpZihpbmRleD09PW1vdmVUb0luZGV4KXtpZihydGwpeyRjb2x1bW5bdXBkYXRlRnVuY10oe3JpZ2h0OicwJSd9KTt9ZWxzZXskY29sdW1uW3VwZGF0ZUZ1bmNdKHtsZWZ0OicwJSd9KTt9fWVsc2UgaWYoaW5kZXg8bW92ZVRvSW5kZXgpe2lmKHJ0bCl7JGNvbHVtbi5jc3Moe3JpZ2h0OictMTAwJSd9KTt9ZWxzZXskY29sdW1uLmNzcyh7bGVmdDonLTEwMCUnfSk7fX1lbHNlIGlmKGluZGV4Pm1vdmVUb0luZGV4KXtpZihydGwpeyRjb2x1bW4uY3NzKHtyaWdodDonMTAwJSd9KTt9ZWxzZXskY29sdW1uLmNzcyh7bGVmdDonMTAwJSd9KTt9fX0pO319LF9jb21wdXRlQ3VycmVudENvbHVtbjpmdW5jdGlvbigpe2lmKHRoaXMud2lkZ2V0cy5sZW5ndGgpe3ZhciBjb2x1bW49dGhpcy53aWRnZXRzW3RoaXMuYWN0aXZlQ29sdW1uSW5kZXhdO2lmKCFjb2x1bW4pe3JldHVybjt9CnZhciBjb2x1bW5JRD1jb2x1bW4uaWR8fGNvbHVtbi5kYl9pZDt0aGlzLiQoJy5vX2thbmJhbl9tb2JpbGVfdGFiLm9fY3VycmVudCwgLm9fa2FuYmFuX2dyb3VwLm9fY3VycmVudCcpLnJlbW92ZUNsYXNzKCdvX2N1cnJlbnQnKTt0aGlzLiQoJy5vX2thbmJhbl9ncm91cFtkYXRhLWlkPSInK2NvbHVtbklEKyciXSwgJysnLm9fa2FuYmFuX21vYmlsZV90YWJbZGF0YS1pZD0iJytjb2x1bW5JRCsnIl0nKS5hZGRDbGFzcygnb19jdXJyZW50Jyk7fX0sX2NvbXB1dGVUYWJQb3NpdGlvbjpmdW5jdGlvbigpe3RoaXMuX2NvbXB1dGVUYWJKdXN0aWZpY2F0aW9uKCk7dGhpcy5fY29tcHV0ZVRhYlNjcm9sbFBvc2l0aW9uKCk7fSxfY29tcHV0ZVRhYlNjcm9sbFBvc2l0aW9uOmZ1bmN0aW9uKCl7aWYodGhpcy53aWRnZXRzLmxlbmd0aCl7dmFyIGxhc3RJdGVtSW5kZXg9dGhpcy53aWRnZXRzLmxlbmd0aC0xO3ZhciBtb3ZlVG9JbmRleD10aGlzLmFjdGl2ZUNvbHVtbkluZGV4O3ZhciBzY3JvbGxUb0xlZnQ9MDtmb3IodmFyIGk9MDtpPG1vdmVUb0luZGV4O2krKyl7dmFyIGNvbHVtbldpZHRoPXRoaXMuX2dldFRhYldpZHRoKHRoaXMud2lkZ2V0c1tpXSk7aWYobW92ZVRvSW5kZXghPT1sYXN0SXRlbUluZGV4JiZpPT09bW92ZVRvSW5kZXgtMSl7dmFyIHBhcnRpYWxXaWR0aD0wLjc1O3Njcm9sbFRvTGVmdCs9Y29sdW1uV2lkdGgqcGFydGlhbFdpZHRoO31lbHNle3Njcm9sbFRvTGVmdCs9Y29sdW1uV2lkdGg7fX0KdGhpcy4kKCcub19rYW5iYW5fbW9iaWxlX3RhYnMnKS5zY3JvbGxMZWZ0KHNjcm9sbFRvTGVmdCk7fX0sX2NvbXB1dGVUYWJKdXN0aWZpY2F0aW9uOmZ1bmN0aW9uKCl7aWYodGhpcy53aWRnZXRzLmxlbmd0aCl7dmFyIHNlbGY9dGhpczt2YXIgd2lkdGhDaGlsZHM9dGhpcy53aWRnZXRzLnJlZHVjZShmdW5jdGlvbih0b3RhbCxjb2x1bW4pe3JldHVybiB0b3RhbCtzZWxmLl9nZXRUYWJXaWR0aChjb2x1bW4pO30sMCk7dmFyICR0YWJzPXRoaXMuJCgnLm9fa2FuYmFuX21vYmlsZV90YWJzJyk7JHRhYnMudG9nZ2xlQ2xhc3MoJ2p1c3RpZnktY29udGVudC1hcm91bmQnLCR0YWJzLm91dGVyV2lkdGgoKT49d2lkdGhDaGlsZHMpO319LF9lbmFibGVTd2lwZTpmdW5jdGlvbigpe3ZhciBzZWxmPXRoaXM7dmFyIHN0ZXA9X3QuZGF0YWJhc2UucGFyYW1ldGVycy5kaXJlY3Rpb249PT0ncnRsJz8tMToxO3RoaXMuJGVsLnN3aXBlKHtleGNsdWRlZEVsZW1lbnRzOiIub19rYW5iYW5fbW9iaWxlX3RhYnMiLHN3aXBlTGVmdDpmdW5jdGlvbigpe3ZhciBtb3ZlVG9JbmRleD1zZWxmLmFjdGl2ZUNvbHVtbkluZGV4K3N0ZXA7aWYobW92ZVRvSW5kZXg8c2VsZi53aWRnZXRzLmxlbmd0aCl7c2VsZi5fbW92ZVRvR3JvdXAobW92ZVRvSW5kZXgsc2VsZi5BTklNQVRFKTt9fSxzd2lwZVJpZ2h0OmZ1bmN0aW9uKCl7dmFyIG1vdmVUb0luZGV4PXNlbGYuYWN0aXZlQ29sdW1uSW5kZXgtc3RlcDtpZihtb3ZlVG9JbmRleD4tMSl7c2VsZi5fbW92ZVRvR3JvdXAobW92ZVRvSW5kZXgsc2VsZi5BTklNQVRFKTt9fX0pO30sX2dldFRhYldpZHRoOmZ1bmN0aW9uKGNvbHVtbil7dmFyIGNvbHVtbklEPWNvbHVtbi5pZHx8Y29sdW1uLmRiX2lkO3JldHVybiB0aGlzLiQoJy5vX2thbmJhbl9tb2JpbGVfdGFiW2RhdGEtaWQ9IicrY29sdW1uSUQrJyJdJykub3V0ZXJXaWR0aCgpO30sX2xheW91dFVwZGF0ZTpmdW5jdGlvbihhbmltYXRlKXt0aGlzLl9jb21wdXRlQ3VycmVudENvbHVtbigpO3RoaXMuX2NvbXB1dGVUYWJQb3NpdGlvbigpO3RoaXMuX2NvbXB1dGVDb2x1bW5Qb3NpdGlvbihhbmltYXRlKTt9LF9tb3ZlVG9Hcm91cDpmdW5jdGlvbihtb3ZlVG9JbmRleCxhbmltYXRlKXt2YXIgc2VsZj10aGlzO2lmKG1vdmVUb0luZGV4PDB8fG1vdmVUb0luZGV4Pj10aGlzLndpZGdldHMubGVuZ3RoKXt0aGlzLl9sYXlvdXRVcGRhdGUoYW5pbWF0ZSk7cmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO30KdGhpcy5hY3RpdmVDb2x1bW5JbmRleD1tb3ZlVG9JbmRleDt2YXIgY29sdW1uPXRoaXMud2lkZ2V0c1t0aGlzLmFjdGl2ZUNvbHVtbkluZGV4XTtyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSl7c2VsZi50cmlnZ2VyX3VwKCdrYW5iYW5fbG9hZF9yZWNvcmRzJyx7Y29sdW1uSUQ6Y29sdW1uLmRiX2lkLG9uU3VjY2VzczpmdW5jdGlvbigpe3NlbGYuX2xheW91dFVwZGF0ZShhbmltYXRlKTtyZXNvbHZlKCk7fSx9KTt9KTt9LF9yZW5kZXJHcm91cGVkOmZ1bmN0aW9uKGZyYWdtZW50KXt2YXIgc2VsZj10aGlzO3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLmRlZnMucHVzaChQcm9taXNlLmFsbCh0aGlzLmRlZnMpLnRoZW4oZnVuY3Rpb24oKXt2YXIgZGF0YT1bXTtfLmVhY2goc2VsZi5zdGF0ZS5kYXRhLGZ1bmN0aW9uKGdyb3VwKXtpZighZ3JvdXAudmFsdWUpe2dyb3VwPV8uZXh0ZW5kKHt9LGdyb3VwLHt2YWx1ZTpfdCgnVW5kZWZpbmVkJyl9KTtkYXRhLnVuc2hpZnQoZ3JvdXApO31lbHNle2RhdGEucHVzaChncm91cCk7fX0pOyQocXdlYi5yZW5kZXIoJ0thbmJhblZpZXcuTW9iaWxlVGFicycse2RhdGE6ZGF0YSx9KSkucHJlcGVuZFRvKGZyYWdtZW50KTt9KSk7fSxfcmVuZGVyVmlldzpmdW5jdGlvbigpe3ZhciBzZWxmPXRoaXM7cmV0dXJuIHRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKS50aGVuKGZ1bmN0aW9uKCl7aWYoc2VsZi5zdGF0ZS5ncm91cGVkQnkubGVuZ3RoKXtyZXR1cm4gc2VsZi5fbW92ZVRvR3JvdXAoMCk7fX0pO30sX29uTW9iaWxlVGFiQ2xpY2tlZDpmdW5jdGlvbihldmVudCl7dGhpcy5fbW92ZVRvR3JvdXAoJChldmVudC5jdXJyZW50VGFyZ2V0KS5pbmRleCgpLHRydWUpO30sfSk7fSk7OwoKLyogL3dlYi9zdGF0aWMvc3JjL2pzL3ZpZXdzL2thbmJhbi9rYW5iYW5fdmlldy5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwpvZG9vLmRlZmluZSgnd2ViLkthbmJhblZpZXcnLGZ1bmN0aW9uKHJlcXVpcmUpeyJ1c2Ugc3RyaWN0Ijt2YXIgQmFzaWNWaWV3PXJlcXVpcmUoJ3dlYi5CYXNpY1ZpZXcnKTt2YXIgY29uZmlnPXJlcXVpcmUoJ3dlYi5jb25maWcnKTt2YXIgY29yZT1yZXF1aXJlKCd3ZWIuY29yZScpO3ZhciBLYW5iYW5Db250cm9sbGVyPXJlcXVpcmUoJ3dlYi5LYW5iYW5Db250cm9sbGVyJyk7dmFyIGthbmJhbkV4YW1wbGVzUmVnaXN0cnk9cmVxdWlyZSgnd2ViLmthbmJhbl9leGFtcGxlc19yZWdpc3RyeScpO3ZhciBLYW5iYW5Nb2RlbD1yZXF1aXJlKCd3ZWIuS2FuYmFuTW9kZWwnKTt2YXIgS2FuYmFuUmVuZGVyZXI9cmVxdWlyZSgnd2ViLkthbmJhblJlbmRlcmVyJyk7dmFyIHV0aWxzPXJlcXVpcmUoJ3dlYi51dGlscycpO3ZhciBfbHQ9Y29yZS5fbHQ7dmFyIEthbmJhblZpZXc9QmFzaWNWaWV3LmV4dGVuZCh7YWNjZXNza2V5OiJrIixkaXNwbGF5X25hbWU6X2x0KCJLYW5iYW4iKSxpY29uOidmYS10aC1sYXJnZScsbW9iaWxlX2ZyaWVuZGx5OnRydWUsY29uZmlnOl8uZXh0ZW5kKHt9LEJhc2ljVmlldy5wcm90b3R5cGUuY29uZmlnLHtNb2RlbDpLYW5iYW5Nb2RlbCxDb250cm9sbGVyOkthbmJhbkNvbnRyb2xsZXIsUmVuZGVyZXI6S2FuYmFuUmVuZGVyZXIsfSksanNMaWJzOltdLHZpZXdUeXBlOidrYW5iYW4nLGluaXQ6ZnVuY3Rpb24odmlld0luZm8scGFyYW1zKXt0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy5sb2FkUGFyYW1zLmxpbWl0PXRoaXMubG9hZFBhcmFtcy5saW1pdHx8NDA7dGhpcy5sb2FkUGFyYW1zLm9wZW5Hcm91cEJ5RGVmYXVsdD1jb25maWcuZGV2aWNlLmlzTW9iaWxlP2ZhbHNlOnRydWU7dGhpcy5sb2FkUGFyYW1zLnR5cGU9J2xpc3QnO3RoaXMubm9EZWZhdWx0R3JvdXBieT1wYXJhbXMubm9EZWZhdWx0R3JvdXBieTt2YXIgcHJvZ3Jlc3NCYXI7dXRpbHMudHJhdmVyc2UodGhpcy5hcmNoLGZ1bmN0aW9uKG4pe3ZhciBpc1Byb2dyZXNzQmFyPShuLnRhZz09PSdwcm9ncmVzc2JhcicpO2lmKGlzUHJvZ3Jlc3NCYXIpe3Byb2dyZXNzQmFyPV8uY2xvbmUobi5hdHRycyk7cHJvZ3Jlc3NCYXIuY29sb3JzPUpTT04ucGFyc2UocHJvZ3Jlc3NCYXIuY29sb3JzKTtwcm9ncmVzc0Jhci5zdW1fZmllbGQ9cHJvZ3Jlc3NCYXIuc3VtX2ZpZWxkfHxmYWxzZTt9CnJldHVybiFpc1Byb2dyZXNzQmFyO30pO2lmKHByb2dyZXNzQmFyKXt0aGlzLmxvYWRQYXJhbXMucHJvZ3Jlc3NCYXI9cHJvZ3Jlc3NCYXI7fQp2YXIgYWN0aXZlQWN0aW9ucz10aGlzLmNvbnRyb2xsZXJQYXJhbXMuYWN0aXZlQWN0aW9uczt2YXIgYXJjaEF0dHJzPXRoaXMuYXJjaC5hdHRyczthY3RpdmVBY3Rpb25zPV8uZXh0ZW5kKGFjdGl2ZUFjdGlvbnMse2dyb3VwX2NyZWF0ZTp0aGlzLmFyY2guYXR0cnMuZ3JvdXBfY3JlYXRlPyEhSlNPTi5wYXJzZShhcmNoQXR0cnMuZ3JvdXBfY3JlYXRlKTp0cnVlLGdyb3VwX2VkaXQ6YXJjaEF0dHJzLmdyb3VwX2VkaXQ/ISFKU09OLnBhcnNlKGFyY2hBdHRycy5ncm91cF9lZGl0KTp0cnVlLGdyb3VwX2RlbGV0ZTphcmNoQXR0cnMuZ3JvdXBfZGVsZXRlPyEhSlNPTi5wYXJzZShhcmNoQXR0cnMuZ3JvdXBfZGVsZXRlKTp0cnVlLH0pO3RoaXMucmVuZGVyZXJQYXJhbXMuY29sdW1uX29wdGlvbnM9e2VkaXRhYmxlOmFjdGl2ZUFjdGlvbnMuZ3JvdXBfZWRpdCxkZWxldGFibGU6YWN0aXZlQWN0aW9ucy5ncm91cF9kZWxldGUsYXJjaGl2YWJsZTphcmNoQXR0cnMuYXJjaGl2YWJsZT8hIUpTT04ucGFyc2UoYXJjaEF0dHJzLmFyY2hpdmFibGUpOnRydWUsZ3JvdXBfY3JlYXRhYmxlOmFjdGl2ZUFjdGlvbnMuZ3JvdXBfY3JlYXRlJiYhY29uZmlnLmRldmljZS5pc01vYmlsZSxxdWlja0NyZWF0ZVZpZXc6YXJjaEF0dHJzLnF1aWNrX2NyZWF0ZV92aWV3fHxudWxsLHJlY29yZHNEcmFnZ2FibGU6YXJjaEF0dHJzLnJlY29yZHNfZHJhZ2dhYmxlPyEhSlNPTi5wYXJzZShhcmNoQXR0cnMucmVjb3Jkc19kcmFnZ2FibGUpOnRydWUsaGFzUHJvZ3Jlc3NCYXI6ISFwcm9ncmVzc0Jhcix9O3RoaXMucmVuZGVyZXJQYXJhbXMucmVjb3JkX29wdGlvbnM9e2VkaXRhYmxlOmFjdGl2ZUFjdGlvbnMuZWRpdCxkZWxldGFibGU6YWN0aXZlQWN0aW9ucy5kZWxldGUscmVhZF9vbmx5X21vZGU6cGFyYW1zLnJlYWRPbmx5TW9kZSxzZWxlY3Rpb25Nb2RlOnBhcmFtcy5zZWxlY3Rpb25Nb2RlLH07dGhpcy5yZW5kZXJlclBhcmFtcy5xdWlja0NyZWF0ZUVuYWJsZWQ9dGhpcy5faXNRdWlja0NyZWF0ZUVuYWJsZWQoKTt0aGlzLnJlbmRlcmVyUGFyYW1zLnJlYWRPbmx5TW9kZT1wYXJhbXMucmVhZE9ubHlNb2RlO3ZhciBleGFtcGxlcz1hcmNoQXR0cnMuZXhhbXBsZXM7aWYoZXhhbXBsZXMpe3RoaXMucmVuZGVyZXJQYXJhbXMuZXhhbXBsZXM9a2FuYmFuRXhhbXBsZXNSZWdpc3RyeS5nZXQoZXhhbXBsZXMpO30KdGhpcy5jb250cm9sbGVyUGFyYW1zLm9uX2NyZWF0ZT1hcmNoQXR0cnMub25fY3JlYXRlO3RoaXMuY29udHJvbGxlclBhcmFtcy5oYXNCdXR0b25zPSFwYXJhbXMuc2VsZWN0aW9uTW9kZT90cnVlOmZhbHNlO3RoaXMuY29udHJvbGxlclBhcmFtcy5xdWlja0NyZWF0ZUVuYWJsZWQ9dGhpcy5yZW5kZXJlclBhcmFtcy5xdWlja0NyZWF0ZUVuYWJsZWQ7aWYoY29uZmlnLmRldmljZS5pc01vYmlsZSl7dGhpcy5qc0xpYnMucHVzaCgnL3dlYi9zdGF0aWMvbGliL2pxdWVyeS50b3VjaFN3aXBlL2pxdWVyeS50b3VjaFN3aXBlLmpzJyk7fX0sX2lzUXVpY2tDcmVhdGVFbmFibGVkOmZ1bmN0aW9uKCl7aWYoIXRoaXMuY29udHJvbGxlclBhcmFtcy5hY3RpdmVBY3Rpb25zLmNyZWF0ZSl7cmV0dXJuIGZhbHNlO30KaWYodGhpcy5hcmNoLmF0dHJzLnF1aWNrX2NyZWF0ZSE9PXVuZGVmaW5lZCl7cmV0dXJuISFKU09OLnBhcnNlKHRoaXMuYXJjaC5hdHRycy5xdWlja19jcmVhdGUpO30KcmV0dXJuIHRydWU7fSxfdXBkYXRlTVZDUGFyYW1zOmZ1bmN0aW9uKCl7dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO2lmKCF0aGlzLm5vRGVmYXVsdEdyb3VwYnkpe3ZhciBkZWZhdWx0R3JvdXBCeT10aGlzLmFyY2guYXR0cnMuZGVmYXVsdF9ncm91cF9ieTt0aGlzLmxvYWRQYXJhbXMuZ3JvdXBCeT1kZWZhdWx0R3JvdXBCeT9bZGVmYXVsdEdyb3VwQnldOih0aGlzLmxvYWRQYXJhbXMuZ3JvdXBlZEJ5fHxbXSk7fX0sfSk7cmV0dXJuIEthbmJhblZpZXc7fSk7OwoKLyogL3dlYi9zdGF0aWMvc3JjL2pzL3ZpZXdzL2thbmJhbi9xdWlja19jcmVhdGVfZm9ybV92aWV3LmpzIGRlZmluZWQgaW4gYnVuZGxlICd3ZWIuYXNzZXRzX2JhY2tlbmQnICovCm9kb28uZGVmaW5lKCd3ZWIuUXVpY2tDcmVhdGVGb3JtVmlldycsZnVuY3Rpb24ocmVxdWlyZSl7InVzZSBzdHJpY3QiO3ZhciBCYXNpY01vZGVsPXJlcXVpcmUoJ3dlYi5CYXNpY01vZGVsJyk7dmFyIEZvcm1Db250cm9sbGVyPXJlcXVpcmUoJ3dlYi5Gb3JtQ29udHJvbGxlcicpO3ZhciBGb3JtUmVuZGVyZXI9cmVxdWlyZSgnd2ViLkZvcm1SZW5kZXJlcicpO3ZhciBGb3JtVmlldz1yZXF1aXJlKCd3ZWIuRm9ybVZpZXcnKTt2YXIgUXVpY2tDcmVhdGVGb3JtUmVuZGVyZXI9Rm9ybVJlbmRlcmVyLmV4dGVuZCh7c3RhcnQ6ZnVuY3Rpb24oKXt0aGlzLiRlbC5hZGRDbGFzcygnb194eHNfZm9ybV92aWV3Jyk7cmV0dXJuIHRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9LF9vbk5hdmlnYXRpb25Nb3ZlOmZ1bmN0aW9uKGV2KXt2YXIgZGlyZWN0aW9uPWV2LmRhdGEuZGlyZWN0aW9uO2lmKGRpcmVjdGlvbj09PSdjYW5jZWwnfHxkaXJlY3Rpb249PT0nbmV4dF9saW5lJyl7ZXYuc3RvcFByb3BhZ2F0aW9uKCk7dGhpcy50cmlnZ2VyX3VwKGRpcmVjdGlvbj09PSdjYW5jZWwnPydjYW5jZWwnOidhZGQnKTt9ZWxzZXt0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fX0sfSk7dmFyIFF1aWNrQ3JlYXRlRm9ybU1vZGVsPUJhc2ljTW9kZWwuZXh0ZW5kKHtnZXRDaGFuZ2VzOmZ1bmN0aW9uKGxvY2FsSUQpe3ZhciByZWNvcmQ9dGhpcy5sb2NhbERhdGFbbG9jYWxJRF07cmV0dXJuIHRoaXMuX2dlbmVyYXRlQ2hhbmdlcyhyZWNvcmQse2NoYW5nZXNPbmx5OmZhbHNlfSk7fSx9KTt2YXIgUXVpY2tDcmVhdGVGb3JtQ29udHJvbGxlcj1Gb3JtQ29udHJvbGxlci5leHRlbmQoe2NvbW1pdENoYW5nZXM6ZnVuY3Rpb24oKXt2YXIgbXV0ZXhEZWY9dGhpcy5tdXRleC5nZXRVbmxvY2tlZERlZigpO3JldHVybiBQcm9taXNlLmFsbChbbXV0ZXhEZWYsdGhpcy5yZW5kZXJlci5jb21taXRDaGFuZ2VzKHRoaXMuaGFuZGxlKV0pO30sZ2V0Q2hhbmdlczpmdW5jdGlvbigpe3JldHVybiB0aGlzLm1vZGVsLmdldENoYW5nZXModGhpcy5oYW5kbGUpO30sfSk7dmFyIFF1aWNrQ3JlYXRlRm9ybVZpZXc9Rm9ybVZpZXcuZXh0ZW5kKHt3aXRoQ29udHJvbFBhbmVsOmZhbHNlLGNvbmZpZzpfLmV4dGVuZCh7fSxGb3JtVmlldy5wcm90b3R5cGUuY29uZmlnLHtNb2RlbDpRdWlja0NyZWF0ZUZvcm1Nb2RlbCxSZW5kZXJlcjpRdWlja0NyZWF0ZUZvcm1SZW5kZXJlcixDb250cm9sbGVyOlF1aWNrQ3JlYXRlRm9ybUNvbnRyb2xsZXIsfSksfSk7cmV0dXJuIFF1aWNrQ3JlYXRlRm9ybVZpZXc7fSk7OwoKLyogL3dlYi9zdGF0aWMvc3JjL2pzL3ZpZXdzL2xpc3QvbGlzdF9lZGl0YWJsZV9yZW5kZXJlci5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwpvZG9vLmRlZmluZSgnd2ViLkVkaXRhYmxlTGlzdFJlbmRlcmVyJyxmdW5jdGlvbihyZXF1aXJlKXsidXNlIHN0cmljdCI7dmFyIGNvcmU9cmVxdWlyZSgnd2ViLmNvcmUnKTt2YXIgZG9tPXJlcXVpcmUoJ3dlYi5kb20nKTt2YXIgTGlzdFJlbmRlcmVyPXJlcXVpcmUoJ3dlYi5MaXN0UmVuZGVyZXInKTt2YXIgdXRpbHM9cmVxdWlyZSgnd2ViLnV0aWxzJyk7dmFyIF90PWNvcmUuX3Q7TGlzdFJlbmRlcmVyLmluY2x1ZGUoe1JFU0laRV9ERUxBWToyMDAsY3VzdG9tX2V2ZW50czpfLmV4dGVuZCh7fSxMaXN0UmVuZGVyZXIucHJvdG90eXBlLmN1c3RvbV9ldmVudHMse25hdmlnYXRpb25fbW92ZTonX29uTmF2aWdhdGlvbk1vdmUnLH0pLGV2ZW50czpfLmV4dGVuZCh7fSxMaXN0UmVuZGVyZXIucHJvdG90eXBlLmV2ZW50cyx7J2NsaWNrIC5vX2ZpZWxkX3gybWFueV9saXN0X3Jvd19hZGQgYSc6J19vbkFkZFJlY29yZCcsJ2NsaWNrIC5vX2dyb3VwX2ZpZWxkX3Jvd19hZGQgYSc6J19vbkFkZFJlY29yZFRvR3JvdXAnLCdrZXlkb3duIC5vX2ZpZWxkX3gybWFueV9saXN0X3Jvd19hZGQgYSc6J19vbktleURvd25BZGRSZWNvcmQnLCdjbGljayB0Ym9keSB0ZC5vX2RhdGFfY2VsbCc6J19vbkNlbGxDbGljaycsJ2NsaWNrIHRib2R5IHRyOm5vdCgub19kYXRhX3JvdyknOidfb25FbXB0eVJvd0NsaWNrJywnY2xpY2sgdGZvb3QnOidfb25Gb290ZXJDbGljaycsJ2NsaWNrIHRyIC5vX2xpc3RfcmVjb3JkX3JlbW92ZSc6J19vblJlbW92ZUljb25DbGljaycsfSksaW5pdDpmdW5jdGlvbihwYXJlbnQsc3RhdGUscGFyYW1zKXt2YXIgc2VsZj10aGlzO3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLmVkaXRhYmxlPXBhcmFtcy5lZGl0YWJsZTt0aGlzLmlzTXVsdGlFZGl0YWJsZT1wYXJhbXMuaXNNdWx0aUVkaXRhYmxlO3RoaXMuY29sdW1uV2lkdGhzPWZhbHNlO3RoaXMuYWRkQ3JlYXRlTGluZT1wYXJhbXMuYWRkQ3JlYXRlTGluZTt0aGlzLmFkZENyZWF0ZUxpbmVJbkdyb3Vwcz1wYXJhbXMuYWRkQ3JlYXRlTGluZUluR3JvdXBzO2lmKHRoaXMuYWRkQ3JlYXRlTGluZSl7dGhpcy5jcmVhdGVzPVtdO18uZWFjaCh0aGlzLmFyY2guY2hpbGRyZW4sZnVuY3Rpb24oY2hpbGQpe2lmKGNoaWxkLnRhZyE9PSdjb250cm9sJyl7cmV0dXJuO30KXy5lYWNoKGNoaWxkLmNoaWxkcmVuLGZ1bmN0aW9uKGNoaWxkKXtpZihjaGlsZC50YWchPT0nY3JlYXRlJ3x8Y2hpbGQuYXR0cnMuaW52aXNpYmxlKXtyZXR1cm47fQpzZWxmLmNyZWF0ZXMucHVzaCh7Y29udGV4dDpjaGlsZC5hdHRycy5jb250ZXh0LHN0cmluZzpjaGlsZC5hdHRycy5zdHJpbmcsfSk7fSk7fSk7aWYodGhpcy5jcmVhdGVzLmxlbmd0aD09PTApe3RoaXMuY3JlYXRlcy5wdXNoKHtzdHJpbmc6X3QoIkFkZCBhIGxpbmUiKSx9KTt9fQp0aGlzLmFkZFRyYXNoSWNvbj1wYXJhbXMuYWRkVHJhc2hJY29uO3RoaXMuaXNNYW55Mk1hbnk9cGFyYW1zLmlzTWFueTJNYW55O3RoaXMuY3VycmVudFJvdz1udWxsO3RoaXMuY3VycmVudEZpZWxkSW5kZXg9bnVsbDt0aGlzLmlzUmVzaXppbmc9ZmFsc2U7dGhpcy5ldmVudExpc3RlbmVycz1bXTt9LHN0YXJ0OmZ1bmN0aW9uKCl7Y29yZS5idXMub24oJ2NsaWNrJyx0aGlzLHRoaXMuX29uV2luZG93Q2xpY2tlZC5iaW5kKHRoaXMpKTtjb3JlLmJ1cy5vbigncmVzaXplJyx0aGlzLF8uZGVib3VuY2UodGhpcy5fb25SZXNpemUuYmluZCh0aGlzKSx0aGlzLlJFU0laRV9ERUxBWSkpO3JldHVybiB0aGlzLl9zdXBlcigpO30sZGVzdHJveTpmdW5jdGlvbigpe3RoaXMuZXZlbnRMaXN0ZW5lcnMuZm9yRWFjaChsaXN0ZW5lcj0+e2NvbnN0e3R5cGUsZWwsY2FsbGJhY2ssb3B0aW9uc309bGlzdGVuZXI7ZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcih0eXBlLGNhbGxiYWNrLG9wdGlvbnMpO30pO3JldHVybiB0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fSxvbl9hdHRhY2hfY2FsbGJhY2s6ZnVuY3Rpb24oKXt0aGlzLmlzSW5ET009dHJ1ZTt0aGlzLl9mcmVlemVDb2x1bW5XaWR0aHMoKTt0aGlzLl9zdXBlcigpO30sb25fZGV0YWNoX2NhbGxiYWNrOmZ1bmN0aW9uKCl7dGhpcy5pc0luRE9NPWZhbHNlO3RoaXMuX3N1cGVyKCk7fSxjYW5CZVNhdmVkOmZ1bmN0aW9uKHJlY29yZElEKXtpZigocmVjb3JkSUR8fHRoaXMuc3RhdGUuaWQpPT09dGhpcy5zdGF0ZS5pZCl7cmVjb3JkSUQ9dGhpcy5nZXRFZGl0YWJsZVJlY29yZElEKCk7aWYocmVjb3JkSUQ9PT1udWxsKXtyZXR1cm5bXTt9fQp2YXIgZmllbGROYW1lcz10aGlzLl9zdXBlcihyZWNvcmRJRCk7dGhpcy4kKCcub19zZWxlY3RlZF9yb3cgLm9fZGF0YV9jZWxsJykucmVtb3ZlQ2xhc3MoJ29faW52YWxpZF9jZWxsJyk7dGhpcy4kKCcub19zZWxlY3RlZF9yb3cgLm9fZGF0YV9jZWxsOmhhcyg+IC5vX2ZpZWxkX2ludmFsaWQpJykuYWRkQ2xhc3MoJ29faW52YWxpZF9jZWxsJyk7cmV0dXJuIGZpZWxkTmFtZXM7fSxjb25maXJtQ2hhbmdlOmZ1bmN0aW9uKHN0YXRlLHJlY29yZElEKXt2YXIgc2VsZj10aGlzO3JldHVybiB0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cykudGhlbihmdW5jdGlvbih3aWRnZXRzKXtpZih3aWRnZXRzLmxlbmd0aCl7dmFyICRyb3c9c2VsZi5fZ2V0Um93KHJlY29yZElEKTt2YXIgcmVjb3JkPXNlbGYuX2dldFJlY29yZChyZWNvcmRJRCk7c2VsZi5fc2V0RGVjb3JhdGlvbkNsYXNzZXMocmVjb3JkLCRyb3cpO3NlbGYuX3VwZGF0ZUZvb3RlcigpO30KcmV0dXJuIHdpZGdldHM7fSk7fSxjb25maXJtVXBkYXRlOmZ1bmN0aW9uKHN0YXRlLGlkLGZpZWxkcyxldil7dmFyIHNlbGY9dGhpczt2YXIgb2xkRGF0YT10aGlzLnN0YXRlLmRhdGE7dGhpcy5zdGF0ZT1zdGF0ZTtyZXR1cm4gdGhpcy5jb25maXJtQ2hhbmdlKHN0YXRlLGlkLGZpZWxkcyxldikudGhlbihmdW5jdGlvbigpe3ZhciByZWNvcmQ9c2VsZi5fZ2V0UmVjb3JkKGlkKTtpZighcmVjb3JkKXtyZXR1cm47fQpfLmVhY2gob2xkRGF0YSxmdW5jdGlvbihyZWMpe2lmKHJlYy5pZCE9PWlkKXtzZWxmLl9kZXN0cm95RmllbGRXaWRnZXRzKHJlYy5pZCk7fX0pO3NlbGYuZGVmcz1bXTt2YXIgJG5ld0JvZHk9c2VsZi5fcmVuZGVyQm9keSgpO3ZhciBkZWZzPXNlbGYuZGVmcztkZWxldGUgc2VsZi5kZWZzO3JldHVybiBQcm9taXNlLmFsbChkZWZzKS50aGVuKGZ1bmN0aW9uKCl7Xy5lYWNoKHNlbGYuY29sdW1ucyxmdW5jdGlvbihub2RlKXtzZWxmLl9yZWdpc3Rlck1vZGlmaWVycyhub2RlLHJlY29yZCxudWxsLHttb2RlOidlZGl0J30pO30pO3ZhciBjdXJyZW50Um93SUQ7dmFyIGN1cnJlbnRXaWRnZXQ7dmFyIGZvY3VzZWRFbGVtZW50O3ZhciBzZWxlY3Rpb25SYW5nZTtpZihzZWxmLmN1cnJlbnRSb3chPT1udWxsKXtjdXJyZW50Um93SUQ9c2VsZi5fZ2V0UmVjb3JkSUQoc2VsZi5jdXJyZW50Um93KTtjdXJyZW50V2lkZ2V0PXNlbGYuYWxsRmllbGRXaWRnZXRzW2N1cnJlbnRSb3dJRF1bc2VsZi5jdXJyZW50RmllbGRJbmRleF07aWYoY3VycmVudFdpZGdldCl7Zm9jdXNlZEVsZW1lbnQ9Y3VycmVudFdpZGdldC5nZXRGb2N1c2FibGVFbGVtZW50KCkuZ2V0KDApO2lmKGN1cnJlbnRXaWRnZXQuZm9ybWF0VHlwZSE9PSdib29sZWFuJyl7c2VsZWN0aW9uUmFuZ2U9ZG9tLmdldFNlbGVjdGlvblJhbmdlKGZvY3VzZWRFbGVtZW50KTt9fX0KdmFyICRlZGl0ZWRSb3c9c2VsZi5fZ2V0Um93KGlkKTskZWRpdGVkUm93Lm5leHRBbGwoJy5vX2RhdGFfcm93JykucmVtb3ZlKCk7JGVkaXRlZFJvdy5wcmV2QWxsKCcub19kYXRhX3JvdycpLnJlbW92ZSgpO3ZhciAkbmV3Um93PSRuZXdCb2R5LmZpbmQoJy5vX2RhdGFfcm93W2RhdGEtaWQ9IicraWQrJyJdJyk7JG5ld1Jvdy5wcmV2QWxsKCcub19kYXRhX3JvdycpLmdldCgpLnJldmVyc2UoKS5mb3JFYWNoKGZ1bmN0aW9uKHJvdyl7JChyb3cpLmluc2VydEJlZm9yZSgkZWRpdGVkUm93KTt9KTskbmV3Um93Lm5leHRBbGwoJy5vX2RhdGFfcm93JykuZ2V0KCkucmV2ZXJzZSgpLmZvckVhY2goZnVuY3Rpb24ocm93KXskKHJvdykuaW5zZXJ0QWZ0ZXIoJGVkaXRlZFJvdyk7fSk7aWYoc2VsZi5jdXJyZW50Um93IT09bnVsbCl7dmFyIG5ld1Jvd0luZGV4PSRlZGl0ZWRSb3cucHJvcCgncm93SW5kZXgnKS0xO3NlbGYuY3VycmVudFJvdz1uZXdSb3dJbmRleDtyZXR1cm4gc2VsZi5fc2VsZWN0Q2VsbChuZXdSb3dJbmRleCxzZWxmLmN1cnJlbnRGaWVsZEluZGV4LHtmb3JjZTp0cnVlfSkudGhlbihmdW5jdGlvbigpe2N1cnJlbnRXaWRnZXQ9c2VsZi5hbGxGaWVsZFdpZGdldHNbY3VycmVudFJvd0lEXVtzZWxmLmN1cnJlbnRGaWVsZEluZGV4XTtpZihjdXJyZW50V2lkZ2V0KXtmb2N1c2VkRWxlbWVudD1jdXJyZW50V2lkZ2V0LmdldEZvY3VzYWJsZUVsZW1lbnQoKS5nZXQoMCk7aWYoc2VsZWN0aW9uUmFuZ2Upe2RvbS5zZXRTZWxlY3Rpb25SYW5nZShmb2N1c2VkRWxlbWVudCxzZWxlY3Rpb25SYW5nZSk7fX19KTt9fSk7fSk7fSxlZGl0Rmlyc3RSZWNvcmQ6ZnVuY3Rpb24oZXYpe2NvbnN0ICRib3JkZXJSb3c9dGhpcy5fZ2V0Qm9yZGVyUm93KGV2LmRhdGEuc2lkZXx8J2ZpcnN0Jyk7dGhpcy5fc2VsZWN0Q2VsbCgkYm9yZGVyUm93LnByb3AoJ3Jvd0luZGV4JyktMSxldi5kYXRhLmNlbGxJbmRleHx8MCk7fSxlZGl0UmVjb3JkOmZ1bmN0aW9uKHJlY29yZElEKXt2YXIgJHJvdz10aGlzLl9nZXRSb3cocmVjb3JkSUQpO3ZhciByb3dJbmRleD0kcm93LnByb3AoJ3Jvd0luZGV4JyktMTt0aGlzLl9zZWxlY3RDZWxsKHJvd0luZGV4LDApO30sZm9jdXNDZWxsOmZ1bmN0aW9uKHJlY29yZElkLGNvbHVtbil7dmFyICRyb3c9dGhpcy5fZ2V0Um93KHJlY29yZElkKTt2YXIgY2VsbEluZGV4PXRoaXMuY29sdW1ucy5pbmRleE9mKGNvbHVtbik7JHJvdy5maW5kKCcub19kYXRhX2NlbGwnKVtjZWxsSW5kZXhdLmZvY3VzKCk7fSxnZXRFZGl0YWJsZVJlY29yZElEOmZ1bmN0aW9uKCl7aWYodGhpcy5jdXJyZW50Um93IT09bnVsbCl7cmV0dXJuIHRoaXMuX2dldFJlY29yZElEKHRoaXMuY3VycmVudFJvdyk7fQpyZXR1cm4gbnVsbDt9LGlzSW5NdWx0aXBsZVJlY29yZEVkaXRpb246ZnVuY3Rpb24ocmVjb3JkSWQpe3JldHVybiB0aGlzLmlzRWRpdGFibGUoKSYmdGhpcy5pc011bHRpRWRpdGFibGUmJnRoaXMuc2VsZWN0aW9uLmluY2x1ZGVzKHJlY29yZElkKTt9LGlzRWRpdGFibGU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lZGl0YWJsZXx8KHRoaXMuaXNNdWx0aUVkaXRhYmxlJiZ0aGlzLnNlbGVjdGlvbi5sZW5ndGgpO30scmVtb3ZlTGluZTpmdW5jdGlvbihzdGF0ZSxyZWNvcmRJRCl7dGhpcy5zdGF0ZT1zdGF0ZTt2YXIgJHJvdz10aGlzLl9nZXRSb3cocmVjb3JkSUQpO2lmKCRyb3cubGVuZ3RoPT09MCl7cmV0dXJuO30KaWYoJHJvdy5wcm9wKCdyb3dJbmRleCcpLTE9PT10aGlzLmN1cnJlbnRSb3cpe3RoaXMuY3VycmVudFJvdz1udWxsO3RoaXMuX2VuYWJsZVJlY29yZFNlbGVjdG9ycygpO30KdGhpcy5fZGVzdHJveUZpZWxkV2lkZ2V0cyhyZWNvcmRJRCk7aWYodGhpcy5zdGF0ZS5jb3VudD49NCl7JHJvdy5yZW1vdmUoKTt9ZWxzZXt2YXIgJGVtcHR5Um93PXRoaXMuX3JlbmRlckVtcHR5Um93KCk7JHJvdy5yZXBsYWNlV2l0aCgkZW1wdHlSb3cpO2lmKHRoaXMuZWRpdGFibGU9PT0idG9wIil7dmFyICRsYXN0RGF0YVJvdz10aGlzLiQoJy5vX2RhdGFfcm93Omxhc3QnKTtpZigkbGFzdERhdGFSb3cubGVuZ3RoKXskZW1wdHlSb3cuaW5zZXJ0QWZ0ZXIoJGxhc3REYXRhUm93KTt9fX19LHNldFJvd01vZGU6ZnVuY3Rpb24ocmVjb3JkSUQsbW9kZSl7dmFyIHNlbGY9dGhpczt2YXIgcmVjb3JkPXNlbGYuX2dldFJlY29yZChyZWNvcmRJRCk7aWYoIXJlY29yZCl7cmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO30KdmFyIGVkaXRNb2RlPShtb2RlPT09J2VkaXQnKTt2YXIgJHJvdz10aGlzLl9nZXRSb3cocmVjb3JkSUQpO3RoaXMuY3VycmVudFJvdz1lZGl0TW9kZT8kcm93LnByb3AoJ3Jvd0luZGV4JyktMTpudWxsO3ZhciAkdGRzPSRyb3cuY2hpbGRyZW4oJy5vX2RhdGFfY2VsbCcpO3ZhciBvbGRXaWRnZXRzPV8uY2xvbmUodGhpcy5hbGxGaWVsZFdpZGdldHNbcmVjb3JkLmlkXSk7dmFyIG9wdGlvbnM9e3JlbmRlckludmlzaWJsZTplZGl0TW9kZSxyZW5kZXJXaWRnZXRzOmVkaXRNb2RlLH07b3B0aW9ucy5tb2RlPWVkaXRNb2RlPydlZGl0JzoncmVhZG9ubHknO3ZhciBkZWZzPVtdO3RoaXMuZGVmcz1kZWZzO18uZWFjaCh0aGlzLmNvbHVtbnMsZnVuY3Rpb24obm9kZSxjb2xJbmRleCl7dmFyICR0ZD0kdGRzLmVxKGNvbEluZGV4KTt2YXIgJG5ld1RkPXNlbGYuX3JlbmRlckJvZHlDZWxsKHJlY29yZCxub2RlLGNvbEluZGV4LG9wdGlvbnMpO2lmKCR0ZC5oYXNDbGFzcygnb19saXN0X2J1dHRvbicpKXtzZWxmLl91bnJlZ2lzdGVyTW9kaWZpZXJzRWxlbWVudChub2RlLHJlY29yZElELCR0ZC5jaGlsZHJlbigpKTt9CmlmKGVkaXRNb2RlKXskdGQuZW1wdHkoKS5hcHBlbmQoJG5ld1RkLmNvbnRlbnRzKCkpO31lbHNle3NlbGYuX3VucmVnaXN0ZXJNb2RpZmllcnNFbGVtZW50KG5vZGUscmVjb3JkSUQsJHRkKTskdGQucmVwbGFjZVdpdGgoJG5ld1RkKTt9fSk7ZGVsZXRlIHRoaXMuZGVmcztfLmVhY2gob2xkV2lkZ2V0cyx0aGlzLl9kZXN0cm95RmllbGRXaWRnZXQuYmluZCh0aGlzLHJlY29yZElEKSk7JHJvdy50b2dnbGVDbGFzcygnb19zZWxlY3RlZF9yb3cnLGVkaXRNb2RlKTtpZihlZGl0TW9kZSl7dGhpcy5fZGlzYWJsZVJlY29yZFNlbGVjdG9ycygpO31lbHNle3RoaXMuX2VuYWJsZVJlY29yZFNlbGVjdG9ycygpO30KcmV0dXJuIFByb21pc2UuYWxsKGRlZnMpLnRoZW4oZnVuY3Rpb24oKXtjb3JlLmJ1cy50cmlnZ2VyKCdET01fdXBkYXRlZCcpO30pO30sdW5zZWxlY3RSb3c6ZnVuY3Rpb24oKXtpZih0aGlzLmN1cnJlbnRSb3c9PT1udWxsKXtyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7fQp2YXIgcmVjb3JkSUQ9dGhpcy5fZ2V0UmVjb3JkSUQodGhpcy5jdXJyZW50Um93KTt2YXIgcmVjb3JkV2lkZ2V0cz10aGlzLmFsbEZpZWxkV2lkZ2V0c1tyZWNvcmRJRF07ZnVuY3Rpb24gdG9nZ2xlV2lkZ2V0cyhkaXNhYmxlZCl7Xy5lYWNoKHJlY29yZFdpZGdldHMsZnVuY3Rpb24od2lkZ2V0KXt2YXIgJGVsPXdpZGdldC5nZXRGb2N1c2FibGVFbGVtZW50KCk7JGVsLnByb3AoJ2Rpc2FibGVkJyxkaXNhYmxlZCk7fSk7fQp0b2dnbGVXaWRnZXRzKHRydWUpO3JldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSxyZWplY3QpPT57dGhpcy50cmlnZ2VyX3VwKCdzYXZlX2xpbmUnLHtyZWNvcmRJRDpyZWNvcmRJRCxvblN1Y2Nlc3M6cmVzb2x2ZSxvbkZhaWx1cmU6cmVqZWN0LH0pO30pLnRoZW4oY2hhbmdlZEZpZWxkcz0+e3RoaXMuX2VuYWJsZVJlY29yZFNlbGVjdG9ycygpO3JldHVybiBjaGFuZ2VkRmllbGRzJiZjaGFuZ2VkRmllbGRzLmxlbmd0aCYmdGhpcy5pc0luTXVsdGlwbGVSZWNvcmRFZGl0aW9uKHJlY29yZElEKTt9KS5ndWFyZGVkQ2F0Y2goKCk9Pnt0b2dnbGVXaWRnZXRzKGZhbHNlKTt9KTt9LHVwZGF0ZVN0YXRlOmZ1bmN0aW9uKHN0YXRlLHBhcmFtcyl7dGhpcy5jb2x1bW5XaWR0aHM9ZmFsc2U7aWYocGFyYW1zLmtlZXBXaWR0aHMmJnRoaXMuJGVsLmlzKCc6dmlzaWJsZScpKXt0aGlzLl9zdG9yZUNvbHVtbldpZHRocygpO30KaWYocGFyYW1zLm5vUmVuZGVyKXt0aGlzLmFsbE1vZGlmaWVyc0RhdGE9W107fQpyZXR1cm4gdGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO30sX2FkZEV2ZW50TGlzdGVuZXI6ZnVuY3Rpb24odHlwZSxlbCxjYWxsYmFjayxvcHRpb25zKXtlbC5hZGRFdmVudExpc3RlbmVyKHR5cGUsY2FsbGJhY2ssb3B0aW9ucyk7dGhpcy5ldmVudExpc3RlbmVycy5wdXNoKHt0eXBlLGVsLGNhbGxiYWNrLG9wdGlvbnN9KTt9LF9kZXN0cm95RmllbGRXaWRnZXRzOmZ1bmN0aW9uKHJlY29yZElEKXtpZihyZWNvcmRJRCBpbiB0aGlzLmFsbEZpZWxkV2lkZ2V0cyl7dmFyIHdpZGdldHNUb0Rlc3Ryb3k9dGhpcy5hbGxGaWVsZFdpZGdldHNbcmVjb3JkSURdLnNsaWNlKCk7Xy5lYWNoKHdpZGdldHNUb0Rlc3Ryb3ksdGhpcy5fZGVzdHJveUZpZWxkV2lkZ2V0LmJpbmQodGhpcyxyZWNvcmRJRCkpO2RlbGV0ZSB0aGlzLmFsbEZpZWxkV2lkZ2V0c1tyZWNvcmRJRF07fX0sX2Rpc2FibGVSZWNvcmRTZWxlY3RvcnM6ZnVuY3Rpb24oKXt0aGlzLiQoJy5vX2xpc3RfcmVjb3JkX3NlbGVjdG9yIGlucHV0JykuYXR0cignZGlzYWJsZWQnLCdkaXNhYmxlZCcpO30sX2VuYWJsZVJlY29yZFNlbGVjdG9yczpmdW5jdGlvbigpe3RoaXMuJCgnLm9fbGlzdF9yZWNvcmRfc2VsZWN0b3IgaW5wdXQnKS5hdHRyKCdkaXNhYmxlZCcsZmFsc2UpO30sX2ZyZWV6ZUNvbHVtbldpZHRoczpmdW5jdGlvbigpe2lmKCF0aGlzLmNvbHVtbldpZHRocyYmKCF0aGlzLl9oYXNWaXNpYmxlUmVjb3Jkcyh0aGlzLnN0YXRlKXx8IXRoaXMuJGVsLmlzKCc6dmlzaWJsZScpKSl7cmV0dXJuO30KY29uc3QgdGFibGU9dGhpcy5lbC5nZXRFbGVtZW50c0J5VGFnTmFtZSgndGFibGUnKVswXTtjb25zdCB0aGVhZD10YWJsZS5nZXRFbGVtZW50c0J5VGFnTmFtZSgndGhlYWQnKVswXTtjb25zdCB0aEVsZW1lbnRzPVsuLi50aGVhZC5nZXRFbGVtZW50c0J5VGFnTmFtZSgndGgnKV07bGV0IGNvbHVtbldpZHRocz10aGlzLmNvbHVtbldpZHRocztpZighY29sdW1uV2lkdGhzKXt0YWJsZS5zdHlsZS50YWJsZUxheW91dD0nYXV0byc7dGhFbGVtZW50cy5mb3JFYWNoKCh0aCk9Pnt0aC5zdHlsZS53aWR0aD1udWxsO3RoLnN0eWxlLm1heFdpZHRoPW51bGw7fSk7Y29sdW1uV2lkdGhzPXRoaXMuX3NxdWVlemVUYWJsZSgpO30KdGhFbGVtZW50cy5mb3JFYWNoKCh0aCxpbmRleCk9Pnt0aC5zdHlsZS53aWR0aD1gJHtjb2x1bW5XaWR0aHNbaW5kZXhdfXB4YDt9KTt0YWJsZS5zdHlsZS50YWJsZUxheW91dD0nZml4ZWQnO30sX2dldEJvcmRlclJvdzpmdW5jdGlvbihzaWRlKXtsZXQgJGJvcmRlckRhdGFSb3c9dGhpcy4kKGAub19kYXRhX3Jvdzoke3NpZGV9YCk7aWYoIXRoaXMuX2lzUmVjb3JkRWRpdGFibGUoJGJvcmRlckRhdGFSb3cuZGF0YSgnaWQnKSkpeyRib3JkZXJEYXRhUm93PXRoaXMuX2dldE5lYXJlc3RFZGl0YWJsZVJvdygkYm9yZGVyRGF0YVJvdyxzaWRlPT09J2ZpcnN0Jyk7fQpyZXR1cm4gJGJvcmRlckRhdGFSb3c7fSxfZ2V0Q29sdW1uc1RvdGFsV2lkdGgoJHRoZWFkKXtyZXR1cm4gdGhpcy5jb2x1bW5zLnJlZHVjZSgoYWNjLGNvbHVtbik9PmFjYysoY29sdW1uLmF0dHJzLnJlbGF0aXZlV2lkdGh8fDApLDApO30sX2dldENvbHVtbldpZHRoOmZ1bmN0aW9uKGNvbHVtbil7aWYoY29sdW1uLmF0dHJzLndpZHRoKXtyZXR1cm4gY29sdW1uLmF0dHJzLndpZHRoO30KY29uc3QgZmllbGRzSW5mbz10aGlzLnN0YXRlLmZpZWxkc0luZm8ubGlzdDtjb25zdCBuYW1lPWNvbHVtbi5hdHRycy5uYW1lO2lmKCFmaWVsZHNJbmZvW25hbWVdKXtyZXR1cm4nMSc7fQpjb25zdCB3aWRnZXQ9ZmllbGRzSW5mb1tuYW1lXS5XaWRnZXQucHJvdG90eXBlO2lmKCd3aWR0aEluTGlzdCdpbiB3aWRnZXQpe3JldHVybiB3aWRnZXQud2lkdGhJbkxpc3Q7fQpjb25zdCBmaWVsZD10aGlzLnN0YXRlLmZpZWxkc1tuYW1lXTtpZighZmllbGQpe3JldHVybicxJzt9CmNvbnN0IGZpeGVkV2lkdGhzPXtib29sZWFuOic1MHB4JyxkYXRlOic5MnB4JyxkYXRldGltZTonMTQ2cHgnLGZsb2F0Oic5MnB4JyxpbnRlZ2VyOic3NHB4Jyxtb25ldGFyeTonMTA0cHgnLH07bGV0IHR5cGU9ZmllbGQudHlwZTtpZihmaWVsZHNJbmZvW25hbWVdLndpZGdldCBpbiBmaXhlZFdpZHRocyl7dHlwZT1maWVsZHNJbmZvW25hbWVdLndpZGdldDt9CnJldHVybiBmaXhlZFdpZHRoc1t0eXBlXXx8JzEnO30sX2dldE5lYXJlc3RFZGl0YWJsZVJvdzpmdW5jdGlvbigkcm93LG5leHQpe2NvbnN0IGRpcmVjdGlvbj1uZXh0PyduZXh0JzoncHJldic7bGV0ICRuZWFyZXN0Um93O2lmKHRoaXMuZWRpdGFibGUpeyRuZWFyZXN0Um93PSRyb3dbZGlyZWN0aW9uXSgpO2lmKCEkbmVhcmVzdFJvdy5oYXNDbGFzcygnb19kYXRhX3JvdycpKXt2YXIgJG5leHRCb2R5PSRyb3cuY2xvc2VzdCgndGJvZHknKVtkaXJlY3Rpb25dKCk7d2hpbGUoJG5leHRCb2R5Lmxlbmd0aCYmISRuZXh0Qm9keS5maW5kKCcub19kYXRhX3JvdycpLmxlbmd0aCl7JG5leHRCb2R5PSRuZXh0Qm9keVtkaXJlY3Rpb25dKCk7fQokbmVhcmVzdFJvdz0kbmV4dEJvZHkuZmluZChgLm9fZGF0YV9yb3c6JHtuZXh0ID8gJ2ZpcnN0JyA6ICdsYXN0J31gKTt9fWVsc2V7Y29uc3QgcmVjb3JkSWQ9JHJvdy5kYXRhKCdpZCcpO2NvbnN0IHJvd1NlbGVjdGlvbkluZGV4PXRoaXMuc2VsZWN0aW9uLmluZGV4T2YocmVjb3JkSWQpO2xldCBuZXh0Um93SW5kZXg7aWYocm93U2VsZWN0aW9uSW5kZXg8MCl7bmV4dFJvd0luZGV4PW5leHQ/MDp0aGlzLnNlbGVjdGlvbi5sZW5ndGgtMTt9ZWxzZXtuZXh0Um93SW5kZXg9cm93U2VsZWN0aW9uSW5kZXgrKG5leHQ/MTotMSk7fQokbmVhcmVzdFJvdz10aGlzLl9nZXRSb3codGhpcy5zZWxlY3Rpb25bbmV4dFJvd0luZGV4XSk7fQpyZXR1cm4gJG5lYXJlc3RSb3c7fSxfZ2V0TnVtYmVyT2ZDb2xzOmZ1bmN0aW9uKCl7dmFyIG49dGhpcy5fc3VwZXIoKTtpZih0aGlzLmFkZFRyYXNoSWNvbil7bisrO30KcmV0dXJuIG47fSxfZ2V0UmVjb3JkOmZ1bmN0aW9uKHJlY29yZElkKXt2YXIgcmVjb3JkO3V0aWxzLnRyYXZlcnNlX3JlY29yZHModGhpcy5zdGF0ZSxmdW5jdGlvbihyKXtpZihyLmlkPT09cmVjb3JkSWQpe3JlY29yZD1yO319KTtyZXR1cm4gcmVjb3JkO30sX2dldFJlY29yZElEOmZ1bmN0aW9uKHJvd0luZGV4KXt2YXIgJHRyPXRoaXMuJCgndGFibGUub19saXN0X3RhYmxlID4gdGJvZHkgdHInKS5lcShyb3dJbmRleCk7cmV0dXJuICR0ci5kYXRhKCdpZCcpO30sX2dldFJvdzpmdW5jdGlvbihyZWNvcmRJZCl7cmV0dXJuIHRoaXMuJCgnLm9fZGF0YV9yb3dbZGF0YS1pZD0iJytyZWNvcmRJZCsnIl0nKTt9LF9oYXNWaXNpYmxlUmVjb3JkczpmdW5jdGlvbihsaXN0KXtpZighbGlzdC5ncm91cGVkQnkubGVuZ3RoKXtyZXR1cm4hIWxpc3QuZGF0YS5sZW5ndGg7fWVsc2V7dmFyIGhhc1Zpc2libGVSZWNvcmRzPWZhbHNlO2Zvcih2YXIgaT0wO2k8bGlzdC5kYXRhLmxlbmd0aDtpKyspe2hhc1Zpc2libGVSZWNvcmRzPWhhc1Zpc2libGVSZWNvcmRzfHx0aGlzLl9oYXNWaXNpYmxlUmVjb3JkcyhsaXN0LmRhdGFbaV0pO30KcmV0dXJuIGhhc1Zpc2libGVSZWNvcmRzO319LF9pc1JlY29yZEVkaXRhYmxlOmZ1bmN0aW9uKHJlY29yZElEKXtyZXR1cm4gdGhpcy5lZGl0YWJsZXx8KHRoaXMuaXNNdWx0aUVkaXRhYmxlJiZ0aGlzLnNlbGVjdGlvbi5pbmNsdWRlcyhyZWNvcmRJRCkpO30sX21vdmVUb05leHRMaW5lOmZ1bmN0aW9uKG9wdGlvbnMpe3RoaXMuX21vdmVUb1NpZGVMaW5lKHRydWUsb3B0aW9ucyk7fSxfbW92ZVRvUHJldmlvdXNMaW5lOmZ1bmN0aW9uKG9wdGlvbnMpe3RoaXMuX21vdmVUb1NpZGVMaW5lKGZhbHNlLG9wdGlvbnMpO30sX21vdmVUb1NpZGVMaW5lOmZ1bmN0aW9uKG5leHQsb3B0aW9ucyl7b3B0aW9ucz1vcHRpb25zfHx7fTtjb25zdCByZWNvcmRJRD10aGlzLl9nZXRSZWNvcmRJRCh0aGlzLmN1cnJlbnRSb3cpO3RoaXMuY29tbWl0Q2hhbmdlcyhyZWNvcmRJRCkudGhlbigoKT0+e2NvbnN0IHJlY29yZD10aGlzLl9nZXRSZWNvcmQocmVjb3JkSUQpO2NvbnN0IG11bHRpRWRpdD10aGlzLmlzSW5NdWx0aXBsZVJlY29yZEVkaXRpb24ocmVjb3JkSUQpO2lmKCFtdWx0aUVkaXQpe2NvbnN0IGZpZWxkTmFtZXM9dGhpcy5jYW5CZVNhdmVkKHJlY29yZElEKTtpZihmaWVsZE5hbWVzLmxlbmd0aCYmKHJlY29yZC5pc0RpcnR5KCl8fG9wdGlvbnMuZm9yY2VDcmVhdGUpKXtyZXR1cm47fX0KY29uc3Qgc2lkZT1uZXh0PydmaXJzdCc6J2xhc3QnO2NvbnN0IGJvcmRlclJvd0luZGV4PXRoaXMuX2dldEJvcmRlclJvdyhzaWRlKS5wcm9wKCdyb3dJbmRleCcpLTE7Y29uc3QgY2VsbEluZGV4PW5leHQ/MDp0aGlzLmFsbEZpZWxkV2lkZ2V0c1tyZWNvcmRJRF0ubGVuZ3RoLTE7Y29uc3QgY2VsbE9wdGlvbnM9e2luYzpuZXh0PzE6LTEsZm9yY2U6dHJ1ZX07Y29uc3QgJGN1cnJlbnRSb3c9dGhpcy5fZ2V0Um93KHJlY29yZElEKTtjb25zdCAkbmV4dFJvdz10aGlzLl9nZXROZWFyZXN0RWRpdGFibGVSb3coJGN1cnJlbnRSb3csbmV4dCk7bGV0IG5leHRSb3dJbmRleD1udWxsO2xldCBncm91cElkO2lmKCF0aGlzLmlzR3JvdXBlZCl7aWYoJG5leHRSb3cubGVuZ3RoKXtuZXh0Um93SW5kZXg9JG5leHRSb3cucHJvcCgncm93SW5kZXgnKS0xO31lbHNlIGlmKCF0aGlzLmVkaXRhYmxlKXtuZXh0Um93SW5kZXg9Ym9yZGVyUm93SW5kZXg7fWVsc2UgaWYoIW9wdGlvbnMuZm9yY2VDcmVhdGUmJiFyZWNvcmQuaXNEaXJ0eSgpKXt0aGlzLnRyaWdnZXJfdXAoJ2Rpc2NhcmRfY2hhbmdlcycse3JlY29yZElEOnJlY29yZElELG9uU3VjY2Vzczp0aGlzLnRyaWdnZXJfdXAuYmluZCh0aGlzLCdhY3RpdmF0ZV9uZXh0X3dpZGdldCcse3NpZGU6c2lkZX0pLH0pO3JldHVybjt9fWVsc2V7dmFyICRkaXJlY3ROZXh0Um93PSRjdXJyZW50Um93Lm5leHQoKTtpZihuZXh0JiZ0aGlzLmVkaXRhYmxlPT09ImJvdHRvbSImJiRkaXJlY3ROZXh0Um93Lmhhc0NsYXNzKCdvX2FkZF9yZWNvcmRfcm93Jykpe2lmKG9wdGlvbnMuZm9yY2VDcmVhdGV8fHJlY29yZC5pc0RpcnR5KCkpe2dyb3VwSWQ9JGRpcmVjdE5leHRSb3cuZGF0YSgnZ3JvdXAtaWQnKTt9ZWxzZXtuZXh0Um93SW5kZXg9KCRuZXh0Um93LnByb3AoJ3Jvd0luZGV4JyktMSl8fG51bGw7dGhpcy50cmlnZ2VyX3VwKCdkaXNjYXJkX2NoYW5nZXMnLHtyZWNvcmRJRDpyZWNvcmRJRCxvblN1Y2Nlc3M6KCk9PntpZihuZXh0Um93SW5kZXghPT1udWxsKXtpZighcmVjb3JkLnJlc19pZCl7bmV4dFJvd0luZGV4LS07fQp0aGlzLl9zZWxlY3RDZWxsKG5leHRSb3dJbmRleCxjZWxsSW5kZXgsY2VsbE9wdGlvbnMpO31lbHNle3RoaXMuX3NlbGVjdENlbGwoYm9yZGVyUm93SW5kZXgsY2VsbEluZGV4LGNlbGxPcHRpb25zKTt9fSx9KTtyZXR1cm47fX1lbHNle25leHRSb3dJbmRleD0kbmV4dFJvdy5sZW5ndGg/KCRuZXh0Um93LnByb3AoJ3Jvd0luZGV4JyktMSk6Ym9yZGVyUm93SW5kZXg7fX0KaWYobmV4dFJvd0luZGV4IT09bnVsbCl7dGhpcy5fc2VsZWN0Q2VsbChuZXh0Um93SW5kZXgsY2VsbEluZGV4LGNlbGxPcHRpb25zKTt9ZWxzZSBpZih0aGlzLmVkaXRhYmxlKXt0aGlzLnVuc2VsZWN0Um93KCkudGhlbih0aGlzLnRyaWdnZXJfdXAuYmluZCh0aGlzLCdhZGRfcmVjb3JkJyx7Z3JvdXBJZDpncm91cElkLG9uRmFpbDp0aGlzLl9zZWxlY3RDZWxsLmJpbmQodGhpcyxib3JkZXJSb3dJbmRleCxjZWxsSW5kZXgsY2VsbE9wdGlvbnMpLH0pKTt9fSk7fSxfcHJvY2Vzc0NvbHVtbnM6ZnVuY3Rpb24oKXtjb25zdCBvbGRDb2x1bW5zPXRoaXMuY29sdW1uczt0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7aWYodGhpcy5jb2x1bW5XaWR0aHMmJm9sZENvbHVtbnMmJm9sZENvbHVtbnMubGVuZ3RoPT09dGhpcy5jb2x1bW5zLmxlbmd0aCl7Zm9yKGxldCBpPTA7aTxvbGRDb2x1bW5zLmxlbmd0aDtpKyspe2lmKG9sZENvbHVtbnNbaV0hPT10aGlzLmNvbHVtbnNbaV0pe3RoaXMuY29sdW1uV2lkdGhzPWZhbHNlO2JyZWFrO319fWVsc2V7dGhpcy5jb2x1bW5XaWR0aHM9ZmFsc2U7fQppZighdGhpcy5jb2x1bW5XaWR0aHMpe3RoaXMuY29sdW1ucy5mb3JFYWNoKChjb2x1bW4pPT57Y29uc3Qgd2lkdGg9dGhpcy5fZ2V0Q29sdW1uV2lkdGgoY29sdW1uKTtpZih3aWR0aC5tYXRjaCgvW2EtekEtWl0vKSl7Y29sdW1uLmF0dHJzLmFic29sdXRlV2lkdGg9d2lkdGg7fWVsc2V7Y29sdW1uLmF0dHJzLnJlbGF0aXZlV2lkdGg9cGFyc2VGbG9hdCh3aWR0aCwxMCk7fX0pO319LF9yZW5kZXI6ZnVuY3Rpb24oKXt0aGlzLmN1cnJlbnRSb3c9bnVsbDt0aGlzLmN1cnJlbnRGaWVsZEluZGV4PW51bGw7cmV0dXJuIHRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9LF9yZW5kZXJHcm91cDpmdW5jdGlvbihncm91cCl7dmFyIHJlc3VsdD10aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7aWYoIWdyb3VwLmdyb3VwZWRCeS5sZW5ndGgmJnRoaXMuYWRkQ3JlYXRlTGluZUluR3JvdXBzKXt2YXIgJGdyb3VwQm9keT1yZXN1bHRbMF07dmFyICRhPSQoJzxhIGhyZWY9IiMiIHJvbGU9ImJ1dHRvbiI+JykudGV4dChfdCgiQWRkIGEgbGluZSIpKS5hdHRyKCdkYXRhLWdyb3VwLWlkJyxncm91cC5pZCk7dmFyICR0ZD0kKCc8dGQ+JykuYXR0cignY29sc3BhbicsdGhpcy5fZ2V0TnVtYmVyT2ZDb2xzKCkpLmFkZENsYXNzKCdvX2dyb3VwX2ZpZWxkX3Jvd19hZGQnKS5hdHRyKCd0YWJpbmRleCcsLTEpLmFwcGVuZCgkYSk7dmFyICR0cj0kKCc8dHI+Jyx7Y2xhc3M6J29fYWRkX3JlY29yZF9yb3cnfSkuYXR0cignZGF0YS1ncm91cC1pZCcsZ3JvdXAuaWQpLmFwcGVuZCgkdGQpOyRncm91cEJvZHkuYXBwZW5kKCR0ci5wcmVwZW5kKCQoJzx0ZD4nKS5odG1sKCcmbmJzcDsnKSkpO30KcmV0dXJuIHJlc3VsdDt9LF9yZW5kZXJCb2R5OmZ1bmN0aW9uKCl7dmFyIHNlbGY9dGhpczt2YXIgJGJvZHk9dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO2lmKHRoaXMuaGFzSGFuZGxlKXskYm9keS5zb3J0YWJsZSh7YXhpczoneScsaXRlbXM6Jz4gdHIub19kYXRhX3JvdycsaGVscGVyOidjbG9uZScsaGFuZGxlOicub19yb3dfaGFuZGxlJyxzdG9wOmZ1bmN0aW9uKGV2ZW50LHVpKXtpZihzZWxmLmN1cnJlbnRSb3chPT1udWxsKXt2YXIgY3VycmVudElEPXNlbGYuc3RhdGUuZGF0YVtzZWxmLmN1cnJlbnRSb3ddLmlkO3NlbGYuY3VycmVudFJvdz1zZWxmLl9nZXRSb3coY3VycmVudElEKS5pbmRleCgpO30Kc2VsZi51bnNlbGVjdFJvdygpLnRoZW4oZnVuY3Rpb24oKXtzZWxmLl9tb3ZlUmVjb3JkKHVpLml0ZW0uZGF0YSgnaWQnKSx1aS5pdGVtLmluZGV4KCkpO30pO30sfSk7fQpyZXR1cm4gJGJvZHk7fSxfcmVuZGVyRm9vdGVyOmZ1bmN0aW9uKCl7Y29uc3QgJGZvb3Rlcj10aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7aWYodGhpcy5hZGRUcmFzaEljb24peyRmb290ZXIuZmluZCgndHInKS5hcHBlbmQoJCgnPHRkPicpKTt9CnJldHVybiAkZm9vdGVyO30sX3JlbmRlckhlYWRlcjpmdW5jdGlvbigpe3ZhciAkdGhlYWQ9dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO2lmKCF0aGlzLmNvbHVtbldpZHRocyl7aWYoIXRoaXMuX2hhc1Zpc2libGVSZWNvcmRzKHRoaXMuc3RhdGUpKXt2YXIgdG90YWxXaWR0aD10aGlzLl9nZXRDb2x1bW5zVG90YWxXaWR0aCgkdGhlYWQpO3RoaXMuY29sdW1ucy5mb3JFYWNoKGZ1bmN0aW9uKGNvbHVtbil7bGV0IHdpZHRoO2lmKGNvbHVtbi5hdHRycy5hYnNvbHV0ZVdpZHRoKXt3aWR0aD1jb2x1bW4uYXR0cnMuYWJzb2x1dGVXaWR0aDt9ZWxzZSBpZihjb2x1bW4uYXR0cnMucmVsYXRpdmVXaWR0aCl7d2lkdGg9KChjb2x1bW4uYXR0cnMucmVsYXRpdmVXaWR0aC90b3RhbFdpZHRoKjEwMCkrJyUnKTt9CmlmKHdpZHRoKXskdGhlYWQuZmluZCgndGhbZGF0YS1uYW1lPScrY29sdW1uLmF0dHJzLm5hbWUrJ10nKS5jc3MoJ3dpZHRoJyx3aWR0aCk7fX0pO31lbHNle3RoaXMuY29sdW1ucy5mb3JFYWNoKGZ1bmN0aW9uKGNvbHVtbil7aWYoY29sdW1uLmF0dHJzLmFic29sdXRlV2lkdGgpe2xldCB3aWR0aD1jb2x1bW4uYXR0cnMuYWJzb2x1dGVXaWR0aDskdGhlYWQuZmluZCgndGhbZGF0YS1uYW1lPScrY29sdW1uLmF0dHJzLm5hbWUrJ10nKS5jc3MoJ21pbi13aWR0aCcsd2lkdGgpO319KTt9fQppZih0aGlzLmFkZFRyYXNoSWNvbil7JHRoZWFkLmZpbmQoJ3RyJykuYXBwZW5kKCQoJzx0aD4nLHtjbGFzczonb19saXN0X3JlY29yZF9yZW1vdmVfaGVhZGVyJ30pKTt9CnJldHVybiAkdGhlYWQ7fSxfcmVuZGVySGVhZGVyQ2VsbDpmdW5jdGlvbigpe2NvbnN0ICR0aD10aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7aWYoJHRoWzBdLmlubmVySFRNTC5sZW5ndGgmJnRoaXMuX2hhc1Zpc2libGVSZWNvcmRzKHRoaXMuc3RhdGUpKXtjb25zdCByZXNpemVIYW5kbGU9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO3Jlc2l6ZUhhbmRsZS5jbGFzc0xpc3Q9J29fcmVzaXplJztyZXNpemVIYW5kbGUub25jbGljaz10aGlzLl9vbkNsaWNrUmVzaXplLmJpbmQodGhpcyk7cmVzaXplSGFuZGxlLm9ubW91c2Vkb3duPXRoaXMuX29uU3RhcnRSZXNpemUuYmluZCh0aGlzKTskdGguYXBwZW5kKHJlc2l6ZUhhbmRsZSk7fQpyZXR1cm4gJHRoO30sX3JlbmRlclJvdzpmdW5jdGlvbihyZWNvcmQsaW5kZXgpe3ZhciAkcm93PXRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtpZih0aGlzLmFkZFRyYXNoSWNvbil7dmFyICRpY29uPXRoaXMuaXNNYW55Mk1hbnk/JCgnPGJ1dHRvbj4nLHsnY2xhc3MnOidmYSBmYS10aW1lcycsJ25hbWUnOid1bmxpbmsnLCdhcmlhLWxhYmVsJzpfdCgnVW5saW5rIHJvdyAnKSsoaW5kZXgrMSl9KTokKCc8YnV0dG9uPicseydjbGFzcyc6J2ZhIGZhLXRyYXNoLW8nLCduYW1lJzonZGVsZXRlJywnYXJpYS1sYWJlbCc6X3QoJ0RlbGV0ZSByb3cgJykrKGluZGV4KzEpfSk7dmFyICR0ZD0kKCc8dGQ+Jyx7Y2xhc3M6J29fbGlzdF9yZWNvcmRfcmVtb3ZlJ30pLmFwcGVuZCgkaWNvbik7JHJvdy5hcHBlbmQoJHRkKTt9CnJldHVybiAkcm93O30sX3JlbmRlclJvd3M6ZnVuY3Rpb24oKXt2YXIgJHJvd3M9dGhpcy5fc3VwZXIoKTtpZih0aGlzLmFkZENyZWF0ZUxpbmUpe3ZhciAkdHI9JCgnPHRyPicpO3ZhciBjb2xzcGFuPXRoaXMuX2dldE51bWJlck9mQ29scygpO2lmKHRoaXMuaGFuZGxlRmllbGQpe2NvbHNwYW49Y29sc3Bhbi0xOyR0ci5hcHBlbmQoJzx0ZD4nKTt9CnZhciAkdGQ9JCgnPHRkPicpLmF0dHIoJ2NvbHNwYW4nLGNvbHNwYW4pLmFkZENsYXNzKCdvX2ZpZWxkX3gybWFueV9saXN0X3Jvd19hZGQnKTskdHIuYXBwZW5kKCR0ZCk7JHJvd3MucHVzaCgkdHIpO18uZWFjaCh0aGlzLmNyZWF0ZXMsZnVuY3Rpb24oY3JlYXRlLGluZGV4KXt2YXIgJGE9JCgnPGEgaHJlZj0iIyIgcm9sZT0iYnV0dG9uIj4nKS5hdHRyKCdkYXRhLWNvbnRleHQnLGNyZWF0ZS5jb250ZXh0KS50ZXh0KGNyZWF0ZS5zdHJpbmcpO2lmKGluZGV4PjApeyRhLmFkZENsYXNzKCdtbDE2Jyk7fQokdGQuYXBwZW5kKCRhKTt9KTt9CnJldHVybiAkcm93czt9LF9yZW5kZXJWaWV3OmZ1bmN0aW9uKCl7dGhpcy5jdXJyZW50Um93PW51bGw7cmV0dXJuIHRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKS50aGVuKCgpPT57Y29uc3QgdGFibGU9dGhpcy5lbC5nZXRFbGVtZW50c0J5VGFnTmFtZSgndGFibGUnKVswXTtpZih0YWJsZSl7dGFibGUuY2xhc3NMaXN0LnRvZ2dsZSgnb19lbXB0eV9saXN0JywhdGhpcy5faGFzVmlzaWJsZVJlY29yZHModGhpcy5zdGF0ZSkpO3RoaXMuX2ZyZWV6ZUNvbHVtbldpZHRocygpO319KTt9LF9zZWxlY3RDZWxsOmZ1bmN0aW9uKHJvd0luZGV4LGZpZWxkSW5kZXgsb3B0aW9ucyl7b3B0aW9ucz1vcHRpb25zfHx7fTtpZighb3B0aW9ucy5mb3JjZSYmcm93SW5kZXg9PT10aGlzLmN1cnJlbnRSb3cmJmZpZWxkSW5kZXg9PT10aGlzLmN1cnJlbnRGaWVsZEluZGV4KXtyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7fQp2YXIgd3JhcD1vcHRpb25zLndyYXA9PT11bmRlZmluZWQ/dHJ1ZTpvcHRpb25zLndyYXA7dmFyIHNlbGY9dGhpcztyZXR1cm4gdGhpcy5fc2VsZWN0Um93KHJvd0luZGV4KS50aGVuKGZ1bmN0aW9uKCl7dmFyIHJlY29yZElEPXNlbGYuX2dldFJlY29yZElEKHJvd0luZGV4KTt2YXIgcmVjb3JkPXNlbGYuX2dldFJlY29yZChyZWNvcmRJRCk7aWYoZmllbGRJbmRleD49KHNlbGYuYWxsRmllbGRXaWRnZXRzW3JlY29yZC5pZF18fFtdKS5sZW5ndGgpe3JldHVybiBQcm9taXNlLnJlamVjdCgpO30KdmFyIG9sZEZpZWxkSW5kZXg9c2VsZi5jdXJyZW50RmllbGRJbmRleDtzZWxmLmN1cnJlbnRGaWVsZEluZGV4PWZpZWxkSW5kZXg7ZmllbGRJbmRleD1zZWxmLl9hY3RpdmF0ZUZpZWxkV2lkZ2V0KHJlY29yZCxmaWVsZEluZGV4LHtpbmM6b3B0aW9ucy5pbmN8fDEsd3JhcDp3cmFwLGV2ZW50Om9wdGlvbnMmJm9wdGlvbnMuZXZlbnQsfSk7aWYoZmllbGRJbmRleDwwKXtzZWxmLmN1cnJlbnRGaWVsZEluZGV4PW9sZEZpZWxkSW5kZXg7cmV0dXJuIFByb21pc2UucmVqZWN0KCk7fQpzZWxmLmN1cnJlbnRGaWVsZEluZGV4PWZpZWxkSW5kZXg7fSk7fSxfc2VsZWN0Um93OmZ1bmN0aW9uKHJvd0luZGV4KXtpZihyb3dJbmRleD09PXRoaXMuY3VycmVudFJvdyl7cmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO30KaWYoIXRoaXMuY29sdW1uV2lkdGhzKXt0aGlzLl9zdG9yZUNvbHVtbldpZHRocygpO30KdGhpcy5fZnJlZXplQ29sdW1uV2lkdGhzKCk7dmFyIHJlY29yZElkPXRoaXMuX2dldFJlY29yZElEKHJvd0luZGV4KTt2YXIgc2VsZj10aGlzO3JldHVybiB0aGlzLnVuc2VsZWN0Um93KCkudGhlbihub1NlbGVjdE5leHQ9PntpZihub1NlbGVjdE5leHQpe3JldHVybiBQcm9taXNlLnJlc29sdmUoKTt9CmlmKCFyZWNvcmRJZCl7cmV0dXJuIFByb21pc2UucmVqZWN0KCk7fQpyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSl7c2VsZi50cmlnZ2VyX3VwKCdlZGl0X2xpbmUnLHtyZWNvcmRJZDpyZWNvcmRJZCxvblN1Y2Nlc3M6ZnVuY3Rpb24oKXtzZWxmLl9kaXNhYmxlUmVjb3JkU2VsZWN0b3JzKCk7cmVzb2x2ZSgpO30sfSk7fSk7fSk7fSxfc3F1ZWV6ZVRhYmxlOmZ1bmN0aW9uKCl7Y29uc3QgdGFibGU9dGhpcy5lbC5nZXRFbGVtZW50c0J5VGFnTmFtZSgndGFibGUnKVswXTtjb25zdCB0aGVhZD10YWJsZS5nZXRFbGVtZW50c0J5VGFnTmFtZSgndGhlYWQnKVswXTtjb25zdCB0aEVsZW1lbnRzPVsuLi50aGVhZC5nZXRFbGVtZW50c0J5VGFnTmFtZSgndGgnKV07Y29uc3QgY29sdW1uV2lkdGhzPXRoRWxlbWVudHMubWFwKHRoPT50aC5vZmZzZXRXaWR0aCk7Y29uc3QgZ2V0V2lkdGg9dGg9PmNvbHVtbldpZHRoc1t0aEVsZW1lbnRzLmluZGV4T2YodGgpXXx8MDtjb25zdCBnZXRUb3RhbFdpZHRoPSgpPT50aEVsZW1lbnRzLnJlZHVjZSgodG90LHRoLGkpPT50b3QrY29sdW1uV2lkdGhzW2ldLDApO2NvbnN0IHNocmlua0NvbHVtbnM9KGNvbHVtbnMsd2lkdGgpPT57bGV0IHRocmVzaG9sZFJlYWNoZWQ9ZmFsc2U7Y29sdW1ucy5mb3JFYWNoKHRoPT57Y29uc3QgaW5kZXg9dGhFbGVtZW50cy5pbmRleE9mKHRoKTtsZXQgbWF4V2lkdGg9Y29sdW1uV2lkdGhzW2luZGV4XS1NYXRoLmNlaWwod2lkdGgvY29sdW1ucy5sZW5ndGgpO2lmKG1heFdpZHRoPDkyKXttYXhXaWR0aD05Mjt0aHJlc2hvbGRSZWFjaGVkPXRydWU7fQp0aC5zdHlsZS5tYXhXaWR0aD1gJHttYXhXaWR0aH1weGA7Y29sdW1uV2lkdGhzW2luZGV4XT1tYXhXaWR0aDt9KTtyZXR1cm4gdGhyZXNob2xkUmVhY2hlZDt9O2NvbnN0IHNvcnRlZFRocz1bLi4udGhlYWQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3RoJyldLnNvcnQoKGEsYik9PmdldFdpZHRoKGIpLWdldFdpZHRoKGEpKTtjb25zdCBhbGxvd2VkV2lkdGg9dGFibGUucGFyZW50Tm9kZS5vZmZzZXRXaWR0aDtsZXQgdG90YWxXaWR0aD1nZXRUb3RhbFdpZHRoKCk7bGV0IHN0b3A9ZmFsc2U7bGV0IGluZGV4PTA7d2hpbGUodG90YWxXaWR0aD5hbGxvd2VkV2lkdGgmJiFzdG9wKXtpbmRleCsrO2NvbnN0IGxhcmdlc3RzPXNvcnRlZFRocy5zbGljZSgwLGluZGV4KTt3aGlsZShnZXRXaWR0aChsYXJnZXN0c1swXSk9PT1nZXRXaWR0aChzb3J0ZWRUaHNbaW5kZXhdKSl7bGFyZ2VzdHMucHVzaChzb3J0ZWRUaHNbaW5kZXhdKTtpbmRleCsrO30KY29uc3QgbmV4dExhcmdlc3Q9c29ydGVkVGhzW2luZGV4XTtjb25zdCB0b3RhbFRvUmVtb3ZlPXRvdGFsV2lkdGgtYWxsb3dlZFdpZHRoO2NvbnN0IGNhblJlbW92ZT0oZ2V0V2lkdGgobGFyZ2VzdHNbMF0pLWdldFdpZHRoKG5leHRMYXJnZXN0KSkqbGFyZ2VzdHMubGVuZ3RoO3N0b3A9c2hyaW5rQ29sdW1ucyhsYXJnZXN0cyxNYXRoLm1pbih0b3RhbFRvUmVtb3ZlLGNhblJlbW92ZSkpO3RvdGFsV2lkdGg9Z2V0VG90YWxXaWR0aCgpO30KcmV0dXJuIGNvbHVtbldpZHRoczt9LF9zdG9yZUNvbHVtbldpZHRoczpmdW5jdGlvbigpe3RoaXMuY29sdW1uV2lkdGhzPXRoaXMuJCgndGhlYWQgdGgnKS50b0FycmF5KCkubWFwKGZ1bmN0aW9uKHRoKXtyZXR1cm4gJCh0aCkub3V0ZXJXaWR0aCgpO30pO30sX29uQWRkUmVjb3JkVG9Hcm91cDpmdW5jdGlvbihldil7ZXYucHJldmVudERlZmF1bHQoKTtldi5zdG9wUHJvcGFnYXRpb24oKTt2YXIgc2VsZj10aGlzO2NvbnN0IHRhcmdldD1ldi50YXJnZXQudGFnTmFtZSE9PSdBJz9ldi50YXJnZXQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ0EnKVswXTpldi50YXJnZXQ7Y29uc3QgZ3JvdXBJZD10YXJnZXQuZGF0YXNldC5ncm91cElkO3RoaXMuY3VycmVudEdyb3VwSWQ9Z3JvdXBJZDt0aGlzLnVuc2VsZWN0Um93KCkudGhlbihmdW5jdGlvbigpe3NlbGYudHJpZ2dlcl91cCgnYWRkX3JlY29yZCcse2dyb3VwSWQ6Z3JvdXBJZCx9KTt9KTt9LF9vbkFkZFJlY29yZDpmdW5jdGlvbihldil7ZXYucHJldmVudERlZmF1bHQoKTtldi5zdG9wUHJvcGFnYXRpb24oKTt2YXIgc2VsZj10aGlzO3RoaXMudW5zZWxlY3RSb3coKS50aGVuKGZ1bmN0aW9uKCl7c2VsZi50cmlnZ2VyX3VwKCdhZGRfcmVjb3JkJyx7Y29udGV4dDpldi5jdXJyZW50VGFyZ2V0LmRhdGFzZXQuY29udGV4dCYmW2V2LmN1cnJlbnRUYXJnZXQuZGF0YXNldC5jb250ZXh0XX0pO30pO30sX29uQ2VsbENsaWNrOmZ1bmN0aW9uKGV2ZW50KXt2YXIgJHRkPSQoZXZlbnQuY3VycmVudFRhcmdldCk7dmFyICR0cj0kdGQucGFyZW50KCk7dmFyIHJvd0luZGV4PSR0ci5wcm9wKCdyb3dJbmRleCcpLTE7aWYoIXRoaXMuX2lzUmVjb3JkRWRpdGFibGUoJHRyLmRhdGEoJ2lkJykpfHwkKGV2ZW50LnRhcmdldCkucHJvcCgnc3BlY2lhbF9jbGljaycpKXtyZXR1cm47fQp2YXIgZmllbGRJbmRleD1NYXRoLm1heCgkdHIuZmluZCgnLm9fZmllbGRfY2VsbCcpLmluZGV4KCR0ZCksMCk7dGhpcy5fc2VsZWN0Q2VsbChyb3dJbmRleCxmaWVsZEluZGV4LHtldmVudDpldmVudH0pO30sX29uQ2xpY2tSZXNpemU6ZnVuY3Rpb24oZXYpe2V2LnN0b3BQcm9wYWdhdGlvbigpO2V2LnByZXZlbnREZWZhdWx0KCk7fSxfb25FbXB0eVJvd0NsaWNrOmZ1bmN0aW9uKCl7dGhpcy51bnNlbGVjdFJvdygpO30sX29uRm9vdGVyQ2xpY2s6ZnVuY3Rpb24oKXt0aGlzLnVuc2VsZWN0Um93KCk7fSxfb25LZXlEb3duOmZ1bmN0aW9uKGV2KXtjb25zdCAkdGFyZ2V0PSQoZXYuY3VycmVudFRhcmdldCk7Y29uc3QgJHRyPSR0YXJnZXQuY2xvc2VzdCgndHInKTtjb25zdCByZWNvcmRFZGl0YWJsZT10aGlzLl9pc1JlY29yZEVkaXRhYmxlKCR0ci5kYXRhKCdpZCcpKTtpZihyZWNvcmRFZGl0YWJsZSYmZXYua2V5Q29kZT09PSQudWkua2V5Q29kZS5FTlRFUiYmJHRyLmhhc0NsYXNzKCdvX3NlbGVjdGVkX3JvdycpKXtyZXR1cm47fQppZihyZWNvcmRFZGl0YWJsZSYmZXYua2V5Q29kZT09PSQudWkua2V5Q29kZS5FTlRFUiYmISR0ci5oYXNDbGFzcygnb19zZWxlY3RlZF9yb3cnKSYmISR0ci5oYXNDbGFzcygnb19ncm91cF9oZWFkZXInKSl7ZXYuc3RvcFByb3BhZ2F0aW9uKCk7ZXYucHJldmVudERlZmF1bHQoKTtpZigkdGFyZ2V0LmNsb3Nlc3QoJ3RkJykuaGFzQ2xhc3MoJ29fZ3JvdXBfZmllbGRfcm93X2FkZCcpKXt0aGlzLl9vbkFkZFJlY29yZFRvR3JvdXAoZXYpO31lbHNle3RoaXMuX29uQ2VsbENsaWNrKGV2KTt9fWVsc2V7dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO319LF9vbktleURvd25BZGRSZWNvcmQ6ZnVuY3Rpb24oZSl7c3dpdGNoKGUua2V5Q29kZSl7Y2FzZSAkLnVpLmtleUNvZGUuRU5URVI6ZS5zdG9wUHJvcGFnYXRpb24oKTtlLnByZXZlbnREZWZhdWx0KCk7dGhpcy5fb25BZGRSZWNvcmQoZSk7YnJlYWs7fX0sX29uTmF2aWdhdGlvbk1vdmU6ZnVuY3Rpb24oZXYpe3ZhciBzZWxmPXRoaXM7aWYodGhpcy5jdXJyZW50Um93PT09bnVsbCYmZXYuZGF0YS5kaXJlY3Rpb249PT0ndXAnKXtyZXR1cm47fQpldi5zdG9wUHJvcGFnYXRpb24oKTtzd2l0Y2goZXYuZGF0YS5kaXJlY3Rpb24pe2Nhc2UncHJldmlvdXMnOmlmKHRoaXMuY3VycmVudEZpZWxkSW5kZXg+MCl7dGhpcy5fc2VsZWN0Q2VsbCh0aGlzLmN1cnJlbnRSb3csdGhpcy5jdXJyZW50RmllbGRJbmRleC0xLHtpbmM6LTEsd3JhcDpmYWxzZX0pLmd1YXJkZWRDYXRjaCh0aGlzLl9tb3ZlVG9QcmV2aW91c0xpbmUuYmluZCh0aGlzKSk7fWVsc2V7dGhpcy5fbW92ZVRvUHJldmlvdXNMaW5lKCk7fQpicmVhaztjYXNlJ25leHQnOmlmKHRoaXMuY3VycmVudEZpZWxkSW5kZXgrMTx0aGlzLmNvbHVtbnMubGVuZ3RoKXt0aGlzLl9zZWxlY3RDZWxsKHRoaXMuY3VycmVudFJvdyx0aGlzLmN1cnJlbnRGaWVsZEluZGV4KzEse3dyYXA6ZmFsc2V9KS5ndWFyZGVkQ2F0Y2godGhpcy5fbW92ZVRvTmV4dExpbmUuYmluZCh0aGlzKSk7fWVsc2V7dGhpcy5fbW92ZVRvTmV4dExpbmUoKTt9CmJyZWFrO2Nhc2UnbmV4dF9saW5lJzppZighdGhpcy5lZGl0YWJsZSYmdGhpcy5zZWxlY3Rpb24ubGVuZ3RoPT09MSYmdGhpcy5fZ2V0UmVjb3JkSUQodGhpcy5jdXJyZW50Um93KT09PWV2LnRhcmdldC5kYXRhUG9pbnRJRCl7dGhpcy51bnNlbGVjdFJvdygpO31lbHNle3RoaXMuX21vdmVUb05leHRMaW5lKHtmb3JjZUNyZWF0ZTp0cnVlfSk7fQpicmVhaztjYXNlJ2NhbmNlbCc6ZXYuZGF0YS5vcmlnaW5hbEV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO3ZhciByb3dJbmRleD10aGlzLmN1cnJlbnRSb3c7dmFyIGNlbGxJbmRleD10aGlzLmN1cnJlbnRGaWVsZEluZGV4KzE7dGhpcy50cmlnZ2VyX3VwKCdkaXNjYXJkX2NoYW5nZXMnLHtyZWNvcmRJRDpldi50YXJnZXQuZGF0YVBvaW50SUQsb25TdWNjZXNzOmZ1bmN0aW9uKCl7c2VsZi5fZW5hYmxlUmVjb3JkU2VsZWN0b3JzKCk7dmFyIHJlY29yZElkPXNlbGYuX2dldFJlY29yZElEKHJvd0luZGV4KTtpZihyZWNvcmRJZCl7dmFyIGNvcnJlc3BvbmRpbmdSb3c9c2VsZi5fZ2V0Um93KHJlY29yZElkKTtjb3JyZXNwb25kaW5nUm93LmNoaWxkcmVuKCkuZXEoY2VsbEluZGV4KS5mb2N1cygpO31lbHNlIGlmKHNlbGYuY3VycmVudEdyb3VwSWQpe3NlbGYuJCgnYVtkYXRhLWdyb3VwLWlkPSInK3NlbGYuY3VycmVudEdyb3VwSWQrJyJdJykuZm9jdXMoKTt9ZWxzZXtzZWxmLiQoJy5vX2ZpZWxkX3gybWFueV9saXN0X3Jvd19hZGQgYTpmaXJzdCcpLmZvY3VzKCk7fX19KTticmVhazt9fSxfb25SZW1vdmVJY29uQ2xpY2s6ZnVuY3Rpb24oZXZlbnQpe2V2ZW50LnN0b3BQcm9wYWdhdGlvbigpO3ZhciAkcm93PSQoZXZlbnQudGFyZ2V0KS5jbG9zZXN0KCd0cicpO3ZhciBpZD0kcm93LmRhdGEoJ2lkJyk7aWYoJHJvdy5oYXNDbGFzcygnb19zZWxlY3RlZF9yb3cnKSl7dGhpcy50cmlnZ2VyX3VwKCdsaXN0X3JlY29yZF9yZW1vdmUnLHtpZDppZH0pO31lbHNle3ZhciBzZWxmPXRoaXM7dGhpcy51bnNlbGVjdFJvdygpLnRoZW4oZnVuY3Rpb24oKXtzZWxmLnRyaWdnZXJfdXAoJ2xpc3RfcmVjb3JkX3JlbW92ZScse2lkOmlkfSk7fSk7fX0sX29uUmVzaXplOmZ1bmN0aW9uKCl7dGhpcy5jb2x1bW5XaWR0aHM9ZmFsc2U7dGhpcy5fZnJlZXplQ29sdW1uV2lkdGhzKCk7fSxfb25Sb3dDbGlja2VkOmZ1bmN0aW9uKGV2KXtpZighdGhpcy5faXNSZWNvcmRFZGl0YWJsZShldi5jdXJyZW50VGFyZ2V0LmRhdGFzZXQuaWQpKXtpZih0aGlzLmdldEVkaXRhYmxlUmVjb3JkSUQoKSl7dGhpcy51bnNlbGVjdFJvdygpO31lbHNle3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9fX0sX29uU29ydENvbHVtbjpmdW5jdGlvbigpe2lmKHRoaXMuY3VycmVudFJvdz09PW51bGwmJiF0aGlzLmlzUmVzaXppbmcpe3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9fSxfb25TdGFydFJlc2l6ZTpmdW5jdGlvbihldil7aWYoZXYud2hpY2ghPT0xKXtyZXR1cm47fQpldi5wcmV2ZW50RGVmYXVsdCgpO2V2LnN0b3BQcm9wYWdhdGlvbigpO3RoaXMuaXNSZXNpemluZz10cnVlO2NvbnN0IHRhYmxlPXRoaXMuZWwuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3RhYmxlJylbMF07Y29uc3QgdGg9ZXYudGFyZ2V0LmNsb3Nlc3QoJ3RoJyk7dGFibGUuc3R5bGUud2lkdGg9YCR7dGFibGUub2Zmc2V0V2lkdGh9cHhgO2NvbnN0IHRoUG9zaXRpb249Wy4uLnRoLnBhcmVudE5vZGUuY2hpbGRyZW5dLmluZGV4T2YodGgpO2NvbnN0IHJlc2l6aW5nQ29sdW1uRWxlbWVudHM9Wy4uLnRhYmxlLmdldEVsZW1lbnRzQnlUYWdOYW1lKCd0cicpXS5maWx0ZXIodHI9PnRyLmNoaWxkcmVuLmxlbmd0aD09PXRoLnBhcmVudE5vZGUuY2hpbGRyZW4ubGVuZ3RoKS5tYXAodHI9PnRyLmNoaWxkcmVuW3RoUG9zaXRpb25dKTtjb25zdCBvcHRpb25hbERyb3Bkb3duPXRoaXMuZWwuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnb19vcHRpb25hbF9jb2x1bW5zJylbMF07Y29uc3QgaW5pdGlhbFg9ZXYucGFnZVg7Y29uc3QgaW5pdGlhbFdpZHRoPXRoLm9mZnNldFdpZHRoO2NvbnN0IGluaXRpYWxUYWJsZVdpZHRoPXRhYmxlLm9mZnNldFdpZHRoO2NvbnN0IGluaXRpYWxEcm9wZG93blg9b3B0aW9uYWxEcm9wZG93bj9vcHRpb25hbERyb3Bkb3duLm9mZnNldExlZnQ6bnVsbDtjb25zdCByZXNpemVTdG9wcGluZ0V2ZW50cz1bJ2tleWRvd24nLCdtb3VzZWRvd24nLCdtb3VzZXVwJyxdO3RhYmxlLmNsYXNzTGlzdC5hZGQoJ29fcmVzaXppbmcnKTtyZXNpemluZ0NvbHVtbkVsZW1lbnRzLmZvckVhY2goZWw9PmVsLmNsYXNzTGlzdC5hZGQoJ29fY29sdW1uX3Jlc2l6aW5nJykpO2NvbnN0IHJlc2l6ZUhlYWRlcj1ldj0+e2V2LnByZXZlbnREZWZhdWx0KCk7ZXYuc3RvcFByb3BhZ2F0aW9uKCk7Y29uc3QgZGVsdGE9ZXYucGFnZVgtaW5pdGlhbFg7Y29uc3QgbmV3V2lkdGg9TWF0aC5tYXgoMTAsaW5pdGlhbFdpZHRoK2RlbHRhKTtjb25zdCB0YWJsZURlbHRhPW5ld1dpZHRoLWluaXRpYWxXaWR0aDt0aC5zdHlsZS53aWR0aD1gJHtuZXdXaWR0aH1weGA7dGFibGUuc3R5bGUud2lkdGg9YCR7aW5pdGlhbFRhYmxlV2lkdGggKyB0YWJsZURlbHRhfXB4YDtpZihvcHRpb25hbERyb3Bkb3duKXtvcHRpb25hbERyb3Bkb3duLnN0eWxlLmxlZnQ9YCR7aW5pdGlhbERyb3Bkb3duWCArIHRhYmxlRGVsdGF9cHhgO319O3RoaXMuX2FkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsd2luZG93LHJlc2l6ZUhlYWRlcik7Y29uc3Qgc3RvcFJlc2l6ZT1ldj0+e2lmKGV2LnR5cGU9PT0nbW91c2Vkb3duJyYmZXYud2hpY2g9PT0xKXtyZXR1cm47fQpldi5wcmV2ZW50RGVmYXVsdCgpO2V2LnN0b3BQcm9wYWdhdGlvbigpO2NsZWFyVGltZW91dCh0aGlzLnJlc2l6ZVRpbWVvdXQpO3RoaXMucmVzaXplVGltZW91dD1zZXRUaW1lb3V0KCgpPT57dGhpcy5pc1Jlc2l6aW5nPWZhbHNlO30sMTAwKTt3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJyxyZXNpemVIZWFkZXIpO3RhYmxlLmNsYXNzTGlzdC5yZW1vdmUoJ29fcmVzaXppbmcnKTtyZXNpemluZ0NvbHVtbkVsZW1lbnRzLmZvckVhY2goZWw9PmVsLmNsYXNzTGlzdC5yZW1vdmUoJ29fY29sdW1uX3Jlc2l6aW5nJykpO3Jlc2l6ZVN0b3BwaW5nRXZlbnRzLmZvckVhY2goc3RvcHBpbmdFdmVudD0+e3dpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKHN0b3BwaW5nRXZlbnQsc3RvcFJlc2l6ZSk7fSk7ZG9jdW1lbnQuYWN0aXZlRWxlbWVudC5ibHVyKCk7fTtyZXNpemVTdG9wcGluZ0V2ZW50cy5mb3JFYWNoKHN0b3BwaW5nRXZlbnQ9Pnt0aGlzLl9hZGRFdmVudExpc3RlbmVyKHN0b3BwaW5nRXZlbnQsd2luZG93LHN0b3BSZXNpemUpO30pO30sX29uVG9nZ2xlT3B0aW9uYWxDb2x1bW5Ecm9wZG93bjpmdW5jdGlvbihldil7dGhpcy51bnNlbGVjdFJvdygpLnRoZW4odGhpcy5fc3VwZXIuYmluZCh0aGlzLGV2KSk7fSxfb25XaW5kb3dDbGlja2VkOmZ1bmN0aW9uKGV2ZW50KXtpZighdGhpcy5pc0VkaXRhYmxlKCkpe3JldHVybjt9CmlmKCFkb2N1bWVudC5jb250YWlucyh0aGlzLmVsKSl7cmV0dXJuO30KaWYodGhpcy5jdXJyZW50Um93PT09bnVsbCl7cmV0dXJuO30KaWYoJChldmVudC50YXJnZXQpLnBhcmVudHMoJy51aS1hdXRvY29tcGxldGUnKS5sZW5ndGgpe3JldHVybjt9CnZhciAkY2xpY2tNb2RhbD0kKGV2ZW50LnRhcmdldCkuY2xvc2VzdCgnLm1vZGFsJyk7aWYoJGNsaWNrTW9kYWwubGVuZ3RoKXt2YXIgJGxpc3RNb2RhbD10aGlzLiRlbC5jbG9zZXN0KCcubW9kYWwnKTtpZigkY2xpY2tNb2RhbC5wcm9wKCdpZCcpIT09JGxpc3RNb2RhbC5wcm9wKCdpZCcpKXtyZXR1cm47fX0KaWYoIWRvY3VtZW50LmNvbnRhaW5zKGV2ZW50LnRhcmdldCkpe3JldHVybjt9CmlmKHRoaXMuZWwuY29udGFpbnMoZXZlbnQudGFyZ2V0KSYmdGhpcy5lbCE9PWV2ZW50LnRhcmdldCl7cmV0dXJuO30KdGhpcy51bnNlbGVjdFJvdygpO30sfSk7fSk7OwoKLyogL3dlYi9zdGF0aWMvc3JjL2pzL3ZpZXdzL2xpc3QvbGlzdF9tb2RlbC5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwpvZG9vLmRlZmluZSgnd2ViLkxpc3RNb2RlbCcsZnVuY3Rpb24ocmVxdWlyZSl7InVzZSBzdHJpY3QiO3ZhciBCYXNpY01vZGVsPXJlcXVpcmUoJ3dlYi5CYXNpY01vZGVsJyk7dmFyIExpc3RNb2RlbD1CYXNpY01vZGVsLmV4dGVuZCh7aW5pdDpmdW5jdGlvbihwYXJlbnQscGFyYW1zKXt0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy5ncm91cGJ5cz1wYXJhbXMuZ3JvdXBieXM7fSxnZXQ6ZnVuY3Rpb24oKXt2YXIgcmVzdWx0PXRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt2YXIgZHA9cmVzdWx0JiZ0aGlzLmxvY2FsRGF0YVtyZXN1bHQuaWRdO2lmKGRwJiZkcC5ncm91cERhdGEpe3Jlc3VsdC5ncm91cERhdGE9dGhpcy5nZXQoZHAuZ3JvdXBEYXRhKTt9CnJldHVybiByZXN1bHQ7fSxzYXZlUmVjb3JkczpmdW5jdGlvbihsaXN0RGF0YXBvaW50SWQscmVmZXJlbmNlUmVjb3JkSWQscmVjb3JkSWRzLGZpZWxkTmFtZSl7dmFyIHNlbGY9dGhpczt2YXIgcmVmZXJlbmNlUmVjb3JkPXRoaXMubG9jYWxEYXRhW3JlZmVyZW5jZVJlY29yZElkXTt2YXIgbGlzdD10aGlzLmxvY2FsRGF0YVtsaXN0RGF0YXBvaW50SWRdO3ZhciBhbGxDaGFuZ2VzPXRoaXMuX2dlbmVyYXRlQ2hhbmdlcyhyZWZlcmVuY2VSZWNvcmQse2NoYW5nZXNPbmx5OmZhbHNlfSk7dmFyIGNoYW5nZXM9Xy5waWNrKGFsbENoYW5nZXMsZmllbGROYW1lKTt2YXIgcmVjb3Jkcz1yZWNvcmRJZHMubWFwKGZ1bmN0aW9uKHJlY29yZElkKXtyZXR1cm4gc2VsZi5sb2NhbERhdGFbcmVjb3JkSWRdO30pO3ZhciBtb2RlbD1yZWNvcmRzWzBdLm1vZGVsO3ZhciByZWNvcmRSZXNJZHM9Xy5wbHVjayhyZWNvcmRzLCdyZXNfaWQnKTt2YXIgZmllbGROYW1lcz1yZWNvcmRzWzBdLmdldEZpZWxkTmFtZXMoKTt2YXIgY29udGV4dD1yZWNvcmRzWzBdLmdldENvbnRleHQoKTtyZXR1cm4gdGhpcy5fcnBjKHttb2RlbDptb2RlbCxtZXRob2Q6J3dyaXRlJyxhcmdzOltyZWNvcmRSZXNJZHMsY2hhbmdlc10sY29udGV4dDpjb250ZXh0LH0pLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gc2VsZi5fcnBjKHttb2RlbDptb2RlbCxtZXRob2Q6J3JlYWQnLGFyZ3M6W3JlY29yZFJlc0lkcyxmaWVsZE5hbWVzXSxjb250ZXh0OmNvbnRleHQsfSk7fSkudGhlbihmdW5jdGlvbihyZXN1bHRzKXtyZXN1bHRzLmZvckVhY2goZnVuY3Rpb24oZGF0YSl7dmFyIHJlY29yZD1fLmZpbmRXaGVyZShyZWNvcmRzLHtyZXNfaWQ6ZGF0YS5pZH0pO3JlY29yZC5kYXRhPV8uZXh0ZW5kKHt9LHJlY29yZC5kYXRhLGRhdGEpO3JlY29yZC5fY2hhbmdlcz17fTtyZWNvcmQuX2lzRGlydHk9ZmFsc2U7c2VsZi5fcGFyc2VTZXJ2ZXJEYXRhKGZpZWxkTmFtZXMscmVjb3JkLHJlY29yZC5kYXRhKTt9KTt9KS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIFByb21pc2UuYWxsKFtzZWxmLl9mZXRjaFgyTWFueXNCYXRjaGVkKGxpc3QpLHNlbGYuX2ZldGNoUmVmZXJlbmNlc0JhdGNoZWQobGlzdCldKTt9KTt9LF9yZWFkR3JvdXA6ZnVuY3Rpb24obGlzdCxvcHRpb25zKXt2YXIgc2VsZj10aGlzO29wdGlvbnM9b3B0aW9uc3x8e307b3B0aW9ucy5mZXRjaFJlY29yZHNXaXRoR3JvdXBzPXRydWU7cmV0dXJuIHRoaXMuX3N1cGVyKGxpc3Qsb3B0aW9ucykudGhlbihmdW5jdGlvbihyZXN1bHQpe3JldHVybiBzZWxmLl9yZWFkR3JvdXBFeHRyYUZpZWxkcyhsaXN0KS50aGVuKF8uY29uc3RhbnQocmVzdWx0KSk7fSk7fSxfcmVhZEdyb3VwRXh0cmFGaWVsZHM6ZnVuY3Rpb24obGlzdCl7dmFyIHNlbGY9dGhpczt2YXIgZ3JvdXBCeUZpZWxkTmFtZT1saXN0Lmdyb3VwZWRCeVswXS5zcGxpdCgnOicpWzBdO3ZhciBncm91cGVkQnlGaWVsZD1saXN0LmZpZWxkc1tncm91cEJ5RmllbGROYW1lXTtpZihncm91cGVkQnlGaWVsZC50eXBlIT09J21hbnkyb25lJ3x8IXRoaXMuZ3JvdXBieXNbZ3JvdXBCeUZpZWxkTmFtZV0pe3JldHVybiBQcm9taXNlLnJlc29sdmUoKTt9CnZhciBncm91cElkcz1fLnJlZHVjZShsaXN0LmRhdGEsZnVuY3Rpb24oZ3JvdXBJZHMsaWQpe3ZhciByZXNJZD1zZWxmLmdldChpZCx7cmF3OnRydWV9KS5yZXNfaWQ7aWYocmVzSWQpe2dyb3VwSWRzLnB1c2gocmVzSWQpO30KcmV0dXJuIGdyb3VwSWRzO30sW10pO3ZhciBncm91cEZpZWxkcz1PYmplY3Qua2V5cyh0aGlzLmdyb3VwYnlzW2dyb3VwQnlGaWVsZE5hbWVdLnZpZXdGaWVsZHMpO3ZhciBwcm9tO2lmKGdyb3VwSWRzLmxlbmd0aCYmZ3JvdXBGaWVsZHMubGVuZ3RoKXtwcm9tPXRoaXMuX3JwYyh7bW9kZWw6Z3JvdXBlZEJ5RmllbGQucmVsYXRpb24sbWV0aG9kOidyZWFkJyxhcmdzOltncm91cElkcyxncm91cEZpZWxkc10sY29udGV4dDpsaXN0LmNvbnRleHQsfSk7fQpyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHByb20pLnRoZW4oZnVuY3Rpb24ocmVzdWx0KXt2YXIgZnZnPXNlbGYuZ3JvdXBieXNbZ3JvdXBCeUZpZWxkTmFtZV07Xy5lYWNoKGxpc3QuZGF0YSxmdW5jdGlvbihpZCl7dmFyIGRwPXNlbGYubG9jYWxEYXRhW2lkXTt2YXIgZ3JvdXBEYXRhPXJlc3VsdCYmXy5maW5kV2hlcmUocmVzdWx0LHtpZDpkcC5yZXNfaWQsfSk7dmFyIGdyb3VwRHA9c2VsZi5fbWFrZURhdGFQb2ludCh7Y29udGV4dDpkcC5jb250ZXh0LGRhdGE6Z3JvdXBEYXRhLGZpZWxkczpmdmcuZmllbGRzLGZpZWxkc0luZm86ZnZnLmZpZWxkc0luZm8sbW9kZWxOYW1lOmdyb3VwZWRCeUZpZWxkLnJlbGF0aW9uLHBhcmVudElEOmRwLmlkLHJlc19pZDpkcC5yZXNfaWQsdmlld1R5cGU6J2dyb3VwYnknLH0pO2RwLmdyb3VwRGF0YT1ncm91cERwLmlkO30pO30pO30sfSk7cmV0dXJuIExpc3RNb2RlbDt9KTs7CgovKiAvd2ViL3N0YXRpYy9zcmMvanMvdmlld3MvbGlzdC9saXN0X3JlbmRlcmVyLmpzIGRlZmluZWQgaW4gYnVuZGxlICd3ZWIuYXNzZXRzX2JhY2tlbmQnICovCm9kb28uZGVmaW5lKCd3ZWIuTGlzdFJlbmRlcmVyJyxmdW5jdGlvbihyZXF1aXJlKXsidXNlIHN0cmljdCI7dmFyIEJhc2ljUmVuZGVyZXI9cmVxdWlyZSgnd2ViLkJhc2ljUmVuZGVyZXInKTt2YXIgY29uZmlnPXJlcXVpcmUoJ3dlYi5jb25maWcnKTt2YXIgY29yZT1yZXF1aXJlKCd3ZWIuY29yZScpO3ZhciBkb209cmVxdWlyZSgnd2ViLmRvbScpO3ZhciBmaWVsZF91dGlscz1yZXF1aXJlKCd3ZWIuZmllbGRfdXRpbHMnKTt2YXIgUGFnZXI9cmVxdWlyZSgnd2ViLlBhZ2VyJyk7dmFyIHV0aWxzPXJlcXVpcmUoJ3dlYi51dGlscycpO3ZhciB2aWV3VXRpbHM9cmVxdWlyZSgnd2ViLnZpZXdVdGlscycpO3ZhciBfdD1jb3JlLl90O3ZhciBERUNPUkFUSU9OUz1bJ2RlY29yYXRpb24tYmYnLCdkZWNvcmF0aW9uLWl0JywnZGVjb3JhdGlvbi1kYW5nZXInLCdkZWNvcmF0aW9uLWluZm8nLCdkZWNvcmF0aW9uLW11dGVkJywnZGVjb3JhdGlvbi1wcmltYXJ5JywnZGVjb3JhdGlvbi1zdWNjZXNzJywnZGVjb3JhdGlvbi13YXJuaW5nJ107dmFyIEZJRUxEX0NMQVNTRVM9e2NoYXI6J29fbGlzdF9jaGFyJyxmbG9hdDonb19saXN0X251bWJlcicsaW50ZWdlcjonb19saXN0X251bWJlcicsbW9uZXRhcnk6J29fbGlzdF9udW1iZXInLHRleHQ6J29fbGlzdF90ZXh0JyxtYW55Mm9uZTonb19saXN0X21hbnkyb25lJyx9O3ZhciBMaXN0UmVuZGVyZXI9QmFzaWNSZW5kZXJlci5leHRlbmQoe2V2ZW50czp7Im1vdXNlZG93biI6Il9vbk1vdXNlRG93biIsImNsaWNrIC5vX29wdGlvbmFsX2NvbHVtbnNfZHJvcGRvd24gLmRyb3Bkb3duLWl0ZW0iOiJfb25Ub2dnbGVPcHRpb25hbENvbHVtbiIsImNsaWNrIC5vX29wdGlvbmFsX2NvbHVtbnNfZHJvcGRvd25fdG9nZ2xlIjoiX29uVG9nZ2xlT3B0aW9uYWxDb2x1bW5Ecm9wZG93biIsJ2NsaWNrIHRib2R5IHRyJzonX29uUm93Q2xpY2tlZCcsJ2NoYW5nZSB0Ym9keSAub19saXN0X3JlY29yZF9zZWxlY3Rvcic6J19vblNlbGVjdFJlY29yZCcsJ2NsaWNrIHRoZWFkIHRoLm9fY29sdW1uX3NvcnRhYmxlJzonX29uU29ydENvbHVtbicsJ2NsaWNrIC5vX2dyb3VwX2hlYWRlcic6J19vblRvZ2dsZUdyb3VwJywnY2hhbmdlIHRoZWFkIC5vX2xpc3RfcmVjb3JkX3NlbGVjdG9yIGlucHV0JzonX29uVG9nZ2xlU2VsZWN0aW9uJywna2V5cHJlc3MgdGhlYWQgdHIgdGQnOidfb25LZXlQcmVzcycsJ2tleWRvd24gdGQnOidfb25LZXlEb3duJywna2V5ZG93biB0aCc6J19vbktleURvd24nLH0saW5pdDpmdW5jdGlvbihwYXJlbnQsc3RhdGUscGFyYW1zKXt0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy5jb2x1bW5JbnZpc2libGVGaWVsZHM9cGFyYW1zLmNvbHVtbkludmlzaWJsZUZpZWxkczt0aGlzLnJvd0RlY29yYXRpb25zPV8uY2hhaW4odGhpcy5hcmNoLmF0dHJzKS5waWNrKGZ1bmN0aW9uKHZhbHVlLGtleSl7cmV0dXJuIERFQ09SQVRJT05TLmluZGV4T2Yoa2V5KT49MDt9KS5tYXBPYmplY3QoZnVuY3Rpb24odmFsdWUpe3JldHVybiBweS5wYXJzZShweS50b2tlbml6ZSh2YWx1ZSkpO30pLnZhbHVlKCk7dGhpcy5oYXNTZWxlY3RvcnM9cGFyYW1zLmhhc1NlbGVjdG9yczt0aGlzLnNlbGVjdGlvbj1wYXJhbXMuc2VsZWN0ZWRSZWNvcmRzfHxbXTt0aGlzLnBhZ2Vycz1bXTt0aGlzLmlzR3JvdXBlZD10aGlzLnN0YXRlLmdyb3VwZWRCeS5sZW5ndGg+MDt0aGlzLmdyb3VwYnlzPXBhcmFtcy5ncm91cGJ5czt9LHdpbGxTdGFydDpmdW5jdGlvbigpe3RoaXMuX3Byb2Nlc3NDb2x1bW5zKHRoaXMuY29sdW1uSW52aXNpYmxlRmllbGRzfHx7fSk7cmV0dXJuIHRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9LGdpdmVGb2N1czpmdW5jdGlvbigpe3RoaXMuJCgndGg6ZXEoMCkgaW5wdXQsIHRoOmVxKDEpJykuZmlyc3QoKS5mb2N1cygpO30sdXBkYXRlU3RhdGU6ZnVuY3Rpb24oc3RhdGUscGFyYW1zKXt0aGlzLmlzR3JvdXBlZD1zdGF0ZS5ncm91cGVkQnkubGVuZ3RoPjA7dGhpcy5fcHJvY2Vzc0NvbHVtbnMocGFyYW1zLmNvbHVtbkludmlzaWJsZUZpZWxkc3x8e30pO2lmKHBhcmFtcy5zZWxlY3RlZFJlY29yZHMpe3RoaXMuc2VsZWN0aW9uPXBhcmFtcy5zZWxlY3RlZFJlY29yZHM7fQpyZXR1cm4gdGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO30sX2NvbXB1dGVBZ2dyZWdhdGVzOmZ1bmN0aW9uKCl7dmFyIHNlbGY9dGhpczt2YXIgZGF0YT1bXTtpZih0aGlzLnNlbGVjdGlvbi5sZW5ndGgpe3V0aWxzLnRyYXZlcnNlX3JlY29yZHModGhpcy5zdGF0ZSxmdW5jdGlvbihyZWNvcmQpe2lmKF8uY29udGFpbnMoc2VsZi5zZWxlY3Rpb24scmVjb3JkLmlkKSl7ZGF0YS5wdXNoKHJlY29yZCk7fX0pO31lbHNle2RhdGE9dGhpcy5zdGF0ZS5kYXRhO30KXy5lYWNoKHRoaXMuY29sdW1ucyx0aGlzLl9jb21wdXRlQ29sdW1uQWdncmVnYXRlcy5iaW5kKHRoaXMsZGF0YSkpO30sX2NvbXB1dGVDb2x1bW5BZ2dyZWdhdGVzOmZ1bmN0aW9uKGRhdGEsY29sdW1uKXt2YXIgYXR0cnM9Y29sdW1uLmF0dHJzO3ZhciBmaWVsZD10aGlzLnN0YXRlLmZpZWxkc1thdHRycy5uYW1lXTtpZighZmllbGQpe3JldHVybjt9CnZhciB0eXBlPWZpZWxkLnR5cGU7aWYodHlwZSE9PSdpbnRlZ2VyJyYmdHlwZSE9PSdmbG9hdCcmJnR5cGUhPT0nbW9uZXRhcnknKXtyZXR1cm47fQp2YXIgZnVuYz0oYXR0cnMuc3VtJiYnc3VtJyl8fChhdHRycy5hdmcmJidhdmcnKXx8KGF0dHJzLm1heCYmJ21heCcpfHwoYXR0cnMubWluJiYnbWluJyk7aWYoZnVuYyl7dmFyIGNvdW50PTA7dmFyIGFnZ3JlZ2F0ZVZhbHVlPTA7aWYoZnVuYz09PSdtYXgnKXthZ2dyZWdhdGVWYWx1ZT0tSW5maW5pdHk7fWVsc2UgaWYoZnVuYz09PSdtaW4nKXthZ2dyZWdhdGVWYWx1ZT1JbmZpbml0eTt9Cl8uZWFjaChkYXRhLGZ1bmN0aW9uKGQpe2NvdW50Kz0xO3ZhciB2YWx1ZT0oZC50eXBlPT09J3JlY29yZCcpP2QuZGF0YVthdHRycy5uYW1lXTpkLmFnZ3JlZ2F0ZVZhbHVlc1thdHRycy5uYW1lXTtpZihmdW5jPT09J2F2Zycpe2FnZ3JlZ2F0ZVZhbHVlKz12YWx1ZTt9ZWxzZSBpZihmdW5jPT09J3N1bScpe2FnZ3JlZ2F0ZVZhbHVlKz12YWx1ZTt9ZWxzZSBpZihmdW5jPT09J21heCcpe2FnZ3JlZ2F0ZVZhbHVlPU1hdGgubWF4KGFnZ3JlZ2F0ZVZhbHVlLHZhbHVlKTt9ZWxzZSBpZihmdW5jPT09J21pbicpe2FnZ3JlZ2F0ZVZhbHVlPU1hdGgubWluKGFnZ3JlZ2F0ZVZhbHVlLHZhbHVlKTt9fSk7aWYoZnVuYz09PSdhdmcnKXthZ2dyZWdhdGVWYWx1ZT1jb3VudD9hZ2dyZWdhdGVWYWx1ZS9jb3VudDphZ2dyZWdhdGVWYWx1ZTt9CmNvbHVtbi5hZ2dyZWdhdGU9e2hlbHA6YXR0cnNbZnVuY10sdmFsdWU6YWdncmVnYXRlVmFsdWUsfTt9fSxfZmluZENvbm5lY3RlZENlbGw6ZnVuY3Rpb24oJGNlbGwsZGlyZWN0aW9uLGNvbEluZGV4KXt2YXIgJGNvbm5lY3RlZFJvdz0kY2VsbC5jbG9zZXN0KCd0cicpW2RpcmVjdGlvbl0oJ3RyJyk7aWYoISRjb25uZWN0ZWRSb3cubGVuZ3RoKXt2YXIgdGJvZHk9JGNlbGwuY2xvc2VzdCgndGJvZHksIHRoZWFkJyk7dmFyICRjb25uZWN0ZWRHcm91cD10Ym9keVtkaXJlY3Rpb25dKCd0Ym9keSwgdGhlYWQnKTtpZigkY29ubmVjdGVkR3JvdXAubGVuZ3RoKXt2YXIgJGNvbm5lY3RlZFJvd3M9JGNvbm5lY3RlZEdyb3VwLmZpbmQoJ3RyJyk7dmFyIHJvd0luZGV4O2lmKGRpcmVjdGlvbj09PSdwcmV2Jyl7cm93SW5kZXg9JGNvbm5lY3RlZFJvd3MubGVuZ3RoLTE7fWVsc2V7cm93SW5kZXg9MDt9CiRjb25uZWN0ZWRSb3c9JGNvbm5lY3RlZFJvd3MuZXEocm93SW5kZXgpO31lbHNle3JldHVybjt9fQp2YXIgJGNvbm5lY3RlZENlbGw7aWYoJGNvbm5lY3RlZFJvdy5oYXNDbGFzcygnb19ncm91cF9oZWFkZXInKSl7JGNvbm5lY3RlZENlbGw9JGNvbm5lY3RlZFJvdy5jaGlsZHJlbigpO3RoaXMuY3VycmVudENvbEluZGV4PWNvbEluZGV4O31lbHNlIGlmKCRjb25uZWN0ZWRSb3cuaGFzKCd0ZC5vX2dyb3VwX2ZpZWxkX3Jvd19hZGQnKS5sZW5ndGgpeyRjb25uZWN0ZWRDZWxsPSRjb25uZWN0ZWRSb3cuZmluZCgnLm9fZ3JvdXBfZmllbGRfcm93X2FkZCcpO3RoaXMuY3VycmVudENvbEluZGV4PWNvbEluZGV4O31lbHNle3ZhciBjb25uZWN0ZWRSb3dDaGlsZHJlbj0kY29ubmVjdGVkUm93LmNoaWxkcmVuKCk7aWYoY29sSW5kZXg9PT0tMSl7Y29sSW5kZXg9Y29ubmVjdGVkUm93Q2hpbGRyZW4ubGVuZ3RoLTE7fQokY29ubmVjdGVkQ2VsbD1jb25uZWN0ZWRSb3dDaGlsZHJlbi5lcShjb2xJbmRleCk7fQpyZXR1cm4gJGNvbm5lY3RlZENlbGw7fSxfZ2V0TnVtYmVyT2ZDb2xzOmZ1bmN0aW9uKCl7dmFyIG49dGhpcy5jb2x1bW5zLmxlbmd0aDtyZXR1cm4gdGhpcy5oYXNTZWxlY3RvcnM/bisxOm47fSxfZ2V0T3B0aW9uYWxDb2x1bW5zU3RvcmFnZUtleVBhcnRzOmZ1bmN0aW9uKCl7dmFyIHNlbGY9dGhpcztyZXR1cm57ZmllbGRzOl8ubWFwKHRoaXMuc3RhdGUuZmllbGRzSW5mb1t0aGlzLnZpZXdUeXBlXSxmdW5jdGlvbihfLGZpZWxkTmFtZSl7cmV0dXJue25hbWU6ZmllbGROYW1lLHR5cGU6c2VsZi5zdGF0ZS5maWVsZHNbZmllbGROYW1lXS50eXBlfTt9KSx9O30sX3Byb2Nlc3NDb2x1bW5zOmZ1bmN0aW9uKGNvbHVtbkludmlzaWJsZUZpZWxkcyl7dmFyIHNlbGY9dGhpczt0aGlzLmhhbmRsZUZpZWxkPW51bGw7dGhpcy5jb2x1bW5zPVtdO3RoaXMub3B0aW9uYWxDb2x1bW5zPVtdO3RoaXMub3B0aW9uYWxDb2x1bW5zRW5hYmxlZD1bXTt2YXIgc3RvcmVkT3B0aW9uYWxDb2x1bW5zO3RoaXMudHJpZ2dlcl91cCgnbG9hZF9vcHRpb25hbF9maWVsZHMnLHtrZXlQYXJ0czp0aGlzLl9nZXRPcHRpb25hbENvbHVtbnNTdG9yYWdlS2V5UGFydHMoKSxjYWxsYmFjazpmdW5jdGlvbihyZXMpe3N0b3JlZE9wdGlvbmFsQ29sdW1ucz1yZXM7fSx9KTtfLmVhY2godGhpcy5hcmNoLmNoaWxkcmVuLGZ1bmN0aW9uKGMpe2lmKGMudGFnIT09J2NvbnRyb2wnJiZjLnRhZyE9PSdncm91cGJ5Jyl7dmFyIHJlamVjdD1jLmF0dHJzLm1vZGlmaWVycy5jb2x1bW5faW52aXNpYmxlO2lmKGMuYXR0cnMubmFtZSBpbiBjb2x1bW5JbnZpc2libGVGaWVsZHMpe3JlamVjdD1jb2x1bW5JbnZpc2libGVGaWVsZHNbYy5hdHRycy5uYW1lXTt9CmlmKGMuYXR0cnMuY2xhc3Mpe2lmKGMuYXR0cnMuY2xhc3MubWF0Y2goL1xib2VfZWRpdF9vbmx5XGIvKSl7Yy5hdHRycy5lZGl0T25seT10cnVlO30KaWYoYy5hdHRycy5jbGFzcy5tYXRjaCgvXGJvZV9yZWFkX29ubHlcYi8pKXtjLmF0dHJzLnJlYWRPbmx5PXRydWU7fX0KaWYoIXJlamVjdCYmYy5hdHRycy53aWRnZXQ9PT0naGFuZGxlJyl7c2VsZi5oYW5kbGVGaWVsZD1jLmF0dHJzLm5hbWU7aWYoc2VsZi5pc0dyb3VwZWQpe3JlamVjdD10cnVlO319CmlmKCFyZWplY3QmJmMuYXR0cnMub3B0aW9uYWwpe3NlbGYub3B0aW9uYWxDb2x1bW5zLnB1c2goYyk7dmFyIGVuYWJsZWQ7aWYoc3RvcmVkT3B0aW9uYWxDb2x1bW5zPT09dW5kZWZpbmVkKXtlbmFibGVkPWMuYXR0cnMub3B0aW9uYWw9PT0nc2hvdyc7fWVsc2V7ZW5hYmxlZD1fLmNvbnRhaW5zKHN0b3JlZE9wdGlvbmFsQ29sdW1ucyxjLmF0dHJzLm5hbWUpO30KaWYoZW5hYmxlZCl7c2VsZi5vcHRpb25hbENvbHVtbnNFbmFibGVkLnB1c2goYy5hdHRycy5uYW1lKTt9CnJlamVjdD0hZW5hYmxlZDt9CmlmKCFyZWplY3Qpe3NlbGYuY29sdW1ucy5wdXNoKGMpO319fSk7fSxfcmVuZGVyQWdncmVnYXRlQ2VsbHM6ZnVuY3Rpb24oYWdncmVnYXRlVmFsdWVzKXt2YXIgc2VsZj10aGlzO3JldHVybiBfLm1hcCh0aGlzLmNvbHVtbnMsZnVuY3Rpb24oY29sdW1uKXt2YXIgJGNlbGw9JCgnPHRkPicpO2lmKGNvbmZpZy5pc0RlYnVnKCkpeyRjZWxsLmFkZENsYXNzKGNvbHVtbi5hdHRycy5uYW1lKTt9CmlmKGNvbHVtbi5hdHRycy5lZGl0T25seSl7JGNlbGwuYWRkQ2xhc3MoJ29lX2VkaXRfb25seScpO30KaWYoY29sdW1uLmF0dHJzLnJlYWRPbmx5KXskY2VsbC5hZGRDbGFzcygnb2VfcmVhZF9vbmx5Jyk7fQppZihjb2x1bW4uYXR0cnMubmFtZSBpbiBhZ2dyZWdhdGVWYWx1ZXMpe3ZhciBmaWVsZD1zZWxmLnN0YXRlLmZpZWxkc1tjb2x1bW4uYXR0cnMubmFtZV07dmFyIHZhbHVlPWFnZ3JlZ2F0ZVZhbHVlc1tjb2x1bW4uYXR0cnMubmFtZV0udmFsdWU7dmFyIGhlbHA9YWdncmVnYXRlVmFsdWVzW2NvbHVtbi5hdHRycy5uYW1lXS5oZWxwO3ZhciBmb3JtYXRGdW5jPWZpZWxkX3V0aWxzLmZvcm1hdFtjb2x1bW4uYXR0cnMud2lkZ2V0XTtpZighZm9ybWF0RnVuYyl7Zm9ybWF0RnVuYz1maWVsZF91dGlscy5mb3JtYXRbZmllbGQudHlwZV07fQp2YXIgZm9ybWF0dGVkVmFsdWU9Zm9ybWF0RnVuYyh2YWx1ZSxmaWVsZCx7ZXNjYXBlOnRydWV9KTskY2VsbC5hZGRDbGFzcygnb19saXN0X251bWJlcicpLmF0dHIoJ3RpdGxlJyxoZWxwKS5odG1sKGZvcm1hdHRlZFZhbHVlKTt9CnJldHVybiAkY2VsbDt9KTt9LF9yZW5kZXJCb2R5OmZ1bmN0aW9uKCl7dmFyIHNlbGY9dGhpczt2YXIgJHJvd3M9dGhpcy5fcmVuZGVyUm93cygpO3doaWxlKCRyb3dzLmxlbmd0aDw0KXskcm93cy5wdXNoKHNlbGYuX3JlbmRlckVtcHR5Um93KCkpO30KcmV0dXJuICQoJzx0Ym9keT4nKS5hcHBlbmQoJHJvd3MpO30sX3JlbmRlckJvZHlDZWxsOmZ1bmN0aW9uKHJlY29yZCxub2RlLGNvbEluZGV4LG9wdGlvbnMpe3ZhciB0ZENsYXNzTmFtZT0nb19kYXRhX2NlbGwnO2lmKG5vZGUudGFnPT09J2J1dHRvbicpe3RkQ2xhc3NOYW1lKz0nIG9fbGlzdF9idXR0b24nO31lbHNlIGlmKG5vZGUudGFnPT09J2ZpZWxkJyl7dGRDbGFzc05hbWUrPScgb19maWVsZF9jZWxsJzt2YXIgdHlwZUNsYXNzPUZJRUxEX0NMQVNTRVNbdGhpcy5zdGF0ZS5maWVsZHNbbm9kZS5hdHRycy5uYW1lXS50eXBlXTtpZih0eXBlQ2xhc3Mpe3RkQ2xhc3NOYW1lKz0oJyAnK3R5cGVDbGFzcyk7fQppZihub2RlLmF0dHJzLndpZGdldCl7dGRDbGFzc05hbWUrPSgnIG9fJytub2RlLmF0dHJzLndpZGdldCsnX2NlbGwnKTt9fQppZihub2RlLmF0dHJzLmVkaXRPbmx5KXt0ZENsYXNzTmFtZSs9JyBvZV9lZGl0X29ubHknO30KaWYobm9kZS5hdHRycy5yZWFkT25seSl7dGRDbGFzc05hbWUrPScgb2VfcmVhZF9vbmx5Jzt9CnZhciAkdGQ9JCgnPHRkPicse2NsYXNzOnRkQ2xhc3NOYW1lLHRhYmluZGV4Oi0xfSk7dmFyIG1vZGlmaWVycz10aGlzLl9yZWdpc3Rlck1vZGlmaWVycyhub2RlLHJlY29yZCwkdGQsXy5waWNrKG9wdGlvbnMsJ21vZGUnKSk7aWYobW9kaWZpZXJzLmludmlzaWJsZSYmIShvcHRpb25zJiZvcHRpb25zLnJlbmRlckludmlzaWJsZSkpe3JldHVybiAkdGQ7fQppZihub2RlLnRhZz09PSdidXR0b24nKXtyZXR1cm4gJHRkLmFwcGVuZCh0aGlzLl9yZW5kZXJCdXR0b24ocmVjb3JkLG5vZGUpKTt9ZWxzZSBpZihub2RlLnRhZz09PSd3aWRnZXQnKXtyZXR1cm4gJHRkLmFwcGVuZCh0aGlzLl9yZW5kZXJXaWRnZXQocmVjb3JkLG5vZGUpKTt9CmlmKG5vZGUuYXR0cnMud2lkZ2V0fHwob3B0aW9ucyYmb3B0aW9ucy5yZW5kZXJXaWRnZXRzKSl7dmFyICRlbD10aGlzLl9yZW5kZXJGaWVsZFdpZGdldChub2RlLHJlY29yZCxfLnBpY2sob3B0aW9ucywnbW9kZScpKTtyZXR1cm4gJHRkLmFwcGVuZCgkZWwpO30KdmFyIG5hbWU9bm9kZS5hdHRycy5uYW1lO3ZhciBmaWVsZD10aGlzLnN0YXRlLmZpZWxkc1tuYW1lXTt2YXIgdmFsdWU9cmVjb3JkLmRhdGFbbmFtZV07dmFyIGZvcm1hdHRlZFZhbHVlPWZpZWxkX3V0aWxzLmZvcm1hdFtmaWVsZC50eXBlXSh2YWx1ZSxmaWVsZCx7ZGF0YTpyZWNvcmQuZGF0YSxlc2NhcGU6dHJ1ZSxpc1Bhc3N3b3JkOidwYXNzd29yZCdpbiBub2RlLmF0dHJzLGRpZ2l0czpub2RlLmF0dHJzLmRpZ2l0cyYmSlNPTi5wYXJzZShub2RlLmF0dHJzLmRpZ2l0cyksfSk7dGhpcy5faGFuZGxlQXR0cmlidXRlcygkdGQsbm9kZSk7dmFyIHRpdGxlPWZpZWxkLnR5cGUhPT0nYm9vbGVhbic/Zm9ybWF0dGVkVmFsdWU6Jyc7cmV0dXJuICR0ZC5odG1sKGZvcm1hdHRlZFZhbHVlKS5hdHRyKCd0aXRsZScsdGl0bGUpO30sX3JlbmRlckJ1dHRvbjpmdW5jdGlvbihyZWNvcmQsbm9kZSl7dmFyIHNlbGY9dGhpczt2YXIgJGJ1dHRvbj12aWV3VXRpbHMucmVuZGVyQnV0dG9uRnJvbU5vZGUobm9kZSx7ZXh0cmFDbGFzczpub2RlLmF0dHJzLmljb24/J29faWNvbl9idXR0b24nOnVuZGVmaW5lZCx0ZXh0QXNUaXRsZTohIW5vZGUuYXR0cnMuaWNvbix9KTt0aGlzLl9oYW5kbGVBdHRyaWJ1dGVzKCRidXR0b24sbm9kZSk7dGhpcy5fcmVnaXN0ZXJNb2RpZmllcnMobm9kZSxyZWNvcmQsJGJ1dHRvbik7aWYocmVjb3JkLnJlc19pZCl7JGJ1dHRvbi5vbigiY2xpY2siLGZ1bmN0aW9uKGUpe2Uuc3RvcFByb3BhZ2F0aW9uKCk7c2VsZi50cmlnZ2VyX3VwKCdidXR0b25fY2xpY2tlZCcse2F0dHJzOm5vZGUuYXR0cnMscmVjb3JkOnJlY29yZCx9KTt9KTt9ZWxzZXtpZihub2RlLmF0dHJzLm9wdGlvbnMud2Fybil7JGJ1dHRvbi5vbigiY2xpY2siLGZ1bmN0aW9uKGUpe2Uuc3RvcFByb3BhZ2F0aW9uKCk7c2VsZi5kb193YXJuKF90KCJXYXJuaW5nIiksX3QoJ1BsZWFzZSBjbGljayBvbiB0aGUgInNhdmUiIGJ1dHRvbiBmaXJzdC4nKSk7fSk7fWVsc2V7JGJ1dHRvbi5wcm9wKCdkaXNhYmxlZCcsdHJ1ZSk7fX0KcmV0dXJuICRidXR0b247fSxfcmVuZGVyRW1wdHlSb3c6ZnVuY3Rpb24oKXt2YXIgJHRkPSQoJzx0ZD4mbmJzcDs8L3RkPicpLmF0dHIoJ2NvbHNwYW4nLHRoaXMuX2dldE51bWJlck9mQ29scygpKTtyZXR1cm4gJCgnPHRyPicpLmFwcGVuZCgkdGQpO30sX3JlbmRlckZvb3RlcjpmdW5jdGlvbigpe3ZhciBhZ2dyZWdhdGVzPXt9O18uZWFjaCh0aGlzLmNvbHVtbnMsZnVuY3Rpb24oY29sdW1uKXtpZignYWdncmVnYXRlJ2luIGNvbHVtbil7YWdncmVnYXRlc1tjb2x1bW4uYXR0cnMubmFtZV09Y29sdW1uLmFnZ3JlZ2F0ZTt9fSk7dmFyICRjZWxscz10aGlzLl9yZW5kZXJBZ2dyZWdhdGVDZWxscyhhZ2dyZWdhdGVzKTtpZih0aGlzLmhhc1NlbGVjdG9ycyl7JGNlbGxzLnVuc2hpZnQoJCgnPHRkPicpKTt9CnJldHVybiAkKCc8dGZvb3Q+JykuYXBwZW5kKCQoJzx0cj4nKS5hcHBlbmQoJGNlbGxzKSk7fSxfcmVuZGVyR3JvdXBCdXR0b246ZnVuY3Rpb24obGlzdCxub2RlKXt2YXIgJGJ1dHRvbj12aWV3VXRpbHMucmVuZGVyQnV0dG9uRnJvbU5vZGUobm9kZSx7ZXh0cmFDbGFzczpub2RlLmF0dHJzLmljb24/J29faWNvbl9idXR0b24nOnVuZGVmaW5lZCx0ZXh0QXNUaXRsZTohIW5vZGUuYXR0cnMuaWNvbix9KTt0aGlzLl9oYW5kbGVBdHRyaWJ1dGVzKCRidXR0b24sbm9kZSk7dGhpcy5fcmVnaXN0ZXJNb2RpZmllcnMobm9kZSxsaXN0Lmdyb3VwRGF0YSwkYnV0dG9uKTskYnV0dG9uLm9uKCJjbGljayIsdGhpcy5fb25Hcm91cEJ1dHRvbkNsaWNrZWQuYmluZCh0aGlzLGxpc3QuZ3JvdXBEYXRhLG5vZGUpKTskYnV0dG9uLm9uKCJrZXlkb3duIix0aGlzLl9vbkdyb3VwQnV0dG9uS2V5ZG93bi5iaW5kKHRoaXMpKTtyZXR1cm4gJGJ1dHRvbjt9LF9yZW5kZXJHcm91cEJ1dHRvbnM6ZnVuY3Rpb24obGlzdCxncm91cCl7dmFyIHNlbGY9dGhpczt2YXIgJGJ1dHRvbnM9JCgpO2lmKGxpc3QudmFsdWUpe2dyb3VwLmFyY2guY2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbihjaGlsZCl7aWYoY2hpbGQudGFnPT09J2J1dHRvbicpeyRidXR0b25zPSRidXR0b25zLmFkZChzZWxmLl9yZW5kZXJHcm91cEJ1dHRvbihsaXN0LGNoaWxkKSk7fX0pO30KcmV0dXJuICRidXR0b25zO30sX3JlbmRlckdyb3VwUGFnZXI6ZnVuY3Rpb24oZ3JvdXApe3ZhciBwYWdlcj1uZXcgUGFnZXIodGhpcyxncm91cC5jb3VudCxncm91cC5vZmZzZXQrMSxncm91cC5saW1pdCk7cGFnZXIub24oJ3BhZ2VyX2NoYW5nZWQnLHRoaXMsZnVuY3Rpb24obmV3U3RhdGUpe3ZhciBzZWxmPXRoaXM7cGFnZXIuZGlzYWJsZSgpO3RoaXMudHJpZ2dlcl91cCgnbG9hZCcse2lkOmdyb3VwLmlkLGxpbWl0Om5ld1N0YXRlLmxpbWl0LG9mZnNldDpuZXdTdGF0ZS5jdXJyZW50X21pbi0xLG9uX3N1Y2Nlc3M6ZnVuY3Rpb24ocmVsb2FkZWRHcm91cCl7Xy5leHRlbmQoZ3JvdXAscmVsb2FkZWRHcm91cCk7c2VsZi5fcmVuZGVyVmlldygpO30sb25fZmFpbDpwYWdlci5lbmFibGUuYmluZChwYWdlciksfSk7fSk7dGhpcy5wYWdlcnMucHVzaChwYWdlcik7dmFyIHBhZ2VyUHJvbT1wYWdlci5fd2lkZ2V0UmVuZGVyQW5kSW5zZXJ0KGZ1bmN0aW9uKCl7fSk7dGhpcy5kZWZzLnB1c2gocGFnZXJQcm9tKTt2YXIgJGVsPSQoJzxkaXY+Jyk7cGFnZXJQcm9tLnRoZW4oZnVuY3Rpb24oKXskZWwucmVwbGFjZVdpdGgocGFnZXIuJGVsKTt9KTtyZXR1cm4gJGVsO30sX3JlbmRlckdyb3VwUm93OmZ1bmN0aW9uKGdyb3VwLGdyb3VwTGV2ZWwpe3ZhciBjZWxscz1bXTt2YXIgbmFtZT1ncm91cC52YWx1ZT09PXVuZGVmaW5lZD9fdCgnVW5kZWZpbmVkJyk6Z3JvdXAudmFsdWU7dmFyIGdyb3VwQnk9dGhpcy5zdGF0ZS5ncm91cGVkQnlbZ3JvdXBMZXZlbF07aWYoZ3JvdXAuZmllbGRzW2dyb3VwQnkuc3BsaXQoJzonKVswXV0udHlwZSE9PSdib29sZWFuJyl7bmFtZT1uYW1lfHxfdCgnVW5kZWZpbmVkJyk7fQp2YXIgJHRoPSQoJzx0aD4nKS5hZGRDbGFzcygnb19ncm91cF9uYW1lJykuYXR0cigndGFiaW5kZXgnLC0xKS50ZXh0KG5hbWUrJyAoJytncm91cC5jb3VudCsnKScpO3ZhciAkYXJyb3c9JCgnPHNwYW4+JykuY3NzKCdwYWRkaW5nLWxlZnQnLChncm91cExldmVsKjIwKSsncHgnKS5jc3MoJ3BhZGRpbmctcmlnaHQnLCc1cHgnKS5hZGRDbGFzcygnZmEnKTtpZihncm91cC5jb3VudD4wKXskYXJyb3cudG9nZ2xlQ2xhc3MoJ2ZhLWNhcmV0LXJpZ2h0JywhZ3JvdXAuaXNPcGVuKS50b2dnbGVDbGFzcygnZmEtY2FyZXQtZG93bicsZ3JvdXAuaXNPcGVuKTt9CiR0aC5wcmVwZW5kKCRhcnJvdyk7Y2VsbHMucHVzaCgkdGgpO3ZhciBhZ2dyZWdhdGVLZXlzPU9iamVjdC5rZXlzKGdyb3VwLmFnZ3JlZ2F0ZVZhbHVlcyk7dmFyIGFnZ3JlZ2F0ZVZhbHVlcz1fLm1hcE9iamVjdChncm91cC5hZ2dyZWdhdGVWYWx1ZXMsZnVuY3Rpb24odmFsdWUpe3JldHVybnt2YWx1ZTp2YWx1ZX07fSk7dmFyIGFnZ3JlZ2F0ZUNlbGxzPXRoaXMuX3JlbmRlckFnZ3JlZ2F0ZUNlbGxzKGFnZ3JlZ2F0ZVZhbHVlcyk7dmFyIGZpcnN0QWdncmVnYXRlSW5kZXg9Xy5maW5kSW5kZXgodGhpcy5jb2x1bW5zLGZ1bmN0aW9uKGNvbHVtbil7cmV0dXJuIGNvbHVtbi50YWc9PT0nZmllbGQnJiZfLmNvbnRhaW5zKGFnZ3JlZ2F0ZUtleXMsY29sdW1uLmF0dHJzLm5hbWUpO30pO3ZhciBjb2xzcGFuQmVmb3JlQWdncmVnYXRlO2lmKGZpcnN0QWdncmVnYXRlSW5kZXghPT0tMSl7Y29sc3BhbkJlZm9yZUFnZ3JlZ2F0ZT1maXJzdEFnZ3JlZ2F0ZUluZGV4O3ZhciBsYXN0QWdncmVnYXRlSW5kZXg9Xy5maW5kTGFzdEluZGV4KHRoaXMuY29sdW1ucyxmdW5jdGlvbihjb2x1bW4pe3JldHVybiBjb2x1bW4udGFnPT09J2ZpZWxkJyYmXy5jb250YWlucyhhZ2dyZWdhdGVLZXlzLGNvbHVtbi5hdHRycy5uYW1lKTt9KTtjZWxscz1jZWxscy5jb25jYXQoYWdncmVnYXRlQ2VsbHMuc2xpY2UoZmlyc3RBZ2dyZWdhdGVJbmRleCxsYXN0QWdncmVnYXRlSW5kZXgrMSkpO3ZhciBjb2xTcGFuPXRoaXMuY29sdW1ucy5sZW5ndGgtMS1sYXN0QWdncmVnYXRlSW5kZXg7aWYoY29sU3Bhbj4wKXtjZWxscy5wdXNoKCQoJzx0aD4nKS5hdHRyKCdjb2xzcGFuJyxjb2xTcGFuKSk7fX1lbHNle3ZhciBjb2xOPXRoaXMuY29sdW1ucy5sZW5ndGg7Y29sc3BhbkJlZm9yZUFnZ3JlZ2F0ZT1jb2xOPjE/Y29sTi0xOjE7aWYoY29sTj4xKXtjZWxscy5wdXNoKCQoJzx0aD4nKSk7fX0KaWYodGhpcy5oYXNTZWxlY3RvcnMpe2NvbHNwYW5CZWZvcmVBZ2dyZWdhdGUrPTE7fQokdGguYXR0cignY29sc3BhbicsY29sc3BhbkJlZm9yZUFnZ3JlZ2F0ZSk7aWYoZ3JvdXAuaXNPcGVuJiYhZ3JvdXAuZ3JvdXBlZEJ5Lmxlbmd0aCYmKGdyb3VwLmNvdW50Pmdyb3VwLmRhdGEubGVuZ3RoKSl7dmFyICRwYWdlcj10aGlzLl9yZW5kZXJHcm91cFBhZ2VyKGdyb3VwKTt2YXIgJGxhc3RDZWxsPWNlbGxzW2NlbGxzLmxlbmd0aC0xXTskbGFzdENlbGwuYXBwZW5kKCRwYWdlcik7fQppZihncm91cC5pc09wZW4mJnRoaXMuZ3JvdXBieXNbZ3JvdXBCeV0pe3ZhciAkYnV0dG9ucz10aGlzLl9yZW5kZXJHcm91cEJ1dHRvbnMoZ3JvdXAsdGhpcy5ncm91cGJ5c1tncm91cEJ5XSk7aWYoJGJ1dHRvbnMubGVuZ3RoKXt2YXIgJGJ1dHRvblNlY3Rpb249JCgnPGRpdj4nLHtjbGFzczonb19ncm91cF9idXR0b25zJyx9KS5hcHBlbmQoJGJ1dHRvbnMpOyR0aC5hcHBlbmQoJGJ1dHRvblNlY3Rpb24pO319CnJldHVybiAkKCc8dHI+JykuYWRkQ2xhc3MoJ29fZ3JvdXBfaGVhZGVyJykudG9nZ2xlQ2xhc3MoJ29fZ3JvdXBfb3BlbicsZ3JvdXAuaXNPcGVuKS50b2dnbGVDbGFzcygnb19ncm91cF9oYXNfY29udGVudCcsZ3JvdXAuY291bnQ+MCkuZGF0YSgnZ3JvdXAnLGdyb3VwKS5hcHBlbmQoY2VsbHMpO30sX3JlbmRlckdyb3VwOmZ1bmN0aW9uKGdyb3VwLGdyb3VwTGV2ZWwpe3ZhciBzZWxmPXRoaXM7aWYoZ3JvdXAuZ3JvdXBlZEJ5Lmxlbmd0aCl7cmV0dXJuIHRoaXMuX3JlbmRlckdyb3Vwcyhncm91cC5kYXRhLGdyb3VwTGV2ZWwrMSk7fWVsc2V7dmFyICRyZWNvcmRzPV8ubWFwKGdyb3VwLmRhdGEsZnVuY3Rpb24ocmVjb3JkKXtyZXR1cm4gc2VsZi5fcmVuZGVyUm93KHJlY29yZCk7fSk7cmV0dXJuWyQoJzx0Ym9keT4nKS5hcHBlbmQoJHJlY29yZHMpXTt9fSxfcmVuZGVyR3JvdXBzOmZ1bmN0aW9uKGRhdGEsZ3JvdXBMZXZlbCl7dmFyIHNlbGY9dGhpcztncm91cExldmVsPWdyb3VwTGV2ZWx8fDA7dmFyIHJlc3VsdD1bXTt2YXIgJHRib2R5PSQoJzx0Ym9keT4nKTtfLmVhY2goZGF0YSxmdW5jdGlvbihncm91cCl7aWYoISR0Ym9keSl7JHRib2R5PSQoJzx0Ym9keT4nKTt9CiR0Ym9keS5hcHBlbmQoc2VsZi5fcmVuZGVyR3JvdXBSb3coZ3JvdXAsZ3JvdXBMZXZlbCkpO2lmKGdyb3VwLmRhdGEubGVuZ3RoKXtyZXN1bHQucHVzaCgkdGJvZHkpO3Jlc3VsdD1yZXN1bHQuY29uY2F0KHNlbGYuX3JlbmRlckdyb3VwKGdyb3VwLGdyb3VwTGV2ZWwpKTskdGJvZHk9bnVsbDt9fSk7aWYoJHRib2R5KXtyZXN1bHQucHVzaCgkdGJvZHkpO30KcmV0dXJuIHJlc3VsdDt9LF9yZW5kZXJIZWFkZXI6ZnVuY3Rpb24oKXt2YXIgJHRyPSQoJzx0cj4nKS5hcHBlbmQoXy5tYXAodGhpcy5jb2x1bW5zLHRoaXMuX3JlbmRlckhlYWRlckNlbGwuYmluZCh0aGlzKSkpO2lmKHRoaXMuaGFzU2VsZWN0b3JzKXskdHIucHJlcGVuZCh0aGlzLl9yZW5kZXJTZWxlY3RvcigndGgnKSk7fQpyZXR1cm4gJCgnPHRoZWFkPicpLmFwcGVuZCgkdHIpO30sX3JlbmRlckhlYWRlckNlbGw6ZnVuY3Rpb24obm9kZSl7dmFyIG5hbWU9bm9kZS5hdHRycy5uYW1lO3ZhciBvcmRlcj10aGlzLnN0YXRlLm9yZGVyZWRCeTt2YXIgaXNOb2RlU29ydGVkPW9yZGVyWzBdJiZvcmRlclswXS5uYW1lPT09bmFtZTt2YXIgZmllbGQ9dGhpcy5zdGF0ZS5maWVsZHNbbmFtZV07dmFyICR0aD0kKCc8dGg+Jyk7aWYobmFtZSl7JHRoLmF0dHIoJ2RhdGEtbmFtZScsbmFtZSk7fQppZihub2RlLmF0dHJzLmVkaXRPbmx5KXskdGguYWRkQ2xhc3MoJ29lX2VkaXRfb25seScpO30KaWYobm9kZS5hdHRycy5yZWFkT25seSl7JHRoLmFkZENsYXNzKCdvZV9yZWFkX29ubHknKTt9CmlmKCFmaWVsZCl7cmV0dXJuICR0aDt9CnZhciBkZXNjcmlwdGlvbj1ub2RlLmF0dHJzLnN0cmluZ3x8ZmllbGQuc3RyaW5nO2lmKG5vZGUuYXR0cnMud2lkZ2V0KXskdGguYWRkQ2xhc3MoJyBvXycrbm9kZS5hdHRycy53aWRnZXQrJ19jZWxsJyk7aWYodGhpcy5zdGF0ZS5maWVsZHNJbmZvLmxpc3RbbmFtZV0uV2lkZ2V0LnByb3RvdHlwZS5ub0xhYmVsKXtkZXNjcmlwdGlvbj0nJzt9fQokdGgudGV4dChkZXNjcmlwdGlvbikuYXR0cigndGFiaW5kZXgnLC0xKS50b2dnbGVDbGFzcygnby1zb3J0LWRvd24nLGlzTm9kZVNvcnRlZD8hb3JkZXJbMF0uYXNjOmZhbHNlKS50b2dnbGVDbGFzcygnby1zb3J0LXVwJyxpc05vZGVTb3J0ZWQ/b3JkZXJbMF0uYXNjOmZhbHNlKS5hZGRDbGFzcyhmaWVsZC5zb3J0YWJsZSYmJ29fY29sdW1uX3NvcnRhYmxlJyk7aWYoaXNOb2RlU29ydGVkKXskdGguYXR0cignYXJpYS1zb3J0JyxvcmRlclswXS5hc2M/J2FzY2VuZGluZyc6J2Rlc2NlbmRpbmcnKTt9CmlmKGZpZWxkLnR5cGU9PT0nZmxvYXQnfHxmaWVsZC50eXBlPT09J2ludGVnZXInfHxmaWVsZC50eXBlPT09J21vbmV0YXJ5Jyl7JHRoLmFkZENsYXNzKCdvX2xpc3RfbnVtYmVyX3RoJyk7fQppZihjb25maWcuaXNEZWJ1ZygpKXt2YXIgZmllbGREZXNjcj17ZmllbGQ6ZmllbGQsbmFtZTpuYW1lLHN0cmluZzpkZXNjcmlwdGlvbnx8bmFtZSxyZWNvcmQ6dGhpcy5zdGF0ZSxhdHRyczpfLmV4dGVuZCh7fSxub2RlLmF0dHJzLHRoaXMuc3RhdGUuZmllbGRzSW5mby5saXN0W25hbWVdKSx9O3RoaXMuX2FkZEZpZWxkVG9vbHRpcChmaWVsZERlc2NyLCR0aCk7fWVsc2V7JHRoLmF0dHIoJ3RpdGxlJyxkZXNjcmlwdGlvbik7fQpyZXR1cm4gJHRoO30sX3JlbmRlclJvdzpmdW5jdGlvbihyZWNvcmQpe3ZhciBzZWxmPXRoaXM7dmFyICRjZWxscz10aGlzLmNvbHVtbnMubWFwKGZ1bmN0aW9uKG5vZGUsaW5kZXgpe3JldHVybiBzZWxmLl9yZW5kZXJCb2R5Q2VsbChyZWNvcmQsbm9kZSxpbmRleCx7bW9kZToncmVhZG9ubHknfSk7fSk7dmFyICR0cj0kKCc8dHIvPicse2NsYXNzOidvX2RhdGFfcm93J30pLmF0dHIoJ2RhdGEtaWQnLHJlY29yZC5pZCkuYXBwZW5kKCRjZWxscyk7aWYodGhpcy5oYXNTZWxlY3RvcnMpeyR0ci5wcmVwZW5kKHRoaXMuX3JlbmRlclNlbGVjdG9yKCd0ZCcsIXJlY29yZC5yZXNfaWQpKTt9CnRoaXMuX3NldERlY29yYXRpb25DbGFzc2VzKHJlY29yZCwkdHIpO3JldHVybiAkdHI7fSxfcmVuZGVyUm93czpmdW5jdGlvbigpe3JldHVybiB0aGlzLnN0YXRlLmRhdGEubWFwKHRoaXMuX3JlbmRlclJvdy5iaW5kKHRoaXMpKTt9LF9yZW5kZXJPcHRpb25hbENvbHVtbnNEcm9wZG93bjpmdW5jdGlvbigpe3ZhciBzZWxmPXRoaXM7dmFyICRvcHRpb25hbENvbHVtbnNEcm9wZG93bj0kKCc8ZGl2Picse2NsYXNzOidvX29wdGlvbmFsX2NvbHVtbnMgdGV4dC1jZW50ZXIgZHJvcGRvd24nLH0pO3ZhciAkYT0kKCI8YT4iLHsnY2xhc3MnOiJkcm9wZG93bi10b2dnbGUgdGV4dC1kYXJrIG8tbm8tY2FyZXQiLCdocmVmJzoiIyIsJ3JvbGUnOiJidXR0b24iLCdkYXRhLXRvZ2dsZSc6ImRyb3Bkb3duIiwnYXJpYS1leHBhbmRlZCc6ZmFsc2UsfSk7JGEuYXBwZW5kVG8oJG9wdGlvbmFsQ29sdW1uc0Ryb3Bkb3duKTt2YXIgJGRyb3Bkb3duPSQoIjxkaXY+Iix7Y2xhc3M6J2Ryb3Bkb3duLW1lbnUgZHJvcGRvd24tbWVudS1yaWdodCBvX29wdGlvbmFsX2NvbHVtbnNfZHJvcGRvd24nLHJvbGU6J21lbnUnLH0pO3RoaXMub3B0aW9uYWxDb2x1bW5zLmZvckVhY2goZnVuY3Rpb24oY29sKXt2YXIgdHh0PShjb2wuYXR0cnMuc3RyaW5nfHxzZWxmLnN0YXRlLmZpZWxkc1tjb2wuYXR0cnMubmFtZV0uc3RyaW5nKSsKKGNvbmZpZy5pc0RlYnVnKCk/KCcgKCcrY29sLmF0dHJzLm5hbWUrJyknKTonJyk7dmFyICRjaGVja2JveD1kb20ucmVuZGVyQ2hlY2tib3goe3RleHQ6dHh0LHByb3A6e25hbWU6Y29sLmF0dHJzLm5hbWUsY2hlY2tlZDpfLmNvbnRhaW5zKHNlbGYub3B0aW9uYWxDb2x1bW5zRW5hYmxlZCxjb2wuYXR0cnMubmFtZSksfX0pOyRkcm9wZG93bi5hcHBlbmQoJCgiPGRpdj4iLHtjbGFzczoiZHJvcGRvd24taXRlbSIsfSkuYXBwZW5kKCRjaGVja2JveCkpO30pOyRkcm9wZG93bi5hcHBlbmRUbygkb3B0aW9uYWxDb2x1bW5zRHJvcGRvd24pO3JldHVybiAkb3B0aW9uYWxDb2x1bW5zRHJvcGRvd247fSxfcmVuZGVyU2VsZWN0b3I6ZnVuY3Rpb24odGFnLGRpc2FibGVJbnB1dCl7dmFyICRjb250ZW50PWRvbS5yZW5kZXJDaGVja2JveCgpO2lmKGRpc2FibGVJbnB1dCl7JGNvbnRlbnQuZmluZCgiaW5wdXRbdHlwZT0nY2hlY2tib3gnXSIpLnByb3AoJ2Rpc2FibGVkJyxkaXNhYmxlSW5wdXQpO30KcmV0dXJuICQoJzwnK3RhZysnPicpLmFkZENsYXNzKCdvX2xpc3RfcmVjb3JkX3NlbGVjdG9yJykuYXBwZW5kKCRjb250ZW50KTt9LF9yZW5kZXJWaWV3OmZ1bmN0aW9uKCl7dmFyIHNlbGY9dGhpczt2YXIgb2xkUGFnZXJzPXRoaXMucGFnZXJzO3RoaXMucGFnZXJzPVtdO3ZhciBkaXNwbGF5Tm9Db250ZW50SGVscGVyPSF0aGlzLl9oYXNDb250ZW50KCkmJiEhdGhpcy5ub0NvbnRlbnRIZWxwO3RoaXMuJGVsLnRvZ2dsZUNsYXNzKCdvX2xpc3RfdmlldycsIWRpc3BsYXlOb0NvbnRlbnRIZWxwZXIpO2lmKGRpc3BsYXlOb0NvbnRlbnRIZWxwZXIpe18uaW52b2tlKG9sZFBhZ2VycywnZGVzdHJveScpO3RoaXMuJGVsLnJlbW92ZUNsYXNzKCd0YWJsZS1yZXNwb25zaXZlJyk7dGhpcy4kZWwuaHRtbCh0aGlzLl9yZW5kZXJOb0NvbnRlbnRIZWxwZXIoKSk7cmV0dXJuIHRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9CnZhciBvcmRlcmVkQnk9dGhpcy5zdGF0ZS5vcmRlcmVkQnk7dGhpcy5oYXNIYW5kbGU9b3JkZXJlZEJ5Lmxlbmd0aD09PTB8fG9yZGVyZWRCeVswXS5uYW1lPT09dGhpcy5oYW5kbGVGaWVsZDt0aGlzLl9jb21wdXRlQWdncmVnYXRlcygpO3ZhciAkdGFibGU9JCgnPHRhYmxlPicpLmFkZENsYXNzKCdvX2xpc3RfdGFibGUgdGFibGUgdGFibGUtc20gdGFibGUtaG92ZXIgdGFibGUtc3RyaXBlZCcpOyR0YWJsZS50b2dnbGVDbGFzcygnb19saXN0X3RhYmxlX2dyb3VwZWQnLHRoaXMuaXNHcm91cGVkKTskdGFibGUudG9nZ2xlQ2xhc3MoJ29fbGlzdF90YWJsZV91bmdyb3VwZWQnLCF0aGlzLmlzR3JvdXBlZCk7dmFyIGRlZnM9W107dGhpcy5kZWZzPWRlZnM7aWYodGhpcy5pc0dyb3VwZWQpeyR0YWJsZS5hcHBlbmQodGhpcy5fcmVuZGVySGVhZGVyKCkpOyR0YWJsZS5hcHBlbmQodGhpcy5fcmVuZGVyR3JvdXBzKHRoaXMuc3RhdGUuZGF0YSkpOyR0YWJsZS5hcHBlbmQodGhpcy5fcmVuZGVyRm9vdGVyKCkpO31lbHNleyR0YWJsZS5hcHBlbmQodGhpcy5fcmVuZGVySGVhZGVyKCkpOyR0YWJsZS5hcHBlbmQodGhpcy5fcmVuZGVyQm9keSgpKTskdGFibGUuYXBwZW5kKHRoaXMuX3JlbmRlckZvb3RlcigpKTt9CmRlbGV0ZSB0aGlzLmRlZnM7dmFyIHByb209UHJvbWlzZS5hbGwoZGVmcykudGhlbihmdW5jdGlvbigpe18uaW52b2tlKG9sZFBhZ2VycywnZGVzdHJveScpO3NlbGYuJGVsLmh0bWwoJCgnPGRpdj4nLHtjbGFzczondGFibGUtcmVzcG9uc2l2ZScsaHRtbDokdGFibGV9KSk7aWYoc2VsZi5vcHRpb25hbENvbHVtbnMubGVuZ3RoKXtzZWxmLiRlbC5hZGRDbGFzcygnb19saXN0X29wdGlvbmFsX2NvbHVtbnMnKTtzZWxmLiQoJ3RhYmxlJykuYXBwZW5kKCQoJzxpIGNsYXNzPSJvX29wdGlvbmFsX2NvbHVtbnNfZHJvcGRvd25fdG9nZ2xlIGZhIGZhLWVsbGlwc2lzLXYiLz4nKSk7c2VsZi4kZWwuYXBwZW5kKHNlbGYuX3JlbmRlck9wdGlvbmFsQ29sdW1uc0Ryb3Bkb3duKCkpO30KaWYoc2VsZi5zZWxlY3Rpb24ubGVuZ3RoKXt2YXIgJGNoZWNrZWRfcm93cz1zZWxmLiQoJ3RyJykuZmlsdGVyKGZ1bmN0aW9uKGluZGV4LGVsKXtyZXR1cm4gXy5jb250YWlucyhzZWxmLnNlbGVjdGlvbiwkKGVsKS5kYXRhKCdpZCcpKTt9KTskY2hlY2tlZF9yb3dzLmZpbmQoJy5vX2xpc3RfcmVjb3JkX3NlbGVjdG9yIGlucHV0JykucHJvcCgnY2hlY2tlZCcsdHJ1ZSk7fX0pO3JldHVybiBQcm9taXNlLmFsbChbdGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpLHByb21dKTt9LF9zZXREZWNvcmF0aW9uQ2xhc3NlczpmdW5jdGlvbihyZWNvcmQsJHRyKXtfLmVhY2godGhpcy5yb3dEZWNvcmF0aW9ucyxmdW5jdGlvbihleHByLGRlY29yYXRpb24pe3ZhciBjc3NDbGFzcz1kZWNvcmF0aW9uLnJlcGxhY2UoJ2RlY29yYXRpb24nLCd0ZXh0Jyk7JHRyLnRvZ2dsZUNsYXNzKGNzc0NsYXNzLHB5LlBZX2lzVHJ1ZShweS5ldmFsdWF0ZShleHByLHJlY29yZC5ldmFsQ29udGV4dCkpKTt9KTt9LF91cGRhdGVGb290ZXI6ZnVuY3Rpb24oKXt0aGlzLl9jb21wdXRlQWdncmVnYXRlcygpO3RoaXMuJCgndGZvb3QnKS5yZXBsYWNlV2l0aCh0aGlzLl9yZW5kZXJGb290ZXIoKSk7fSxfdXBkYXRlU2VsZWN0aW9uOmZ1bmN0aW9uKCl7dGhpcy5zZWxlY3Rpb249W107dmFyIHNlbGY9dGhpczt2YXIgJGlucHV0cz10aGlzLiQoJ3Rib2R5IC5vX2xpc3RfcmVjb3JkX3NlbGVjdG9yIGlucHV0OnZpc2libGU6bm90KDpkaXNhYmxlZCknKTt2YXIgYWxsQ2hlY2tlZD0kaW5wdXRzLmxlbmd0aD4wOyRpbnB1dHMuZWFjaChmdW5jdGlvbihpbmRleCxpbnB1dCl7aWYoaW5wdXQuY2hlY2tlZCl7c2VsZi5zZWxlY3Rpb24ucHVzaCgkKGlucHV0KS5jbG9zZXN0KCd0cicpLmRhdGEoJ2lkJykpO31lbHNle2FsbENoZWNrZWQ9ZmFsc2U7fX0pO3RoaXMuJCgndGhlYWQgLm9fbGlzdF9yZWNvcmRfc2VsZWN0b3IgaW5wdXQnKS5wcm9wKCdjaGVja2VkJyxhbGxDaGVja2VkKTt0aGlzLnRyaWdnZXJfdXAoJ3NlbGVjdGlvbl9jaGFuZ2VkJyx7c2VsZWN0aW9uOnRoaXMuc2VsZWN0aW9ufSk7dGhpcy5fdXBkYXRlRm9vdGVyKCk7fSxfb25Hcm91cEJ1dHRvbkNsaWNrZWQ6ZnVuY3Rpb24ocmVjb3JkLG5vZGUsZXYpe2V2LnN0b3BQcm9wYWdhdGlvbigpO2lmKG5vZGUuYXR0cnMudHlwZT09PSdlZGl0Jyl7dGhpcy50cmlnZ2VyX3VwKCdncm91cF9lZGl0X2J1dHRvbl9jbGlja2VkJyx7cmVjb3JkOnJlY29yZCx9KTt9ZWxzZXt0aGlzLnRyaWdnZXJfdXAoJ2J1dHRvbl9jbGlja2VkJyx7YXR0cnM6bm9kZS5hdHRycyxyZWNvcmQ6cmVjb3JkLH0pO319LF9vbkdyb3VwQnV0dG9uS2V5ZG93bjpmdW5jdGlvbihldil7aWYoZXYua2V5Q29kZT09PSQudWkua2V5Q29kZS5FTlRFUil7ZXYuc3RvcFByb3BhZ2F0aW9uKCk7fX0sX29uVG9nZ2xlT3B0aW9uYWxDb2x1bW46ZnVuY3Rpb24oZXYpe3ZhciBzZWxmPXRoaXM7ZXYuc3RvcFByb3BhZ2F0aW9uKCk7dmFyIGlucHV0PWV2LmN1cnJlbnRUYXJnZXQucXVlcnlTZWxlY3RvcignaW5wdXQnKTt2YXIgZmllbGRJbmRleD10aGlzLm9wdGlvbmFsQ29sdW1uc0VuYWJsZWQuaW5kZXhPZihpbnB1dC5uYW1lKTtpZihmaWVsZEluZGV4Pj0wKXt0aGlzLm9wdGlvbmFsQ29sdW1uc0VuYWJsZWQuc3BsaWNlKGZpZWxkSW5kZXgsMSk7fWVsc2V7dGhpcy5vcHRpb25hbENvbHVtbnNFbmFibGVkLnB1c2goaW5wdXQubmFtZSk7fQp0aGlzLnRyaWdnZXJfdXAoJ3NhdmVfb3B0aW9uYWxfZmllbGRzJyx7a2V5UGFydHM6dGhpcy5fZ2V0T3B0aW9uYWxDb2x1bW5zU3RvcmFnZUtleVBhcnRzKCksb3B0aW9uYWxDb2x1bW5zRW5hYmxlZDp0aGlzLm9wdGlvbmFsQ29sdW1uc0VuYWJsZWQsfSk7dGhpcy5fcHJvY2Vzc0NvbHVtbnModGhpcy5jb2x1bW5JbnZpc2libGVGaWVsZHN8fHt9KTt0aGlzLl9yZW5kZXJWaWV3KCkudGhlbihmdW5jdGlvbigpe3NlbGYuX29uVG9nZ2xlT3B0aW9uYWxDb2x1bW5Ecm9wZG93bihldik7fSk7fSxfb25Ub2dnbGVPcHRpb25hbENvbHVtbkRyb3Bkb3duOmZ1bmN0aW9uKGV2KXtldi5zdG9wUHJvcGFnYXRpb24oKTt0aGlzLiQoJy5vX29wdGlvbmFsX2NvbHVtbnMgLmRyb3Bkb3duLXRvZ2dsZScpLmRyb3Bkb3duKCd0b2dnbGUnKTt9LF9vbktleURvd246ZnVuY3Rpb24oZXYpe3ZhciAkY2VsbD0kKGV2LmN1cnJlbnRUYXJnZXQpO3ZhciAkdHI7dmFyICRmdXR1cmVDZWxsO3ZhciBjb2xJbmRleDtzd2l0Y2goZXYua2V5Q29kZSl7Y2FzZSAkLnVpLmtleUNvZGUuTEVGVDpldi5wcmV2ZW50RGVmYXVsdCgpOyR0cj0kY2VsbC5jbG9zZXN0KCd0cicpOyR0ci5jbG9zZXN0KCd0Ym9keScpLmFkZENsYXNzKCdvX2tleWJvYXJkX25hdmlnYXRpb24nKTtpZigkdHIuaGFzQ2xhc3MoJ29fZ3JvdXBfaGVhZGVyJykmJiR0ci5oYXNDbGFzcygnb19ncm91cF9vcGVuJykpe3RoaXMuX29uVG9nZ2xlR3JvdXAoZXYpO31lbHNleyRmdXR1cmVDZWxsPSRjZWxsLnByZXYoKTt9CmJyZWFrO2Nhc2UgJC51aS5rZXlDb2RlLlJJR0hUOmV2LnByZXZlbnREZWZhdWx0KCk7JHRyPSRjZWxsLmNsb3Nlc3QoJ3RyJyk7JHRyLmNsb3Nlc3QoJ3Rib2R5JykuYWRkQ2xhc3MoJ29fa2V5Ym9hcmRfbmF2aWdhdGlvbicpO2lmKCR0ci5oYXNDbGFzcygnb19ncm91cF9oZWFkZXInKSYmISR0ci5oYXNDbGFzcygnb19ncm91cF9vcGVuJykpe3RoaXMuX29uVG9nZ2xlR3JvdXAoZXYpO31lbHNleyRmdXR1cmVDZWxsPSRjZWxsLm5leHQoKTt9CmJyZWFrO2Nhc2UgJC51aS5rZXlDb2RlLlVQOmV2LnByZXZlbnREZWZhdWx0KCk7JGNlbGwuY2xvc2VzdCgndGJvZHknKS5hZGRDbGFzcygnb19rZXlib2FyZF9uYXZpZ2F0aW9uJyk7Y29sSW5kZXg9dGhpcy5jdXJyZW50Q29sSW5kZXh8fCRjZWxsLmluZGV4KCk7JGZ1dHVyZUNlbGw9dGhpcy5fZmluZENvbm5lY3RlZENlbGwoJGNlbGwsJ3ByZXYnLGNvbEluZGV4KTtpZighJGZ1dHVyZUNlbGwpe3RoaXMudHJpZ2dlcl91cCgnbmF2aWdhdGlvbl9tb3ZlJyx7ZGlyZWN0aW9uOid1cCd9KTt9CmJyZWFrO2Nhc2UgJC51aS5rZXlDb2RlLkRPV046ZXYucHJldmVudERlZmF1bHQoKTskY2VsbC5jbG9zZXN0KCd0Ym9keScpLmFkZENsYXNzKCdvX2tleWJvYXJkX25hdmlnYXRpb24nKTtjb2xJbmRleD10aGlzLmN1cnJlbnRDb2xJbmRleHx8JGNlbGwuaW5kZXgoKTskZnV0dXJlQ2VsbD10aGlzLl9maW5kQ29ubmVjdGVkQ2VsbCgkY2VsbCwnbmV4dCcsY29sSW5kZXgpO2JyZWFrO2Nhc2UgJC51aS5rZXlDb2RlLkVOVEVSOmV2LnByZXZlbnREZWZhdWx0KCk7JHRyPSRjZWxsLmNsb3Nlc3QoJ3RyJyk7aWYoJHRyLmhhc0NsYXNzKCdvX2dyb3VwX2hlYWRlcicpKXt0aGlzLl9vblRvZ2dsZUdyb3VwKGV2KTt9ZWxzZXt2YXIgaWQ9JHRyLmRhdGEoJ2lkJyk7aWYoaWQpe3RoaXMudHJpZ2dlcl91cCgnb3Blbl9yZWNvcmQnLHtpZDppZCx0YXJnZXQ6ZXYudGFyZ2V0fSk7fX0KYnJlYWs7fQppZigkZnV0dXJlQ2VsbCl7dmFyIGlzSW5Hcm91cEhlYWRlcj0kZnV0dXJlQ2VsbC5jbG9zZXN0KCd0cicpLmhhc0NsYXNzKCdvX2dyb3VwX2hlYWRlcicpO3ZhciAkYWN0aXZhYmxlcz0haXNJbkdyb3VwSGVhZGVyJiYkZnV0dXJlQ2VsbC5maW5kKCc6Zm9jdXNhYmxlJyk7aWYoJGFjdGl2YWJsZXMubGVuZ3RoKXskYWN0aXZhYmxlc1swXS5mb2N1cygpO31lbHNleyRmdXR1cmVDZWxsLmZvY3VzKCk7fX19LF9vbk1vdXNlRG93bjpmdW5jdGlvbigpeyQoJy5vX2tleWJvYXJkX25hdmlnYXRpb24nKS5yZW1vdmVDbGFzcygnb19rZXlib2FyZF9uYXZpZ2F0aW9uJyk7fSxfb25Sb3dDbGlja2VkOmZ1bmN0aW9uKGV2KXtpZighZXYudGFyZ2V0LmNsb3Nlc3QoJy5vX2xpc3RfcmVjb3JkX3NlbGVjdG9yJykmJiEkKGV2LnRhcmdldCkucHJvcCgnc3BlY2lhbF9jbGljaycpKXt2YXIgaWQ9JChldi5jdXJyZW50VGFyZ2V0KS5kYXRhKCdpZCcpO2lmKGlkKXt0aGlzLnRyaWdnZXJfdXAoJ29wZW5fcmVjb3JkJyx7aWQ6aWQsdGFyZ2V0OmV2LnRhcmdldH0pO319fSxfb25TZWxlY3RSZWNvcmQ6ZnVuY3Rpb24oZXYpe2V2LnN0b3BQcm9wYWdhdGlvbigpO3RoaXMuX3VwZGF0ZVNlbGVjdGlvbigpO30sX29uU29ydENvbHVtbjpmdW5jdGlvbihldil7dmFyIG5hbWU9JChldi5jdXJyZW50VGFyZ2V0KS5kYXRhKCduYW1lJyk7dGhpcy50cmlnZ2VyX3VwKCd0b2dnbGVfY29sdW1uX29yZGVyJyx7aWQ6dGhpcy5zdGF0ZS5pZCxuYW1lOm5hbWV9KTt9LF9vblRvZ2dsZUdyb3VwOmZ1bmN0aW9uKGV2KXtldi5wcmV2ZW50RGVmYXVsdCgpO2V2LnN0b3BQcm9wYWdhdGlvbigpO3ZhciBncm91cD0kKGV2LmN1cnJlbnRUYXJnZXQpLmNsb3Nlc3QoJ3RyJykuZGF0YSgnZ3JvdXAnKTtpZihncm91cC5jb3VudCl7dGhpcy50cmlnZ2VyX3VwKCd0b2dnbGVfZ3JvdXAnLHtncm91cDpncm91cCxvblN1Y2Nlc3M6KCk9Pnt0aGlzLl91cGRhdGVTZWxlY3Rpb24oKTtpZihkb2N1bWVudC5hY3RpdmVFbGVtZW50LnRhZ05hbWU9PT0nQk9EWScpe3ZhciBncm91cEhlYWRlcnM9JCgndHIub19ncm91cF9oZWFkZXI6ZGF0YSgiZ3JvdXAiKScpO3ZhciBoZWFkZXI9Z3JvdXBIZWFkZXJzLmZpbHRlcihmdW5jdGlvbigpe3JldHVybiAkKHRoaXMpLmRhdGEoJ2dyb3VwJykuaWQ9PT1ncm91cC5pZDt9KTtoZWFkZXIuZmluZCgnLm9fZ3JvdXBfbmFtZScpLmZvY3VzKCk7fX0sfSk7fX0sX29uVG9nZ2xlU2VsZWN0aW9uOmZ1bmN0aW9uKGV2KXt2YXIgY2hlY2tlZD0kKGV2LmN1cnJlbnRUYXJnZXQpLnByb3AoJ2NoZWNrZWQnKXx8ZmFsc2U7dGhpcy4kKCd0Ym9keSAub19saXN0X3JlY29yZF9zZWxlY3RvciBpbnB1dDpub3QoIjpkaXNhYmxlZCIpJykucHJvcCgnY2hlY2tlZCcsY2hlY2tlZCk7dGhpcy5fdXBkYXRlU2VsZWN0aW9uKCk7fSx9KTtyZXR1cm4gTGlzdFJlbmRlcmVyO30pOzsKCi8qIC93ZWIvc3RhdGljL3NyYy9qcy92aWV3cy9saXN0L2xpc3Rfdmlldy5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwpvZG9vLmRlZmluZSgnd2ViLkxpc3RWaWV3JyxmdW5jdGlvbihyZXF1aXJlKXsidXNlIHN0cmljdCI7dmFyIEJhc2ljVmlldz1yZXF1aXJlKCd3ZWIuQmFzaWNWaWV3Jyk7dmFyIGNvcmU9cmVxdWlyZSgnd2ViLmNvcmUnKTt2YXIgTGlzdE1vZGVsPXJlcXVpcmUoJ3dlYi5MaXN0TW9kZWwnKTt2YXIgTGlzdFJlbmRlcmVyPXJlcXVpcmUoJ3dlYi5MaXN0UmVuZGVyZXInKTt2YXIgTGlzdENvbnRyb2xsZXI9cmVxdWlyZSgnd2ViLkxpc3RDb250cm9sbGVyJyk7dmFyIHB5VXRpbHM9cmVxdWlyZSgnd2ViLnB5X3V0aWxzJyk7dmFyIF9sdD1jb3JlLl9sdDt2YXIgTGlzdFZpZXc9QmFzaWNWaWV3LmV4dGVuZCh7YWNjZXNza2V5OiJsIixkaXNwbGF5X25hbWU6X2x0KCdMaXN0JyksaWNvbjonZmEtbGlzdC11bCcsY29uZmlnOl8uZXh0ZW5kKHt9LEJhc2ljVmlldy5wcm90b3R5cGUuY29uZmlnLHtNb2RlbDpMaXN0TW9kZWwsUmVuZGVyZXI6TGlzdFJlbmRlcmVyLENvbnRyb2xsZXI6TGlzdENvbnRyb2xsZXIsfSksdmlld1R5cGU6J2xpc3QnLGluaXQ6ZnVuY3Rpb24odmlld0luZm8scGFyYW1zKXt2YXIgc2VsZj10aGlzO3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt2YXIgc2VsZWN0ZWRSZWNvcmRzPVtdO3ZhciBweWV2YWxDb250ZXh0PXB5LmRpY3QuZnJvbUpTT04oXy5waWNrKHBhcmFtcy5jb250ZXh0LGZ1bmN0aW9uKHZhbHVlLGtleSxvYmplY3Qpe3JldHVybiFfLmlzVW5kZWZpbmVkKHZhbHVlKX0pfHx7fSk7dmFyIGV4cGFuZEdyb3Vwcz0hIUpTT04ucGFyc2UocHlVdGlscy5weV9ldmFsKHRoaXMuYXJjaC5hdHRycy5leHBhbmR8fCIwIix7J2NvbnRleHQnOnB5ZXZhbENvbnRleHR9KSk7dGhpcy5ncm91cGJ5cz17fTt0aGlzLmFyY2guY2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbihjaGlsZCl7aWYoY2hpbGQudGFnPT09J2dyb3VwYnknKXtzZWxmLl9leHRyYWN0R3JvdXAoY2hpbGQpO319KTtsZXQgZWRpdGFibGU9ZmFsc2U7aWYoKCF0aGlzLmFyY2guYXR0cnMuZWRpdHx8ISFKU09OLnBhcnNlKHRoaXMuYXJjaC5hdHRycy5lZGl0KSkmJiFwYXJhbXMucmVhZG9ubHkpe2VkaXRhYmxlPXRoaXMuYXJjaC5hdHRycy5lZGl0YWJsZTt9CnRoaXMuY29udHJvbGxlclBhcmFtcy5hY3RpdmVBY3Rpb25zLmV4cG9ydF94bHN4PXRoaXMuYXJjaC5hdHRycy5leHBvcnRfeGxzeD8hIUpTT04ucGFyc2UodGhpcy5hcmNoLmF0dHJzLmV4cG9ydF94bHN4KTp0cnVlO3RoaXMuY29udHJvbGxlclBhcmFtcy5lZGl0YWJsZT1lZGl0YWJsZTt0aGlzLmNvbnRyb2xsZXJQYXJhbXMuaGFzU2lkZWJhcj1wYXJhbXMuaGFzU2lkZWJhcjt0aGlzLmNvbnRyb2xsZXJQYXJhbXMudG9vbGJhckFjdGlvbnM9dmlld0luZm8udG9vbGJhcjt0aGlzLmNvbnRyb2xsZXJQYXJhbXMubW9kZT1lZGl0YWJsZT8nZWRpdCc6J3JlYWRvbmx5Jzt0aGlzLmNvbnRyb2xsZXJQYXJhbXMuc2VsZWN0ZWRSZWNvcmRzPXNlbGVjdGVkUmVjb3Jkczt0aGlzLnJlbmRlcmVyUGFyYW1zLmFyY2g9dGhpcy5hcmNoO3RoaXMucmVuZGVyZXJQYXJhbXMuZ3JvdXBieXM9dGhpcy5ncm91cGJ5czt0aGlzLnJlbmRlcmVyUGFyYW1zLmhhc1NlbGVjdG9ycz0naGFzU2VsZWN0b3JzJ2luIHBhcmFtcz9wYXJhbXMuaGFzU2VsZWN0b3JzOnRydWU7dGhpcy5yZW5kZXJlclBhcmFtcy5lZGl0YWJsZT1lZGl0YWJsZTt0aGlzLnJlbmRlcmVyUGFyYW1zLnNlbGVjdGVkUmVjb3Jkcz1zZWxlY3RlZFJlY29yZHM7dGhpcy5yZW5kZXJlclBhcmFtcy5hZGRDcmVhdGVMaW5lPWZhbHNlO3RoaXMucmVuZGVyZXJQYXJhbXMuYWRkQ3JlYXRlTGluZUluR3JvdXBzPWVkaXRhYmxlJiZ0aGlzLmNvbnRyb2xsZXJQYXJhbXMuYWN0aXZlQWN0aW9ucy5jcmVhdGU7dGhpcy5yZW5kZXJlclBhcmFtcy5pc011bHRpRWRpdGFibGU9dGhpcy5hcmNoLmF0dHJzLm11bHRpX2VkaXQmJiEhSlNPTi5wYXJzZSh0aGlzLmFyY2guYXR0cnMubXVsdGlfZWRpdCk7dGhpcy5tb2RlbFBhcmFtcy5ncm91cGJ5cz10aGlzLmdyb3VwYnlzO3RoaXMubG9hZFBhcmFtcy5saW1pdD10aGlzLmxvYWRQYXJhbXMubGltaXR8fDgwO3RoaXMubG9hZFBhcmFtcy5vcGVuR3JvdXBCeURlZmF1bHQ9ZXhwYW5kR3JvdXBzO3RoaXMubG9hZFBhcmFtcy50eXBlPSdsaXN0Jzt2YXIgZ3JvdXBzTGltaXQ9cGFyc2VJbnQodGhpcy5hcmNoLmF0dHJzLmdyb3Vwc19saW1pdCwxMCk7dGhpcy5sb2FkUGFyYW1zLmdyb3Vwc0xpbWl0PWdyb3Vwc0xpbWl0fHwoZXhwYW5kR3JvdXBzPzEwOjgwKTt9LF9leHRyYWN0R3JvdXA6ZnVuY3Rpb24obm9kZSl7dmFyIGlubmVyVmlldz10aGlzLmZpZWxkc1tub2RlLmF0dHJzLm5hbWVdLnZpZXdzLmdyb3VwYnk7dGhpcy5ncm91cGJ5c1tub2RlLmF0dHJzLm5hbWVdPXRoaXMuX3Byb2Nlc3NGaWVsZHNWaWV3KGlubmVyVmlldywnZ3JvdXBieScpO30sX2V4dHJhY3RQYXJhbXNGcm9tQWN0aW9uOmZ1bmN0aW9uKGFjdGlvbil7dmFyIHBhcmFtcz10aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dmFyIGluRGlhbG9nPWFjdGlvbi50YXJnZXQ9PT0nbmV3Jzt2YXIgaW5saW5lPWFjdGlvbi50YXJnZXQ9PT0naW5saW5lJztwYXJhbXMuaGFzU2lkZWJhcj0haW5EaWFsb2cmJiFpbmxpbmU7cmV0dXJuIHBhcmFtczt9LF91cGRhdGVNVkNQYXJhbXM6ZnVuY3Rpb24oKXt0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy5jb250cm9sbGVyUGFyYW1zLm5vTGVhZj0hIXRoaXMubG9hZFBhcmFtcy5jb250ZXh0Lmdyb3VwX2J5X25vX2xlYWY7fSx9KTtyZXR1cm4gTGlzdFZpZXc7fSk7OwoKLyogL3dlYi9zdGF0aWMvc3JjL2pzL3ZpZXdzL2xpc3QvbGlzdF9jb250cm9sbGVyLmpzIGRlZmluZWQgaW4gYnVuZGxlICd3ZWIuYXNzZXRzX2JhY2tlbmQnICovCm9kb28uZGVmaW5lKCd3ZWIuTGlzdENvbnRyb2xsZXInLGZ1bmN0aW9uKHJlcXVpcmUpeyJ1c2Ugc3RyaWN0Ijt2YXIgY29yZT1yZXF1aXJlKCd3ZWIuY29yZScpO3ZhciBCYXNpY0NvbnRyb2xsZXI9cmVxdWlyZSgnd2ViLkJhc2ljQ29udHJvbGxlcicpO3ZhciBEYXRhRXhwb3J0PXJlcXVpcmUoJ3dlYi5EYXRhRXhwb3J0Jyk7dmFyIERpYWxvZz1yZXF1aXJlKCd3ZWIuRGlhbG9nJyk7dmFyIExpc3RDb25maXJtRGlhbG9nPXJlcXVpcmUoJ3dlYi5MaXN0Q29uZmlybURpYWxvZycpO3ZhciBTaWRlYmFyPXJlcXVpcmUoJ3dlYi5TaWRlYmFyJyk7dmFyIF90PWNvcmUuX3Q7dmFyIHF3ZWI9Y29yZS5xd2ViO3ZhciBMaXN0Q29udHJvbGxlcj1CYXNpY0NvbnRyb2xsZXIuZXh0ZW5kKHtidXR0b25zX3RlbXBsYXRlOidMaXN0Vmlldy5idXR0b25zJyxldmVudHM6Xy5leHRlbmQoe30sQmFzaWNDb250cm9sbGVyLnByb3RvdHlwZS5ldmVudHMseydjbGljayAub19saXN0X2V4cG9ydF94bHN4JzonX29uRGlyZWN0RXhwb3J0RGF0YScsfSksY3VzdG9tX2V2ZW50czpfLmV4dGVuZCh7fSxCYXNpY0NvbnRyb2xsZXIucHJvdG90eXBlLmN1c3RvbV9ldmVudHMse2FjdGl2YXRlX25leHRfd2lkZ2V0Oidfb25BY3RpdmF0ZU5leHRXaWRnZXQnLGFkZF9yZWNvcmQ6J19vbkFkZFJlY29yZCcsYnV0dG9uX2NsaWNrZWQ6J19vbkJ1dHRvbkNsaWNrZWQnLGdyb3VwX2VkaXRfYnV0dG9uX2NsaWNrZWQ6J19vbkVkaXRHcm91cENsaWNrZWQnLGVkaXRfbGluZTonX29uRWRpdExpbmUnLHNhdmVfbGluZTonX29uU2F2ZUxpbmUnLHNlbGVjdGlvbl9jaGFuZ2VkOidfb25TZWxlY3Rpb25DaGFuZ2VkJyx0b2dnbGVfY29sdW1uX29yZGVyOidfb25Ub2dnbGVDb2x1bW5PcmRlcicsdG9nZ2xlX2dyb3VwOidfb25Ub2dnbGVHcm91cCcsfSksaW5pdDpmdW5jdGlvbihwYXJlbnQsbW9kZWwscmVuZGVyZXIscGFyYW1zKXt0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy5oYXNTaWRlYmFyPXBhcmFtcy5oYXNTaWRlYmFyO3RoaXMudG9vbGJhckFjdGlvbnM9cGFyYW1zLnRvb2xiYXJBY3Rpb25zfHx7fTt0aGlzLmVkaXRhYmxlPXBhcmFtcy5lZGl0YWJsZTt0aGlzLm5vTGVhZj1wYXJhbXMubm9MZWFmO3RoaXMuc2VsZWN0ZWRSZWNvcmRzPXBhcmFtcy5zZWxlY3RlZFJlY29yZHN8fFtdO3RoaXMubXVsdGlwbGVSZWNvcmRzU2F2aW5nUHJvbWlzZT1udWxsO3RoaXMuZmllbGRDaGFuZ2VkUHJldmVudGVkPWZhbHNlO09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCdtb2RlJyx7Z2V0OigpPT50aGlzLnJlbmRlcmVyLmlzRWRpdGFibGUoKT8nZWRpdCc6J3JlYWRvbmx5JyxzZXQ6KCk9Pnt9LH0pO30sZ2V0QWN0aXZlRG9tYWluOmZ1bmN0aW9uKCl7dmFyIHNlbGY9dGhpcztpZih0aGlzLiQoJ3RoZWFkIC5vX2xpc3RfcmVjb3JkX3NlbGVjdG9yIGlucHV0JykucHJvcCgnY2hlY2tlZCcpKXt2YXIgc2VhcmNoUXVlcnk9dGhpcy5fY29udHJvbFBhbmVsP3RoaXMuX2NvbnRyb2xQYW5lbC5nZXRTZWFyY2hRdWVyeSgpOnt9O3ZhciByZWNvcmQ9c2VsZi5tb2RlbC5nZXQoc2VsZi5oYW5kbGUse3Jhdzp0cnVlfSk7cmV0dXJuIHJlY29yZC5nZXREb21haW4oKS5jb25jYXQoc2VhcmNoUXVlcnkuZG9tYWlufHxbXSk7fX0sZ2V0T3duZWRRdWVyeVBhcmFtczpmdW5jdGlvbigpe3ZhciBzdGF0ZT10aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dmFyIG9yZGVyZWRCeT10aGlzLm1vZGVsLmdldCh0aGlzLmhhbmRsZSx7cmF3OnRydWV9KS5vcmRlcmVkQnl8fFtdO3JldHVybiBfLmV4dGVuZCh7fSxzdGF0ZSx7b3JkZXJlZEJ5Om9yZGVyZWRCeX0pO30sZ2V0U2VsZWN0ZWRJZHM6ZnVuY3Rpb24oKXtyZXR1cm4gXy5tYXAodGhpcy5nZXRTZWxlY3RlZFJlY29yZHMoKSxmdW5jdGlvbihyZWNvcmQpe3JldHVybiByZWNvcmQucmVzX2lkO30pO30sZ2V0U2VsZWN0ZWRSZWNvcmRzOmZ1bmN0aW9uKCl7dmFyIHNlbGY9dGhpcztyZXR1cm4gXy5tYXAodGhpcy5zZWxlY3RlZFJlY29yZHMsZnVuY3Rpb24oZGJfaWQpe3JldHVybiBzZWxmLm1vZGVsLmdldChkYl9pZCx7cmF3OnRydWV9KTt9KTt9LHJlbmRlckJ1dHRvbnM6ZnVuY3Rpb24oJG5vZGUpe2lmKCF0aGlzLm5vTGVhZiYmdGhpcy5oYXNCdXR0b25zKXt0aGlzLiRidXR0b25zPSQocXdlYi5yZW5kZXIodGhpcy5idXR0b25zX3RlbXBsYXRlLHt3aWRnZXQ6dGhpc30pKTt0aGlzLiRidXR0b25zLm9uKCdjbGljaycsJy5vX2xpc3RfYnV0dG9uX2FkZCcsdGhpcy5fb25DcmVhdGVSZWNvcmQuYmluZCh0aGlzKSk7dGhpcy5fYXNzaWduQ3JlYXRlS2V5Ym9hcmRCZWhhdmlvcih0aGlzLiRidXR0b25zLmZpbmQoJy5vX2xpc3RfYnV0dG9uX2FkZCcpKTt0aGlzLiRidXR0b25zLmZpbmQoJy5vX2xpc3RfYnV0dG9uX2FkZCcpLnRvb2x0aXAoe2RlbGF5OntzaG93OjIwMCxoaWRlOjB9LHRpdGxlOmZ1bmN0aW9uKCl7cmV0dXJuIHF3ZWIucmVuZGVyKCdDcmVhdGVCdXR0b24udG9vbHRpcCcpO30sdHJpZ2dlcjonbWFudWFsJyx9KTt0aGlzLiRidXR0b25zLm9uKCdtb3VzZWRvd24nLCcub19saXN0X2J1dHRvbl9kaXNjYXJkJyx0aGlzLl9vbkRpc2NhcmRNb3VzZWRvd24uYmluZCh0aGlzKSk7dGhpcy4kYnV0dG9ucy5vbignY2xpY2snLCcub19saXN0X2J1dHRvbl9kaXNjYXJkJyx0aGlzLl9vbkRpc2NhcmQuYmluZCh0aGlzKSk7dGhpcy4kYnV0dG9ucy5hcHBlbmRUbygkbm9kZSk7fX0scmVuZGVyU2lkZWJhcjpmdW5jdGlvbigkbm9kZSl7dmFyIHNlbGY9dGhpcztpZih0aGlzLmhhc1NpZGViYXIpe3ZhciBvdGhlcj1be2xhYmVsOl90KCJFeHBvcnQiKSxjYWxsYmFjazp0aGlzLl9vbkV4cG9ydERhdGEuYmluZCh0aGlzKX1dO2lmKHRoaXMuYXJjaGl2ZUVuYWJsZWQpe290aGVyLnB1c2goe2xhYmVsOl90KCJBcmNoaXZlIiksY2FsbGJhY2s6ZnVuY3Rpb24oKXtEaWFsb2cuY29uZmlybShzZWxmLF90KCJBcmUgeW91IHN1cmUgdGhhdCB5b3Ugd2FudCB0byBhcmNoaXZlIGFsbCB0aGUgc2VsZWN0ZWQgcmVjb3Jkcz8iKSx7Y29uZmlybV9jYWxsYmFjazpzZWxmLl90b2dnbGVBcmNoaXZlU3RhdGUuYmluZChzZWxmLHRydWUpLH0pO319KTtvdGhlci5wdXNoKHtsYWJlbDpfdCgiVW5hcmNoaXZlIiksY2FsbGJhY2s6dGhpcy5fdG9nZ2xlQXJjaGl2ZVN0YXRlLmJpbmQodGhpcyxmYWxzZSl9KTt9CmlmKHRoaXMuaXNfYWN0aW9uX2VuYWJsZWQoJ2RlbGV0ZScpKXtvdGhlci5wdXNoKHtsYWJlbDpfdCgnRGVsZXRlJyksY2FsbGJhY2s6dGhpcy5fb25EZWxldGVTZWxlY3RlZFJlY29yZHMuYmluZCh0aGlzKX0pO30KdGhpcy5zaWRlYmFyPW5ldyBTaWRlYmFyKHRoaXMse2VkaXRhYmxlOnRoaXMuaXNfYWN0aW9uX2VuYWJsZWQoJ2VkaXQnKSxlbnY6e2NvbnRleHQ6dGhpcy5tb2RlbC5nZXQodGhpcy5oYW5kbGUse3Jhdzp0cnVlfSkuZ2V0Q29udGV4dCgpLGFjdGl2ZUlkczp0aGlzLmdldFNlbGVjdGVkSWRzKCksbW9kZWw6dGhpcy5tb2RlbE5hbWUsfSxhY3Rpb25zOl8uZXh0ZW5kKHRoaXMudG9vbGJhckFjdGlvbnMse290aGVyOm90aGVyfSksfSk7cmV0dXJuIHRoaXMuc2lkZWJhci5hcHBlbmRUbygkbm9kZSkudGhlbihmdW5jdGlvbigpe3NlbGYuX3RvZ2dsZVNpZGViYXIoKTt9KTt9CnJldHVybiBQcm9taXNlLnJlc29sdmUoKTt9LHVwZGF0ZTpmdW5jdGlvbihwYXJhbXMsb3B0aW9ucyl7dmFyIHNlbGY9dGhpcztpZihvcHRpb25zJiZvcHRpb25zLmtlZXBTZWxlY3Rpb24pe3ZhciByZXNfaWRzPXRoaXMubW9kZWwuZ2V0KHRoaXMuaGFuZGxlKS5yZXNfaWRzO3RoaXMuc2VsZWN0ZWRSZWNvcmRzPV8uZmlsdGVyKHRoaXMuc2VsZWN0ZWRSZWNvcmRzLGZ1bmN0aW9uKGlkKXtyZXR1cm4gXy5jb250YWlucyhyZXNfaWRzLHNlbGYubW9kZWwuZ2V0KGlkKS5yZXNfaWQpO30pO31lbHNle3RoaXMuc2VsZWN0ZWRSZWNvcmRzPVtdO30KcGFyYW1zLnNlbGVjdGVkUmVjb3Jkcz10aGlzLnNlbGVjdGVkUmVjb3JkcztyZXR1cm4gdGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO30sX2FiYW5kb25SZWNvcmQ6ZnVuY3Rpb24ocmVjb3JkSUQpe3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtpZigocmVjb3JkSUR8fHRoaXMuaGFuZGxlKSE9PXRoaXMuaGFuZGxlKXt2YXIgc3RhdGU9dGhpcy5tb2RlbC5nZXQodGhpcy5oYW5kbGUpO3RoaXMucmVuZGVyZXIucmVtb3ZlTGluZShzdGF0ZSxyZWNvcmRJRCk7dGhpcy5fdXBkYXRlUGFnZXIoKTt9fSxfYWRkUmVjb3JkOmZ1bmN0aW9uKGRhdGFQb2ludElkKXt2YXIgc2VsZj10aGlzO3RoaXMuX2Rpc2FibGVCdXR0b25zKCk7cmV0dXJuIHRoaXMucmVuZGVyZXIudW5zZWxlY3RSb3coKS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIHNlbGYubW9kZWwuYWRkRGVmYXVsdFJlY29yZChkYXRhUG9pbnRJZCx7cG9zaXRpb246c2VsZi5lZGl0YWJsZSx9KTt9KS50aGVuKGZ1bmN0aW9uKHJlY29yZElEKXt2YXIgc3RhdGU9c2VsZi5tb2RlbC5nZXQoc2VsZi5oYW5kbGUpO3NlbGYucmVuZGVyZXIudXBkYXRlU3RhdGUoc3RhdGUse2tlZXBXaWR0aHM6dHJ1ZX0pLnRoZW4oZnVuY3Rpb24oKXtzZWxmLnJlbmRlcmVyLmVkaXRSZWNvcmQocmVjb3JkSUQpO30pLnRoZW4oc2VsZi5fdXBkYXRlUGFnZXIuYmluZChzZWxmKSk7fSkudGhlbih0aGlzLl9lbmFibGVCdXR0b25zLmJpbmQodGhpcykpLmd1YXJkZWRDYXRjaCh0aGlzLl9lbmFibGVCdXR0b25zLmJpbmQodGhpcykpO30sX2FyY2hpdmU6ZnVuY3Rpb24oaWRzLGFyY2hpdmUpe2lmKGlkcy5sZW5ndGg9PT0wKXtyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7fQppZihhcmNoaXZlKXtyZXR1cm4gdGhpcy5tb2RlbC5hY3Rpb25BcmNoaXZlKGlkcyx0aGlzLmhhbmRsZSkudGhlbih0aGlzLnVwZGF0ZS5iaW5kKHRoaXMse30se3JlbG9hZDpmYWxzZX0pKTt9ZWxzZXtyZXR1cm4gdGhpcy5tb2RlbC5hY3Rpb25VbmFyY2hpdmUoaWRzLHRoaXMuaGFuZGxlKS50aGVuKHRoaXMudXBkYXRlLmJpbmQodGhpcyx7fSx7cmVsb2FkOmZhbHNlfSkpO319LF9hc3NpZ25DcmVhdGVLZXlib2FyZEJlaGF2aW9yOmZ1bmN0aW9uKCRjcmVhdGVCdXR0b24pe3ZhciBzZWxmPXRoaXM7JGNyZWF0ZUJ1dHRvbi5vbigna2V5ZG93bicsZnVuY3Rpb24oZSl7JGNyZWF0ZUJ1dHRvbi50b29sdGlwKCdoaWRlJyk7c3dpdGNoKGUud2hpY2gpe2Nhc2UgJC51aS5rZXlDb2RlLkVOVEVSOmUucHJldmVudERlZmF1bHQoKTtzZWxmLl9vbkNyZWF0ZVJlY29yZC5hcHBseShzZWxmKTticmVhaztjYXNlICQudWkua2V5Q29kZS5ET1dOOmUucHJldmVudERlZmF1bHQoKTtzZWxmLnJlbmRlcmVyLmdpdmVGb2N1cygpO2JyZWFrO2Nhc2UgJC51aS5rZXlDb2RlLlRBQjppZighZS5zaGlmdEtleSYmZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCJidG4tcHJpbWFyeSIpKXtlLnByZXZlbnREZWZhdWx0KCk7JGNyZWF0ZUJ1dHRvbi50b29sdGlwKCdzaG93Jyk7fQpicmVhazt9fSk7fSxfY29uZmlybVNhdmU6ZnVuY3Rpb24oaWQpe3ZhciBzdGF0ZT10aGlzLm1vZGVsLmdldCh0aGlzLmhhbmRsZSk7cmV0dXJuIHRoaXMucmVuZGVyZXIudXBkYXRlU3RhdGUoc3RhdGUse25vUmVuZGVyOnRydWV9KS50aGVuKHRoaXMuX3NldE1vZGUuYmluZCh0aGlzLCdyZWFkb25seScsaWQpKTt9LF9kaXNjYXJkQ2hhbmdlczpmdW5jdGlvbihyZWNvcmRJRCl7aWYoKHJlY29yZElEfHx0aGlzLmhhbmRsZSk9PT10aGlzLmhhbmRsZSl7cmVjb3JkSUQ9dGhpcy5yZW5kZXJlci5nZXRFZGl0YWJsZVJlY29yZElEKCk7aWYocmVjb3JkSUQ9PT1udWxsKXtyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7fX0KdmFyIHNlbGY9dGhpcztyZXR1cm4gdGhpcy5fc3VwZXIocmVjb3JkSUQpLnRoZW4oZnVuY3Rpb24oKXtzZWxmLl91cGRhdGVCdXR0b25zKCdyZWFkb25seScpO30pO30sX2dldEV4cG9ydERpYWxvZ1dpZGdldCgpe2xldCBzdGF0ZT10aGlzLm1vZGVsLmdldCh0aGlzLmhhbmRsZSk7bGV0IGRlZmF1bHRFeHBvcnRGaWVsZHM9dGhpcy5yZW5kZXJlci5jb2x1bW5zLmZpbHRlcihmaWVsZD0+ZmllbGQudGFnPT09J2ZpZWxkJykubWFwKGZpZWxkPT5maWVsZC5hdHRycy5uYW1lKTtsZXQgZ3JvdXBlZEJ5PXRoaXMucmVuZGVyZXIuc3RhdGUuZ3JvdXBlZEJ5O3JldHVybiBuZXcgRGF0YUV4cG9ydCh0aGlzLHN0YXRlLGRlZmF1bHRFeHBvcnRGaWVsZHMsZ3JvdXBlZEJ5LHRoaXMuZ2V0QWN0aXZlRG9tYWluKCksdGhpcy5nZXRTZWxlY3RlZElkcygpKTt9LF9nZXRTaWRlYmFyRW52OmZ1bmN0aW9uKCl7dmFyIGVudj10aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dmFyIHJlY29yZD10aGlzLm1vZGVsLmdldCh0aGlzLmhhbmRsZSk7cmV0dXJuIF8uZXh0ZW5kKGVudix7ZG9tYWluOnJlY29yZC5nZXREb21haW4oKX0pO30sX2lzUGFnZXJWaXNpYmxlOmZ1bmN0aW9uKCl7dmFyIHN0YXRlPXRoaXMubW9kZWwuZ2V0KHRoaXMuaGFuZGxlLHtyYXc6dHJ1ZX0pO3JldHVybiEhc3RhdGUuY291bnQ7fSxfc2F2ZU11bHRpcGxlUmVjb3JkczpmdW5jdGlvbihyZWNvcmRJZCxub2RlLGNoYW5nZXMpe3ZhciBmaWVsZE5hbWU9T2JqZWN0LmtleXMoY2hhbmdlcylbMF07dmFyIHZhbHVlPU9iamVjdC52YWx1ZXMoY2hhbmdlcylbMF07dmFyIHJlY29yZElkcz1fLnVuaW9uKFtyZWNvcmRJZF0sdGhpcy5zZWxlY3RlZFJlY29yZHMpO3ZhciB2YWxpZFJlY29yZElkcz1yZWNvcmRJZHMucmVkdWNlKChyZXN1bHQsbmV4dFJlY29yZElkKT0+e3ZhciByZWNvcmQ9dGhpcy5tb2RlbC5nZXQobmV4dFJlY29yZElkKTt2YXIgbW9kaWZpZXJzPXRoaXMucmVuZGVyZXIuX3JlZ2lzdGVyTW9kaWZpZXJzKG5vZGUscmVjb3JkKTtpZighbW9kaWZpZXJzLnJlYWRvbmx5JiYoIW1vZGlmaWVycy5yZXF1aXJlZHx8dmFsdWUpKXtyZXN1bHQucHVzaChuZXh0UmVjb3JkSWQpO30KcmV0dXJuIHJlc3VsdDt9LFtdKTtyZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUscmVqZWN0KT0+e2NvbnN0IGRpc2NhcmRBbmRSZWplY3Q9KCk9Pnt0aGlzLm1vZGVsLmRpc2NhcmRDaGFuZ2VzKHJlY29yZElkKTt0aGlzLl9jb25maXJtU2F2ZShyZWNvcmRJZCkudGhlbigoKT0+e3RoaXMucmVuZGVyZXIuZm9jdXNDZWxsKHJlY29yZElkLG5vZGUpO3JlamVjdCgpO30pO307aWYodmFsaWRSZWNvcmRJZHMubGVuZ3RoPjApe2NvbnN0IGRpYWxvZ09wdGlvbnM9e2NvbmZpcm1fY2FsbGJhY2s6KCk9Pnt0aGlzLm1vZGVsLnNhdmVSZWNvcmRzKHRoaXMuaGFuZGxlLHJlY29yZElkLHZhbGlkUmVjb3JkSWRzLGZpZWxkTmFtZSkudGhlbihhc3luYygpPT57dGhpcy5fdXBkYXRlQnV0dG9ucygncmVhZG9ubHknKTtjb25zdCBzdGF0ZT10aGlzLm1vZGVsLmdldCh0aGlzLmhhbmRsZSk7YXdhaXQgdGhpcy5yZW5kZXJlci51cGRhdGVTdGF0ZShzdGF0ZSx7a2VlcFdpZHRoczp0cnVlfSk7YXdhaXQgdGhpcy5yZW5kZXJlci5mb2N1c0NlbGwocmVjb3JkSWQsbm9kZSk7cmVzb2x2ZShPYmplY3Qua2V5cyhjaGFuZ2VzKSk7fSkuZ3VhcmRlZENhdGNoKGRpc2NhcmRBbmRSZWplY3QpO30sY2FuY2VsX2NhbGxiYWNrOmRpc2NhcmRBbmRSZWplY3QsfTtjb25zdCByZWNvcmQ9dGhpcy5tb2RlbC5nZXQocmVjb3JkSWQpO2NvbnN0IGRpYWxvZ0NoYW5nZXM9e2ZpZWxkTGFiZWw6bm9kZS5hdHRycy5zdHJpbmd8fHJlY29yZC5maWVsZHNbZmllbGROYW1lXS5zdHJpbmcsZmllbGROYW1lOm5vZGUuYXR0cnMubmFtZSxuYlJlY29yZHM6cmVjb3JkSWRzLmxlbmd0aCxuYlZhbGlkUmVjb3Jkczp2YWxpZFJlY29yZElkcy5sZW5ndGgsfTtuZXcgTGlzdENvbmZpcm1EaWFsb2codGhpcyxyZWNvcmQsZGlhbG9nQ2hhbmdlcyxkaWFsb2dPcHRpb25zKS5vcGVuKHtzaG91bGRGb2N1c0J1dHRvbnM6dHJ1ZX0pO31lbHNle0RpYWxvZy5hbGVydCh0aGlzLF90KCJObyB2YWxpZCByZWNvcmQgdG8gc2F2ZSIpLHtjb25maXJtX2NhbGxiYWNrOmRpc2NhcmRBbmRSZWplY3QsfSk7fX0pO30sX3NhdmVSZWNvcmQ6ZnVuY3Rpb24ocmVjb3JkSWQpe3ZhciByZWNvcmQ9dGhpcy5tb2RlbC5nZXQocmVjb3JkSWQse3Jhdzp0cnVlfSk7aWYocmVjb3JkLmlzRGlydHkoKSYmdGhpcy5yZW5kZXJlci5pc0luTXVsdGlwbGVSZWNvcmRFZGl0aW9uKHJlY29yZElkKSl7Y29uc3QgcHJvbT10aGlzLm11bHRpcGxlUmVjb3Jkc1NhdmluZ1Byb21pc2V8fFByb21pc2UucmVqZWN0KCk7dGhpcy5tdWx0aXBsZVJlY29yZHNTYXZpbmdQcm9taXNlPW51bGw7cmV0dXJuIHByb207fQpyZXR1cm4gdGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO30sX3NldE1vZGU6ZnVuY3Rpb24obW9kZSxyZWNvcmRJRCl7aWYoKHJlY29yZElEfHx0aGlzLmhhbmRsZSkhPT10aGlzLmhhbmRsZSl7dGhpcy5fdXBkYXRlQnV0dG9ucyhtb2RlKTtyZXR1cm4gdGhpcy5yZW5kZXJlci5zZXRSb3dNb2RlKHJlY29yZElELG1vZGUpO31lbHNle3JldHVybiB0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fX0sX3RvZ2dsZUFyY2hpdmVTdGF0ZTpmdW5jdGlvbihhcmNoaXZlKXt0aGlzLl9hcmNoaXZlKHRoaXMuc2VsZWN0ZWRSZWNvcmRzLGFyY2hpdmUpO30sX3RvZ2dsZUNyZWF0ZUJ1dHRvbjpmdW5jdGlvbigpe2lmKHRoaXMuJGJ1dHRvbnMpe3ZhciBzdGF0ZT10aGlzLm1vZGVsLmdldCh0aGlzLmhhbmRsZSk7dmFyIGNyZWF0ZUhpZGRlbj10aGlzLnJlbmRlcmVyLmlzRWRpdGFibGUoKSYmc3RhdGUuZ3JvdXBlZEJ5Lmxlbmd0aCYmc3RhdGUuZGF0YS5sZW5ndGg7dGhpcy4kYnV0dG9ucy5maW5kKCcub19saXN0X2J1dHRvbl9hZGQnKS50b2dnbGVDbGFzcygnb19oaWRkZW4nLCEhY3JlYXRlSGlkZGVuKTt9fSxfdG9nZ2xlU2lkZWJhcjpmdW5jdGlvbigpe2lmKHRoaXMuc2lkZWJhcil7dGhpcy5zaWRlYmFyLmRvX3RvZ2dsZSh0aGlzLnNlbGVjdGVkUmVjb3Jkcy5sZW5ndGg+MCk7fX0sX3VwZGF0ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cykudGhlbih0aGlzLl90b2dnbGVTaWRlYmFyLmJpbmQodGhpcykpLnRoZW4odGhpcy5fdG9nZ2xlQ3JlYXRlQnV0dG9uLmJpbmQodGhpcykpLnRoZW4odGhpcy5fdXBkYXRlQnV0dG9ucy5iaW5kKHRoaXMsJ3JlYWRvbmx5JykpO30sX3VwZGF0ZUJ1dHRvbnM6ZnVuY3Rpb24obW9kZSl7aWYodGhpcy4kYnV0dG9ucyl7dGhpcy4kYnV0dG9ucy50b2dnbGVDbGFzcygnby1lZGl0aW5nJyxtb2RlPT09J2VkaXQnKTtjb25zdCBzdGF0ZT10aGlzLm1vZGVsLmdldCh0aGlzLmhhbmRsZSx7cmF3OnRydWV9KTtpZihzdGF0ZS5jb3VudCl7dGhpcy4kKCcub19saXN0X2V4cG9ydF94bHN4Jykuc2hvdygpO31lbHNle3RoaXMuJCgnLm9fbGlzdF9leHBvcnRfeGxzeCcpLmhpZGUoKTt9fX0sX29uQWN0aXZhdGVOZXh0V2lkZ2V0OmZ1bmN0aW9uKGV2KXtldi5zdG9wUHJvcGFnYXRpb24oKTt0aGlzLnJlbmRlcmVyLmVkaXRGaXJzdFJlY29yZChldik7fSxfb25BZGRSZWNvcmQ6ZnVuY3Rpb24oZXYpe2V2LnN0b3BQcm9wYWdhdGlvbigpO3ZhciBkYXRhUG9pbnRJZD1ldi5kYXRhLmdyb3VwSWR8fHRoaXMuaGFuZGxlO2lmKHRoaXMuYWN0aXZlQWN0aW9ucy5jcmVhdGUpe3RoaXMuX2FkZFJlY29yZChkYXRhUG9pbnRJZCk7fWVsc2UgaWYoZXYuZGF0YS5vbkZhaWwpe2V2LmRhdGEub25GYWlsKCk7fX0sX29uQnV0dG9uQ2xpY2tlZDpmdW5jdGlvbihldil7ZXYuc3RvcFByb3BhZ2F0aW9uKCk7dGhpcy5fY2FsbEJ1dHRvbkFjdGlvbihldi5kYXRhLmF0dHJzLGV2LmRhdGEucmVjb3JkKTt9LF9vbkNyZWF0ZVJlY29yZDpmdW5jdGlvbihldil7aWYoZXYpe2V2LnN0b3BQcm9wYWdhdGlvbigpO30KdmFyIHN0YXRlPXRoaXMubW9kZWwuZ2V0KHRoaXMuaGFuZGxlLHtyYXc6dHJ1ZX0pO2lmKHRoaXMuZWRpdGFibGUmJiFzdGF0ZS5ncm91cGVkQnkubGVuZ3RoKXt0aGlzLl9hZGRSZWNvcmQodGhpcy5oYW5kbGUpO31lbHNle3RoaXMudHJpZ2dlcl91cCgnc3dpdGNoX3ZpZXcnLHt2aWV3X3R5cGU6J2Zvcm0nLHJlc19pZDp1bmRlZmluZWR9KTt9fSxfb25EZWxldGVTZWxlY3RlZFJlY29yZHM6ZnVuY3Rpb24oKXt0aGlzLl9kZWxldGVSZWNvcmRzKHRoaXMuc2VsZWN0ZWRSZWNvcmRzKTt9LF9vbkRpc2NhcmQ6ZnVuY3Rpb24oZXYpe2V2LnN0b3BQcm9wYWdhdGlvbigpO3RoaXMuX2Rpc2NhcmRDaGFuZ2VzKCk7fSxfb25EaXNjYXJkTW91c2Vkb3duOmZ1bmN0aW9uKGV2KXt2YXIgc2VsZj10aGlzO3RoaXMuZmllbGRDaGFuZ2VkUHJldmVudGVkPXRydWU7d2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLGZ1bmN0aW9uKG1vdXNldXBFdmVudCl7dmFyIHByZXZlbnRlZEV2ZW50PXNlbGYuZmllbGRDaGFuZ2VkUHJldmVudGVkO3NlbGYuZmllbGRDaGFuZ2VkUHJldmVudGVkPWZhbHNlO2lmKGV2LnRhcmdldCE9PW1vdXNldXBFdmVudC50YXJnZXQmJnByZXZlbnRlZEV2ZW50LmNvbnN0cnVjdG9yLm5hbWU9PT0nT2Rvb0V2ZW50Jyl7c2VsZi5fb25GaWVsZENoYW5nZWQocHJldmVudGVkRXZlbnQpO319LHtjYXB0dXJlOnRydWUsb25jZTp0cnVlfSk7fSxfb25FZGl0TGluZTpmdW5jdGlvbihldil7dmFyIHNlbGY9dGhpcztldi5zdG9wUHJvcGFnYXRpb24oKTt0aGlzLnRyaWdnZXJfdXAoJ211dGV4aWZ5Jyx7YWN0aW9uOmZ1bmN0aW9uKCl7c2VsZi5fc2V0TW9kZSgnZWRpdCcsZXYuZGF0YS5yZWNvcmRJZCkudGhlbihldi5kYXRhLm9uU3VjY2Vzcyk7fSx9KTt9LF9vbkV4cG9ydERhdGE6ZnVuY3Rpb24oKXt0aGlzLl9nZXRFeHBvcnREaWFsb2dXaWRnZXQoKS5vcGVuKCk7fSxfb25EaXJlY3RFeHBvcnREYXRhKCl7dGhpcy5fZ2V0RXhwb3J0RGlhbG9nV2lkZ2V0KCkuZXhwb3J0KCk7fSxfb25FZGl0R3JvdXBDbGlja2VkOmZ1bmN0aW9uKGV2KXtldi5zdG9wUHJvcGFnYXRpb24oKTt0aGlzLmRvX2FjdGlvbih7Y29udGV4dDp7Y3JlYXRlOmZhbHNlfSx0eXBlOidpci5hY3Rpb25zLmFjdF93aW5kb3cnLHZpZXdzOltbZmFsc2UsJ2Zvcm0nXV0scmVzX21vZGVsOmV2LmRhdGEucmVjb3JkLm1vZGVsLHJlc19pZDpldi5kYXRhLnJlY29yZC5yZXNfaWQsZmxhZ3M6e21vZGU6J2VkaXQnfSx9KTt9LF9vbkZpZWxkQ2hhbmdlZDpmdW5jdGlvbihldil7ZXYuc3RvcFByb3BhZ2F0aW9uKCk7Y29uc3QgcmVjb3JkSWQ9ZXYuZGF0YS5kYXRhUG9pbnRJRDtpZih0aGlzLmZpZWxkQ2hhbmdlZFByZXZlbnRlZCl7dGhpcy5maWVsZENoYW5nZWRQcmV2ZW50ZWQ9ZXY7fWVsc2UgaWYodGhpcy5yZW5kZXJlci5pc0luTXVsdGlwbGVSZWNvcmRFZGl0aW9uKHJlY29yZElkKSl7Y29uc3Qgc2F2ZU11bHRpPSgpPT57dGhpcy5tdWx0aXBsZVJlY29yZHNTYXZpbmdQcm9taXNlPXRoaXMuX3NhdmVNdWx0aXBsZVJlY29yZHMoZXYuZGF0YS5kYXRhUG9pbnRJRCxldi50YXJnZXQuX19ub2RlLGV2LmRhdGEuY2hhbmdlcyk7fTtldi5kYXRhLm9uU3VjY2Vzcz1zYXZlTXVsdGk7ZXYuZGF0YS5vbkZhaWx1cmU9c2F2ZU11bHRpO2V2LmRhdGEubm90aWZ5Q2hhbmdlPWZhbHNlO30KdGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO30sX29uU2F2ZUxpbmU6ZnVuY3Rpb24oZXYpe3RoaXMuc2F2ZVJlY29yZChldi5kYXRhLnJlY29yZElEKS50aGVuKGV2LmRhdGEub25TdWNjZXNzKS5ndWFyZGVkQ2F0Y2goZXYuZGF0YS5vbkZhaWx1cmUpO30sX29uU2VsZWN0aW9uQ2hhbmdlZDpmdW5jdGlvbihldil7dGhpcy5zZWxlY3RlZFJlY29yZHM9ZXYuZGF0YS5zZWxlY3Rpb247dGhpcy5fdG9nZ2xlU2lkZWJhcigpO30sX29uU2V0RGlydHk6ZnVuY3Rpb24oZXYpe3ZhciByZWNvcmRJZD1ldi5kYXRhLmRhdGFQb2ludElEO2lmKHRoaXMucmVuZGVyZXIuaXNJbk11bHRpcGxlUmVjb3JkRWRpdGlvbihyZWNvcmRJZCkpe2V2LnN0b3BQcm9wYWdhdGlvbigpO0RpYWxvZy5hbGVydCh0aGlzLF90KCJObyB2YWxpZCByZWNvcmQgdG8gc2F2ZSIpLHtjb25maXJtX2NhbGxiYWNrOmFzeW5jKCk9Pnt0aGlzLm1vZGVsLmRpc2NhcmRDaGFuZ2VzKHJlY29yZElkKTthd2FpdCB0aGlzLl9jb25maXJtU2F2ZShyZWNvcmRJZCk7dGhpcy5yZW5kZXJlci5mb2N1c0NlbGwocmVjb3JkSWQsZXYudGFyZ2V0Ll9fbm9kZSk7fSx9KTt9ZWxzZXt0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fX0sX29uVG9nZ2xlQ29sdW1uT3JkZXI6ZnVuY3Rpb24oZXYpe2V2LnN0b3BQcm9wYWdhdGlvbigpO3ZhciBkYXRhPXRoaXMubW9kZWwuZ2V0KHRoaXMuaGFuZGxlKTtpZighZGF0YS5ncm91cGVkQnkpe3RoaXMucGFnZXIudXBkYXRlU3RhdGUoe2N1cnJlbnRfbWluOjF9KTt9CnZhciBzZWxmPXRoaXM7dGhpcy5tb2RlbC5zZXRTb3J0KGRhdGEuaWQsZXYuZGF0YS5uYW1lKS50aGVuKGZ1bmN0aW9uKCl7c2VsZi51cGRhdGUoe30pO30pO30sX29uVG9nZ2xlR3JvdXA6ZnVuY3Rpb24oZXYpe2V2LnN0b3BQcm9wYWdhdGlvbigpO3ZhciBzZWxmPXRoaXM7dGhpcy5tb2RlbC50b2dnbGVHcm91cChldi5kYXRhLmdyb3VwLmlkKS50aGVuKGZ1bmN0aW9uKCl7c2VsZi51cGRhdGUoe30se2tlZXBTZWxlY3Rpb246dHJ1ZSxyZWxvYWQ6ZmFsc2V9KS50aGVuKGZ1bmN0aW9uKCl7aWYoZXYuZGF0YS5vblN1Y2Nlc3Mpe2V2LmRhdGEub25TdWNjZXNzKCk7fX0pO30pO30sfSk7cmV0dXJuIExpc3RDb250cm9sbGVyO30pOzsKCi8qIC93ZWIvc3RhdGljL3NyYy9qcy92aWV3cy9saXN0L2xpc3RfY29uZmlybV9kaWFsb2cuanMgZGVmaW5lZCBpbiBidW5kbGUgJ3dlYi5hc3NldHNfYmFja2VuZCcgKi8Kb2Rvby5kZWZpbmUoJ3dlYi5MaXN0Q29uZmlybURpYWxvZycsZnVuY3Rpb24ocmVxdWlyZSl7InVzZSBzdHJpY3QiO2NvbnN0IGNvcmU9cmVxdWlyZSgnd2ViLmNvcmUnKTtjb25zdCBEaWFsb2c9cmVxdWlyZSgnd2ViLkRpYWxvZycpO2NvbnN0IF90PWNvcmUuX3Q7Y29uc3QgcXdlYj1jb3JlLnF3ZWI7Y29uc3QgTGlzdENvbmZpcm1EaWFsb2c9RGlhbG9nLmV4dGVuZCh7aW5pdDpmdW5jdGlvbihwYXJlbnQscmVjb3JkLGNoYW5nZXMsb3B0aW9ucyl7b3B0aW9ucz1PYmplY3QuYXNzaWduKHt9LG9wdGlvbnMseyRjb250ZW50OiQocXdlYi5yZW5kZXIoJ0xpc3RWaWV3LmNvbmZpcm1Nb2RhbCcse2NoYW5nZXN9KSksYnV0dG9uczpvcHRpb25zLmJ1dHRvbnN8fFt7dGV4dDpfdCgiT2siKSxjbGFzc2VzOididG4tcHJpbWFyeScsY2xvc2U6dHJ1ZSxjbGljazpvcHRpb25zLmNvbmZpcm1fY2FsbGJhY2ssfSx7dGV4dDpfdCgiQ2FuY2VsIiksY2xvc2U6dHJ1ZSxjbGljazpvcHRpb25zLmNhbmNlbF9jYWxsYmFjayx9XSxvbkZvcmNlQ2xvc2U6b3B0aW9ucy5jYW5jZWxfY2FsbGJhY2ssc2l6ZTpvcHRpb25zLnNpemV8fCdtZWRpdW0nLHRpdGxlOm9wdGlvbnMudGl0bGV8fF90KCJDb25maXJtYXRpb24iKSx9KTt0aGlzLl9zdXBlcihwYXJlbnQsb3B0aW9ucyk7Y29uc3QgV2lkZ2V0PXJlY29yZC5maWVsZHNJbmZvLmxpc3RbY2hhbmdlcy5maWVsZE5hbWVdLldpZGdldDt0aGlzLmZpZWxkV2lkZ2V0PW5ldyBXaWRnZXQodGhpcyxjaGFuZ2VzLmZpZWxkTmFtZSxyZWNvcmQse21vZGU6J3JlYWRvbmx5Jyx2aWV3VHlwZTonbGlzdCcsbm9PcGVuOnRydWUsfSk7fSx3aWxsU3RhcnQ6ZnVuY3Rpb24oKXtyZXR1cm4gUHJvbWlzZS5hbGwoW3RoaXMuZmllbGRXaWRnZXQuYXBwZW5kVG8oZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpKSx0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyldKTt9LHN0YXJ0OmZ1bmN0aW9uKCl7dGhpcy4kY29udGVudC5maW5kKCcub19jaGFuZ2VzX3dpZGdldCcpLnJlcGxhY2VXaXRoKHRoaXMuZmllbGRXaWRnZXQuJGVsKTtyZXR1cm4gdGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO30sfSk7cmV0dXJuIExpc3RDb25maXJtRGlhbG9nO30pOzsKCi8qIC93ZWIvc3RhdGljL3NyYy9qcy92aWV3cy9waXZvdC9waXZvdF9tb2RlbC5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwpvZG9vLmRlZmluZSgnd2ViLlBpdm90TW9kZWwnLGZ1bmN0aW9uKHJlcXVpcmUpeyJ1c2Ugc3RyaWN0Ijt2YXIgQWJzdHJhY3RNb2RlbD1yZXF1aXJlKCd3ZWIuQWJzdHJhY3RNb2RlbCcpO3ZhciBjb25jdXJyZW5jeT1yZXF1aXJlKCd3ZWIuY29uY3VycmVuY3knKTt2YXIgY29yZT1yZXF1aXJlKCd3ZWIuY29yZScpO3ZhciBkYXRhQ29tcGFyaXNvblV0aWxzPXJlcXVpcmUoJ3dlYi5kYXRhQ29tcGFyaXNvblV0aWxzJyk7dmFyIG1hdGhVdGlscz1yZXF1aXJlKCd3ZWIubWF0aFV0aWxzJyk7dmFyIHNlc3Npb249cmVxdWlyZSgnd2ViLnNlc3Npb24nKTt2YXIgX3Q9Y29yZS5fdDt2YXIgY2FydGVzaWFuPW1hdGhVdGlscy5jYXJ0ZXNpYW47dmFyIGNvbXB1dGVWYXJpYXRpb249ZGF0YUNvbXBhcmlzb25VdGlscy5jb21wdXRlVmFyaWF0aW9uO3ZhciBzZWN0aW9ucz1tYXRoVXRpbHMuc2VjdGlvbnM7dmFyIFBpdm90TW9kZWw9QWJzdHJhY3RNb2RlbC5leHRlbmQoe2luaXQ6ZnVuY3Rpb24oKXt0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy5udW1iZXJpbmc9e307dGhpcy5kYXRhPW51bGw7dGhpcy5fbG9hZERhdGFEcm9wUHJldmlvdXM9bmV3IGNvbmN1cnJlbmN5LkRyb3BQcmV2aW91cygpO30sYWRkR3JvdXBCeTpmdW5jdGlvbihncm91cEJ5LHR5cGUpe2lmKHR5cGU9PT0ncm93Jyl7dGhpcy5kYXRhLmV4cGFuZGVkUm93R3JvdXBCeXMucHVzaChncm91cEJ5KTt9ZWxzZXt0aGlzLmRhdGEuZXhwYW5kZWRDb2xHcm91cEJ5cy5wdXNoKGdyb3VwQnkpO319LGNsb3NlR3JvdXA6ZnVuY3Rpb24oZ3JvdXBJZCx0eXBlKXt2YXIgZ3JvdXBCeXM7dmFyIGV4cGFuZGVkR3JvdXBCeXM7dmFyIGdyb3VwO3ZhciB0cmVlO2lmKHR5cGU9PT0ncm93Jyl7Z3JvdXBCeXM9dGhpcy5kYXRhLnJvd0dyb3VwQnlzO2V4cGFuZGVkR3JvdXBCeXM9dGhpcy5kYXRhLmV4cGFuZGVkUm93R3JvdXBCeXM7dHJlZT10aGlzLnJvd0dyb3VwVHJlZTtncm91cD10aGlzLl9maW5kR3JvdXAodGhpcy5yb3dHcm91cFRyZWUsZ3JvdXBJZFswXSk7fWVsc2V7Z3JvdXBCeXM9dGhpcy5kYXRhLmNvbEdyb3VwQnlzO2V4cGFuZGVkR3JvdXBCeXM9dGhpcy5kYXRhLmV4cGFuZGVkQ29sR3JvdXBCeXM7dHJlZT10aGlzLmNvbEdyb3VwVHJlZTtncm91cD10aGlzLl9maW5kR3JvdXAodGhpcy5jb2xHcm91cFRyZWUsZ3JvdXBJZFsxXSk7fQpncm91cC5kaXJlY3RTdWJUcmVlcz17fTtkZWxldGUgZ3JvdXAuc29ydGVkS2V5czt2YXIgbmV3R3JvdXBCeXNMZW5ndGg9dGhpcy5fZ2V0VHJlZUhlaWdodCh0cmVlKS0xO2lmKG5ld0dyb3VwQnlzTGVuZ3RoPD1ncm91cEJ5cy5sZW5ndGgpe2V4cGFuZGVkR3JvdXBCeXMuc3BsaWNlKDApO2dyb3VwQnlzLnNwbGljZShuZXdHcm91cEJ5c0xlbmd0aCk7fWVsc2V7ZXhwYW5kZWRHcm91cEJ5cy5zcGxpY2UobmV3R3JvdXBCeXNMZW5ndGgtZ3JvdXBCeXMubGVuZ3RoKTt9fSxleHBhbmRBbGw6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fbG9hZERhdGEoKTt9LGV4cGFuZEdyb3VwOmZ1bmN0aW9uKGdyb3VwLGdyb3VwQnkpe3ZhciBsZWZ0RGl2aXNvcnM7dmFyIHJpZ2h0RGl2aXNvcnM7aWYoZ3JvdXAudHlwZT09PSdyb3cnKXtsZWZ0RGl2aXNvcnM9W1tncm91cEJ5XV07cmlnaHREaXZpc29ycz1zZWN0aW9ucyh0aGlzLl9nZXRHcm91cEJ5cygpLmNvbEdyb3VwQnlzKTt9ZWxzZXtsZWZ0RGl2aXNvcnM9c2VjdGlvbnModGhpcy5fZ2V0R3JvdXBCeXMoKS5yb3dHcm91cEJ5cyk7cmlnaHREaXZpc29ycz1bW2dyb3VwQnldXTt9CnZhciBkaXZpc29ycz1jYXJ0ZXNpYW4obGVmdERpdmlzb3JzLHJpZ2h0RGl2aXNvcnMpO2RlbGV0ZSBncm91cC50eXBlO3JldHVybiB0aGlzLl9zdWJkaXZpZGVHcm91cChncm91cCxkaXZpc29ycyk7fSxleHBvcnREYXRhOmZ1bmN0aW9uKCl7dmFyIG1lYXN1cmVDb3VudD10aGlzLmRhdGEubWVhc3VyZXMubGVuZ3RoO3ZhciBvcmlnaW5Db3VudD10aGlzLmRhdGEub3JpZ2lucy5sZW5ndGg7dmFyIHRhYmxlPXRoaXMuX2dldFRhYmxlKCk7dmFyIGhlYWRlcnM9dGFibGUuaGVhZGVyczt2YXIgY29sR3JvdXBIZWFkZXJSb3dzO3ZhciBtZWFzdXJlUm93PVtdO3ZhciBvcmlnaW5Sb3c9W107ZnVuY3Rpb24gcHJvY2Vzc0hlYWRlcihoZWFkZXIpe3ZhciBpblRvdGFsQ29sdW1uPWhlYWRlci5ncm91cElkWzFdLmxlbmd0aD09PTA7cmV0dXJue3RpdGxlOmhlYWRlci50aXRsZSx3aWR0aDpoZWFkZXIud2lkdGgsaGVpZ2h0OmhlYWRlci5oZWlnaHQsaXNfYm9sZDohIWhlYWRlci5tZWFzdXJlJiZpblRvdGFsQ29sdW1ufTt9CmlmKG9yaWdpbkNvdW50PjEpe2NvbEdyb3VwSGVhZGVyUm93cz1oZWFkZXJzLnNsaWNlKDAsaGVhZGVycy5sZW5ndGgtMik7bWVhc3VyZVJvdz1oZWFkZXJzW2hlYWRlcnMubGVuZ3RoLTJdLm1hcChwcm9jZXNzSGVhZGVyKTtvcmlnaW5Sb3c9aGVhZGVyc1toZWFkZXJzLmxlbmd0aC0xXS5tYXAocHJvY2Vzc0hlYWRlcik7fWVsc2V7Y29sR3JvdXBIZWFkZXJSb3dzPWhlYWRlcnMuc2xpY2UoMCxoZWFkZXJzLmxlbmd0aC0xKTtpZihtZWFzdXJlQ291bnQ+MSl7bWVhc3VyZVJvdz1oZWFkZXJzW2hlYWRlcnMubGVuZ3RoLTFdLm1hcChwcm9jZXNzSGVhZGVyKTt9fQpjb2xHcm91cEhlYWRlclJvd3NbMF0uc3BsaWNlKDAsMSk7Y29sR3JvdXBIZWFkZXJSb3dzPWNvbEdyb3VwSGVhZGVyUm93cy5tYXAoZnVuY3Rpb24oaGVhZGVyUm93KXtyZXR1cm4gaGVhZGVyUm93Lm1hcChwcm9jZXNzSGVhZGVyKTt9KTt2YXIgdGFibGVSb3dzPXRhYmxlLnJvd3MubWFwKGZ1bmN0aW9uKHJvdyl7cmV0dXJue3RpdGxlOnJvdy50aXRsZSxpbmRlbnQ6cm93LmluZGVudCx2YWx1ZXM6cm93LnN1Ykdyb3VwTWVhc3VyZW1lbnRzLm1hcChmdW5jdGlvbihtZWFzdXJlbWVudCl7dmFyIHZhbHVlPW1lYXN1cmVtZW50LnZhbHVlO2lmKHZhbHVlPT09dW5kZWZpbmVkKXt2YWx1ZT0iIjt9ZWxzZSBpZihtZWFzdXJlbWVudC5vcmlnaW5JbmRleGVzLmxlbmd0aD4xKXt2YWx1ZT12YWx1ZSoxMDA7fQpyZXR1cm57aXNfYm9sZDptZWFzdXJlbWVudC5pc0JvbGQsdmFsdWU6dmFsdWUsfTt9KSx9O30pO3JldHVybntjb2xfZ3JvdXBfaGVhZGVyczpjb2xHcm91cEhlYWRlclJvd3MsbWVhc3VyZV9oZWFkZXJzOm1lYXN1cmVSb3csb3JpZ2luX2hlYWRlcnM6b3JpZ2luUm93LHJvd3M6dGFibGVSb3dzLG1lYXN1cmVfY291bnQ6bWVhc3VyZUNvdW50LG9yaWdpbl9jb3VudDpvcmlnaW5Db3VudCx9O30sZmxpcDpmdW5jdGlvbigpe3ZhciB0ZW1wPXRoaXMucm93R3JvdXBUcmVlO3RoaXMucm93R3JvdXBUcmVlPXRoaXMuY29sR3JvdXBUcmVlO3RoaXMuY29sR3JvdXBUcmVlPXRlbXA7dGVtcD10aGlzLmRhdGEucm93R3JvdXBCeXM7dGhpcy5kYXRhLmdyb3VwZWRCeT10aGlzLmRhdGEuY29sR3JvdXBCeXM7dGhpcy5kYXRhLnJvd0dyb3VwQnlzPXRoaXMuZGF0YS5jb2xHcm91cEJ5czt0aGlzLmRhdGEuY29sR3JvdXBCeXM9dGVtcDt0ZW1wPXRoaXMuZGF0YS5leHBhbmRlZENvbEdyb3VwQnlzO3RoaXMuZGF0YS5leHBhbmRlZENvbEdyb3VwQnlzPXRoaXMuZGF0YS5leHBhbmRlZFJvd0dyb3VwQnlzO3RoaXMuZGF0YS5leHBhbmRlZFJvd0dyb3VwQnlzPXRlbXA7ZnVuY3Rpb24gdHdpc3RLZXkoa2V5KXtyZXR1cm4gSlNPTi5zdHJpbmdpZnkoSlNPTi5wYXJzZShrZXkpLnJldmVyc2UoKSk7fQpmdW5jdGlvbiB0d2lzdChvYmplY3Qpe3ZhciBuZXdPYmplY3Q9e307T2JqZWN0LmtleXMob2JqZWN0KS5mb3JFYWNoKGZ1bmN0aW9uKGtleSl7dmFyIHZhbHVlPW9iamVjdFtrZXldO25ld09iamVjdFt0d2lzdEtleShrZXkpXT12YWx1ZTt9KTtyZXR1cm4gbmV3T2JqZWN0O30KdGhpcy5tZWFzdXJlbWVudHM9dHdpc3QodGhpcy5tZWFzdXJlbWVudHMpO3RoaXMuY291bnRzPXR3aXN0KHRoaXMuY291bnRzKTt0aGlzLmdyb3VwRG9tYWlucz10d2lzdCh0aGlzLmdyb3VwRG9tYWlucyk7fSxnZXQ6ZnVuY3Rpb24ob3B0aW9ucyl7b3B0aW9ucz1vcHRpb25zfHx7fTt2YXIgcmF3PW9wdGlvbnMucmF3fHxmYWxzZTt2YXIgZ3JvdXBCeXM9dGhpcy5fZ2V0R3JvdXBCeXMoKTt2YXIgc3RhdGU9e2NvbEdyb3VwQnlzOmdyb3VwQnlzLmNvbEdyb3VwQnlzLGNvbnRleHQ6dGhpcy5kYXRhLmNvbnRleHQsZG9tYWluOnRoaXMuZGF0YS5kb21haW4sZmllbGRzOnRoaXMuZmllbGRzLGhhc0RhdGE6dGhpcy5faGFzRGF0YSgpLG1lYXN1cmVzOnRoaXMuZGF0YS5tZWFzdXJlcyxvcmlnaW5zOnRoaXMuZGF0YS5vcmlnaW5zLHJvd0dyb3VwQnlzOmdyb3VwQnlzLnJvd0dyb3VwQnlzLH07aWYoIXJhdyYmc3RhdGUuaGFzRGF0YSl7c3RhdGUudGFibGU9dGhpcy5fZ2V0VGFibGUoKTt9CnJldHVybiBzdGF0ZTt9LGdldFRhYmxlV2lkdGg6ZnVuY3Rpb24oKXt2YXIgbGVhZkNvdW50cz10aGlzLl9nZXRMZWFmQ291bnRzKHRoaXMuY29sR3JvdXBUcmVlKTtyZXR1cm4gbGVhZkNvdW50c1tKU09OLnN0cmluZ2lmeSh0aGlzLmNvbEdyb3VwVHJlZS5yb290LnZhbHVlcyldKzI7fSxsb2FkOmZ1bmN0aW9uKHBhcmFtcyl7dGhpcy5pbml0aWFsRG9tYWluPXBhcmFtcy5kb21haW47dGhpcy5pbml0aWFsUm93R3JvdXBCeXM9cGFyYW1zLmNvbnRleHQucGl2b3Rfcm93X2dyb3VwYnl8fHBhcmFtcy5yb3dHcm91cEJ5czt0aGlzLmRlZmF1bHRHcm91cGVkQnk9cGFyYW1zLmdyb3VwZWRCeTt0aGlzLmZpZWxkcz1wYXJhbXMuZmllbGRzO3RoaXMubW9kZWxOYW1lPXBhcmFtcy5tb2RlbE5hbWU7dGhpcy5kYXRhPXtleHBhbmRlZFJvd0dyb3VwQnlzOltdLGV4cGFuZGVkQ29sR3JvdXBCeXM6W10sZG9tYWluOnRoaXMuaW5pdGlhbERvbWFpbix0aW1lUmFuZ2U6cGFyYW1zLnRpbWVSYW5nZXx8W10sdGltZVJhbmdlRGVzY3JpcHRpb246cGFyYW1zLnRpbWVSYW5nZURlc2NyaXB0aW9ufHwiIixjb21wYXJpc29uVGltZVJhbmdlOnBhcmFtcy5jb21wYXJpc29uVGltZVJhbmdlfHxbXSxjb21wYXJpc29uVGltZVJhbmdlRGVzY3JpcHRpb246cGFyYW1zLmNvbXBhcmlzb25UaW1lUmFuZ2VEZXNjcmlwdGlvbnx8IiIsY29tcGFyZTpwYXJhbXMuY29tcGFyZXx8ZmFsc2UsY29udGV4dDpfLmV4dGVuZCh7fSxzZXNzaW9uLnVzZXJfY29udGV4dCxwYXJhbXMuY29udGV4dCksZ3JvdXBlZEJ5OnBhcmFtcy5jb250ZXh0LnBpdm90X3Jvd19ncm91cGJ5fHxwYXJhbXMuZ3JvdXBlZEJ5LGNvbEdyb3VwQnlzOnBhcmFtcy5jb250ZXh0LnBpdm90X2NvbHVtbl9ncm91cGJ5fHxwYXJhbXMuY29sR3JvdXBCeXMsbWVhc3VyZXM6dGhpcy5fcHJvY2Vzc01lYXN1cmVzKHBhcmFtcy5jb250ZXh0LnBpdm90X21lYXN1cmVzKXx8cGFyYW1zLm1lYXN1cmVzLH07dGhpcy5kYXRhLmRvbWFpbnM9dGhpcy5fZ2V0RG9tYWlucygpO3RoaXMuZGF0YS5vcmlnaW5zPXRoaXMuX2dldE9yaWdpbnMoKTt0aGlzLmRhdGEucm93R3JvdXBCeXM9IV8uaXNFbXB0eSh0aGlzLmRhdGEuZ3JvdXBlZEJ5KT90aGlzLmRhdGEuZ3JvdXBlZEJ5OnRoaXMuaW5pdGlhbFJvd0dyb3VwQnlzO3ZhciBkZWZhdWx0T3JkZXI9cGFyYW1zLmRlZmF1bHRfb3JkZXImJnBhcmFtcy5kZWZhdWx0X29yZGVyLnNwbGl0KCcgJyk7aWYoZGVmYXVsdE9yZGVyKXt0aGlzLmRhdGEuc29ydGVkQ29sdW1uPXtncm91cElkOltbXSxbXV0sbWVhc3VyZTpkZWZhdWx0T3JkZXJbMF0sb3JkZXI6ZGVmYXVsdE9yZGVyWzFdP2RlZmF1bHRPcmRlclsxXTonYXNjJyx9O30KcmV0dXJuIHRoaXMuX2xvYWREYXRhKCk7fSxyZWxvYWQ6ZnVuY3Rpb24oaGFuZGxlLHBhcmFtcyl7dmFyIHNlbGY9dGhpczt2YXIgb2xkQ29sR3JvdXBCeXM9dGhpcy5kYXRhLmNvbEdyb3VwQnlzO3ZhciBvbGRSb3dHcm91cEJ5cz10aGlzLmRhdGEucm93R3JvdXBCeXM7aWYoJ2NvbnRleHQnaW4gcGFyYW1zKXt0aGlzLmRhdGEuY29udGV4dD1wYXJhbXMuY29udGV4dDt0aGlzLmRhdGEuY29sR3JvdXBCeXM9cGFyYW1zLmNvbnRleHQucGl2b3RfY29sdW1uX2dyb3VwYnl8fHRoaXMuZGF0YS5jb2xHcm91cEJ5czt0aGlzLmRhdGEuZ3JvdXBlZEJ5PXBhcmFtcy5jb250ZXh0LnBpdm90X3Jvd19ncm91cGJ5fHx0aGlzLmRhdGEuZ3JvdXBlZEJ5O3RoaXMuZGF0YS5tZWFzdXJlcz10aGlzLl9wcm9jZXNzTWVhc3VyZXMocGFyYW1zLmNvbnRleHQucGl2b3RfbWVhc3VyZXMpfHx0aGlzLmRhdGEubWVhc3VyZXM7dGhpcy5kZWZhdWx0R3JvdXBlZEJ5PXRoaXMuZGF0YS5ncm91cGVkQnkubGVuZ3RoP3RoaXMuZGF0YS5ncm91cGVkQnk6dGhpcy5kZWZhdWx0R3JvdXBlZEJ5O3ZhciB0aW1lUmFuZ2VNZW51RGF0YT1wYXJhbXMuY29udGV4dC50aW1lUmFuZ2VNZW51RGF0YTtpZih0aW1lUmFuZ2VNZW51RGF0YSl7dGhpcy5kYXRhLnRpbWVSYW5nZT10aW1lUmFuZ2VNZW51RGF0YS50aW1lUmFuZ2V8fFtdO3RoaXMuZGF0YS50aW1lUmFuZ2VEZXNjcmlwdGlvbj10aW1lUmFuZ2VNZW51RGF0YS50aW1lUmFuZ2VEZXNjcmlwdGlvbnx8IiI7dGhpcy5kYXRhLmNvbXBhcmlzb25UaW1lUmFuZ2U9dGltZVJhbmdlTWVudURhdGEuY29tcGFyaXNvblRpbWVSYW5nZXx8W107dGhpcy5kYXRhLmNvbXBhcmlzb25UaW1lUmFuZ2VEZXNjcmlwdGlvbj10aW1lUmFuZ2VNZW51RGF0YS5jb21wYXJpc29uVGltZVJhbmdlRGVzY3JpcHRpb258fCIiO3RoaXMuZGF0YS5jb21wYXJlPXRoaXMuZGF0YS5jb21wYXJpc29uVGltZVJhbmdlLmxlbmd0aD4wO31lbHNle3RoaXMuZGF0YS50aW1lUmFuZ2U9W107dGhpcy5kYXRhLnRpbWVSYW5nZURlc2NyaXB0aW9uPSIiO3RoaXMuZGF0YS5jb21wYXJpc29uVGltZVJhbmdlPVtdO3RoaXMuZGF0YS5jb21wYXJpc29uVGltZVJhbmdlRGVzY3JpcHRpb249IiI7dGhpcy5kYXRhLmNvbXBhcmU9ZmFsc2U7dGhpcy5kYXRhLmNvbnRleHQ9Xy5vbWl0KHRoaXMuZGF0YS5jb250ZXh0LCd0aW1lUmFuZ2VNZW51RGF0YScpO319CmlmKCdkb21haW4naW4gcGFyYW1zKXt0aGlzLmRhdGEuZG9tYWluPXBhcmFtcy5kb21haW47dGhpcy5pbml0aWFsRG9tYWluPXBhcmFtcy5kb21haW47fWVsc2V7dGhpcy5kYXRhLmRvbWFpbj10aGlzLmluaXRpYWxEb21haW47fQppZignZ3JvdXBCeSdpbiBwYXJhbXMpe3RoaXMuZGF0YS5ncm91cGVkQnk9cGFyYW1zLmdyb3VwQnkubGVuZ3RoP3BhcmFtcy5ncm91cEJ5OnRoaXMuZGVmYXVsdEdyb3VwZWRCeTt9CnRoaXMuZGF0YS5kb21haW5zPXRoaXMuX2dldERvbWFpbnMoKTt0aGlzLmRhdGEub3JpZ2lucz10aGlzLl9nZXRPcmlnaW5zKCk7dGhpcy5kYXRhLnJvd0dyb3VwQnlzPSFfLmlzRW1wdHkodGhpcy5kYXRhLmdyb3VwZWRCeSk/dGhpcy5kYXRhLmdyb3VwZWRCeTp0aGlzLmluaXRpYWxSb3dHcm91cEJ5cztpZighXy5pc0VxdWFsKG9sZFJvd0dyb3VwQnlzLHNlbGYuZGF0YS5yb3dHcm91cEJ5cykpe3RoaXMuZGF0YS5leHBhbmRlZFJvd0dyb3VwQnlzPVtdO30KaWYoIV8uaXNFcXVhbChvbGRDb2xHcm91cEJ5cyxzZWxmLmRhdGEuY29sR3JvdXBCeXMpKXt0aGlzLmRhdGEuZXhwYW5kZWRDb2xHcm91cEJ5cz1bXTt9CmlmKCF0aGlzLl9oYXNEYXRhKCkpe3JldHVybiB0aGlzLl9sb2FkRGF0YSgpO30KdmFyIG9sZFJvd0dyb3VwVHJlZT10aGlzLnJvd0dyb3VwVHJlZTt2YXIgb2xkQ29sR3JvdXBUcmVlPXRoaXMuY29sR3JvdXBUcmVlO3JldHVybiB0aGlzLl9sb2FkRGF0YSgpLnRoZW4oZnVuY3Rpb24oKXtpZihfLmlzRXF1YWwob2xkUm93R3JvdXBCeXMsc2VsZi5kYXRhLnJvd0dyb3VwQnlzKSl7c2VsZi5fcHJ1bmVUcmVlKHNlbGYucm93R3JvdXBUcmVlLG9sZFJvd0dyb3VwVHJlZSk7fQppZihfLmlzRXF1YWwob2xkQ29sR3JvdXBCeXMsc2VsZi5kYXRhLmNvbEdyb3VwQnlzKSl7c2VsZi5fcHJ1bmVUcmVlKHNlbGYuY29sR3JvdXBUcmVlLG9sZENvbEdyb3VwVHJlZSk7fX0pO30sc29ydFJvd3M6ZnVuY3Rpb24oc29ydGVkQ29sdW1uKXt2YXIgc2VsZj10aGlzO3ZhciBjb2xHcm91cFZhbHVlcz1zb3J0ZWRDb2x1bW4uZ3JvdXBJZFsxXTtzb3J0ZWRDb2x1bW4ub3JpZ2luSW5kZXhlcz1zb3J0ZWRDb2x1bW4ub3JpZ2luSW5kZXhlc3x8WzBdO3RoaXMuZGF0YS5zb3J0ZWRDb2x1bW49c29ydGVkQ29sdW1uO3ZhciBzb3J0RnVuY3Rpb249ZnVuY3Rpb24odHJlZSl7cmV0dXJuIGZ1bmN0aW9uKHN1YlRyZWVLZXkpe3ZhciBzdWJUcmVlPXRyZWUuZGlyZWN0U3ViVHJlZXNbc3ViVHJlZUtleV07dmFyIGdyb3VwSW50ZXJzZWN0aW9uSWQ9W3N1YlRyZWUucm9vdC52YWx1ZXMsY29sR3JvdXBWYWx1ZXNdO3ZhciB2YWx1ZT1zZWxmLl9nZXRDZWxsVmFsdWUoZ3JvdXBJbnRlcnNlY3Rpb25JZCxzb3J0ZWRDb2x1bW4ubWVhc3VyZSxzb3J0ZWRDb2x1bW4ub3JpZ2luSW5kZXhlcyl8fDA7cmV0dXJuIHNvcnRlZENvbHVtbi5vcmRlcj09PSdhc2MnP3ZhbHVlOi12YWx1ZTt9O307dGhpcy5fc29ydFRyZWUoc29ydEZ1bmN0aW9uLHRoaXMucm93R3JvdXBUcmVlKTt9LHRvZ2dsZU1lYXN1cmU6ZnVuY3Rpb24oZmllbGROYW1lKXt2YXIgaW5kZXg9dGhpcy5kYXRhLm1lYXN1cmVzLmluZGV4T2YoZmllbGROYW1lKTtpZihpbmRleCE9PS0xKXt0aGlzLmRhdGEubWVhc3VyZXMuc3BsaWNlKGluZGV4LDEpO3JldHVybiBQcm9taXNlLnJlc29sdmUoKTt9ZWxzZXt0aGlzLmRhdGEubWVhc3VyZXMucHVzaChmaWVsZE5hbWUpO30KcmV0dXJuIHRoaXMuX2xvYWREYXRhKCk7fSxfYWRkR3JvdXA6ZnVuY3Rpb24oZ3JvdXBUcmVlLGxhYmVscyx2YWx1ZXMpe3ZhciB0cmVlPWdyb3VwVHJlZTt2YWx1ZXMuc2xpY2UoMCx2YWx1ZXMubGVuZ3RoLTEpLmZvckVhY2goZnVuY3Rpb24odmFsdWUpe3ZhciBrZXk9SlNPTi5zdHJpbmdpZnkodmFsdWUpO3RyZWU9dHJlZS5kaXJlY3RTdWJUcmVlc1trZXldO30pO3RyZWUuZGlyZWN0U3ViVHJlZXNbSlNPTi5zdHJpbmdpZnkodmFsdWVzW3ZhbHVlcy5sZW5ndGgtMV0pXT17cm9vdDp7bGFiZWxzOmxhYmVscyx2YWx1ZXM6dmFsdWVzLH0sZGlyZWN0U3ViVHJlZXM6e30sfTt9LF9jb21wdXRlUm93R3JvdXBCeXM6ZnVuY3Rpb24oKXtyZXR1cm4hXy5pc0VtcHR5KHRoaXMuZGF0YS5ncm91cGVkQnkpP3RoaXMuZGF0YS5ncm91cGVkQnk6dGhpcy5pbml0aWFsUm93R3JvdXBCeXM7fSxfZmluZEdyb3VwOmZ1bmN0aW9uKGdyb3VwVHJlZSx2YWx1ZXMpe3ZhciB0cmVlPWdyb3VwVHJlZTt2YWx1ZXMuc2xpY2UoMCx2YWx1ZXMubGVuZ3RoKS5mb3JFYWNoKGZ1bmN0aW9uKHZhbHVlKXt2YXIga2V5PUpTT04uc3RyaW5naWZ5KHZhbHVlKTt0cmVlPXRyZWUuZGlyZWN0U3ViVHJlZXNba2V5XTt9KTtyZXR1cm4gdHJlZTt9LF9nZXRDZWxsVmFsdWU6ZnVuY3Rpb24oZ3JvdXBJZCxtZWFzdXJlLG9yaWdpbkluZGV4ZXMpe3ZhciBzZWxmPXRoaXM7dmFyIGtleT1KU09OLnN0cmluZ2lmeShncm91cElkKTtpZighc2VsZi5tZWFzdXJlbWVudHNba2V5XSl7cmV0dXJuO30KdmFyIHZhbHVlcz1vcmlnaW5JbmRleGVzLm1hcChmdW5jdGlvbihvcmlnaW5JbmRleCl7cmV0dXJuIHNlbGYubWVhc3VyZW1lbnRzW2tleV1bb3JpZ2luSW5kZXhdW21lYXN1cmVdO30pO2lmKG9yaWdpbkluZGV4ZXMubGVuZ3RoPjEpe3JldHVybiBjb21wdXRlVmFyaWF0aW9uKHZhbHVlc1swXSx2YWx1ZXNbMV0pO31lbHNle3JldHVybiB2YWx1ZXNbMF07fX0sX2dldERvbWFpbnM6ZnVuY3Rpb24oKXt2YXIgZG9tYWlucz1bdGhpcy5kYXRhLmRvbWFpbi5jb25jYXQodGhpcy5kYXRhLnRpbWVSYW5nZSldO2lmKHRoaXMuZGF0YS5jb21wYXJlKXtkb21haW5zLnB1c2godGhpcy5kYXRhLmRvbWFpbi5jb25jYXQodGhpcy5kYXRhLmNvbXBhcmlzb25UaW1lUmFuZ2UpKTt9CnJldHVybiBkb21haW5zO30sX2dldEdyb3VwQnlzOmZ1bmN0aW9uKCl7cmV0dXJue2NvbEdyb3VwQnlzOnRoaXMuZGF0YS5jb2xHcm91cEJ5cy5jb25jYXQodGhpcy5kYXRhLmV4cGFuZGVkQ29sR3JvdXBCeXMpLHJvd0dyb3VwQnlzOnRoaXMuZGF0YS5yb3dHcm91cEJ5cy5jb25jYXQodGhpcy5kYXRhLmV4cGFuZGVkUm93R3JvdXBCeXMpLH07fSxfZ2V0R3JvdXBEb21haW46ZnVuY3Rpb24oZ3JvdXApe3ZhciBrZXk9SlNPTi5zdHJpbmdpZnkoW2dyb3VwLnJvd1ZhbHVlcyxncm91cC5jb2xWYWx1ZXNdKTtyZXR1cm4gdGhpcy5ncm91cERvbWFpbnNba2V5XVtncm91cC5vcmlnaW5JbmRleF07fSxfZ2V0R3JvdXBMYWJlbHM6ZnVuY3Rpb24oZ3JvdXAsZ3JvdXBCeXMpe3ZhciBzZWxmPXRoaXM7cmV0dXJuIGdyb3VwQnlzLm1hcChmdW5jdGlvbihncm91cEJ5KXtyZXR1cm4gc2VsZi5fc2FuaXRpemVMYWJlbChncm91cFtncm91cEJ5XSxncm91cEJ5KTt9KTt9LF9nZXRHcm91cFN1YmRpdmlzaW9uOmZ1bmN0aW9uKGdyb3VwLHJvd0dyb3VwQnksY29sR3JvdXBCeSl7dmFyIGdyb3VwRG9tYWluPXRoaXMuX2dldEdyb3VwRG9tYWluKGdyb3VwKTt2YXIgbWVhc3VyZVNwZWNzPXRoaXMuX2dldE1lYXN1cmVTcGVjcygpO3ZhciBncm91cEJ5PXJvd0dyb3VwQnkuY29uY2F0KGNvbEdyb3VwQnkpO3JldHVybiB0aGlzLl9ycGMoe21vZGVsOnRoaXMubW9kZWxOYW1lLG1ldGhvZDoncmVhZF9ncm91cCcsY29udGV4dDp0aGlzLmRhdGEuY29udGV4dCxkb21haW46Z3JvdXBEb21haW4sZmllbGRzOm1lYXN1cmVTcGVjcyxncm91cEJ5Omdyb3VwQnksbGF6eTpmYWxzZSx9KS50aGVuKGZ1bmN0aW9uKHN1Ykdyb3Vwcyl7cmV0dXJue2dyb3VwOmdyb3VwLHN1Ykdyb3VwczpzdWJHcm91cHMscm93R3JvdXBCeTpyb3dHcm91cEJ5LGNvbEdyb3VwQnk6Y29sR3JvdXBCeX07fSk7fSxfZ2V0R3JvdXBWYWx1ZXM6ZnVuY3Rpb24oZ3JvdXAsZ3JvdXBCeXMpe3ZhciBzZWxmPXRoaXM7cmV0dXJuIGdyb3VwQnlzLm1hcChmdW5jdGlvbihncm91cEJ5KXtyZXR1cm4gc2VsZi5fc2FuaXRpemVWYWx1ZShncm91cFtncm91cEJ5XSk7fSk7fSxfZ2V0TGVhZkNvdW50czpmdW5jdGlvbih0cmVlKXt2YXIgc2VsZj10aGlzO3ZhciBsZWFmQ291bnRzPXt9O3ZhciBsZWFmQ291bnQ7aWYoXy5pc0VtcHR5KHRyZWUuZGlyZWN0U3ViVHJlZXMpKXtsZWFmQ291bnQ9MTt9ZWxzZXtsZWFmQ291bnQ9Xy52YWx1ZXModHJlZS5kaXJlY3RTdWJUcmVlcykucmVkdWNlKGZ1bmN0aW9uKGFjYyxzdWJUcmVlKXt2YXIgc3ViTGVhZkNvdW50cz1zZWxmLl9nZXRMZWFmQ291bnRzKHN1YlRyZWUpO18uZXh0ZW5kKGxlYWZDb3VudHMsc3ViTGVhZkNvdW50cyk7cmV0dXJuIGFjYytsZWFmQ291bnRzW0pTT04uc3RyaW5naWZ5KHN1YlRyZWUucm9vdC52YWx1ZXMpXTt9LDApO30KbGVhZkNvdW50c1tKU09OLnN0cmluZ2lmeSh0cmVlLnJvb3QudmFsdWVzKV09bGVhZkNvdW50O3JldHVybiBsZWFmQ291bnRzO30sX2dldE1lYXN1cmVtZW50czpmdW5jdGlvbihncm91cCl7dmFyIHNlbGY9dGhpcztyZXR1cm4gdGhpcy5kYXRhLm1lYXN1cmVzLnJlZHVjZShmdW5jdGlvbihtZWFzdXJlbWVudHMsZmllbGROYW1lKXt2YXIgbWVhc3VyZW1lbnQ9Z3JvdXBbZmllbGROYW1lXTtpZihtZWFzdXJlbWVudCBpbnN0YW5jZW9mIEFycmF5KXttZWFzdXJlbWVudD0xO30KaWYoc2VsZi5maWVsZHNbZmllbGROYW1lXS50eXBlPT09J2Jvb2xlYW4nJiZtZWFzdXJlbWVudCBpbnN0YW5jZW9mIEJvb2xlYW4pe21lYXN1cmVtZW50PW1lYXN1cmVtZW50PzE6MDt9CmlmKHNlbGYuZGF0YS5vcmlnaW5zLmxlbmd0aD4xJiYhbWVhc3VyZW1lbnQpe21lYXN1cmVtZW50PTA7fQptZWFzdXJlbWVudHNbZmllbGROYW1lXT1tZWFzdXJlbWVudDtyZXR1cm4gbWVhc3VyZW1lbnRzO30se30pO30sX2dldE1lYXN1cmVzUm93OmZ1bmN0aW9uKGNvbHVtbnMpe3ZhciBzZWxmPXRoaXM7dmFyIHNvcnRlZENvbHVtbj10aGlzLmRhdGEuc29ydGVkQ29sdW1ufHx7fTt2YXIgbWVhc3VyZVJvdz1bXTtjb2x1bW5zLmZvckVhY2goZnVuY3Rpb24oY29sdW1uKXtzZWxmLmRhdGEubWVhc3VyZXMuZm9yRWFjaChmdW5jdGlvbihtZWFzdXJlKXt2YXIgbWVhc3VyZUNlbGw9e2dyb3VwSWQ6Y29sdW1uLmdyb3VwSWQsaGVpZ2h0OjEsbWVhc3VyZTptZWFzdXJlLHRpdGxlOnNlbGYuZmllbGRzW21lYXN1cmVdLnN0cmluZyx3aWR0aDoyKnNlbGYuZGF0YS5vcmlnaW5zLmxlbmd0aC0xLH07aWYoc29ydGVkQ29sdW1uLm1lYXN1cmU9PT1tZWFzdXJlJiZfLmlzRXF1YWwoc29ydGVkQ29sdW1uLmdyb3VwSWQsY29sdW1uLmdyb3VwSWQpKXttZWFzdXJlQ2VsbC5vcmRlcj1zb3J0ZWRDb2x1bW4ub3JkZXI7fQptZWFzdXJlUm93LnB1c2gobWVhc3VyZUNlbGwpO30pO30pO3JldHVybiBtZWFzdXJlUm93O30sX2dldE1lYXN1cmVTcGVjczpmdW5jdGlvbigpe3ZhciBzZWxmPXRoaXM7cmV0dXJuIHRoaXMuZGF0YS5tZWFzdXJlcy5yZWR1Y2UoZnVuY3Rpb24oYWNjLG1lYXN1cmUpe2lmKG1lYXN1cmU9PT0nX19jb3VudCcpe2FjYy5wdXNoKG1lYXN1cmUpO3JldHVybiBhY2M7fQp2YXIgdHlwZT1zZWxmLmZpZWxkc1ttZWFzdXJlXS50eXBlO3ZhciBncm91cE9wZXJhdG9yPXNlbGYuZmllbGRzW21lYXN1cmVdLmdyb3VwX29wZXJhdG9yO2lmKHR5cGU9PT0nbWFueTJvbmUnKXtncm91cE9wZXJhdG9yPSdjb3VudF9kaXN0aW5jdCc7fQppZihncm91cE9wZXJhdG9yPT09dW5kZWZpbmVkKXt0aHJvdyBuZXcgRXJyb3IoIk5vIGFnZ3JlZ2F0ZSBmdW5jdGlvbiBoYXMgYmVlbiBwcm92aWRlZCBmb3IgdGhlIG1lYXN1cmUgJyIrbWVhc3VyZSsiJyIpO30KYWNjLnB1c2gobWVhc3VyZSsnOicrZ3JvdXBPcGVyYXRvcik7cmV0dXJuIGFjYzt9LFtdKTt9LF9nZXROdW1iZXJlZExhYmVsOmZ1bmN0aW9uKGxhYmVsLGZpZWxkTmFtZSl7dmFyIGlkPWxhYmVsWzBdO3ZhciBuYW1lPWxhYmVsWzFdO3RoaXMubnVtYmVyaW5nW2ZpZWxkTmFtZV09dGhpcy5udW1iZXJpbmdbZmllbGROYW1lXXx8e307dGhpcy5udW1iZXJpbmdbZmllbGROYW1lXVtuYW1lXT10aGlzLm51bWJlcmluZ1tmaWVsZE5hbWVdW25hbWVdfHx7fTt2YXIgbnVtYmVycz10aGlzLm51bWJlcmluZ1tmaWVsZE5hbWVdW25hbWVdO251bWJlcnNbaWRdPW51bWJlcnNbaWRdfHxfLnNpemUobnVtYmVycykrMTtyZXR1cm4gbmFtZSsobnVtYmVyc1tpZF0+MT8iICAoIitudW1iZXJzW2lkXSsiKSI6IiIpO30sX2dldE9yaWdpbnNSb3c6ZnVuY3Rpb24oY29sdW1ucyl7dmFyIHNlbGY9dGhpczt2YXIgc29ydGVkQ29sdW1uPXRoaXMuZGF0YS5zb3J0ZWRDb2x1bW58fHt9O3ZhciBvcmlnaW5Sb3c9W107Y29sdW1ucy5mb3JFYWNoKGZ1bmN0aW9uKGNvbHVtbil7dmFyIGdyb3VwSWQ9Y29sdW1uLmdyb3VwSWQ7dmFyIG1lYXN1cmU9Y29sdW1uLm1lYXN1cmU7dmFyIGlzU29ydGVkPXNvcnRlZENvbHVtbi5tZWFzdXJlPT09bWVhc3VyZSYmXy5pc0VxdWFsKHNvcnRlZENvbHVtbi5ncm91cElkLGdyb3VwSWQpO3ZhciBpc1NvcnRlZEJ5T3JpZ2luPWlzU29ydGVkJiYhc29ydGVkQ29sdW1uLm9yaWdpbkluZGV4ZXNbMV07dmFyIGlzU29ydGVkQnlWYXJpYXRpb249aXNTb3J0ZWQmJnNvcnRlZENvbHVtbi5vcmlnaW5JbmRleGVzWzFdO3NlbGYuZGF0YS5vcmlnaW5zLmZvckVhY2goZnVuY3Rpb24ob3JpZ2luLG9yaWdpbkluZGV4KXt2YXIgb3JpZ2luQ2VsbD17Z3JvdXBJZDpncm91cElkLGhlaWdodDoxLG1lYXN1cmU6bWVhc3VyZSxvcmlnaW5JbmRleGVzOltvcmlnaW5JbmRleF0sdGl0bGU6b3JpZ2luLHdpZHRoOjEsfTtpZihpc1NvcnRlZEJ5T3JpZ2luJiZzb3J0ZWRDb2x1bW4ub3JpZ2luSW5kZXhlc1swXT09PW9yaWdpbkluZGV4KXtvcmlnaW5DZWxsLm9yZGVyPXNvcnRlZENvbHVtbi5vcmRlcjt9Cm9yaWdpblJvdy5wdXNoKG9yaWdpbkNlbGwpO2lmKG9yaWdpbkluZGV4PjApe3ZhciB2YXJpYXRpb25DZWxsPXtncm91cElkOmdyb3VwSWQsaGVpZ2h0OjEsbWVhc3VyZTptZWFzdXJlLG9yaWdpbkluZGV4ZXM6W29yaWdpbkluZGV4LTEsb3JpZ2luSW5kZXhdLHRpdGxlOl90KCdWYXJpYXRpb24nKSx3aWR0aDoxLH07aWYoaXNTb3J0ZWRCeVZhcmlhdGlvbiYmc29ydGVkQ29sdW1uLm9yaWdpbkluZGV4ZXNbMV09PT1vcmlnaW5JbmRleCl7dmFyaWF0aW9uQ2VsbC5vcmRlcj1zb3J0ZWRDb2x1bW4ub3JkZXI7fQpvcmlnaW5Sb3cucHVzaCh2YXJpYXRpb25DZWxsKTt9fSk7fSk7cmV0dXJuIG9yaWdpblJvdzt9LF9nZXRPcmlnaW5zOmZ1bmN0aW9uKCl7dmFyIG9yaWdpbnM9W3RoaXMuZGF0YS50aW1lUmFuZ2VEZXNjcmlwdGlvbnx8IiJdO2lmKHRoaXMuZGF0YS5jb21wYXJlKXtvcmlnaW5zLnB1c2godGhpcy5kYXRhLmNvbXBhcmlzb25UaW1lUmFuZ2VEZXNjcmlwdGlvbik7fQpyZXR1cm4gb3JpZ2luczt9LF9nZXRUYWJsZTpmdW5jdGlvbigpe3ZhciBoZWFkZXJzPXRoaXMuX2dldFRhYmxlSGVhZGVycygpO3JldHVybntoZWFkZXJzOmhlYWRlcnMscm93czp0aGlzLl9nZXRUYWJsZVJvd3ModGhpcy5yb3dHcm91cFRyZWUsaGVhZGVyc1toZWFkZXJzLmxlbmd0aC0xXSksfTt9LF9nZXRUYWJsZUhlYWRlcnM6ZnVuY3Rpb24oKXt2YXIgY29sR3JvdXBCeXM9dGhpcy5fZ2V0R3JvdXBCeXMoKS5jb2xHcm91cEJ5czt2YXIgaGVpZ2h0PWNvbEdyb3VwQnlzLmxlbmd0aCsxO3ZhciBtZWFzdXJlQ291bnQ9dGhpcy5kYXRhLm1lYXN1cmVzLmxlbmd0aDt2YXIgb3JpZ2luQ291bnQ9dGhpcy5kYXRhLm9yaWdpbnMubGVuZ3RoO3ZhciBsZWFmQ291bnRzPXRoaXMuX2dldExlYWZDb3VudHModGhpcy5jb2xHcm91cFRyZWUpO3ZhciBoZWFkZXJzPVtdO3ZhciBtZWFzdXJlQ29sdW1ucz1bXTt2YXIgY29sR3JvdXBSb3dzPShuZXcgQXJyYXkoaGVpZ2h0KSkuZmlsbCgwKS5tYXAoZnVuY3Rpb24oKXtyZXR1cm5bXTt9KTtjb2xHcm91cFJvd3NbMF0ucHVzaCh7aGVpZ2h0OmhlaWdodCsxKyhvcmlnaW5Db3VudD4xPzE6MCksdGl0bGU6IiIsd2lkdGg6MSx9KTtmdW5jdGlvbiBnZW5lcmF0ZVRyZWVIZWFkZXJzKHRyZWUpe3ZhciBncm91cD10cmVlLnJvb3Q7dmFyIHJvd0luZGV4PWdyb3VwLnZhbHVlcy5sZW5ndGg7dmFyIHJvdz1jb2xHcm91cFJvd3Nbcm93SW5kZXhdO3ZhciBncm91cElkPVtbXSxncm91cC52YWx1ZXNdO3ZhciBpc0xlYWY9Xy5pc0VtcHR5KHRyZWUuZGlyZWN0U3ViVHJlZXMpO3ZhciBsZWFmQ291bnQ9bGVhZkNvdW50c1tKU09OLnN0cmluZ2lmeSh0cmVlLnJvb3QudmFsdWVzKV07dmFyIGNlbGw9e2dyb3VwSWQ6Z3JvdXBJZCxoZWlnaHQ6aXNMZWFmPyhjb2xHcm91cEJ5cy5sZW5ndGgrMS1yb3dJbmRleCk6MSxpc0xlYWY6aXNMZWFmLHRpdGxlOmdyb3VwLmxhYmVsc1tncm91cC5sYWJlbHMubGVuZ3RoLTFdfHxfdCgnVG90YWwnKSx3aWR0aDpsZWFmQ291bnQqbWVhc3VyZUNvdW50KigyKm9yaWdpbkNvdW50LTEpLH07cm93LnB1c2goY2VsbCk7aWYoaXNMZWFmKXttZWFzdXJlQ29sdW1ucy5wdXNoKGNlbGwpO30KXy52YWx1ZXModHJlZS5kaXJlY3RTdWJUcmVlcykuZm9yRWFjaChmdW5jdGlvbihzdWJUcmVlKXtnZW5lcmF0ZVRyZWVIZWFkZXJzKHN1YlRyZWUpO30pO30KZ2VuZXJhdGVUcmVlSGVhZGVycyh0aGlzLmNvbEdyb3VwVHJlZSk7aWYobGVhZkNvdW50c1tKU09OLnN0cmluZ2lmeSh0aGlzLmNvbEdyb3VwVHJlZS5yb290LnZhbHVlcyldPjEpe3ZhciBncm91cElkPVtbXSxbXV07dmFyIHRvdGFsVG9wUmlnaHRDZWxsPXtncm91cElkOmdyb3VwSWQsaGVpZ2h0OmhlaWdodCx0aXRsZToiIix3aWR0aDptZWFzdXJlQ291bnQqKDIqb3JpZ2luQ291bnQtMSksfTtjb2xHcm91cFJvd3NbMF0ucHVzaCh0b3RhbFRvcFJpZ2h0Q2VsbCk7bWVhc3VyZUNvbHVtbnMucHVzaCh0b3RhbFRvcFJpZ2h0Q2VsbCk7fQpoZWFkZXJzPWhlYWRlcnMuY29uY2F0KGNvbEdyb3VwUm93cyk7dmFyIG1lYXN1cmVzUm93PXRoaXMuX2dldE1lYXN1cmVzUm93KG1lYXN1cmVDb2x1bW5zKTtoZWFkZXJzLnB1c2gobWVhc3VyZXNSb3cpO2lmKG9yaWdpbkNvdW50PjEpe2hlYWRlcnMucHVzaCh0aGlzLl9nZXRPcmlnaW5zUm93KG1lYXN1cmVzUm93KSk7fQpyZXR1cm4gaGVhZGVyczt9LF9nZXRUYWJsZVJvd3M6ZnVuY3Rpb24odHJlZSxjb2x1bW5zKXt2YXIgc2VsZj10aGlzO3ZhciByb3dzPVtdO3ZhciBncm91cD10cmVlLnJvb3Q7dmFyIHJvd0dyb3VwSWQ9W2dyb3VwLnZhbHVlcyxbXV07dmFyIHRpdGxlPWdyb3VwLmxhYmVsc1tncm91cC5sYWJlbHMubGVuZ3RoLTFdfHxfdCgnVG90YWwnKTt2YXIgaW5kZW50PWdyb3VwLmxhYmVscy5sZW5ndGg7dmFyIGlzTGVhZj1fLmlzRW1wdHkodHJlZS5kaXJlY3RTdWJUcmVlcyk7dmFyIHN1Ykdyb3VwTWVhc3VyZW1lbnRzPWNvbHVtbnMubWFwKGZ1bmN0aW9uKGNvbHVtbil7dmFyIGNvbEdyb3VwSWQ9Y29sdW1uLmdyb3VwSWQ7dmFyIGdyb3VwSW50ZXJzZWN0aW9uSWQ9W3Jvd0dyb3VwSWRbMF0sY29sR3JvdXBJZFsxXV07dmFyIG1lYXN1cmU9Y29sdW1uLm1lYXN1cmU7dmFyIG9yaWdpbkluZGV4ZXM9Y29sdW1uLm9yaWdpbkluZGV4ZXN8fFswXTt2YXIgdmFsdWU9c2VsZi5fZ2V0Q2VsbFZhbHVlKGdyb3VwSW50ZXJzZWN0aW9uSWQsbWVhc3VyZSxvcmlnaW5JbmRleGVzKTt2YXIgbWVhc3VyZW1lbnQ9e2dyb3VwSWQ6Z3JvdXBJbnRlcnNlY3Rpb25JZCxvcmlnaW5JbmRleGVzOm9yaWdpbkluZGV4ZXMsbWVhc3VyZTptZWFzdXJlLHZhbHVlOnZhbHVlLGlzQm9sZDohZ3JvdXBJbnRlcnNlY3Rpb25JZFswXS5sZW5ndGh8fCFncm91cEludGVyc2VjdGlvbklkWzFdLmxlbmd0aCx9O3JldHVybiBtZWFzdXJlbWVudDt9KTtyb3dzLnB1c2goe3RpdGxlOnRpdGxlLGdyb3VwSWQ6cm93R3JvdXBJZCxpbmRlbnQ6aW5kZW50LGlzTGVhZjppc0xlYWYsc3ViR3JvdXBNZWFzdXJlbWVudHM6c3ViR3JvdXBNZWFzdXJlbWVudHN9KTt2YXIgc3ViVHJlZUtleXM9dHJlZS5zb3J0ZWRLZXlzfHxPYmplY3Qua2V5cyh0cmVlLmRpcmVjdFN1YlRyZWVzKTtzdWJUcmVlS2V5cy5mb3JFYWNoKGZ1bmN0aW9uKHN1YlRyZWVLZXkpe3ZhciBzdWJUcmVlPXRyZWUuZGlyZWN0U3ViVHJlZXNbc3ViVHJlZUtleV07cm93cz1yb3dzLmNvbmNhdChzZWxmLl9nZXRUYWJsZVJvd3Moc3ViVHJlZSxjb2x1bW5zKSk7fSk7cmV0dXJuIHJvd3M7fSxfZ2V0VHJlZUhlaWdodDpmdW5jdGlvbih0cmVlKXt2YXIgc3ViVHJlZUhlaWdodHM9Xy52YWx1ZXModHJlZS5kaXJlY3RTdWJUcmVlcykubWFwKHRoaXMuX2dldFRyZWVIZWlnaHQuYmluZCh0aGlzKSk7cmV0dXJuIE1hdGgubWF4KDAsTWF0aC5tYXguYXBwbHkobnVsbCxzdWJUcmVlSGVpZ2h0cykpKzE7fSxfaGFzRGF0YTpmdW5jdGlvbigpe3JldHVybih0aGlzLmNvdW50c1tKU09OLnN0cmluZ2lmeShbW10sW11dKV18fFtdKS5zb21lKGZ1bmN0aW9uKGNvdW50KXtyZXR1cm4gY291bnQ+MDt9KTt9LF9sb2FkRGF0YTpmdW5jdGlvbigpe3ZhciBzZWxmPXRoaXM7dGhpcy5yb3dHcm91cFRyZWU9e3Jvb3Q6e2xhYmVsczpbXSx2YWx1ZXM6W119LGRpcmVjdFN1YlRyZWVzOnt9fTt0aGlzLmNvbEdyb3VwVHJlZT17cm9vdDp7bGFiZWxzOltdLHZhbHVlczpbXX0sZGlyZWN0U3ViVHJlZXM6e319O3RoaXMubWVhc3VyZW1lbnRzPXt9O3RoaXMuY291bnRzPXt9O3ZhciBrZXk9SlNPTi5zdHJpbmdpZnkoW1tdLFtdXSk7dGhpcy5ncm91cERvbWFpbnM9e307dGhpcy5ncm91cERvbWFpbnNba2V5XT10aGlzLmRhdGEuZG9tYWlucy5zbGljZSgwKTt2YXIgZ3JvdXA9e3Jvd1ZhbHVlczpbXSxjb2xWYWx1ZXM6W119O3ZhciBncm91cEJ5cz10aGlzLl9nZXRHcm91cEJ5cygpO3ZhciBsZWZ0RGl2aXNvcnM9c2VjdGlvbnMoZ3JvdXBCeXMucm93R3JvdXBCeXMpO3ZhciByaWdodERpdmlzb3JzPXNlY3Rpb25zKGdyb3VwQnlzLmNvbEdyb3VwQnlzKTt2YXIgZGl2aXNvcnM9Y2FydGVzaWFuKGxlZnREaXZpc29ycyxyaWdodERpdmlzb3JzKTtyZXR1cm4gdGhpcy5fc3ViZGl2aWRlR3JvdXAoZ3JvdXAsZGl2aXNvcnMuc2xpY2UoMCwxKSkudGhlbihmdW5jdGlvbigpe3JldHVybiBzZWxmLl9zdWJkaXZpZGVHcm91cChncm91cCxkaXZpc29ycy5zbGljZSgxKSk7fSk7fSxfcHJlcGFyZURhdGE6ZnVuY3Rpb24oZ3JvdXAsZ3JvdXBTdWJkaXZpc2lvbnMpe3ZhciBzZWxmPXRoaXM7dmFyIGdyb3VwUm93VmFsdWVzPWdyb3VwLnJvd1ZhbHVlczt2YXIgZ3JvdXBSb3dMYWJlbHM9W107dmFyIHJvd1N1YlRyZWU9dGhpcy5yb3dHcm91cFRyZWU7dmFyIHJvb3Q7aWYoZ3JvdXBSb3dWYWx1ZXMubGVuZ3RoKXtyb3dTdWJUcmVlPXRoaXMuX2ZpbmRHcm91cCh0aGlzLnJvd0dyb3VwVHJlZSxncm91cFJvd1ZhbHVlcyk7cm9vdD1yb3dTdWJUcmVlLnJvb3Q7Z3JvdXBSb3dMYWJlbHM9cm9vdC5sYWJlbHM7fQp2YXIgZ3JvdXBDb2xWYWx1ZXM9Z3JvdXAuY29sVmFsdWVzO3ZhciBncm91cENvbExhYmVscz1bXTtpZihncm91cENvbFZhbHVlcy5sZW5ndGgpe3Jvb3Q9dGhpcy5fZmluZEdyb3VwKHRoaXMuY29sR3JvdXBUcmVlLGdyb3VwQ29sVmFsdWVzKS5yb290O2dyb3VwQ29sTGFiZWxzPXJvb3QubGFiZWxzO30KZ3JvdXBTdWJkaXZpc2lvbnMuZm9yRWFjaChmdW5jdGlvbihncm91cFN1YmRpdmlzaW9uKXtncm91cFN1YmRpdmlzaW9uLnN1Ykdyb3Vwcy5mb3JFYWNoKGZ1bmN0aW9uKHN1Ykdyb3VwKXt2YXIgcm93VmFsdWVzPWdyb3VwUm93VmFsdWVzLmNvbmNhdChzZWxmLl9nZXRHcm91cFZhbHVlcyhzdWJHcm91cCxncm91cFN1YmRpdmlzaW9uLnJvd0dyb3VwQnkpKTt2YXIgcm93TGFiZWxzPWdyb3VwUm93TGFiZWxzLmNvbmNhdChzZWxmLl9nZXRHcm91cExhYmVscyhzdWJHcm91cCxncm91cFN1YmRpdmlzaW9uLnJvd0dyb3VwQnkpKTt2YXIgY29sVmFsdWVzPWdyb3VwQ29sVmFsdWVzLmNvbmNhdChzZWxmLl9nZXRHcm91cFZhbHVlcyhzdWJHcm91cCxncm91cFN1YmRpdmlzaW9uLmNvbEdyb3VwQnkpKTt2YXIgY29sTGFiZWxzPWdyb3VwQ29sTGFiZWxzLmNvbmNhdChzZWxmLl9nZXRHcm91cExhYmVscyhzdWJHcm91cCxncm91cFN1YmRpdmlzaW9uLmNvbEdyb3VwQnkpKTtpZighY29sVmFsdWVzLmxlbmd0aCYmcm93VmFsdWVzLmxlbmd0aCl7c2VsZi5fYWRkR3JvdXAoc2VsZi5yb3dHcm91cFRyZWUscm93TGFiZWxzLHJvd1ZhbHVlcyk7fQppZihjb2xWYWx1ZXMubGVuZ3RoJiYhcm93VmFsdWVzLmxlbmd0aCl7c2VsZi5fYWRkR3JvdXAoc2VsZi5jb2xHcm91cFRyZWUsY29sTGFiZWxzLGNvbFZhbHVlcyk7fQp2YXIga2V5PUpTT04uc3RyaW5naWZ5KFtyb3dWYWx1ZXMsY29sVmFsdWVzXSk7dmFyIG9yaWdpbkluZGV4PWdyb3VwU3ViZGl2aXNpb24uZ3JvdXAub3JpZ2luSW5kZXg7aWYoIShrZXkgaW4gc2VsZi5tZWFzdXJlbWVudHMpKXtzZWxmLm1lYXN1cmVtZW50c1trZXldPXNlbGYuZGF0YS5vcmlnaW5zLm1hcChmdW5jdGlvbigpe3JldHVybiBzZWxmLl9nZXRNZWFzdXJlbWVudHMoe30pO30pO30Kc2VsZi5tZWFzdXJlbWVudHNba2V5XVtvcmlnaW5JbmRleF09c2VsZi5fZ2V0TWVhc3VyZW1lbnRzKHN1Ykdyb3VwKTtpZighKGtleSBpbiBzZWxmLmNvdW50cykpe3NlbGYuY291bnRzW2tleV09c2VsZi5kYXRhLm9yaWdpbnMubWFwKGZ1bmN0aW9uKCl7cmV0dXJuIDA7fSk7fQpzZWxmLmNvdW50c1trZXldW29yaWdpbkluZGV4XT1zdWJHcm91cC5fX2NvdW50O2lmKCEoa2V5IGluIHNlbGYuZ3JvdXBEb21haW5zKSl7c2VsZi5ncm91cERvbWFpbnNba2V5XT1zZWxmLmRhdGEub3JpZ2lucy5tYXAoZnVuY3Rpb24oKXtyZXR1cm5bWzAsJz0nLDFdXTt9KTt9CmlmKHN1Ykdyb3VwLl9fZG9tYWluKXtzZWxmLmdyb3VwRG9tYWluc1trZXldW29yaWdpbkluZGV4XT1zdWJHcm91cC5fX2RvbWFpbjt9fSk7fSk7aWYodGhpcy5kYXRhLnNvcnRlZENvbHVtbil7dGhpcy5zb3J0Um93cyh0aGlzLmRhdGEuc29ydGVkQ29sdW1uLHJvd1N1YlRyZWUpO319LF9wcm9jZXNzTWVhc3VyZXM6ZnVuY3Rpb24obWVhc3VyZXMpe2lmKG1lYXN1cmVzKXtyZXR1cm4gXy5tYXAobWVhc3VyZXMsZnVuY3Rpb24obWVhc3VyZSl7cmV0dXJuIG1lYXN1cmU9PT0nX19jb3VudF9fJz8nX19jb3VudCc6bWVhc3VyZTt9KTt9fSxfcHJ1bmVUcmVlOmZ1bmN0aW9uKHRyZWUsb2xkVHJlZSl7aWYoXy5pc0VtcHR5KG9sZFRyZWUuZGlyZWN0U3ViVHJlZXMpKXt0cmVlLmRpcmVjdFN1YlRyZWVzPXt9O2RlbGV0ZSB0cmVlLnNvcnRlZEtleXM7cmV0dXJuO30KdmFyIHNlbGY9dGhpcztPYmplY3Qua2V5cyh0cmVlLmRpcmVjdFN1YlRyZWVzKS5mb3JFYWNoKGZ1bmN0aW9uKHN1YlRyZWVLZXkpe3ZhciBpbmRleD1PYmplY3Qua2V5cyhvbGRUcmVlLmRpcmVjdFN1YlRyZWVzKS5pbmRleE9mKHN1YlRyZWVLZXkpO3ZhciBzdWJUcmVlPXRyZWUuZGlyZWN0U3ViVHJlZXNbc3ViVHJlZUtleV07aWYoaW5kZXg9PT0tMSl7c3ViVHJlZS5kaXJlY3RTdWJUcmVlcz17fTtkZWxldGUgc3ViVHJlZUtleS5zb3J0ZWRLZXlzO31lbHNle3ZhciBvbGRTdWJUcmVlPW9sZFRyZWUuZGlyZWN0U3ViVHJlZXNbc3ViVHJlZUtleV07c2VsZi5fcHJ1bmVUcmVlKHN1YlRyZWUsb2xkU3ViVHJlZSk7fX0pO30sX3Nhbml0aXplTGFiZWw6ZnVuY3Rpb24odmFsdWUsZ3JvdXBCeSl7dmFyIGZpZWxkTmFtZT1ncm91cEJ5LnNwbGl0KCc6JylbMF07aWYodmFsdWU9PT1mYWxzZSl7cmV0dXJuIF90KCJVbmRlZmluZWQiKTt9CmlmKHZhbHVlIGluc3RhbmNlb2YgQXJyYXkpe3JldHVybiB0aGlzLl9nZXROdW1iZXJlZExhYmVsKHZhbHVlLGZpZWxkTmFtZSk7fQppZihmaWVsZE5hbWUmJnRoaXMuZmllbGRzW2ZpZWxkTmFtZV0mJih0aGlzLmZpZWxkc1tmaWVsZE5hbWVdLnR5cGU9PT0nc2VsZWN0aW9uJykpe3ZhciBzZWxlY3RlZD1fLndoZXJlKHRoaXMuZmllbGRzW2ZpZWxkTmFtZV0uc2VsZWN0aW9uLHswOnZhbHVlfSlbMF07cmV0dXJuIHNlbGVjdGVkP3NlbGVjdGVkWzFdOnZhbHVlO30KcmV0dXJuIHZhbHVlO30sX3Nhbml0aXplVmFsdWU6ZnVuY3Rpb24odmFsdWUpe2lmKHZhbHVlIGluc3RhbmNlb2YgQXJyYXkpe3JldHVybiB2YWx1ZVswXTt9CnJldHVybiB2YWx1ZTt9LF9zdWJkaXZpZGVHcm91cDpmdW5jdGlvbihncm91cCxkaXZpc29ycyl7dmFyIHNlbGY9dGhpczt2YXIga2V5PUpTT04uc3RyaW5naWZ5KFtncm91cC5yb3dWYWx1ZXMsZ3JvdXAuY29sVmFsdWVzXSk7dmFyIHByb21zPXRoaXMuZGF0YS5vcmlnaW5zLnJlZHVjZShmdW5jdGlvbihhY2Msb3JpZ2luLG9yaWdpbkluZGV4KXtpZighc2VsZi5jb3VudHNba2V5XXx8c2VsZi5jb3VudHNba2V5XVtvcmlnaW5JbmRleF0+MCl7dmFyIHN1Ykdyb3VwPXtyb3dWYWx1ZXM6Z3JvdXAucm93VmFsdWVzLGNvbFZhbHVlczpncm91cC5jb2xWYWx1ZXMsb3JpZ2luSW5kZXg6b3JpZ2luSW5kZXh9O2Rpdmlzb3JzLmZvckVhY2goZnVuY3Rpb24oZGl2aXNvcil7YWNjLnB1c2goc2VsZi5fZ2V0R3JvdXBTdWJkaXZpc2lvbihzdWJHcm91cCxkaXZpc29yWzBdLGRpdmlzb3JbMV0pKTt9KTt9CnJldHVybiBhY2M7fSxbXSk7cmV0dXJuIHRoaXMuX2xvYWREYXRhRHJvcFByZXZpb3VzLmFkZChQcm9taXNlLmFsbChwcm9tcykpLnRoZW4oZnVuY3Rpb24oZ3JvdXBTdWJkaXZpc2lvbnMpe2lmKGdyb3VwU3ViZGl2aXNpb25zLmxlbmd0aCl7c2VsZi5fcHJlcGFyZURhdGEoZ3JvdXAsZ3JvdXBTdWJkaXZpc2lvbnMpO319KTt9LF9zb3J0VHJlZTpmdW5jdGlvbihzb3J0RnVuY3Rpb24sdHJlZSl7dmFyIHNlbGY9dGhpczt0cmVlLnNvcnRlZEtleXM9Xy5zb3J0QnkoT2JqZWN0LmtleXModHJlZS5kaXJlY3RTdWJUcmVlcyksc29ydEZ1bmN0aW9uKHRyZWUpKTtfLnZhbHVlcyh0cmVlLmRpcmVjdFN1YlRyZWVzKS5mb3JFYWNoKGZ1bmN0aW9uKHN1YlRyZWUpe3NlbGYuX3NvcnRUcmVlKHNvcnRGdW5jdGlvbixzdWJUcmVlKTt9KTt9LH0pO3JldHVybiBQaXZvdE1vZGVsO30pOzsKCi8qIC93ZWIvc3RhdGljL3NyYy9qcy92aWV3cy9waXZvdC9waXZvdF9jb250cm9sbGVyLmpzIGRlZmluZWQgaW4gYnVuZGxlICd3ZWIuYXNzZXRzX2JhY2tlbmQnICovCm9kb28uZGVmaW5lKCd3ZWIuUGl2b3RDb250cm9sbGVyJyxmdW5jdGlvbihyZXF1aXJlKXsidXNlIHN0cmljdCI7dmFyIEFic3RyYWN0Q29udHJvbGxlcj1yZXF1aXJlKCd3ZWIuQWJzdHJhY3RDb250cm9sbGVyJyk7dmFyIGNvcmU9cmVxdWlyZSgnd2ViLmNvcmUnKTt2YXIgZnJhbWV3b3JrPXJlcXVpcmUoJ3dlYi5mcmFtZXdvcmsnKTt2YXIgc2Vzc2lvbj1yZXF1aXJlKCd3ZWIuc2Vzc2lvbicpO3ZhciBfdD1jb3JlLl90O3ZhciBRV2ViPWNvcmUucXdlYjt2YXIgUGl2b3RDb250cm9sbGVyPUFic3RyYWN0Q29udHJvbGxlci5leHRlbmQoe2NvbnRlbnRUZW1wbGF0ZTonUGl2b3RWaWV3JyxldmVudHM6eydjbGljayAub19waXZvdF9maWVsZF9tZW51IGEnOidfb25Hcm91cEJ5TWVudVNlbGVjdGlvbicsJ2NsaWNrIC5vX3Bpdm90X2hlYWRlcl9jZWxsX2Nsb3NlZCc6J19vbkNsb3NlZEhlYWRlckNsaWNrJyx9LGN1c3RvbV9ldmVudHM6Xy5leHRlbmQoe30sQWJzdHJhY3RDb250cm9sbGVyLnByb3RvdHlwZS5jdXN0b21fZXZlbnRzLHtjbG9zZV9ncm91cDonX29uQ2xvc2VHcm91cCcsb3Blbl92aWV3Oidfb25PcGVuVmlldycsc29ydF9yb3dzOidfb25Tb3J0Um93cycsfSksaW5pdDpmdW5jdGlvbihwYXJlbnQsbW9kZWwscmVuZGVyZXIscGFyYW1zKXt0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy5tZWFzdXJlcz1wYXJhbXMubWVhc3VyZXM7dGhpcy5ncm91cGFibGVGaWVsZHM9cGFyYW1zLmdyb3VwYWJsZUZpZWxkczt0aGlzLnRpdGxlPXBhcmFtcy50aXRsZTt0aGlzLnZpZXdzPXBhcmFtcy52aWV3czt0aGlzLmdyb3VwU2VsZWN0ZWQ9bnVsbDt9LHN0YXJ0OmZ1bmN0aW9uKCl7dGhpcy4kZ3JvdXBCeVNlbGVjdGlvbj10aGlzLiQoJy5vX2ZpZWxkX3NlbGVjdGlvbicpO2NvcmUuYnVzLm9uKCdjbGljaycsdGhpcyxmdW5jdGlvbigpe3RoaXMuJGdyb3VwQnlTZWxlY3Rpb24uZW1wdHkoKTt9KTtyZXR1cm4gdGhpcy5fc3VwZXIoKTt9LGRlc3Ryb3k6ZnVuY3Rpb24oKXtpZih0aGlzLiRidXR0b25zKXt0aGlzLiRidXR0b25zLmZpbmQoJ2J1dHRvbicpLm9mZigpO30KcmV0dXJuIHRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9LGdldE93bmVkUXVlcnlQYXJhbXM6ZnVuY3Rpb24oKXt2YXIgc3RhdGU9dGhpcy5tb2RlbC5nZXQoe3Jhdzp0cnVlfSk7cmV0dXJue2NvbnRleHQ6e3Bpdm90X21lYXN1cmVzOnN0YXRlLm1lYXN1cmVzLHBpdm90X2NvbHVtbl9ncm91cGJ5OnN0YXRlLmNvbEdyb3VwQnlzLHBpdm90X3Jvd19ncm91cGJ5OnN0YXRlLnJvd0dyb3VwQnlzLH19O30scmVuZGVyQnV0dG9uczpmdW5jdGlvbigkbm9kZSl7aWYoJG5vZGUpe3ZhciBjb250ZXh0PXttZWFzdXJlczpfLnNvcnRCeShfLnBhaXJzKF8ub21pdCh0aGlzLm1lYXN1cmVzLCdfX2NvdW50JykpLGZ1bmN0aW9uKHgpe3JldHVybiB4WzFdLnN0cmluZy50b0xvd2VyQ2FzZSgpO30pLH07dGhpcy4kYnV0dG9ucz0kKFFXZWIucmVuZGVyKCdQaXZvdFZpZXcuYnV0dG9ucycsY29udGV4dCkpO3RoaXMuJGJ1dHRvbnMuY2xpY2sodGhpcy5fb25CdXR0b25DbGljay5iaW5kKHRoaXMpKTt0aGlzLiRidXR0b25zLmZpbmQoJ2J1dHRvbicpLnRvb2x0aXAoKTt0aGlzLiRidXR0b25zLmFwcGVuZFRvKCRub2RlKTt0aGlzLl91cGRhdGVCdXR0b25zKCk7fX0sX2Rvd25sb2FkVGFibGU6ZnVuY3Rpb24oKXt2YXIgc2VsZj10aGlzO2lmKHNlbGYubW9kZWwuZ2V0VGFibGVXaWR0aCgpPjI1Nil7dGhpcy5jYWxsKCdjcmFzaF9tYW5hZ2VyJywnc2hvd19tZXNzYWdlJyxfdCgiRm9yIEV4Y2VsIGNvbXBhdGliaWxpdHksIGRhdGEgY2Fubm90IGJlIGV4cG9ydGVkIGlmIHRoZXJlIGFyZSBtb3JlIHRoYW4gMjU2IGNvbHVtbnMuXG5cblRpcDogdHJ5IHRvIGZsaXAgYXhpcywgZmlsdGVyIGZ1cnRoZXIgb3IgcmVkdWNlIHRoZSBudW1iZXIgb2YgbWVhc3VyZXMuIikpO2ZyYW1ld29yay51bmJsb2NrVUkoKTtyZXR1cm47fQp2YXIgdGFibGU9c2VsZi5tb2RlbC5leHBvcnREYXRhKCk7dGFibGUudGl0bGU9c2VsZi50aXRsZTtzZXNzaW9uLmdldF9maWxlKHt1cmw6Jy93ZWIvcGl2b3QvZXhwb3J0X3hscycsZGF0YTp7ZGF0YTpKU09OLnN0cmluZ2lmeSh0YWJsZSl9LGNvbXBsZXRlOmZyYW1ld29yay51bmJsb2NrVUksZXJyb3I6KGVycm9yKT0+dGhpcy5jYWxsKCdjcmFzaF9tYW5hZ2VyJywncnBjX2Vycm9yJyxlcnJvciksfSk7fSxfcmVuZGVyR3JvdXBCeVNlbGVjdGlvbjpmdW5jdGlvbih0b3AsbGVmdCl7dmFyIHN0YXRlPXRoaXMubW9kZWwuZ2V0KHtyYXc6dHJ1ZX0pO3ZhciBncm91cGVkRmllbGRzPXN0YXRlLnJvd0dyb3VwQnlzLmNvbmNhdChzdGF0ZS5jb2xHcm91cEJ5cykubWFwKGZ1bmN0aW9uKGYpe3JldHVybiBmLnNwbGl0KCc6JylbMF07fSk7dmFyIGZpZWxkcz1fLmNoYWluKHRoaXMuZ3JvdXBhYmxlRmllbGRzKS5wYWlycygpLnNvcnRCeShmdW5jdGlvbihmKXtyZXR1cm4gZlsxXS5zdHJpbmc7fSkubWFwKGZ1bmN0aW9uKGYpe3JldHVybltmWzBdLGZbMV0sXy5jb250YWlucyhncm91cGVkRmllbGRzLGZbMF0pXTt9KS52YWx1ZSgpO3RoaXMuJGdyb3VwQnlTZWxlY3Rpb24uaHRtbChRV2ViLnJlbmRlcignUGl2b3RWaWV3Lkdyb3VwQnlTZWxlY3Rpb24nLHtmaWVsZHM6ZmllbGRzfSkpO3ZhciBjc3NQcm9wcz17dG9wOnRvcH07dmFyIGlzUlRMPV90LmRhdGFiYXNlLnBhcmFtZXRlcnMuZGlyZWN0aW9uPT09J3J0bCc7Y3NzUHJvcHNbaXNSVEw/J3JpZ2h0JzonbGVmdCddPWlzUlRMP3RoaXMuJGVsLndpZHRoKCktbGVmdDpsZWZ0O3RoaXMuJGdyb3VwQnlTZWxlY3Rpb24uZmluZCgnLmRyb3Bkb3duLW1lbnUnKS5maXJzdCgpLmNzcyhjc3NQcm9wcykuYWRkQ2xhc3MoJ3Nob3cnKTt9LF9zdGFydFJlbmRlcmVyOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucmVuZGVyZXIuYXBwZW5kVG8odGhpcy4kKCcub19waXZvdCcpKTt9LF91cGRhdGU6ZnVuY3Rpb24oKXt0aGlzLl91cGRhdGVCdXR0b25zKCk7cmV0dXJuIHRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9LF91cGRhdGVCdXR0b25zOmZ1bmN0aW9uKCl7aWYoIXRoaXMuJGJ1dHRvbnMpe3JldHVybjt9CnZhciBzZWxmPXRoaXM7dmFyIHN0YXRlPXRoaXMubW9kZWwuZ2V0KHtyYXc6dHJ1ZX0pO18uZWFjaCh0aGlzLm1lYXN1cmVzLGZ1bmN0aW9uKG1lYXN1cmUsbmFtZSl7dmFyIGlzU2VsZWN0ZWQ9Xy5jb250YWlucyhzdGF0ZS5tZWFzdXJlcyxuYW1lKTtzZWxmLiRidXR0b25zLmZpbmQoJy5kcm9wZG93bi1pdGVtW2RhdGEtZmllbGQ9IicrbmFtZSsnIl0nKS50b2dnbGVDbGFzcygnc2VsZWN0ZWQnLGlzU2VsZWN0ZWQpO30pO3ZhciBub0RhdGFEaXNwbGF5ZWQ9IXN0YXRlLmhhc0RhdGF8fCFzdGF0ZS5tZWFzdXJlcy5sZW5ndGg7dGhpcy4kYnV0dG9ucy5maW5kKCcub19waXZvdF9mbGlwX2J1dHRvbicpLnByb3AoJ2Rpc2FibGVkJyxub0RhdGFEaXNwbGF5ZWQpO3RoaXMuJGJ1dHRvbnMuZmluZCgnLm9fcGl2b3RfZXhwYW5kX2J1dHRvbicpLnByb3AoJ2Rpc2FibGVkJyxub0RhdGFEaXNwbGF5ZWQpO3RoaXMuJGJ1dHRvbnMuZmluZCgnLm9fcGl2b3RfZG93bmxvYWQnKS5wcm9wKCdkaXNhYmxlZCcsbm9EYXRhRGlzcGxheWVkKTt9LF9vbkJ1dHRvbkNsaWNrOmZ1bmN0aW9uKGV2KXt2YXIgJHRhcmdldD0kKGV2LnRhcmdldCk7aWYoJHRhcmdldC5oYXNDbGFzcygnb19waXZvdF9mbGlwX2J1dHRvbicpKXt0aGlzLm1vZGVsLmZsaXAoKTt0aGlzLnVwZGF0ZSh7fSx7cmVsb2FkOmZhbHNlfSk7fQppZigkdGFyZ2V0Lmhhc0NsYXNzKCdvX3Bpdm90X2V4cGFuZF9idXR0b24nKSl7dGhpcy5tb2RlbC5leHBhbmRBbGwoKS50aGVuKHRoaXMudXBkYXRlLmJpbmQodGhpcyx7fSx7cmVsb2FkOmZhbHNlfSkpO30KaWYoJHRhcmdldC5wYXJlbnRzKCcub19waXZvdF9tZWFzdXJlc19saXN0JykubGVuZ3RoKXtldi5wcmV2ZW50RGVmYXVsdCgpO2V2LnN0b3BQcm9wYWdhdGlvbigpO3ZhciBmaWVsZD0kdGFyZ2V0LmRhdGEoJ2ZpZWxkJyk7dGhpcy5tb2RlbC50b2dnbGVNZWFzdXJlKGZpZWxkKS50aGVuKHRoaXMudXBkYXRlLmJpbmQodGhpcyx7fSx7cmVsb2FkOmZhbHNlfSkpO30KaWYoJHRhcmdldC5oYXNDbGFzcygnb19waXZvdF9kb3dubG9hZCcpKXt0aGlzLl9kb3dubG9hZFRhYmxlKCk7fX0sX29uQ2xvc2VHcm91cDpmdW5jdGlvbihldil7dGhpcy5tb2RlbC5jbG9zZUdyb3VwKGV2LmRhdGEuZ3JvdXBJZCxldi5kYXRhLnR5cGUpO3RoaXMudXBkYXRlKHt9LHtyZWxvYWQ6ZmFsc2V9KTt9LF9vbkNsb3NlZEhlYWRlckNsaWNrOmZ1bmN0aW9uKGV2KXtldi5wcmV2ZW50RGVmYXVsdCgpO2V2LnN0b3BQcm9wYWdhdGlvbigpO3ZhciAkdGFyZ2V0PSQoZXYudGFyZ2V0KTt2YXIgZ3JvdXBJZD0kdGFyZ2V0LmRhdGEoJ2dyb3VwSWQnKTt2YXIgdHlwZT0kdGFyZ2V0LmRhdGEoJ3R5cGUnKTt2YXIgZ3JvdXA9e3Jvd1ZhbHVlczpncm91cElkWzBdLGNvbFZhbHVlczpncm91cElkWzFdLHR5cGU6dHlwZX07dmFyIHN0YXRlPXRoaXMubW9kZWwuZ2V0KHtyYXc6dHJ1ZX0pO3ZhciBncm91cFZhbHVlcz10eXBlPT09J3Jvdyc/Z3JvdXBJZFswXTpncm91cElkWzFdO3ZhciBncm91cEJ5cz10eXBlPT09J3Jvdyc/c3RhdGUucm93R3JvdXBCeXM6c3RhdGUuY29sR3JvdXBCeXM7dGhpcy5zZWxlY3RlZEdyb3VwPWdyb3VwO2lmKGdyb3VwVmFsdWVzLmxlbmd0aDxncm91cEJ5cy5sZW5ndGgpe3ZhciBncm91cEJ5PWdyb3VwQnlzW2dyb3VwVmFsdWVzLmxlbmd0aF07dGhpcy5tb2RlbC5leHBhbmRHcm91cCh0aGlzLnNlbGVjdGVkR3JvdXAsZ3JvdXBCeSkudGhlbih0aGlzLnVwZGF0ZS5iaW5kKHRoaXMse30se3JlbG9hZDpmYWxzZX0pKTt9ZWxzZXt2YXIgcG9zaXRpb249JHRhcmdldC5wb3NpdGlvbigpO3ZhciB0b3A9cG9zaXRpb24udG9wKyR0YXJnZXQuaGVpZ2h0KCk7dmFyIGxlZnQ9cG9zaXRpb24ubGVmdCtldi5vZmZzZXRYO3RoaXMuX3JlbmRlckdyb3VwQnlTZWxlY3Rpb24odG9wLGxlZnQpO319LF9vbkdyb3VwQnlNZW51U2VsZWN0aW9uOmZ1bmN0aW9uKGV2KXtldi5wcmV2ZW50RGVmYXVsdCgpO3ZhciAkdGFyZ2V0PSQoZXYudGFyZ2V0KTtpZigkdGFyZ2V0Lmhhc0NsYXNzKCdkaXNhYmxlZCcpKXtldi5zdG9wUHJvcGFnYXRpb24oKTtyZXR1cm47fQp2YXIgZ3JvdXBCeT0kdGFyZ2V0LmRhdGEoJ2ZpZWxkJyk7dmFyIGludGVydmFsPSR0YXJnZXQuZGF0YSgnaW50ZXJ2YWwnKTtpZihpbnRlcnZhbCl7Z3JvdXBCeT1ncm91cEJ5Kyc6JytpbnRlcnZhbDt9CnRoaXMubW9kZWwuYWRkR3JvdXBCeShncm91cEJ5LHRoaXMuc2VsZWN0ZWRHcm91cC50eXBlKTt0aGlzLm1vZGVsLmV4cGFuZEdyb3VwKHRoaXMuc2VsZWN0ZWRHcm91cCxncm91cEJ5KS50aGVuKHRoaXMudXBkYXRlLmJpbmQodGhpcyx7fSx7cmVsb2FkOmZhbHNlfSkpO30sX29uT3BlblZpZXc6ZnVuY3Rpb24oZXYpe2V2LnN0b3BQcm9wYWdhdGlvbigpO3ZhciBjb250ZXh0PWV2LmRhdGEuY29udGV4dDt2YXIgZ3JvdXA9ZXYuZGF0YS5ncm91cDt2YXIgZG9tYWluPXRoaXMubW9kZWwuX2dldEdyb3VwRG9tYWluKGdyb3VwKTt0aGlzLmRvX2FjdGlvbih7dHlwZTonaXIuYWN0aW9ucy5hY3Rfd2luZG93JyxuYW1lOnRoaXMudGl0bGUscmVzX21vZGVsOnRoaXMubW9kZWxOYW1lLHZpZXdzOnRoaXMudmlld3Msdmlld19tb2RlOidsaXN0Jyx0YXJnZXQ6J2N1cnJlbnQnLGNvbnRleHQ6Y29udGV4dCxkb21haW46ZG9tYWluLH0pO30sX29uU29ydFJvd3M6ZnVuY3Rpb24oZXYpe3RoaXMubW9kZWwuc29ydFJvd3MoZXYuZGF0YS5zb3J0ZWRDb2x1bW4pO3RoaXMudXBkYXRlKHt9LHtyZWxvYWQ6ZmFsc2V9KTt9LH0pO3JldHVybiBQaXZvdENvbnRyb2xsZXI7fSk7OwoKLyogL3dlYi9zdGF0aWMvc3JjL2pzL3ZpZXdzL3Bpdm90L3Bpdm90X3JlbmRlcmVyLmpzIGRlZmluZWQgaW4gYnVuZGxlICd3ZWIuYXNzZXRzX2JhY2tlbmQnICovCm9kb28uZGVmaW5lKCd3ZWIuUGl2b3RSZW5kZXJlcicsZnVuY3Rpb24ocmVxdWlyZSl7InVzZSBzdHJpY3QiO3ZhciBBYnN0cmFjdFJlbmRlcmVyPXJlcXVpcmUoJ3dlYi5BYnN0cmFjdFJlbmRlcmVyJyk7dmFyIGNvbmZpZz1yZXF1aXJlKCd3ZWIuY29uZmlnJyk7dmFyIGNvcmU9cmVxdWlyZSgnd2ViLmNvcmUnKTt2YXIgZGF0YUNvbXBhcmlzb25VdGlscz1yZXF1aXJlKCd3ZWIuZGF0YUNvbXBhcmlzb25VdGlscycpO3ZhciBmaWVsZF91dGlscz1yZXF1aXJlKCd3ZWIuZmllbGRfdXRpbHMnKTt2YXIgUVdlYj1jb3JlLnF3ZWI7dmFyIF90PWNvcmUuX3Q7dmFyIFBpdm90UmVuZGVyZXI9QWJzdHJhY3RSZW5kZXJlci5leHRlbmQoe3RhZ05hbWU6J3RhYmxlJyxjbGFzc05hbWU6J3RhYmxlLWhvdmVyIHRhYmxlLXNtIHRhYmxlLWJvcmRlcmVkJyxldmVudHM6Xy5leHRlbmQoe30sQWJzdHJhY3RSZW5kZXJlci5wcm90b3R5cGUuZXZlbnRzLHsnY2xpY2sgdGQub19waXZvdF9jZWxsX3ZhbHVlJzonX29uQ2VsbFZhbHVlQ2xpY2tlZCcsJ2NsaWNrIC5vX3Bpdm90X2hlYWRlcl9jZWxsX29wZW5lZCc6J19vbk9wZW5IZWFkZXJDbGljaycsJ2NsaWNrIC5vX3Bpdm90X21lYXN1cmVfcm93JzonX29uU3BlY2lhbFJvd0NsaWNrJywnY2xpY2sgLm9fcGl2b3Rfb3JpZ2luX3Jvdyc6J19vblNwZWNpYWxSb3dDbGljaycsJ21vdXNlZW50ZXIgdGhlYWQgdHI6bGFzdCB0aCc6J19vbk1vdXNlZW50ZXJDZWxsJywnbW91c2VlbnRlciB0Ym9keSB0ZCc6J19vbk1vdXNlZW50ZXJDZWxsJywnbW91c2VsZWF2ZSB0aGVhZCB0cjpsYXN0IHRoJzonX29uTW91c2VsZWF2ZUNlbGwnLCdtb3VzZWxlYXZlIHRib2R5IHRkJzonX29uTW91c2VsZWF2ZUNlbGwnLH0pLGluaXQ6ZnVuY3Rpb24ocGFyZW50LHN0YXRlLHBhcmFtcyl7dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3RoaXMuZW5hYmxlTGlua2luZz1wYXJhbXMuZW5hYmxlTGlua2luZzt0aGlzLmZpZWxkV2lkZ2V0cz1wYXJhbXMud2lkZ2V0c3x8e307dGhpcy5wYWRkaW5nTGVmdEhlYWRlclRhYldpZHRoPWNvbmZpZy5kZXZpY2UuaXNNb2JpbGU/NTozMDt9LF9nZXRHcm91cEJ5TGFiZWxzOmZ1bmN0aW9uKGdyb3VwQnkpe3ZhciBzZWxmPXRoaXM7cmV0dXJuIF8ubWFwKGdyb3VwQnksZnVuY3Rpb24oZ2Ipe3JldHVybiBzZWxmLnN0YXRlLmZpZWxkc1tnYi5zcGxpdCgnOicpWzBdXS5zdHJpbmc7fSk7fSxfcmVuZGVyOmZ1bmN0aW9uKCl7dmFyIGhhc0NvbnRlbnQ9dGhpcy5zdGF0ZS5oYXNEYXRhJiZ0aGlzLnN0YXRlLm1lYXN1cmVzLmxlbmd0aDtpZighaGFzQ29udGVudCl7dGhpcy5fcmVwbGFjZUVsZW1lbnQoUVdlYi5yZW5kZXIoJ1ZpZXcuTm9Db250ZW50SGVscGVyJyx7ZGVzY3JpcHRpb246X3QoIlRyeSB0byBhZGQgc29tZSByZWNvcmRzLCBvciBtYWtlIHN1cmUgdGhhdCB0aGVyZSBpcyBhdCBsZWFzdCAiKyJvbmUgbWVhc3VyZSBhbmQgbm8gYWN0aXZlIGZpbHRlciBpbiB0aGUgc2VhcmNoIGJhci4iKSx9KSk7cmV0dXJuIHRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9CnRoaXMucmVuZGVyRWxlbWVudCgpO3RoaXMuJGVsLnRvZ2dsZUNsYXNzKCdvX2VuYWJsZV9saW5raW5nJyx0aGlzLmVuYWJsZUxpbmtpbmcpO3ZhciAkdGhlYWQ9JCgnPHRoZWFkPicpO3ZhciAkdGJvZHk9JCgnPHRib2R5PicpO3RoaXMuX3JlbmRlckhlYWRlcnMoJHRoZWFkKTt0aGlzLl9yZW5kZXJSb3dzKCR0Ym9keSk7dGhpcy4kZWwuZW1wdHkoKS5hcHBlbmQoJHRoZWFkKS5hcHBlbmQoJHRib2R5KTt0aGlzLiQoJy5vX3Bpdm90X2hlYWRlcl9jZWxsX29wZW5lZCwgLm9fcGl2b3RfaGVhZGVyX2NlbGxfY2xvc2VkJykudG9vbHRpcCgpO3JldHVybiB0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fSxfcmVuZGVySGVhZGVyczpmdW5jdGlvbigkdGhlYWQpe3ZhciBncm91cGJ5TGFiZWxzPXRoaXMuX2dldEdyb3VwQnlMYWJlbHModGhpcy5zdGF0ZS5jb2xHcm91cEJ5cyk7dGhpcy5zdGF0ZS50YWJsZS5oZWFkZXJzLmZvckVhY2goZnVuY3Rpb24ocm93LHJvd0luZGV4KXt2YXIgJHRyPSQoJzx0cj4nKTtyb3cuZm9yRWFjaChmdW5jdGlvbihjZWxsKXt2YXIgY2VsbFBhcmFtcz17dGV4dDpjZWxsLnRpdGxlLGNvbHNwYW46Y2VsbC53aWR0aCxyb3dzcGFuOmNlbGwuaGVpZ2h0LGRhdGE6e2dyb3VwSWQ6Y2VsbC5ncm91cElkLHR5cGU6J2NvbCcsfX0KdmFyIGNsYXNzTmFtZTtpZihjZWxsLm1lYXN1cmUpe2lmKGNlbGwub3JpZ2luSW5kZXhlcyl7Y2VsbFBhcmFtcy5kYXRhLm9yaWdpbkluZGV4ZXM9Y2VsbC5vcmlnaW5JbmRleGVzCmNsYXNzTmFtZT0nb19waXZvdF9vcmlnaW5fcm93Jzt9ZWxzZXtjbGFzc05hbWU9J29fcGl2b3RfbWVhc3VyZV9yb3cnO30KY2xhc3NOYW1lKz0nIHRleHQtbXV0ZWQnO2lmKGNlbGwub3JkZXIpe2NsYXNzTmFtZSs9JyBvX3Bpdm90X3NvcnRfb3JkZXJfJytjZWxsLm9yZGVyO2lmKGNlbGwub3JkZXI9PT0nYXNjJyl7Y2VsbFBhcmFtc1snYXJpYS1zb3J0ZWQnXT0nYXNjZW5kaW5nJ31lbHNle2NlbGxQYXJhbXNbJ2FyaWEtc29ydGVkJ109J2Rlc2NlbmRpbmcnfX0KY2VsbFBhcmFtcy5kYXRhLm1lYXN1cmU9Y2VsbC5tZWFzdXJlO31lbHNlIGlmKCdpc0xlYWYnaW4gY2VsbCl7aWYocm93SW5kZXg+MCl7Y2VsbFBhcmFtcy50aXRsZT1ncm91cGJ5TGFiZWxzW3Jvd0luZGV4LTFdO30KY2xhc3NOYW1lPSdvX3Bpdm90X2hlYWRlcl9jZWxsJysoY2VsbC5pc0xlYWY/J19jbG9zZWQnOidfb3BlbmVkJyk7fQpjZWxsUGFyYW1zLmNsYXNzPWNsYXNzTmFtZTskdHIuYXBwZW5kKCQoJzx0aD4nLGNlbGxQYXJhbXMpKTt9KTskdGhlYWQuYXBwZW5kKCR0cik7fSk7fSxfcmVuZGVyUm93czpmdW5jdGlvbigkdGJvZHkpe3ZhciBzZWxmPXRoaXM7dmFyIG1lYXN1cmVUeXBlcz10aGlzLnN0YXRlLm1lYXN1cmVzLnJlZHVjZShmdW5jdGlvbihhY2MsbWVhc3VyZU5hbWUpe3ZhciB0eXBlPXNlbGYuc3RhdGUuZmllbGRzW21lYXN1cmVOYW1lXS50eXBlO2FjY1ttZWFzdXJlTmFtZV09dHlwZT09PSdtYW55Mm9uZSc/J2ludGVnZXInOnR5cGU7cmV0dXJuIGFjYzt9LHt9KTt2YXIgZ3JvdXBieUxhYmVscz10aGlzLl9nZXRHcm91cEJ5TGFiZWxzKHRoaXMuc3RhdGUucm93R3JvdXBCeXMpO3RoaXMuc3RhdGUudGFibGUucm93cy5mb3JFYWNoKGZ1bmN0aW9uKHJvdyl7dmFyICR0cj0kKCc8dHI+Jyk7dmFyIHBhZGRpbmdMZWZ0PTUrcm93LmluZGVudCpzZWxmLnBhZGRpbmdMZWZ0SGVhZGVyVGFiV2lkdGg7JHRyLmFwcGVuZCgkKCc8dGg+Jyx7dGV4dDpyb3cudGl0bGUsdGl0bGU6cm93LmluZGVudD4wP2dyb3VwYnlMYWJlbHNbcm93LmluZGVudC0xXTpudWxsLGRhdGE6e2dyb3VwSWQ6cm93Lmdyb3VwSWQsdHlwZToncm93Jyx9LGNzczp7J3BhZGRpbmctbGVmdCc6cGFkZGluZ0xlZnQrJ3B4Jyx9LGNsYXNzOidvX3Bpdm90X2hlYWRlcl9jZWxsXycrKHJvdy5pc0xlYWY/J2Nsb3NlZCc6J29wZW5lZCcpLH0pKTtyb3cuc3ViR3JvdXBNZWFzdXJlbWVudHMuZm9yRWFjaChmdW5jdGlvbihtZWFzdXJlbWVudCl7dmFyIGNlbGxQYXJhbXM9e2RhdGE6e2dyb3VwSWQ6bWVhc3VyZW1lbnQuZ3JvdXBJZCxvcmlnaW5JbmRleGVzOm1lYXN1cmVtZW50Lm9yaWdpbkluZGV4ZXMsfSxjbGFzczonb19waXZvdF9jZWxsX3ZhbHVlIHRleHQtcmlnaHQnLH07aWYobWVhc3VyZW1lbnQuaXNCb2xkKXtjZWxsUGFyYW1zLmNzcz17J2ZvbnQtd2VpZ2h0JzonYm9sZCcsfTt9CmlmKG1lYXN1cmVtZW50LnZhbHVlIT09dW5kZWZpbmVkKXt2YXIgbWVhc3VyZT1tZWFzdXJlbWVudC5tZWFzdXJlO3ZhciBtZWFzdXJlRmllbGQ9c2VsZi5zdGF0ZS5maWVsZHNbbWVhc3VyZV07dmFyICR2YWx1ZTtpZihtZWFzdXJlbWVudC5vcmlnaW5JbmRleGVzLmxlbmd0aD4xKXskdmFsdWU9ZGF0YUNvbXBhcmlzb25VdGlscy5yZW5kZXJWYXJpYXRpb24obWVhc3VyZW1lbnQudmFsdWUsbWVhc3VyZUZpZWxkKTt9ZWxzZXt2YXIgZm9ybWF0VHlwZT1zZWxmLmZpZWxkV2lkZ2V0c1ttZWFzdXJlXXx8bWVhc3VyZVR5cGVzW21lYXN1cmVdO3ZhciBmb3JtYXR0ZXI9ZmllbGRfdXRpbHMuZm9ybWF0W2Zvcm1hdFR5cGVdOyR2YWx1ZT0kKCc8ZGl2Picse2NsYXNzOidvX3ZhbHVlJyxodG1sOmZvcm1hdHRlcihtZWFzdXJlbWVudC52YWx1ZSxtZWFzdXJlRmllbGQpLH0pO30KY2VsbFBhcmFtcy5odG1sPSR2YWx1ZTt9ZWxzZXtjZWxsUGFyYW1zLmNsYXNzKz0nIG9fZW1wdHknfQokdHIuYXBwZW5kKCQoJzx0ZD4nLGNlbGxQYXJhbXMpKTt9KTskdGJvZHkuYXBwZW5kKCR0cik7fSk7fSxfb25DZWxsVmFsdWVDbGlja2VkOmZ1bmN0aW9uKGV2KXtldi5wcmV2ZW50RGVmYXVsdCgpO2V2LnN0b3BQcm9wYWdhdGlvbigpO3ZhciAkdGFyZ2V0PSQoZXYuY3VycmVudFRhcmdldCk7aWYoJHRhcmdldC5oYXNDbGFzcygnb19lbXB0eScpfHwhdGhpcy5lbmFibGVMaW5raW5nKXtyZXR1cm47fQp2YXIgY29udGV4dD1fLm9taXQodGhpcy5zdGF0ZS5jb250ZXh0LGZ1bmN0aW9uKHZhbCxrZXkpe3JldHVybiBrZXk9PT0nZ3JvdXBfYnknfHxfLnN0ci5zdGFydHNXaXRoKGtleSwnc2VhcmNoX2RlZmF1bHRfJyk7fSk7dmFyIGdyb3VwSWQ9JHRhcmdldC5kYXRhKCdncm91cElkJyk7dmFyIG9yaWdpbkluZGV4ZXM9JHRhcmdldC5kYXRhKCdvcmlnaW5JbmRleGVzJyk7dmFyIGdyb3VwPXtyb3dWYWx1ZXM6Z3JvdXBJZFswXSxjb2xWYWx1ZXM6Z3JvdXBJZFsxXSxvcmlnaW5JbmRleDpvcmlnaW5JbmRleGVzWzBdfTt0aGlzLnRyaWdnZXJfdXAoJ29wZW5fdmlldycse2dyb3VwOmdyb3VwLGNvbnRleHQ6Y29udGV4dCx9KTt9LF9vbk1vdXNlZW50ZXJDZWxsOmZ1bmN0aW9uKGV2KXt2YXIgaW5kZXg9JChldi5jdXJyZW50VGFyZ2V0KS5pbmRleCgpO2lmKCQoZXYuY3VycmVudFRhcmdldCkuaXMoJ3RoJykpe2luZGV4Kz0xO30KdGhpcy4kKCJ0ZCIpLmZpbHRlcigiOm50aC1jaGlsZCgiKyhpbmRleCsxKSsiKSIpLmFkZENsYXNzKCJvX2NlbGxfaG92ZXIiKTt9LF9vbk1vdXNlbGVhdmVDZWxsOmZ1bmN0aW9uKCl7dGhpcy4kKCcub19jZWxsX2hvdmVyJykucmVtb3ZlQ2xhc3MoJ29fY2VsbF9ob3ZlcicpO30sX29uT3BlbkhlYWRlckNsaWNrOmZ1bmN0aW9uKGV2KXtldi5wcmV2ZW50RGVmYXVsdCgpO2V2LnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO3ZhciAkdGFyZ2V0PSQoZXYudGFyZ2V0KTt2YXIgZ3JvdXBJZD0kdGFyZ2V0LmRhdGEoJ2dyb3VwSWQnKTt2YXIgdHlwZT0kdGFyZ2V0LmRhdGEoJ3R5cGUnKTt0aGlzLnRyaWdnZXJfdXAoJ2Nsb3NlX2dyb3VwJyx7Z3JvdXBJZDpncm91cElkLHR5cGU6dHlwZSx9KTt9LF9vblNwZWNpYWxSb3dDbGljazpmdW5jdGlvbihldil7ZXYucHJldmVudERlZmF1bHQoKTtldi5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTt2YXIgJHRhcmdldD0kKGV2LnRhcmdldCk7dmFyIGdyb3VwSWQ9JHRhcmdldC5kYXRhKCdncm91cElkJyk7dmFyIG1lYXN1cmU9JHRhcmdldC5kYXRhKCdtZWFzdXJlJyk7dmFyIG9yaWdpbkluZGV4ZXM9JHRhcmdldC5kYXRhKCdvcmlnaW5JbmRleGVzJyk7dmFyIGlzQXNjZW5kaW5nPSR0YXJnZXQuaGFzQ2xhc3MoJ29fcGl2b3Rfc29ydF9vcmRlcl9hc2MnKTt2YXIgb3JkZXI9aXNBc2NlbmRpbmc/J2Rlc2MnOidhc2MnO3RoaXMudHJpZ2dlcl91cCgnc29ydF9yb3dzJyx7c29ydGVkQ29sdW1uOntncm91cElkOmdyb3VwSWQsbWVhc3VyZTptZWFzdXJlLG9yZGVyOm9yZGVyLG9yaWdpbkluZGV4ZXM6b3JpZ2luSW5kZXhlcyx9fSk7fSx9KTtyZXR1cm4gUGl2b3RSZW5kZXJlcjt9KTs7CgovKiAvd2ViL3N0YXRpYy9zcmMvanMvdmlld3MvcGl2b3QvcGl2b3Rfdmlldy5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwpvZG9vLmRlZmluZSgnd2ViLlBpdm90VmlldycsZnVuY3Rpb24ocmVxdWlyZSl7InVzZSBzdHJpY3QiO3ZhciBBYnN0cmFjdFZpZXc9cmVxdWlyZSgnd2ViLkFic3RyYWN0VmlldycpO3ZhciBjb25maWc9cmVxdWlyZSgnd2ViLmNvbmZpZycpO3ZhciBjb3JlPXJlcXVpcmUoJ3dlYi5jb3JlJyk7dmFyIFBpdm90TW9kZWw9cmVxdWlyZSgnd2ViLlBpdm90TW9kZWwnKTt2YXIgUGl2b3RDb250cm9sbGVyPXJlcXVpcmUoJ3dlYi5QaXZvdENvbnRyb2xsZXInKTt2YXIgUGl2b3RSZW5kZXJlcj1yZXF1aXJlKCd3ZWIuUGl2b3RSZW5kZXJlcicpO3ZhciBfdD1jb3JlLl90O3ZhciBfbHQ9Y29yZS5fbHQ7dmFyIGNvbnRyb2xQYW5lbFZpZXdQYXJhbWV0ZXJzPXJlcXVpcmUoJ3dlYi5jb250cm9sUGFuZWxWaWV3UGFyYW1ldGVycycpO3ZhciBHUk9VUEFCTEVfVFlQRVM9Y29udHJvbFBhbmVsVmlld1BhcmFtZXRlcnMuR1JPVVBBQkxFX1RZUEVTO3ZhciBQaXZvdFZpZXc9QWJzdHJhY3RWaWV3LmV4dGVuZCh7ZGlzcGxheV9uYW1lOl9sdCgnUGl2b3QnKSxpY29uOidmYS10YWJsZScsY29uZmlnOl8uZXh0ZW5kKHt9LEFic3RyYWN0Vmlldy5wcm90b3R5cGUuY29uZmlnLHtNb2RlbDpQaXZvdE1vZGVsLENvbnRyb2xsZXI6UGl2b3RDb250cm9sbGVyLFJlbmRlcmVyOlBpdm90UmVuZGVyZXIsfSksdmlld1R5cGU6J3Bpdm90JyxzZWFyY2hNZW51VHlwZXM6WydmaWx0ZXInLCdncm91cEJ5JywndGltZVJhbmdlJywnZmF2b3JpdGUnXSxpbml0OmZ1bmN0aW9uKHZpZXdJbmZvLHBhcmFtcyl7dmFyIHNlbGY9dGhpczt0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dmFyIGFjdGl2ZU1lYXN1cmVzPVtdO3ZhciBjb2xHcm91cEJ5cz1bXTt2YXIgcm93R3JvdXBCeXM9W107dmFyIG1lYXN1cmVzPXt9O3ZhciBncm91cGFibGVGaWVsZHM9e307dmFyIHdpZGdldHM9e307dGhpcy5maWVsZHMuX19jb3VudD17c3RyaW5nOl90KCJDb3VudCIpLHR5cGU6ImludGVnZXIifTtfLmVhY2godGhpcy5maWVsZHMsZnVuY3Rpb24oZmllbGQsbmFtZSl7aWYoKG5hbWUhPT0naWQnKSYmKGZpZWxkLnN0b3JlPT09dHJ1ZSkpe2lmKF8uY29udGFpbnMoWydpbnRlZ2VyJywnZmxvYXQnLCdtb25ldGFyeSddLGZpZWxkLnR5cGUpfHxfLmNvbnRhaW5zKHBhcmFtcy5hZGRpdGlvbmFsTWVhc3VyZXMsbmFtZSkpe21lYXN1cmVzW25hbWVdPWZpZWxkO30KaWYoXy5jb250YWlucyhHUk9VUEFCTEVfVFlQRVMsZmllbGQudHlwZSkpe2dyb3VwYWJsZUZpZWxkc1tuYW1lXT1maWVsZDt9fX0pO21lYXN1cmVzLl9fY291bnQ9e3N0cmluZzpfdCgiQ291bnQiKSx0eXBlOiJpbnRlZ2VyIn07dGhpcy5hcmNoLmNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24oZmllbGQpe3ZhciBuYW1lPWZpZWxkLmF0dHJzLm5hbWU7aWYoZmllbGQuYXR0cnMuaW50ZXJ2YWwpe25hbWUrPSc6JytmaWVsZC5hdHRycy5pbnRlcnZhbDt9CmlmKGZpZWxkLmF0dHJzLndpZGdldCl7d2lkZ2V0c1tuYW1lXT1maWVsZC5hdHRycy53aWRnZXQ7fQppZihmaWVsZC5hdHRycy5pbnZpc2libGUmJnB5LmV2YWwoZmllbGQuYXR0cnMuaW52aXNpYmxlKSl7ZGVsZXRlIG1lYXN1cmVzW25hbWVdO3JldHVybjt9CmlmKGZpZWxkLmF0dHJzLnR5cGU9PT0nbWVhc3VyZScmJiEobmFtZSBpbiBtZWFzdXJlcykpe21lYXN1cmVzW25hbWVdPXNlbGYuZmllbGRzW25hbWVdO30KaWYoZmllbGQuYXR0cnMuc3RyaW5nKXttZWFzdXJlc1tuYW1lXS5zdHJpbmc9ZmllbGQuYXR0cnMuc3RyaW5nO30KaWYoZmllbGQuYXR0cnMudHlwZT09PSdtZWFzdXJlJ3x8J29wZXJhdG9yJ2luIGZpZWxkLmF0dHJzKXthY3RpdmVNZWFzdXJlcy5wdXNoKG5hbWUpO21lYXN1cmVzW25hbWVdPXNlbGYuZmllbGRzW25hbWVdO30KaWYoZmllbGQuYXR0cnMudHlwZT09PSdjb2wnKXtjb2xHcm91cEJ5cy5wdXNoKG5hbWUpO30KaWYoZmllbGQuYXR0cnMudHlwZT09PSdyb3cnKXtyb3dHcm91cEJ5cy5wdXNoKG5hbWUpO319KTtpZigoIWFjdGl2ZU1lYXN1cmVzLmxlbmd0aCl8fHRoaXMuYXJjaC5hdHRycy5kaXNwbGF5X3F1YW50aXR5KXthY3RpdmVNZWFzdXJlcz1bJ19fY291bnQnXS5jb25jYXQoYWN0aXZlTWVhc3VyZXMpO30KdGhpcy5sb2FkUGFyYW1zLm1lYXN1cmVzPWFjdGl2ZU1lYXN1cmVzO3RoaXMubG9hZFBhcmFtcy5jb2xHcm91cEJ5cz1jb2xHcm91cEJ5czt0aGlzLmxvYWRQYXJhbXMucm93R3JvdXBCeXM9cm93R3JvdXBCeXM7dGhpcy5sb2FkUGFyYW1zLmZpZWxkcz10aGlzLmZpZWxkczt0aGlzLmxvYWRQYXJhbXMuZGVmYXVsdF9vcmRlcj1wYXJhbXMuZGVmYXVsdF9vcmRlcnx8dGhpcy5hcmNoLmF0dHJzLmRlZmF1bHRfb3JkZXI7aWYoY29uZmlnLmRldmljZS5pc01vYmlsZSl7dGhpcy5sb2FkUGFyYW1zLmNvbEdyb3VwQnlzPVtdO30KdGhpcy5yZW5kZXJlclBhcmFtcy53aWRnZXRzPXdpZGdldHM7dGhpcy5yZW5kZXJlclBhcmFtcy5lbmFibGVMaW5raW5nPSF0aGlzLmFyY2guYXR0cnMuZGlzYWJsZV9saW5raW5nO3RoaXMuY29udHJvbGxlclBhcmFtcy50aXRsZT1wYXJhbXMudGl0bGV8fHRoaXMuYXJjaC5hdHRycy5zdHJpbmd8fF90KCJVbnRpdGxlZCIpO3RoaXMuY29udHJvbGxlclBhcmFtcy5tZWFzdXJlcz1tZWFzdXJlczt0aGlzLmNvbnRyb2xsZXJQYXJhbXMuZ3JvdXBhYmxlRmllbGRzPWdyb3VwYWJsZUZpZWxkczt0aGlzLmNvbnRyb2xsZXJQYXJhbXMudmlld3M9W19maW5kVmlldyhwYXJhbXMuYWN0aW9uVmlld3MsJ2xpc3QnKSxfZmluZFZpZXcocGFyYW1zLmFjdGlvblZpZXdzLCdmb3JtJyksXTtmdW5jdGlvbiBfZmluZFZpZXcodmlld3Msdmlld1R5cGUpe3ZhciB2aWV3PV8uZmluZCh2aWV3cyxmdW5jdGlvbih2aWV3KXtyZXR1cm4gdmlldy50eXBlPT09dmlld1R5cGU7fSk7cmV0dXJuW3ZpZXc/dmlldy52aWV3SUQ6ZmFsc2Usdmlld1R5cGVdO319LH0pO3JldHVybiBQaXZvdFZpZXc7fSk7OwoKLyogL3dlYi9zdGF0aWMvc3JjL2pzL3ZpZXdzL2NhbGVuZGFyL2NhbGVuZGFyX2NvbnRyb2xsZXIuanMgZGVmaW5lZCBpbiBidW5kbGUgJ3dlYi5hc3NldHNfYmFja2VuZCcgKi8Kb2Rvby5kZWZpbmUoJ3dlYi5DYWxlbmRhckNvbnRyb2xsZXInLGZ1bmN0aW9uKHJlcXVpcmUpeyJ1c2Ugc3RyaWN0Ijt2YXIgQWJzdHJhY3RDb250cm9sbGVyPXJlcXVpcmUoJ3dlYi5BYnN0cmFjdENvbnRyb2xsZXInKTt2YXIgY29uZmlnPXJlcXVpcmUoJ3dlYi5jb25maWcnKTt2YXIgY29yZT1yZXF1aXJlKCd3ZWIuY29yZScpO3ZhciBEaWFsb2c9cmVxdWlyZSgnd2ViLkRpYWxvZycpO3ZhciBkaWFsb2dzPXJlcXVpcmUoJ3dlYi52aWV3X2RpYWxvZ3MnKTt2YXIgUXVpY2tDcmVhdGU9cmVxdWlyZSgnd2ViLkNhbGVuZGFyUXVpY2tDcmVhdGUnKTt2YXIgX3Q9Y29yZS5fdDt2YXIgUVdlYj1jb3JlLnF3ZWI7ZnVuY3Rpb24gZGF0ZVRvU2VydmVyKGRhdGUpe3JldHVybiBkYXRlLmNsb25lKCkudXRjKCkubG9jYWxlKCdlbicpLmZvcm1hdCgnWVlZWS1NTS1ERCBISDptbTpzcycpO30KdmFyIENhbGVuZGFyQ29udHJvbGxlcj1BYnN0cmFjdENvbnRyb2xsZXIuZXh0ZW5kKHtjdXN0b21fZXZlbnRzOl8uZXh0ZW5kKHt9LEFic3RyYWN0Q29udHJvbGxlci5wcm90b3R5cGUuY3VzdG9tX2V2ZW50cyx7Y2hhbmdlRGF0ZTonX29uQ2hhbmdlRGF0ZScsY2hhbmdlRmlsdGVyOidfb25DaGFuZ2VGaWx0ZXInLGRlbGV0ZVJlY29yZDonX29uRGVsZXRlUmVjb3JkJyxkcm9wUmVjb3JkOidfb25Ecm9wUmVjb3JkJyxuZXh0Oidfb25OZXh0JyxvcGVuQ3JlYXRlOidfb25PcGVuQ3JlYXRlJyxvcGVuRXZlbnQ6J19vbk9wZW5FdmVudCcscHJldjonX29uUHJldicscXVpY2tDcmVhdGU6J19vblF1aWNrQ3JlYXRlJyx1cGRhdGVSZWNvcmQ6J19vblVwZGF0ZVJlY29yZCcsdmlld1VwZGF0ZWQ6J19vblZpZXdVcGRhdGVkJyx9KSxpbml0OmZ1bmN0aW9uKHBhcmVudCxtb2RlbCxyZW5kZXJlcixwYXJhbXMpe3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLmN1cnJlbnRfc3RhcnQ9bnVsbDt0aGlzLmRpc3BsYXlOYW1lPXBhcmFtcy5kaXNwbGF5TmFtZTt0aGlzLnF1aWNrQWRkUG9wPXBhcmFtcy5xdWlja0FkZFBvcDt0aGlzLmRpc2FibGVRdWlja0NyZWF0ZT1wYXJhbXMuZGlzYWJsZVF1aWNrQ3JlYXRlO3RoaXMuZXZlbnRPcGVuUG9wdXA9cGFyYW1zLmV2ZW50T3BlblBvcHVwO3RoaXMuZm9ybVZpZXdJZD1wYXJhbXMuZm9ybVZpZXdJZDt0aGlzLnJlYWRvbmx5Rm9ybVZpZXdJZD1wYXJhbXMucmVhZG9ubHlGb3JtVmlld0lkO3RoaXMubWFwcGluZz1wYXJhbXMubWFwcGluZzt0aGlzLmNvbnRleHQ9cGFyYW1zLmNvbnRleHQ7dGhpcy5wcmV2aW91c09wZW49bnVsbDt0aGlzLnF1aWNrQ3JlYXRpbmc9ZmFsc2U7fSxkZXN0cm95OmZ1bmN0aW9uKCl7dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO2lmKHRoaXMuJHRvZGF5QnV0dG9uKXt0aGlzLiR0b2RheUJ1dHRvbi5vZmYoKTt9fSxnZXRUaXRsZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl90aXRsZTt9LHJlbmRlckJ1dHRvbnM6ZnVuY3Rpb24oJG5vZGUpe3ZhciBzZWxmPXRoaXM7dGhpcy4kYnV0dG9ucz0kKFFXZWIucmVuZGVyKCdDYWxlbmRhclZpZXcuYnV0dG9ucycse2lzTW9iaWxlOmNvbmZpZy5kZXZpY2UuaXNNb2JpbGUsfSkpO3RoaXMuJGJ1dHRvbnMub24oJ2NsaWNrJywnYnV0dG9uLm9fY2FsZW5kYXJfYnV0dG9uX25ldycsZnVuY3Rpb24oKXtzZWxmLnRyaWdnZXJfdXAoJ3N3aXRjaF92aWV3Jyx7dmlld190eXBlOidmb3JtJ30pO30pO18uZWFjaChbJ3ByZXYnLCd0b2RheScsJ25leHQnXSxmdW5jdGlvbihhY3Rpb24pe3NlbGYuJGJ1dHRvbnMub24oJ2NsaWNrJywnLm9fY2FsZW5kYXJfYnV0dG9uXycrYWN0aW9uLGZ1bmN0aW9uKCl7c2VsZi5fbW92ZShhY3Rpb24pO30pO30pO18uZWFjaChbJ2RheScsJ3dlZWsnLCdtb250aCddLGZ1bmN0aW9uKHNjYWxlKXtzZWxmLiRidXR0b25zLm9uKCdjbGljaycsJy5vX2NhbGVuZGFyX2J1dHRvbl8nK3NjYWxlLGZ1bmN0aW9uKCl7c2VsZi5tb2RlbC5zZXRTY2FsZShzY2FsZSk7c2VsZi5yZWxvYWQoKTt9KTt9KTt0aGlzLiRidXR0b25zLmZpbmQoJy5vX2NhbGVuZGFyX2J1dHRvbl8nK3RoaXMubW9kZSkuYWRkQ2xhc3MoJ2FjdGl2ZScpO2lmKCRub2RlKXt0aGlzLiRidXR0b25zLmFwcGVuZFRvKCRub2RlKTt9ZWxzZXt0aGlzLiQoJy5vX2NhbGVuZGFyX2J1dHRvbnMnKS5yZXBsYWNlV2l0aCh0aGlzLiRidXR0b25zKTt9fSxyZW5kZXJQYWdlcjpmdW5jdGlvbigkbm9kZSl7aWYoY29uZmlnLmRldmljZS5pc01vYmlsZSl7dGhpcy4kdG9kYXlCdXR0b249JChRV2ViLnJlbmRlcignQ2FsZW5kYXJWaWV3LlRvZGF5QnV0dG9uTW9iaWxlJykpO3RoaXMuJHRvZGF5QnV0dG9uLm9uKCdjbGljaycsdGhpcy5fbW92ZS5iaW5kKHRoaXMsJ3RvZGF5JykpOyRub2RlLmFwcGVuZCh0aGlzLiR0b2RheUJ1dHRvbik7fX0sX21vdmU6ZnVuY3Rpb24odG8pe3RoaXMubW9kZWxbdG9dKCk7cmV0dXJuIHRoaXMucmVsb2FkKCk7fSxfdXBkYXRlUmVjb3JkOmZ1bmN0aW9uKHJlY29yZCl7dmFyIHJlbG9hZD10aGlzLnJlbG9hZC5iaW5kKHRoaXMse30pO3JldHVybiB0aGlzLm1vZGVsLnVwZGF0ZVJlY29yZChyZWNvcmQpLnRoZW4ocmVsb2FkLHJlbG9hZCk7fSxfb25DaGFuZ2VEYXRlOmZ1bmN0aW9uKGV2ZW50KXt2YXIgbW9kZWxEYXRhPXRoaXMubW9kZWwuZ2V0KCk7aWYobW9kZWxEYXRhLnRhcmdldF9kYXRlLmZvcm1hdCgnWVlZWS1NTS1ERCcpPT09ZXZlbnQuZGF0YS5kYXRlLmZvcm1hdCgnWVlZWS1NTS1ERCcpKXtzd2l0Y2gobW9kZWxEYXRhLnNjYWxlKXtjYXNlJ21vbnRoJzp0aGlzLm1vZGVsLnNldFNjYWxlKCd3ZWVrJyk7YnJlYWs7Y2FzZSd3ZWVrJzp0aGlzLm1vZGVsLnNldFNjYWxlKCdkYXknKTticmVhaztjYXNlJ2RheSc6dGhpcy5tb2RlbC5zZXRTY2FsZSgnbW9udGgnKTticmVhazt9fWVsc2UgaWYobW9kZWxEYXRhLnRhcmdldF9kYXRlLndlZWsoKT09PWV2ZW50LmRhdGEuZGF0ZS53ZWVrKCkpe3RoaXMubW9kZWwuc2V0U2NhbGUoJ2RheScpO31lbHNle3RoaXMubW9kZWwuc2V0U2NhbGUoJ3dlZWsnKTt9CnRoaXMubW9kZWwuc2V0RGF0ZShldmVudC5kYXRhLmRhdGUpO3RoaXMucmVsb2FkKCk7fSxfb25DaGFuZ2VGaWx0ZXI6ZnVuY3Rpb24oZXZlbnQpe2lmKHRoaXMubW9kZWwuY2hhbmdlRmlsdGVyKGV2ZW50LmRhdGEpJiYhZXZlbnQuZGF0YS5ub19yZWxvYWQpe3RoaXMucmVsb2FkKCk7fX0sX29uRGVsZXRlUmVjb3JkOmZ1bmN0aW9uKGV2ZW50KXt2YXIgc2VsZj10aGlzO0RpYWxvZy5jb25maXJtKHRoaXMsX3QoIkFyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byBkZWxldGUgdGhpcyByZWNvcmQgPyIpLHtjb25maXJtX2NhbGxiYWNrOmZ1bmN0aW9uKCl7c2VsZi5tb2RlbC5kZWxldGVSZWNvcmRzKFtldmVudC5kYXRhLmlkXSxzZWxmLm1vZGVsTmFtZSkudGhlbihmdW5jdGlvbigpe3NlbGYucmVsb2FkKCk7fSk7fX0pO30sX29uRHJvcFJlY29yZDpmdW5jdGlvbihldmVudCl7dGhpcy5fdXBkYXRlUmVjb3JkKF8uZXh0ZW5kKHt9LGV2ZW50LmRhdGEseydkcm9wJzp0cnVlLH0pKTt9LF9vbk5leHQ6ZnVuY3Rpb24oZXZlbnQpe2V2ZW50LnN0b3BQcm9wYWdhdGlvbigpO3RoaXMuX21vdmUoJ25leHQnKTt9LF9vbk9wZW5DcmVhdGU6ZnVuY3Rpb24oZXZlbnQpe3ZhciBzZWxmPXRoaXM7aWYodGhpcy5tb2RlbC5nZXQoKS5zY2FsZT09PSJtb250aCIpe2V2ZW50LmRhdGEuYWxsRGF5PXRydWU7fQp2YXIgZGF0YT10aGlzLm1vZGVsLmNhbGVuZGFyRXZlbnRUb1JlY29yZChldmVudC5kYXRhKTt2YXIgY29udGV4dD1fLmV4dGVuZCh7fSx0aGlzLmNvbnRleHQsZXZlbnQub3B0aW9ucyYmZXZlbnQub3B0aW9ucy5jb250ZXh0KTtjb250ZXh0LmRlZmF1bHRfbmFtZT1kYXRhLm5hbWV8fG51bGw7Y29udGV4dFsnZGVmYXVsdF8nK3RoaXMubWFwcGluZy5kYXRlX3N0YXJ0XT1kYXRhW3RoaXMubWFwcGluZy5kYXRlX3N0YXJ0XXx8bnVsbDtpZih0aGlzLm1hcHBpbmcuZGF0ZV9zdG9wKXtjb250ZXh0WydkZWZhdWx0XycrdGhpcy5tYXBwaW5nLmRhdGVfc3RvcF09ZGF0YVt0aGlzLm1hcHBpbmcuZGF0ZV9zdG9wXXx8bnVsbDt9CmlmKHRoaXMubWFwcGluZy5kYXRlX2RlbGF5KXtjb250ZXh0WydkZWZhdWx0XycrdGhpcy5tYXBwaW5nLmRhdGVfZGVsYXldPWRhdGFbdGhpcy5tYXBwaW5nLmRhdGVfZGVsYXldfHxudWxsO30KaWYodGhpcy5tYXBwaW5nLmFsbF9kYXkpe2NvbnRleHRbJ2RlZmF1bHRfJyt0aGlzLm1hcHBpbmcuYWxsX2RheV09ZGF0YVt0aGlzLm1hcHBpbmcuYWxsX2RheV18fG51bGw7fQpmb3IodmFyIGsgaW4gY29udGV4dCl7aWYoY29udGV4dFtrXSYmY29udGV4dFtrXS5faXNBTW9tZW50T2JqZWN0KXtjb250ZXh0W2tdPWRhdGVUb1NlcnZlcihjb250ZXh0W2tdKTt9fQp2YXIgb3B0aW9ucz1fLmV4dGVuZCh7fSx0aGlzLm9wdGlvbnMsZXZlbnQub3B0aW9ucyx7Y29udGV4dDpjb250ZXh0LHRpdGxlOl8uc3RyLnNwcmludGYoX3QoJ0NyZWF0ZTogJXMnKSwodGhpcy5kaXNwbGF5TmFtZXx8dGhpcy5yZW5kZXJlci5hcmNoLmF0dHJzLnN0cmluZykpfSk7aWYodGhpcy5xdWljayE9bnVsbCl7dGhpcy5xdWljay5kZXN0cm95KCk7dGhpcy5xdWljaz1udWxsO30KaWYoIW9wdGlvbnMuZGlzYWJsZVF1aWNrQ3JlYXRlJiYhZXZlbnQuZGF0YS5kaXNhYmxlUXVpY2tDcmVhdGUmJnRoaXMucXVpY2tBZGRQb3Ape3RoaXMucXVpY2s9bmV3IFF1aWNrQ3JlYXRlKHRoaXMsdHJ1ZSxvcHRpb25zLGRhdGEsZXZlbnQuZGF0YSk7dGhpcy5xdWljay5vcGVuKCk7dGhpcy5xdWljay5vcGVuZWQoZnVuY3Rpb24oKXtzZWxmLnF1aWNrLmZvY3VzKCk7fSk7cmV0dXJuO30KdmFyIHRpdGxlPV90KCJDcmVhdGUiKTtpZih0aGlzLnJlbmRlcmVyLmFyY2guYXR0cnMuc3RyaW5nKXt0aXRsZSs9JzogJyt0aGlzLnJlbmRlcmVyLmFyY2guYXR0cnMuc3RyaW5nO30KaWYodGhpcy5ldmVudE9wZW5Qb3B1cCl7aWYodGhpcy5wcmV2aW91c09wZW4pe3RoaXMucHJldmlvdXNPcGVuLmNsb3NlKCk7fQp0aGlzLnByZXZpb3VzT3Blbj1uZXcgZGlhbG9ncy5Gb3JtVmlld0RpYWxvZyhzZWxmLHtyZXNfbW9kZWw6dGhpcy5tb2RlbE5hbWUsY29udGV4dDpjb250ZXh0LHRpdGxlOnRpdGxlLHZpZXdfaWQ6dGhpcy5mb3JtVmlld0lkfHxmYWxzZSxkaXNhYmxlX211bHRpcGxlX3NlbGVjdGlvbjp0cnVlLG9uX3NhdmVkOmZ1bmN0aW9uKCl7aWYoZXZlbnQuZGF0YS5vbl9zYXZlKXtldmVudC5kYXRhLm9uX3NhdmUoKTt9CnNlbGYucmVsb2FkKCk7fSx9KTt0aGlzLnByZXZpb3VzT3Blbi5vcGVuKCk7fWVsc2V7dGhpcy5kb19hY3Rpb24oe3R5cGU6J2lyLmFjdGlvbnMuYWN0X3dpbmRvdycscmVzX21vZGVsOnRoaXMubW9kZWxOYW1lLHZpZXdzOltbdGhpcy5mb3JtVmlld0lkfHxmYWxzZSwnZm9ybSddXSx0YXJnZXQ6J2N1cnJlbnQnLGNvbnRleHQ6Y29udGV4dCx9KTt9fSxfb25PcGVuRXZlbnQ6ZnVuY3Rpb24oZXZlbnQpe3ZhciBzZWxmPXRoaXM7dmFyIGlkPWV2ZW50LmRhdGEuX2lkO2lkPWlkJiZwYXJzZUludChpZCkudG9TdHJpbmcoKT09PWlkP3BhcnNlSW50KGlkKTppZDtpZighdGhpcy5ldmVudE9wZW5Qb3B1cCl7dGhpcy5fcnBjKHttb2RlbDpzZWxmLm1vZGVsTmFtZSxtZXRob2Q6J2dldF9mb3Jtdmlld19pZCcsYXJnczpbW2lkXV0sY29udGV4dDpldmVudC5jb250ZXh0fHxzZWxmLmNvbnRleHQsfSkudGhlbihmdW5jdGlvbih2aWV3SWQpe3NlbGYuZG9fYWN0aW9uKHt0eXBlOidpci5hY3Rpb25zLmFjdF93aW5kb3cnLHJlc19pZDppZCxyZXNfbW9kZWw6c2VsZi5tb2RlbE5hbWUsdmlld3M6W1t2aWV3SWR8fGZhbHNlLCdmb3JtJ11dLHRhcmdldDonY3VycmVudCcsY29udGV4dDpldmVudC5jb250ZXh0fHxzZWxmLmNvbnRleHQsfSk7fSk7cmV0dXJuO30KdmFyIG9wdGlvbnM9e3Jlc19tb2RlbDpzZWxmLm1vZGVsTmFtZSxyZXNfaWQ6aWR8fG51bGwsY29udGV4dDpldmVudC5jb250ZXh0fHxzZWxmLmNvbnRleHQsdGl0bGU6X3QoIk9wZW46ICIpK2V2ZW50LmRhdGEudGl0bGUsb25fc2F2ZWQ6ZnVuY3Rpb24oKXtpZihldmVudC5kYXRhLm9uX3NhdmUpe2V2ZW50LmRhdGEub25fc2F2ZSgpO30Kc2VsZi5yZWxvYWQoKTt9LH07aWYodGhpcy5mb3JtVmlld0lkKXtvcHRpb25zLnZpZXdfaWQ9cGFyc2VJbnQodGhpcy5mb3JtVmlld0lkKTt9Cm5ldyBkaWFsb2dzLkZvcm1WaWV3RGlhbG9nKHRoaXMsb3B0aW9ucykub3BlbigpO30sX29uUHJldjpmdW5jdGlvbigpe2V2ZW50LnN0b3BQcm9wYWdhdGlvbigpO3RoaXMuX21vdmUoJ3ByZXYnKTt9LF9vblF1aWNrQ3JlYXRlOmZ1bmN0aW9uKGV2ZW50KXt2YXIgc2VsZj10aGlzO2lmKHRoaXMucXVpY2tDcmVhdGluZyl7cmV0dXJuO30KdGhpcy5xdWlja0NyZWF0aW5nPXRydWU7dGhpcy5tb2RlbC5jcmVhdGVSZWNvcmQoZXZlbnQpLnRoZW4oZnVuY3Rpb24oKXtzZWxmLnF1aWNrLmRlc3Ryb3koKTtzZWxmLnF1aWNrPW51bGw7c2VsZi5yZWxvYWQoKTtzZWxmLnF1aWNrQ3JlYXRpbmc9ZmFsc2U7fSkuZ3VhcmRlZENhdGNoKGZ1bmN0aW9uKHJlc3VsdCl7dmFyIGVycm9yRXZlbnQ9cmVzdWx0LmV2ZW50O2Vycm9yRXZlbnQucHJldmVudERlZmF1bHQoKTtldmVudC5kYXRhLm9wdGlvbnMuZGlzYWJsZVF1aWNrQ3JlYXRlPXRydWU7ZXZlbnQuZGF0YS5kYXRhLm9uX3NhdmU9c2VsZi5xdWljay5kZXN0cm95LmJpbmQoc2VsZi5xdWljayk7c2VsZi5fb25PcGVuQ3JlYXRlKGV2ZW50LmRhdGEpO3NlbGYucXVpY2tDcmVhdGluZz1mYWxzZTt9KX0sX29uVXBkYXRlUmVjb3JkOmZ1bmN0aW9uKGV2ZW50KXt0aGlzLl91cGRhdGVSZWNvcmQoZXZlbnQuZGF0YSk7fSxfb25WaWV3VXBkYXRlZDpmdW5jdGlvbihldmVudCl7dGhpcy5tb2RlPWV2ZW50LmRhdGEubW9kZTtpZih0aGlzLiRidXR0b25zKXt0aGlzLiRidXR0b25zLmZpbmQoJy5hY3RpdmUnKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7dGhpcy4kYnV0dG9ucy5maW5kKCcub19jYWxlbmRhcl9idXR0b25fJyt0aGlzLm1vZGUpLmFkZENsYXNzKCdhY3RpdmUnKTt9CnRoaXMuX3NldFRpdGxlKHRoaXMuZGlzcGxheU5hbWUrJyAoJytldmVudC5kYXRhLnRpdGxlKycpJyk7fSx9KTtyZXR1cm4gQ2FsZW5kYXJDb250cm9sbGVyO30pOzsKCi8qIC93ZWIvc3RhdGljL3NyYy9qcy92aWV3cy9jYWxlbmRhci9jYWxlbmRhcl9tb2RlbC5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwpvZG9vLmRlZmluZSgnd2ViLkNhbGVuZGFyTW9kZWwnLGZ1bmN0aW9uKHJlcXVpcmUpeyJ1c2Ugc3RyaWN0Ijt2YXIgQWJzdHJhY3RNb2RlbD1yZXF1aXJlKCd3ZWIuQWJzdHJhY3RNb2RlbCcpO3ZhciBDb250ZXh0PXJlcXVpcmUoJ3dlYi5Db250ZXh0Jyk7dmFyIGNvcmU9cmVxdWlyZSgnd2ViLmNvcmUnKTt2YXIgZmllbGRVdGlscz1yZXF1aXJlKCd3ZWIuZmllbGRfdXRpbHMnKTt2YXIgc2Vzc2lvbj1yZXF1aXJlKCd3ZWIuc2Vzc2lvbicpO3ZhciBfdD1jb3JlLl90O3ZhciBzY2FsZXM9WydkYXknLCd3ZWVrJywnbW9udGgnXTtmdW5jdGlvbiBkYXRlVG9TZXJ2ZXIoZGF0ZSl7cmV0dXJuIGRhdGUuY2xvbmUoKS51dGMoKS5sb2NhbGUoJ2VuJykuZm9ybWF0KCdZWVlZLU1NLUREIEhIOm1tOnNzJyk7fQpyZXR1cm4gQWJzdHJhY3RNb2RlbC5leHRlbmQoe2luaXQ6ZnVuY3Rpb24oKXt0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy5lbmRfZGF0ZT1udWxsO3ZhciB3ZWVrX3N0YXJ0PV90LmRhdGFiYXNlLnBhcmFtZXRlcnMud2Vla19zdGFydDt0aGlzLndlZWtfc3RhcnQ9d2Vla19zdGFydCE9PXVuZGVmaW5lZCYmd2Vla19zdGFydCE9PWZhbHNlP3dlZWtfc3RhcnQlNzptb21lbnQoKS5zdGFydE9mKCd3ZWVrJykuZGF5KCk7dGhpcy53ZWVrX3N0b3A9dGhpcy53ZWVrX3N0YXJ0KzY7fSxjYWxlbmRhckV2ZW50VG9SZWNvcmQ6ZnVuY3Rpb24oZXZlbnQpe3ZhciBkYXRhPXsnbmFtZSc6ZXZlbnQudGl0bGV9O3ZhciBzdGFydD1ldmVudC5zdGFydC5jbG9uZSgpO3ZhciBlbmQ9ZXZlbnQuZW5kJiZldmVudC5lbmQuY2xvbmUoKTtpZihldmVudC5hbGxEYXl8fChlbmQmJmVuZC5kaWZmKHN0YXJ0KSU4NjQwMDAwMD09PTApKXtldmVudC5hbGxEYXk9dHJ1ZTt9CmlmKCFlbmR8fGVuZC5kaWZmKHN0YXJ0KTwwKXtpZihldmVudC5hbGxEYXkpe2VuZD1zdGFydC5jbG9uZSgpO31lbHNle2VuZD1zdGFydC5jbG9uZSgpLmFkZCgyLCdoJyk7fX1lbHNlIGlmKGV2ZW50LmFsbERheSl7ZW5kLmFkZCgtMSwnZGF5cycpO30KdmFyIGlzRGF0ZUV2ZW50PXRoaXMuZmllbGRzW3RoaXMubWFwcGluZy5kYXRlX3N0YXJ0XS50eXBlPT09J2RhdGUnO2lmKGV2ZW50LmFsbERheSl7aWYoIXRoaXMubWFwcGluZy5hbGxfZGF5JiYhaXNEYXRlRXZlbnQpe2lmKGV2ZW50LnJfc3RhcnQpe3N0YXJ0LmhvdXJzKGV2ZW50LnJfc3RhcnQuaG91cnMoKSkubWludXRlcyhldmVudC5yX3N0YXJ0Lm1pbnV0ZXMoKSkuc2Vjb25kcyhldmVudC5yX3N0YXJ0LnNlY29uZHMoKSkudXRjKCk7ZW5kLmhvdXJzKGV2ZW50LnJfZW5kLmhvdXJzKCkpLm1pbnV0ZXMoZXZlbnQucl9lbmQubWludXRlcygpKS5zZWNvbmRzKGV2ZW50LnJfZW5kLnNlY29uZHMoKSkudXRjKCk7fWVsc2V7c3RhcnQuaG91cnMoNyk7ZW5kLmhvdXJzKDE5KTt9CnN0YXJ0LmFkZCgtdGhpcy5nZXRTZXNzaW9uKCkuZ2V0VFpPZmZzZXQoc3RhcnQpLCdtaW51dGVzJyk7ZW5kLmFkZCgtdGhpcy5nZXRTZXNzaW9uKCkuZ2V0VFpPZmZzZXQoZW5kKSwnbWludXRlcycpO319ZWxzZXtzdGFydC5hZGQoLXRoaXMuZ2V0U2Vzc2lvbigpLmdldFRaT2Zmc2V0KHN0YXJ0KSwnbWludXRlcycpO2VuZC5hZGQoLXRoaXMuZ2V0U2Vzc2lvbigpLmdldFRaT2Zmc2V0KGVuZCksJ21pbnV0ZXMnKTt9CmlmKHRoaXMubWFwcGluZy5hbGxfZGF5KXtpZihldmVudC5yZWNvcmQpe2RhdGFbdGhpcy5tYXBwaW5nLmFsbF9kYXldPSh0aGlzLnNjYWxlIT09J21vbnRoJyYmZXZlbnQuYWxsRGF5KXx8ZXZlbnQucmVjb3JkW3RoaXMubWFwcGluZy5hbGxfZGF5XSYmZW5kLmRpZmYoc3RhcnQpPDEwfHxmYWxzZTt9ZWxzZXtkYXRhW3RoaXMubWFwcGluZy5hbGxfZGF5XT1ldmVudC5hbGxEYXk7fX0KZGF0YVt0aGlzLm1hcHBpbmcuZGF0ZV9zdGFydF09c3RhcnQ7aWYodGhpcy5tYXBwaW5nLmRhdGVfc3RvcCl7ZGF0YVt0aGlzLm1hcHBpbmcuZGF0ZV9zdG9wXT1lbmQ7fQppZih0aGlzLm1hcHBpbmcuZGF0ZV9kZWxheSl7aWYodGhpcy5kYXRhLnNjYWxlIT09J21vbnRoJ3x8KHRoaXMuZGF0YS5zY2FsZT09PSdtb250aCcmJiFldmVudC5kcm9wKSl7ZGF0YVt0aGlzLm1hcHBpbmcuZGF0ZV9kZWxheV09KGVuZC5kaWZmKHN0YXJ0KTw9MD9lbmQuZW5kT2YoJ2RheScpLmRpZmYoc3RhcnQpOmVuZC5kaWZmKHN0YXJ0KSkvMTAwMC8zNjAwO319CnJldHVybiBkYXRhO30sY2hhbmdlRmlsdGVyOmZ1bmN0aW9uKGZpbHRlcil7dmFyIEZpbHRlcj10aGlzLmRhdGEuZmlsdGVyc1tmaWx0ZXIuZmllbGROYW1lXTtpZihmaWx0ZXIudmFsdWU9PT0nYWxsJyl7RmlsdGVyLmFsbD1maWx0ZXIuYWN0aXZlO30KdmFyIGY9Xy5maW5kKEZpbHRlci5maWx0ZXJzLGZ1bmN0aW9uKGYpe3JldHVybiBmLnZhbHVlPT09ZmlsdGVyLnZhbHVlO30pO2lmKGYpe2lmKGYuYWN0aXZlIT09ZmlsdGVyLmFjdGl2ZSl7Zi5hY3RpdmU9ZmlsdGVyLmFjdGl2ZTt9ZWxzZXtyZXR1cm4gZmFsc2U7fX1lbHNlIGlmKGZpbHRlci5hY3RpdmUpe0ZpbHRlci5maWx0ZXJzLnB1c2goe3ZhbHVlOmZpbHRlci52YWx1ZSxhY3RpdmU6dHJ1ZSx9KTt9CnJldHVybiB0cnVlO30sY3JlYXRlUmVjb3JkOmZ1bmN0aW9uKGV2ZW50KXt2YXIgZGF0YT10aGlzLmNhbGVuZGFyRXZlbnRUb1JlY29yZChldmVudC5kYXRhLmRhdGEpO2Zvcih2YXIgayBpbiBkYXRhKXtpZihkYXRhW2tdJiZkYXRhW2tdLl9pc0FNb21lbnRPYmplY3Qpe2RhdGFba109ZGF0ZVRvU2VydmVyKGRhdGFba10pO319CnJldHVybiB0aGlzLl9ycGMoe21vZGVsOnRoaXMubW9kZWxOYW1lLG1ldGhvZDonY3JlYXRlJyxhcmdzOltkYXRhXSxjb250ZXh0OmV2ZW50LmRhdGEub3B0aW9ucy5jb250ZXh0LH0pO30sZGVsZXRlUmVjb3JkczpmdW5jdGlvbihpZHMsbW9kZWwpe3JldHVybiB0aGlzLl9ycGMoe21vZGVsOm1vZGVsLG1ldGhvZDondW5saW5rJyxhcmdzOltpZHNdLGNvbnRleHQ6c2Vzc2lvbi51c2VyX2NvbnRleHQsfSk7fSxnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gXy5leHRlbmQoe30sdGhpcy5kYXRhLHtmaWVsZHM6dGhpcy5maWVsZHN9KTt9LGxvYWQ6ZnVuY3Rpb24ocGFyYW1zKXt2YXIgc2VsZj10aGlzO3RoaXMubW9kZWxOYW1lPXBhcmFtcy5tb2RlbE5hbWU7dGhpcy5maWVsZHM9cGFyYW1zLmZpZWxkczt0aGlzLmZpZWxkTmFtZXM9cGFyYW1zLmZpZWxkTmFtZXM7dGhpcy5maWVsZHNJbmZvPXBhcmFtcy5maWVsZHNJbmZvO3RoaXMubWFwcGluZz1wYXJhbXMubWFwcGluZzt0aGlzLm1vZGU9cGFyYW1zLm1vZGU7dGhpcy5zY2FsZXM9cGFyYW1zLnNjYWxlczt0aGlzLmVkaXRhYmxlPXBhcmFtcy5lZGl0YWJsZTt0aGlzLmNyZWF0YWJsZT1wYXJhbXMuY3JlYXRhYmxlO3RoaXMuZXZlbnRMaW1pdD1wYXJhbXMuZXZlbnRMaW1pdDt0aGlzLmZpZWxkQ29sb3I9cGFyYW1zLmZpZWxkQ29sb3I7aWYoIXRoaXMucHJlbG9hZFByb21pc2Upe3RoaXMucHJlbG9hZFByb21pc2U9bmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSxyZWplY3Qpe1Byb21pc2UuYWxsKFtzZWxmLl9ycGMoe21vZGVsOnNlbGYubW9kZWxOYW1lLG1ldGhvZDonY2hlY2tfYWNjZXNzX3JpZ2h0cycsYXJnczpbIndyaXRlIixmYWxzZV19KSxzZWxmLl9ycGMoe21vZGVsOnNlbGYubW9kZWxOYW1lLG1ldGhvZDonY2hlY2tfYWNjZXNzX3JpZ2h0cycsYXJnczpbImNyZWF0ZSIsZmFsc2VdfSldKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCl7dmFyIHdyaXRlPXJlc3VsdFswXTt2YXIgY3JlYXRlPXJlc3VsdFsxXTtzZWxmLndyaXRlX3JpZ2h0PXdyaXRlO3NlbGYuY3JlYXRlX3JpZ2h0PWNyZWF0ZTtyZXNvbHZlKCk7fSkuZ3VhcmRlZENhdGNoKHJlamVjdCk7fSk7fQp0aGlzLmRhdGE9e2RvbWFpbjpwYXJhbXMuZG9tYWluLGNvbnRleHQ6cGFyYW1zLmNvbnRleHQsZmlsdGVyczpwYXJhbXMuZmlsdGVycyx9O3RoaXMuc2V0RGF0ZShwYXJhbXMuaW5pdGlhbERhdGUpO3RoaXMuc2V0U2NhbGUocGFyYW1zLm1vZGUpO18uZWFjaCh0aGlzLmRhdGEuZmlsdGVycyxmdW5jdGlvbihmaWx0ZXIpe2lmKGZpbHRlci5hdmF0YXJfZmllbGQmJiFmaWx0ZXIuYXZhdGFyX21vZGVsKXtmaWx0ZXIuYXZhdGFyX21vZGVsPXNlbGYubW9kZWxOYW1lO319KTtyZXR1cm4gdGhpcy5wcmVsb2FkUHJvbWlzZS50aGVuKHRoaXMuX2xvYWRDYWxlbmRhci5iaW5kKHRoaXMpKTt9LG5leHQ6ZnVuY3Rpb24oKXt0aGlzLnNldERhdGUodGhpcy5kYXRhLnRhcmdldF9kYXRlLmNsb25lKCkuYWRkKDEsdGhpcy5kYXRhLnNjYWxlKSk7fSxwcmV2OmZ1bmN0aW9uKCl7dGhpcy5zZXREYXRlKHRoaXMuZGF0YS50YXJnZXRfZGF0ZS5jbG9uZSgpLmFkZCgtMSx0aGlzLmRhdGEuc2NhbGUpKTt9LHJlbG9hZDpmdW5jdGlvbihoYW5kbGUscGFyYW1zKXtpZihwYXJhbXMuZG9tYWluKXt0aGlzLmRhdGEuZG9tYWluPXBhcmFtcy5kb21haW47fQppZihwYXJhbXMuY29udGV4dCl7dGhpcy5kYXRhLmNvbnRleHQ9cGFyYW1zLmNvbnRleHQ7fQpyZXR1cm4gdGhpcy5fbG9hZENhbGVuZGFyKCk7fSxzZXREYXRlOmZ1bmN0aW9uKHN0YXJ0KXt0aGlzLmRhdGEuaGlnaGxpZ2h0X2RhdGU9dGhpcy5kYXRhLnRhcmdldF9kYXRlPXN0YXJ0LmNsb25lKCk7dGhpcy5kYXRhLnN0YXJ0X2RhdGU9dGhpcy5kYXRhLmVuZF9kYXRlPXN0YXJ0O3N3aXRjaCh0aGlzLmRhdGEuc2NhbGUpe2Nhc2UnbW9udGgnOnZhciBtb250aFN0YXJ0PXRoaXMuZGF0YS5zdGFydF9kYXRlLmNsb25lKCkuc3RhcnRPZignbW9udGgnKTt2YXIgbW9udGhTdGFydERheTtpZihtb250aFN0YXJ0LmRheSgpPj10aGlzLndlZWtfc3RhcnQpe21vbnRoU3RhcnREYXk9dGhpcy53ZWVrX3N0YXJ0O31lbHNle21vbnRoU3RhcnREYXk9dGhpcy53ZWVrX3N0YXJ0LTc7fQp0aGlzLmRhdGEuc3RhcnRfZGF0ZT1tb250aFN0YXJ0LmRheShtb250aFN0YXJ0RGF5KS5zdGFydE9mKCdkYXknKTt0aGlzLmRhdGEuZW5kX2RhdGU9dGhpcy5kYXRhLnN0YXJ0X2RhdGUuY2xvbmUoKS5hZGQoNSwnd2VlaycpLmRheSh0aGlzLndlZWtfc3RvcCkuZW5kT2YoJ2RheScpO2JyZWFrO2Nhc2Und2Vlayc6dGhpcy5kYXRhLnN0YXJ0X2RhdGU9dGhpcy5kYXRhLnN0YXJ0X2RhdGUuY2xvbmUoKS5kYXkodGhpcy53ZWVrX3N0YXJ0KS5zdGFydE9mKCdkYXknKTt0aGlzLmRhdGEuZW5kX2RhdGU9dGhpcy5kYXRhLmVuZF9kYXRlLmNsb25lKCkuZGF5KHRoaXMud2Vla19zdG9wKS5lbmRPZignZGF5Jyk7YnJlYWs7ZGVmYXVsdDp0aGlzLmRhdGEuc3RhcnRfZGF0ZT10aGlzLmRhdGEuc3RhcnRfZGF0ZS5jbG9uZSgpLnN0YXJ0T2YoJ2RheScpO3RoaXMuZGF0YS5lbmRfZGF0ZT10aGlzLmRhdGEuZW5kX2RhdGUuY2xvbmUoKS5lbmRPZignZGF5Jyk7fQp0aGlzLmRhdGEuc3RhcnRfZGF0ZS51dGMoKTt0aGlzLmRhdGEuZW5kX2RhdGUudXRjKCk7fSxzZXRTY2FsZTpmdW5jdGlvbihzY2FsZSl7aWYoIV8uY29udGFpbnMoc2NhbGVzLHNjYWxlKSl7c2NhbGU9IndlZWsiO30KdGhpcy5kYXRhLnNjYWxlPXNjYWxlO3RoaXMuc2V0RGF0ZSh0aGlzLmRhdGEudGFyZ2V0X2RhdGUpO30sdG9kYXk6ZnVuY3Rpb24oKXt0aGlzLnNldERhdGUobW9tZW50KG5ldyBEYXRlKCkpKTt9LHVwZGF0ZVJlY29yZDpmdW5jdGlvbihyZWNvcmQpe3ZhciBkYXRhPV8ub21pdCh0aGlzLmNhbGVuZGFyRXZlbnRUb1JlY29yZChyZWNvcmQpLCduYW1lJyk7Zm9yKHZhciBrIGluIGRhdGEpe2lmKGRhdGFba10mJmRhdGFba10uX2lzQU1vbWVudE9iamVjdCl7ZGF0YVtrXT1kYXRlVG9TZXJ2ZXIoZGF0YVtrXSk7fX0KdmFyIGNvbnRleHQ9bmV3IENvbnRleHQodGhpcy5kYXRhLmNvbnRleHQse2Zyb21fdWk6dHJ1ZX0pO3JldHVybiB0aGlzLl9ycGMoe21vZGVsOnRoaXMubW9kZWxOYW1lLG1ldGhvZDond3JpdGUnLGFyZ3M6W1tyZWNvcmQuaWRdLGRhdGFdLGNvbnRleHQ6Y29udGV4dH0pO30sX2dldEZpbHRlckRvbWFpbjpmdW5jdGlvbigpe3ZhciBhdXRob3JpemVkVmFsdWVzPXt9O3ZhciBhdm9pZFZhbHVlcz17fTtfLmVhY2godGhpcy5kYXRhLmZpbHRlcnMsZnVuY3Rpb24oZmlsdGVyKXtpZihmaWx0ZXIuYWxsKXJldHVybjtfLmVhY2goZmlsdGVyLmZpbHRlcnMsZnVuY3Rpb24oZil7aWYoZmlsdGVyLndyaXRlX21vZGVsKXtpZighYXV0aG9yaXplZFZhbHVlc1tmaWx0ZXIuZmllbGROYW1lXSkKYXV0aG9yaXplZFZhbHVlc1tmaWx0ZXIuZmllbGROYW1lXT1bXTtpZihmLmFjdGl2ZSl7YXV0aG9yaXplZFZhbHVlc1tmaWx0ZXIuZmllbGROYW1lXS5wdXNoKGYudmFsdWUpO319ZWxzZXtpZighYXZvaWRWYWx1ZXNbZmlsdGVyLmZpZWxkTmFtZV0pCmF2b2lkVmFsdWVzW2ZpbHRlci5maWVsZE5hbWVdPVtdO2lmKCFmLmFjdGl2ZSl7YXZvaWRWYWx1ZXNbZmlsdGVyLmZpZWxkTmFtZV0ucHVzaChmLnZhbHVlKTt9fX0pO30pO3ZhciBkb21haW49W107Zm9yKHZhciBmaWVsZCBpbiBhdXRob3JpemVkVmFsdWVzKXtkb21haW4ucHVzaChbZmllbGQsJ2luJyxhdXRob3JpemVkVmFsdWVzW2ZpZWxkXV0pO30KZm9yKHZhciBmaWVsZCBpbiBhdm9pZFZhbHVlcyl7aWYoYXZvaWRWYWx1ZXNbZmllbGRdLmxlbmd0aD4wKXtkb21haW4ucHVzaChbZmllbGQsJ25vdCBpbicsYXZvaWRWYWx1ZXNbZmllbGRdXSk7fX0KcmV0dXJuIGRvbWFpbjt9LF9nZXRGdWxsQ2FsZW5kYXJPcHRpb25zOmZ1bmN0aW9uKCl7cmV0dXJue2RlZmF1bHRWaWV3Oih0aGlzLm1vZGU9PT0ibW9udGgiKT8ibW9udGgiOigodGhpcy5tb2RlPT09IndlZWsiKT8iYWdlbmRhV2VlayI6KCh0aGlzLm1vZGU9PT0iZGF5Iik/ImFnZW5kYURheSI6ImFnZW5kYVdlZWsiKSksaGVhZGVyOmZhbHNlLHNlbGVjdGFibGU6dGhpcy5jcmVhdGFibGUmJnRoaXMuY3JlYXRlX3JpZ2h0LHNlbGVjdEhlbHBlcjp0cnVlLGVkaXRhYmxlOnRoaXMuZWRpdGFibGUsZHJvcHBhYmxlOnRydWUsbmF2TGlua3M6ZmFsc2UsZXZlbnRMaW1pdDp0aGlzLmV2ZW50TGltaXQsc25hcE1pbnV0ZXM6MTUsbG9uZ1ByZXNzRGVsYXk6NTAwLGV2ZW50UmVzaXphYmxlRnJvbVN0YXJ0OnRydWUsbm93SW5kaWNhdG9yOnRydWUsd2Vla051bWJlcnM6dHJ1ZSx3ZWVrTnVtYmVyc1dpdGhpbkRheXM6dHJ1ZSx3ZWVrTnVtYmVyVGl0bGU6X3QoIldlZWsiKSsiICIsYWxsRGF5VGV4dDpfdCgiQWxsIGRheSIpLG1vbnRoTmFtZXM6bW9tZW50Lm1vbnRocygpLG1vbnRoTmFtZXNTaG9ydDptb21lbnQubW9udGhzU2hvcnQoKSxkYXlOYW1lczptb21lbnQud2Vla2RheXMoKSxkYXlOYW1lc1Nob3J0Om1vbWVudC53ZWVrZGF5c1Nob3J0KCksZmlyc3REYXk6dGhpcy53ZWVrX3N0YXJ0LHNsb3RMYWJlbEZvcm1hdDpfdC5kYXRhYmFzZS5wYXJhbWV0ZXJzLnRpbWVfZm9ybWF0LnNlYXJjaCgiJUgiKSE9LTE/J0g6bW0nOidoKDptbSlhJyx9O30sX2dldFJhbmdlRG9tYWluOmZ1bmN0aW9uKCl7dmFyIGRvbWFpbj1bW3RoaXMubWFwcGluZy5kYXRlX3N0YXJ0LCc8PScsZGF0ZVRvU2VydmVyKHRoaXMuZGF0YS5lbmRfZGF0ZSldXTtpZih0aGlzLm1hcHBpbmcuZGF0ZV9zdG9wKXtkb21haW4ucHVzaChbdGhpcy5tYXBwaW5nLmRhdGVfc3RvcCwnPj0nLGRhdGVUb1NlcnZlcih0aGlzLmRhdGEuc3RhcnRfZGF0ZSldKTt9ZWxzZSBpZighdGhpcy5tYXBwaW5nLmRhdGVfZGVsYXkpe2RvbWFpbi5wdXNoKFt0aGlzLm1hcHBpbmcuZGF0ZV9zdGFydCwnPj0nLGRhdGVUb1NlcnZlcih0aGlzLmRhdGEuc3RhcnRfZGF0ZSldKTt9CnJldHVybiBkb21haW47fSxfbG9hZENhbGVuZGFyOmZ1bmN0aW9uKCl7dmFyIHNlbGY9dGhpczt0aGlzLmRhdGEuZmNfb3B0aW9ucz10aGlzLl9nZXRGdWxsQ2FsZW5kYXJPcHRpb25zKCk7dmFyIGRlZnM9Xy5tYXAodGhpcy5kYXRhLmZpbHRlcnMsdGhpcy5fbG9hZEZpbHRlci5iaW5kKHRoaXMpKTtyZXR1cm4gUHJvbWlzZS5hbGwoZGVmcykudGhlbihmdW5jdGlvbigpe3JldHVybiBzZWxmLl9ycGMoe21vZGVsOnNlbGYubW9kZWxOYW1lLG1ldGhvZDonc2VhcmNoX3JlYWQnLGNvbnRleHQ6c2VsZi5kYXRhLmNvbnRleHQsZmllbGRzOnNlbGYuZmllbGROYW1lcyxkb21haW46c2VsZi5kYXRhLmRvbWFpbi5jb25jYXQoc2VsZi5fZ2V0UmFuZ2VEb21haW4oKSkuY29uY2F0KHNlbGYuX2dldEZpbHRlckRvbWFpbigpKX0pLnRoZW4oZnVuY3Rpb24oZXZlbnRzKXtzZWxmLl9wYXJzZVNlcnZlckRhdGEoZXZlbnRzKTtzZWxmLmRhdGEuZGF0YT1fLm1hcChldmVudHMsc2VsZi5fcmVjb3JkVG9DYWxlbmRhckV2ZW50LmJpbmQoc2VsZikpO3JldHVybiBQcm9taXNlLmFsbChbc2VsZi5fbG9hZENvbG9ycyhzZWxmLmRhdGEsc2VsZi5kYXRhLmRhdGEpLHNlbGYuX2xvYWRSZWNvcmRzVG9GaWx0ZXJzKHNlbGYuZGF0YSxzZWxmLmRhdGEuZGF0YSldKTt9KTt9KTt9LF9sb2FkQ29sb3JzOmZ1bmN0aW9uKGVsZW1lbnQsZXZlbnRzKXtpZih0aGlzLmZpZWxkQ29sb3Ipe3ZhciBmaWVsZE5hbWU9dGhpcy5maWVsZENvbG9yO18uZWFjaChldmVudHMsZnVuY3Rpb24oZXZlbnQpe3ZhciB2YWx1ZT1ldmVudC5yZWNvcmRbZmllbGROYW1lXTtldmVudC5jb2xvcl9pbmRleD1fLmlzQXJyYXkodmFsdWUpP3ZhbHVlWzBdOnZhbHVlO30pO3RoaXMubW9kZWxfY29sb3I9dGhpcy5maWVsZHNbZmllbGROYW1lXS5yZWxhdGlvbnx8ZWxlbWVudC5tb2RlbDt9CnJldHVybiBQcm9taXNlLnJlc29sdmUoKTt9LF9sb2FkRmlsdGVyOmZ1bmN0aW9uKGZpbHRlcil7aWYoIWZpbHRlci53cml0ZV9tb2RlbCl7cmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO30KdmFyIGZpZWxkPXRoaXMuZmllbGRzW2ZpbHRlci5maWVsZE5hbWVdO3JldHVybiB0aGlzLl9ycGMoe21vZGVsOmZpbHRlci53cml0ZV9tb2RlbCxtZXRob2Q6J3NlYXJjaF9yZWFkJyxkb21haW46W1sidXNlcl9pZCIsIj0iLHNlc3Npb24udWlkXV0sZmllbGRzOltmaWx0ZXIud3JpdGVfZmllbGRdLH0pLnRoZW4oZnVuY3Rpb24ocmVzKXt2YXIgcmVjb3Jkcz1fLm1hcChyZXMsZnVuY3Rpb24ocmVjb3JkKXt2YXIgX3ZhbHVlPXJlY29yZFtmaWx0ZXIud3JpdGVfZmllbGRdO3ZhciB2YWx1ZT1fLmlzQXJyYXkoX3ZhbHVlKT9fdmFsdWVbMF06X3ZhbHVlO3ZhciBmPV8uZmluZChmaWx0ZXIuZmlsdGVycyxmdW5jdGlvbihmKXtyZXR1cm4gZi52YWx1ZT09PXZhbHVlO30pO3ZhciBmb3JtYXRlcj1maWVsZFV0aWxzLmZvcm1hdFtfLmNvbnRhaW5zKFsnbWFueTJtYW55Jywnb25lMm1hbnknXSxmaWVsZC50eXBlKT8nbWFueTJvbmUnOmZpZWxkLnR5cGVdO3JldHVybnsnaWQnOnJlY29yZC5pZCwndmFsdWUnOnZhbHVlLCdsYWJlbCc6Zm9ybWF0ZXIoX3ZhbHVlLGZpZWxkKSwnYWN0aXZlJzohZnx8Zi5hY3RpdmUsfTt9KTtyZWNvcmRzLnNvcnQoZnVuY3Rpb24oZjEsZjIpe3JldHVybiBfLnN0cmluZy5uYXR1cmFsQ21wKGYyLmxhYmVsLGYxLmxhYmVsKTt9KTtpZihmaWVsZC5yZWxhdGlvbj09PSdyZXMucGFydG5lcid8fGZpZWxkLnJlbGF0aW9uPT09J3Jlcy51c2Vycycpe3ZhciB2YWx1ZT1maWVsZC5yZWxhdGlvbj09PSdyZXMucGFydG5lcic/c2Vzc2lvbi5wYXJ0bmVyX2lkOnNlc3Npb24udWlkO3ZhciBtZT1fLmZpbmQocmVjb3JkcyxmdW5jdGlvbihyZWNvcmQpe3JldHVybiByZWNvcmQudmFsdWU9PT12YWx1ZTt9KTtpZihtZSl7cmVjb3Jkcy5zcGxpY2UocmVjb3Jkcy5pbmRleE9mKG1lKSwxKTt9ZWxzZXt2YXIgZj1fLmZpbmQoZmlsdGVyLmZpbHRlcnMsZnVuY3Rpb24oZil7cmV0dXJuIGYudmFsdWU9PT12YWx1ZTt9KTttZT17J3ZhbHVlJzp2YWx1ZSwnbGFiZWwnOnNlc3Npb24ubmFtZStfdCgiIFtNZV0iKSwnYWN0aXZlJzohZnx8Zi5hY3RpdmUsfTt9CnJlY29yZHMudW5zaGlmdChtZSk7fQpyZWNvcmRzLnB1c2goeyd2YWx1ZSc6J2FsbCcsJ2xhYmVsJzpmaWVsZC5yZWxhdGlvbj09PSdyZXMucGFydG5lcid8fGZpZWxkLnJlbGF0aW9uPT09J3Jlcy51c2Vycyc/X3QoIkV2ZXJ5Ym9keSdzIGNhbGVuZGFycyIpOl90KCJFdmVyeXRoaW5nIiksJ2FjdGl2ZSc6ZmlsdGVyLmFsbCx9KTtmaWx0ZXIuZmlsdGVycz1yZWNvcmRzO30pO30sX2xvYWRSZWNvcmRzVG9GaWx0ZXJzOmZ1bmN0aW9uKGVsZW1lbnQsZXZlbnRzKXt2YXIgc2VsZj10aGlzO3ZhciBuZXdfZmlsdGVycz17fTt2YXIgdG9fcmVhZD17fTtfLmVhY2godGhpcy5kYXRhLmZpbHRlcnMsZnVuY3Rpb24oZmlsdGVyLGZpZWxkTmFtZSl7dmFyIGZpZWxkPXNlbGYuZmllbGRzW2ZpZWxkTmFtZV07bmV3X2ZpbHRlcnNbZmllbGROYW1lXT1maWx0ZXI7aWYoZmlsdGVyLndyaXRlX21vZGVsKXtpZihmaWVsZC5yZWxhdGlvbj09PXNlbGYubW9kZWxfY29sb3Ipe18uZWFjaChmaWx0ZXIuZmlsdGVycyxmdW5jdGlvbihmKXtmLmNvbG9yX2luZGV4PWYudmFsdWU7fSk7fQpyZXR1cm47fQpfLmVhY2goZmlsdGVyLmZpbHRlcnMsZnVuY3Rpb24oZmlsdGVyKXtmaWx0ZXIuZGlzcGxheT0hZmlsdGVyLmFjdGl2ZTt9KTt2YXIgZnM9W107dmFyIHVuZGVmaW5lZF9mcz1bXTtfLmVhY2goZXZlbnRzLGZ1bmN0aW9uKGV2ZW50KXt2YXIgZGF0YT1ldmVudC5yZWNvcmRbZmllbGROYW1lXTtpZighXy5jb250YWlucyhbJ21hbnkybWFueScsJ29uZTJtYW55J10sZmllbGQudHlwZSkpe2RhdGE9W2RhdGFdO31lbHNle3RvX3JlYWRbZmllbGQucmVsYXRpb25dPSh0b19yZWFkW2ZpZWxkLnJlbGF0aW9uXXx8W10pLmNvbmNhdChkYXRhKTt9Cl8uZWFjaChkYXRhLGZ1bmN0aW9uKF92YWx1ZSl7dmFyIHZhbHVlPV8uaXNBcnJheShfdmFsdWUpP192YWx1ZVswXTpfdmFsdWU7dmFyIGY9eydjb2xvcl9pbmRleCc6c2VsZi5tb2RlbF9jb2xvcj09PShmaWVsZC5yZWxhdGlvbnx8ZWxlbWVudC5tb2RlbCk/dmFsdWU6ZmFsc2UsJ3ZhbHVlJzp2YWx1ZSwnbGFiZWwnOmZpZWxkVXRpbHMuZm9ybWF0W2ZpZWxkLnR5cGVdKF92YWx1ZSxmaWVsZCl8fF90KCJVbmRlZmluZWQiKSwnYXZhdGFyX21vZGVsJzpmaWVsZC5yZWxhdGlvbnx8ZWxlbWVudC5tb2RlbCx9O3ZhbHVlP2ZzLnB1c2goZik6dW5kZWZpbmVkX2ZzLnB1c2goZik7fSk7fSk7Xy5lYWNoKF8udW5pb24oZnMsdW5kZWZpbmVkX2ZzKSxmdW5jdGlvbihmKXt2YXIgZjE9Xy5maW5kV2hlcmUoZmlsdGVyLmZpbHRlcnMsZik7aWYoZjEpe2YxLmRpc3BsYXk9dHJ1ZTt9ZWxzZXtmLmRpc3BsYXk9Zi5hY3RpdmU9dHJ1ZTtmaWx0ZXIuZmlsdGVycy5wdXNoKGYpO319KTt9KTt2YXIgZGVmcz1bXTtfLmVhY2godG9fcmVhZCxmdW5jdGlvbihpZHMsbW9kZWwpe2RlZnMucHVzaChzZWxmLl9ycGMoe21vZGVsOm1vZGVsLG1ldGhvZDonbmFtZV9nZXQnLGFyZ3M6W18udW5pcShpZHMpXSx9KS50aGVuKGZ1bmN0aW9uKHJlcyl7dG9fcmVhZFttb2RlbF09Xy5vYmplY3QocmVzKTt9KSk7fSk7cmV0dXJuIFByb21pc2UuYWxsKGRlZnMpLnRoZW4oZnVuY3Rpb24oKXtfLmVhY2goc2VsZi5kYXRhLmZpbHRlcnMsZnVuY3Rpb24oZmlsdGVyKXtpZihmaWx0ZXIud3JpdGVfbW9kZWwpe3JldHVybjt9CmlmKGZpbHRlci5maWx0ZXJzLmxlbmd0aCYmKGZpbHRlci5maWx0ZXJzWzBdLmF2YXRhcl9tb2RlbCBpbiB0b19yZWFkKSl7Xy5lYWNoKGZpbHRlci5maWx0ZXJzLGZ1bmN0aW9uKGYpe2YubGFiZWw9dG9fcmVhZFtmLmF2YXRhcl9tb2RlbF1bZi52YWx1ZV07fSk7fX0pO30pO30sX3BhcnNlU2VydmVyRGF0YTpmdW5jdGlvbihkYXRhKXt2YXIgc2VsZj10aGlzO18uZWFjaChkYXRhLGZ1bmN0aW9uKGV2ZW50KXtfLmVhY2goc2VsZi5maWVsZE5hbWVzLGZ1bmN0aW9uKGZpZWxkTmFtZSl7ZXZlbnRbZmllbGROYW1lXT1zZWxmLl9wYXJzZVNlcnZlclZhbHVlKHNlbGYuZmllbGRzW2ZpZWxkTmFtZV0sZXZlbnRbZmllbGROYW1lXSk7fSk7fSk7fSxfcmVjb3JkVG9DYWxlbmRhckV2ZW50OmZ1bmN0aW9uKGV2dCl7dmFyIGRhdGVfc3RhcnQ7dmFyIGRhdGVfc3RvcDt2YXIgZGF0ZV9kZWxheT1ldnRbdGhpcy5tYXBwaW5nLmRhdGVfZGVsYXldfHwxLjAsYWxsX2RheT10aGlzLmZpZWxkc1t0aGlzLm1hcHBpbmcuZGF0ZV9zdGFydF0udHlwZT09PSdkYXRlJ3x8dGhpcy5tYXBwaW5nLmFsbF9kYXkmJmV2dFt0aGlzLm1hcHBpbmcuYWxsX2RheV18fGZhbHNlLHRoZV90aXRsZT0nJyxhdHRlbmRlZXM9W107aWYoIWFsbF9kYXkpe2RhdGVfc3RhcnQ9ZXZ0W3RoaXMubWFwcGluZy5kYXRlX3N0YXJ0XS5jbG9uZSgpO2RhdGVfc3RvcD10aGlzLm1hcHBpbmcuZGF0ZV9zdG9wP2V2dFt0aGlzLm1hcHBpbmcuZGF0ZV9zdG9wXS5jbG9uZSgpOm51bGw7fWVsc2V7ZGF0ZV9zdGFydD1ldnRbdGhpcy5tYXBwaW5nLmRhdGVfc3RhcnRdLmNsb25lKCkuc3RhcnRPZignZGF5Jyk7ZGF0ZV9zdG9wPXRoaXMubWFwcGluZy5kYXRlX3N0b3A/ZXZ0W3RoaXMubWFwcGluZy5kYXRlX3N0b3BdLmNsb25lKCkuc3RhcnRPZignZGF5Jyk6bnVsbDt9CmlmKCFkYXRlX3N0b3AmJmRhdGVfZGVsYXkpe2RhdGVfc3RvcD1kYXRlX3N0YXJ0LmNsb25lKCkuYWRkKGRhdGVfZGVsYXksJ2hvdXJzJyk7fQppZighYWxsX2RheSl7ZGF0ZV9zdGFydC5hZGQodGhpcy5nZXRTZXNzaW9uKCkuZ2V0VFpPZmZzZXQoZGF0ZV9zdGFydCksJ21pbnV0ZXMnKTtkYXRlX3N0b3AuYWRkKHRoaXMuZ2V0U2Vzc2lvbigpLmdldFRaT2Zmc2V0KGRhdGVfc3RvcCksJ21pbnV0ZXMnKTt9CmlmKHRoaXMubWFwcGluZy5hbGxfZGF5JiZldnRbdGhpcy5tYXBwaW5nLmFsbF9kYXldKXtkYXRlX3N0b3AuYWRkKDEsJ2RheXMnKTt9CnZhciByPXsncmVjb3JkJzpldnQsJ3N0YXJ0JzpkYXRlX3N0YXJ0LCdlbmQnOmRhdGVfc3RvcCwncl9zdGFydCc6ZGF0ZV9zdGFydCwncl9lbmQnOmRhdGVfc3RvcCwndGl0bGUnOnRoZV90aXRsZSwnYWxsRGF5JzphbGxfZGF5LCdpZCc6ZXZ0LmlkLCdhdHRlbmRlZXMnOmF0dGVuZGVlcyx9O2lmKHRoaXMubWFwcGluZy5hbGxfZGF5JiZldnRbdGhpcy5tYXBwaW5nLmFsbF9kYXldKXt9ZWxzZSBpZih0aGlzLmRhdGEuc2NhbGU9PT0nbW9udGgnJiZ0aGlzLmZpZWxkc1t0aGlzLm1hcHBpbmcuZGF0ZV9zdGFydF0udHlwZSE9PSdkYXRlJyl7ZGF0ZV9zdG9wLmFkZCgxLCdkYXlzJyk7ci5yZXNldF9hbGxkYXk9ci5hbGxEYXk7ci5hbGxEYXk9dHJ1ZTtyLnN0YXJ0PWRhdGVfc3RhcnQuZm9ybWF0KCdZWVlZLU1NLUREJyk7ci5lbmQ9ZGF0ZV9zdG9wLnN0YXJ0T2YoJ2RheScpLmZvcm1hdCgnWVlZWS1NTS1ERCcpO30KcmV0dXJuIHI7fSx9KTt9KTs7CgovKiAvd2ViL3N0YXRpYy9zcmMvanMvdmlld3MvY2FsZW5kYXIvY2FsZW5kYXJfcG9wb3Zlci5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwpvZG9vLmRlZmluZSgnd2ViLkNhbGVuZGFyUG9wb3ZlcicsZnVuY3Rpb24ocmVxdWlyZSl7InVzZSBzdHJpY3QiO3ZhciBmaWVsZFJlZ2lzdHJ5PXJlcXVpcmUoJ3dlYi5maWVsZF9yZWdpc3RyeScpO3ZhciBTdGFuZGFsb25lRmllbGRNYW5hZ2VyTWl4aW49cmVxdWlyZSgnd2ViLlN0YW5kYWxvbmVGaWVsZE1hbmFnZXJNaXhpbicpO3ZhciBXaWRnZXQ9cmVxdWlyZSgnd2ViLldpZGdldCcpO3ZhciBDYWxlbmRhclBvcG92ZXI9V2lkZ2V0LmV4dGVuZChTdGFuZGFsb25lRmllbGRNYW5hZ2VyTWl4aW4se3RlbXBsYXRlOidDYWxlbmRhclZpZXcuZXZlbnQucG9wb3ZlcicsZXZlbnRzOnsnY2xpY2sgLm9fY3dfcG9wb3Zlcl9lZGl0JzonX29uQ2xpY2tQb3BvdmVyRWRpdCcsJ2NsaWNrIC5vX2N3X3BvcG92ZXJfZGVsZXRlJzonX29uQ2xpY2tQb3BvdmVyRGVsZXRlJyx9LGluaXQ6ZnVuY3Rpb24ocGFyZW50LGV2ZW50SW5mbyl7dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO1N0YW5kYWxvbmVGaWVsZE1hbmFnZXJNaXhpbi5pbml0LmNhbGwodGhpcyk7dGhpcy5oaWRlRGF0ZT1ldmVudEluZm8uaGlkZURhdGU7dGhpcy5oaWRlVGltZT1ldmVudEluZm8uaGlkZVRpbWU7dGhpcy5ldmVudFRpbWU9ZXZlbnRJbmZvLmV2ZW50VGltZTt0aGlzLmV2ZW50RGF0ZT1ldmVudEluZm8uZXZlbnREYXRlO3RoaXMuZGlzcGxheUZpZWxkcz1ldmVudEluZm8uZGlzcGxheUZpZWxkczt0aGlzLmZpZWxkcz1ldmVudEluZm8uZmllbGRzO3RoaXMuZXZlbnQ9ZXZlbnRJbmZvLmV2ZW50O3RoaXMubW9kZWxOYW1lPWV2ZW50SW5mby5tb2RlbE5hbWU7fSx3aWxsU3RhcnQ6ZnVuY3Rpb24oKXtyZXR1cm4gUHJvbWlzZS5hbGwoW3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKSx0aGlzLl9wcm9jZXNzRmllbGRzKCldKTt9LHN0YXJ0OmZ1bmN0aW9uKCl7dmFyIHNlbGY9dGhpcztfLmVhY2godGhpcy4kZmllbGRzTGlzdCxmdW5jdGlvbigkZmllbGQpeyRmaWVsZC5hcHBlbmRUbyhzZWxmLiQoJy5vX2N3X3BvcG92ZXJfZmllbGRzX3NlY29uZGFyeScpKTt9KTtyZXR1cm4gdGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO30sX3Byb2Nlc3NGaWVsZHM6ZnVuY3Rpb24oKXt2YXIgc2VsZj10aGlzO3ZhciBmaWVsZHNUb0dlbmVyYXRlPVtdO18uZWFjaCh0aGlzLmRpc3BsYXlGaWVsZHMsZnVuY3Rpb24oZGlzcGxheUZpZWxkSW5mbyxmaWVsZE5hbWUpe3ZhciBmaWVsZEluZm89c2VsZi5maWVsZHNbZmllbGROYW1lXTt2YXIgZmllbGQ9e25hbWU6ZmllbGROYW1lLHN0cmluZzpkaXNwbGF5RmllbGRJbmZvLmF0dHJzLnN0cmluZ3x8ZmllbGRJbmZvLnN0cmluZyx2YWx1ZTpzZWxmLmV2ZW50LnJlY29yZFtmaWVsZE5hbWVdLHR5cGU6ZmllbGRJbmZvLnR5cGUsfTtpZihmaWVsZC50eXBlPT09J3NlbGVjdGlvbicpe2ZpZWxkLnNlbGVjdGlvbj1maWVsZEluZm8uc2VsZWN0aW9uO30KaWYoZmllbGRJbmZvLnJlbGF0aW9uKXtmaWVsZC5yZWxhdGlvbj1maWVsZEluZm8ucmVsYXRpb247fQppZihkaXNwbGF5RmllbGRJbmZvLmF0dHJzLndpZGdldCl7ZmllbGQud2lkZ2V0PWRpc3BsYXlGaWVsZEluZm8uYXR0cnMud2lkZ2V0O31lbHNlIGlmKF8uY29udGFpbnMoWydtYW55Mm1hbnknLCdvbmUybWFueSddLGZpZWxkLnR5cGUpKXtmaWVsZC53aWRnZXQ9J21hbnkybWFueV90YWdzJzt9CmlmKF8uY29udGFpbnMoWydtYW55Mm1hbnknLCdvbmUybWFueSddLGZpZWxkLnR5cGUpKXtmaWVsZC5maWVsZHM9W3tuYW1lOidpZCcsdHlwZTonaW50ZWdlcicsfSx7bmFtZTonZGlzcGxheV9uYW1lJyx0eXBlOidjaGFyJyx9XTt9CmZpZWxkc1RvR2VuZXJhdGUucHVzaChmaWVsZCk7fSk7dGhpcy4kZmllbGRzTGlzdD1bXTtyZXR1cm4gdGhpcy5tb2RlbC5tYWtlUmVjb3JkKHRoaXMubW9kZWxOYW1lLGZpZWxkc1RvR2VuZXJhdGUpLnRoZW4oZnVuY3Rpb24ocmVjb3JkSUQpe3ZhciBkZWZzPVtdO3ZhciByZWNvcmQ9c2VsZi5tb2RlbC5nZXQocmVjb3JkSUQpO18uZWFjaChmaWVsZHNUb0dlbmVyYXRlLGZ1bmN0aW9uKGZpZWxkKXt2YXIgRmllbGRDbGFzcz1maWVsZFJlZ2lzdHJ5LmdldEFueShbZmllbGQud2lkZ2V0LGZpZWxkLnR5cGVdKTt2YXIgZmllbGRXaWRnZXQ9bmV3IEZpZWxkQ2xhc3Moc2VsZixmaWVsZC5uYW1lLHJlY29yZCxzZWxmLmRpc3BsYXlGaWVsZHNbZmllbGQubmFtZV0pO3NlbGYuX3JlZ2lzdGVyV2lkZ2V0KHJlY29yZElELGZpZWxkLm5hbWUsZmllbGRXaWRnZXQpO3ZhciAkZmllbGQ9JCgnPGxpPicse2NsYXNzOidsaXN0LWdyb3VwLWl0ZW0gZmxleC1zaHJpbmstMCBkLWZsZXggZmxleC13cmFwJ30pO3ZhciAkZmllbGRMYWJlbD0kKCc8c3Ryb25nPicse2NsYXNzOidtci0yJyx0ZXh0Ol8uc3RyLnNwcmludGYoJyVzIDogJyxmaWVsZC5zdHJpbmcpfSk7JGZpZWxkTGFiZWwuYXBwZW5kVG8oJGZpZWxkKTt2YXIgJGZpZWxkQ29udGFpbmVyPSQoJzxkaXY+Jyx7Y2xhc3M6J2ZsZXgtZ3Jvdy0xJ30pOyRmaWVsZENvbnRhaW5lci5hcHBlbmRUbygkZmllbGQpO2RlZnMucHVzaChmaWVsZFdpZGdldC5hcHBlbmRUbygkZmllbGRDb250YWluZXIpLnRoZW4oZnVuY3Rpb24oKXtzZWxmLiRmaWVsZHNMaXN0LnB1c2goJGZpZWxkKTt9KSk7fSk7cmV0dXJuIFByb21pc2UuYWxsKGRlZnMpO30pO30sX29uQ2xpY2tQb3BvdmVyRWRpdDpmdW5jdGlvbihldil7ZXYucHJldmVudERlZmF1bHQoKTt0aGlzLnRyaWdnZXJfdXAoJ2VkaXRfZXZlbnQnLHtpZDp0aGlzLmV2ZW50LmlkLHRpdGxlOnRoaXMuZXZlbnQucmVjb3JkLmRpc3BsYXlfbmFtZSx9KTt9LF9vbkNsaWNrUG9wb3ZlckRlbGV0ZTpmdW5jdGlvbihldil7ZXYucHJldmVudERlZmF1bHQoKTt0aGlzLnRyaWdnZXJfdXAoJ2RlbGV0ZV9ldmVudCcse2lkOnRoaXMuZXZlbnQuaWR9KTt9LH0pO3JldHVybiBDYWxlbmRhclBvcG92ZXI7fSk7OwoKLyogL3dlYi9zdGF0aWMvc3JjL2pzL3ZpZXdzL2NhbGVuZGFyL2NhbGVuZGFyX3F1aWNrX2NyZWF0ZS5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwpvZG9vLmRlZmluZSgnd2ViLkNhbGVuZGFyUXVpY2tDcmVhdGUnLGZ1bmN0aW9uKHJlcXVpcmUpeyJ1c2Ugc3RyaWN0Ijt2YXIgY29yZT1yZXF1aXJlKCd3ZWIuY29yZScpO3ZhciBEaWFsb2c9cmVxdWlyZSgnd2ViLkRpYWxvZycpO3ZhciBfdD1jb3JlLl90O3ZhciBRV2ViPWNvcmUucXdlYjt2YXIgUXVpY2tDcmVhdGU9RGlhbG9nLmV4dGVuZCh7ZXZlbnRzOl8uZXh0ZW5kKHt9LERpYWxvZy5ldmVudHMseydrZXl1cCBpbnB1dCc6J19vbmtleXVwJyx9KSxpbml0OmZ1bmN0aW9uKHBhcmVudCxidXR0b25zLG9wdGlvbnMsZGF0YVRlbXBsYXRlLGRhdGFDYWxlbmRhcil7dGhpcy5fYnV0dG9ucz1idXR0b25zfHxmYWxzZTt0aGlzLm9wdGlvbnM9b3B0aW9uczt0aGlzLmRhdGFUZW1wbGF0ZT1kYXRhVGVtcGxhdGV8fHt9O3RoaXMuZGF0YUNhbGVuZGFyPWRhdGFDYWxlbmRhcjt2YXIgc2VsZj10aGlzO3RoaXMuX3N1cGVyKHBhcmVudCx7dGl0bGU6b3B0aW9ucy50aXRsZSxzaXplOidzbWFsbCcsYnV0dG9uczp0aGlzLl9idXR0b25zP1t7dGV4dDpfdCgiQ3JlYXRlIiksY2xhc3NlczonYnRuLXByaW1hcnknLGNsaWNrOmZ1bmN0aW9uKCl7aWYoIXNlbGYuX3F1aWNrQWRkKGRhdGFDYWxlbmRhcikpe3NlbGYuZm9jdXMoKTt9fX0se3RleHQ6X3QoIkVkaXQiKSxjbGljazpmdW5jdGlvbigpe2RhdGFDYWxlbmRhci5kaXNhYmxlUXVpY2tDcmVhdGU9dHJ1ZTtkYXRhQ2FsZW5kYXIudGl0bGU9c2VsZi4kKCdpbnB1dCcpLnZhbCgpLnRyaW0oKTtkYXRhQ2FsZW5kYXIub25fc2F2ZT1zZWxmLmRlc3Ryb3kuYmluZChzZWxmKTtzZWxmLnRyaWdnZXJfdXAoJ29wZW5DcmVhdGUnLGRhdGFDYWxlbmRhcik7fX0se3RleHQ6X3QoIkNhbmNlbCIpLGNsb3NlOnRydWV9LF06W10sJGNvbnRlbnQ6UVdlYi5yZW5kZXIoJ0NhbGVuZGFyVmlldy5xdWlja19jcmVhdGUnLHt3aWRnZXQ6dGhpc30pfSk7fSxmb2N1czpmdW5jdGlvbigpe3RoaXMuJCgnaW5wdXQnKS5mb2N1cygpO30sX3F1aWNrQWRkOmZ1bmN0aW9uKGRhdGFDYWxlbmRhcil7ZGF0YUNhbGVuZGFyPSQuZXh0ZW5kKHt9LHRoaXMuZGF0YVRlbXBsYXRlLGRhdGFDYWxlbmRhcik7dmFyIHZhbD10aGlzLiQoJ2lucHV0JykudmFsKCkudHJpbSgpO2lmKCF2YWwpe3RoaXMuJCgnbGFiZWwsIGlucHV0JykuYWRkQ2xhc3MoJ29fZmllbGRfaW52YWxpZCcpO3ZhciB3YXJuaW5ncz1fLnN0ci5zcHJpbnRmKCc8dWw+PGxpPiVzPC9saT48L3VsPicsX3QoIlN1bW1hcnkiKSk7dGhpcy5kb193YXJuKF90KCJUaGUgZm9sbG93aW5nIGZpZWxkIGlzIGludmFsaWQ6Iiksd2FybmluZ3MpO30KZGF0YUNhbGVuZGFyLnRpdGxlPXZhbDtyZXR1cm4odmFsKT90aGlzLnRyaWdnZXJfdXAoJ3F1aWNrQ3JlYXRlJyx7ZGF0YTpkYXRhQ2FsZW5kYXIsb3B0aW9uczp0aGlzLm9wdGlvbnN9KTpmYWxzZTt9LF9vbmtleXVwOmZ1bmN0aW9uKGV2ZW50KXtpZih0aGlzLl9mbGFnRW50ZXIpe3JldHVybjt9CmlmKGV2ZW50LmtleUNvZGU9PT0kLnVpLmtleUNvZGUuRU5URVIpe3RoaXMuX2ZsYWdFbnRlcj10cnVlO2lmKCF0aGlzLl9xdWlja0FkZCh0aGlzLmRhdGFDYWxlbmRhcikpe3RoaXMuX2ZsYWdFbnRlcj1mYWxzZTt9fWVsc2UgaWYoZXZlbnQua2V5Q29kZT09PSQudWkua2V5Q29kZS5FU0NBUEUmJnRoaXMuX2J1dHRvbnMpe3RoaXMuY2xvc2UoKTt9fSx9KTtyZXR1cm4gUXVpY2tDcmVhdGU7fSk7OwoKLyogL3dlYi9zdGF0aWMvc3JjL2pzL3ZpZXdzL2NhbGVuZGFyL2NhbGVuZGFyX3JlbmRlcmVyLmpzIGRlZmluZWQgaW4gYnVuZGxlICd3ZWIuYXNzZXRzX2JhY2tlbmQnICovCm9kb28uZGVmaW5lKCd3ZWIuQ2FsZW5kYXJSZW5kZXJlcicsZnVuY3Rpb24ocmVxdWlyZSl7InVzZSBzdHJpY3QiO3ZhciBBYnN0cmFjdFJlbmRlcmVyPXJlcXVpcmUoJ3dlYi5BYnN0cmFjdFJlbmRlcmVyJyk7dmFyIENhbGVuZGFyUG9wb3Zlcj1yZXF1aXJlKCd3ZWIuQ2FsZW5kYXJQb3BvdmVyJyk7dmFyIGNvbmZpZz1yZXF1aXJlKCd3ZWIuY29uZmlnJyk7dmFyIGNvcmU9cmVxdWlyZSgnd2ViLmNvcmUnKTt2YXIgRGlhbG9nPXJlcXVpcmUoJ3dlYi5EaWFsb2cnKTt2YXIgZmllbGRfdXRpbHM9cmVxdWlyZSgnd2ViLmZpZWxkX3V0aWxzJyk7dmFyIEZpZWxkTWFuYWdlck1peGluPXJlcXVpcmUoJ3dlYi5GaWVsZE1hbmFnZXJNaXhpbicpO3ZhciByZWxhdGlvbmFsX2ZpZWxkcz1yZXF1aXJlKCd3ZWIucmVsYXRpb25hbF9maWVsZHMnKTt2YXIgc2Vzc2lvbj1yZXF1aXJlKCd3ZWIuc2Vzc2lvbicpO3ZhciBXaWRnZXQ9cmVxdWlyZSgnd2ViLldpZGdldCcpO3ZhciBfdD1jb3JlLl90O3ZhciBxd2ViPWNvcmUucXdlYjt2YXIgc2NhbGVzPXtkYXk6J2FnZW5kYURheScsd2VlazonYWdlbmRhV2VlaycsbW9udGg6J21vbnRoJ307dmFyIFNpZGViYXJGaWx0ZXJNMk89cmVsYXRpb25hbF9maWVsZHMuRmllbGRNYW55Mk9uZS5leHRlbmQoe19nZXRTZWFyY2hCbGFja2xpc3Q6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpLmNvbmNhdCh0aGlzLmZpbHRlcl9pZHN8fFtdKTt9LH0pO3ZhciBTaWRlYmFyRmlsdGVyPVdpZGdldC5leHRlbmQoRmllbGRNYW5hZ2VyTWl4aW4se3RlbXBsYXRlOidDYWxlbmRhclZpZXcuc2lkZWJhci5maWx0ZXInLGN1c3RvbV9ldmVudHM6Xy5leHRlbmQoe30sRmllbGRNYW5hZ2VyTWl4aW4uY3VzdG9tX2V2ZW50cyx7ZmllbGRfY2hhbmdlZDonX29uRmllbGRDaGFuZ2VkJyx9KSxpbml0OmZ1bmN0aW9uKHBhcmVudCxvcHRpb25zKXt0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7RmllbGRNYW5hZ2VyTWl4aW4uaW5pdC5jYWxsKHRoaXMpO3RoaXMudGl0bGU9b3B0aW9ucy50aXRsZTt0aGlzLmZpZWxkcz1vcHRpb25zLmZpZWxkczt0aGlzLmZpZWxkTmFtZT1vcHRpb25zLmZpZWxkTmFtZTt0aGlzLndyaXRlX21vZGVsPW9wdGlvbnMud3JpdGVfbW9kZWw7dGhpcy53cml0ZV9maWVsZD1vcHRpb25zLndyaXRlX2ZpZWxkO3RoaXMuYXZhdGFyX2ZpZWxkPW9wdGlvbnMuYXZhdGFyX2ZpZWxkO3RoaXMuYXZhdGFyX21vZGVsPW9wdGlvbnMuYXZhdGFyX21vZGVsO3RoaXMuZmlsdGVycz1vcHRpb25zLmZpbHRlcnM7dGhpcy5sYWJlbD1vcHRpb25zLmxhYmVsO3RoaXMuZ2V0Q29sb3I9b3B0aW9ucy5nZXRDb2xvcjt0aGlzLmlzU3dpcGVFbmFibGVkPXRydWU7fSx3aWxsU3RhcnQ6ZnVuY3Rpb24oKXt2YXIgc2VsZj10aGlzO3ZhciBkZWZzPVt0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyldO2lmKHRoaXMud3JpdGVfbW9kZWx8fHRoaXMud3JpdGVfZmllbGQpe3ZhciBkZWY9dGhpcy5tb2RlbC5tYWtlUmVjb3JkKHRoaXMud3JpdGVfbW9kZWwsW3tuYW1lOnRoaXMud3JpdGVfZmllbGQscmVsYXRpb246dGhpcy5maWVsZHNbdGhpcy5maWVsZE5hbWVdLnJlbGF0aW9uLHR5cGU6J21hbnkyb25lJyx9XSkudGhlbihmdW5jdGlvbihyZWNvcmRJRCl7c2VsZi5tYW55Mm9uZT1uZXcgU2lkZWJhckZpbHRlck0yTyhzZWxmLHNlbGYud3JpdGVfZmllbGQsc2VsZi5tb2RlbC5nZXQocmVjb3JkSUQpLHttb2RlOidlZGl0JyxhdHRyczp7cGxhY2Vob2xkZXI6IisgIitfLnN0ci5zcHJpbnRmKF90KCJBZGQgJXMiKSxzZWxmLnRpdGxlKSxjYW5fY3JlYXRlOmZhbHNlfSx9KTt9KTtkZWZzLnB1c2goZGVmKTt9CnJldHVybiBQcm9taXNlLmFsbChkZWZzKTt9LHN0YXJ0OmZ1bmN0aW9uKCl7dGhpcy5fc3VwZXIoKTtpZih0aGlzLm1hbnkyb25lKXt0aGlzLm1hbnkyb25lLmFwcGVuZFRvKHRoaXMuJGVsKTt0aGlzLm1hbnkyb25lLmZpbHRlcl9pZHM9Xy53aXRob3V0KF8ucGx1Y2sodGhpcy5maWx0ZXJzLCd2YWx1ZScpLCdhbGwnKTt9CnRoaXMuJGVsLm9uKCdjbGljaycsJy5vX3JlbW92ZScsdGhpcy5fb25GaWx0ZXJSZW1vdmUuYmluZCh0aGlzKSk7dGhpcy4kZWwub24oJ2NsaWNrJywnLm9fY2FsZW5kYXJfZmlsdGVyX2l0ZW1zIGlucHV0Jyx0aGlzLl9vbkZpbHRlckFjdGl2ZS5iaW5kKHRoaXMpKTt9LF9vbkZpZWxkQ2hhbmdlZDpmdW5jdGlvbihldmVudCl7dmFyIHNlbGY9dGhpcztldmVudC5zdG9wUHJvcGFnYXRpb24oKTt2YXIgY3JlYXRlVmFsdWVzPXsndXNlcl9pZCc6c2Vzc2lvbi51aWR9O3ZhciB2YWx1ZT1ldmVudC5kYXRhLmNoYW5nZXNbdGhpcy53cml0ZV9maWVsZF0uaWQ7Y3JlYXRlVmFsdWVzW3RoaXMud3JpdGVfZmllbGRdPXZhbHVlO3RoaXMuX3JwYyh7bW9kZWw6dGhpcy53cml0ZV9tb2RlbCxtZXRob2Q6J2NyZWF0ZScsYXJnczpbY3JlYXRlVmFsdWVzXSx9KS50aGVuKGZ1bmN0aW9uKCl7c2VsZi50cmlnZ2VyX3VwKCdjaGFuZ2VGaWx0ZXInLHsnZmllbGROYW1lJzpzZWxmLmZpZWxkTmFtZSwndmFsdWUnOnZhbHVlLCdhY3RpdmUnOnRydWUsfSk7fSk7fSxfb25GaWx0ZXJBY3RpdmU6ZnVuY3Rpb24oZSl7dmFyICRpbnB1dD0kKGUuY3VycmVudFRhcmdldCk7dGhpcy50cmlnZ2VyX3VwKCdjaGFuZ2VGaWx0ZXInLHsnZmllbGROYW1lJzp0aGlzLmZpZWxkTmFtZSwndmFsdWUnOiRpbnB1dC5jbG9zZXN0KCcub19jYWxlbmRhcl9maWx0ZXJfaXRlbScpLmRhdGEoJ3ZhbHVlJyksJ2FjdGl2ZSc6JGlucHV0LnByb3AoJ2NoZWNrZWQnKSx9KTt9LF9vbkZpbHRlclJlbW92ZTpmdW5jdGlvbihlKXt2YXIgc2VsZj10aGlzO3ZhciAkZmlsdGVyPSQoZS5jdXJyZW50VGFyZ2V0KS5jbG9zZXN0KCcub19jYWxlbmRhcl9maWx0ZXJfaXRlbScpO0RpYWxvZy5jb25maXJtKHRoaXMsX3QoIkRvIHlvdSByZWFsbHkgd2FudCB0byBkZWxldGUgdGhpcyBmaWx0ZXIgZnJvbSBmYXZvcml0ZXMgPyIpLHtjb25maXJtX2NhbGxiYWNrOmZ1bmN0aW9uKCl7c2VsZi5fcnBjKHttb2RlbDpzZWxmLndyaXRlX21vZGVsLG1ldGhvZDondW5saW5rJyxhcmdzOltbJGZpbHRlci5kYXRhKCdpZCcpXV0sfSkudGhlbihmdW5jdGlvbigpe3NlbGYudHJpZ2dlcl91cCgnY2hhbmdlRmlsdGVyJyx7J2ZpZWxkTmFtZSc6c2VsZi5maWVsZE5hbWUsJ2lkJzokZmlsdGVyLmRhdGEoJ2lkJyksJ2FjdGl2ZSc6ZmFsc2UsJ3ZhbHVlJzokZmlsdGVyLmRhdGEoJ3ZhbHVlJyksfSk7fSk7fSx9KTt9LH0pO3JldHVybiBBYnN0cmFjdFJlbmRlcmVyLmV4dGVuZCh7dGVtcGxhdGU6IkNhbGVuZGFyVmlldyIsY29uZmlnOntDYWxlbmRhclBvcG92ZXI6Q2FsZW5kYXJQb3BvdmVyLH0sY3VzdG9tX2V2ZW50czpfLmV4dGVuZCh7fSxBYnN0cmFjdFJlbmRlcmVyLnByb3RvdHlwZS5jdXN0b21fZXZlbnRzfHx7fSx7ZWRpdF9ldmVudDonX29uRWRpdEV2ZW50JyxkZWxldGVfZXZlbnQ6J19vbkRlbGV0ZUV2ZW50Jyx9KSxpbml0OmZ1bmN0aW9uKHBhcmVudCxzdGF0ZSxwYXJhbXMpe3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLmRpc3BsYXlGaWVsZHM9cGFyYW1zLmRpc3BsYXlGaWVsZHM7dGhpcy5tb2RlbD1wYXJhbXMubW9kZWw7dGhpcy5maWx0ZXJzPVtdO3RoaXMuY29sb3JfbWFwPXt9O3RoaXMuaGlkZURhdGU9cGFyYW1zLmhpZGVEYXRlO3RoaXMuaGlkZVRpbWU9cGFyYW1zLmhpZGVUaW1lO30sc3RhcnQ6ZnVuY3Rpb24oKXt0aGlzLl9pbml0U2lkZWJhcigpO3RoaXMuX2luaXRDYWxlbmRhcigpO2lmKGNvbmZpZy5kZXZpY2UuaXNNb2JpbGUpe3RoaXMuX2JpbmRTd2lwZSgpO30KcmV0dXJuIHRoaXMuX3N1cGVyKCk7fSxvbl9hdHRhY2hfY2FsbGJhY2s6ZnVuY3Rpb24oKXtpZihjb25maWcuZGV2aWNlLmlzTW9iaWxlKXt0aGlzLiRlbC5oZWlnaHQoJCh3aW5kb3cpLmhlaWdodCgpLXRoaXMuJGVsLm9mZnNldCgpLnRvcCk7fQp2YXIgc2Nyb2xsVG9wPXRoaXMuJGNhbGVuZGFyLmZpbmQoJy5mYy1zY3JvbGxlcicpLnNjcm9sbFRvcCgpO2lmKHNjcm9sbFRvcCl7dGhpcy4kY2FsZW5kYXIuZnVsbENhbGVuZGFyKCdyZWluaXRWaWV3Jyk7fWVsc2V7dGhpcy4kY2FsZW5kYXIuZnVsbENhbGVuZGFyKCdyZW5kZXInKTt9fSxkZXN0cm95OmZ1bmN0aW9uKCl7aWYodGhpcy4kY2FsZW5kYXIpe3RoaXMuJGNhbGVuZGFyLmZ1bGxDYWxlbmRhcignZGVzdHJveScpO30KaWYodGhpcy4kc21hbGxfY2FsZW5kYXIpe3RoaXMuJHNtYWxsX2NhbGVuZGFyLmRhdGVwaWNrZXIoJ2Rlc3Ryb3knKTskKCcjdWktZGF0ZXBpY2tlci1kaXY6ZW1wdHknKS5yZW1vdmUoKTt9CnRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9LGdldEF2YXRhcnM6ZnVuY3Rpb24ocmVjb3JkLGZpZWxkTmFtZSxpbWFnZUZpZWxkKXt2YXIgZmllbGQ9dGhpcy5zdGF0ZS5maWVsZHNbZmllbGROYW1lXTtpZighcmVjb3JkW2ZpZWxkTmFtZV0pe3JldHVybltdO30KaWYoZmllbGQudHlwZT09PSdvbmUybWFueSd8fGZpZWxkLnR5cGU9PT0nbWFueTJtYW55Jyl7cmV0dXJuIF8ubWFwKHJlY29yZFtmaWVsZE5hbWVdLGZ1bmN0aW9uKGlkKXtyZXR1cm4nPGltZyBzcmM9Ii93ZWIvaW1hZ2UvJytmaWVsZC5yZWxhdGlvbisnLycraWQrJy8nK2ltYWdlRmllbGQrJyIgLz4nO30pO31lbHNlIGlmKGZpZWxkLnR5cGU9PT0nbWFueTJvbmUnKXtyZXR1cm5bJzxpbWcgc3JjPSIvd2ViL2ltYWdlLycrZmllbGQucmVsYXRpb24rJy8nK3JlY29yZFtmaWVsZE5hbWVdWzBdKycvJytpbWFnZUZpZWxkKyciIC8+J107fWVsc2V7dmFyIHZhbHVlPXRoaXMuX2Zvcm1hdChyZWNvcmQsZmllbGROYW1lKTt2YXIgY29sb3I9dGhpcy5nZXRDb2xvcih2YWx1ZSk7aWYoaXNOYU4oY29sb3IpKXtyZXR1cm5bJzxzcGFuIGNsYXNzPSJvX2F2YXRhcl9zcXVhcmUiIHN0eWxlPSJiYWNrZ3JvdW5kLWNvbG9yOicrY29sb3IrJzsiLz4nXTt9CmVsc2V7cmV0dXJuWyc8c3BhbiBjbGFzcz0ib19hdmF0YXJfc3F1YXJlIG9fY2FsZW5kYXJfY29sb3JfJytjb2xvcisnIi8+J107fX19LGdldENvbG9yOmZ1bmN0aW9uKGtleSl7aWYoIWtleSl7cmV0dXJuO30KaWYodGhpcy5jb2xvcl9tYXBba2V5XSl7cmV0dXJuIHRoaXMuY29sb3JfbWFwW2tleV07fQppZih0eXBlb2Yga2V5PT09J3N0cmluZycmJmtleS5tYXRjaCgvXigoI1tBLUYwLTldezN9KXwoI1tBLUYwLTldezZ9KXwoKGhzbHxyZ2IpYT9cKFxzKig/OihccypcZHsxLDN9JT9ccyopLD8pezN9KFxzKixbMC05Ll17MSw0fSk/XCkpfCkkL2kpKXtyZXR1cm4gdGhpcy5jb2xvcl9tYXBba2V5XT1rZXk7fQp2YXIgaW5kZXg9KCgoXy5rZXlzKHRoaXMuY29sb3JfbWFwKS5sZW5ndGgrMSkqNSklMjQpKzE7dGhpcy5jb2xvcl9tYXBba2V5XT1pbmRleDtyZXR1cm4gaW5kZXg7fSxnZXRMb2NhbFN0YXRlOmZ1bmN0aW9uKCl7dmFyICRmY1Njcm9sbGVyPXRoaXMuJGNhbGVuZGFyLmZpbmQoJy5mYy1zY3JvbGxlcicpO3JldHVybntzY3JvbGxQb3NpdGlvbjokZmNTY3JvbGxlci5zY3JvbGxUb3AoKSx9O30sc2V0TG9jYWxTdGF0ZTpmdW5jdGlvbihsb2NhbFN0YXRlKXtpZihsb2NhbFN0YXRlLnNjcm9sbFBvc2l0aW9uKXt2YXIgJGZjU2Nyb2xsZXI9dGhpcy4kY2FsZW5kYXIuZmluZCgnLmZjLXNjcm9sbGVyJyk7JGZjU2Nyb2xsZXIuc2Nyb2xsVG9wKGxvY2FsU3RhdGUuc2Nyb2xsUG9zaXRpb24pO319LF9iaW5kU3dpcGU6ZnVuY3Rpb24oKXt2YXIgc2VsZj10aGlzO3ZhciB0b3VjaFN0YXJ0WDt2YXIgdG91Y2hFbmRYO3RoaXMuJGNhbGVuZGFyLm9uKCd0b3VjaHN0YXJ0JyxmdW5jdGlvbihldmVudCl7dG91Y2hTdGFydFg9ZXZlbnQub3JpZ2luYWxFdmVudC50b3VjaGVzWzBdLnBhZ2VYO30pO3RoaXMuJGNhbGVuZGFyLm9uKCd0b3VjaGVuZCcsZnVuY3Rpb24oZXZlbnQpe3RvdWNoRW5kWD1ldmVudC5vcmlnaW5hbEV2ZW50LmNoYW5nZWRUb3VjaGVzWzBdLnBhZ2VYO2lmKCFzZWxmLmlzU3dpcGVFbmFibGVkKXtyZXR1cm47fQppZih0b3VjaFN0YXJ0WC10b3VjaEVuZFg+MTAwKXtzZWxmLnRyaWdnZXJfdXAoJ25leHQnKTt9ZWxzZSBpZih0b3VjaFN0YXJ0WC10b3VjaEVuZFg8LTEwMCl7c2VsZi50cmlnZ2VyX3VwKCdwcmV2Jyk7fX0pO30sX2V2ZW50UmVuZGVyOmZ1bmN0aW9uKGV2ZW50KXt2YXIgcXdlYl9jb250ZXh0PXtldmVudDpldmVudCxyZWNvcmQ6ZXZlbnQucmVjb3JkLGNvbG9yOnRoaXMuZ2V0Q29sb3IoZXZlbnQuY29sb3JfaW5kZXgpLH07dGhpcy5xd2ViX2NvbnRleHQ9cXdlYl9jb250ZXh0O2lmKF8uaXNFbXB0eShxd2ViX2NvbnRleHQucmVjb3JkKSl7cmV0dXJuJyc7fWVsc2V7cmV0dXJuIHF3ZWIucmVuZGVyKCJjYWxlbmRhci1ib3giLHF3ZWJfY29udGV4dCk7fX0sX2Zvcm1hdDpmdW5jdGlvbihyZWNvcmQsZmllbGROYW1lKXt2YXIgZmllbGQ9dGhpcy5zdGF0ZS5maWVsZHNbZmllbGROYW1lXTtpZihmaWVsZC50eXBlPT09Im9uZTJtYW55Inx8ZmllbGQudHlwZT09PSJtYW55Mm1hbnkiKXtyZXR1cm4gZmllbGRfdXRpbHMuZm9ybWF0W2ZpZWxkLnR5cGVdKHtkYXRhOnJlY29yZFtmaWVsZE5hbWVdfSxmaWVsZCk7fWVsc2V7cmV0dXJuIGZpZWxkX3V0aWxzLmZvcm1hdFtmaWVsZC50eXBlXShyZWNvcmRbZmllbGROYW1lXSxmaWVsZCx7Zm9yY2VTdHJpbmc6dHJ1ZX0pO319LF9pbml0Q2FsZW5kYXI6ZnVuY3Rpb24oKXt2YXIgc2VsZj10aGlzO3RoaXMuJGNhbGVuZGFyPXRoaXMuJCgiLm9fY2FsZW5kYXJfd2lkZ2V0Iik7dmFyIGxvY2FsZT1tb21lbnQubG9jYWxlKCk7JC5mdWxsQ2FsZW5kYXIubG9jYWxlKGxvY2FsZSk7dmFyIGZjX29wdGlvbnM9JC5leHRlbmQoe30sdGhpcy5zdGF0ZS5mY19vcHRpb25zLHtldmVudERyb3A6ZnVuY3Rpb24oZXZlbnQpe3NlbGYudHJpZ2dlcl91cCgnZHJvcFJlY29yZCcsZXZlbnQpO30sZXZlbnRSZXNpemU6ZnVuY3Rpb24oZXZlbnQpe3NlbGYuX3Vuc2VsZWN0RXZlbnQoKTtzZWxmLnRyaWdnZXJfdXAoJ3VwZGF0ZVJlY29yZCcsZXZlbnQpO30sZXZlbnRDbGljazpmdW5jdGlvbihldmVudERhdGEsZXYpe3NlbGYuX3Vuc2VsZWN0RXZlbnQoKTtzZWxmLiRjYWxlbmRhci5maW5kKF8uc3RyLnNwcmludGYoJ1tkYXRhLWV2ZW50LWlkPSVzXScsZXZlbnREYXRhLmlkKSkuYWRkQ2xhc3MoJ29fY3dfY3VzdG9tX2hpZ2hsaWdodCcpO3NlbGYuX3JlbmRlckV2ZW50UG9wb3ZlcihldmVudERhdGEsJChldi5jdXJyZW50VGFyZ2V0KSk7fSxzZWxlY3Q6ZnVuY3Rpb24oc3RhcnREYXRlLGVuZERhdGUpe3NlbGYuaXNTd2lwZUVuYWJsZWQ9ZmFsc2U7aWYoc2VsZi4kKCcub19jd19wb3BvdmVyJykubGVuZ3RoKXtzZWxmLl91bnNlbGVjdEV2ZW50KCk7fWVsc2V7dmFyIGRhdGE9e3N0YXJ0OnN0YXJ0RGF0ZSxlbmQ6ZW5kRGF0ZX07aWYoc2VsZi5zdGF0ZS5jb250ZXh0LmRlZmF1bHRfbmFtZSl7ZGF0YS50aXRsZT1zZWxmLnN0YXRlLmNvbnRleHQuZGVmYXVsdF9uYW1lO30Kc2VsZi50cmlnZ2VyX3VwKCdvcGVuQ3JlYXRlJyxkYXRhKTt9CnNlbGYuJGNhbGVuZGFyLmZ1bGxDYWxlbmRhcigndW5zZWxlY3QnKTt9LGV2ZW50UmVuZGVyOmZ1bmN0aW9uKGV2ZW50LGVsZW1lbnQsdmlldyl7c2VsZi5pc1N3aXBlRW5hYmxlZD1mYWxzZTt2YXIgJHJlbmRlcj0kKHNlbGYuX2V2ZW50UmVuZGVyKGV2ZW50KSk7ZWxlbWVudC5maW5kKCcuZmMtY29udGVudCcpLmh0bWwoJHJlbmRlci5odG1sKCkpO2VsZW1lbnQuYWRkQ2xhc3MoJHJlbmRlci5hdHRyKCdjbGFzcycpKTtlbGVtZW50LmF0dHIoJ2RhdGEtZXZlbnQtaWQnLGV2ZW50LmlkKTtpZighZWxlbWVudC5maW5kKCcuZmMtYmcnKS5sZW5ndGgpe2VsZW1lbnQuZmluZCgnLmZjLWNvbnRlbnQnKS5hZnRlcigkKCc8ZGl2Lz4nLHtjbGFzczonZmMtYmcnfSkpO30KaWYodmlldy5uYW1lPT09J21vbnRoJyYmZXZlbnQucmVjb3JkKXt2YXIgc3RhcnQ9ZXZlbnQucl9zdGFydHx8ZXZlbnQuc3RhcnQ7dmFyIGVuZD1ldmVudC5yX2VuZHx8ZXZlbnQuZW5kO3ZhciBpc1NhbWVEYXlFdmVudD1zdGFydC5jbG9uZSgpLmFkZCgxLCdtaW51dGUnKS5pc1NhbWUoZW5kLmNsb25lKCkuc3VidHJhY3QoMSwnbWludXRlJyksJ2RheScpO2lmKCFldmVudC5yZWNvcmQuYWxsZGF5JiZpc1NhbWVEYXlFdmVudCl7ZWxlbWVudC5hZGRDbGFzcygnb19jd19ub2JnJyk7fX0KZWxlbWVudC5vbignZGJsY2xpY2snLGZ1bmN0aW9uKCl7c2VsZi50cmlnZ2VyX3VwKCdlZGl0X2V2ZW50Jyx7aWQ6ZXZlbnQuaWR9KTt9KTt9LGV2ZW50QWZ0ZXJBbGxSZW5kZXI6ZnVuY3Rpb24oKXtzZWxmLmlzU3dpcGVFbmFibGVkPXRydWU7fSx2aWV3UmVuZGVyOmZ1bmN0aW9uKHZpZXcpe3ZhciBtb2RlPXZpZXcubmFtZT09PSdtb250aCc/J21vbnRoJzoodmlldy5uYW1lPT09J2FnZW5kYVdlZWsnPyd3ZWVrJzonZGF5Jyk7c2VsZi50cmlnZ2VyX3VwKCd2aWV3VXBkYXRlZCcse21vZGU6bW9kZSx0aXRsZTp2aWV3LnRpdGxlLH0pO30sZXZlbnRNb3VzZW92ZXI6ZnVuY3Rpb24oZXZlbnREYXRhKXtzZWxmLiRjYWxlbmRhci5maW5kKF8uc3RyLnNwcmludGYoJ1tkYXRhLWV2ZW50LWlkPSVzXScsZXZlbnREYXRhLmlkKSkuYWRkQ2xhc3MoJ29fY3dfY3VzdG9tX2hvdmVyJyk7fSxldmVudE1vdXNlb3V0OmZ1bmN0aW9uKGV2ZW50RGF0YSl7c2VsZi4kY2FsZW5kYXIuZmluZChfLnN0ci5zcHJpbnRmKCdbZGF0YS1ldmVudC1pZD0lc10nLGV2ZW50RGF0YS5pZCkpLnJlbW92ZUNsYXNzKCdvX2N3X2N1c3RvbV9ob3ZlcicpO30sZXZlbnREcmFnU3RhcnQ6ZnVuY3Rpb24oKXtzZWxmLl91bnNlbGVjdEV2ZW50KCk7fSxldmVudFJlc2l6ZVN0YXJ0OmZ1bmN0aW9uKCl7c2VsZi5fdW5zZWxlY3RFdmVudCgpO30sZXZlbnRMaW1pdENsaWNrOmZ1bmN0aW9uKCl7c2VsZi5fdW5zZWxlY3RFdmVudCgpO3JldHVybidwb3BvdmVyJzt9LHdpbmRvd1Jlc2l6ZTpmdW5jdGlvbigpe3NlbGYuX3JlbmRlcigpO30sdmlld3M6e2RheTp7Y29sdW1uRm9ybWF0OidMTCd9LHdlZWs6e2NvbHVtbkZvcm1hdDonZGRkIEQnfSxtb250aDp7Y29sdW1uRm9ybWF0OmNvbmZpZy5kZXZpY2UuaXNNb2JpbGU/J2RkZCc6J2RkZGQnfX0saGVpZ2h0OidwYXJlbnQnLHVuc2VsZWN0QXV0bzpmYWxzZSxpc1JUTDpfdC5kYXRhYmFzZS5wYXJhbWV0ZXJzLmRpcmVjdGlvbj09PSJydGwiLGxvY2FsZTpsb2NhbGUsfSk7dGhpcy4kY2FsZW5kYXIuZnVsbENhbGVuZGFyKGZjX29wdGlvbnMpO30sX2luaXRDYWxlbmRhck1pbmk6ZnVuY3Rpb24oKXt2YXIgc2VsZj10aGlzO3RoaXMuJHNtYWxsX2NhbGVuZGFyPXRoaXMuJCgiLm9fY2FsZW5kYXJfbWluaSIpO3RoaXMuJHNtYWxsX2NhbGVuZGFyLmRhdGVwaWNrZXIoeydvblNlbGVjdCc6ZnVuY3Rpb24oZGF0dW0sb2JqKXtzZWxmLnRyaWdnZXJfdXAoJ2NoYW5nZURhdGUnLHtkYXRlOm1vbWVudChuZXcgRGF0ZSgrb2JqLmN1cnJlbnRZZWFyLCtvYmouY3VycmVudE1vbnRoLCtvYmouY3VycmVudERheSkpfSk7fSwnc2hvd090aGVyTW9udGhzJzp0cnVlLCdkYXlOYW1lc01pbic6dGhpcy5zdGF0ZS5mY19vcHRpb25zLmRheU5hbWVzU2hvcnQsJ21vbnRoTmFtZXMnOnRoaXMuc3RhdGUuZmNfb3B0aW9ucy5tb250aE5hbWVzU2hvcnQsJ2ZpcnN0RGF5Jzp0aGlzLnN0YXRlLmZjX29wdGlvbnMuZmlyc3REYXksfSk7fSxfaW5pdFNpZGViYXI6ZnVuY3Rpb24oKXt0aGlzLiRzaWRlYmFyPXRoaXMuJCgnLm9fY2FsZW5kYXJfc2lkZWJhcicpO3RoaXMuJHNpZGViYXJfY29udGFpbmVyPXRoaXMuJCgiLm9fY2FsZW5kYXJfc2lkZWJhcl9jb250YWluZXIiKTt0aGlzLl9pbml0Q2FsZW5kYXJNaW5pKCk7fSxfb25Qb3BvdmVyU2hvd246ZnVuY3Rpb24oJHBvcG92ZXJFbGVtZW50LGNhbGVuZGFyUG9wb3Zlcil7dmFyICRwb3BvdmVyPSQoJHBvcG92ZXJFbGVtZW50LmRhdGEoJ2JzLnBvcG92ZXInKS50aXApOyRwb3BvdmVyLmZpbmQoJy5vX2N3X3BvcG92ZXJfY2xvc2UnKS5vbignY2xpY2snLHRoaXMuX3Vuc2VsZWN0RXZlbnQuYmluZCh0aGlzKSk7JHBvcG92ZXIuZmluZCgnLm9fY3dfYm9keScpLnJlcGxhY2VXaXRoKGNhbGVuZGFyUG9wb3Zlci4kZWwpO30sX3JlbmRlcjpmdW5jdGlvbigpe3ZhciAkY2FsZW5kYXI9dGhpcy4kY2FsZW5kYXI7dmFyICRmY192aWV3PSRjYWxlbmRhci5maW5kKCcuZmMtdmlldycpO3ZhciBzY3JvbGxQb3NpdGlvbj0kZmNfdmlldy5zY3JvbGxMZWZ0KCk7JGZjX3ZpZXcuc2Nyb2xsTGVmdCgwKTskY2FsZW5kYXIuZnVsbENhbGVuZGFyKCd1bnNlbGVjdCcpO2lmKHNjYWxlc1t0aGlzLnN0YXRlLnNjYWxlXSE9PSRjYWxlbmRhci5kYXRhKCdmdWxsQ2FsZW5kYXInKS5nZXRWaWV3KCkudHlwZSl7JGNhbGVuZGFyLmZ1bGxDYWxlbmRhcignY2hhbmdlVmlldycsc2NhbGVzW3RoaXMuc3RhdGUuc2NhbGVdKTt9CmlmKHRoaXMudGFyZ2V0X2RhdGUhPT10aGlzLnN0YXRlLnRhcmdldF9kYXRlLnRvU3RyaW5nKCkpeyRjYWxlbmRhci5mdWxsQ2FsZW5kYXIoJ2dvdG9EYXRlJyxtb21lbnQodGhpcy5zdGF0ZS50YXJnZXRfZGF0ZSkpO3RoaXMudGFyZ2V0X2RhdGU9dGhpcy5zdGF0ZS50YXJnZXRfZGF0ZS50b1N0cmluZygpO30KdGhpcy4kc21hbGxfY2FsZW5kYXIuZGF0ZXBpY2tlcigic2V0RGF0ZSIsdGhpcy5zdGF0ZS5oaWdobGlnaHRfZGF0ZS50b0RhdGUoKSkuZmluZCgnLm9fc2VsZWN0ZWRfcmFuZ2UnKS5yZW1vdmVDbGFzcygnb19jb2xvciBvX3NlbGVjdGVkX3JhbmdlJyk7dmFyICRhO3N3aXRjaCh0aGlzLnN0YXRlLnNjYWxlKXtjYXNlJ21vbnRoJzokYT10aGlzLiRzbWFsbF9jYWxlbmRhci5maW5kKCd0ZCcpO2JyZWFrO2Nhc2Und2Vlayc6JGE9dGhpcy4kc21hbGxfY2FsZW5kYXIuZmluZCgndHI6aGFzKC51aS1zdGF0ZS1hY3RpdmUpJyk7YnJlYWs7Y2FzZSdkYXknOiRhPXRoaXMuJHNtYWxsX2NhbGVuZGFyLmZpbmQoJ2EudWktc3RhdGUtYWN0aXZlJyk7YnJlYWs7fQokYS5hZGRDbGFzcygnb19zZWxlY3RlZF9yYW5nZScpO3NldFRpbWVvdXQoZnVuY3Rpb24oKXskYS5ub3QoJy51aS1zdGF0ZS1hY3RpdmUnKS5hZGRDbGFzcygnb19jb2xvcicpO30pOyRmY192aWV3LnNjcm9sbExlZnQoc2Nyb2xsUG9zaXRpb24pO3RoaXMuX3Vuc2VsZWN0RXZlbnQoKTt2YXIgZmlsdGVyUHJvbT10aGlzLl9yZW5kZXJGaWx0ZXJzKCk7dGhpcy5fcmVuZGVyRXZlbnRzKCk7dGhpcy4kY2FsZW5kYXIucHJlcGVuZFRvKHRoaXMuJCgnLm9fY2FsZW5kYXJfdmlldycpKTtyZXR1cm4gUHJvbWlzZS5hbGwoW2ZpbHRlclByb20sdGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpXSk7fSxfcmVuZGVyRXZlbnRzOmZ1bmN0aW9uKCl7dGhpcy4kY2FsZW5kYXIuZnVsbENhbGVuZGFyKCdyZW1vdmVFdmVudHMnKTt0aGlzLiRjYWxlbmRhci5mdWxsQ2FsZW5kYXIoJ2FkZEV2ZW50U291cmNlJyx0aGlzLnN0YXRlLmRhdGEpO30sX3JlbmRlckZpbHRlcnM6ZnVuY3Rpb24oKXt0aGlzLiQoJy5vX2NhbGVuZGFyX2ZpbHRlcl9pdGVtJykucG9wb3ZlcignZGlzcG9zZScpO18uZWFjaCh0aGlzLmZpbHRlcnN8fCh0aGlzLmZpbHRlcnM9W10pLGZ1bmN0aW9uKGZpbHRlcil7ZmlsdGVyLmRlc3Ryb3koKTt9KTtpZih0aGlzLnN0YXRlLmZ1bGxXaWR0aCl7cmV0dXJuO30KcmV0dXJuIHRoaXMuX3JlbmRlckZpbHRlcnNPbmVCeU9uZSgpO30sX3JlbmRlckZpbHRlcnNPbmVCeU9uZTpmdW5jdGlvbihmaWx0ZXJJbmRleCl7ZmlsdGVySW5kZXg9ZmlsdGVySW5kZXh8fDA7dmFyIGFyckZpbHRlcnM9Xy50b0FycmF5KHRoaXMuc3RhdGUuZmlsdGVycyk7dmFyIHByb207aWYoZmlsdGVySW5kZXg8YXJyRmlsdGVycy5sZW5ndGgpe3ZhciBvcHRpb25zPWFyckZpbHRlcnNbZmlsdGVySW5kZXhdO2lmKCFfLmZpbmQob3B0aW9ucy5maWx0ZXJzLGZ1bmN0aW9uKGYpe3JldHVybiBmLmRpc3BsYXk9PW51bGx8fGYuZGlzcGxheTt9KSl7cmV0dXJuO30KdmFyIHNlbGY9dGhpcztvcHRpb25zLmdldENvbG9yPXRoaXMuZ2V0Q29sb3IuYmluZCh0aGlzKTtvcHRpb25zLmZpZWxkcz10aGlzLnN0YXRlLmZpZWxkczt2YXIgZmlsdGVyPW5ldyBTaWRlYmFyRmlsdGVyKHNlbGYsb3B0aW9ucyk7cHJvbT1maWx0ZXIuYXBwZW5kVG8odGhpcy4kc2lkZWJhcikudGhlbihmdW5jdGlvbigpe2lmKG9wdGlvbnMuYXZhdGFyX2ZpZWxkKXtfLmVhY2gob3B0aW9ucy5maWx0ZXJzLGZ1bmN0aW9uKGZpbHRlcil7aWYoZmlsdGVyLnZhbHVlIT09J2FsbCcpe3ZhciBzZWxlY3Rvcj1fLnN0ci5zcHJpbnRmKCcub19jYWxlbmRhcl9maWx0ZXJfaXRlbVtkYXRhLXZhbHVlPSVzXScsZmlsdGVyLnZhbHVlKTtzZWxmLiRzaWRlYmFyLmZpbmQoc2VsZWN0b3IpLnBvcG92ZXIoe2FuaW1hdGlvbjpmYWxzZSx0cmlnZ2VyOidob3ZlcicsaHRtbDp0cnVlLHBsYWNlbWVudDondG9wJyx0aXRsZTpmaWx0ZXIubGFiZWwsZGVsYXk6e3Nob3c6MzAwLGhpZGU6MH0sY29udGVudDpmdW5jdGlvbigpe3JldHVybiAkKCc8aW1nPicse3NyYzpfLnN0ci5zcHJpbnRmKCcvd2ViL2ltYWdlLyVzLyVzLyVzJyxvcHRpb25zLmF2YXRhcl9tb2RlbCxmaWx0ZXIudmFsdWUsb3B0aW9ucy5hdmF0YXJfZmllbGQpLGNsYXNzOidteC1hdXRvJyx9KTt9LH0pO319KTt9CnJldHVybiBzZWxmLl9yZW5kZXJGaWx0ZXJzT25lQnlPbmUoZmlsdGVySW5kZXgrMSk7fSk7dGhpcy5maWx0ZXJzLnB1c2goZmlsdGVyKTt9CnJldHVybiBQcm9taXNlLnJlc29sdmUocHJvbSk7fSxfZ2V0UG9wb3ZlckNvbnRleHQ6ZnVuY3Rpb24oZXZlbnREYXRhKXt2YXIgY29udGV4dD17aGlkZURhdGU6dGhpcy5oaWRlRGF0ZSxoaWRlVGltZTp0aGlzLmhpZGVUaW1lLGV2ZW50VGltZTp7fSxldmVudERhdGU6e30sZmllbGRzOnRoaXMuc3RhdGUuZmllbGRzLGRpc3BsYXlGaWVsZHM6dGhpcy5kaXNwbGF5RmllbGRzLGV2ZW50OmV2ZW50RGF0YSxtb2RlbE5hbWU6dGhpcy5tb2RlbCx9O3ZhciBzdGFydD1tb21lbnQoZXZlbnREYXRhLnJfc3RhcnR8fGV2ZW50RGF0YS5zdGFydCk7dmFyIGVuZD1tb21lbnQoZXZlbnREYXRhLnJfZW5kfHxldmVudERhdGEuZW5kKTt2YXIgaXNTYW1lRGF5RXZlbnQ9c3RhcnQuY2xvbmUoKS5hZGQoMSwnbWludXRlJykuaXNTYW1lKGVuZC5jbG9uZSgpLnN1YnRyYWN0KDEsJ21pbnV0ZScpLCdkYXknKTtpZighdGhpcy5oaWRlVGltZSYmIWV2ZW50RGF0YS5yZWNvcmQuYWxsZGF5JiZpc1NhbWVEYXlFdmVudCl7dmFyIGRiVGltZUZvcm1hdD1fdC5kYXRhYmFzZS5wYXJhbWV0ZXJzLnRpbWVfZm9ybWF0LnNlYXJjaCgnJUgnKSE9LTE/J0hIOm1tJzonaGg6bW0gYSc7Y29udGV4dC5ldmVudFRpbWUudGltZT1zdGFydC5jbG9uZSgpLmZvcm1hdChkYlRpbWVGb3JtYXQpKycgLSAnK2VuZC5jbG9uZSgpLmZvcm1hdChkYlRpbWVGb3JtYXQpO3ZhciBkdXJhdGlvbkhvdXJzPW1vbWVudC5kdXJhdGlvbihlbmQuZGlmZihzdGFydCkpLmhvdXJzKCk7dmFyIGR1cmF0aW9uSG91cnNLZXk9KGR1cmF0aW9uSG91cnM9PT0xKT8naCc6J2hoJzt2YXIgZHVyYXRpb25NaW51dGVzPW1vbWVudC5kdXJhdGlvbihlbmQuZGlmZihzdGFydCkpLm1pbnV0ZXMoKTt2YXIgZHVyYXRpb25NaW51dGVzS2V5PShkdXJhdGlvbk1pbnV0ZXM9PT0xKT8nbSc6J21tJzt2YXIgbG9jYWxlRGF0YT1tb21lbnQubG9jYWxlRGF0YSgpO2NvbnRleHQuZXZlbnRUaW1lLmR1cmF0aW9uPShkdXJhdGlvbkhvdXJzPjA/bG9jYWxlRGF0YS5yZWxhdGl2ZVRpbWUoZHVyYXRpb25Ib3Vycyx0cnVlLGR1cmF0aW9uSG91cnNLZXkpOicnKQorKGR1cmF0aW9uSG91cnM+MCYmZHVyYXRpb25NaW51dGVzPjA/JywgJzonJykKKyhkdXJhdGlvbk1pbnV0ZXM+MD9sb2NhbGVEYXRhLnJlbGF0aXZlVGltZShkdXJhdGlvbk1pbnV0ZXMsdHJ1ZSxkdXJhdGlvbk1pbnV0ZXNLZXkpOicnKTt9CmlmKCF0aGlzLmhpZGVEYXRlKXtpZighaXNTYW1lRGF5RXZlbnQmJnN0YXJ0LmlzU2FtZShlbmQsJ21vbnRoJykpe2NvbnRleHQuZXZlbnREYXRlLmRhdGU9c3RhcnQuY2xvbmUoKS5mb3JtYXQoJ01NTU0gRCcpKyctJytlbmQuY2xvbmUoKS5mb3JtYXQoJ0QsIFlZWVknKTt9ZWxzZXtjb250ZXh0LmV2ZW50RGF0ZS5kYXRlPWlzU2FtZURheUV2ZW50P3N0YXJ0LmNsb25lKCkuZm9ybWF0KCdkZGRkLCBMTCcpOnN0YXJ0LmNsb25lKCkuZm9ybWF0KCdMTCcpKycgLSAnK2VuZC5jbG9uZSgpLmZvcm1hdCgnTEwnKTt9CmlmKGV2ZW50RGF0YS5yZWNvcmQuYWxsZGF5JiZpc1NhbWVEYXlFdmVudCl7Y29udGV4dC5ldmVudERhdGUuZHVyYXRpb249X3QoIkFsbCBkYXkiKTt9ZWxzZSBpZihldmVudERhdGEucmVjb3JkLmFsbGRheSYmIWlzU2FtZURheUV2ZW50KXt2YXIgZGF5c0xvY2FsZURhdGE9bW9tZW50LmxvY2FsZURhdGEoKTt2YXIgZGF5cz1tb21lbnQuZHVyYXRpb24oZW5kLmRpZmYoc3RhcnQpKS5kYXlzKCk7Y29udGV4dC5ldmVudERhdGUuZHVyYXRpb249ZGF5c0xvY2FsZURhdGEucmVsYXRpdmVUaW1lKGRheXMsdHJ1ZSwnZGQnKTt9fQpyZXR1cm4gY29udGV4dDt9LF9nZXRQb3BvdmVyUGFyYW1zOmZ1bmN0aW9uKGV2ZW50RGF0YSl7cmV0dXJue2FuaW1hdGlvbjpmYWxzZSxkZWxheTp7c2hvdzo1MCxoaWRlOjEwMH0sdHJpZ2dlcjonbWFudWFsJyxodG1sOnRydWUsdGl0bGU6ZXZlbnREYXRhLnJlY29yZC5kaXNwbGF5X25hbWUsdGVtcGxhdGU6cXdlYi5yZW5kZXIoJ0NhbGVuZGFyVmlldy5ldmVudC5wb3BvdmVyLnBsYWNlaG9sZGVyJyx7Y29sb3I6dGhpcy5nZXRDb2xvcihldmVudERhdGEuY29sb3JfaW5kZXgpfSksY29udGFpbmVyOmV2ZW50RGF0YS5hbGxEYXk/Jy5mYy12aWV3JzonLmZjLXNjcm9sbGVyJyx9fSxfcmVuZGVyRXZlbnRQb3BvdmVyOmZ1bmN0aW9uKGV2ZW50RGF0YSwkZXZlbnRFbGVtZW50KXt2YXIgc2VsZj10aGlzO3ZhciBjYWxlbmRhclBvcG92ZXI9bmV3IHNlbGYuY29uZmlnLkNhbGVuZGFyUG9wb3ZlcihzZWxmLHNlbGYuX2dldFBvcG92ZXJDb250ZXh0KGV2ZW50RGF0YSkpO2NhbGVuZGFyUG9wb3Zlci5hcHBlbmRUbygkKCc8ZGl2PicpKS50aGVuKCgpPT57JGV2ZW50RWxlbWVudC5wb3BvdmVyKHNlbGYuX2dldFBvcG92ZXJQYXJhbXMoZXZlbnREYXRhKSkub24oJ3Nob3duLmJzLnBvcG92ZXInLGZ1bmN0aW9uKCl7c2VsZi5fb25Qb3BvdmVyU2hvd24oJCh0aGlzKSxjYWxlbmRhclBvcG92ZXIpO30pLnBvcG92ZXIoJ3Nob3cnKTt9KTt9LF91bnNlbGVjdEV2ZW50OmZ1bmN0aW9uKCl7dGhpcy4kKCcuZmMtZXZlbnQnKS5yZW1vdmVDbGFzcygnb19jd19jdXN0b21faGlnaGxpZ2h0Jyk7dGhpcy4kKCcub19jd19wb3BvdmVyJykucG9wb3ZlcignZGlzcG9zZScpO30sX29uRWRpdEV2ZW50OmZ1bmN0aW9uKGV2ZW50KXt0aGlzLl91bnNlbGVjdEV2ZW50KCk7dGhpcy50cmlnZ2VyX3VwKCdvcGVuRXZlbnQnLHtfaWQ6ZXZlbnQuZGF0YS5pZCx0aXRsZTpldmVudC5kYXRhLnRpdGxlLH0pO30sX29uRGVsZXRlRXZlbnQ6ZnVuY3Rpb24oZXZlbnQpe3RoaXMuX3Vuc2VsZWN0RXZlbnQoKTt0aGlzLnRyaWdnZXJfdXAoJ2RlbGV0ZVJlY29yZCcse2lkOmV2ZW50LmRhdGEuaWR9KTt9LH0pO30pOzsKCi8qIC93ZWIvc3RhdGljL3NyYy9qcy92aWV3cy9jYWxlbmRhci9jYWxlbmRhcl92aWV3LmpzIGRlZmluZWQgaW4gYnVuZGxlICd3ZWIuYXNzZXRzX2JhY2tlbmQnICovCm9kb28uZGVmaW5lKCd3ZWIuQ2FsZW5kYXJWaWV3JyxmdW5jdGlvbihyZXF1aXJlKXsidXNlIHN0cmljdCI7dmFyIEFic3RyYWN0Vmlldz1yZXF1aXJlKCd3ZWIuQWJzdHJhY3RWaWV3Jyk7dmFyIENhbGVuZGFyTW9kZWw9cmVxdWlyZSgnd2ViLkNhbGVuZGFyTW9kZWwnKTt2YXIgQ2FsZW5kYXJDb250cm9sbGVyPXJlcXVpcmUoJ3dlYi5DYWxlbmRhckNvbnRyb2xsZXInKTt2YXIgQ2FsZW5kYXJSZW5kZXJlcj1yZXF1aXJlKCd3ZWIuQ2FsZW5kYXJSZW5kZXJlcicpO3ZhciBjb3JlPXJlcXVpcmUoJ3dlYi5jb3JlJyk7dmFyIHB5VXRpbHM9cmVxdWlyZSgnd2ViLnB5X3V0aWxzJyk7dmFyIHV0aWxzPXJlcXVpcmUoJ3dlYi51dGlscycpO3ZhciBfbHQ9Y29yZS5fbHQ7dmFyIGZpZWxkc1RvR2F0aGVyPVsiZGF0ZV9zdGFydCIsImRhdGVfZGVsYXkiLCJkYXRlX3N0b3AiLCJhbGxfZGF5IixdO3ZhciBDYWxlbmRhclZpZXc9QWJzdHJhY3RWaWV3LmV4dGVuZCh7ZGlzcGxheV9uYW1lOl9sdCgnQ2FsZW5kYXInKSxpY29uOidmYS1jYWxlbmRhcicsanNMaWJzOlsnL3dlYi9zdGF0aWMvbGliL2Z1bGxjYWxlbmRhci9qcy9mdWxsY2FsZW5kYXIuanMnXSxjc3NMaWJzOlsnL3dlYi9zdGF0aWMvbGliL2Z1bGxjYWxlbmRhci9jc3MvZnVsbGNhbGVuZGFyLmNzcyddLGNvbmZpZzpfLmV4dGVuZCh7fSxBYnN0cmFjdFZpZXcucHJvdG90eXBlLmNvbmZpZyx7TW9kZWw6Q2FsZW5kYXJNb2RlbCxDb250cm9sbGVyOkNhbGVuZGFyQ29udHJvbGxlcixSZW5kZXJlcjpDYWxlbmRhclJlbmRlcmVyLH0pLHZpZXdUeXBlOidjYWxlbmRhcicsc2VhcmNoTWVudVR5cGVzOlsnZmlsdGVyJywnZmF2b3JpdGUnXSxpbml0OmZ1bmN0aW9uKHZpZXdJbmZvLHBhcmFtcyl7dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3ZhciBhcmNoPXRoaXMuYXJjaDt2YXIgZmllbGRzPXRoaXMuZmllbGRzO3ZhciBhdHRycz1hcmNoLmF0dHJzO2lmKCFhdHRycy5kYXRlX3N0YXJ0KXt0aHJvdyBuZXcgRXJyb3IoX2x0KCJDYWxlbmRhciB2aWV3IGhhcyBub3QgZGVmaW5lZCAnZGF0ZV9zdGFydCcgYXR0cmlidXRlLiIpKTt9CnZhciBtYXBwaW5nPXt9O3ZhciBmaWVsZE5hbWVzPWZpZWxkcy5kaXNwbGF5X25hbWU/WydkaXNwbGF5X25hbWUnXTpbXTt2YXIgZGlzcGxheUZpZWxkcz17fTtfLmVhY2goZmllbGRzVG9HYXRoZXIsZnVuY3Rpb24oZmllbGQpe2lmKGFyY2guYXR0cnNbZmllbGRdKXt2YXIgZmllbGROYW1lPWF0dHJzW2ZpZWxkXTttYXBwaW5nW2ZpZWxkXT1maWVsZE5hbWU7ZmllbGROYW1lcy5wdXNoKGZpZWxkTmFtZSk7fX0pO3ZhciBmaWx0ZXJzPXt9O3ZhciBldmVudExpbWl0PWF0dHJzLmV2ZW50X2xpbWl0IT09bnVsbCYmKGlzTmFOKCthdHRycy5ldmVudF9saW1pdCk/Xy5zdHIudG9Cb29sKGF0dHJzLmV2ZW50X2xpbWl0KTorYXR0cnMuZXZlbnRfbGltaXQpO3ZhciBtb2RlbEZpbHRlcnM9W107Xy5lYWNoKGFyY2guY2hpbGRyZW4sZnVuY3Rpb24oY2hpbGQpe2lmKGNoaWxkLnRhZyE9PSdmaWVsZCcpcmV0dXJuO3ZhciBmaWVsZE5hbWU9Y2hpbGQuYXR0cnMubmFtZTtmaWVsZE5hbWVzLnB1c2goZmllbGROYW1lKTtpZighY2hpbGQuYXR0cnMuaW52aXNpYmxlKXtjaGlsZC5hdHRycy5vcHRpb25zPWNoaWxkLmF0dHJzLm9wdGlvbnM/cHlVdGlscy5weV9ldmFsKGNoaWxkLmF0dHJzLm9wdGlvbnMpOnt9O2Rpc3BsYXlGaWVsZHNbZmllbGROYW1lXT17YXR0cnM6Y2hpbGQuYXR0cnN9O2lmKHBhcmFtcy5zaWRlYmFyPT09ZmFsc2UpcmV0dXJuO2lmKGNoaWxkLmF0dHJzLmF2YXRhcl9maWVsZCl7ZmlsdGVyc1tmaWVsZE5hbWVdPWZpbHRlcnNbZmllbGROYW1lXXx8eyd0aXRsZSc6ZmllbGRzW2ZpZWxkTmFtZV0uc3RyaW5nLCdmaWVsZE5hbWUnOmZpZWxkTmFtZSwnZmlsdGVycyc6W10sfTtmaWx0ZXJzW2ZpZWxkTmFtZV0uYXZhdGFyX2ZpZWxkPWNoaWxkLmF0dHJzLmF2YXRhcl9maWVsZDtmaWx0ZXJzW2ZpZWxkTmFtZV0uYXZhdGFyX21vZGVsPWZpZWxkc1tmaWVsZE5hbWVdLnJlbGF0aW9uO30KaWYoY2hpbGQuYXR0cnMud3JpdGVfbW9kZWwpe2ZpbHRlcnNbZmllbGROYW1lXT1maWx0ZXJzW2ZpZWxkTmFtZV18fHsndGl0bGUnOmZpZWxkc1tmaWVsZE5hbWVdLnN0cmluZywnZmllbGROYW1lJzpmaWVsZE5hbWUsJ2ZpbHRlcnMnOltdLH07ZmlsdGVyc1tmaWVsZE5hbWVdLndyaXRlX21vZGVsPWNoaWxkLmF0dHJzLndyaXRlX21vZGVsO2ZpbHRlcnNbZmllbGROYW1lXS53cml0ZV9maWVsZD1jaGlsZC5hdHRycy53cml0ZV9maWVsZDttb2RlbEZpbHRlcnMucHVzaChmaWVsZHNbZmllbGROYW1lXS5yZWxhdGlvbik7fX19KTtpZihhdHRycy5jb2xvcil7dmFyIGZpZWxkTmFtZT1hdHRycy5jb2xvcjtmaWVsZE5hbWVzLnB1c2goZmllbGROYW1lKTtmaWx0ZXJzW2ZpZWxkTmFtZV09eyd0aXRsZSc6ZmllbGRzW2ZpZWxkTmFtZV0uc3RyaW5nLCdmaWVsZE5hbWUnOmZpZWxkTmFtZSwnZmlsdGVycyc6W10sfTtpZihmaWVsZHNbZmllbGROYW1lXS5yZWxhdGlvbil7aWYoWydyZXMudXNlcnMnLCdyZXMucGFydG5lcicsJ2hyLmVtcGxveWVlJ10uaW5kZXhPZihmaWVsZHNbZmllbGROYW1lXS5yZWxhdGlvbikhPT0tMSl7ZmlsdGVyc1tmaWVsZE5hbWVdLmF2YXRhcl9maWVsZD0naW1hZ2VfMTI4Jzt9CmZpbHRlcnNbZmllbGROYW1lXS5hdmF0YXJfbW9kZWw9ZmllbGRzW2ZpZWxkTmFtZV0ucmVsYXRpb247fX0KdGhpcy5jb250cm9sbGVyUGFyYW1zLnF1aWNrQWRkUG9wPSghKCdxdWlja19hZGQnaW4gYXR0cnMpfHx1dGlscy50b0Jvb2xFbHNlKGF0dHJzLnF1aWNrX2FkZCsnJyx0cnVlKSk7dGhpcy5jb250cm9sbGVyUGFyYW1zLmRpc2FibGVRdWlja0NyZWF0ZT1wYXJhbXMuZGlzYWJsZV9xdWlja19jcmVhdGV8fCF0aGlzLmNvbnRyb2xsZXJQYXJhbXMucXVpY2tBZGRQb3A7dGhpcy5jb250cm9sbGVyUGFyYW1zLmZvcm1WaWV3SWQ9YXR0cnMuZm9ybV92aWV3X2lkP3BhcnNlSW50KGF0dHJzLmZvcm1fdmlld19pZCwxMCk6ZmFsc2U7aWYoIXRoaXMuY29udHJvbGxlclBhcmFtcy5mb3JtVmlld0lkJiZwYXJhbXMuYWN0aW9uKXt2YXIgZm9ybVZpZXdEZXNjcj1fLmZpbmQocGFyYW1zLmFjdGlvbi52aWV3cyxmdW5jdGlvbih2KXtyZXR1cm4gdi50eXBlPT09J2Zvcm0nO30pO2lmKGZvcm1WaWV3RGVzY3Ipe3RoaXMuY29udHJvbGxlclBhcmFtcy5mb3JtVmlld0lkPWZvcm1WaWV3RGVzY3Iudmlld0lEO319CnRoaXMuY29udHJvbGxlclBhcmFtcy5ldmVudE9wZW5Qb3B1cD11dGlscy50b0Jvb2xFbHNlKGF0dHJzLmV2ZW50X29wZW5fcG9wdXB8fCcnLGZhbHNlKTt0aGlzLmNvbnRyb2xsZXJQYXJhbXMubWFwcGluZz1tYXBwaW5nO3RoaXMuY29udHJvbGxlclBhcmFtcy5jb250ZXh0PXBhcmFtcy5jb250ZXh0fHx7fTt0aGlzLmNvbnRyb2xsZXJQYXJhbXMuZGlzcGxheU5hbWU9cGFyYW1zLmFjdGlvbiYmcGFyYW1zLmFjdGlvbi5uYW1lO3RoaXMucmVuZGVyZXJQYXJhbXMuZGlzcGxheUZpZWxkcz1kaXNwbGF5RmllbGRzO3RoaXMucmVuZGVyZXJQYXJhbXMubW9kZWw9dmlld0luZm8ubW9kZWw7dGhpcy5yZW5kZXJlclBhcmFtcy5oaWRlRGF0ZT11dGlscy50b0Jvb2xFbHNlKGF0dHJzLmhpZGVfZGF0ZXx8JycsZmFsc2UpO3RoaXMucmVuZGVyZXJQYXJhbXMuaGlkZVRpbWU9dXRpbHMudG9Cb29sRWxzZShhdHRycy5oaWRlX3RpbWV8fCcnLGZhbHNlKTt0aGlzLmxvYWRQYXJhbXMuZmllbGROYW1lcz1fLnVuaXEoZmllbGROYW1lcyk7dGhpcy5sb2FkUGFyYW1zLm1hcHBpbmc9bWFwcGluZzt0aGlzLmxvYWRQYXJhbXMuZmllbGRzPWZpZWxkczt0aGlzLmxvYWRQYXJhbXMuZmllbGRzSW5mbz12aWV3SW5mby5maWVsZHNJbmZvO3RoaXMubG9hZFBhcmFtcy5lZGl0YWJsZT0hZmllbGRzW21hcHBpbmcuZGF0ZV9zdGFydF0ucmVhZG9ubHk7dGhpcy5sb2FkUGFyYW1zLmNyZWF0YWJsZT10cnVlO3RoaXMubG9hZFBhcmFtcy5ldmVudExpbWl0PWV2ZW50TGltaXQ7dGhpcy5sb2FkUGFyYW1zLmZpZWxkQ29sb3I9YXR0cnMuY29sb3I7dGhpcy5sb2FkUGFyYW1zLmZpbHRlcnM9ZmlsdGVyczt0aGlzLmxvYWRQYXJhbXMubW9kZT0ocGFyYW1zLmNvbnRleHQmJnBhcmFtcy5jb250ZXh0LmRlZmF1bHRfbW9kZSl8fGF0dHJzLm1vZGU7dGhpcy5sb2FkUGFyYW1zLmluaXRpYWxEYXRlPW1vbWVudChwYXJhbXMuaW5pdGlhbERhdGV8fG5ldyBEYXRlKCkpO30sfSk7cmV0dXJuIENhbGVuZGFyVmlldzt9KTs7CgovKiAvd2ViL3N0YXRpYy9zcmMvanMvdmlld3MvcXdlYi9xd2ViX3ZpZXcuanMgZGVmaW5lZCBpbiBidW5kbGUgJ3dlYi5hc3NldHNfYmFja2VuZCcgKi8Kb2Rvby5kZWZpbmUoJ3dlYi5xd2ViJyxmdW5jdGlvbihyZXF1aXJlKXsidXNlIHN0cmljdCI7dmFyIGNvcmU9cmVxdWlyZSgnd2ViLmNvcmUnKTt2YXIgQWJzdHJhY3RWaWV3PXJlcXVpcmUoJ3dlYi5BYnN0cmFjdFZpZXcnKTt2YXIgQWJzdHJhY3RNb2RlbD1yZXF1aXJlKCd3ZWIuQWJzdHJhY3RNb2RlbCcpO3ZhciBBYnN0cmFjdFJlbmRlcmVyPXJlcXVpcmUoJ3dlYi5BYnN0cmFjdFJlbmRlcmVyJyk7dmFyIEFic3RyYWN0Q29udHJvbGxlcj1yZXF1aXJlKCd3ZWIuQWJzdHJhY3RDb250cm9sbGVyJyk7dmFyIHJlZ2lzdHJ5PXJlcXVpcmUoJ3dlYi52aWV3X3JlZ2lzdHJ5Jyk7dmFyIF9sdD1jb3JlLl9sdDt2YXIgTW9kZWw9QWJzdHJhY3RNb2RlbC5leHRlbmQoe2luaXQ6ZnVuY3Rpb24oKXt0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy5fc3RhdGU9e3ZpZXdJZDpmYWxzZSxtb2RlbE5hbWU6ZmFsc2UsYm9keTonJyxjb250ZXh0Ont9LGRvbWFpbjpbXSx9O30sX2ZldGNoOmZ1bmN0aW9uKCl7dmFyIHN0YXRlPXRoaXMuX3N0YXRlO3JldHVybiB0aGlzLl9ycGMoe21vZGVsOnN0YXRlLm1vZGVsTmFtZSxtZXRob2Q6J3F3ZWJfcmVuZGVyX3ZpZXcnLGt3YXJnczp7dmlld19pZDpzdGF0ZS52aWV3SWQsZG9tYWluOnN0YXRlLmRvbWFpbixjb250ZXh0OnN0YXRlLmNvbnRleHR9fSkudGhlbihmdW5jdGlvbihyKXtzdGF0ZS5ib2R5PXI7cmV0dXJuIHN0YXRlLnZpZXdJZDt9KTt9LGdldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9zdGF0ZTt9LGxvYWQ6ZnVuY3Rpb24ocGFyYW1zKXtfLmV4dGVuZCh0aGlzLl9zdGF0ZSxfLnBpY2socGFyYW1zLFsndmlld0lkJywnbW9kZWxOYW1lJywnZG9tYWluJywnY29udGV4dCddKSk7cmV0dXJuIHRoaXMuX2ZldGNoKCk7fSxyZWxvYWQ6ZnVuY3Rpb24oX2lkLHBhcmFtcyl7Xy5leHRlbmQodGhpcy5fc3RhdGUsXy5waWNrKHBhcmFtcyxbJ2RvbWFpbicsJ2NvbnRleHQnXSkpO3JldHVybiB0aGlzLl9mZXRjaCgpO319KTt2YXIgUmVuZGVyZXI9QWJzdHJhY3RSZW5kZXJlci5leHRlbmQoe19yZW5kZXI6ZnVuY3Rpb24oKXt2YXIgc2VsZj10aGlzO3JldHVybiB0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cykudGhlbihmdW5jdGlvbigpe3NlbGYuJGVsLmh0bWwoc2VsZi5zdGF0ZS5ib2R5KTt9KTt9fSk7dmFyIENvbnRyb2xsZXI9QWJzdHJhY3RDb250cm9sbGVyLmV4dGVuZCh7ZXZlbnRzOl8uZXh0ZW5kKHt9LEFic3RyYWN0Q29udHJvbGxlci5wcm90b3R5cGUuZXZlbnRzLHsnY2xpY2sgW3R5cGU9InRvZ2dsZSJdJzonX29uTGF6eVRvZ2dsZScsfSksaW5pdDpmdW5jdGlvbigpe3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLl8kYnV0dG9ucz0kKCc8bmF2PicpLm9uKCdjbGljaycsJ1t0eXBlPSJhY3Rpb24iXScsdGhpcy5wcm94eSgnX29uQWN0aW9uQ2xpY2tlZCcpKTt9LHJlbmRlckJ1dHRvbnM6ZnVuY3Rpb24oJG5vZGUpe3RoaXMuX3N1cGVyKCRub2RlKTskbm9kZS5hcHBlbmQodGhpcy5fJGJ1dHRvbnMpO30sX3VwZGF0ZTpmdW5jdGlvbigpe3ZhciBzZWxmPXRoaXM7cmV0dXJuIHRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKS50aGVuKGZ1bmN0aW9uKCl7dmFyICRjcF9idXR0b25zPXNlbGYucmVuZGVyZXIuJCgnbmF2Lm9fcXdlYl9jcF9idXR0b25zJyk7JGNwX2J1dHRvbnMuY2hpbGRyZW4oKS5hcHBlbmRUbyhzZWxmLl8kYnV0dG9ucy5lbXB0eSgpKTskY3BfYnV0dG9ucy5yZW1vdmUoKTt9KTt9LF9vbkxhenlUb2dnbGU6ZnVuY3Rpb24oZSl7dmFyICR0YXJnZXQ9JChlLnRhcmdldCk7dmFyICR0PSR0YXJnZXQuY2xvc2VzdCgnW2RhdGEtbW9kZWxdJyk7aWYoISgkdGFyZ2V0Lmhhc0NsYXNzKCdmYS1jYXJldC1kb3duJyl8fCR0YXJnZXQuaGFzQ2xhc3MoJ2ZhLWNhcmV0LXJpZ2h0JykpKXskdGFyZ2V0PSR0LmZpbmQoJy5mYS1jYXJldC1kb3duLCAuZmEtY2FyZXQtcmlnaHQnKTt9CnZhciBkYXRhPSR0LmRhdGEoKTtpZih0aGlzLl9mb2xkKCR0KSl7JHRhcmdldC5yZW1vdmVDbGFzcygnZmEtY2FyZXQtZG93bicpLmFkZENsYXNzKCdmYS1jYXJldC1yaWdodCcpO3JldHVybjt9CnZhciBhcmdzPWRhdGEuYXJnc3x8Xy5vbWl0KGRhdGEsJ21vZGVsJywnbWV0aG9kJywnaWQnKTtyZXR1cm4gdGhpcy5fcnBjKHttb2RlbDpkYXRhLm1vZGVsLG1ldGhvZDpkYXRhLm1ldGhvZCxhcmdzOmRhdGEuaWQ/W2RhdGEuaWRdOnVuZGVmaW5lZCxrd2FyZ3M6YXJnc30pLnRoZW4oZnVuY3Rpb24ocyl7cmV0dXJuICQocyk7fSkudGhlbihmdW5jdGlvbigkbmV3Y29udGVudCl7JHQuZGF0YSgnY2hpbGRyZW4nLCRuZXdjb250ZW50KS5hZnRlcigkbmV3Y29udGVudCk7JHRhcmdldC5yZW1vdmVDbGFzcygnZmEtY2FyZXQtcmlnaHQnKS5hZGRDbGFzcygnZmEtY2FyZXQtZG93bicpO30pO30sX2ZvbGQ6ZnVuY3Rpb24oJGVsKXt2YXIgJGNoaWxkcmVuPSRlbC5kYXRhKCdjaGlsZHJlbicpO2lmKCEkY2hpbGRyZW4pe3JldHVybiBmYWxzZTt9CnZhciBzZWxmPXRoaXM7JGNoaWxkcmVuLmVhY2goZnVuY3Rpb24oX2ksZSl7c2VsZi5fZm9sZCgkKGUpKTt9KS5yZW1vdmUoKTskZWwucmVtb3ZlRGF0YSgnY2hpbGRyZW4nKTtyZXR1cm4gdHJ1ZTt9fSk7dmFyIFFXZWJWaWV3PUFic3RyYWN0Vmlldy5leHRlbmQoe2Rpc3BsYXlfbmFtZTpfbHQoJ0ZyZWVkb20gVmlldycpLGljb246J2ZhLWZpbGUtcGljdHVyZS1vJyx2aWV3VHlwZToncXdlYicsZW5hYmxlVGltZVJhbmdlTWVudTp0cnVlLGNvbmZpZzpfLmV4dGVuZCh7fSxBYnN0cmFjdFZpZXcucHJvdG90eXBlLmNvbmZpZyx7TW9kZWw6TW9kZWwsUmVuZGVyZXI6UmVuZGVyZXIsQ29udHJvbGxlcjpDb250cm9sbGVyLH0pLGluaXQ6ZnVuY3Rpb24odmlld0luZm8scGFyYW1zKXt0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy5sb2FkUGFyYW1zLnZpZXdJZD12aWV3SW5mby52aWV3X2lkO319KTtyZWdpc3RyeS5hZGQoJ3F3ZWInLFFXZWJWaWV3KTtyZXR1cm57VmlldzpRV2ViVmlldyxDb250cm9sbGVyOkNvbnRyb2xsZXIsUmVuZGVyZXI6UmVuZGVyZXIsTW9kZWw6TW9kZWx9O30pOzsKCi8qIC93ZWIvc3RhdGljL3NyYy9qcy93aWRnZXRzL2F0dGFjaF9kb2N1bWVudC5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwpvZG9vLmRlZmluZSgnd2ViLkF0dGFjaERvY3VtZW50JyxmdW5jdGlvbihyZXF1aXJlKXsidXNlIHN0YXRpYyI7dmFyIGNvcmU9cmVxdWlyZSgnd2ViLmNvcmUnKTt2YXIgZnJhbWV3b3JrPXJlcXVpcmUoJ3dlYi5mcmFtZXdvcmsnKTt2YXIgd2lkZ2V0UmVnaXN0cnk9cmVxdWlyZSgnd2ViLndpZGdldF9yZWdpc3RyeScpO3ZhciBXaWRnZXQ9cmVxdWlyZSgnd2ViLldpZGdldCcpO3ZhciBfdD1jb3JlLl90O3ZhciBBdHRhY2hEb2N1bWVudD1XaWRnZXQuZXh0ZW5kKHt0ZW1wbGF0ZTonQXR0YWNoRG9jdW1lbnQnLGV2ZW50czp7J2NsaWNrJzonX29uQ2xpY2tBdHRhY2hEb2N1bWVudCcsJ2NoYW5nZSBpbnB1dC5vX2lucHV0X2ZpbGUnOidfb25GaWxlQ2hhbmdlZCcsfSxpbml0OmZ1bmN0aW9uKHBhcmVudCxyZWNvcmQsbm9kZUluZm8pe3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLnJlc19pZD1yZWNvcmQucmVzX2lkO3RoaXMucmVzX21vZGVsPXJlY29yZC5tb2RlbDt0aGlzLnN0YXRlPXJlY29yZDt0aGlzLm5vZGU9bm9kZUluZm87dGhpcy5maWxldXBsb2FkSUQ9Xy51bmlxdWVJZCgnb19maWxldXBsb2FkJyk7fSxzdGFydDpmdW5jdGlvbigpeyQod2luZG93KS5vbih0aGlzLmZpbGV1cGxvYWRJRCx0aGlzLl9vbkZpbGVMb2FkZWQuYmluZCh0aGlzKSk7cmV0dXJuIHRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9LGRlc3Ryb3k6ZnVuY3Rpb24oKXskKHdpbmRvdykub2ZmKHRoaXMuZmlsZXVwbG9hZElEKTt0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fSxfbm90aWZ5SW52YWxpZEZpZWxkczpmdW5jdGlvbihpbnZhbGlkRmllbGRzKXt2YXIgZmllbGRzPXRoaXMuc3RhdGUuZmllbGRzO3ZhciB3YXJuaW5ncz1pbnZhbGlkRmllbGRzLm1hcChmdW5jdGlvbihmaWVsZE5hbWUpe3ZhciBmaWVsZFN0cj1maWVsZHNbZmllbGROYW1lXS5zdHJpbmc7cmV0dXJuIF8uc3RyLnNwcmludGYoJzxsaT4lczwvbGk+JyxfLmVzY2FwZShmaWVsZFN0cikpO30pO3dhcm5pbmdzLnVuc2hpZnQoJzx1bD4nKTt3YXJuaW5ncy5wdXNoKCc8L3VsPicpO3RoaXMuZG9fd2FybihfdCgiVGhlIGZvbGxvd2luZyBmaWVsZHMgYXJlIGludmFsaWQ6Iiksd2FybmluZ3Muam9pbignJykpO30sX29uQ2xpY2tBdHRhY2hEb2N1bWVudDpmdW5jdGlvbihldil7aWYoJChldi50YXJnZXQpLmlzKCdpbnB1dC5vX2lucHV0X2ZpbGUnKSl7cmV0dXJuO30KdmFyIGZpZWxkTmFtZXM9dGhpcy5nZXRQYXJlbnQoKS5jYW5CZVNhdmVkKHRoaXMuc3RhdGUuaWQpO2lmKGZpZWxkTmFtZXMubGVuZ3RoKXtyZXR1cm4gdGhpcy5fbm90aWZ5SW52YWxpZEZpZWxkcyhmaWVsZE5hbWVzKTt9CmlmKCF0aGlzLnJlc19pZCl7cmV0dXJuIHRoaXMuZG9fd2FybihfdCgnV2FybmluZyA6IFlvdSBoYXZlIHRvIHNhdmUgZmlyc3QgYmVmb3JlIGF0dGFjaGluZyBhIGZpbGUuJykpO30KdGhpcy4kKCdpbnB1dC5vX2lucHV0X2ZpbGUnKS50cmlnZ2VyKCdjbGljaycpO30sX29uRmlsZUNoYW5nZWQ6ZnVuY3Rpb24oZXYpe2V2LnN0b3BQcm9wYWdhdGlvbigpO3RoaXMuJCgnZm9ybS5vX2Zvcm1fYmluYXJ5X2Zvcm0nKS50cmlnZ2VyKCdzdWJtaXQnKTtmcmFtZXdvcmsuYmxvY2tVSSgpO30sX29uRmlsZUxvYWRlZDpmdW5jdGlvbigpe3ZhciBzZWxmPXRoaXM7dmFyIGZpbGVzPUFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywxKTtyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSl7aWYoc2VsZi5ub2RlLmF0dHJzLmFjdGlvbil7c2VsZi5fcnBjKHttb2RlbDpzZWxmLnJlc19tb2RlbCxtZXRob2Q6c2VsZi5ub2RlLmF0dHJzLmFjdGlvbixhcmdzOltzZWxmLnJlc19pZF0sa3dhcmdzOnthdHRhY2htZW50X2lkczpfLm1hcChmaWxlcyxmdW5jdGlvbihmaWxlKXtyZXR1cm4gZmlsZS5pZDt9KSx9fSkudGhlbihmdW5jdGlvbigpe3Jlc29sdmUoKTt9KTt9ZWxzZXtyZXNvbHZlKCk7fX0pLnRoZW4oZnVuY3Rpb24oKXtzZWxmLnRyaWdnZXJfdXAoJ3JlbG9hZCcpO2ZyYW1ld29yay51bmJsb2NrVUkoKTt9KTt9LH0pO3dpZGdldFJlZ2lzdHJ5LmFkZCgnYXR0YWNoX2RvY3VtZW50JyxBdHRhY2hEb2N1bWVudCk7fSk7OwoKLyogL3dlYi9zdGF0aWMvc3JjL2pzL2ZpZWxkcy9zaWduYXR1cmUuanMgZGVmaW5lZCBpbiBidW5kbGUgJ3dlYi5hc3NldHNfYmFja2VuZCcgKi8Kb2Rvby5kZWZpbmUoJ3dlYi5TaWduYXR1cmUnLGZ1bmN0aW9uKHJlcXVpcmUpeyJ1c2Ugc3RyaWN0Ijt2YXIgQWJzdHJhY3RGaWVsZEJpbmFyeT1yZXF1aXJlKCd3ZWIuYmFzaWNfZmllbGRzJykuQWJzdHJhY3RGaWVsZEJpbmFyeTt2YXIgY29yZT1yZXF1aXJlKCd3ZWIuY29yZScpO3ZhciBEaWFsb2c9cmVxdWlyZSgnd2ViLkRpYWxvZycpO3ZhciBmaWVsZF91dGlscz1yZXF1aXJlKCd3ZWIuZmllbGRfdXRpbHMnKTt2YXIgTmFtZUFuZFNpZ25hdHVyZT1yZXF1aXJlKCd3ZWIubmFtZV9hbmRfc2lnbmF0dXJlJykuTmFtZUFuZFNpZ25hdHVyZTt2YXIgcmVnaXN0cnk9cmVxdWlyZSgnd2ViLmZpZWxkX3JlZ2lzdHJ5Jyk7dmFyIHNlc3Npb249cmVxdWlyZSgnd2ViLnNlc3Npb24nKTt2YXIgdXRpbHM9cmVxdWlyZSgnd2ViLnV0aWxzJyk7dmFyIHF3ZWI9Y29yZS5xd2ViO3ZhciBfdD1jb3JlLl90O3ZhciBfbHQ9Y29yZS5fbHQ7dmFyIFNpZ25hdHVyZURpYWxvZz1EaWFsb2cuZXh0ZW5kKHt0ZW1wbGF0ZTond2ViLnNpZ25hdHVyZV9kaWFsb2cnLHhtbERlcGVuZGVuY2llczpEaWFsb2cucHJvdG90eXBlLnhtbERlcGVuZGVuY2llcy5jb25jYXQoWycvd2ViL3N0YXRpYy9zcmMveG1sL25hbWVfYW5kX3NpZ25hdHVyZS54bWwnXSksY3VzdG9tX2V2ZW50czp7J3NpZ25hdHVyZV9jaGFuZ2VkJzonX29uQ2hhbmdlU2lnbmF0dXJlJyx9LGluaXQ6ZnVuY3Rpb24ocGFyZW50LG9wdGlvbnMpe3ZhciBzZWxmPXRoaXM7b3B0aW9ucz1vcHRpb25zfHx7fTtvcHRpb25zLnRpdGxlPW9wdGlvbnMudGl0bGV8fF90KCJBZG9wdCBZb3VyIFNpZ25hdHVyZSIpO29wdGlvbnMuc2l6ZT1vcHRpb25zLnNpemV8fCdtZWRpdW0nO29wdGlvbnMudGVjaG5pY2FsPWZhbHNlO2lmKCFvcHRpb25zLmJ1dHRvbnMpe29wdGlvbnMuYnV0dG9ucz1bXTtvcHRpb25zLmJ1dHRvbnMucHVzaCh7dGV4dDpfdCgiQWRvcHQgYW5kIFNpZ24iKSxjbGFzc2VzOiJidG4tcHJpbWFyeSIsZGlzYWJsZWQ6dHJ1ZSxjbGljazpmdW5jdGlvbihlKXtzZWxmLl9vbkNvbmZpcm0oKTt9fSk7b3B0aW9ucy5idXR0b25zLnB1c2goe3RleHQ6X3QoIkNhbmNlbCIpLGNsb3NlOnRydWV9KTt9CnRoaXMuX3N1cGVyKHBhcmVudCxvcHRpb25zKTt0aGlzLm5hbWVBbmRTaWduYXR1cmU9bmV3IE5hbWVBbmRTaWduYXR1cmUodGhpcyxvcHRpb25zLm5hbWVBbmRTaWduYXR1cmVPcHRpb25zKTt9LHdpbGxTdGFydDpmdW5jdGlvbigpe3JldHVybiBQcm9taXNlLmFsbChbdGhpcy5uYW1lQW5kU2lnbmF0dXJlLmFwcGVuZFRvKCQoJzxkaXY+JykpLHRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKV0pO30sc3RhcnQ6ZnVuY3Rpb24oKXt2YXIgc2VsZj10aGlzO3RoaXMuJHByaW1hcnlCdXR0b249dGhpcy4kZm9vdGVyLmZpbmQoJy5idG4tcHJpbWFyeScpO3RoaXMub3BlbmVkKCkudGhlbihmdW5jdGlvbigpe3NlbGYuJCgnLm9fd2ViX3NpZ25fbmFtZV9hbmRfc2lnbmF0dXJlJykucmVwbGFjZVdpdGgoc2VsZi5uYW1lQW5kU2lnbmF0dXJlLiRlbCk7c2VsZi5uYW1lQW5kU2lnbmF0dXJlLnJlc2V0U2lnbmF0dXJlKCk7fSk7cmV0dXJuIHRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9LGlzU2lnbmF0dXJlRW1wdHk6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5uYW1lQW5kU2lnbmF0dXJlLmlzU2lnbmF0dXJlRW1wdHkoKTt9LF9vbkNoYW5nZVNpZ25hdHVyZTpmdW5jdGlvbigpe3ZhciBpc0VtcHR5PXRoaXMubmFtZUFuZFNpZ25hdHVyZS5pc1NpZ25hdHVyZUVtcHR5KCk7dGhpcy4kcHJpbWFyeUJ1dHRvbi5wcm9wKCdkaXNhYmxlZCcsaXNFbXB0eSk7fSxfb25Db25maXJtOmZ1bmN0aW9uKGZjdCl7dGhpcy50cmlnZ2VyX3VwKCd1cGxvYWRfc2lnbmF0dXJlJyx7bmFtZTp0aGlzLm5hbWVBbmRTaWduYXR1cmUuZ2V0TmFtZSgpLHNpZ25hdHVyZUltYWdlOnRoaXMubmFtZUFuZFNpZ25hdHVyZS5nZXRTaWduYXR1cmVJbWFnZSgpLH0pO30sfSk7dmFyIEZpZWxkQmluYXJ5U2lnbmF0dXJlPUFic3RyYWN0RmllbGRCaW5hcnkuZXh0ZW5kKHtkZXNjcmlwdGlvbjpfbHQoIlNpZ25hdHVyZSIpLGZpZWxkRGVwZW5kZW5jaWVzOl8uZXh0ZW5kKHt9LEFic3RyYWN0RmllbGRCaW5hcnkucHJvdG90eXBlLmZpZWxkRGVwZW5kZW5jaWVzLHtfX2xhc3RfdXBkYXRlOnt0eXBlOidkYXRldGltZSd9LH0pLHJlc2V0T25BbnlGaWVsZENoYW5nZTp0cnVlLGN1c3RvbV9ldmVudHM6Xy5leHRlbmQoe30sQWJzdHJhY3RGaWVsZEJpbmFyeS5wcm90b3R5cGUuY3VzdG9tX2V2ZW50cyx7dXBsb2FkX3NpZ25hdHVyZTonX29uVXBsb2FkU2lnbmF0dXJlJyx9KSxldmVudHM6Xy5leHRlbmQoe30sQWJzdHJhY3RGaWVsZEJpbmFyeS5wcm90b3R5cGUuZXZlbnRzLHsnY2xpY2sgLm9fc2lnbmF0dXJlJzonX29uQ2xpY2tTaWduYXR1cmUnLH0pLHRlbXBsYXRlOm51bGwsc3VwcG9ydGVkRmllbGRUeXBlczpbJ2JpbmFyeSddLGZpbGVfdHlwZV9tYWdpY193b3JkOnsnLyc6J2pwZycsJ1InOidnaWYnLCdpJzoncG5nJywnUCc6J3N2Zyt4bWwnLH0saXNTZXQ6ZnVuY3Rpb24oKXtpZih0aGlzLm1vZGU9PT0nZWRpdCcpe3JldHVybiB0aGlzLnZhbHVlO30KcmV0dXJuIHRydWU7fSxfcmVuZGVyOmZ1bmN0aW9uKCl7dmFyIHNlbGY9dGhpczt2YXIgZGlzcGxheVNpZ25hdHVyZVJhdGlvPTM7dmFyIHVybDt2YXIgJGltZzt2YXIgd2lkdGg9dGhpcy5ub2RlT3B0aW9ucy5zaXplP3RoaXMubm9kZU9wdGlvbnMuc2l6ZVswXTp0aGlzLmF0dHJzLndpZHRoO3ZhciBoZWlnaHQ9dGhpcy5ub2RlT3B0aW9ucy5zaXplP3RoaXMubm9kZU9wdGlvbnMuc2l6ZVsxXTp0aGlzLmF0dHJzLmhlaWdodDtpZih0aGlzLnZhbHVlKXtpZighdXRpbHMuaXNfYmluX3NpemUodGhpcy52YWx1ZSkpe3VybD0nZGF0YTppbWFnZS8nKyh0aGlzLmZpbGVfdHlwZV9tYWdpY193b3JkW3RoaXMudmFsdWVbMF1dfHwncG5nJykrJztiYXNlNjQsJyt0aGlzLnZhbHVlO31lbHNle3VybD1zZXNzaW9uLnVybCgnL3dlYi9pbWFnZScse21vZGVsOnRoaXMubW9kZWwsaWQ6SlNPTi5zdHJpbmdpZnkodGhpcy5yZXNfaWQpLGZpZWxkOnRoaXMubm9kZU9wdGlvbnMucHJldmlld19pbWFnZXx8dGhpcy5uYW1lLHVuaXF1ZTpmaWVsZF91dGlscy5mb3JtYXQuZGF0ZXRpbWUodGhpcy5yZWNvcmREYXRhLl9fbGFzdF91cGRhdGUpLnJlcGxhY2UoL1teMC05XS9nLCcnKSx9KTt9CiRpbWc9JChxd2ViLnJlbmRlcigiRmllbGRCaW5hcnlTaWduYXR1cmUtaW1nIix7d2lkZ2V0OnRoaXMsdXJsOnVybH0pKTt9ZWxzZXskaW1nPSQoJzxkaXYgY2xhc3M9Im9fc2lnbmF0dXJlIG9fc2lnbmF0dXJlX2VtcHR5Ij48c3ZnPjwvc3ZnPjxwPicrX3QoJ1NJR05BVFVSRScpKyc8L3A+PC9kaXY+Jyk7aWYod2lkdGgmJmhlaWdodCl7d2lkdGg9TWF0aC5taW4od2lkdGgsZGlzcGxheVNpZ25hdHVyZVJhdGlvKmhlaWdodCk7aGVpZ2h0PXdpZHRoL2Rpc3BsYXlTaWduYXR1cmVSYXRpbzt9ZWxzZSBpZih3aWR0aCl7aGVpZ2h0PXdpZHRoL2Rpc3BsYXlTaWduYXR1cmVSYXRpbzt9ZWxzZSBpZihoZWlnaHQpe3dpZHRoPWhlaWdodCpkaXNwbGF5U2lnbmF0dXJlUmF0aW87fX0KaWYod2lkdGgpeyRpbWcuYXR0cignd2lkdGgnLHdpZHRoKTskaW1nLmNzcygnbWF4LXdpZHRoJyx3aWR0aCsncHgnKTt9CmlmKGhlaWdodCl7JGltZy5hdHRyKCdoZWlnaHQnLGhlaWdodCk7JGltZy5jc3MoJ21heC1oZWlnaHQnLGhlaWdodCsncHgnKTt9CnRoaXMuJCgnPiBkaXYnKS5yZW1vdmUoKTt0aGlzLiQoJz4gaW1nJykucmVtb3ZlKCk7dGhpcy4kZWwucHJlcGVuZCgkaW1nKTskaW1nLm9uKCdlcnJvcicsZnVuY3Rpb24oKXtzZWxmLl9jbGVhckZpbGUoKTskaW1nLmF0dHIoJ3NyYycsc2VsZi5wbGFjZWhvbGRlcik7c2VsZi5kb193YXJuKF90KCJJbWFnZSIpLF90KCJDb3VsZCBub3QgZGlzcGxheSB0aGUgc2VsZWN0ZWQgaW1hZ2UuIikpO30pO30sX29uQ2xpY2tTaWduYXR1cmU6ZnVuY3Rpb24oKXt2YXIgc2VsZj10aGlzO2lmKHRoaXMubW9kZT09PSdlZGl0Jyl7dmFyIG5hbWVBbmRTaWduYXR1cmVPcHRpb25zPXttb2RlOidkcmF3JyxkaXNwbGF5U2lnbmF0dXJlUmF0aW86MyxzaWduYXR1cmVUeXBlOidzaWduYXR1cmUnLG5vSW5wdXROYW1lOnRydWUsfTtpZih0aGlzLm5vZGVPcHRpb25zLmZ1bGxfbmFtZSl7dmFyIHNpZ25OYW1lO2lmKHRoaXMuZmllbGRzW3RoaXMubm9kZU9wdGlvbnMuZnVsbF9uYW1lXS50eXBlPT09J21hbnkyb25lJyl7c2lnbk5hbWU9dGhpcy5yZWNvcmREYXRhW3RoaXMubm9kZU9wdGlvbnMuZnVsbF9uYW1lXSYmdGhpcy5yZWNvcmREYXRhW3RoaXMubm9kZU9wdGlvbnMuZnVsbF9uYW1lXS5kYXRhLmRpc3BsYXlfbmFtZTt9ZWxzZXtzaWduTmFtZT10aGlzLnJlY29yZERhdGFbdGhpcy5ub2RlT3B0aW9ucy5mdWxsX25hbWVdO30KbmFtZUFuZFNpZ25hdHVyZU9wdGlvbnMuZGVmYXVsdE5hbWU9KHNpZ25OYW1lPT09JycpP3VuZGVmaW5lZDpzaWduTmFtZTt9Cm5hbWVBbmRTaWduYXR1cmVPcHRpb25zLmRlZmF1bHRGb250PXRoaXMubm9kZU9wdGlvbnMuZGVmYXVsdF9mb250fHwnJzt0aGlzLnNpZ25EaWFsb2c9bmV3IFNpZ25hdHVyZURpYWxvZyhzZWxmLHtuYW1lQW5kU2lnbmF0dXJlT3B0aW9uczpuYW1lQW5kU2lnbmF0dXJlT3B0aW9uc30pO3RoaXMuc2lnbkRpYWxvZy5vcGVuKCk7fX0sX29uVXBsb2FkU2lnbmF0dXJlOmZ1bmN0aW9uKGV2KXt2YXIgc2lnbmF0dXJlSW1hZ2U9ZXYuZGF0YS5zaWduYXR1cmVJbWFnZTtpZihzaWduYXR1cmVJbWFnZSE9PXRoaXMuc2lnbkRpYWxvZy5lbXB0eVNpZ25hdHVyZSl7dmFyIGRhdGE9c2lnbmF0dXJlSW1hZ2VbMV07dmFyIHR5cGU9c2lnbmF0dXJlSW1hZ2VbMF0uc3BsaXQoJy8nKVsxXTt0aGlzLm9uX2ZpbGVfdXBsb2FkZWQoZGF0YS5sZW5ndGgsZXYuZGF0YS5uYW1lLHR5cGUsZGF0YSk7fQp0aGlzLnNpZ25EaWFsb2cuY2xvc2UoKTt9fSk7cmVnaXN0cnkuYWRkKCdzaWduYXR1cmUnLEZpZWxkQmluYXJ5U2lnbmF0dXJlKTt9KTs7CgovKiAvd2ViL3N0YXRpYy9zcmMvanMvcmVwb3J0L3V0aWxzLmpzIGRlZmluZWQgaW4gYnVuZGxlICd3ZWIuYXNzZXRzX2JhY2tlbmQnICovCm9kb28uZGVmaW5lKCdyZXBvcnQudXRpbHMnLGZ1bmN0aW9uKHJlcXVpcmUpeyd1c2Ugc3RyaWN0JztmdW5jdGlvbiBnZXRfcHJvdG9jb2xfZnJvbV91cmwodXJsKXt2YXIgYT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7YS5ocmVmPXVybDtyZXR1cm4gYS5wcm90b2NvbDt9CmZ1bmN0aW9uIGdldF9ob3N0X2Zyb21fdXJsKHVybCl7dmFyIGE9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO2EuaHJlZj11cmw7cmV0dXJuIGEuaG9zdDt9CmZ1bmN0aW9uIGJ1aWxkX29yaWdpbihwcm90b2NvbCxob3N0KXtyZXR1cm4gcHJvdG9jb2wrJy8vJytob3N0O30KcmV0dXJueydnZXRfcHJvdG9jb2xfZnJvbV91cmwnOmdldF9wcm90b2NvbF9mcm9tX3VybCwnZ2V0X2hvc3RfZnJvbV91cmwnOmdldF9ob3N0X2Zyb21fdXJsLCdidWlsZF9vcmlnaW4nOmJ1aWxkX29yaWdpbix9O30pOzsKCi8qIC93ZWIvc3RhdGljL3NyYy9qcy9yZXBvcnQvY2xpZW50X2FjdGlvbi5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwpvZG9vLmRlZmluZSgncmVwb3J0LmNsaWVudF9hY3Rpb24nLGZ1bmN0aW9uKHJlcXVpcmUpeyd1c2Ugc3RyaWN0Jzt2YXIgQWJzdHJhY3RBY3Rpb249cmVxdWlyZSgnd2ViLkFic3RyYWN0QWN0aW9uJyk7dmFyIGNvcmU9cmVxdWlyZSgnd2ViLmNvcmUnKTt2YXIgc2Vzc2lvbj1yZXF1aXJlKCd3ZWIuc2Vzc2lvbicpO3ZhciB1dGlscz1yZXF1aXJlKCdyZXBvcnQudXRpbHMnKTt2YXIgUVdlYj1jb3JlLnF3ZWI7dmFyIEFVVEhPUklaRURfTUVTU0FHRVM9WydyZXBvcnQ6ZG9fYWN0aW9uJyxdO3ZhciBSZXBvcnRBY3Rpb249QWJzdHJhY3RBY3Rpb24uZXh0ZW5kKHtoYXNDb250cm9sUGFuZWw6dHJ1ZSxjb250ZW50VGVtcGxhdGU6J3JlcG9ydC5jbGllbnRfYWN0aW9uJyxpbml0OmZ1bmN0aW9uKHBhcmVudCxhY3Rpb24sb3B0aW9ucyl7dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO29wdGlvbnM9b3B0aW9uc3x8e307dGhpcy5hY3Rpb25fbWFuYWdlcj1wYXJlbnQ7dGhpcy5fdGl0bGU9b3B0aW9ucy5kaXNwbGF5X25hbWV8fG9wdGlvbnMubmFtZTt0aGlzLnJlcG9ydF91cmw9b3B0aW9ucy5yZXBvcnRfdXJsO3RoaXMucmVwb3J0X25hbWU9b3B0aW9ucy5yZXBvcnRfbmFtZTt0aGlzLnJlcG9ydF9maWxlPW9wdGlvbnMucmVwb3J0X2ZpbGU7dGhpcy5kYXRhPW9wdGlvbnMuZGF0YXx8e307dGhpcy5jb250ZXh0PW9wdGlvbnMuY29udGV4dHx8e307fSxzdGFydDpmdW5jdGlvbigpe3ZhciBzZWxmPXRoaXM7dGhpcy5pZnJhbWU9dGhpcy4kKCdpZnJhbWUnKVswXTtyZXR1cm4gUHJvbWlzZS5hbGwoW3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKSxzZXNzaW9uLmlzX2JvdW5kXSkudGhlbihmdW5jdGlvbigpe3ZhciB3ZWJfYmFzZV91cmw9c2Vzc2lvblsnd2ViLmJhc2UudXJsJ107dmFyIHRydXN0ZWRfaG9zdD11dGlscy5nZXRfaG9zdF9mcm9tX3VybCh3ZWJfYmFzZV91cmwpO3ZhciB0cnVzdGVkX3Byb3RvY29sPXV0aWxzLmdldF9wcm90b2NvbF9mcm9tX3VybCh3ZWJfYmFzZV91cmwpO3NlbGYudHJ1c3RlZF9vcmlnaW49dXRpbHMuYnVpbGRfb3JpZ2luKHRydXN0ZWRfcHJvdG9jb2wsdHJ1c3RlZF9ob3N0KTtzZWxmLiRidXR0b25zPSQoUVdlYi5yZW5kZXIoJ3JlcG9ydC5jbGllbnRfYWN0aW9uLkNvbnRyb2xCdXR0b25zJyx7fSkpO3NlbGYuJGJ1dHRvbnMub24oJ2NsaWNrJywnLm9fcmVwb3J0X3ByaW50JyxzZWxmLm9uX2NsaWNrX3ByaW50KTtzZWxmLl91cGRhdGVfY29udHJvbF9wYW5lbCgpO3NlbGYuaWZyYW1lLnNyYz1zZWxmLnJlcG9ydF91cmw7fSk7fSxkb19zaG93OmZ1bmN0aW9uKCl7dGhpcy5fdXBkYXRlX2NvbnRyb2xfcGFuZWwoKTtyZXR1cm4gdGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO30sb25fYXR0YWNoX2NhbGxiYWNrOmZ1bmN0aW9uKCl7JCh3aW5kb3cpLm9uKCdtZXNzYWdlJyx0aGlzLHRoaXMub25fbWVzc2FnZV9yZWNlaXZlZCk7fSxvbl9kZXRhY2hfY2FsbGJhY2s6ZnVuY3Rpb24oKXskKHdpbmRvdykub2ZmKCdtZXNzYWdlJyx0aGlzLm9uX21lc3NhZ2VfcmVjZWl2ZWQpO30sX3VwZGF0ZV9jb250cm9sX3BhbmVsOmZ1bmN0aW9uKCl7dGhpcy51cGRhdGVDb250cm9sUGFuZWwoe2NwX2NvbnRlbnQ6eyRidXR0b25zOnRoaXMuJGJ1dHRvbnMsfSx9KTt9LG9uX21lc3NhZ2VfcmVjZWl2ZWQ6ZnVuY3Rpb24oZXYpe3ZhciBtZXNzYWdlX29yaWdpbj11dGlscy5idWlsZF9vcmlnaW4oZXYub3JpZ2luYWxFdmVudC5zb3VyY2UubG9jYXRpb24ucHJvdG9jb2wsZXYub3JpZ2luYWxFdmVudC5zb3VyY2UubG9jYXRpb24uaG9zdCk7aWYobWVzc2FnZV9vcmlnaW49PT10aGlzLnRydXN0ZWRfb3JpZ2luKXt2YXIgbWVzc2FnZT1ldi5vcmlnaW5hbEV2ZW50LmRhdGE7aWYoXy5pc09iamVjdChtZXNzYWdlKSl7bWVzc2FnZT1tZXNzYWdlLm1lc3NhZ2U7fQppZighXy5pc1N0cmluZyhtZXNzYWdlKXx8KF8uaXNTdHJpbmcobWVzc2FnZSkmJiFfLmNvbnRhaW5zKEFVVEhPUklaRURfTUVTU0FHRVMsbWVzc2FnZSkpKXtyZXR1cm47fQpzd2l0Y2gobWVzc2FnZSl7Y2FzZSdyZXBvcnQ6ZG9fYWN0aW9uJzpyZXR1cm4gdGhpcy5kb19hY3Rpb24oZXYub3JpZ2luYWxFdmVudC5kYXRhLmFjdGlvbik7ZGVmYXVsdDp9fX0sX3Bvc3RfbWVzc2FnZTpmdW5jdGlvbihtZXNzYWdlKXt0aGlzLmlmcmFtZS5jb250ZW50V2luZG93LnBvc3RNZXNzYWdlKG1lc3NhZ2UsdGhpcy50cnVzdGVkX29yaWdpbik7fSxvbl9jbGlja19wcmludDpmdW5jdGlvbigpe3ZhciBhY3Rpb249eyd0eXBlJzonaXIuYWN0aW9ucy5yZXBvcnQnLCdyZXBvcnRfdHlwZSc6J3F3ZWItcGRmJywncmVwb3J0X25hbWUnOnRoaXMucmVwb3J0X25hbWUsJ3JlcG9ydF9maWxlJzp0aGlzLnJlcG9ydF9maWxlLCdkYXRhJzp0aGlzLmRhdGEsJ2NvbnRleHQnOnRoaXMuY29udGV4dCwnZGlzcGxheV9uYW1lJzp0aGlzLnRpdGxlLH07cmV0dXJuIHRoaXMuZG9fYWN0aW9uKGFjdGlvbik7fSx9KTtjb3JlLmFjdGlvbl9yZWdpc3RyeS5hZGQoJ3JlcG9ydC5jbGllbnRfYWN0aW9uJyxSZXBvcnRBY3Rpb24pO3JldHVybiBSZXBvcnRBY3Rpb247fSk7OwoKLyogL2Jhc2VfaW1wb3J0L3N0YXRpYy9saWIvamF2YXNjcmlwdC1zdGF0ZS1tYWNoaW5lL3N0YXRlLW1hY2hpbmUuanMgZGVmaW5lZCBpbiBidW5kbGUgJ3dlYi5hc3NldHNfYmFja2VuZCcgKi8KKGZ1bmN0aW9uKHdpbmRvdyl7U3RhdGVNYWNoaW5lPXtWRVJTSU9OOiIyLjEuMCIsUmVzdWx0OntTVUNDRUVERUQ6MSxOT1RSQU5TSVRJT046MixDQU5DRUxMRUQ6MyxBU1lOQzo0LH0sRXJyb3I6e0lOVkFMSURfVFJBTlNJVElPTjoxMDAsUEVORElOR19UUkFOU0lUSU9OOjIwMCxJTlZBTElEX0NBTExCQUNLOjMwMCx9LFdJTERDQVJEOicqJyxBU1lOQzonYXN5bmMnLGNyZWF0ZTpmdW5jdGlvbihjZmcsdGFyZ2V0KXt2YXIgaW5pdGlhbD0odHlwZW9mIGNmZy5pbml0aWFsPT0nc3RyaW5nJyk/e3N0YXRlOmNmZy5pbml0aWFsfTpjZmcuaW5pdGlhbDt2YXIgZnNtPXRhcmdldHx8Y2ZnLnRhcmdldHx8e307dmFyIGV2ZW50cz1jZmcuZXZlbnRzfHxbXTt2YXIgY2FsbGJhY2tzPWNmZy5jYWxsYmFja3N8fHt9O3ZhciBtYXA9e307dmFyIGFkZD1mdW5jdGlvbihlKXt2YXIgZnJvbT0oZS5mcm9tIGluc3RhbmNlb2YgQXJyYXkpP2UuZnJvbTooZS5mcm9tP1tlLmZyb21dOltTdGF0ZU1hY2hpbmUuV0lMRENBUkRdKTttYXBbZS5uYW1lXT1tYXBbZS5uYW1lXXx8e307Zm9yKHZhciBuPTA7bjxmcm9tLmxlbmd0aDtuKyspCm1hcFtlLm5hbWVdW2Zyb21bbl1dPWUudG98fGZyb21bbl07fTtpZihpbml0aWFsKXtpbml0aWFsLmV2ZW50PWluaXRpYWwuZXZlbnR8fCdzdGFydHVwJzthZGQoe25hbWU6aW5pdGlhbC5ldmVudCxmcm9tOidub25lJyx0bzppbml0aWFsLnN0YXRlfSk7fQpmb3IodmFyIG49MDtuPGV2ZW50cy5sZW5ndGg7bisrKQphZGQoZXZlbnRzW25dKTtmb3IodmFyIG5hbWUgaW4gbWFwKXtpZihtYXAuaGFzT3duUHJvcGVydHkobmFtZSkpCmZzbVtuYW1lXT1TdGF0ZU1hY2hpbmUuYnVpbGRFdmVudChuYW1lLG1hcFtuYW1lXSk7fQpmb3IodmFyIG5hbWUgaW4gY2FsbGJhY2tzKXtpZihjYWxsYmFja3MuaGFzT3duUHJvcGVydHkobmFtZSkpCmZzbVtuYW1lXT1jYWxsYmFja3NbbmFtZV19CmZzbS5jdXJyZW50PSdub25lJztmc20uaXM9ZnVuY3Rpb24oc3RhdGUpe3JldHVybiB0aGlzLmN1cnJlbnQ9PXN0YXRlO307ZnNtLmNhbj1mdW5jdGlvbihldmVudCl7cmV0dXJuIXRoaXMudHJhbnNpdGlvbiYmKG1hcFtldmVudF0uaGFzT3duUHJvcGVydHkodGhpcy5jdXJyZW50KXx8bWFwW2V2ZW50XS5oYXNPd25Qcm9wZXJ0eShTdGF0ZU1hY2hpbmUuV0lMRENBUkQpKTt9CmZzbS5jYW5ub3Q9ZnVuY3Rpb24oZXZlbnQpe3JldHVybiF0aGlzLmNhbihldmVudCk7fTtmc20uZXJyb3I9Y2ZnLmVycm9yfHxmdW5jdGlvbihuYW1lLGZyb20sdG8sYXJncyxlcnJvcixtc2cpe3Rocm93IG1zZzt9O2lmKGluaXRpYWwmJiFpbml0aWFsLmRlZmVyKQpmc21baW5pdGlhbC5ldmVudF0oKTtyZXR1cm4gZnNtO30sZG9DYWxsYmFjazpmdW5jdGlvbihmc20sZnVuYyxuYW1lLGZyb20sdG8sYXJncyl7aWYoZnVuYyl7dHJ5e3JldHVybiBmdW5jLmFwcGx5KGZzbSxbbmFtZSxmcm9tLHRvXS5jb25jYXQoYXJncykpO30KY2F0Y2goZSl7cmV0dXJuIGZzbS5lcnJvcihuYW1lLGZyb20sdG8sYXJncyxTdGF0ZU1hY2hpbmUuRXJyb3IuSU5WQUxJRF9DQUxMQkFDSywiYW4gZXhjZXB0aW9uIG9jY3VycmVkIGluIGEgY2FsbGVyLXByb3ZpZGVkIGNhbGxiYWNrIGZ1bmN0aW9uIik7fX19LGJlZm9yZUV2ZW50OmZ1bmN0aW9uKGZzbSxuYW1lLGZyb20sdG8sYXJncyl7cmV0dXJuIFN0YXRlTWFjaGluZS5kb0NhbGxiYWNrKGZzbSxmc21bJ29uYmVmb3JlJytuYW1lXSxuYW1lLGZyb20sdG8sYXJncyk7fSxhZnRlckV2ZW50OmZ1bmN0aW9uKGZzbSxuYW1lLGZyb20sdG8sYXJncyl7cmV0dXJuIFN0YXRlTWFjaGluZS5kb0NhbGxiYWNrKGZzbSxmc21bJ29uYWZ0ZXInK25hbWVdfHxmc21bJ29uJytuYW1lXSxuYW1lLGZyb20sdG8sYXJncyk7fSxsZWF2ZVN0YXRlOmZ1bmN0aW9uKGZzbSxuYW1lLGZyb20sdG8sYXJncyl7cmV0dXJuIFN0YXRlTWFjaGluZS5kb0NhbGxiYWNrKGZzbSxmc21bJ29ubGVhdmUnK2Zyb21dLG5hbWUsZnJvbSx0byxhcmdzKTt9LGVudGVyU3RhdGU6ZnVuY3Rpb24oZnNtLG5hbWUsZnJvbSx0byxhcmdzKXtyZXR1cm4gU3RhdGVNYWNoaW5lLmRvQ2FsbGJhY2soZnNtLGZzbVsnb25lbnRlcicrdG9dfHxmc21bJ29uJyt0b10sbmFtZSxmcm9tLHRvLGFyZ3MpO30sY2hhbmdlU3RhdGU6ZnVuY3Rpb24oZnNtLG5hbWUsZnJvbSx0byxhcmdzKXtyZXR1cm4gU3RhdGVNYWNoaW5lLmRvQ2FsbGJhY2soZnNtLGZzbVsnb25jaGFuZ2VzdGF0ZSddLG5hbWUsZnJvbSx0byxhcmdzKTt9LGJ1aWxkRXZlbnQ6ZnVuY3Rpb24obmFtZSxtYXApe3JldHVybiBmdW5jdGlvbigpe3ZhciBmcm9tPXRoaXMuY3VycmVudDt2YXIgdG89bWFwW2Zyb21dfHxtYXBbU3RhdGVNYWNoaW5lLldJTERDQVJEXXx8ZnJvbTt2YXIgYXJncz1BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMpO2lmKHRoaXMudHJhbnNpdGlvbikKcmV0dXJuIHRoaXMuZXJyb3IobmFtZSxmcm9tLHRvLGFyZ3MsU3RhdGVNYWNoaW5lLkVycm9yLlBFTkRJTkdfVFJBTlNJVElPTiwiZXZlbnQgIituYW1lKyIgaW5hcHByb3ByaWF0ZSBiZWNhdXNlIHByZXZpb3VzIHRyYW5zaXRpb24gZGlkIG5vdCBjb21wbGV0ZSIpO2lmKHRoaXMuY2Fubm90KG5hbWUpKQpyZXR1cm4gdGhpcy5lcnJvcihuYW1lLGZyb20sdG8sYXJncyxTdGF0ZU1hY2hpbmUuRXJyb3IuSU5WQUxJRF9UUkFOU0lUSU9OLCJldmVudCAiK25hbWUrIiBpbmFwcHJvcHJpYXRlIGluIGN1cnJlbnQgc3RhdGUgIit0aGlzLmN1cnJlbnQpO2lmKGZhbHNlPT09U3RhdGVNYWNoaW5lLmJlZm9yZUV2ZW50KHRoaXMsbmFtZSxmcm9tLHRvLGFyZ3MpKQpyZXR1cm4gU3RhdGVNYWNoaW5lLkNBTkNFTExFRDtpZihmcm9tPT09dG8pe1N0YXRlTWFjaGluZS5hZnRlckV2ZW50KHRoaXMsbmFtZSxmcm9tLHRvLGFyZ3MpO3JldHVybiBTdGF0ZU1hY2hpbmUuTk9UUkFOU0lUSU9OO30KdmFyIGZzbT10aGlzO3RoaXMudHJhbnNpdGlvbj1mdW5jdGlvbigpe2ZzbS50cmFuc2l0aW9uPW51bGw7ZnNtLmN1cnJlbnQ9dG87U3RhdGVNYWNoaW5lLmVudGVyU3RhdGUoZnNtLG5hbWUsZnJvbSx0byxhcmdzKTtTdGF0ZU1hY2hpbmUuY2hhbmdlU3RhdGUoZnNtLG5hbWUsZnJvbSx0byxhcmdzKTtTdGF0ZU1hY2hpbmUuYWZ0ZXJFdmVudChmc20sbmFtZSxmcm9tLHRvLGFyZ3MpO307dmFyIGxlYXZlPVN0YXRlTWFjaGluZS5sZWF2ZVN0YXRlKHRoaXMsbmFtZSxmcm9tLHRvLGFyZ3MpO2lmKGZhbHNlPT09bGVhdmUpe3RoaXMudHJhbnNpdGlvbj1udWxsO3JldHVybiBTdGF0ZU1hY2hpbmUuQ0FOQ0VMTEVEO30KZWxzZSBpZigiYXN5bmMiPT09bGVhdmUpe3JldHVybiBTdGF0ZU1hY2hpbmUuQVNZTkM7fQplbHNle2lmKHRoaXMudHJhbnNpdGlvbikKdGhpcy50cmFuc2l0aW9uKCk7cmV0dXJuIFN0YXRlTWFjaGluZS5TVUNDRUVERUQ7fX07fX07aWYoImZ1bmN0aW9uIj09PXR5cGVvZiBkZWZpbmUpe2RlZmluZSgic3RhdGVtYWNoaW5lIixbXSxmdW5jdGlvbigpe3JldHVybiBTdGF0ZU1hY2hpbmU7fSk7fQplbHNle3dpbmRvdy5TdGF0ZU1hY2hpbmU9U3RhdGVNYWNoaW5lO319KHRoaXMpKTs7CgovKiAvYmFzZV9pbXBvcnQvc3RhdGljL3NyYy9qcy9pbXBvcnRfYWN0aW9uLmpzIGRlZmluZWQgaW4gYnVuZGxlICd3ZWIuYXNzZXRzX2JhY2tlbmQnICovCm9kb28uZGVmaW5lKCdiYXNlX2ltcG9ydC5pbXBvcnQnLGZ1bmN0aW9uKHJlcXVpcmUpeyJ1c2Ugc3RyaWN0Ijt2YXIgQWJzdHJhY3RBY3Rpb249cmVxdWlyZSgnd2ViLkFic3RyYWN0QWN0aW9uJyk7dmFyIGNvbmZpZz1yZXF1aXJlKCd3ZWIuY29uZmlnJyk7dmFyIGNvcmU9cmVxdWlyZSgnd2ViLmNvcmUnKTt2YXIgc2Vzc2lvbj1yZXF1aXJlKCd3ZWIuc2Vzc2lvbicpO3ZhciB0aW1lPXJlcXVpcmUoJ3dlYi50aW1lJyk7dmFyIEFic3RyYWN0V2ViQ2xpZW50PXJlcXVpcmUoJ3dlYi5BYnN0cmFjdFdlYkNsaWVudCcpO3ZhciBMb2FkaW5nPXJlcXVpcmUoJ3dlYi5Mb2FkaW5nJyk7dmFyIFFXZWI9Y29yZS5xd2ViO3ZhciBfdD1jb3JlLl90O3ZhciBfbHQ9Y29yZS5fbHQ7dmFyIFN0YXRlTWFjaGluZT13aW5kb3cuU3RhdGVNYWNoaW5lO2Z1bmN0aW9uIGpzb25wKGZvcm0sYXR0cmlidXRlcyxjYWxsYmFjayl7YXR0cmlidXRlcz1hdHRyaWJ1dGVzfHx7fTt2YXIgb3B0aW9ucz17anNvbnA6Xy51bmlxdWVJZCgnaW1wb3J0X2NhbGxiYWNrXycpfTt3aW5kb3dbb3B0aW9ucy5qc29ucF09ZnVuY3Rpb24oKXtkZWxldGUgd2luZG93W29wdGlvbnMuanNvbnBdO2NhbGxiYWNrLmFwcGx5KG51bGwsYXJndW1lbnRzKTt9O2lmKCdkYXRhJ2luIGF0dHJpYnV0ZXMpe18uZXh0ZW5kKGF0dHJpYnV0ZXMuZGF0YSxvcHRpb25zKTt9ZWxzZXtfLmV4dGVuZChhdHRyaWJ1dGVzLHtkYXRhOm9wdGlvbnN9KTt9Cl8uZXh0ZW5kKGF0dHJpYnV0ZXMse2RhdGFUeXBlOidzY3JpcHQnLH0pOyQoZm9ybSkuYWpheFN1Ym1pdChhdHRyaWJ1dGVzKTt9CmZ1bmN0aW9uIF9tYWtlX29wdGlvbih0ZXJtKXtyZXR1cm57aWQ6dGVybSx0ZXh0OnRlcm19O30KZnVuY3Rpb24gX2Zyb21fZGF0YShkYXRhLHRlcm0pe3JldHVybiBfLmZpbmRXaGVyZShkYXRhLHtpZDp0ZXJtfSl8fF9tYWtlX29wdGlvbih0ZXJtKTt9CmZ1bmN0aW9uIGRhdGFGaWx0ZXJlZFF1ZXJ5KHEpe3ZhciBzdWdnZXN0aW9ucz1fLmNsb25lKHRoaXMuZGF0YSk7aWYocS50ZXJtKXt2YXIgZXhhY3Q9Xy5maWx0ZXIoc3VnZ2VzdGlvbnMsZnVuY3Rpb24ocyl7cmV0dXJuIHMuaWQ9PT1xLnRlcm18fHMudGV4dD09PXEudGVybTt9KTtpZihleGFjdC5sZW5ndGgpe3N1Z2dlc3Rpb25zPWV4YWN0O31lbHNle3N1Z2dlc3Rpb25zPVtfbWFrZV9vcHRpb24ocS50ZXJtKV0uY29uY2F0KF8uZmlsdGVyKHN1Z2dlc3Rpb25zLGZ1bmN0aW9uKHMpe3JldHVybiBzLmlkLmluZGV4T2YocS50ZXJtKSE9PS0xfHxzLnRleHQuaW5kZXhPZihxLnRlcm0pIT09LTF9KSk7fX0KcS5jYWxsYmFjayh7cmVzdWx0czpzdWdnZXN0aW9uc30pO30KdmFyIERhdGFJbXBvcnQ9QWJzdHJhY3RBY3Rpb24uZXh0ZW5kKHtoYXNDb250cm9sUGFuZWw6dHJ1ZSxjb250ZW50VGVtcGxhdGU6J0ltcG9ydFZpZXcnLG9wdHM6W3tuYW1lOidlbmNvZGluZycsbGFiZWw6X2x0KCJFbmNvZGluZzoiKSx2YWx1ZTonJ30se25hbWU6J3NlcGFyYXRvcicsbGFiZWw6X2x0KCJTZXBhcmF0b3I6IiksdmFsdWU6Jyd9LHtuYW1lOidxdW90aW5nJyxsYWJlbDpfbHQoIlRleHQgRGVsaW1pdGVyOiIpLHZhbHVlOiciJ31dLHBhcnNlX29wdHNfZm9ybWF0czpbe25hbWU6J2RhdGVfZm9ybWF0JyxsYWJlbDpfbHQoIkRhdGUgRm9ybWF0OiIpLHZhbHVlOicnfSx7bmFtZTonZGF0ZXRpbWVfZm9ybWF0JyxsYWJlbDpfbHQoIkRhdGV0aW1lIEZvcm1hdDoiKSx2YWx1ZTonJ30sXSxwYXJzZV9vcHRzX3NlcGFyYXRvcnM6W3tuYW1lOidmbG9hdF90aG91c2FuZF9zZXBhcmF0b3InLGxhYmVsOl9sdCgiVGhvdXNhbmRzIFNlcGFyYXRvcjoiKSx2YWx1ZTonLCd9LHtuYW1lOidmbG9hdF9kZWNpbWFsX3NlcGFyYXRvcicsbGFiZWw6X2x0KCJEZWNpbWFsIFNlcGFyYXRvcjoiKSx2YWx1ZTonLid9XSxldmVudHM6eydjaGFuZ2UgLm9lX2ltcG9ydF9maWxlJzonbG9hZGVkX2ZpbGUnLCdjaGFuZ2UgaW5wdXQub2VfaW1wb3J0X2hhc19oZWFkZXIsIC5qc19pbXBvcnRfb3B0aW9ucyBpbnB1dCc6J3NldHRpbmdzX2NoYW5nZWQnLCdjaGFuZ2UgaW5wdXQub2VfaW1wb3J0X2FkdmFuY2VkX21vZGUnOmZ1bmN0aW9uKGUpe3RoaXMuZG9fbm90X2NoYW5nZV9tYXRjaD10cnVlO3RoaXNbJ3NldHRpbmdzX2NoYW5nZWQnXSgpO30sJ2NsaWNrIGEub2VfaW1wb3J0X3RvZ2dsZSc6ZnVuY3Rpb24oZSl7ZS5wcmV2ZW50RGVmYXVsdCgpO3RoaXMuJCgnLm9lX2ltcG9ydF9vcHRpb25zJykudG9nZ2xlKCk7fSwnY2xpY2sgLm9lX2ltcG9ydF9yZXBvcnQgYS5vZV9pbXBvcnRfcmVwb3J0X2NvdW50JzpmdW5jdGlvbihlKXtlLnByZXZlbnREZWZhdWx0KCk7JChlLnRhcmdldCkucGFyZW50KCkucGFyZW50KCkudG9nZ2xlQ2xhc3MoJ29lX2ltcG9ydF9yZXBvcnRfc2hvd21vcmUnKTt9LCdjbGljayAub2VfaW1wb3J0X3JlcG9ydF9zZWVfcG9zc2libGVfdmFsdWUnOmZ1bmN0aW9uKGUpe2UucHJldmVudERlZmF1bHQoKTskKGUudGFyZ2V0KS5wYXJlbnQoKS50b2dnbGVDbGFzcygnb2VfaW1wb3J0X3JlcG9ydF9zaG93bW9yZScpO30sJ2NsaWNrIC5vZV9pbXBvcnRfbW9yZWluZm9fYWN0aW9uIGEnOmZ1bmN0aW9uKGUpe2UucHJldmVudERlZmF1bHQoKTt2YXIgYWN0aW9uPUpTT04ucGFyc2UoJChlLnRhcmdldCkuYXR0cignZGF0YS1hY3Rpb24nKSk7YWN0aW9uLnZpZXdzPV8oYWN0aW9uLnZpZXdzKS5tYXAoZnVuY3Rpb24odmlldyl7dmFyIGlkPXZpZXdbMF0sdHlwZT12aWV3WzFdO3JldHVybltpZCx0eXBlIT09J3RyZWUnP3R5cGU6YWN0aW9uLnZpZXdfdHlwZT09PSdmb3JtJz8nbGlzdCc6J3RyZWUnXTt9KTt0aGlzLmRvX2FjdGlvbihfLmV4dGVuZChhY3Rpb24se3RhcmdldDonbmV3JyxmbGFnczp7c2VhcmNoX3ZpZXc6dHJ1ZSxkaXNwbGF5X3RpdGxlOnRydWUscGFnZXI6dHJ1ZSxsaXN0OntzZWxlY3RhYmxlOmZhbHNlfX19KSk7fSx9LGluaXQ6ZnVuY3Rpb24ocGFyZW50LGFjdGlvbil7dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3RoaXMuYWN0aW9uX21hbmFnZXI9cGFyZW50O3RoaXMucmVzX21vZGVsPWFjdGlvbi5wYXJhbXMubW9kZWw7dGhpcy5wYXJlbnRfY29udGV4dD1hY3Rpb24ucGFyYW1zLmNvbnRleHR8fHt9O3RoaXMuaWQ9bnVsbDt0aGlzLnNlc3Npb249c2Vzc2lvbjt0aGlzLl90aXRsZT1fdCgnSW1wb3J0IGEgRmlsZScpO3RoaXMuZG9fbm90X2NoYW5nZV9tYXRjaD1mYWxzZTt9LHdpbGxTdGFydDpmdW5jdGlvbigpe3ZhciBzZWxmPXRoaXM7dmFyIGRlZj10aGlzLl9ycGMoe21vZGVsOnRoaXMucmVzX21vZGVsLG1ldGhvZDonZ2V0X2ltcG9ydF90ZW1wbGF0ZXMnLGNvbnRleHQ6dGhpcy5wYXJlbnRfY29udGV4dCx9KS50aGVuKGZ1bmN0aW9uKHJlc3VsdCl7c2VsZi5pbXBvcnRUZW1wbGF0ZXM9cmVzdWx0O30pO3JldHVybiBQcm9taXNlLmFsbChbdGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpLGRlZl0pO30sc3RhcnQ6ZnVuY3Rpb24oKXt2YXIgc2VsZj10aGlzO3RoaXMuJGZvcm09dGhpcy4kKCdmb3JtJyk7dGhpcy5zZXR1cF9lbmNvZGluZ19waWNrZXIoKTt0aGlzLnNldHVwX3NlcGFyYXRvcl9waWNrZXIoKTt0aGlzLnNldHVwX2Zsb2F0X2Zvcm1hdF9waWNrZXIoKTt0aGlzLnNldHVwX2RhdGVfZm9ybWF0X3BpY2tlcigpO3JldHVybiBQcm9taXNlLmFsbChbdGhpcy5fc3VwZXIoKSxzZWxmLmNyZWF0ZV9tb2RlbCgpLnRoZW4oZnVuY3Rpb24oaWQpe3NlbGYuaWQ9aWQ7c2VsZi4kKCdpbnB1dFtuYW1lPWltcG9ydF9pZF0nKS52YWwoaWQpO3NlbGYucmVuZGVyQnV0dG9ucygpO3ZhciBzdGF0dXM9e2NwX2NvbnRlbnQ6eyRidXR0b25zOnNlbGYuJGJ1dHRvbnN9LH07c2VsZi51cGRhdGVDb250cm9sUGFuZWwoc3RhdHVzKTt9KSxdKTt9LGNyZWF0ZV9tb2RlbDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9ycGMoe21vZGVsOidiYXNlX2ltcG9ydC5pbXBvcnQnLG1ldGhvZDonY3JlYXRlJyxhcmdzOlt7cmVzX21vZGVsOnRoaXMucmVzX21vZGVsfV0sa3dhcmdzOntjb250ZXh0OnNlc3Npb24udXNlcl9jb250ZXh0fSx9KTt9LHJlbmRlckJ1dHRvbnM6ZnVuY3Rpb24oKXt2YXIgc2VsZj10aGlzO3RoaXMuJGJ1dHRvbnM9JChRV2ViLnJlbmRlcigiSW1wb3J0Vmlldy5idXR0b25zIix0aGlzKSk7dGhpcy4kYnV0dG9ucy5maWx0ZXIoJy5vX2ltcG9ydF92YWxpZGF0ZScpLm9uKCdjbGljaycsdGhpcy52YWxpZGF0ZS5iaW5kKHRoaXMpKTt0aGlzLiRidXR0b25zLmZpbHRlcignLm9faW1wb3J0X2ltcG9ydCcpLm9uKCdjbGljaycsdGhpcy5pbXBvcnQuYmluZCh0aGlzKSk7dGhpcy4kYnV0dG9ucy5maWx0ZXIoJy5vX2ltcG9ydF9maWxlX3JlbG9hZCcpLm9uKCdjbGljaycsdGhpcy5sb2FkZWRfZmlsZS5iaW5kKHRoaXMsbnVsbCkpO3RoaXMuJGJ1dHRvbnMuZmlsdGVyKCcub2VfaW1wb3J0X2ZpbGUnKS5vbignY2xpY2snLGZ1bmN0aW9uKCl7c2VsZi4kKCcub19jb250ZW50IC5vZV9pbXBvcnRfZmlsZScpLmNsaWNrKCk7fSk7dGhpcy4kYnV0dG9ucy5maWx0ZXIoJy5vX2ltcG9ydF9jYW5jZWwnKS5vbignY2xpY2snLGZ1bmN0aW9uKGUpe2UucHJldmVudERlZmF1bHQoKTtzZWxmLmV4aXQoKTt9KTt9LHNldHVwX2VuY29kaW5nX3BpY2tlcjpmdW5jdGlvbigpe3RoaXMuJCgnaW5wdXQub2VfaW1wb3J0X2VuY29kaW5nJykuc2VsZWN0Mih7d2lkdGg6JzUwJScsZGF0YTpfLm1hcCgoJ3V0Zi04IHV0Zi0xNiB3aW5kb3dzLTEyNTIgbGF0aW4xIGxhdGluMiBiaWc1IGdiMTgwMzAgc2hpZnRfamlzIHdpbmRvd3MtMTI1MSBrb2lyOF9yJykuc3BsaXQoL1xzKy8pLF9tYWtlX29wdGlvbikscXVlcnk6ZGF0YUZpbHRlcmVkUXVlcnksaW5pdFNlbGVjdGlvbjpmdW5jdGlvbigkZSxjKXtyZXR1cm4gYyhfbWFrZV9vcHRpb24oJGUudmFsKCkpKTt9fSk7fSxzZXR1cF9zZXBhcmF0b3JfcGlja2VyOmZ1bmN0aW9uKCl7dmFyIGRhdGE9W3tpZDonLCcsdGV4dDpfdCgiQ29tbWEiKX0se2lkOic7Jyx0ZXh0Ol90KCJTZW1pY29sb24iKX0se2lkOidcdCcsdGV4dDpfdCgiVGFiIil9LHtpZDonICcsdGV4dDpfdCgiU3BhY2UiKX1dO3RoaXMuJCgnaW5wdXQub2VfaW1wb3J0X3NlcGFyYXRvcicpLnNlbGVjdDIoe3dpZHRoOic1MCUnLGRhdGE6ZGF0YSxxdWVyeTpkYXRhRmlsdGVyZWRRdWVyeSxpbml0U2VsZWN0aW9uOmZ1bmN0aW9uKCRlLGMpe2MoX2Zyb21fZGF0YShkYXRhLCRlLnZhbCgpKXx8X21ha2Vfb3B0aW9uKCRlLnZhbCgpKSl9fSk7fSxzZXR1cF9mbG9hdF9mb3JtYXRfcGlja2VyOmZ1bmN0aW9uKCl7dmFyIGRhdGFfZGVjaW1hbD1be2lkOicsJyx0ZXh0Ol90KCJDb21tYSIpfSx7aWQ6Jy4nLHRleHQ6X3QoIkRvdCIpfSxdO3ZhciBkYXRhX2RpZ2l0cz1kYXRhX2RlY2ltYWwuY29uY2F0KFt7aWQ6JycsdGV4dDpfdCgiTm8gU2VwYXJhdG9yIil9XSk7dGhpcy4kKCdpbnB1dC5vZV9pbXBvcnRfZmxvYXRfdGhvdXNhbmRfc2VwYXJhdG9yJykuc2VsZWN0Mih7d2lkdGg6JzUwJScsZGF0YTpkYXRhX2RpZ2l0cyxxdWVyeTpkYXRhRmlsdGVyZWRRdWVyeSxpbml0U2VsZWN0aW9uOmZ1bmN0aW9uKCRlLGMpe2MoX2Zyb21fZGF0YShkYXRhX2RpZ2l0cywkZS52YWwoKSl8fF9tYWtlX29wdGlvbigkZS52YWwoKSkpfX0pO3RoaXMuJCgnaW5wdXQub2VfaW1wb3J0X2Zsb2F0X2RlY2ltYWxfc2VwYXJhdG9yJykuc2VsZWN0Mih7d2lkdGg6JzUwJScsZGF0YTpkYXRhX2RlY2ltYWwscXVlcnk6ZGF0YUZpbHRlcmVkUXVlcnksaW5pdFNlbGVjdGlvbjpmdW5jdGlvbigkZSxjKXtjKF9mcm9tX2RhdGEoZGF0YV9kZWNpbWFsLCRlLnZhbCgpKXx8X21ha2Vfb3B0aW9uKCRlLnZhbCgpKSl9fSk7fSxzZXR1cF9kYXRlX2Zvcm1hdF9waWNrZXI6ZnVuY3Rpb24oKXt2YXIgZGF0YT1fKFsnWVlZWS1NTS1ERCcsJ0REL01NL1lZJywnREQvTU0vWVlZWScsJ0RELU1NLVlZWVknLCdERC1NTU0tWVknLCdERC1NTU0tWVlZWScsJ01NL0REL1lZJywnTU0vREQvWVlZWScsJ01NLURELVlZJywnTU0tREQtWVlZWScsJ0RETU1ZWScsJ0RETU1ZWVlZJywnWVlNTUREJywnWVlZWU1NREQnLCdZWS9NTS9ERCcsJ1lZWVkvTU0vREQnLCdNTUREWVknLCdNTUREWVlZWScsXSkubWFwKF9tYWtlX29wdGlvbik7dGhpcy4kKCdpbnB1dC5vZV9pbXBvcnRfZGF0ZV9mb3JtYXQnKS5zZWxlY3QyKHt3aWR0aDonNTAlJyxkYXRhOmRhdGEscXVlcnk6ZGF0YUZpbHRlcmVkUXVlcnksaW5pdFNlbGVjdGlvbjpmdW5jdGlvbigkZSxjKXtjKF9mcm9tX2RhdGEoZGF0YSwkZS52YWwoKSl8fF9tYWtlX29wdGlvbigkZS52YWwoKSkpO319KX0saW1wb3J0X29wdGlvbnM6ZnVuY3Rpb24oKXt2YXIgc2VsZj10aGlzO3ZhciBvcHRpb25zPXtoZWFkZXJzOnRoaXMuJCgnaW5wdXQub2VfaW1wb3J0X2hhc19oZWFkZXInKS5wcm9wKCdjaGVja2VkJyksYWR2YW5jZWQ6dGhpcy4kKCdpbnB1dC5vZV9pbXBvcnRfYWR2YW5jZWRfbW9kZScpLnByb3AoJ2NoZWNrZWQnKSxrZWVwX21hdGNoZXM6dGhpcy5kb19ub3RfY2hhbmdlX21hdGNoLG5hbWVfY3JlYXRlX2VuYWJsZWRfZmllbGRzOnt9LHNraXA6TnVtYmVyKHRoaXMuJCgnI29lX2ltcG9ydF9yb3dfc3RhcnQnKS52YWwoKSktMXx8MCxsaW1pdDpOdW1iZXIodGhpcy4kKCcjb2VfaW1wb3J0X2JhdGNoX2xpbWl0JykudmFsKCkpfHxudWxsLH07Xyh0aGlzLm9wdHMpLmVhY2goZnVuY3Rpb24ob3B0KXtvcHRpb25zW29wdC5uYW1lXT1zZWxmLiQoJ2lucHV0Lm9lX2ltcG9ydF8nK29wdC5uYW1lKS52YWwoKTt9KTtfKHRoaXMucGFyc2Vfb3B0c19mb3JtYXRzKS5lYWNoKGZ1bmN0aW9uKG9wdCl7b3B0aW9uc1tvcHQubmFtZV09dGltZS5tb21lbnRfdG9fc3RyZnRpbWVfZm9ybWF0KHNlbGYuJCgnaW5wdXQub2VfaW1wb3J0Xycrb3B0Lm5hbWUpLnZhbCgpKTt9KTtfKHRoaXMucGFyc2Vfb3B0c19zZXBhcmF0b3JzKS5lYWNoKGZ1bmN0aW9uKG9wdCl7b3B0aW9uc1tvcHQubmFtZV09c2VsZi4kKCdpbnB1dC5vZV9pbXBvcnRfJytvcHQubmFtZSkudmFsKCk7fSk7b3B0aW9uc1snZmllbGRzJ109W107aWYodGhpcy5kb19ub3RfY2hhbmdlX21hdGNoKXtvcHRpb25zWydmaWVsZHMnXT10aGlzLiQoJy5vZV9pbXBvcnRfZmllbGRzIGlucHV0Lm9lX2ltcG9ydF9tYXRjaF9maWVsZCcpLm1hcChmdW5jdGlvbihpbmRleCxlbCl7cmV0dXJuICQoZWwpLnNlbGVjdDIoJ3ZhbCcpfHxmYWxzZTt9KS5nZXQoKTt9CnRoaXMuZG9fbm90X2NoYW5nZV9tYXRjaD1mYWxzZTt0aGlzLiQoJ2lucHV0Lm9faW1wb3J0X2NyZWF0ZV9vcHRpb24nKS5lYWNoKGZ1bmN0aW9uKCl7dmFyIGZpZWxkPXRoaXMuZ2V0QXR0cmlidXRlKCdmaWVsZCcpO2lmKGZpZWxkKXtvcHRpb25zLm5hbWVfY3JlYXRlX2VuYWJsZWRfZmllbGRzW2ZpZWxkXT10aGlzLmNoZWNrZWQ7fX0pO3JldHVybiBvcHRpb25zO30sb25maWxlX2xvYWRlZDpmdW5jdGlvbihldmVudCxmcm9tLHRvLGFyZyl7aWYoYXJnIT1udWxsKXt0aGlzLnRvZ2dsZV9wYXJ0aWFsKG51bGwpO30KdGhpcy4kYnV0dG9ucy5maWx0ZXIoJy5vX2ltcG9ydF9pbXBvcnQsIC5vX2ltcG9ydF92YWxpZGF0ZSwgLm9faW1wb3J0X2ZpbGVfcmVsb2FkJykuYWRkQ2xhc3MoJ2Qtbm9uZScpO2lmKCF0aGlzLiQoJ2lucHV0Lm9lX2ltcG9ydF9maWxlJykudmFsKCkpe3JldHVybiB0aGlzWydzZXR0aW5nc19jaGFuZ2VkJ10oKTt9CnRoaXMuJCgnLm9lX2ltcG9ydF9kYXRlX2Zvcm1hdCcpLnNlbGVjdDIoJ3ZhbCcsJycpO3RoaXMuJCgnLm9lX2ltcG9ydF9kYXRldGltZV9mb3JtYXQnKS52YWwoJycpO3RoaXMuJGZvcm0ucmVtb3ZlQ2xhc3MoJ29lX2ltcG9ydF9wcmV2aWV3IG9lX2ltcG9ydF9lcnJvcicpO3ZhciBpbXBvcnRfdG9nZ2xlPWZhbHNlO3ZhciBmaWxlPXRoaXMuJCgnaW5wdXQub2VfaW1wb3J0X2ZpbGUnKVswXS5maWxlc1swXTtpZigoZmlsZS50eXBlJiZfLmxhc3QoZmlsZS50eXBlLnNwbGl0KCcvJykpPT09ImNzdiIpfHwoXy5sYXN0KGZpbGUubmFtZS5zcGxpdCgnLicpKT09PSJjc3YiKSl7aW1wb3J0X3RvZ2dsZT10cnVlO30KdGhpcy4kZm9ybS5maW5kKCcub2VfaW1wb3J0X2JveCcpLnRvZ2dsZShpbXBvcnRfdG9nZ2xlKTtqc29ucCh0aGlzLiRmb3JtLHt1cmw6Jy9iYXNlX2ltcG9ydC9zZXRfZmlsZSd9LHRoaXMucHJveHkoJ3NldHRpbmdzX2NoYW5nZWQnKSk7fSxvbnByZXZpZXdpbmc6ZnVuY3Rpb24oKXt2YXIgc2VsZj10aGlzO3RoaXMuJGJ1dHRvbnMuZmlsdGVyKCcub19pbXBvcnRfaW1wb3J0LCAub19pbXBvcnRfdmFsaWRhdGUsIC5vX2ltcG9ydF9maWxlX3JlbG9hZCcpLmFkZENsYXNzKCdkLW5vbmUnKTt0aGlzLiRmb3JtLmFkZENsYXNzKCdvZV9pbXBvcnRfd2l0aF9maWxlJyk7dGhpcy4kZm9ybS5yZW1vdmVDbGFzcygnb2VfaW1wb3J0X3ByZXZpZXdfZXJyb3Igb2VfaW1wb3J0X2Vycm9yJyk7dGhpcy4kZm9ybS50b2dnbGVDbGFzcygnb2VfaW1wb3J0X25vaGVhZGVycyB0ZXh0LW11dGVkJywhdGhpcy4kKCdpbnB1dC5vZV9pbXBvcnRfaGFzX2hlYWRlcicpLnByb3AoJ2NoZWNrZWQnKSk7dGhpcy5fcnBjKHttb2RlbDonYmFzZV9pbXBvcnQuaW1wb3J0JyxtZXRob2Q6J3BhcnNlX3ByZXZpZXcnLGFyZ3M6W3RoaXMuaWQsdGhpcy5pbXBvcnRfb3B0aW9ucygpXSxrd2FyZ3M6e2NvbnRleHQ6c2Vzc2lvbi51c2VyX2NvbnRleHR9LH0pLnRoZW4oZnVuY3Rpb24ocmVzdWx0KXt2YXIgc2lnbmFsPXJlc3VsdC5lcnJvcj8ncHJldmlld19mYWlsZWQnOidwcmV2aWV3X3N1Y2NlZWRlZCc7c2VsZltzaWduYWxdKHJlc3VsdCk7fSk7fSxvbnByZXZpZXdfZXJyb3I6ZnVuY3Rpb24oZXZlbnQsZnJvbSx0byxyZXN1bHQpe3RoaXMuJCgnLm9lX2ltcG9ydF9vcHRpb25zJykuc2hvdygpO3RoaXMuJGJ1dHRvbnMuZmlsdGVyKCcub19pbXBvcnRfZmlsZV9yZWxvYWQnKS5yZW1vdmVDbGFzcygnZC1ub25lJyk7dGhpcy4kZm9ybS5hZGRDbGFzcygnb2VfaW1wb3J0X3ByZXZpZXdfZXJyb3Igb2VfaW1wb3J0X2Vycm9yJyk7dGhpcy4kZm9ybS5maW5kKCcub2VfaW1wb3J0X2JveCwgLm9lX2ltcG9ydF93aXRoX2ZpbGUnKS5yZW1vdmVDbGFzcygnZC1ub25lJyk7dGhpcy4kZm9ybS5maW5kKCcub192aWV3X25vY29udGVudCcpLmFkZENsYXNzKCdkLW5vbmUnKTt0aGlzLiQoJy5vZV9pbXBvcnRfZXJyb3JfcmVwb3J0JykuaHRtbChRV2ViLnJlbmRlcignSW1wb3J0Vmlldy5wcmV2aWV3LmVycm9yJyxyZXN1bHQpKTt9LG9ucHJldmlld19zdWNjZXNzOmZ1bmN0aW9uKGV2ZW50LGZyb20sdG8scmVzdWx0KXt2YXIgc2VsZj10aGlzO3RoaXMuJGJ1dHRvbnMuZmlsdGVyKCcub2VfaW1wb3J0X2ZpbGUnKS50ZXh0KF90KCdMb2FkIE5ldyBGaWxlJykpLnJlbW92ZUNsYXNzKCdidG4tcHJpbWFyeScpLmFkZENsYXNzKCdidG4tc2Vjb25kYXJ5JykuYmx1cigpO3RoaXMuJGJ1dHRvbnMuZmlsdGVyKCcub19pbXBvcnRfaW1wb3J0LCAub19pbXBvcnRfdmFsaWRhdGUsIC5vX2ltcG9ydF9maWxlX3JlbG9hZCcpLnJlbW92ZUNsYXNzKCdkLW5vbmUnKTt0aGlzLiRmb3JtLmZpbmQoJy5vZV9pbXBvcnRfYm94LCAub2VfaW1wb3J0X3dpdGhfZmlsZScpLnJlbW92ZUNsYXNzKCdkLW5vbmUnKTt0aGlzLiRmb3JtLmZpbmQoJy5vX3ZpZXdfbm9jb250ZW50JykuYWRkQ2xhc3MoJ2Qtbm9uZScpO3RoaXMuJGZvcm0uYWRkQ2xhc3MoJ29lX2ltcG9ydF9wcmV2aWV3Jyk7dGhpcy4kKCdpbnB1dC5vZV9pbXBvcnRfYWR2YW5jZWRfbW9kZScpLnByb3AoJ2NoZWNrZWQnLHJlc3VsdC5hZHZhbmNlZF9tb2RlKTt0aGlzLiQoJy5vZV9pbXBvcnRfZ3JpZCcpLmh0bWwoUVdlYi5yZW5kZXIoJ0ltcG9ydFZpZXcucHJldmlldycscmVzdWx0KSk7dGhpcy4kKCcub19pbXBvcnRfYmF0Y2hfYWxlcnQnKS50b2dnbGVDbGFzcygnZC1ub25lJywhcmVzdWx0LmJhdGNoKTt2YXIgbWVzc2FnZXM9W107aWYocmVzdWx0LmhlYWRlcnMubGVuZ3RoPT09MSl7bWVzc2FnZXMucHVzaCh7dHlwZTond2FybmluZycsbWVzc2FnZTpfdCgiQSBzaW5nbGUgY29sdW1uIHdhcyBmb3VuZCBpbiB0aGUgZmlsZSwgdGhpcyBvZnRlbiBtZWFucyB0aGUgZmlsZSBzZXBhcmF0b3IgaXMgaW5jb3JyZWN0Iil9KTt9CmlmKCFfLmlzRW1wdHkobWVzc2FnZXMpKXt0aGlzLiQoJy5vZV9pbXBvcnRfb3B0aW9ucycpLnNob3coKTt0aGlzLm9ucmVzdWx0cyhudWxsLG51bGwsbnVsbCx7J21lc3NhZ2VzJzptZXNzYWdlc30pO30KXy5lYWNoKFsnZW5jb2RpbmcnLCdzZXBhcmF0b3InLCdmbG9hdF90aG91c2FuZF9zZXBhcmF0b3InLCdmbG9hdF9kZWNpbWFsX3NlcGFyYXRvciddLGZ1bmN0aW9uKGlkKXtzZWxmLiQoJy5vZV9pbXBvcnRfJytpZCkuc2VsZWN0MigndmFsJyxyZXN1bHQub3B0aW9uc1tpZF0pfSk7dGhpcy4kKCcub2VfaW1wb3J0X2RhdGVfZm9ybWF0Jykuc2VsZWN0MigndmFsJyx0aW1lLnN0cmZ0aW1lX3RvX21vbWVudF9mb3JtYXQocmVzdWx0Lm9wdGlvbnMuZGF0ZV9mb3JtYXQpKTt0aGlzLiQoJy5vZV9pbXBvcnRfZGF0ZXRpbWVfZm9ybWF0JykudmFsKHRpbWUuc3RyZnRpbWVfdG9fbW9tZW50X2Zvcm1hdChyZXN1bHQub3B0aW9ucy5kYXRldGltZV9mb3JtYXQpKTt0aGlzLiQoJy5vZV9pbXBvcnRfZGVidWdfb3B0aW9uJykudG9nZ2xlQ2xhc3MoJ2Qtbm9uZScsIXJlc3VsdC5kZWJ1Zyk7dmFyICRmaWVsZHM9dGhpcy4kKCcub2VfaW1wb3J0X2ZpZWxkcyBpbnB1dCcpO3RoaXMucmVuZGVyX2ZpZWxkc19tYXRjaGVzKHJlc3VsdCwkZmllbGRzKTt2YXIgZGF0YT10aGlzLmdlbmVyYXRlX2ZpZWxkc19jb21wbGV0aW9uKHJlc3VsdCk7dmFyIGl0ZW1fZmluZGVyPWZ1bmN0aW9uKGlkLGl0ZW1zKXtpdGVtcz1pdGVtc3x8ZGF0YTtmb3IodmFyIGk9MDtpPGl0ZW1zLmxlbmd0aDsrK2kpe3ZhciBpdGVtPWl0ZW1zW2ldO2lmKGl0ZW0uaWQ9PT1pZCl7cmV0dXJuIGl0ZW07fQp2YXIgdmFsO2lmKGl0ZW0uY2hpbGRyZW4mJih2YWw9aXRlbV9maW5kZXIoaWQsaXRlbS5jaGlsZHJlbikpKXtyZXR1cm4gdmFsO319CnJldHVybicnO307JGZpZWxkcy5lYWNoKGZ1bmN0aW9uKGssdil7dmFyIGZpbHRlcmVkX2RhdGE9c2VsZi5nZW5lcmF0ZV9maWVsZHNfY29tcGxldGlvbihyZXN1bHQsayk7dmFyICR0aGluZz0kKCk7dmFyIGJpbmQ9ZnVuY3Rpb24oZCl7fTtpZihjb25maWcuaXNEZWJ1ZygpKXskdGhpbmc9JChRV2ViLnJlbmRlcignSW1wb3J0Vmlldy5jcmVhdGVfcmVjb3JkX29wdGlvbicpKS5pbnNlcnRBZnRlcih2KS5oaWRlKCk7YmluZD1mdW5jdGlvbihkYXRhKXtzd2l0Y2goZGF0YS50eXBlKXtjYXNlJ21hbnkyb25lJzpjYXNlJ21hbnkybWFueSc6JHRoaW5nLmZpbmQoJ2lucHV0JykuYXR0cignZmllbGQnLGRhdGEuaWQpOyR0aGluZy5zaG93KCk7YnJlYWs7ZGVmYXVsdDokdGhpbmcuZmluZCgnaW5wdXQnKS5hdHRyKCdmaWVsZCcsJycpLnByb3AoJ2NoZWNrZWQnLGZhbHNlKTskdGhpbmcuaGlkZSgpO319fQokKHYpLnNlbGVjdDIoe2FsbG93Q2xlYXI6dHJ1ZSxtaW5pbXVtSW5wdXRMZW5ndGg6MCxkYXRhOmZpbHRlcmVkX2RhdGEsaW5pdFNlbGVjdGlvbjpmdW5jdGlvbihlbGVtZW50LGNhbGxiYWNrKXt2YXIgZGVmYXVsdF92YWx1ZT1lbGVtZW50LnZhbCgpO2lmKCFkZWZhdWx0X3ZhbHVlKXtjYWxsYmFjaygnJyk7cmV0dXJuO30KdmFyIGRhdGE9aXRlbV9maW5kZXIoZGVmYXVsdF92YWx1ZSk7YmluZChkYXRhKTtjYWxsYmFjayhkYXRhKTt9LHBsYWNlaG9sZGVyOl90KCdEb25cJ3QgaW1wb3J0Jyksd2lkdGg6J3Jlc29sdmUnLGRyb3Bkb3duQ3NzQ2xhc3M6J29lX2ltcG9ydF9zZWxlY3Rvcid9KS5vbignY2hhbmdlJyxmdW5jdGlvbihlKXtiaW5kKGl0ZW1fZmluZGVyKGUuY3VycmVudFRhcmdldC52YWx1ZSkpO30pO30pO30sZ2VuZXJhdGVfZmllbGRzX2NvbXBsZXRpb246ZnVuY3Rpb24ocm9vdCxpbmRleCl7dmFyIHNlbGY9dGhpczt2YXIgYmFzaWM9W107dmFyIHJlZ3VsYXJzPVtdO3ZhciBvMm09W107dmFyIGhlYWRlcnNfdHlwZT1yb290LmhlYWRlcnNfdHlwZTtmdW5jdGlvbiB0cmF2ZXJzZShmaWVsZCxhbmNlc3RvcnMsY29sbGVjdGlvbix0eXBlKXt2YXIgc3ViZmllbGRzPWZpZWxkLmZpZWxkczt2YXIgYWR2YW5jZWRfbW9kZT1zZWxmLiQoJ2lucHV0Lm9lX2ltcG9ydF9hZHZhbmNlZF9tb2RlJykucHJvcCgnY2hlY2tlZCcpO3ZhciBmaWVsZF9wYXRoPWFuY2VzdG9ycy5jb25jYXQoZmllbGQpO3ZhciBsYWJlbD1fKGZpZWxkX3BhdGgpLnBsdWNrKCdzdHJpbmcnKS5qb2luKCcgLyAnKTt2YXIgaWQ9XyhmaWVsZF9wYXRoKS5wbHVjaygnbmFtZScpLmpvaW4oJy8nKTtpZih0eXBlPT09dW5kZWZpbmVkfHwodHlwZSE9PXVuZGVmaW5lZCYmKHR5cGUuaW5kZXhPZignYWxsJykhPT0tMXx8dHlwZS5pbmRleE9mKGZpZWxkWyd0eXBlJ10pIT09LTEpKSl7aWYoIWNvbGxlY3Rpb24pe2lmKGZpZWxkLm5hbWU9PT0naWQnKXtjb2xsZWN0aW9uPWJhc2ljO31lbHNlIGlmKF8uaXNFbXB0eShzdWJmaWVsZHMpfHxfLmlzRXF1YWwoXy5wbHVjayhzdWJmaWVsZHMsJ25hbWUnKSxbJ2lkJywnLmlkJ10pKXtjb2xsZWN0aW9uPXJlZ3VsYXJzO31lbHNle2NvbGxlY3Rpb249bzJtO319CmNvbGxlY3Rpb24ucHVzaCh7aWQ6aWQsdGV4dDpsYWJlbCxyZXF1aXJlZDpmaWVsZC5yZXF1aXJlZCx0eXBlOmZpZWxkLnR5cGV9KTt9CmlmKGFkdmFuY2VkX21vZGUpe2Zvcih2YXIgaT0wLGVuZD1zdWJmaWVsZHMubGVuZ3RoO2k8ZW5kOysraSl7dHJhdmVyc2Uoc3ViZmllbGRzW2ldLGZpZWxkX3BhdGgsY29sbGVjdGlvbix0eXBlKTt9fX0KXyhyb290LmZpZWxkcykuZWFjaChmdW5jdGlvbihmaWVsZCl7aWYoaW5kZXg9PT11bmRlZmluZWQpe3RyYXZlcnNlKGZpZWxkLFtdKTt9CmVsc2V7aWYoc2VsZi4kKCdpbnB1dC5vZV9pbXBvcnRfYWR2YW5jZWRfbW9kZScpLnByb3AoJ2NoZWNrZWQnKSl7dHJhdmVyc2UoZmllbGQsW10sdW5kZWZpbmVkLFsnYWxsJ10pO30KZWxzZXt0cmF2ZXJzZShmaWVsZCxbXSx1bmRlZmluZWQsaGVhZGVyc190eXBlW2luZGV4XSk7fX19KTt2YXIgY21wPWZ1bmN0aW9uKGZpZWxkMSxmaWVsZDIpe3JldHVybiBmaWVsZDEudGV4dC5sb2NhbGVDb21wYXJlKGZpZWxkMi50ZXh0KTt9O3JlZ3VsYXJzLnNvcnQoY21wKTtvMm0uc29ydChjbXApO2lmKCFfLmlzRW1wdHkocmVndWxhcnMpJiYhXy5pc0VtcHR5KG8ybSkpe2Jhc2ljPWJhc2ljLmNvbmNhdChbe3RleHQ6X3QoIk5vcm1hbCBGaWVsZHMiKSxjaGlsZHJlbjpyZWd1bGFyc30se3RleHQ6X3QoIlJlbGF0aW9uIEZpZWxkcyIpLGNoaWxkcmVuOm8ybX0sXSk7fQplbHNlIGlmKCFfLmlzRW1wdHkocmVndWxhcnMpKXtiYXNpYz1iYXNpYy5jb25jYXQocmVndWxhcnMpO30KZWxzZSBpZighXy5pc0VtcHR5KG8ybSkpe2Jhc2ljPWJhc2ljLmNvbmNhdChvMm0pO30KcmV0dXJuIGJhc2ljO30scmVuZGVyX2ZpZWxkc19tYXRjaGVzOmZ1bmN0aW9uKHJlc3VsdCwkZmllbGRzKXtpZihfKHJlc3VsdC5tYXRjaGVzKS5pc0VtcHR5KCkpe3JldHVybjt9CiRmaWVsZHMuZWFjaChmdW5jdGlvbihpbmRleCxpbnB1dCl7dmFyIG1hdGNoPXJlc3VsdC5tYXRjaGVzW2luZGV4XTtpZighbWF0Y2gpe3JldHVybjt9CnZhciBjdXJyZW50X2ZpZWxkPXJlc3VsdDtpbnB1dC52YWx1ZT1fKG1hdGNoKS5jaGFpbigpLm1hcChmdW5jdGlvbihuYW1lKXtyZXR1cm4gY3VycmVudF9maWVsZD1fKGN1cnJlbnRfZmllbGQuZmllbGRzKS5maW5kKGZ1bmN0aW9uKHN1YmZpZWxkKXtyZXR1cm4gc3ViZmllbGQubmFtZT09PW5hbWU7fSk7fSkucGx1Y2soJ25hbWUnKS52YWx1ZSgpLmpvaW4oJy8nKTt9KTt9LGNhbGxfaW1wb3J0OmZ1bmN0aW9uKGt3YXJncyl7dmFyIGZpZWxkcz10aGlzLiQoJy5vZV9pbXBvcnRfZmllbGRzIGlucHV0Lm9lX2ltcG9ydF9tYXRjaF9maWVsZCcpLm1hcChmdW5jdGlvbihpbmRleCxlbCl7cmV0dXJuICQoZWwpLnNlbGVjdDIoJ3ZhbCcpfHxmYWxzZTt9KS5nZXQoKTt2YXIgY29sdW1ucz10aGlzLiQoJy5vZV9pbXBvcnRfZ3JpZC1oZWFkZXIgLm9lX2ltcG9ydF9ncmlkLWNlbGwgLm9faW1wb3J0X2hlYWRlcl9uYW1lJykubWFwKGZ1bmN0aW9uKCl7cmV0dXJuICQodGhpcykudGV4dCgpLnRyaW0oKS50b0xvd2VyQ2FzZSgpfHxmYWxzZTt9KS5nZXQoKTt2YXIgdHJhY2tpbmdfZGlzYWJsZT0ndHJhY2tpbmdfZGlzYWJsZSdpbiBrd2FyZ3M/a3dhcmdzLnRyYWNraW5nX2Rpc2FibGU6IXRoaXMuJCgnI29lX2ltcG9ydF90cmFja2luZycpLnByb3AoJ2NoZWNrZWQnKQpkZWxldGUga3dhcmdzLnRyYWNraW5nX2Rpc2FibGU7a3dhcmdzLmNvbnRleHQ9Xy5leHRlbmQoe30sdGhpcy5wYXJlbnRfY29udGV4dCx7dHJhY2tpbmdfZGlzYWJsZTp0cmFja2luZ19kaXNhYmxlfSk7dmFyIHNlbGY9dGhpczt0aGlzLnRyaWdnZXJfdXAoJ3dpdGhfY2xpZW50Jyx7Y2FsbGJhY2s6ZnVuY3Rpb24oKXt0aGlzLmxvYWRpbmcuaWdub3JlX2V2ZW50cz10cnVlO319KTskLmJsb2NrVUkoe21lc3NhZ2U6UVdlYi5yZW5kZXIoJ1Rocm9iYmVyJyl9KTskKGRvY3VtZW50LmJvZHkpLmFkZENsYXNzKCdvX3VpX2Jsb2NrZWQnKTt2YXIgb3B0cz10aGlzLmltcG9ydF9vcHRpb25zKCk7dmFyICRlbD0kKCcub2VfdGhyb2JiZXJfbWVzc2FnZScpO3ZhciBtc2c9a3dhcmdzLmRyeXJ1bj9fdCgiJWQgcmVjb3JkcyB0ZXN0ZWQuLi4iKTpfdCgiJWQgcmVjb3JkcyBzdWNjZXNzZnVsbHkgaW1wb3J0ZWQuLi4iKTtvcHRzLmNhbGxiYWNrPWZ1bmN0aW9uKGNvdW50KXskZWwudGV4dChfLnN0ci5zcHJpbnRmKG1zZyxjb3VudCkpO307cmV0dXJuIHRoaXMuX2JhdGNoZWRJbXBvcnQob3B0cyxbdGhpcy5pZCxmaWVsZHMsY29sdW1uc10sa3dhcmdzLHtkb25lOjAscHJldjowfSkudGhlbihudWxsLGZ1bmN0aW9uKHJlYXNvbil7dmFyIGVycm9yPXJlYXNvbi5tZXNzYWdlO3ZhciBldmVudD1yZWFzb24uZXZlbnQ7aWYoZXZlbnQpe2V2ZW50LnByZXZlbnREZWZhdWx0KCk7fQp2YXIgbXNnO3ZhciBlcnJvcmRhdGE9ZXJyb3IuZGF0YXx8e307aWYoZXJyb3JkYXRhLnR5cGU9PT0neGhyZXJyb3InKXt2YXIgeGhyPWVycm9yZGF0YS5vYmplY3RzWzBdO3N3aXRjaCh4aHIuc3RhdHVzKXtjYXNlIDUwNDptc2c9X3QoIkltcG9ydCB0aW1lZCBvdXQuIFBsZWFzZSByZXRyeS4gSWYgeW91IHN0aWxsIGVuY291bnRlciB0aGlzIGlzc3VlLCB0aGUgZmlsZSBtYXkgYmUgdG9vIGJpZyBmb3IgdGhlIHN5c3RlbSdzIGNvbmZpZ3VyYXRpb24sIHRyeSB0byBzcGxpdCBpdCAoaW1wb3J0IGxlc3MgcmVjb3JkcyBwZXIgZmlsZSkuIik7YnJlYWs7ZGVmYXVsdDptc2c9X3QoIkFuIHVua25vd24gaXNzdWUgb2NjdXJyZWQgZHVyaW5nIGltcG9ydCAocG9zc2libHkgbG9zdCBjb25uZWN0aW9uLCBkYXRhIGxpbWl0IGV4Y2VlZGVkIG9yIG1lbW9yeSBsaW1pdHMgZXhjZWVkZWQpLiBQbGVhc2UgcmV0cnkgaW4gY2FzZSB0aGUgaXNzdWUgaXMgdHJhbnNpZW50LiBJZiB0aGUgaXNzdWUgc3RpbGwgb2NjdXJzLCB0cnkgdG8gc3BsaXQgdGhlIGZpbGUgcmF0aGVyIHRoYW4gaW1wb3J0IGl0IGF0IG9uY2UuIik7fX1lbHNle21zZz1lcnJvcmRhdGEuYXJndW1lbnRzJiYoZXJyb3JkYXRhLmFyZ3VtZW50c1sxXXx8ZXJyb3JkYXRhLmFyZ3VtZW50c1swXSl8fGVycm9yLm1lc3NhZ2U7fQpyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHsnbWVzc2FnZXMnOlt7dHlwZTonZXJyb3InLHJlY29yZDpmYWxzZSxtZXNzYWdlOm1zZyx9XX0pO30pLmZpbmFsbHkoZnVuY3Rpb24oKXskKGRvY3VtZW50LmJvZHkpLnJlbW92ZUNsYXNzKCdvX3VpX2Jsb2NrZWQnKTskLnVuYmxvY2tVSSgpO3NlbGYudHJpZ2dlcl91cCgnd2l0aF9jbGllbnQnLHtjYWxsYmFjazpmdW5jdGlvbigpe2RlbGV0ZSB0aGlzLmxvYWRpbmcuaWdub3JlX2V2ZW50czt9fSk7fSk7fSxfYmF0Y2hlZEltcG9ydDpmdW5jdGlvbihvcHRzLGFyZ3Msa3dhcmdzLHJlYyl7b3B0cy5jYWxsYmFjayYmb3B0cy5jYWxsYmFjayhyZWMuZG9uZXx8MCk7dmFyIHNlbGY9dGhpcztyZXR1cm4gdGhpcy5fcnBjKHttb2RlbDonYmFzZV9pbXBvcnQuaW1wb3J0JyxtZXRob2Q6J2RvJyxhcmdzOmFyZ3MuY29uY2F0KFtvcHRzXSksa3dhcmdzOmt3YXJnc30pLnRoZW4oZnVuY3Rpb24ocmVzdWx0cyl7Xy5lYWNoKHJlc3VsdHMubWVzc2FnZXMsb2Zmc2V0X2J5KG9wdHMuc2tpcCkpO2lmKCFrd2FyZ3MuZHJ5cnVuJiYhcmVzdWx0cy5pZHMpe3NlbGYuJCgnI29lX2ltcG9ydF9yb3dfc3RhcnQnKS52YWwob3B0cy5za2lwKzEpO2lmKG9wdHMuc2tpcCl7cmVzdWx0cy5tZXNzYWdlcy5wdXNoKHt0eXBlOidpbmZvJyxwcmlvcml0eTp0cnVlLG1lc3NhZ2U6Xy5zdHIuc3ByaW50ZihfdCgiVGhpcyBmaWxlIGhhcyBiZWVuIHN1Y2Nlc3NmdWxseSBpbXBvcnRlZCB1cCB0byBsaW5lICVkLiIpLG9wdHMuc2tpcCl9KTt9CnJldHVybiByZXN1bHRzO30KaWYoIXJlc3VsdHMubmV4dHJvdyl7cmV0dXJuIHJlc3VsdHM7fQpyZXR1cm4gc2VsZi5fYmF0Y2hlZEltcG9ydChfLmRlZmF1bHRzKHtza2lwOnJlc3VsdHMubmV4dHJvd30sb3B0cyksYXJncyxrd2FyZ3Mse2RvbmU6cmVjLmRvbmUrKHJlc3VsdHMuaWRzfHxbXSkubGVuZ3RoLHByZXY6cmVzdWx0cy5uZXh0cm93fSkudGhlbihmdW5jdGlvbihyMil7cmV0dXJue25hbWU6Xy56aXAocmVzdWx0cy5uYW1lLHIyLm5hbWUpLm1hcChmdW5jdGlvbihuYW1lcyl7cmV0dXJuIG5hbWVzWzBdfHxuYW1lc1sxXTt9KSxpZHM6KHJlc3VsdHMuaWRzfHxbXSkuY29uY2F0KHIyLmlkc3x8W10pLG1lc3NhZ2VzOnJlc3VsdHMubWVzc2FnZXMuY29uY2F0KHIyLm1lc3NhZ2VzKSxza2lwOnIyLnNraXB8fHJlc3VsdHMubmV4dHJvdyxuZXh0cm93OnIyLm5leHRyb3d9fSk7fSk7fSxvbnZhbGlkYXRlOmZ1bmN0aW9uKCl7dmFyIHByb209dGhpcy5jYWxsX2ltcG9ydCh7ZHJ5cnVuOnRydWUsdHJhY2tpbmdfZGlzYWJsZTp0cnVlfSk7cHJvbS50aGVuKHRoaXMucHJveHkoJ3ZhbGlkYXRlZCcpKTtyZXR1cm4gcHJvbTt9LG9uaW1wb3J0OmZ1bmN0aW9uKCl7dmFyIHNlbGY9dGhpczt2YXIgcHJvbT10aGlzLmNhbGxfaW1wb3J0KHtkcnlydW46ZmFsc2V9KTtwcm9tLnRoZW4oZnVuY3Rpb24ocmVzdWx0cyl7dmFyIG1lc3NhZ2U9cmVzdWx0cy5tZXNzYWdlcztpZighXy5hbnkobWVzc2FnZSxmdW5jdGlvbihtZXNzYWdlKXtyZXR1cm4gbWVzc2FnZS50eXBlPT09J2Vycm9yJzt9KSl7c2VsZlsnaW1wb3J0X3N1Y2NlZWRlZCddKHJlc3VsdHMpO3JldHVybjt9CnNlbGZbJ2ltcG9ydF9mYWlsZWQnXShyZXN1bHRzKTt9KTtyZXR1cm4gcHJvbTt9LG9uaW1wb3J0ZWQ6ZnVuY3Rpb24oZXZlbnQsZnJvbSx0byxyZXN1bHRzKXt0aGlzLmRvX25vdGlmeShfdCgiSW1wb3J0IGNvbXBsZXRlZCIpLF8uc3RyLnNwcmludGYoX3QoIiVkIHJlY29yZHMgd2VyZSBzdWNjZXNzZnVsbHkgaW1wb3J0ZWQiKSxyZXN1bHRzLmlkcy5sZW5ndGgpKTt0aGlzLmV4aXQoKTt9LGV4aXQ6ZnVuY3Rpb24oKXt0aGlzLnRyaWdnZXJfdXAoJ2hpc3RvcnlfYmFjaycpO30sb25yZXN1bHRzOmZ1bmN0aW9uKGV2ZW50LGZyb20sdG8scmVzdWx0cyl7dmFyIGZpZWxkcz10aGlzLiQoJy5vZV9pbXBvcnRfZmllbGRzIGlucHV0Lm9lX2ltcG9ydF9tYXRjaF9maWVsZCcpLm1hcChmdW5jdGlvbihpbmRleCxlbCl7cmV0dXJuICQoZWwpLnNlbGVjdDIoJ3ZhbCcpfHxmYWxzZTt9KS5nZXQoKTt2YXIgbWVzc2FnZT1yZXN1bHRzLm1lc3NhZ2VzO3ZhciBub19tZXNzYWdlcz1fLmlzRW1wdHkobWVzc2FnZSk7aWYobm9fbWVzc2FnZXMpe21lc3NhZ2UucHVzaCh7dHlwZTonaW5mbycsbWVzc2FnZTpfdCgiRXZlcnl0aGluZyBzZWVtcyB2YWxpZC4iKX0pO31lbHNlIGlmKGV2ZW50PT09J2ltcG9ydF9mYWlsZWQnJiZyZXN1bHRzLmlkcyl7dGhpcy50b2dnbGVfcGFydGlhbChyZXN1bHRzKTt9CnZhciBvZmZzZXQ9MTtpZih0aGlzLmltcG9ydF9vcHRpb25zKCkuaGVhZGVycyl7b2Zmc2V0Kz0xO30KdmFyIG1lc3NhZ2VzU29ydGVkPV8uc29ydEJ5KF8obWVzc2FnZSkuZ3JvdXBCeSgnbWVzc2FnZScpLGZ1bmN0aW9uKGdyb3VwKXtpZihncm91cFswXS5wcmlvcml0eSl7cmV0dXJuLTI7fQp2YXIgb3JkZXI9MDtzd2l0Y2goZ3JvdXBbMF0udHlwZSl7Y2FzZSdlcnJvcic6b3JkZXI9MDticmVhaztjYXNlJ3dhcm5pbmcnOm9yZGVyPWZpZWxkcy5sZW5ndGgrMTticmVhaztjYXNlJ2luZm8nOm9yZGVyPTIqKGZpZWxkcy5sZW5ndGgrMSk7YnJlYWs7ZGVmYXVsdDpvcmRlcj0zKihmaWVsZHMubGVuZ3RoKzEpO2JyZWFrO30KcmV0dXJuIG9yZGVyK18uaW5kZXhPZihmaWVsZHMsZ3JvdXBbMF0uZmllbGQpO30pO3RoaXMuJGZvcm0uYWRkQ2xhc3MoJ29lX2ltcG9ydF9lcnJvcicpO3RoaXMuJCgnLm9lX2ltcG9ydF9lcnJvcl9yZXBvcnQnKS5odG1sKFFXZWIucmVuZGVyKCdJbXBvcnRWaWV3LmVycm9yJyx7ZXJyb3JzOm1lc3NhZ2VzU29ydGVkLGF0OmZ1bmN0aW9uKHJvd3Mpe3ZhciBmcm9tPXJvd3MuZnJvbStvZmZzZXQ7dmFyIHRvPXJvd3MudG8rb2Zmc2V0O3ZhciByb3dOYW1lPScnO2lmKHJlc3VsdHMubmFtZS5sZW5ndGg+cm93cy5mcm9tJiZyZXN1bHRzLm5hbWVbcm93cy5mcm9tXSE9PScnKXtyb3dOYW1lPV8uc3RyLnNwcmludGYoJyAoJXMpJyxyZXN1bHRzLm5hbWVbcm93cy5mcm9tXSk7fQppZihmcm9tPT09dG8pe3JldHVybiBfLnN0ci5zcHJpbnRmKF90KCJhdCByb3cgJWQlcyIpLGZyb20scm93TmFtZSk7fQpyZXR1cm4gXy5zdHIuc3ByaW50ZihfdCgiYmV0d2VlbiByb3dzICVkIGFuZCAlZCIpLGZyb20sdG8pO30sYXRfbXVsdGk6ZnVuY3Rpb24ocm93cyl7dmFyIGZyb209cm93cy5mcm9tK29mZnNldDt2YXIgdG89cm93cy50bytvZmZzZXQ7dmFyIHJvd05hbWU9Jyc7aWYocmVzdWx0cy5uYW1lLmxlbmd0aD5yb3dzLmZyb20mJnJlc3VsdHMubmFtZVtyb3dzLmZyb21dIT09Jycpe3Jvd05hbWU9Xy5zdHIuc3ByaW50ZignICglcyknLHJlc3VsdHMubmFtZVtyb3dzLmZyb21dKTt9CmlmKGZyb209PT10byl7cmV0dXJuIF8uc3RyLnNwcmludGYoX3QoIlJvdyAlZCVzIiksZnJvbSxyb3dOYW1lKTt9CnJldHVybiBfLnN0ci5zcHJpbnRmKF90KCJCZXR3ZWVuIHJvd3MgJWQgYW5kICVkIiksZnJvbSx0byk7fSxhdF9tdWx0aV9oZWFkZXI6ZnVuY3Rpb24obnVtYmVyTGluZXMpe3JldHVybiBfLnN0ci5zcHJpbnRmKF90KCJhdCAlZCBkaWZmZXJlbnQgcm93czoiKSxudW1iZXJMaW5lcyk7fSxtb3JlOmZ1bmN0aW9uKG4pe3JldHVybiBfLnN0ci5zcHJpbnRmKF90KCIoJWQgbW9yZSkiKSxuKTt9LGluZm86ZnVuY3Rpb24obXNnKXtpZih0eXBlb2YgbXNnPT09J3N0cmluZycpe3JldHVybiBfLnN0ci5zcHJpbnRmKCc8ZGl2IGNsYXNzPSJvZV9pbXBvcnRfbW9yZWluZm8gb2VfaW1wb3J0X21vcmVpbmZvX21lc3NhZ2UiPiVzPC9kaXY+JyxfLnN0ci5lc2NhcGVIVE1MKG1zZykpO30KaWYobXNnIGluc3RhbmNlb2YgQXJyYXkpe3JldHVybiBfLnN0ci5zcHJpbnRmKCc8ZGl2IGNsYXNzPSJvZV9pbXBvcnRfbW9yZWluZm8gb2VfaW1wb3J0X21vcmVpbmZvX2Nob2ljZXMiPjxhIGhyZWY9IiMiIGNsYXNzPSJvZV9pbXBvcnRfcmVwb3J0X3NlZV9wb3NzaWJsZV92YWx1ZSBvZV9pbXBvcnRfc2VlX2FsbCI+PGkgY2xhc3M9ImZhIGZhLWFycm93LXJpZ2h0Ii8+ICVzIDwvYT48dWwgY2xhc3M9Im9lX2ltcG9ydF9yZXBvcnRfbW9yZSI+JXM8L3VsPjwvZGl2PicsXy5zdHIuZXNjYXBlSFRNTChfdCgiU2VlIHBvc3NpYmxlIHZhbHVlcyIpKSxfKG1zZykubWFwKGZ1bmN0aW9uKG1zZyl7cmV0dXJuJzxsaT4nCitfLnN0ci5lc2NhcGVIVE1MKG1zZykKKyc8L2xpPic7fSkuam9pbignJykpO30KcmV0dXJuWyc8ZGl2IGNsYXNzPSJvZV9pbXBvcnRfbW9yZWluZm8gb2VfaW1wb3J0X21vcmVpbmZvX2FjdGlvbiI+JyxfLnN0ci5zcHJpbnRmKCc8YSBocmVmPSIjIiBkYXRhLWFjdGlvbj0iJXMiIGNsYXNzPSJvZV9pbXBvcnRfc2VlX2FsbCI+PGkgY2xhc3M9ImZhIGZhLWFycm93LXJpZ2h0Ii8+ICcsXy5zdHIuZXNjYXBlSFRNTChKU09OLnN0cmluZ2lmeShtc2cpKSksXy5zdHIuZXNjYXBlSFRNTChfdCgiU2VlIHBvc3NpYmxlIHZhbHVlcyIpKSwnPC9hPicsJzwvZGl2PiddLmpvaW4oJycpO30sfSkpO30sdG9nZ2xlX3BhcnRpYWw6ZnVuY3Rpb24ocmVzdWx0KXt2YXIgJGZvcm09dGhpcy4kKCcub2VfaW1wb3J0Jyk7dmFyICRwYXJ0aWFsX3dhcm5pbmc9dGhpcy4kKCcub19pbXBvcnRfcGFydGlhbF9hbGVydCcpO3ZhciAkcGFydGlhbF9jb3VudD10aGlzLiQoJy5vX2ltcG9ydF9wYXJ0aWFsX2NvdW50Jyk7aWYocmVzdWx0PT1udWxsKXskcGFydGlhbF93YXJuaW5nLmFkZENsYXNzKCdkLW5vbmUnKTskZm9ybS5hZGQodGhpcy4kYnV0dG9ucykucmVtb3ZlQ2xhc3MoJ29faW1wb3J0X3BhcnRpYWxfbW9kZScpO3ZhciAkc2tpcD10aGlzLiQoJyNvZV9pbXBvcnRfcm93X3N0YXJ0Jyk7JHNraXAudmFsKCRza2lwLmF0dHIoJ3ZhbHVlJykpOyRwYXJ0aWFsX2NvdW50LnRleHQoJycpO3JldHVybjt9CnRoaXMuJCgnLm9faW1wb3J0X2JhdGNoX2FsZXJ0JykuYWRkQ2xhc3MoJ2Qtbm9uZScpOyRwYXJ0aWFsX3dhcm5pbmcucmVtb3ZlQ2xhc3MoJ2Qtbm9uZScpOyRmb3JtLmFkZCh0aGlzLiRidXR0b25zKS5hZGRDbGFzcygnb19pbXBvcnRfcGFydGlhbF9tb2RlJyk7JHBhcnRpYWxfY291bnQudGV4dCgocmVzdWx0LnNraXB8fDApKzEpO319KTtjb3JlLmFjdGlvbl9yZWdpc3RyeS5hZGQoJ2ltcG9ydCcsRGF0YUltcG9ydCk7U3RhdGVNYWNoaW5lLmNyZWF0ZSh7dGFyZ2V0OkRhdGFJbXBvcnQucHJvdG90eXBlLGV2ZW50czpbe25hbWU6J2xvYWRlZF9maWxlJyxmcm9tOlsnbm9uZScsJ2ZpbGVfbG9hZGVkJywncHJldmlld19lcnJvcicsJ3ByZXZpZXdfc3VjY2VzcycsJ3Jlc3VsdHMnXSx0bzonZmlsZV9sb2FkZWQnfSx7bmFtZTonc2V0dGluZ3NfY2hhbmdlZCcsZnJvbTpbJ2ZpbGVfbG9hZGVkJywncHJldmlld19lcnJvcicsJ3ByZXZpZXdfc3VjY2VzcycsJ3Jlc3VsdHMnXSx0bzoncHJldmlld2luZyd9LHtuYW1lOidwcmV2aWV3X2ZhaWxlZCcsZnJvbToncHJldmlld2luZycsdG86J3ByZXZpZXdfZXJyb3InfSx7bmFtZToncHJldmlld19zdWNjZWVkZWQnLGZyb206J3ByZXZpZXdpbmcnLHRvOidwcmV2aWV3X3N1Y2Nlc3MnfSx7bmFtZTondmFsaWRhdGUnLGZyb206J3ByZXZpZXdfc3VjY2VzcycsdG86J3ZhbGlkYXRpbmcnfSx7bmFtZTondmFsaWRhdGUnLGZyb206J3Jlc3VsdHMnLHRvOid2YWxpZGF0aW5nJ30se25hbWU6J3ZhbGlkYXRlZCcsZnJvbTondmFsaWRhdGluZycsdG86J3Jlc3VsdHMnfSx7bmFtZTonaW1wb3J0Jyxmcm9tOlsncHJldmlld19zdWNjZXNzJywncmVzdWx0cyddLHRvOidpbXBvcnRpbmcnfSx7bmFtZTonaW1wb3J0X3N1Y2NlZWRlZCcsZnJvbTonaW1wb3J0aW5nJyx0bzonaW1wb3J0ZWQnfSx7bmFtZTonaW1wb3J0X2ZhaWxlZCcsZnJvbTonaW1wb3J0aW5nJyx0bzoncmVzdWx0cyd9XSx9KTtMb2FkaW5nLmluY2x1ZGUoe29uX3JwY19ldmVudDpmdW5jdGlvbigpe2lmKHRoaXMuaWdub3JlX2V2ZW50cyl7cmV0dXJufQp0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fX0pO0Fic3RyYWN0V2ViQ2xpZW50LnByb3RvdHlwZS5jdXN0b21fZXZlbnRzWyd3aXRoX2NsaWVudCddPWZ1bmN0aW9uKGV2KXtldi5kYXRhLmNhbGxiYWNrLmNhbGwodGhpcyk7fTtmdW5jdGlvbiBvZmZzZXRfYnkoYnkpe3JldHVybiBmdW5jdGlvbiBvZmZzZXRfbWVzc2FnZShtc2cpe2lmKG1zZy5yb3dzKXttc2cucm93cy5mcm9tKz1ieTttc2cucm93cy50bys9Ynk7fX19CnJldHVybntEYXRhSW1wb3J0OkRhdGFJbXBvcnQsfTt9KTs7CgovKiAvYmFzZV9pbXBvcnQvc3RhdGljL3NyYy9qcy9pbXBvcnRfYnV0dG9ucy5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwpvZG9vLmRlZmluZSgnYmFzZV9pbXBvcnQuaW1wb3J0X2J1dHRvbnMnLGZ1bmN0aW9uKHJlcXVpcmUpeyJ1c2Ugc3RyaWN0Ijt2YXIgY29uZmlnPXJlcXVpcmUoJ3dlYi5jb25maWcnKTt2YXIgS2FuYmFuQ29udHJvbGxlcj1yZXF1aXJlKCd3ZWIuS2FuYmFuQ29udHJvbGxlcicpO3ZhciBLYW5iYW5WaWV3PXJlcXVpcmUoJ3dlYi5LYW5iYW5WaWV3Jyk7dmFyIExpc3RDb250cm9sbGVyPXJlcXVpcmUoJ3dlYi5MaXN0Q29udHJvbGxlcicpO3ZhciBMaXN0Vmlldz1yZXF1aXJlKCd3ZWIuTGlzdFZpZXcnKTt2YXIgSW1wb3J0Vmlld01peGluPXtpbml0OmZ1bmN0aW9uKHZpZXdJbmZvLHBhcmFtcyl7dmFyIGltcG9ydEVuYWJsZWQ9ISFKU09OLnBhcnNlKHRoaXMuYXJjaC5hdHRycy5pbXBvcnR8fCcxJykmJignaW1wb3J0X2VuYWJsZWQnaW4gcGFyYW1zP3BhcmFtcy5pbXBvcnRfZW5hYmxlZDp0cnVlKTt0aGlzLmNvbnRyb2xsZXJQYXJhbXMuaW1wb3J0RW5hYmxlZD1pbXBvcnRFbmFibGVkJiYhY29uZmlnLmRldmljZS5pc01vYmlsZTt9LH07dmFyIEltcG9ydENvbnRyb2xsZXJNaXhpbj17aW5pdDpmdW5jdGlvbihwYXJlbnQsbW9kZWwscmVuZGVyZXIscGFyYW1zKXt0aGlzLmltcG9ydEVuYWJsZWQ9cGFyYW1zLmltcG9ydEVuYWJsZWQ7fSxfYmluZEltcG9ydDpmdW5jdGlvbigpe2lmKCF0aGlzLiRidXR0b25zKXtyZXR1cm47fQp2YXIgc2VsZj10aGlzO3RoaXMuJGJ1dHRvbnMub24oJ2NsaWNrJywnLm9fYnV0dG9uX2ltcG9ydCcsZnVuY3Rpb24oKXt2YXIgc3RhdGU9c2VsZi5tb2RlbC5nZXQoc2VsZi5oYW5kbGUse3Jhdzp0cnVlfSk7c2VsZi5kb19hY3Rpb24oe3R5cGU6J2lyLmFjdGlvbnMuY2xpZW50Jyx0YWc6J2ltcG9ydCcscGFyYW1zOnttb2RlbDpzZWxmLm1vZGVsTmFtZSxjb250ZXh0OnN0YXRlLmdldENvbnRleHQoKSx9fSk7fSk7fX07TGlzdFZpZXcuaW5jbHVkZSh7aW5pdDpmdW5jdGlvbigpe3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtJbXBvcnRWaWV3TWl4aW4uaW5pdC5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fSx9KTtMaXN0Q29udHJvbGxlci5pbmNsdWRlKHtpbml0OmZ1bmN0aW9uKCl7dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO0ltcG9ydENvbnRyb2xsZXJNaXhpbi5pbml0LmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9LHJlbmRlckJ1dHRvbnM6ZnVuY3Rpb24oKXt0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7SW1wb3J0Q29udHJvbGxlck1peGluLl9iaW5kSW1wb3J0LmNhbGwodGhpcyk7fX0pO0thbmJhblZpZXcuaW5jbHVkZSh7aW5pdDpmdW5jdGlvbigpe3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtJbXBvcnRWaWV3TWl4aW4uaW5pdC5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fSx9KTtLYW5iYW5Db250cm9sbGVyLmluY2x1ZGUoe2luaXQ6ZnVuY3Rpb24oKXt0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7SW1wb3J0Q29udHJvbGxlck1peGluLmluaXQuYXBwbHkodGhpcyxhcmd1bWVudHMpO30scmVuZGVyQnV0dG9uczpmdW5jdGlvbigpe3RoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtJbXBvcnRDb250cm9sbGVyTWl4aW4uX2JpbmRJbXBvcnQuY2FsbCh0aGlzKTt9fSk7fSk7OwoKLyogL3dlYl9kaWFncmFtL3N0YXRpYy9zcmMvanMvdmVjMi5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwooZnVuY3Rpb24od2luZG93KXtmdW5jdGlvbiBWZWMyKHgseSl7dGhpcy54PXg7dGhpcy55PXk7fQp3aW5kb3cuVmVjMj1WZWMyO3ZhciByYWQyZGVnPTU3LjI5NTc3OTUxMzA4MjMyO3ZhciBkZWcycmFkPTAuMDE3NDUzMjkyNTE5OTQzMjk1O3ZhciBlcHNpbG9uPTAuMDAwMDAwMTtWZWMyLm5ld19wb2xhcl9kZWc9ZnVuY3Rpb24obGVuLGFuZ2xlKXt2YXIgdj1uZXcgVmVjMihsZW4sMCk7cmV0dXJuIHYucm90YXRlX2RlZyhhbmdsZSk7fTtWZWMyLm5ld19wb2xhcj1mdW5jdGlvbihsZW4sYW5nbGUpe3ZhciB2PW5ldyBWZWMyKGxlbiwwKTt2LnJvdGF0ZShhbmdsZSk7cmV0dXJuIHY7fTtWZWMyLnByb3RvdHlwZS5sZW49ZnVuY3Rpb24oKXtyZXR1cm4gTWF0aC5zcXJ0KHRoaXMueCp0aGlzLngrdGhpcy55KnRoaXMueSk7fTtWZWMyLnByb3RvdHlwZS5sZW5fc3E9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy54KnRoaXMueCt0aGlzLnkqdGhpcy55O307VmVjMi5wcm90b3R5cGUuZGlzdD1mdW5jdGlvbih2KXt2YXIgZHg9dGhpcy54LXYueDt2YXIgZHk9dGhpcy55LXYueTtyZXR1cm4gTWF0aC5zcXJ0KGR4KmR4K2R5KmR5KTt9O1ZlYzIucHJvdG90eXBlLmRpc3RfeHk9ZnVuY3Rpb24oeCx5KXt2YXIgZHg9dGhpcy54LXg7dmFyIGR5PXRoaXMueS15O3JldHVybiBNYXRoLnNxcnQoZHgqZHgrZHkqZHkpO307VmVjMi5wcm90b3R5cGUuZGlzdF9zcT1mdW5jdGlvbih2KXt2YXIgZHg9dGhpcy54LXYueDt2YXIgZHk9dGhpcy55LXYueTtyZXR1cm4gZHgqZHgrZHkqZHk7fTtWZWMyLnByb3RvdHlwZS5kaXN0X3NxX3h5PWZ1bmN0aW9uKHgseSl7dmFyIGR4PXRoaXMueC14O3ZhciBkeT10aGlzLnkteTtyZXR1cm4gZHgqZHgrZHkqZHk7fTtWZWMyLnByb3RvdHlwZS5kb3Q9ZnVuY3Rpb24odil7cmV0dXJuIHRoaXMueCp2LngrdGhpcy55KnYueTt9O1ZlYzIucHJvdG90eXBlLmRvdF94eT1mdW5jdGlvbih4LHkpe3JldHVybiB0aGlzLngqeCt0aGlzLnkqeTt9O1ZlYzIucHJvdG90eXBlLmNsb25lPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBWZWMyKHRoaXMueCx0aGlzLnkpO307VmVjMi5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKHYpe3JldHVybiBuZXcgVmVjMih0aGlzLngrdi54LHRoaXMueSt2LnkpO307VmVjMi5wcm90b3R5cGUuYWRkX3h5PWZ1bmN0aW9uKHgseSl7cmV0dXJuIG5ldyBWZWMyKHRoaXMueCt4LHRoaXMueSt5KTt9O1ZlYzIucHJvdG90eXBlLnN1Yj1mdW5jdGlvbih2KXtyZXR1cm4gbmV3IFZlYzIodGhpcy54LXYueCx0aGlzLnktdi55KTt9O1ZlYzIucHJvdG90eXBlLnN1Yl94eT1mdW5jdGlvbih4LHkpe3JldHVybiBuZXcgVmVjMih0aGlzLngteCx0aGlzLnkteSk7fTtWZWMyLnByb3RvdHlwZS5tdWx0PWZ1bmN0aW9uKHYpe3JldHVybiBuZXcgVmVjMih0aGlzLngqdi54LHRoaXMueSp2LnkpO307VmVjMi5wcm90b3R5cGUubXVsdF94eT1mdW5jdGlvbih4LHkpe3JldHVybiBuZXcgVmVjMih0aGlzLngqeCx0aGlzLnkqeSk7fTtWZWMyLnByb3RvdHlwZS5zY2FsZT1mdW5jdGlvbihmKXtyZXR1cm4gbmV3IFZlYzIodGhpcy54KmYsdGhpcy55KmYpO307VmVjMi5wcm90b3R5cGUubmVnPWZ1bmN0aW9uKGYpe3JldHVybiBuZXcgVmVjMigtdGhpcy54LC10aGlzLnkpO307VmVjMi5wcm90b3R5cGUubm9ybWFsaXplPWZ1bmN0aW9uKCl7dmFyIGxlbj10aGlzLmxlbigpO2lmKGxlbj09MCl7cmV0dXJuIG5ldyBWZWMyKDAsMSk7fWVsc2UgaWYobGVuIT0xKXtyZXR1cm4gdGhpcy5zY2FsZSgxLjAvbGVuKTt9CnJldHVybiBuZXcgVmVjMih0aGlzLngsdGhpcy55KTt9O1ZlYzIucHJvdG90eXBlLnNldF9sZW49ZnVuY3Rpb24obCl7cmV0dXJuIHRoaXMubm9ybWFsaXplKCkuc2NhbGUobCk7fTtWZWMyLnByb3RvdHlwZS5wcm9qZWN0PWZ1bmN0aW9uKHYpe3JldHVybiB2LnNldF9sZW4odGhpcy5kb3QodikpO307VmVjMi5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXt2YXIgc3RyPSIiO3N0cis9IlsiO3N0cis9dGhpcy54O3N0cis9IiwiO3N0cis9dGhpcy55O3N0cis9Il0iO3JldHVybiBzdHI7fTtWZWMyLnByb3RvdHlwZS5yb3RhdGU9ZnVuY3Rpb24ocmFkKXt2YXIgYz1NYXRoLmNvcyhyYWQpO3ZhciBzPU1hdGguc2luKHJhZCk7dmFyIHB4PXRoaXMueCpjLXRoaXMueSpzO3ZhciBweT10aGlzLngqcyt0aGlzLnkqYztyZXR1cm4gbmV3IFZlYzIocHgscHkpO307VmVjMi5wcm90b3R5cGUucm90YXRlX2RlZz1mdW5jdGlvbihkZWcpe3JldHVybiB0aGlzLnJvdGF0ZShkZWcqZGVnMnJhZCk7fTtWZWMyLnByb3RvdHlwZS5sZXJwPWZ1bmN0aW9uKHYsYWxwaGEpe3ZhciBpbnZfYWxwaGE9MS1hbHBoYTtyZXR1cm4gbmV3IFZlYzIodGhpcy54Kmludl9hbHBoYSt2LngqYWxwaGEsdGhpcy55Kmludl9hbHBoYSt2LnkqYWxwaGEpO307VmVjMi5wcm90b3R5cGUuYW5nbGU9ZnVuY3Rpb24oKXtyZXR1cm4gTWF0aC5hdGFuMih0aGlzLnksdGhpcy54KTt9O1ZlYzIucHJvdG90eXBlLmFuZ2xlX2RlZz1mdW5jdGlvbigpe3JldHVybiBNYXRoLmF0YW4yKHRoaXMueSx0aGlzLngpKnJhZDJkZWc7fTtWZWMyLnByb3RvdHlwZS5lcXVhbHM9ZnVuY3Rpb24odil7aWYoTWF0aC5hYnModGhpcy54LXYueCk+ZXBzaWxvbil7cmV0dXJuIGZhbHNlO31lbHNlIGlmKE1hdGguYWJzKHRoaXMueS12LnkpPmVwc2lsb24pe3JldHVybiBmYWxzZTt9CnJldHVybiB0cnVlO307VmVjMi5wcm90b3R5cGUuZXF1YWxzX3h5PWZ1bmN0aW9uKHgseSl7aWYoTWF0aC5hYnModGhpcy54LXgpPmVwc2lsb24pe3JldHVybiBmYWxzZTt9ZWxzZSBpZihNYXRoLmFicyh0aGlzLnkteSk+ZXBzaWxvbil7cmV0dXJuIGZhbHNlO30KcmV0dXJuIHRydWU7fTt9KSh3aW5kb3cpOyhmdW5jdGlvbih3aW5kb3cpe2Z1bmN0aW9uIEJFbGxpcHNlKGN4LGN5LHJ4LHJ5KXt0aGlzLnR5cGU9J2VsbGlwc2UnO3RoaXMueD1jeC1yeDt0aGlzLnk9Y3ktcnk7dGhpcy5zeD0yKnJ4O3RoaXMuc3k9MipyeTt0aGlzLmh4PXJ4O3RoaXMuaHk9cnk7dGhpcy5jeD1jeDt0aGlzLmN5PWN5O3RoaXMubXg9Y3grcng7dGhpcy5teT1jeStyeTt9CndpbmRvdy5CRWxsaXBzZT1CRWxsaXBzZTtCRWxsaXBzZS5wcm90b3R5cGUuY29sbGlkZV9zZWdtZW50PWZ1bmN0aW9uKGEsYil7dmFyIGNvbGxpc2lvbnM9W107aWYoYS5lcXVhbHMoYikpe3JldHVybiBjb2xsaXNpb25zO30KdmFyIGM9bmV3IFZlYzIodGhpcy5jeCx0aGlzLmN5KTthPWEuc3ViKGMpLm11bHRfeHkoMS90aGlzLmh4LDEvdGhpcy5oeSk7Yj1iLnN1YihjKS5tdWx0X3h5KDEvdGhpcy5oeCwxL3RoaXMuaHkpO2lmKGEubGVuX3NxKCk8MSYmYi5sZW5fc3EoKTwxKXtyZXR1cm4gY29sbGlzaW9uczt9CnZhciBhYj1iLnN1YihhKTt2YXIgQT0oYWIueCphYi54K2FiLnkqYWIueSk7dmFyIEI9MiooYWIueCphLngrYWIueSphLnkpO3ZhciBDPWEueCphLngrYS55KmEueS0xO3ZhciB1PUIqQi00KkEqQztpZih1PDApe3JldHVybiBjb2xsaXNpb25zO30KdT1NYXRoLnNxcnQodSk7dmFyIHUxPSgtQit1KS8oMipBKTt2YXIgdTI9KC1CLXUpLygyKkEpO2lmKHUxPj0wJiZ1MTw9MSl7dmFyIHBvcz1hLmFkZChhYi5zY2FsZSh1MSkpO2NvbGxpc2lvbnMucHVzaChwb3MpO30KaWYodTEhPXUyJiZ1Mj49MCYmdTI8PTEpe3ZhciBwb3M9YS5hZGQoYWIuc2NhbGUodTIpKTtjb2xsaXNpb25zLnB1c2gocG9zKTt9CmZvcih2YXIgaT0wO2k8Y29sbGlzaW9ucy5sZW5ndGg7aSsrKXtjb2xsaXNpb25zW2ldPWNvbGxpc2lvbnNbaV0ubXVsdF94eSh0aGlzLmh4LHRoaXMuaHkpO2NvbGxpc2lvbnNbaV09Y29sbGlzaW9uc1tpXS5hZGRfeHkodGhpcy5jeCx0aGlzLmN5KTt9CnJldHVybiBjb2xsaXNpb25zO307ZnVuY3Rpb24gQlJlY3QoeCx5LHN4LHN5KXt0aGlzLnR5cGU9J3JlY3QnO3RoaXMueD14O3RoaXMueT15O3RoaXMuc3g9c3g7dGhpcy5zeT1zeTt0aGlzLmh4PXN4LzI7dGhpcy5oeT1zeS8yO3RoaXMuY3g9eCt0aGlzLmh4O3RoaXMuY3k9eSt0aGlzLmh5O3RoaXMubXg9eCtzeDt0aGlzLm15PXkrc3k7fQp3aW5kb3cuQlJlY3Q9QlJlY3Q7QlJlY3QubmV3X2NlbnRlcmVkPWZ1bmN0aW9uKGN4LGN5LHN4LHN5KXtyZXR1cm4gbmV3IEJSZWN0KGN4LXN4LzIsY3ktc3kvMixzeCxzeSk7fTtmdW5jdGlvbiBsaW5lX2ludGVyc2VjdChhLGIsYyxkKXt2YXIgZj0oKGQueS1jLnkpKihiLngtYS54KS0oZC54LWMueCkqKGIueS1hLnkpKTtpZihmPT0wKXtyZXR1cm4gbnVsbDt9CmY9MS9mO3ZhciBmYWI9KChkLngtYy54KSooYS55LWMueSktKGQueS1jLnkpKihhLngtYy54KSkqZjtpZihmYWI8MHx8ZmFiPjEpe3JldHVybiBudWxsO30KdmFyIGZjZD0oKGIueC1hLngpKihhLnktYy55KS0oYi55LWEueSkqKGEueC1jLngpKSpmO2lmKGZjZDwwfHxmY2Q+MSl7cmV0dXJuIG51bGw7fQpyZXR1cm4gbmV3IFZlYzIoYS54K2ZhYiooYi54LWEueCksYS55K2ZhYiooYi55LWEueSkpO30KQlJlY3QucHJvdG90eXBlLmNvbGxpZGVfc2VnbWVudD1mdW5jdGlvbihhLGIpe3ZhciBjb2xsaXNpb25zPVtdO3ZhciBjb3JuZXJzPVtuZXcgVmVjMih0aGlzLngsdGhpcy55KSxuZXcgVmVjMih0aGlzLngsdGhpcy5teSksbmV3IFZlYzIodGhpcy5teCx0aGlzLm15KSxuZXcgVmVjMih0aGlzLm14LHRoaXMueSldO3ZhciBwb3M9bGluZV9pbnRlcnNlY3QoYSxiLGNvcm5lcnNbMF0sY29ybmVyc1sxXSk7aWYocG9zKWNvbGxpc2lvbnMucHVzaChwb3MpO3Bvcz1saW5lX2ludGVyc2VjdChhLGIsY29ybmVyc1sxXSxjb3JuZXJzWzJdKTtpZihwb3MpY29sbGlzaW9ucy5wdXNoKHBvcyk7cG9zPWxpbmVfaW50ZXJzZWN0KGEsYixjb3JuZXJzWzJdLGNvcm5lcnNbM10pO2lmKHBvcyljb2xsaXNpb25zLnB1c2gocG9zKTtwb3M9bGluZV9pbnRlcnNlY3QoYSxiLGNvcm5lcnNbM10sY29ybmVyc1swXSk7aWYocG9zKWNvbGxpc2lvbnMucHVzaChwb3MpO3JldHVybiBjb2xsaXNpb25zO307QlJlY3QucHJvdG90eXBlLmNvbnRhaW5zX3ZlYz1mdW5jdGlvbih2ZWMpe3JldHVybih2ZWMueD49dGhpcy54JiZ2ZWMueDw9dGhpcy5teCYmdmVjLnk+PXRoaXMueSYmdmVjLnk8PXRoaXMubXkpO307QlJlY3QucHJvdG90eXBlLmNvbnRhaW5zX3h5PWZ1bmN0aW9uKHgseSl7cmV0dXJuKHg+PXRoaXMueCYmeDw9dGhpcy5teCYmeT49dGhpcy55JiZ5PD10aGlzLm15KTt9O0JFbGxpcHNlLnByb3RvdHlwZS5jb250YWluc192ZWM9ZnVuY3Rpb24odil7dj12Lm11bHRfeHkodGhpcy5oeCx0aGlzLmh5KTtyZXR1cm4gdi5sZW5fc3EoKTw9MTt9O0JFbGxpcHNlLnByb3RvdHlwZS5jb250YWluc194eT1mdW5jdGlvbih4LHkpe3JldHVybiB0aGlzLmNvbnRhaW5zKG5ldyBWZWMyKHgseSkpO307fSkod2luZG93KTs7CgovKiAvd2ViX2RpYWdyYW0vc3RhdGljL3NyYy9qcy9ncmFwaC5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwooZnVuY3Rpb24od2luZG93KXtmdW5jdGlvbiBFZGdlRW5kKHBvc194LHBvc195KXt0aGlzLng9cG9zX3g7dGhpcy55PXBvc195O3RoaXMuZ2V0X3Bvcz1mdW5jdGlvbigpe3JldHVybiBuZXcgVmVjMih0aGlzLngsdGhpcy55KTt9fQpmdW5jdGlvbiBDbG9zZUJ1dHRvbihncmFwaCxlbnRpdHksZW50aXR5X3R5cGUscG9zX3gscG9zX3kpe3ZhciBzZWxmPXRoaXM7dmFyIHZpc2libGU9ZmFsc2U7dmFyIGNsb3NlX2J1dHRvbl9yYWRpdXM9Z3JhcGguc3R5bGUuY2xvc2VfYnV0dG9uX3JhZGl1c3x8ODt2YXIgY2xvc2VfY2lyY2xlPWdyYXBoLnIuY2lyY2xlKGVudGl0eS5nZXRfcG9zKCkueCtwb3NfeCxlbnRpdHkuZ2V0X3BvcygpLnkrcG9zX3ksY2xvc2VfYnV0dG9uX3JhZGl1cyk7Y2xvc2VfY2lyY2xlLmF0dHIoeydvcGFjaXR5JzowLCdmaWxsJzpncmFwaC5zdHlsZS5jbG9zZV9idXR0b25fY29sb3J8fCJibGFjayIsJ2N1cnNvcic6J3BvaW50ZXInLCdzdHJva2UnOidub25lJ30pO2Nsb3NlX2NpcmNsZS50cmFuc2Zvcm0oZ3JhcGguZ2V0X3RyYW5zZm9ybSgpKTtncmFwaC5zZXRfc2Nyb2xsaW5nKGNsb3NlX2NpcmNsZSk7dmFyIGNsb3NlX2xhYmVsPWdyYXBoLnIudGV4dChlbnRpdHkuZ2V0X3BvcygpLngrcG9zX3gsZW50aXR5LmdldF9wb3MoKS55K3Bvc195LCJ4Iik7Y2xvc2VfbGFiZWwuYXR0cih7J2ZpbGwnOmdyYXBoLnN0eWxlLmNsb3NlX2J1dHRvbl94X2NvbG9yfHwid2hpdGUiLCdmb250LXNpemUnOmNsb3NlX2J1dHRvbl9yYWRpdXMsJ2N1cnNvcic6J3BvaW50ZXInfSk7Y2xvc2VfbGFiZWwudHJhbnNmb3JtKGdyYXBoLmdldF90cmFuc2Zvcm0oKSk7Z3JhcGguc2V0X3Njcm9sbGluZyhjbG9zZV9sYWJlbCk7dmFyIGR1bW15X2NpcmNsZT1ncmFwaC5yLmNpcmNsZShlbnRpdHkuZ2V0X3BvcygpLngrcG9zX3gsZW50aXR5LmdldF9wb3MoKS55K3Bvc195LGNsb3NlX2J1dHRvbl9yYWRpdXMpO2R1bW15X2NpcmNsZS5hdHRyKHsnb3BhY2l0eSc6MSwnZmlsbCc6J3RyYW5zcGFyZW50Jywnc3Ryb2tlJzonbm9uZScsJ2N1cnNvcic6J3BvaW50ZXInfSk7ZHVtbXlfY2lyY2xlLnRyYW5zZm9ybShncmFwaC5nZXRfdHJhbnNmb3JtKCkpO2dyYXBoLnNldF9zY3JvbGxpbmcoZHVtbXlfY2lyY2xlKTt0aGlzLmdldF9wb3M9ZnVuY3Rpb24oKXtyZXR1cm4gZW50aXR5LmdldF9wb3MoKS5hZGRfeHkocG9zX3gscG9zX3kpO307dGhpcy51cGRhdGVfcG9zPWZ1bmN0aW9uKCl7dmFyIHBvcz1zZWxmLmdldF9wb3MoKTtjbG9zZV9jaXJjbGUuYXR0cih7J2N4Jzpwb3MueCwnY3knOnBvcy55fSk7ZHVtbXlfY2lyY2xlLmF0dHIoeydjeCc6cG9zLngsJ2N5Jzpwb3MueX0pO2Nsb3NlX2xhYmVsLmF0dHIoeyd4Jzpwb3MueCwneSc6cG9zLnl9KTt9O2Z1bmN0aW9uIGhvdmVyX2luKCl7aWYoIXZpc2libGUpe3JldHVybjt9CmNsb3NlX2NpcmNsZS5hbmltYXRlKHsncic6Y2xvc2VfYnV0dG9uX3JhZGl1cyoxLjV9LDMwMCwnZWxhc3RpYycpO2R1bW15X2NpcmNsZS5hbmltYXRlKHsncic6Y2xvc2VfYnV0dG9uX3JhZGl1cyoxLjV9LDMwMCwnZWxhc3RpYycpO30KZnVuY3Rpb24gaG92ZXJfb3V0KCl7aWYoIXZpc2libGUpe3JldHVybjt9CmNsb3NlX2NpcmNsZS5hbmltYXRlKHsncic6Y2xvc2VfYnV0dG9uX3JhZGl1c30sNDAwLCdsaW5lYXInKTtkdW1teV9jaXJjbGUuYW5pbWF0ZSh7J3InOmNsb3NlX2J1dHRvbl9yYWRpdXN9LDQwMCwnbGluZWFyJyk7fQpkdW1teV9jaXJjbGUuaG92ZXIoaG92ZXJfaW4saG92ZXJfb3V0KTtjbG9zZV9jaXJjbGUuaG92ZXIoaG92ZXJfaW4saG92ZXJfb3V0KTtjbG9zZV9sYWJlbC5ob3Zlcihob3Zlcl9pbixob3Zlcl9vdXQpO2Z1bmN0aW9uIGNsaWNrX2FjdGlvbigpe2lmKCF2aXNpYmxlKXtyZXR1cm47fQpjbG9zZV9jaXJjbGUuYXR0cih7J3InOmNsb3NlX2J1dHRvbl9yYWRpdXMqMn0pO2R1bW15X2NpcmNsZS5hdHRyKHsncic6Y2xvc2VfYnV0dG9uX3JhZGl1cyoyfSk7Y2xvc2VfY2lyY2xlLmFuaW1hdGUoeydyJzpjbG9zZV9idXR0b25fcmFkaXVzfSw0MDAsJ2xpbmVhcicpO2R1bW15X2NpcmNsZS5hbmltYXRlKHsncic6Y2xvc2VfYnV0dG9uX3JhZGl1c30sNDAwLCdsaW5lYXInKTtpZihlbnRpdHlfdHlwZT09Im5vZGUiKXtQcm9taXNlLnJlc29sdmUoR3JhcGhOb2RlLmRlc3RydWN0aW9uX2NhbGxiYWNrKGVudGl0eSkpLnRoZW4oZnVuY3Rpb24oKXtlbnRpdHkucmVtb3ZlKCk7fSk7fWVsc2UgaWYoZW50aXR5X3R5cGU9PSJlZGdlIil7UHJvbWlzZS5yZXNvbHZlKEdyYXBoRWRnZS5kZXN0cnVjdGlvbl9jYWxsYmFjayhlbnRpdHkpKS50aGVuKGZ1bmN0aW9uKCl7ZW50aXR5LnJlbW92ZSgpO30pO319CmR1bW15X2NpcmNsZS5jbGljayhjbGlja19hY3Rpb24pO2Nsb3NlX2NpcmNsZS5jbGljayhjbGlja19hY3Rpb24pO2Nsb3NlX2xhYmVsLmNsaWNrKGNsaWNrX2FjdGlvbik7dGhpcy5zaG93PWZ1bmN0aW9uKCl7aWYoIXZpc2libGUpe2Nsb3NlX2NpcmNsZS5hbmltYXRlKHsnb3BhY2l0eSc6MX0sMTAwLCdsaW5lYXInKTtjbG9zZV9sYWJlbC5hbmltYXRlKHsnb3BhY2l0eSc6MX0sMTAwLCdsaW5lYXInKTt2aXNpYmxlPXRydWU7fX0KdGhpcy5oaWRlPWZ1bmN0aW9uKCl7aWYodmlzaWJsZSl7Y2xvc2VfY2lyY2xlLmFuaW1hdGUoeydvcGFjaXR5JzowfSwxMDAsJ2xpbmVhcicpO2Nsb3NlX2xhYmVsLmFuaW1hdGUoeydvcGFjaXR5JzowfSwxMDAsJ2xpbmVhcicpO3Zpc2libGU9ZmFsc2U7fX0KdGhpcy5yZW1vdmU9ZnVuY3Rpb24oKXtpZih2aXNpYmxlKXt2aXNpYmxlPWZhbHNlO2Nsb3NlX2NpcmNsZS5hbmltYXRlKHsnb3BhY2l0eSc6MH0sMTAwLCdsaW5lYXInKTtjbG9zZV9sYWJlbC5hbmltYXRlKHsnb3BhY2l0eSc6MH0sMTAwLCdsaW5lYXInLHNlbGYucmVtb3ZlKTt9ZWxzZXtjbG9zZV9jaXJjbGUucmVtb3ZlKCk7Y2xvc2VfbGFiZWwucmVtb3ZlKCk7ZHVtbXlfY2lyY2xlLnJlbW92ZSgpO319fQpmdW5jdGlvbiBDb25uZWN0b3IoZ3JhcGgsbm9kZSxwb3NfeCxwb3NfeSl7dmFyIHZpc2libGU9ZmFsc2U7dmFyIGNvbm5fY2lyY2xlPWdyYXBoLnIuY2lyY2xlKG5vZGUuZ2V0X3BvcygpLngrcG9zX3gsbm9kZS5nZXRfcG9zKCkueStwb3NfeSw0KTtjb25uX2NpcmNsZS5hdHRyKHsnb3BhY2l0eSc6MCwnZmlsbCc6Z3JhcGguc3R5bGUubm9kZV9vdXRsaW5lX2NvbG9yLCdzdHJva2UnOidub25lJ30pO2Nvbm5fY2lyY2xlLnRyYW5zZm9ybShncmFwaC5nZXRfdHJhbnNmb3JtKCkpO2dyYXBoLnNldF9zY3JvbGxpbmcoY29ubl9jaXJjbGUpO3ZhciBzZWxmPXRoaXM7dGhpcy51cGRhdGVfcG9zPWZ1bmN0aW9uKCl7Y29ubl9jaXJjbGUuYXR0cih7J2N4Jzpub2RlLmdldF9wb3MoKS54K3Bvc194LCdjeSc6bm9kZS5nZXRfcG9zKCkueStwb3NfeX0pO307dGhpcy5nZXRfcG9zPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBub2RlLmdldF9wb3MoKS5hZGRfeHkocG9zX3gscG9zX3kpO307dGhpcy5yZW1vdmU9ZnVuY3Rpb24oKXtjb25uX2NpcmNsZS5yZW1vdmUoKTt9CmZ1bmN0aW9uIGhvdmVyX2luKCl7aWYoIXZpc2libGUpe3JldHVybjt9CmNvbm5fY2lyY2xlLmFuaW1hdGUoeydyJzo4fSwzMDAsJ2VsYXN0aWMnKTtpZihncmFwaC5jcmVhdGluZ19lZGdlKXtncmFwaC50YXJnZXRfbm9kZT1ub2RlO2Nvbm5fY2lyY2xlLmFuaW1hdGUoeydmaWxsJzpncmFwaC5zdHlsZS5jb25uZWN0b3JfYWN0aXZlX2NvbG9yLCdzdHJva2UnOmdyYXBoLnN0eWxlLm5vZGVfb3V0bGluZV9jb2xvciwnc3Ryb2tlLXdpZHRoJzpncmFwaC5zdHlsZS5ub2RlX3NlbGVjdGVkX3dpZHRoLH0sMTAwLCdsaW5lYXInKTt9fQpmdW5jdGlvbiBob3Zlcl9vdXQoKXtpZighdmlzaWJsZSl7cmV0dXJuO30KY29ubl9jaXJjbGUuYW5pbWF0ZSh7J3InOmdyYXBoLnN0eWxlLmNvbm5lY3Rvcl9yYWRpdXMsJ2ZpbGwnOmdyYXBoLnN0eWxlLm5vZGVfb3V0bGluZV9jb2xvciwnc3Ryb2tlJzonbm9uZSd9LDQwMCwnbGluZWFyJyk7Z3JhcGgudGFyZ2V0X25vZGU9bnVsbDt9CmNvbm5fY2lyY2xlLmhvdmVyKGhvdmVyX2luLGhvdmVyX291dCk7dmFyIGRyYWdfZG93bj1mdW5jdGlvbigpe2lmKCF2aXNpYmxlKXtyZXR1cm47fQpzZWxmLm94PWNvbm5fY2lyY2xlLmF0dHIoImN4Iik7c2VsZi5veT1jb25uX2NpcmNsZS5hdHRyKCJjeSIpO3NlbGYuZWRnZV9zdGFydD1uZXcgRWRnZUVuZChzZWxmLm94LHNlbGYub3kpO3NlbGYuZWRnZV9lbmQ9bmV3IEVkZ2VFbmQoc2VsZi5veCxzZWxmLm95KTtzZWxmLmVkZ2VfdG1wPW5ldyBHcmFwaEVkZ2UoZ3JhcGgsJycsc2VsZi5lZGdlX3N0YXJ0LHNlbGYuZWRnZV9lbmQsdHJ1ZSk7Z3JhcGguY3JlYXRpbmdfZWRnZT10cnVlO307dmFyIGRyYWdfbW92ZT1mdW5jdGlvbihkeCxkeSl7aWYoIXZpc2libGUpe3JldHVybjt9CnNlbGYuZWRnZV9lbmQueD1zZWxmLm94K2R4O3NlbGYuZWRnZV9lbmQueT1zZWxmLm95K2R5O3NlbGYuZWRnZV90bXAudXBkYXRlKCk7fTt2YXIgZHJhZ191cD1mdW5jdGlvbigpe2lmKCF2aXNpYmxlKXtyZXR1cm47fQpncmFwaC5jcmVhdGluZ19lZGdlPWZhbHNlO3NlbGYuZWRnZV90bXAucmVtb3ZlKCk7aWYoZ3JhcGgudGFyZ2V0X25vZGUpe3ZhciBlZGdlX3Byb3A9R3JhcGhFZGdlLmNyZWF0aW9uX2NhbGxiYWNrKG5vZGUsZ3JhcGgudGFyZ2V0X25vZGUpO2lmKGVkZ2VfcHJvcCl7dmFyIG5ld19lZGdlPW5ldyBHcmFwaEVkZ2UoZ3JhcGgsZWRnZV9wcm9wLmxhYmVsLG5vZGUsZ3JhcGgudGFyZ2V0X25vZGUpO0dyYXBoRWRnZS5uZXdfZWRnZV9jYWxsYmFjayhuZXdfZWRnZSk7fX19O2Nvbm5fY2lyY2xlLmRyYWcoZHJhZ19tb3ZlLGRyYWdfZG93bixkcmFnX3VwKTtmdW5jdGlvbiBzaG93KCl7aWYoIXZpc2libGUpe2Nvbm5fY2lyY2xlLmFuaW1hdGUoeydvcGFjaXR5JzoxfSwxMDAsJ2xpbmVhcicpO3Zpc2libGU9dHJ1ZTt9fQpmdW5jdGlvbiBoaWRlKCl7aWYodmlzaWJsZSl7Y29ubl9jaXJjbGUuYW5pbWF0ZSh7J29wYWNpdHknOjB9LDEwMCwnbGluZWFyJyk7dmlzaWJsZT1mYWxzZTt9fQp0aGlzLnNob3c9c2hvdzt0aGlzLmhpZGU9aGlkZTt9CmZ1bmN0aW9uIEdyYXBoKHIsc3R5bGUsdmlld3BvcnQpe3ZhciBzZWxmPXRoaXM7dmFyIG5vZGVzPVtdO3ZhciBlZGdlcz1bXTt2YXIgZ3JhcGg9e307dmFyIGxpbmtzPXt9O3ZhciB1aWQ9MTt2YXIgc2VsZWN0ZWRfZW50aXR5PW51bGw7c2VsZi5jcmVhdGluZ19lZGdlPWZhbHNlO3NlbGYudGFyZ2V0X25vZGU9bnVsbDtzZWxmLnI9cjtzZWxmLnN0eWxlPXN0eWxlO3ZhciB0cl94PTAsdHJfeT0wO3ZhciBiYWNrZ3JvdW5kPXIucmVjdCgwLDAsJzEwMCUnLCcxMDAlJykuYXR0cih7J2ZpbGwnOid3aGl0ZScsJ3N0cm9rZSc6J25vbmUnLCdvcGFjaXR5JzowLCdjdXJzb3InOidtb3ZlJ30pO3RoaXMuZ2V0X3RyYW5zZm9ybT1mdW5jdGlvbigpe3JldHVybiJUIit0cl94KyIsIit0cl95fTt2YXIgdHJhbnNsYXRlX2FsbD1mdW5jdGlvbihkeCxkeSl7dHJfeCs9ZHg7dHJfeSs9ZHk7dmFyIHRzdHI9c2VsZi5nZXRfdHJhbnNmb3JtKCk7ci5mb3JFYWNoKGZ1bmN0aW9uKGVsKXtpZihlbCE9YmFja2dyb3VuZCl7ZWwudHJhbnNmb3JtKHRzdHIpO319KTt9O3ZhciBnZXRfYm91bmRzPWZ1bmN0aW9uKCl7dmFyIG1pbng9TnVtYmVyLk1BWF9WQUxVRTt2YXIgbWlueT1OdW1iZXIuTUFYX1ZBTFVFO3ZhciBtYXh4PU51bWJlci5NSU5fVkFMVUU7dmFyIG1heHk9TnVtYmVyLk1JTl9WQUxVRTtmb3IodmFyIGk9MDtpPG5vZGVzLmxlbmd0aDtpKyspe3ZhciBwb3M9bm9kZXNbaV0uZ2V0X3BvcygpO21pbng9TWF0aC5taW4obWlueCxwb3MueCk7bWlueT1NYXRoLm1pbihtaW55LHBvcy55KTttYXh4PU1hdGgubWF4KG1heHgscG9zLngpO21heHk9TWF0aC5tYXgobWF4eSxwb3MueSk7fQptaW54PW1pbngtc3R5bGUubm9kZV9zaXplX3gvMit0cl94O21pbnk9bWlueS1zdHlsZS5ub2RlX3NpemVfeS8yK3RyX3k7bWF4eD1tYXh4K3N0eWxlLm5vZGVfc2l6ZV94LzIrdHJfeDttYXh5PW1heHkrc3R5bGUubm9kZV9zaXplX3kvMit0cl95O3JldHVybnttaW54Om1pbngsbWlueTptaW55LG1heHg6bWF4eCxtYXh5Om1heHl9O307dmFyIHRyYW5zbGF0aW9uX3Jlc3BlY3RzX3ZpZXdwb3J0PWZ1bmN0aW9uKGR4LGR5LG1hcmdpbil7aWYoIXZpZXdwb3J0KXtyZXR1cm4gdHJ1ZTt9Cm1hcmdpbj1tYXJnaW58fDA7dmFyIGI9Z2V0X2JvdW5kcygpO3ZhciB3aWR0aD12aWV3cG9ydC5vZmZzZXRXaWR0aDt2YXIgaGVpZ2h0PXZpZXdwb3J0Lm9mZnNldEhlaWdodDtpZigoZHk8MCYmYi5tYXh5K2R5PG1hcmdpbil8fChkeT4wJiZiLm1pbnkrZHk+aGVpZ2h0LW1hcmdpbil8fChkeDwwJiZiLm1heHgrZHg8bWFyZ2luKXx8KGR4PjAmJmIubWlueCtkeD53aWR0aC1tYXJnaW4pKXtyZXR1cm4gZmFsc2U7fQpyZXR1cm4gdHJ1ZTt9CnRoaXMuc2V0X3Njcm9sbGluZz1mdW5jdGlvbihyYXBoX2VsZW1lbnQpeyQocmFwaF9lbGVtZW50Lm5vZGUpLmJpbmQoJ21vdXNld2hlZWwnLGZ1bmN0aW9uKGV2ZW50LGRlbHRhKXt2YXIgZHk9ZGVsdGEqMjA7aWYodHJhbnNsYXRpb25fcmVzcGVjdHNfdmlld3BvcnQoMCxkeSxzdHlsZS52aWV3cG9ydF9tYXJnaW4pKXt0cmFuc2xhdGVfYWxsKDAsZHkpO319KTt9O3ZhciBweCxweTt2YXIgYmdfZHJhZ19kb3duPWZ1bmN0aW9uKCl7cHg9cHk9MDt9O3ZhciBiZ19kcmFnX21vdmU9ZnVuY3Rpb24oeCx5KXt2YXIgZHg9eC1weDt2YXIgZHk9eS1weTtweD14O3B5PXk7aWYodHJhbnNsYXRpb25fcmVzcGVjdHNfdmlld3BvcnQoZHgsZHksc3R5bGUudmlld3BvcnRfbWFyZ2luKSl7dHJhbnNsYXRlX2FsbChkeCxkeSk7fX07dmFyIGJnX2RyYWdfdXA9ZnVuY3Rpb24oKXt9O2JhY2tncm91bmQuZHJhZyhiZ19kcmFnX21vdmUsYmdfZHJhZ19kb3duLGJnX2RyYWdfdXApO3RoaXMuc2V0X3Njcm9sbGluZyhiYWNrZ3JvdW5kKTt0aGlzLmFkZF9ub2RlPWZ1bmN0aW9uKG4pe25vZGVzLnB1c2gobik7bi51aWQ9dWlkKys7fTt0aGlzLmdldF9ub2RlX2xpc3Q9ZnVuY3Rpb24oKXtyZXR1cm4gbm9kZXM7fTt0aGlzLmFkZF9lZGdlPWZ1bmN0aW9uKG4xLG4yLGUpe2VkZ2VzLnB1c2goZSk7ZS51aWQ9dWlkKys7aWYoIWdyYXBoW24xLnVpZF0pZ3JhcGhbbjEudWlkXT17fTtpZighZ3JhcGhbbjEudWlkXVtuMi51aWRdKWdyYXBoW24xLnVpZF1bbjIudWlkXT1bXTtpZighbGlua3NbbjEudWlkXSlsaW5rc1tuMS51aWRdPVtdO2lmKCFsaW5rc1tuMi51aWRdKWxpbmtzW24yLnVpZF09W107Z3JhcGhbbjEudWlkXVtuMi51aWRdLnB1c2goZSk7bGlua3NbbjEudWlkXS5wdXNoKGUpO2lmKG4xIT1uMil7bGlua3NbbjIudWlkXS5wdXNoKGUpO319O3RoaXMucmVtb3ZlX2VkZ2U9ZnVuY3Rpb24oZWRnZSl7ZWRnZXM9Xy53aXRob3V0KGVkZ2VzLGVkZ2UpO3ZhciBuMT1lZGdlLmdldF9zdGFydCgpO3ZhciBuMj1lZGdlLmdldF9lbmQoKTtsaW5rc1tuMS51aWRdPV8ud2l0aG91dChsaW5rc1tuMS51aWRdLGVkZ2UpO2xpbmtzW24yLnVpZF09Xy53aXRob3V0KGxpbmtzW24yLnVpZF0sZWRnZSk7Z3JhcGhbbjEudWlkXVtuMi51aWRdPV8ud2l0aG91dChncmFwaFtuMS51aWRdW24yLnVpZF0sZWRnZSk7aWYoc2VsZWN0ZWRfZW50aXR5PT1lZGdlKXtzZWxlY3RlZF9lbnRpdHk9bnVsbDt9fTt0aGlzLnJlbW92ZV9ub2RlPWZ1bmN0aW9uKG5vZGUpe3ZhciBsaW5rZWRfZWRnZXM9c2VsZi5nZXRfbGlua2VkX2VkZ2VfbGlzdChub2RlKTtmb3IodmFyIGk9MDtpPGxpbmtlZF9lZGdlcy5sZW5ndGg7aSsrKXtsaW5rZWRfZWRnZXNbaV0ucmVtb3ZlKCk7fQpub2Rlcz1fLndpdGhvdXQobm9kZXMsbm9kZSk7aWYoc2VsZWN0ZWRfZW50aXR5PT1ub2RlKXtzZWxlY3RlZF9lbnRpdHk9bnVsbDt9fQp0aGlzLmdldF9lZGdlX2xpc3Q9ZnVuY3Rpb24objEsbjIpe3ZhciBsaXN0PVtdO2lmKCFncmFwaFtuMS51aWRdKXJldHVybiBsaXN0O2lmKCFncmFwaFtuMS51aWRdW24yLnVpZF0pcmV0dXJuIGxpc3Q7cmV0dXJuIGdyYXBoW24xLnVpZF1bbjIudWlkXTt9O3RoaXMuZ2V0X2xpbmtlZF9lZGdlX2xpc3Q9ZnVuY3Rpb24obil7aWYoIWxpbmtzW24udWlkXSlyZXR1cm5bXTtyZXR1cm4gbGlua3Nbbi51aWRdO307dGhpcy5nZXRfZWRnZV9jdXJ2YXR1cmU9ZnVuY3Rpb24objEsbjIsZSl7dmFyIGVsXzEyPXRoaXMuZ2V0X2VkZ2VfbGlzdChuMSxuMik7dmFyIGMxMj1lbF8xMi5sZW5ndGg7dmFyIGVsXzIxPXRoaXMuZ2V0X2VkZ2VfbGlzdChuMixuMSk7dmFyIGMyMT1lbF8yMS5sZW5ndGg7aWYoYzEyK2MyMT09MSl7cmV0dXJuIDA7fWVsc2V7dmFyIGluZGV4PTA7Zm9yKHZhciBpPTA7aTxjMTI7aSsrKXtpZihlbF8xMltpXS51aWQ8ZS51aWQpe2luZGV4Kys7fX0KaWYoYzIxPT0wKXtyZXR1cm4gaW5kZXgtKGMxMi0xKS8yLjA7fWVsc2V7cmV0dXJuIGluZGV4KzAuNTt9fX07dGhpcy5nZXRfbG9vcF9hbmdsZT1mdW5jdGlvbihuLGUpe3ZhciBsb29wX2xpc3Q9dGhpcy5nZXRfZWRnZV9saXN0KG4sbik7dmFyIHNsb3RzPVtdO2Zvcih2YXIgYW5nbGU9MDthbmdsZTwzNjA7YW5nbGUrPTQ1KXtzbG90cy5wdXNoKFZlYzIubmV3X3BvbGFyX2RlZygxLGFuZ2xlKSk7fQp2YXIgbGlua3M9dGhpcy5nZXRfbGlua2VkX2VkZ2VfbGlzdChuKTtmb3IodmFyIGk9MDtpPGxpbmtzLmxlbmd0aDtpKyspe3ZhciBlZGdlPWxpbmtzW2ldO2lmKCFlZGdlLmlzX2xvb3B8fGVkZ2UuaXNfbG9vcCgpKXtjb250aW51ZTt9CnZhciBlbmQ9ZWRnZS5nZXRfZW5kKCk7aWYoZW5kPT1uKXtlbmQ9ZWRnZS5nZXRfc3RhcnQoKTt9CnZhciBkaXI9ZW5kLmdldF9wb3MoKS5zdWIobi5nZXRfcG9zKCkpLm5vcm1hbGl6ZSgpO2Zvcih2YXIgcz0wO3M8c2xvdHMubGVuZ3RoO3MrKyl7dmFyIHNjb3JlPXNsb3RzW3NdLmRvdChkaXIpO2lmKHNjb3JlPDApe3Njb3JlPS0wLjIqTWF0aC5wb3coc2NvcmUsMik7fWVsc2V7c2NvcmU9TWF0aC5wb3coc2NvcmUsMik7fQppZighc2xvdHNbc10uc2NvcmUpe3Nsb3RzW3NdLnNjb3JlPXNjb3JlO31lbHNle3Nsb3RzW3NdLnNjb3JlKz1zY29yZTt9fX0Kc2xvdHMuc29ydChmdW5jdGlvbihhLGIpe3JldHVybiBhLnNjb3JlPGIuc2NvcmU/LTE6MTt9KTt2YXIgaW5kZXg9MDtmb3IodmFyIGk9MDtpPGxpbmtzLmxlbmd0aDtpKyspe3ZhciBlZGdlPWxpbmtzW2ldO2lmKCFlZGdlLmlzX2xvb3B8fCFlZGdlLmlzX2xvb3AoKSl7Y29udGludWU7fQppZihlZGdlLnVpZDxlLnVpZCl7aW5kZXgrKzt9fQppbmRleCU9c2xvdHMubGVuZ3RoO3JldHVybiBzbG90c1tpbmRleF0uYW5nbGVfZGVnKCk7fQp0aGlzLnNlbGVjdD1mdW5jdGlvbihlbnRpdHkpe2lmKHNlbGVjdGVkX2VudGl0eSl7aWYoc2VsZWN0ZWRfZW50aXR5PT1lbnRpdHkpe3JldHVybjt9ZWxzZXtpZihzZWxlY3RlZF9lbnRpdHkuc2V0X25vdF9zZWxlY3RlZCl7c2VsZWN0ZWRfZW50aXR5LnNldF9ub3Rfc2VsZWN0ZWQoKTt9CnNlbGVjdGVkX2VudGl0eT1udWxsO319CnNlbGVjdGVkX2VudGl0eT1lbnRpdHk7aWYoZW50aXR5JiZlbnRpdHkuc2V0X3NlbGVjdGVkKXtlbnRpdHkuc2V0X3NlbGVjdGVkKCk7fX07fQpmdW5jdGlvbiBHcmFwaE5vZGUoZ3JhcGgscG9zX3gscG9zX3ksbGFiZWwsdHlwZSxjb2xvcil7dmFyIHNlbGY9dGhpczt2YXIgcj1ncmFwaC5yO3ZhciBzeT1ncmFwaC5zdHlsZS5ub2RlX3NpemVfeTt2YXIgc3g9Z3JhcGguc3R5bGUubm9kZV9zaXplX3g7dmFyIG5vZGVfZmlnPW51bGw7dmFyIHNlbGVjdGVkPWZhbHNlO3RoaXMuY29ubmVjdG9ycz1bXTt0aGlzLmNsb3NlX2J1dHRvbj1udWxsO3RoaXMudWlkPTA7Z3JhcGguYWRkX25vZGUodGhpcyk7aWYodHlwZT09J2NpcmNsZScpe25vZGVfZmlnPXIuZWxsaXBzZShwb3NfeCxwb3NfeSxzeC8yLHN5LzIpO31lbHNle25vZGVfZmlnPXIucmVjdChwb3NfeC1zeC8yLHBvc195LXN5LzIsc3gsc3kpO30Kbm9kZV9maWcuYXR0cih7J2ZpbGwnOmNvbG9yLCdzdHJva2UnOmdyYXBoLnN0eWxlLm5vZGVfb3V0bGluZV9jb2xvciwnc3Ryb2tlLXdpZHRoJzpncmFwaC5zdHlsZS5ub2RlX291dGxpbmVfd2lkdGgsJ2N1cnNvcic6J3BvaW50ZXInfSk7bm9kZV9maWcudHJhbnNmb3JtKGdyYXBoLmdldF90cmFuc2Zvcm0oKSk7Z3JhcGguc2V0X3Njcm9sbGluZyhub2RlX2ZpZyk7dmFyIG5vZGVfbGFiZWw9ci50ZXh0KHBvc194LHBvc195LGxhYmVsKTtub2RlX2xhYmVsLmF0dHIoeydmaWxsJzpncmFwaC5zdHlsZS5ub2RlX2xhYmVsX2NvbG9yLCdmb250LXNpemUnOmdyYXBoLnN0eWxlLm5vZGVfbGFiZWxfZm9udF9zaXplLCdjdXJzb3InOidwb2ludGVyJ30pO25vZGVfbGFiZWwudHJhbnNmb3JtKGdyYXBoLmdldF90cmFuc2Zvcm0oKSk7Z3JhcGguc2V0X3Njcm9sbGluZyhub2RlX2xhYmVsKTt2YXIgdXBkYXRlX2xpbmtlZF9lZGdlcz1mdW5jdGlvbigpe3ZhciBlZGdlcz1ncmFwaC5nZXRfbGlua2VkX2VkZ2VfbGlzdChzZWxmKTtmb3IodmFyIGk9MDtpPGVkZ2VzLmxlbmd0aDtpKyspe2VkZ2VzW2ldLnVwZGF0ZSgpO319O3ZhciBzZXRfcG9zPWZ1bmN0aW9uKHBvcyl7aWYodHlwZT09J2NpcmNsZScpe25vZGVfZmlnLmF0dHIoeydjeCc6cG9zLngsJ2N5Jzpwb3MueX0pO31lbHNle25vZGVfZmlnLmF0dHIoeyd4Jzpwb3MueC1zeC8yLCd5Jzpwb3MueS1zeS8yfSk7fQpub2RlX2xhYmVsLmF0dHIoeyd4Jzpwb3MueCwneSc6cG9zLnl9KTtmb3IodmFyIGk9MDtpPHNlbGYuY29ubmVjdG9ycy5sZW5ndGg7aSsrKXtzZWxmLmNvbm5lY3RvcnNbaV0udXBkYXRlX3BvcygpO30KaWYoc2VsZi5jbG9zZV9idXR0b24pe3NlbGYuY2xvc2VfYnV0dG9uLnVwZGF0ZV9wb3MoKTt9CnVwZGF0ZV9saW5rZWRfZWRnZXMoKTt9O3ZhciBnZXRfZmlnPWZ1bmN0aW9uKCl7cmV0dXJuIG5vZGVfZmlnO307dmFyIGdldF9wb3M9ZnVuY3Rpb24oKXtpZih0eXBlPT0nY2lyY2xlJyl7cmV0dXJuIG5ldyBWZWMyKG5vZGVfZmlnLmF0dHIoJ2N4Jyksbm9kZV9maWcuYXR0cignY3knKSk7fWVsc2V7cmV0dXJuIG5ldyBWZWMyKG5vZGVfZmlnLmF0dHIoJ3gnKStzeC8yLG5vZGVfZmlnLmF0dHIoJ3knKStzeS8yKTt9fTt2YXIgZ2V0X2xhYmVsPWZ1bmN0aW9uKCl7cmV0dXJuIG5vZGVfbGFiZWwuYXR0cigidGV4dCIpO307dmFyIHNldF9sYWJlbD1mdW5jdGlvbih0ZXh0KXtub2RlX2xhYmVsLmF0dHIoeyd0ZXh0Jzp0ZXh0fSk7fTt2YXIgZ2V0X2JvdW5kPWZ1bmN0aW9uKCl7aWYodHlwZT09J2NpcmNsZScpe3JldHVybiBuZXcgQkVsbGlwc2UoZ2V0X3BvcygpLngsZ2V0X3BvcygpLnksc3gvMixzeS8yKTt9ZWxzZXtyZXR1cm4gQlJlY3QubmV3X2NlbnRlcmVkKGdldF9wb3MoKS54LGdldF9wb3MoKS55LHN4LHN5KTt9fTt2YXIgc2V0X3NlbGVjdGVkPWZ1bmN0aW9uKCl7aWYoIXNlbGVjdGVkKXtzZWxlY3RlZD10cnVlO25vZGVfZmlnLmF0dHIoeydzdHJva2UnOmdyYXBoLnN0eWxlLm5vZGVfc2VsZWN0ZWRfY29sb3IsJ3N0cm9rZS13aWR0aCc6Z3JhcGguc3R5bGUubm9kZV9zZWxlY3RlZF93aWR0aH0pO2lmKCFzZWxmLmNsb3NlX2J1dHRvbil7c2VsZi5jbG9zZV9idXR0b249bmV3IENsb3NlQnV0dG9uKGdyYXBoLHNlbGYsIm5vZGUiLHN4LzIsLXN5LzIpO3NlbGYuY2xvc2VfYnV0dG9uLnNob3coKTt9CmZvcih2YXIgaT0wO2k8c2VsZi5jb25uZWN0b3JzLmxlbmd0aDtpKyspe3NlbGYuY29ubmVjdG9yc1tpXS5zaG93KCk7fX19O3ZhciBzZXRfbm90X3NlbGVjdGVkPWZ1bmN0aW9uKCl7aWYoc2VsZWN0ZWQpe25vZGVfZmlnLmFuaW1hdGUoeydzdHJva2UnOmdyYXBoLnN0eWxlLm5vZGVfb3V0bGluZV9jb2xvciwnc3Ryb2tlLXdpZHRoJzpncmFwaC5zdHlsZS5ub2RlX291dGxpbmVfd2lkdGh9LDEwMCwnbGluZWFyJyk7aWYoc2VsZi5jbG9zZV9idXR0b24pe3NlbGYuY2xvc2VfYnV0dG9uLnJlbW92ZSgpO3NlbGYuY2xvc2VfYnV0dG9uPW51bGw7fQpzZWxlY3RlZD1mYWxzZTt9CmZvcih2YXIgaT0wO2k8c2VsZi5jb25uZWN0b3JzLmxlbmd0aDtpKyspe3NlbGYuY29ubmVjdG9yc1tpXS5oaWRlKCk7fX07dmFyIHJlbW92ZT1mdW5jdGlvbigpe2lmKHNlbGYuY2xvc2VfYnV0dG9uKXtzZWxmLmNsb3NlX2J1dHRvbi5yZW1vdmUoKTt9CmZvcih2YXIgaT0wO2k8c2VsZi5jb25uZWN0b3JzLmxlbmd0aDtpKyspe3NlbGYuY29ubmVjdG9yc1tpXS5yZW1vdmUoKTt9CmdyYXBoLnJlbW92ZV9ub2RlKHNlbGYpO25vZGVfZmlnLnJlbW92ZSgpO25vZGVfbGFiZWwucmVtb3ZlKCk7fQp0aGlzLnNldF9wb3M9c2V0X3Bvczt0aGlzLmdldF9wb3M9Z2V0X3Bvczt0aGlzLnNldF9sYWJlbD1zZXRfbGFiZWw7dGhpcy5nZXRfbGFiZWw9Z2V0X2xhYmVsO3RoaXMuZ2V0X2JvdW5kPWdldF9ib3VuZDt0aGlzLmdldF9maWc9Z2V0X2ZpZzt0aGlzLnNldF9zZWxlY3RlZD1zZXRfc2VsZWN0ZWQ7dGhpcy5zZXRfbm90X3NlbGVjdGVkPXNldF9ub3Rfc2VsZWN0ZWQ7dGhpcy51cGRhdGVfbGlua2VkX2VkZ2VzPXVwZGF0ZV9saW5rZWRfZWRnZXM7dGhpcy5yZW1vdmU9cmVtb3ZlO3ZhciBjbGlja19hY3Rpb249ZnVuY3Rpb24oKXtpZih0eXBlPT0nY2lyY2xlJyl7bm9kZV9maWcuYXR0cih7J3J4JzpzeC8yKzMsJ3J5JzpzeS8yKzN9KTtub2RlX2ZpZy5hbmltYXRlKHsncngnOnN4LzIsJ3J5JzpzeS8yfSw1MDAsJ2VsYXN0aWMnKTt9ZWxzZXt2YXIgY3g9Z2V0X3BvcygpLng7dmFyIGN5PWdldF9wb3MoKS55O25vZGVfZmlnLmF0dHIoeyd4JzpjeC0oc3gvMiktMywneSc6Y3ktKHN5LzIpLTMsJ+G6g2lkdGgnOnN4KzYsJ2hlaWdodCc6c3krNn0pO25vZGVfZmlnLmFuaW1hdGUoeyd4JzpjeC1zeC8yLCd5JzpjeS1zeS8yLCfhuoNpZHRoJzpzeCwnaGVpZ2h0JzpzeX0sNTAwLCdlbGFzdGljJyk7fQpncmFwaC5zZWxlY3Qoc2VsZik7fTtub2RlX2ZpZy5jbGljayhjbGlja19hY3Rpb24pO25vZGVfbGFiZWwuY2xpY2soY2xpY2tfYWN0aW9uKTt2YXIgZHJhZ19kb3duPWZ1bmN0aW9uKCl7dGhpcy5vcG9zPWdldF9wb3MoKTt9O3ZhciBkcmFnX21vdmU9ZnVuY3Rpb24oZHgsZHkpe3ZhciBlZGdlcz1ncmFwaC5nZXRfbGlua2VkX2VkZ2VfbGlzdChzZWxmKTtmb3IodmFyIGk9MDtpPGVkZ2VzLmxlbmd0aDtpKyspe2VkZ2VzW2ldLmxhYmVsX2Rpc2FibGUoKTt9CmlmKHNlbGYuY2xvc2VfYnV0dG9uKXtzZWxmLmNsb3NlX2J1dHRvbi5oaWRlKCk7fQpzZXRfcG9zKHRoaXMub3Bvcy5hZGRfeHkoZHgsZHkpKTt9O3ZhciBkcmFnX3VwPWZ1bmN0aW9uKCl7dmFyIGVkZ2VzPWdyYXBoLmdldF9saW5rZWRfZWRnZV9saXN0KHNlbGYpO2Zvcih2YXIgaT0wO2k8ZWRnZXMubGVuZ3RoO2krKyl7ZWRnZXNbaV0ubGFiZWxfZW5hYmxlKCk7fQppZihzZWxmLmNsb3NlX2J1dHRvbil7c2VsZi5jbG9zZV9idXR0b24uc2hvdygpO319O25vZGVfZmlnLmRyYWcoZHJhZ19tb3ZlLGRyYWdfZG93bixkcmFnX3VwKTtub2RlX2xhYmVsLmRyYWcoZHJhZ19tb3ZlLGRyYWdfZG93bixkcmFnX3VwKTtmdW5jdGlvbiBob3Zlcl9pbigpe2lmKGdyYXBoLmNyZWF0aW5nX2VkZ2Upe2dyYXBoLnRhcmdldF9ub2RlPXNlbGY7fX0KZnVuY3Rpb24gaG92ZXJfb3V0KCl7Z3JhcGgudGFyZ2V0X25vZGU9bnVsbDt9Cm5vZGVfZmlnLmhvdmVyKGhvdmVyX2luLGhvdmVyX291dCk7bm9kZV9sYWJlbC5ob3Zlcihob3Zlcl9pbixob3Zlcl9vdXQpO2Z1bmN0aW9uIGRvdWJsZV9jbGljaygpe0dyYXBoTm9kZS5kb3VibGVfY2xpY2tfY2FsbGJhY2soc2VsZik7fQpub2RlX2ZpZy5kYmxjbGljayhkb3VibGVfY2xpY2spO25vZGVfbGFiZWwuZGJsY2xpY2soZG91YmxlX2NsaWNrKTt0aGlzLmNvbm5lY3RvcnMucHVzaChuZXcgQ29ubmVjdG9yKGdyYXBoLHRoaXMsLXN4LzIsMCkpO3RoaXMuY29ubmVjdG9ycy5wdXNoKG5ldyBDb25uZWN0b3IoZ3JhcGgsdGhpcyxzeC8yLDApKTt0aGlzLmNvbm5lY3RvcnMucHVzaChuZXcgQ29ubmVjdG9yKGdyYXBoLHRoaXMsMCwtc3kvMikpO3RoaXMuY29ubmVjdG9ycy5wdXNoKG5ldyBDb25uZWN0b3IoZ3JhcGgsdGhpcywwLHN5LzIpKTt0aGlzLmNsb3NlX2J1dHRvbj1uZXcgQ2xvc2VCdXR0b24oZ3JhcGgsdGhpcywibm9kZSIsc3gvMiwtc3kvMik7fQpHcmFwaE5vZGUuZG91YmxlX2NsaWNrX2NhbGxiYWNrPWZ1bmN0aW9uKG5vZGUpe2NvbnNvbGUubG9nKCJkb3VibGUgY2xpY2sgZnJvbSBub2RlOiIsbm9kZSk7fTtHcmFwaE5vZGUuZGVzdHJ1Y3Rpb25fY2FsbGJhY2s9ZnVuY3Rpb24obm9kZSl7cmV0dXJuIHRydWU7fTtmdW5jdGlvbiBHcmFwaEVkZ2UoZ3JhcGgsbGFiZWwsc3RhcnQsZW5kLHRtcCl7dmFyIHNlbGY9dGhpczt2YXIgcj1ncmFwaC5yO3ZhciBjdXJ2YXR1cmU9MDt2YXIgcyxlO3ZhciBtYzt2YXIgbWMxLG1jMjt2YXIgZWxmcz1ncmFwaC5zdHlsZS5lZGdlX2xhYmVsX2ZvbnRfc2l6ZXx8MTA7dmFyIGxhYmVsX2VuYWJsZWQ9dHJ1ZTt0aGlzLnVpZD0wO3ZhciBlZGdlX3BhdGg9IiI7dmFyIHNlbGVjdGVkPWZhbHNlO2lmKCF0bXApe2dyYXBoLmFkZF9lZGdlKHN0YXJ0LGVuZCx0aGlzKTt9CmZ1bmN0aW9uIGdldF9sYWJlbF9wb3MocGF0aCl7dmFyIGNwb3M9cGF0aC5nZXRUb3RhbExlbmd0aCgpKjAuNTt2YXIgY2luZGV4PU1hdGguYWJzKE1hdGguZmxvb3IoY3VydmF0dXJlKSk7dmFyIG1vZD0oKGNpbmRleCUzKSkqKGVsZnMqMy4xKS0oZWxmcyowLjUpO3ZhciB2ZXJ0aWNhbGl0eT1NYXRoLmFicyhlbmQuZ2V0X3BvcygpLnN1YihzdGFydC5nZXRfcG9zKCkpLm5vcm1hbGl6ZSgpLmRvdF94eSgwLDEpKTt2ZXJ0aWNhbGl0eT1NYXRoLm1heCh2ZXJ0aWNhbGl0eS0wLjUsMCkqMjt2YXIgbHBvcz1wYXRoLmdldFBvaW50QXRMZW5ndGgoY3Bvcyttb2QqdmVydGljYWxpdHkpO3JldHVybiBuZXcgVmVjMihscG9zLngsbHBvcy55LWVsZnMqKDEtdmVydGljYWxpdHkpKTt9CnRoaXMuZ2V0X3Bvcz1mdW5jdGlvbigpe2lmKCFlZGdlKXtyZXR1cm4gc3RhcnQuZ2V0X3BvcygpLmxlcnAoZW5kLmdldF9wb3MoKSwwLjUpO30KcmV0dXJuIGdldF9sYWJlbF9wb3MoZWRnZSk7fQpmdW5jdGlvbiBtYWtlX2xpbmUoKXtyZXR1cm4iTSIrcy54KyIsIitzLnkrIkwiK2UueCsiLCIrZS55O30KZnVuY3Rpb24gbWFrZV9jdXJ2ZSgpe3JldHVybiJNIitzLngrIiwiK3MueSsiUSIrbWMueCsiLCIrbWMueSsiICIrZS54KyIsIitlLnk7fQpmdW5jdGlvbiBtYWtlX2xvb3AoKXtyZXR1cm4iTSIrcy54KyIgIitzLnkrIkMiK21jMS54KyIgIittYzEueSsiICIrbWMyLngrIiAiK21jMi55KyIgIitlLngrIiAiK2UueTt9CmZ1bmN0aW9uIHVwZGF0ZV9jdXJ2ZSgpe2lmKHN0YXJ0IT1lbmQpe2lmKCF0bXApe2N1cnZhdHVyZT1ncmFwaC5nZXRfZWRnZV9jdXJ2YXR1cmUoc3RhcnQsZW5kLHNlbGYpO31lbHNle2N1cnZhdHVyZT0wO30Kcz1zdGFydC5nZXRfcG9zKCk7ZT1lbmQuZ2V0X3BvcygpO21jPXMubGVycChlLDAuNSk7dmFyIHNlPWUuc3ViKHMpO3NlPXNlLm5vcm1hbGl6ZSgpO3NlPXNlLnJvdGF0ZV9kZWcoLTkwKTtzZT1zZS5zY2FsZShjdXJ2YXR1cmUqZ3JhcGguc3R5bGUuZWRnZV9zcGFjaW5nKTttYz1tYy5hZGQoc2UpO2lmKHN0YXJ0LmdldF9ib3VuZCl7dmFyIGNvbD1zdGFydC5nZXRfYm91bmQoKS5jb2xsaWRlX3NlZ21lbnQocyxtYyk7aWYoY29sLmxlbmd0aD4wKXtzPWNvbFswXTt9fQppZihlbmQuZ2V0X2JvdW5kKXt2YXIgY29sPWVuZC5nZXRfYm91bmQoKS5jb2xsaWRlX3NlZ21lbnQobWMsZSk7aWYoY29sLmxlbmd0aD4wKXtlPWNvbFswXTt9fQppZihjdXJ2YXR1cmUhPTApe2VkZ2VfcGF0aD1tYWtlX2N1cnZlKCk7fWVsc2V7ZWRnZV9wYXRoPW1ha2VfbGluZSgpO319ZWxzZXt2YXIgcmFkPWdyYXBoLnN0eWxlLmVkZ2VfbG9vcF9yYWRpdXN8fDEwMDtzPXN0YXJ0LmdldF9wb3MoKTtlPWVuZC5nZXRfcG9zKCk7dmFyIHI9VmVjMi5uZXdfcG9sYXJfZGVnKHJhZCxncmFwaC5nZXRfbG9vcF9hbmdsZShzdGFydCxzZWxmKSk7bWM9cy5hZGQocik7dmFyIHA9ci5yb3RhdGVfZGVnKDkwKTttYzE9bWMuYWRkKHAuc2V0X2xlbihyYWQqMC41KSk7bWMyPW1jLmFkZChwLnNldF9sZW4oLXJhZCowLjUpKTtpZihzdGFydC5nZXRfYm91bmQpe3ZhciBjb2w9c3RhcnQuZ2V0X2JvdW5kKCkuY29sbGlkZV9zZWdtZW50KHMsbWMxKTtpZihjb2wubGVuZ3RoPjApe3M9Y29sWzBdO30KdmFyIGNvbD1zdGFydC5nZXRfYm91bmQoKS5jb2xsaWRlX3NlZ21lbnQoZSxtYzIpO2lmKGNvbC5sZW5ndGg+MCl7ZT1jb2xbMF07fX0KZWRnZV9wYXRoPW1ha2VfbG9vcCgpO319CnVwZGF0ZV9jdXJ2ZSgpO3ZhciBlZGdlPXIucGF0aChlZGdlX3BhdGgpLmF0dHIoeydzdHJva2UnOmdyYXBoLnN0eWxlLmVkZ2VfY29sb3IsJ3N0cm9rZS13aWR0aCc6Z3JhcGguc3R5bGUuZWRnZV93aWR0aCwnYXJyb3ctZW5kJzonYmxvY2std2lkZS1sb25nJywnY3Vyc29yJzoncG9pbnRlcid9KS5pbnNlcnRCZWZvcmUoZ3JhcGguZ2V0X25vZGVfbGlzdCgpWzBdLmdldF9maWcoKSk7dmFyIGxhYmVscG9zPWdldF9sYWJlbF9wb3MoZWRnZSk7dmFyIGVkZ2VfbGFiZWw9ci50ZXh0KGxhYmVscG9zLngsbGFiZWxwb3MueS1lbGZzLGxhYmVsKS5hdHRyKHsnZmlsbCc6Z3JhcGguc3R5bGUuZWRnZV9sYWJlbF9jb2xvciwnY3Vyc29yJzoncG9pbnRlcicsJ2ZvbnQtc2l6ZSc6ZWxmc30pO2VkZ2UudHJhbnNmb3JtKGdyYXBoLmdldF90cmFuc2Zvcm0oKSk7Z3JhcGguc2V0X3Njcm9sbGluZyhlZGdlKTtlZGdlX2xhYmVsLnRyYW5zZm9ybShncmFwaC5nZXRfdHJhbnNmb3JtKCkpO2dyYXBoLnNldF9zY3JvbGxpbmcoZWRnZV9sYWJlbCk7aWYoIXRtcCl7dmFyIGVkZ2VzX3N0YXJ0PWdyYXBoLmdldF9saW5rZWRfZWRnZV9saXN0KHN0YXJ0KTt2YXIgZWRnZXNfZW5kPWdyYXBoLmdldF9saW5rZWRfZWRnZV9saXN0KGVuZCk7dmFyIGVkZ2VzPWVkZ2VzX3N0YXJ0Lmxlbmd0aDxlZGdlc19lbmQubGVuZ3RoP2VkZ2VzX3N0YXJ0OmVkZ2VzX2VuZDtmb3IodmFyIGk9MDtpPGVkZ2VzLmxlbmd0aDtpKyspe2lmKGVkZ2VzW2ldIT1zZWxmKXtlZGdlc1tpXS51cGRhdGUoKTt9fX0KZnVuY3Rpb24gbGFiZWxfZW5hYmxlKCl7aWYoIWxhYmVsX2VuYWJsZWQpe2xhYmVsX2VuYWJsZWQ9dHJ1ZTtlZGdlX2xhYmVsLmFuaW1hdGUoeydvcGFjaXR5JzoxfSwxMDAsJ2xpbmVhcicpO2lmKHNlbGYuY2xvc2VfYnV0dG9uKXtzZWxmLmNsb3NlX2J1dHRvbi5zaG93KCk7fQpzZWxmLnVwZGF0ZSgpO319CmZ1bmN0aW9uIGxhYmVsX2Rpc2FibGUoKXtpZihsYWJlbF9lbmFibGVkKXtsYWJlbF9lbmFibGVkPWZhbHNlO2VkZ2VfbGFiZWwuYW5pbWF0ZSh7J29wYWNpdHknOjB9LDEwMCwnbGluZWFyJyk7aWYoc2VsZi5jbG9zZV9idXR0b24pe3NlbGYuY2xvc2VfYnV0dG9uLmhpZGUoKTt9fX0KZnVuY3Rpb24gdXBkYXRlKCl7dXBkYXRlX2N1cnZlKCk7ZWRnZS5hdHRyKHsncGF0aCc6ZWRnZV9wYXRofSk7aWYobGFiZWxfZW5hYmxlZCl7dmFyIGxhYmVscG9zPWdldF9sYWJlbF9wb3MoZWRnZSk7ZWRnZV9sYWJlbC5hdHRyKHsneCc6bGFiZWxwb3MueCwneSc6bGFiZWxwb3MueS0xNH0pO319CmZ1bmN0aW9uIHJlbW92ZSgpe2VkZ2UucmVtb3ZlKCk7ZWRnZV9sYWJlbC5yZW1vdmUoKTtpZighdG1wKXtncmFwaC5yZW1vdmVfZWRnZShzZWxmKTt9CmlmKHN0YXJ0LnVwZGF0ZV9saW5rZWRfZWRnZXMpe3N0YXJ0LnVwZGF0ZV9saW5rZWRfZWRnZXMoKTt9CmlmKHN0YXJ0IT1lbmQmJmVuZC51cGRhdGVfbGlua2VkX2VkZ2VzKXtlbmQudXBkYXRlX2xpbmtlZF9lZGdlcygpO30KaWYoc2VsZi5jbG9zZV9idXR0b24pe3NlbGYuY2xvc2VfYnV0dG9uLnJlbW92ZSgpO319CnRoaXMuc2V0X3NlbGVjdGVkPWZ1bmN0aW9uKCl7aWYoIXNlbGVjdGVkKXtzZWxlY3RlZD10cnVlO2VkZ2UuYXR0cih7J3N0cm9rZSc6Z3JhcGguc3R5bGUubm9kZV9zZWxlY3RlZF9jb2xvciwnc3Ryb2tlLXdpZHRoJzpncmFwaC5zdHlsZS5ub2RlX3NlbGVjdGVkX3dpZHRofSk7ZWRnZV9sYWJlbC5hdHRyKHsnZmlsbCc6Z3JhcGguc3R5bGUubm9kZV9zZWxlY3RlZF9jb2xvcn0pO2lmKCFzZWxmLmNsb3NlX2J1dHRvbil7c2VsZi5jbG9zZV9idXR0b249bmV3IENsb3NlQnV0dG9uKGdyYXBoLHNlbGYsImVkZ2UiLDAsMzApO3NlbGYuY2xvc2VfYnV0dG9uLnNob3coKTt9fX07dGhpcy5zZXRfbm90X3NlbGVjdGVkPWZ1bmN0aW9uKCl7aWYoc2VsZWN0ZWQpe3NlbGVjdGVkPWZhbHNlO2VkZ2UuYW5pbWF0ZSh7J3N0cm9rZSc6Z3JhcGguc3R5bGUuZWRnZV9jb2xvciwnc3Ryb2tlLXdpZHRoJzpncmFwaC5zdHlsZS5lZGdlX3dpZHRofSwxMDAsJ2xpbmVhcicpO2VkZ2VfbGFiZWwuYW5pbWF0ZSh7J2ZpbGwnOmdyYXBoLnN0eWxlLmVkZ2VfbGFiZWxfY29sb3J9LDEwMCwnbGluZWFyJyk7aWYoc2VsZi5jbG9zZV9idXR0b24pe3NlbGYuY2xvc2VfYnV0dG9uLnJlbW92ZSgpO3NlbGYuY2xvc2VfYnV0dG9uPW51bGw7fX19O2Z1bmN0aW9uIGNsaWNrX2FjdGlvbigpe2dyYXBoLnNlbGVjdChzZWxmKTt9CmVkZ2UuY2xpY2soY2xpY2tfYWN0aW9uKTtlZGdlX2xhYmVsLmNsaWNrKGNsaWNrX2FjdGlvbik7ZnVuY3Rpb24gZG91YmxlX2NsaWNrX2FjdGlvbigpe0dyYXBoRWRnZS5kb3VibGVfY2xpY2tfY2FsbGJhY2soc2VsZik7fQplZGdlLmRibGNsaWNrKGRvdWJsZV9jbGlja19hY3Rpb24pO2VkZ2VfbGFiZWwuZGJsY2xpY2soZG91YmxlX2NsaWNrX2FjdGlvbik7dGhpcy5sYWJlbF9lbmFibGU9bGFiZWxfZW5hYmxlO3RoaXMubGFiZWxfZGlzYWJsZT1sYWJlbF9kaXNhYmxlO3RoaXMudXBkYXRlPXVwZGF0ZTt0aGlzLnJlbW92ZT1yZW1vdmU7dGhpcy5pc19sb29wPWZ1bmN0aW9uKCl7cmV0dXJuIHN0YXJ0PT1lbmQ7fTt0aGlzLmdldF9zdGFydD1mdW5jdGlvbigpe3JldHVybiBzdGFydDt9O3RoaXMuZ2V0X2VuZD1mdW5jdGlvbigpe3JldHVybiBlbmQ7fTt9CkdyYXBoRWRnZS5kb3VibGVfY2xpY2tfY2FsbGJhY2s9ZnVuY3Rpb24oZWRnZSl7Y29uc29sZS5sb2coImRvdWJsZSBjbGljayBmcm9tIGVkZ2U6IixlZGdlKTt9O0dyYXBoRWRnZS5jcmVhdGlvbl9jYWxsYmFjaz1mdW5jdGlvbihzdGFydCxlbmQpe3ZhciBlZGdlX3Byb3A9e307ZWRnZV9wcm9wLmxhYmVsPSduZXcgZWRnZSEnO3JldHVybiBlZGdlX3Byb3A7fTtHcmFwaEVkZ2UubmV3X2VkZ2VfY2FsbGJhY2s9ZnVuY3Rpb24obmV3X2VkZ2Upe307R3JhcGhFZGdlLmRlc3RydWN0aW9uX2NhbGxiYWNrPWZ1bmN0aW9uKGVkZ2Upe3JldHVybiB0cnVlO307ZnVuY3Rpb24gd29yZHdyYXAoc3RyLHdpZHRoKXt3aWR0aD13aWR0aHx8MzI7dmFyIGN1dD10cnVlO3ZhciBicms9J1xuJztpZighc3RyKXtyZXR1cm4gc3RyO30KdmFyIHJlZ2V4PScuezEsJyt3aWR0aCsnfShcXHN8JCknKyhjdXQ/J3wueycrd2lkdGgrJ318LiskJzonfFxcUys/KFxcc3wkKScpO3JldHVybiBzdHIubWF0Y2gobmV3IFJlZ0V4cChyZWdleCwnZycpKS5qb2luKGJyayk7fQp3aW5kb3cuQ3V0ZUdyYXBoPUdyYXBoO3dpbmRvdy5DdXRlTm9kZT1HcmFwaE5vZGU7d2luZG93LkN1dGVFZGdlPUdyYXBoRWRnZTt3aW5kb3cuQ3V0ZUdyYXBoLndvcmR3cmFwPXdvcmR3cmFwO30pKHdpbmRvdyk7OwoKLyogL3dlYl9kaWFncmFtL3N0YXRpYy9zcmMvanMvZGlhZ3JhbV9tb2RlbC5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwpvZG9vLmRlZmluZSgnd2ViX2RpYWdyYW0uRGlhZ3JhbU1vZGVsJyxmdW5jdGlvbihyZXF1aXJlKXsidXNlIHN0cmljdCI7dmFyIEFic3RyYWN0TW9kZWw9cmVxdWlyZSgnd2ViLkFic3RyYWN0TW9kZWwnKTt2YXIgRGlhZ3JhbU1vZGVsPUFic3RyYWN0TW9kZWwuZXh0ZW5kKHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gJC5leHRlbmQodHJ1ZSx7fSx7bGFiZWxzOnRoaXMubGFiZWxzLG5vZGVzOnRoaXMuZGF0YW5vZGVzLGVkZ2VzOnRoaXMuZWRnZXMsbm9kZV9tb2RlbDp0aGlzLm5vZGVfbW9kZWwscGFyZW50X2ZpZWxkOnRoaXMucGFyZW50X2ZpZWxkLHJlc19pZDp0aGlzLnJlc19pZCxjb25uZWN0b3JfbW9kZWw6dGhpcy5jb25uZWN0b3JfbW9kZWwsY29ubmVjdG9yczp0aGlzLmNvbm5lY3RvcnMsfSk7fSxsb2FkOmZ1bmN0aW9uKHBhcmFtcyl7dGhpcy5tb2RlbE5hbWU9cGFyYW1zLm1vZGVsTmFtZTt0aGlzLnJlc19pZD1wYXJhbXMucmVzX2lkO3RoaXMubm9kZV9tb2RlbD1wYXJhbXMubm9kZV9tb2RlbDt0aGlzLmNvbm5lY3Rvcl9tb2RlbD1wYXJhbXMuY29ubmVjdG9yX21vZGVsO3RoaXMuY29ubmVjdG9ycz1wYXJhbXMuY29ubmVjdG9yczt0aGlzLm5vZGVzPXBhcmFtcy5ub2Rlczt0aGlzLnZpc2libGVfbm9kZXM9cGFyYW1zLnZpc2libGVfbm9kZXM7dGhpcy5pbnZpc2libGVfbm9kZXM9cGFyYW1zLmludmlzaWJsZV9ub2Rlczt0aGlzLm5vZGVfZmllbGRzX3N0cmluZz1wYXJhbXMubm9kZV9maWVsZHNfc3RyaW5nO3RoaXMuY29ubmVjdG9yX2ZpZWxkc19zdHJpbmc9cGFyYW1zLmNvbm5lY3Rvcl9maWVsZHNfc3RyaW5nO3RoaXMubGFiZWxzPXBhcmFtcy5sYWJlbHM7cmV0dXJuIHRoaXMuX2ZldGNoRGlhZ3JhbUluZm8oKTt9LHJlbG9hZDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9mZXRjaERpYWdyYW1JbmZvKCk7fSxfZmV0Y2hEaWFncmFtSW5mbzpmdW5jdGlvbigpe3ZhciBzZWxmPXRoaXM7cmV0dXJuIHRoaXMuX3JwYyh7cm91dGU6Jy93ZWJfZGlhZ3JhbS9kaWFncmFtL2dldF9kaWFncmFtX2luZm8nLHBhcmFtczp7aWQ6dGhpcy5yZXNfaWQsbW9kZWw6dGhpcy5tb2RlbE5hbWUsbm9kZTp0aGlzLm5vZGVfbW9kZWwsY29ubmVjdG9yOnRoaXMuY29ubmVjdG9yX21vZGVsLHNyY19ub2RlOnRoaXMuY29ubmVjdG9ycy5hdHRycy5zb3VyY2UsZGVzX25vZGU6dGhpcy5jb25uZWN0b3JzLmF0dHJzLmRlc3RpbmF0aW9uLGxhYmVsOnRoaXMuY29ubmVjdG9ycy5hdHRycy5sYWJlbHx8ZmFsc2UsYmdjb2xvcjp0aGlzLm5vZGVzLmF0dHJzLmJnY29sb3Isc2hhcGU6dGhpcy5ub2Rlcy5hdHRycy5zaGFwZSx2aXNpYmxlX25vZGVzOnRoaXMudmlzaWJsZV9ub2RlcyxpbnZpc2libGVfbm9kZXM6dGhpcy5pbnZpc2libGVfbm9kZXMsbm9kZV9maWVsZHNfc3RyaW5nOnRoaXMubm9kZV9maWVsZHNfc3RyaW5nLGNvbm5lY3Rvcl9maWVsZHNfc3RyaW5nOnRoaXMuY29ubmVjdG9yX2ZpZWxkc19zdHJpbmcsfSx9KS50aGVuKGZ1bmN0aW9uKGRhdGEpe3NlbGYuZGF0YW5vZGVzPWRhdGEubm9kZXM7c2VsZi5lZGdlcz1kYXRhLmNvbm47c2VsZi5wYXJlbnRfZmllbGQ9ZGF0YS5wYXJlbnRfZmllbGQ7fSk7fSx9KTtyZXR1cm4gRGlhZ3JhbU1vZGVsO30pOzsKCi8qIC93ZWJfZGlhZ3JhbS9zdGF0aWMvc3JjL2pzL2RpYWdyYW1fY29udHJvbGxlci5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwpvZG9vLmRlZmluZSgnd2ViX2RpYWdyYW0uRGlhZ3JhbUNvbnRyb2xsZXInLGZ1bmN0aW9uKHJlcXVpcmUpeyJ1c2Ugc3RyaWN0Ijt2YXIgQWJzdHJhY3RDb250cm9sbGVyPXJlcXVpcmUoJ3dlYi5BYnN0cmFjdENvbnRyb2xsZXInKTt2YXIgY29yZT1yZXF1aXJlKCd3ZWIuY29yZScpO3ZhciBEaWFsb2c9cmVxdWlyZSgnd2ViLkRpYWxvZycpO3ZhciB2aWV3X2RpYWxvZ3M9cmVxdWlyZSgnd2ViLnZpZXdfZGlhbG9ncycpO3ZhciBfdD1jb3JlLl90O3ZhciBRV2ViPWNvcmUucXdlYjt2YXIgRm9ybVZpZXdEaWFsb2c9dmlld19kaWFsb2dzLkZvcm1WaWV3RGlhbG9nO3ZhciBEaWFncmFtQ29udHJvbGxlcj1BYnN0cmFjdENvbnRyb2xsZXIuZXh0ZW5kKHtjbGFzc05hbWU6J29fZGlhZ3JhbV92aWV3JyxjdXN0b21fZXZlbnRzOnthZGRfZWRnZTonX29uQWRkRWRnZScsZWRpdF9lZGdlOidfb25FZGl0RWRnZScsZWRpdF9ub2RlOidfb25FZGl0Tm9kZScscmVtb3ZlX2VkZ2U6J19vblJlbW92ZUVkZ2UnLHJlbW92ZV9ub2RlOidfb25SZW1vdmVOb2RlJyx9LGluaXQ6ZnVuY3Rpb24ocGFyZW50LG1vZGVsLHJlbmRlcmVyLHBhcmFtcyl7dGhpcy5fc3VwZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3RoaXMuZG9tYWluPXBhcmFtcy5kb21haW58fFtdO3RoaXMuY29udGV4dD1wYXJhbXMuY29udGV4dDt0aGlzLmlkcz1wYXJhbXMuaWRzO3RoaXMuY3VycmVudElkPXBhcmFtcy5jdXJyZW50SWQ7fSxyZW5kZXJCdXR0b25zOmZ1bmN0aW9uKCRub2RlKXt0aGlzLiRidXR0b25zPSQoUVdlYi5yZW5kZXIoIkRpYWdyYW1WaWV3LmJ1dHRvbnMiLHt3aWRnZXQ6dGhpc30pKTt0aGlzLiRidXR0b25zLm9uKCdjbGljaycsJy5vX2RpYWdyYW1fbmV3X2J1dHRvbicsdGhpcy5fYWRkTm9kZS5iaW5kKHRoaXMpKTt0aGlzLiRidXR0b25zLmFwcGVuZFRvKCRub2RlKTt9LF9hZGROb2RlOmZ1bmN0aW9uKCl7dmFyIHN0YXRlPXRoaXMubW9kZWwuZ2V0KCk7dmFyIHBvcD1uZXcgRm9ybVZpZXdEaWFsb2codGhpcyx7cmVzX21vZGVsOnN0YXRlLm5vZGVfbW9kZWwsZG9tYWluOnRoaXMuZG9tYWluLGNvbnRleHQ6dGhpcy5jb250ZXh0LHRpdGxlOl8uc3RyLnNwcmludGYoIiVzICVzIixfdCgiQ3JlYXRlOiIpLF90KCdBY3Rpdml0eScpKSxkaXNhYmxlX211bHRpcGxlX3NlbGVjdGlvbjp0cnVlLG9uX3NhdmVkOnRoaXMucmVsb2FkLmJpbmQodGhpcyx7fSksfSkub3BlbigpO3BvcC5vcGVuZWQoKS50aGVuKGZ1bmN0aW9uKCl7dmFyIGNoYW5nZXM9e307Y2hhbmdlc1tzdGF0ZS5wYXJlbnRfZmllbGRdPXtpZDpzdGF0ZS5yZXNfaWR9O3BvcC5mb3JtX3ZpZXcudHJpZ2dlcl91cCgnZmllbGRfY2hhbmdlZCcse2RhdGFQb2ludElEOnBvcC5mb3JtX3ZpZXcuaGFuZGxlLGNoYW5nZXM6Y2hhbmdlcyx9KTt9KTt9LF9vbkFkZEVkZ2U6ZnVuY3Rpb24oZXZlbnQpe3ZhciBzZWxmPXRoaXM7dmFyIHN0YXRlPXRoaXMubW9kZWwuZ2V0KCk7dmFyIHBvcD1uZXcgRm9ybVZpZXdEaWFsb2coc2VsZix7cmVzX21vZGVsOnN0YXRlLmNvbm5lY3Rvcl9tb2RlbCxkb21haW46dGhpcy5kb21haW4sY29udGV4dDp0aGlzLmNvbnRleHQsdGl0bGU6Xy5zdHIuc3ByaW50ZigiJXMgJXMiLF90KCJDcmVhdGU6IiksX3QoJ1RyYW5zaXRpb24nKSksZGlzYWJsZV9tdWx0aXBsZV9zZWxlY3Rpb246dHJ1ZSx9KS5vcGVuKCk7cG9wLm9wZW5lZCgpLnRoZW4oZnVuY3Rpb24oKXt2YXIgY2hhbmdlcz17fTtjaGFuZ2VzW3N0YXRlLmNvbm5lY3RvcnMuYXR0cnMuc291cmNlXT17aWQ6ZXZlbnQuZGF0YS5zb3VyY2VfaWR9O2NoYW5nZXNbc3RhdGUuY29ubmVjdG9ycy5hdHRycy5kZXN0aW5hdGlvbl09e2lkOmV2ZW50LmRhdGEuZGVzdF9pZH07cG9wLmZvcm1fdmlldy50cmlnZ2VyX3VwKCdmaWVsZF9jaGFuZ2VkJyx7ZGF0YVBvaW50SUQ6cG9wLmZvcm1fdmlldy5oYW5kbGUsY2hhbmdlczpjaGFuZ2VzLH0pO30pO3BvcC5vbignY2xvc2VkJyx0aGlzLHRoaXMucmVsb2FkLmJpbmQodGhpcyx7fSkpO30sX29uRWRpdEVkZ2U6ZnVuY3Rpb24oZXZlbnQpe3ZhciBzdGF0ZT10aGlzLm1vZGVsLmdldCgpO25ldyBGb3JtVmlld0RpYWxvZyh0aGlzLHtyZXNfbW9kZWw6c3RhdGUuY29ubmVjdG9yX21vZGVsLHJlc19pZDpwYXJzZUludChldmVudC5kYXRhLmlkLDEwKSxjb250ZXh0OnRoaXMuY29udGV4dCx0aXRsZTpfLnN0ci5zcHJpbnRmKCIlcyAlcyIsX3QoIk9wZW46IiksX3QoJ1RyYW5zaXRpb24nKSksb25fc2F2ZWQ6dGhpcy5yZWxvYWQuYmluZCh0aGlzLHt9KSx9KS5vcGVuKCk7fSxfb25FZGl0Tm9kZTpmdW5jdGlvbihldmVudCl7dmFyIHN0YXRlPXRoaXMubW9kZWwuZ2V0KCk7bmV3IEZvcm1WaWV3RGlhbG9nKHRoaXMse3Jlc19tb2RlbDpzdGF0ZS5ub2RlX21vZGVsLHJlc19pZDpldmVudC5kYXRhLmlkLGNvbnRleHQ6dGhpcy5jb250ZXh0LHRpdGxlOl8uc3RyLnNwcmludGYoIiVzICVzIixfdCgiT3BlbjoiKSxfdCgnQWN0aXZpdHknKSksb25fc2F2ZWQ6dGhpcy5yZWxvYWQuYmluZCh0aGlzLHt9KSx9KS5vcGVuKCk7fSxfb25SZW1vdmVFZGdlOmZ1bmN0aW9uKGV2ZW50KXt2YXIgc2VsZj10aGlzO0RpYWxvZy5jb25maXJtKHRoaXMsKF90KCJBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gcmVtb3ZlIHRoaXMgdHJhbnNpdGlvbj8iKSkse2NvbmZpcm1fY2FsbGJhY2s6ZnVuY3Rpb24oKXt2YXIgc3RhdGU9c2VsZi5tb2RlbC5nZXQoKTtzZWxmLl9ycGMoe21vZGVsOnN0YXRlLmNvbm5lY3Rvcl9tb2RlbCxtZXRob2Q6J3VubGluaycsYXJnczpbZXZlbnQuZGF0YS5pZF0sfSkudGhlbihzZWxmLnJlbG9hZC5iaW5kKHNlbGYse30pKTt9LH0pO30sX29uUmVtb3ZlTm9kZTpmdW5jdGlvbihldmVudCl7dmFyIHNlbGY9dGhpczt2YXIgbXNnPV90KCJBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gcmVtb3ZlIHRoaXMgbm9kZSA/IFRoaXMgd2lsbCByZW1vdmUgaXRzIGNvbm5lY3RlZCB0cmFuc2l0aW9ucyBhcyB3ZWxsLiIpO0RpYWxvZy5jb25maXJtKHRoaXMsKG1zZykse2NvbmZpcm1fY2FsbGJhY2s6ZnVuY3Rpb24oKXt2YXIgc3RhdGU9c2VsZi5tb2RlbC5nZXQoKTtzZWxmLl9ycGMoe21vZGVsOnN0YXRlLm5vZGVfbW9kZWwsbWV0aG9kOid1bmxpbmsnLGFyZ3M6W2V2ZW50LmRhdGEuaWRdLH0pLnRoZW4oc2VsZi5yZWxvYWQuYmluZChzZWxmLHt9KSk7fSx9KTt9LH0pO3JldHVybiBEaWFncmFtQ29udHJvbGxlcjt9KTs7CgovKiAvd2ViX2RpYWdyYW0vc3RhdGljL3NyYy9qcy9kaWFncmFtX3JlbmRlcmVyLmpzIGRlZmluZWQgaW4gYnVuZGxlICd3ZWIuYXNzZXRzX2JhY2tlbmQnICovCm9kb28uZGVmaW5lKCd3ZWJfZGlhZ3JhbS5EaWFncmFtUmVuZGVyZXInLGZ1bmN0aW9uKHJlcXVpcmUpeyJ1c2Ugc3RyaWN0Ijt2YXIgQWJzdHJhY3RSZW5kZXJlcj1yZXF1aXJlKCd3ZWIuQWJzdHJhY3RSZW5kZXJlcicpO3ZhciBEaWFncmFtUmVuZGVyZXI9QWJzdHJhY3RSZW5kZXJlci5leHRlbmQoe3RlbXBsYXRlOidEaWFncmFtVmlldycsc3RhcnQ6ZnVuY3Rpb24oKXt2YXIgJGhlYWRlcj10aGlzLiRlbC5maWx0ZXIoJy5vX2RpYWdyYW1faGVhZGVyJyk7Xy5lYWNoKHRoaXMuc3RhdGUubGFiZWxzLGZ1bmN0aW9uKGxhYmVsKXskaGVhZGVyLmFwcGVuZCgkKCc8c3Bhbj4nKS5odG1sKGxhYmVsKSk7fSk7dGhpcy4kZGlhZ3JhbV9jb250YWluZXI9dGhpcy4kZWwuZmlsdGVyKCcub19kaWFncmFtJyk7cmV0dXJuIHRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9LF9yZW5kZXI6ZnVuY3Rpb24oKXt2YXIgc2VsZj10aGlzO3ZhciBub2Rlcz10aGlzLnN0YXRlLm5vZGVzO3ZhciBlZGdlcz10aGlzLnN0YXRlLmVkZ2VzO3ZhciBpZF90b19ub2RlPXt9O3ZhciBzdHlsZT17ZWRnZV9jb2xvcjoiI0EwQTBBMCIsZWRnZV9sYWJlbF9jb2xvcjoiIzU1NSIsZWRnZV9sYWJlbF9mb250X3NpemU6MTAsZWRnZV93aWR0aDoyLGVkZ2Vfc3BhY2luZzoxMDAsZWRnZV9sb29wX3JhZGl1czoxMDAsbm9kZV9sYWJlbF9jb2xvcjoiIzMzMyIsbm9kZV9sYWJlbF9mb250X3NpemU6MTIsbm9kZV9vdXRsaW5lX2NvbG9yOiIjMzMzIixub2RlX291dGxpbmVfd2lkdGg6MSxub2RlX3NlbGVjdGVkX2NvbG9yOiIjMDA5N0JFIixub2RlX3NlbGVjdGVkX3dpZHRoOjIsbm9kZV9zaXplX3g6MTEwLG5vZGVfc2l6ZV95OjgwLGNvbm5lY3Rvcl9hY3RpdmVfY29sb3I6IiNGRkYiLGNvbm5lY3Rvcl9yYWRpdXM6NCxjbG9zZV9idXR0b25fcmFkaXVzOjgsY2xvc2VfYnV0dG9uX2NvbG9yOiIjMzMzIixjbG9zZV9idXR0b25feF9jb2xvcjoiI0ZGRiIsZ3JheToiI0RDRENEQyIsd2hpdGU6IiNGRkYiLHZpZXdwb3J0X21hcmdpbjo1MH07dGhpcy4kZGlhZ3JhbV9jb250YWluZXIuZW1wdHkoKTt2YXIgJGRpdj0kKCc8ZGl2PicpLmNzcyh7cG9zaXRpb246J2Fic29sdXRlJyx0b3A6LTEwMDAwLHJpZ2h0Oi0xMDAwMH0pLmFwcGVuZFRvKCQoJ2JvZHknKSk7dmFyIHI9bmV3IFJhcGhhZWwoJGRpdlswXSwnMTAwJScsJzEwMCUnKTt2YXIgZ3JhcGg9bmV3IEN1dGVHcmFwaChyLHN0eWxlLHRoaXMuJGRpYWdyYW1fY29udGFpbmVyWzBdKTtfLmVhY2gobm9kZXMsZnVuY3Rpb24obm9kZSl7dmFyIG49bmV3IEN1dGVOb2RlKGdyYXBoLG5vZGUueCs1MCxub2RlLnkrNTAsQ3V0ZUdyYXBoLndvcmR3cmFwKG5vZGUubmFtZSwxNCksbm9kZS5zaGFwZT09PSdyZWN0YW5nbGUnPydyZWN0JzonY2lyY2xlJyxub2RlLmNvbG9yPT09J3doaXRlJz9zdHlsZS53aGl0ZTpzdHlsZS5ncmF5KTtuLmlkPW5vZGUuaWQ7aWRfdG9fbm9kZVtub2RlLmlkXT1uO30pO18uZWFjaChlZGdlcyxmdW5jdGlvbihlZGdlKXt2YXIgZT1uZXcgQ3V0ZUVkZ2UoZ3JhcGgsQ3V0ZUdyYXBoLndvcmR3cmFwKGVkZ2Uuc2lnbmFsLDMyKSxpZF90b19ub2RlW2VkZ2Uuc19pZF0saWRfdG9fbm9kZVtlZGdlLmRfaWRdfHxpZF90b19ub2RlW2VkZ2Uuc19pZF0pO2UuaWQ9ZWRnZS5pZDt9KTskZGl2LmNvbnRlbnRzKCkuYXBwZW5kVG8odGhpcy4kZGlhZ3JhbV9jb250YWluZXIpOyRkaXYucmVtb3ZlKCk7Q3V0ZU5vZGUuZG91YmxlX2NsaWNrX2NhbGxiYWNrPWZ1bmN0aW9uKGN1dGVub2RlKXtzZWxmLnRyaWdnZXJfdXAoJ2VkaXRfbm9kZScse2lkOmN1dGVub2RlLmlkfSk7fTtDdXRlTm9kZS5kZXN0cnVjdGlvbl9jYWxsYmFjaz1mdW5jdGlvbihjdXRlbm9kZSl7c2VsZi50cmlnZ2VyX3VwKCdyZW1vdmVfbm9kZScse2lkOmN1dGVub2RlLmlkfSk7cmV0dXJuIFByb21pc2UucmVqZWN0KCk7fTtDdXRlRWRnZS5kb3VibGVfY2xpY2tfY2FsbGJhY2s9ZnVuY3Rpb24oY3V0ZWVkZ2Upe3NlbGYudHJpZ2dlcl91cCgnZWRpdF9lZGdlJyx7aWQ6Y3V0ZWVkZ2UuaWR9KTt9O0N1dGVFZGdlLmNyZWF0aW9uX2NhbGxiYWNrPWZ1bmN0aW9uKG5vZGVfc3RhcnQsbm9kZV9lbmQpe3JldHVybntsYWJlbDonJ307fTtDdXRlRWRnZS5uZXdfZWRnZV9jYWxsYmFjaz1mdW5jdGlvbihjdXRlZWRnZSl7c2VsZi50cmlnZ2VyX3VwKCdhZGRfZWRnZScse3NvdXJjZV9pZDpjdXRlZWRnZS5nZXRfc3RhcnQoKS5pZCxkZXN0X2lkOmN1dGVlZGdlLmdldF9lbmQoKS5pZCx9KTt9O0N1dGVFZGdlLmRlc3RydWN0aW9uX2NhbGxiYWNrPWZ1bmN0aW9uKGN1dGVlZGdlKXtzZWxmLnRyaWdnZXJfdXAoJ3JlbW92ZV9lZGdlJyx7aWQ6Y3V0ZWVkZ2UuaWR9KTtyZXR1cm4gUHJvbWlzZS5yZWplY3QoKTt9O3JldHVybiB0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fSx9KTtyZXR1cm4gRGlhZ3JhbVJlbmRlcmVyO30pOzsKCi8qIC93ZWJfZGlhZ3JhbS9zdGF0aWMvc3JjL2pzL2RpYWdyYW1fdmlldy5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwpvZG9vLmRlZmluZSgnd2ViX2RpYWdyYW0uRGlhZ3JhbVZpZXcnLGZ1bmN0aW9uKHJlcXVpcmUpeyJ1c2Ugc3RyaWN0Ijt2YXIgQmFzaWNWaWV3PXJlcXVpcmUoJ3dlYi5CYXNpY1ZpZXcnKTt2YXIgY29yZT1yZXF1aXJlKCd3ZWIuY29yZScpO3ZhciBEaWFncmFtTW9kZWw9cmVxdWlyZSgnd2ViX2RpYWdyYW0uRGlhZ3JhbU1vZGVsJyk7dmFyIERpYWdyYW1SZW5kZXJlcj1yZXF1aXJlKCd3ZWJfZGlhZ3JhbS5EaWFncmFtUmVuZGVyZXInKTt2YXIgRGlhZ3JhbUNvbnRyb2xsZXI9cmVxdWlyZSgnd2ViX2RpYWdyYW0uRGlhZ3JhbUNvbnRyb2xsZXInKTt2YXIgX2x0PWNvcmUuX2x0O3ZhciBEaWFncmFtVmlldz1CYXNpY1ZpZXcuZXh0ZW5kKHtkaXNwbGF5X25hbWU6X2x0KCdEaWFncmFtJyksaWNvbjonZmEtY29kZS1mb3JrJyxtdWx0aV9yZWNvcmQ6ZmFsc2Usd2l0aFNlYXJjaEJhcjpmYWxzZSxzZWFyY2hNZW51VHlwZXM6W10sanNMaWJzOltbJy93ZWJfZGlhZ3JhbS9zdGF0aWMvbGliL2pzL2pxdWVyeS5tb3VzZXdoZWVsLmpzJywnL3dlYl9kaWFncmFtL3N0YXRpYy9saWIvanMvcmFwaGFlbC5qcycsXV0sY29uZmlnOl8uZXh0ZW5kKHt9LEJhc2ljVmlldy5wcm90b3R5cGUuY29uZmlnLHtNb2RlbDpEaWFncmFtTW9kZWwsUmVuZGVyZXI6RGlhZ3JhbVJlbmRlcmVyLENvbnRyb2xsZXI6RGlhZ3JhbUNvbnRyb2xsZXIsfSksdmlld1R5cGU6J2RpYWdyYW0nLGluaXQ6ZnVuY3Rpb24odmlld0luZm8scGFyYW1zKXt0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dmFyIHNlbGY9dGhpczt2YXIgYXJjaD10aGlzLmFyY2g7ZnVuY3Rpb24gdG9UaXRsZUNhc2Uoc3RyKXtyZXR1cm4gc3RyLnJlcGxhY2UoL1x3XFMqL2csZnVuY3Rpb24odHh0KXtyZXR1cm4gdHh0LmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpK3R4dC5zdWJzdHIoMSkudG9Mb3dlckNhc2UoKTt9KTt9CnZhciBub2Rlcz1hcmNoLmNoaWxkcmVuWzBdO3ZhciBjb25uZWN0b3JzPWFyY2guY2hpbGRyZW5bMV07dmFyIG5vZGVfbW9kZWw9bm9kZXMuYXR0cnMub2JqZWN0O3ZhciBjb25uZWN0b3JfbW9kZWw9Y29ubmVjdG9ycy5hdHRycy5vYmplY3Q7dmFyIGxhYmVscz1fLm1hcChfLndoZXJlKGFyY2guY2hpbGRyZW4se3RhZzonbGFiZWwnfSksZnVuY3Rpb24obGFiZWwpe3JldHVybiBsYWJlbC5hdHRycy5zdHJpbmc7fSk7dmFyIGludmlzaWJsZV9ub2Rlcz1bXTt2YXIgdmlzaWJsZV9ub2Rlcz1bXTt2YXIgbm9kZV9maWVsZHNfc3RyaW5nPVtdO18uZWFjaChub2Rlcy5jaGlsZHJlbixmdW5jdGlvbihjaGlsZCl7aWYoY2hpbGQuYXR0cnMuaW52aXNpYmxlPT09JzEnKQppbnZpc2libGVfbm9kZXMucHVzaChjaGlsZC5hdHRycy5uYW1lKTtlbHNle3ZhciBmaWVsZFN0cmluZz1zZWxmLmZpZWxkc1tjaGlsZC5hdHRycy5uYW1lXS5zdHJpbmd8fHRvVGl0bGVDYXNlKGNoaWxkLmF0dHJzLm5hbWUpO3Zpc2libGVfbm9kZXMucHVzaChjaGlsZC5hdHRycy5uYW1lKTtub2RlX2ZpZWxkc19zdHJpbmcucHVzaChmaWVsZFN0cmluZyk7fX0pO3ZhciBjb25uZWN0b3JfZmllbGRzX3N0cmluZz1fLm1hcChjb25uZWN0b3JzLmNoaWxkcmVuLGZ1bmN0aW9uKGNvbm4pe3JldHVybiBzZWxmLmZpZWxkc1tjb25uLmF0dHJzLm5hbWVdLnN0cmluZ3x8dG9UaXRsZUNhc2UoY29ubi5hdHRycy5uYW1lKTt9KTt0aGlzLmxvYWRQYXJhbXM9Xy5leHRlbmQoe30sdGhpcy5sb2FkUGFyYW1zLHtjdXJyZW50SWQ6cGFyYW1zLmN1cnJlbnRJZCxub2Rlczpub2RlcyxsYWJlbHM6bGFiZWxzLGludmlzaWJsZV9ub2RlczppbnZpc2libGVfbm9kZXMsdmlzaWJsZV9ub2Rlczp2aXNpYmxlX25vZGVzLG5vZGVfZmllbGRzX3N0cmluZzpub2RlX2ZpZWxkc19zdHJpbmcsbm9kZV9tb2RlbDpub2RlX21vZGVsLGNvbm5lY3RvcnM6Y29ubmVjdG9ycyxjb25uZWN0b3JfbW9kZWw6Y29ubmVjdG9yX21vZGVsLGNvbm5lY3Rvcl9maWVsZHNfc3RyaW5nOmNvbm5lY3Rvcl9maWVsZHNfc3RyaW5nLH0pO3RoaXMuY29udHJvbGxlclBhcmFtcz1fLmV4dGVuZCh7fSx0aGlzLmNvbnRyb2xsZXJQYXJhbXMse2RvbWFpbjpwYXJhbXMuZG9tYWluLGNvbnRleHQ6cGFyYW1zLmNvbnRleHQsaWRzOnBhcmFtcy5pZHMsY3VycmVudElkOnBhcmFtcy5jdXJyZW50SWQsfSk7fSxnZXRDb250cm9sbGVyOmZ1bmN0aW9uKCl7dmFyIG9sZERlZmluZT13aW5kb3cuZGVmaW5lO2RlbGV0ZSB3aW5kb3cuZGVmaW5lO3JldHVybiB0aGlzLl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cykudGhlbihmdW5jdGlvbih2aWV3KXt3aW5kb3cuZGVmaW5lPW9sZERlZmluZTtyZXR1cm4gdmlldzt9KTt9LH0pO3JldHVybiBEaWFncmFtVmlldzt9KTs7CgovKiAvd2ViX2RpYWdyYW0vc3RhdGljL3NyYy9qcy92aWV3X3JlZ2lzdHJ5LmpzIGRlZmluZWQgaW4gYnVuZGxlICd3ZWIuYXNzZXRzX2JhY2tlbmQnICovCm9kb28uZGVmaW5lKCd3ZWJfZGlhZ3JhbS52aWV3X3JlZ2lzdHJ5JyxmdW5jdGlvbihyZXF1aXJlKXsidXNlIHN0cmljdCI7dmFyIHZpZXdfcmVnaXN0cnk9cmVxdWlyZSgnd2ViLnZpZXdfcmVnaXN0cnknKTt2YXIgRGlhZ3JhbVZpZXc9cmVxdWlyZSgnd2ViX2RpYWdyYW0uRGlhZ3JhbVZpZXcnKTt2aWV3X3JlZ2lzdHJ5LmFkZCgnZGlhZ3JhbScsRGlhZ3JhbVZpZXcpO30pOzsKCi8qIC93ZWJfZWRpdG9yL3N0YXRpYy9zcmMvanMvYmFja2VuZC9maWVsZF9odG1sLmpzIGRlZmluZWQgaW4gYnVuZGxlICd3ZWIuYXNzZXRzX2JhY2tlbmQnICovCm9kb28uZGVmaW5lKCd3ZWJfZWRpdG9yLmZpZWxkLmh0bWwnLGZ1bmN0aW9uKHJlcXVpcmUpeyd1c2Ugc3RyaWN0Jzt2YXIgYWpheD1yZXF1aXJlKCd3ZWIuYWpheCcpO3ZhciBiYXNpY19maWVsZHM9cmVxdWlyZSgnd2ViLmJhc2ljX2ZpZWxkcycpO3ZhciBjb3JlPXJlcXVpcmUoJ3dlYi5jb3JlJyk7dmFyIFd5c2l3eWc9cmVxdWlyZSgnd2ViX2VkaXRvci53eXNpd3lnLnJvb3QnKTt2YXIgZmllbGRfcmVnaXN0cnk9cmVxdWlyZSgnd2ViLmZpZWxkX3JlZ2lzdHJ5Jyk7cmVxdWlyZSgnd2ViLl9maWVsZF9yZWdpc3RyeScpO3ZhciBfbHQ9Y29yZS5fbHQ7dmFyIFRyYW5zbGF0YWJsZUZpZWxkTWl4aW49YmFzaWNfZmllbGRzLlRyYW5zbGF0YWJsZUZpZWxkTWl4aW47dmFyIFFXZWI9Y29yZS5xd2ViO3ZhciBhc3NldHNMb2FkZWQ7dmFyIEZpZWxkSHRtbD1iYXNpY19maWVsZHMuRGVib3VuY2VkRmllbGQuZXh0ZW5kKFRyYW5zbGF0YWJsZUZpZWxkTWl4aW4se2Rlc2NyaXB0aW9uOl9sdCgiSHRtbCIpLGNsYXNzTmFtZTonb2VfZm9ybV9maWVsZCBvZV9mb3JtX2ZpZWxkX2h0bWwnLHN1cHBvcnRlZEZpZWxkVHlwZXM6WydodG1sJ10sY3VzdG9tX2V2ZW50czp7d3lzaXd5Z19mb2N1czonX29uV3lzaXd5Z0ZvY3VzJyx3eXNpd3lnX2JsdXI6J19vbld5c2l3eWdCbHVyJyx3eXNpd3lnX2NoYW5nZTonX29uQ2hhbmdlJyx3eXNpd3lnX2F0dGFjaG1lbnQ6J19vbkF0dGFjaG1lbnRDaGFuZ2UnLH0sd2lsbFN0YXJ0OmZ1bmN0aW9uKCl7dmFyIHNlbGY9dGhpczt0aGlzLmlzUmVuZGVyZWQ9ZmFsc2U7dGhpcy5fb25VcGRhdGVJZnJhbWVJZD0nb25Mb2FkXycrXy51bmlxdWVJZCgnRmllbGRIdG1sJyk7dmFyIGRlZkFzc2V0O2lmKHRoaXMubm9kZU9wdGlvbnMuY3NzUmVhZG9ubHkpe2RlZkFzc2V0PWFqYXgubG9hZEFzc2V0KHRoaXMubm9kZU9wdGlvbnMuY3NzUmVhZG9ubHkpO30KaWYoIWFzc2V0c0xvYWRlZCl7YXNzZXRzTG9hZGVkPW5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUpe3ZhciB3eXNpd3lnPW5ldyBXeXNpd3lnKHNlbGYse30pO3d5c2l3eWcuYXR0YWNoVG8oJCgnPHRleHRhcmVhPicpKS50aGVuKGZ1bmN0aW9uKCl7d3lzaXd5Zy5kZXN0cm95KCk7cmVzb2x2ZSgpO30pO30pO30KcmV0dXJuIFByb21pc2UuYWxsKFt0aGlzLl9zdXBlcigpLGFzc2V0c0xvYWRlZCxkZWZBc3NldF0pO30sZGVzdHJveTpmdW5jdGlvbigpe2RlbGV0ZSB3aW5kb3cudG9wW3RoaXMuX29uVXBkYXRlSWZyYW1lSWRdO2lmKHRoaXMuJGlmcmFtZSl7dGhpcy4kaWZyYW1lLnJlbW92ZSgpO30KdGhpcy5fc3VwZXIoKTt9LGFjdGl2YXRlOmZ1bmN0aW9uKG9wdGlvbnMpe2lmKHRoaXMud3lzaXd5Zyl7dGhpcy53eXNpd3lnLmZvY3VzKCk7cmV0dXJuIHRydWU7fX0sY29tbWl0Q2hhbmdlczpmdW5jdGlvbigpe3ZhciBzZWxmPXRoaXM7aWYodGhpcy5tb2RlPT0icmVhZG9ubHkifHwhdGhpcy5pc1JlbmRlcmVkKXtyZXR1cm4gdGhpcy5fc3VwZXIoKTt9CnZhciBfc3VwZXI9dGhpcy5fc3VwZXIuYmluZCh0aGlzKTtyZXR1cm4gdGhpcy53eXNpd3lnLnNhdmUoKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCl7c2VsZi5faXNEaXJ0eT1yZXN1bHQuaXNEaXJ0eTtfc3VwZXIoKTt9KTt9LGlzU2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudmFsdWUmJnRoaXMudmFsdWUhPT0iPHA+PGJyLz48L3A+IiYmdGhpcy52YWx1ZS5tYXRjaCgvXFMvKTt9LGdldEZvY3VzYWJsZUVsZW1lbnQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy4kdGFyZ2V0fHwkKCk7fSxyZXNldDpmdW5jdGlvbihyZWNvcmQsZXZlbnQpe3RoaXMuX3Jlc2V0KHJlY29yZCxldmVudCk7dmFyIHZhbHVlPXRoaXMudmFsdWU7aWYodGhpcy5ub2RlT3B0aW9ucy53cmFwcGVyKXt2YWx1ZT10aGlzLl93cmFwKHZhbHVlKTt9CnZhbHVlPXRoaXMuX3RleHRUb0h0bWwodmFsdWUpO2lmKCFldmVudHx8ZXZlbnQudGFyZ2V0IT09dGhpcyl7aWYodGhpcy5tb2RlPT09J2VkaXQnKXt0aGlzLnd5c2l3eWcuc2V0VmFsdWUodmFsdWUpO31lbHNle3RoaXMuJGNvbnRlbnQuaHRtbCh2YWx1ZSk7fX0KcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO30sX2dldFZhbHVlOmZ1bmN0aW9uKCl7dmFyIHZhbHVlPXRoaXMuJHRhcmdldC52YWwoKTtpZih0aGlzLm5vZGVPcHRpb25zLndyYXBwZXIpe3JldHVybiB0aGlzLl91bldyYXAodmFsdWUpO30KcmV0dXJuIHZhbHVlO30sX2NyZWF0ZVd5c2l3eWdJbnRhbmNlOmZ1bmN0aW9uKCl7dmFyIHNlbGY9dGhpczt0aGlzLnd5c2l3eWc9bmV3IFd5c2l3eWcodGhpcyx0aGlzLl9nZXRXeXNpd3lnT3B0aW9ucygpKTtyZXR1cm4gdGhpcy53eXNpd3lnLmF0dGFjaFRvKHRoaXMuJHRhcmdldCkudGhlbihmdW5jdGlvbigpe3NlbGYuJGNvbnRlbnQ9c2VsZi53eXNpd3lnLiRlZGl0b3IuY2xvc2VzdCgnYm9keSwgb2Rvby13eXNpd3lnLWNvbnRhaW5lcicpO3NlbGYuX29uTG9hZFd5c2l3eWcoKTtzZWxmLmlzUmVuZGVyZWQ9dHJ1ZTt9KTt9LF9nZXRXeXNpd3lnT3B0aW9uczpmdW5jdGlvbigpe3JldHVybiBPYmplY3QuYXNzaWduKHt9LHRoaXMubm9kZU9wdGlvbnMse3JlY29yZEluZm86e2NvbnRleHQ6dGhpcy5yZWNvcmQuZ2V0Q29udGV4dCh0aGlzLnJlY29yZFBhcmFtcykscmVzX21vZGVsOnRoaXMubW9kZWwscmVzX2lkOnRoaXMucmVzX2lkLH0sbm9BdHRhY2htZW50OnRoaXMubm9kZU9wdGlvbnNbJ25vLWF0dGFjaG1lbnQnXSxpbklmcmFtZTohIXRoaXMubm9kZU9wdGlvbnMuY3NzRWRpdCxpZnJhbWVDc3NBc3NldHM6dGhpcy5ub2RlT3B0aW9ucy5jc3NFZGl0LHNuaXBwZXRzOnRoaXMubm9kZU9wdGlvbnMuc25pcHBldHMsdGFic2l6ZTowLGhlaWdodDoxODAsZ2VuZXJhdGVPcHRpb25zOmZ1bmN0aW9uKG9wdGlvbnMpe3ZhciBwYXJhPV8uZmluZChvcHRpb25zLnRvb2xiYXIsZnVuY3Rpb24oaXRlbSl7cmV0dXJuIGl0ZW1bMF09PT0ncGFyYSc7fSk7aWYocGFyYSYmcGFyYVsxXSYmcGFyYVsxXS5pbmRleE9mKCdjaGVja2xpc3QnKT09PS0xKXtwYXJhWzFdLnNwbGljZSgyLDAsJ2NoZWNrbGlzdCcpO30KcmV0dXJuIG9wdGlvbnM7fSx9KTt9LF9vbkF0dGFjaG1lbnRDaGFuZ2U6ZnVuY3Rpb24oYXR0YWNobWVudHMpe2lmKCF0aGlzLmZpZWxkTmFtZUF0dGFjaG1lbnQpe3JldHVybjt9CnRoaXMudHJpZ2dlcl91cCgnZmllbGRfY2hhbmdlZCcse2RhdGFQb2ludElEOnRoaXMuZGF0YVBvaW50SUQsY2hhbmdlczpfLm9iamVjdChbdGhpcy5maWVsZE5hbWVBdHRhY2htZW50XSxbe29wZXJhdGlvbjonQUREX00yTScsaWRzOmF0dGFjaG1lbnRzfV0pfSk7fSxfcmVuZGVyRWRpdDpmdW5jdGlvbigpe3ZhciB2YWx1ZT10aGlzLl90ZXh0VG9IdG1sKHRoaXMudmFsdWUpO2lmKHRoaXMubm9kZU9wdGlvbnMud3JhcHBlcil7dmFsdWU9dGhpcy5fd3JhcCh2YWx1ZSk7fQp0aGlzLiR0YXJnZXQ9JCgnPHRleHRhcmVhPicpLnZhbCh2YWx1ZSkuaGlkZSgpO3RoaXMuJHRhcmdldC5hcHBlbmRUbyh0aGlzLiRlbCk7dmFyIGZpZWxkTmFtZUF0dGFjaG1lbnQ9Xy5jaGFpbih0aGlzLnJlY29yZERhdGEpLnBhaXJzKCkuZmluZChmdW5jdGlvbih2YWx1ZSl7cmV0dXJuIF8uaXNPYmplY3QodmFsdWVbMV0pJiZ2YWx1ZVsxXS5tb2RlbD09PSJpci5hdHRhY2htZW50Ijt9KS5maXJzdCgpLnZhbHVlKCk7aWYoZmllbGROYW1lQXR0YWNobWVudCl7dGhpcy5maWVsZE5hbWVBdHRhY2htZW50PWZpZWxkTmFtZUF0dGFjaG1lbnQ7fQppZih0aGlzLm5vZGVPcHRpb25zLmNzc0VkaXQpe3RoaXMuX2NyZWF0ZVd5c2l3eWdJbnRhbmNlKCk7fWVsc2V7cmV0dXJuIHRoaXMuX2NyZWF0ZVd5c2l3eWdJbnRhbmNlKCk7fX0sX3JlbmRlclJlYWRvbmx5OmZ1bmN0aW9uKCl7dmFyIHNlbGY9dGhpczt2YXIgdmFsdWU9dGhpcy5fdGV4dFRvSHRtbCh0aGlzLnZhbHVlKTtpZih0aGlzLm5vZGVPcHRpb25zLndyYXBwZXIpe3ZhbHVlPXRoaXMuX3dyYXAodmFsdWUpO30KdGhpcy4kZWwuZW1wdHkoKTt2YXIgcmVzb2x2ZXI7dmFyIGRlZj1uZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlKXtyZXNvbHZlcj1yZXNvbHZlO30pO2lmKHRoaXMubm9kZU9wdGlvbnMuY3NzUmVhZG9ubHkpe3RoaXMuJGlmcmFtZT0kKCc8aWZyYW1lIGNsYXNzPSJvX3JlYWRvbmx5Ii8+Jyk7dGhpcy4kaWZyYW1lLmFwcGVuZFRvKHRoaXMuJGVsKTt2YXIgYXZvaWREb3VibGVMb2FkPTA7dGhpcy4kaWZyYW1lLmRhdGEoJ2xvYWREZWYnLGRlZik7d2luZG93LnRvcFt0aGlzLl9vblVwZGF0ZUlmcmFtZUlkXT1mdW5jdGlvbihfYXZvaWREb3VibGVMb2FkKXtpZihfYXZvaWREb3VibGVMb2FkIT09YXZvaWREb3VibGVMb2FkKXtjb25zb2xlLndhcm4oJ1d5c2l3eWcgaWZyYW1lIGRvdWJsZSBsb2FkIGRldGVjdGVkJyk7cmV0dXJuO30Kc2VsZi4kY29udGVudD0kKCcjaWZyYW1lX3RhcmdldCcsc2VsZi4kaWZyYW1lWzBdLmNvbnRlbnRXaW5kb3cuZG9jdW1lbnQuYm9keSk7cmVzb2x2ZXIoKTt9O3RoaXMuJGlmcmFtZS5vbignbG9hZCcsZnVuY3Rpb24gb25Mb2FkKCl7dmFyIF9hdm9pZERvdWJsZUxvYWQ9Kythdm9pZERvdWJsZUxvYWQ7YWpheC5sb2FkQXNzZXQoc2VsZi5ub2RlT3B0aW9ucy5jc3NSZWFkb25seSkudGhlbihmdW5jdGlvbihhc3NldCl7aWYoX2F2b2lkRG91YmxlTG9hZCE9PWF2b2lkRG91YmxlTG9hZCl7Y29uc29sZS53YXJuKCdXeXNpd3lnIGltbWVkaWF0ZSBpZnJhbWUgZG91YmxlIGxvYWQgZGV0ZWN0ZWQnKTtyZXR1cm47fQp2YXIgY3dpbmRvdz1zZWxmLiRpZnJhbWVbMF0uY29udGVudFdpbmRvdztjd2luZG93LmRvY3VtZW50Lm9wZW4oInRleHQvaHRtbCIsInJlcGxhY2UiKS53cml0ZSgnPGhlYWQ+JysnPG1ldGEgY2hhcnNldD0idXRmLTgiLz4nKyc8bWV0YSBodHRwLWVxdWl2PSJYLVVBLUNvbXBhdGlibGUiIGNvbnRlbnQ9IklFPWVkZ2UsY2hyb21lPTEiLz5cbicrJzxtZXRhIG5hbWU9InZpZXdwb3J0IiBjb250ZW50PSJ3aWR0aD1kZXZpY2Utd2lkdGgsIGluaXRpYWwtc2NhbGU9MSwgdXNlci1zY2FsYWJsZT1ubyIvPlxuJysKXy5tYXAoYXNzZXQuY3NzTGlicyxmdW5jdGlvbihjc3NMaWIpe3JldHVybic8bGluayB0eXBlPSJ0ZXh0L2NzcyIgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSInK2Nzc0xpYisnIi8+Jzt9KS5qb2luKCdcbicpKydcbicrCl8ubWFwKGFzc2V0LmNzc0NvbnRlbnRzLGZ1bmN0aW9uKGNzc0NvbnRlbnQpe3JldHVybic8c3R5bGUgdHlwZT0idGV4dC9jc3MiPicrY3NzQ29udGVudCsnPC9zdHlsZT4nO30pLmpvaW4oJ1xuJykrJ1xuJysnPC9oZWFkPlxuJysnPGJvZHkgY2xhc3M9Im9faW5faWZyYW1lIG9fcmVhZG9ubHkiPlxuJysnPGRpdiBpZD0iaWZyYW1lX3RhcmdldCI+Jyt2YWx1ZSsnPC9kaXY+XG4nKyc8c2NyaXB0IHR5cGU9InRleHQvamF2YXNjcmlwdCI+JysnaWYgKHdpbmRvdy50b3AuJytzZWxmLl9vblVwZGF0ZUlmcmFtZUlkKycpIHsnKyd3aW5kb3cudG9wLicrc2VsZi5fb25VcGRhdGVJZnJhbWVJZCsnKCcrX2F2b2lkRG91YmxlTG9hZCsnKScrJ30nKyc8L3NjcmlwdD5cbicrJzwvYm9keT4nKTt2YXIgaGVpZ2h0PWN3aW5kb3cuZG9jdW1lbnQuYm9keS5zY3JvbGxIZWlnaHQ7c2VsZi4kaWZyYW1lLmNzcygnaGVpZ2h0JyxNYXRoLm1heCgzMCxNYXRoLm1pbihoZWlnaHQsNTAwKSkrJ3B4Jyk7fSk7fSk7fWVsc2V7dGhpcy4kY29udGVudD0kKCc8ZGl2IGNsYXNzPSJvX3JlYWRvbmx5Ii8+JykuaHRtbCh2YWx1ZSk7dGhpcy4kY29udGVudC5hcHBlbmRUbyh0aGlzLiRlbCk7cmVzb2x2ZXIoKTt9CmRlZi50aGVuKGZ1bmN0aW9uKCl7c2VsZi4kY29udGVudC5vbignY2xpY2snLCd1bC5vX2NoZWNrbGlzdCA+IGxpJyxzZWxmLl9vblJlYWRvbmx5Q2xpY2tDaGVja2xpc3QuYmluZChzZWxmKSk7fSk7fSxfdGV4dFRvSHRtbDpmdW5jdGlvbih0ZXh0KXt2YXIgdmFsdWU9dGV4dHx8IiI7aWYoLyVcc2VuZC8udGVzdCh2YWx1ZSkpe3JldHVybiB2YWx1ZTt9CnRyeXskKHRleHQpWzBdLmlubmVySFRNTDt9Y2F0Y2goZSl7aWYodmFsdWUubWF0Y2goL15ccyokLykpe3ZhbHVlPSc8cD48YnIvPjwvcD4nO31lbHNle3ZhbHVlPSI8cD4iK3ZhbHVlLnNwbGl0KC88YnJcLz8+Lykuam9pbigiPGJyLz48L3A+PHA+IikrIjwvcD4iO3ZhbHVlPXZhbHVlLnJlcGxhY2UoLzxwPjxcL3A+L2csJycpLnJlcGxhY2UoJzxwPjxwPicsJzxwPicpLnJlcGxhY2UoJzxwPjxwICcsJzxwICcpLnJlcGxhY2UoJzwvcD48L3A+JywnPC9wPicpO319CnJldHVybiB2YWx1ZTt9LF91bldyYXA6ZnVuY3Rpb24oaHRtbCl7dmFyICR3cmFwcGVyPSQoaHRtbCkuZmluZCgnI3dyYXBwZXInKTtyZXR1cm4gJHdyYXBwZXIubGVuZ3RoPyR3cmFwcGVyLmh0bWwoKTpodG1sO30sX3dyYXA6ZnVuY3Rpb24oaHRtbCl7cmV0dXJuICQoUVdlYi5yZW5kZXIodGhpcy5ub2RlT3B0aW9ucy53cmFwcGVyKSkuZmluZCgnI3dyYXBwZXInKS5odG1sKGh0bWwpLmVuZCgpLnByb3AoJ291dGVySFRNTCcpO30sX29uQ2hhbmdlOmZ1bmN0aW9uKGV2KXt0aGlzLl9kb0RlYm91bmNlZEFjdGlvbi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dmFyICRsaXM9dGhpcy4kY29udGVudC5maW5kKCcubm90ZS1lZGl0YWJsZSB1bC5vX2NoZWNrbGlzdCA+IGxpOm5vdCg6aGFzKD4gdWwub19jaGVja2xpc3QpKScpO2lmKCEkbGlzLmxlbmd0aCl7cmV0dXJuO30KdmFyIG1heD0wO3ZhciBpZHM9W107JGxpcy5tYXAoZnVuY3Rpb24oKXt2YXIgY2hlY2tsaXN0SWQ9cGFyc2VJbnQoKCQodGhpcykuYXR0cignaWQnKXx8JzAnKS5yZXBsYWNlKC9eY2hlY2tsaXN0LWlkLS8sJycpKTtpZihpZHMuaW5kZXhPZihjaGVja2xpc3RJZCk9PT0tMSl7aWYoY2hlY2tsaXN0SWQ+bWF4KXttYXg9Y2hlY2tsaXN0SWQ7fQppZHMucHVzaChjaGVja2xpc3RJZCk7fWVsc2V7JCh0aGlzKS5yZW1vdmVBdHRyKCdpZCcpO319KTskbGlzLm5vdCgnW2lkXScpLmVhY2goZnVuY3Rpb24oKXskKHRoaXMpLmF0dHIoJ2lkJywnY2hlY2tsaXN0LWlkLScrKCsrbWF4KSk7fSk7fSxfb25SZWFkb25seUNsaWNrQ2hlY2tsaXN0OmZ1bmN0aW9uKGV2KXt2YXIgc2VsZj10aGlzO2lmKGV2Lm9mZnNldFg+MCl7cmV0dXJuO30KZXYuc3RvcFByb3BhZ2F0aW9uKCk7ZXYucHJldmVudERlZmF1bHQoKTt2YXIgY2hlY2tlZD0kKGV2LnRhcmdldCkuaGFzQ2xhc3MoJ29fY2hlY2tlZCcpO3ZhciBjaGVja2xpc3RJZD1wYXJzZUludCgoJChldi50YXJnZXQpLmF0dHIoJ2lkJyl8fCcwJykucmVwbGFjZSgvXmNoZWNrbGlzdC1pZC0vLCcnKSk7dGhpcy5fcnBjKHtyb3V0ZTonL3dlYl9lZGl0b3IvY2hlY2tsaXN0JyxwYXJhbXM6e3Jlc19tb2RlbDp0aGlzLm1vZGVsLHJlc19pZDp0aGlzLnJlc19pZCxmaWxlbmFtZTp0aGlzLm5hbWUsY2hlY2tsaXN0SWQ6Y2hlY2tsaXN0SWQsY2hlY2tlZDohY2hlY2tlZCx9LH0pLnRoZW4oZnVuY3Rpb24odmFsdWUpe3NlbGYuX3NldFZhbHVlKHZhbHVlKTt9KTt9LF9vbkxvYWRXeXNpd3lnOmZ1bmN0aW9uKCl7dmFyICRidXR0b249dGhpcy5fcmVuZGVyVHJhbnNsYXRlQnV0dG9uKCk7JGJ1dHRvbi5jc3Moeydmb250LXNpemUnOicxNXB4Jyxwb3NpdGlvbjonYWJzb2x1dGUnLHJpZ2h0OicrNXB4Jyx0b3A6Jys1cHgnLH0pO3RoaXMuJGVsLmFwcGVuZCgkYnV0dG9uKTt9LF9vbld5c2l3eWdCbHVyOmZ1bmN0aW9uKGV2KXtldi5zdG9wUHJvcGFnYXRpb24oKTt0aGlzLl9kb0FjdGlvbigpO2lmKGV2LmRhdGEua2V5PT09J1RBQicpe3RoaXMudHJpZ2dlcl91cCgnbmF2aWdhdGlvbl9tb3ZlJyx7ZGlyZWN0aW9uOmV2LmRhdGEuc2hpZnRLZXk/J2xlZnQnOidyaWdodCcsfSk7fX0sX29uV3lzaXd5Z0ZvY3VzOmZ1bmN0aW9uKGV2KXt9LH0pO2ZpZWxkX3JlZ2lzdHJ5LmFkZCgnaHRtbCcsRmllbGRIdG1sKTtyZXR1cm4gRmllbGRIdG1sO30pOzsKCi8qIC93ZWJfZWRpdG9yL3N0YXRpYy9zcmMvanMvYmFja2VuZC9jb252ZXJ0X2lubGluZS5qcyBkZWZpbmVkIGluIGJ1bmRsZSAnd2ViLmFzc2V0c19iYWNrZW5kJyAqLwpvZG9vLmRlZmluZSgnd2ViX2VkaXRvci5jb252ZXJ0SW5saW5lJyxmdW5jdGlvbihyZXF1aXJlKXsndXNlIHN0cmljdCc7dmFyIEZpZWxkSHRtbD1yZXF1aXJlKCd3ZWJfZWRpdG9yLmZpZWxkLmh0bWwnKTtmdW5jdGlvbiBnZXRNYXRjaGVkQ1NTUnVsZXMoYSl7dmFyIGkscixrO3ZhciBkb2M9YS5vd25lckRvY3VtZW50O3ZhciBydWxlc0NhY2hlPWEub3duZXJEb2N1bWVudC5fcnVsZXNDYWNoZXx8KGEub3duZXJEb2N1bWVudC5fcnVsZXNDYWNoZT1bXSk7aWYoIXJ1bGVzQ2FjaGUubGVuZ3RoKXt2YXIgc2hlZXRzPWRvYy5zdHlsZVNoZWV0cztmb3IoaT1zaGVldHMubGVuZ3RoLTE7aT49MDtpLS0pe3ZhciBydWxlczt0cnl7cnVsZXM9c2hlZXRzW2ldLnJ1bGVzfHxzaGVldHNbaV0uY3NzUnVsZXM7fWNhdGNoKGUpe2NvbnNvbGUud2FybigiQ2FuJ3QgcmVhZCB0aGUgY3NzIHJ1bGVzIG9mOiAiK3NoZWV0c1tpXS5ocmVmLGUpO2NvbnRpbnVlO30KaWYocnVsZXMpe2ZvcihyPXJ1bGVzLmxlbmd0aC0xO3I+PTA7ci0tKXt2YXIgc2VsZWN0b3JUZXh0PXJ1bGVzW3JdLnNlbGVjdG9yVGV4dDtpZihzZWxlY3RvclRleHQmJnJ1bGVzW3JdLmNzc1RleHQmJnNlbGVjdG9yVGV4dCE9PScqJyYmc2VsZWN0b3JUZXh0LmluZGV4T2YoJzpob3ZlcicpPT09LTEmJnNlbGVjdG9yVGV4dC5pbmRleE9mKCc6YmVmb3JlJyk9PT0tMSYmc2VsZWN0b3JUZXh0LmluZGV4T2YoJzphZnRlcicpPT09LTEmJnNlbGVjdG9yVGV4dC5pbmRleE9mKCc6YWN0aXZlJyk9PT0tMSYmc2VsZWN0b3JUZXh0LmluZGV4T2YoJzpsaW5rJyk9PT0tMSYmc2VsZWN0b3JUZXh0LmluZGV4T2YoJzo6Jyk9PT0tMSYmc2VsZWN0b3JUZXh0LmluZGV4T2YoIiciKT09PS0xKXt2YXIgc3Q9c2VsZWN0b3JUZXh0LnNwbGl0KC9ccyosXHMqLyk7Zm9yKGs9MDtrPHN0Lmxlbmd0aDtrKyspe3J1bGVzQ2FjaGUucHVzaCh7J3NlbGVjdG9yJzpzdFtrXSwnc3R5bGUnOnJ1bGVzW3JdLnN0eWxlfSk7fX19fX0KcnVsZXNDYWNoZS5yZXZlcnNlKCk7fQp2YXIgY3NzPVtdO3ZhciBzdHlsZTthLm1hdGNoZXM9YS5tYXRjaGVzfHxhLndlYmtpdE1hdGNoZXNTZWxlY3Rvcnx8YS5tb3pNYXRjaGVzU2VsZWN0b3J8fGEubXNNYXRjaGVzU2VsZWN0b3J8fGEub01hdGNoZXNTZWxlY3Rvcjtmb3Iocj0wO3I8cnVsZXNDYWNoZS5sZW5ndGg7cisrKXtpZihhLm1hdGNoZXMocnVsZXNDYWNoZVtyXS5zZWxlY3Rvcikpe3N0eWxlPXJ1bGVzQ2FjaGVbcl0uc3R5bGU7aWYoc3R5bGUucGFyZW50UnVsZSl7dmFyIHN0eWxlX29iaj17fTt2YXIgbGVuO2ZvcihrPTAsbGVuPXN0eWxlLmxlbmd0aDtrPGxlbjtrKyspe2lmKHN0eWxlW2tdLmluZGV4T2YoJ2FuaW1hdGlvbicpIT09LTEpe2NvbnRpbnVlO30Kc3R5bGVfb2JqW3N0eWxlW2tdXT1zdHlsZVtzdHlsZVtrXS5yZXBsYWNlKC8tKC4pL2csZnVuY3Rpb24oYSxiKXtyZXR1cm4gYi50b1VwcGVyQ2FzZSgpO30pXTtpZihuZXcgUmVnRXhwKHN0eWxlW2tdKydccyo6W146O10rIWltcG9ydGFudCcpLnRlc3Qoc3R5bGUuY3NzVGV4dCkpe3N0eWxlX29ialtzdHlsZVtrXV0rPScgIWltcG9ydGFudCc7fX0KcnVsZXNDYWNoZVtyXS5zdHlsZT1zdHlsZT1zdHlsZV9vYmo7fQpjc3MucHVzaChbcnVsZXNDYWNoZVtyXS5zZWxlY3RvcixzdHlsZV0pO319CmZ1bmN0aW9uIHNwZWNpZmljaXR5KHNlbGVjdG9yKXt2YXIgYT0wO3NlbGVjdG9yPXNlbGVjdG9yLnJlcGxhY2UoLyNbYS16MC05Xy1dKy9naSxmdW5jdGlvbigpe2ErKztyZXR1cm4nJzt9KTt2YXIgYj0wO3NlbGVjdG9yPXNlbGVjdG9yLnJlcGxhY2UoLyhcLlthLXowLTlfLV0rKXwoXFsuKj9cXSkvZ2ksZnVuY3Rpb24oKXtiKys7cmV0dXJuJyc7fSk7dmFyIGM9MDtzZWxlY3Rvcj1zZWxlY3Rvci5yZXBsYWNlKC8oXnxccyt8OispW2EtejAtOV8tXSsvZ2ksZnVuY3Rpb24oYSl7aWYoYS5pbmRleE9mKCc6bm90KCcpPT09LTEpYysrO3JldHVybicnO30pO3JldHVybiBhKjEwMCtiKjEwK2M7fQpjc3Muc29ydChmdW5jdGlvbihhLGIpe3JldHVybiBzcGVjaWZpY2l0eShhWzBdKS1zcGVjaWZpY2l0eShiWzBdKTt9KTtzdHlsZT17fTtfLmVhY2goY3NzLGZ1bmN0aW9uKHYsayl7Xy5lYWNoKHZbMV0sZnVuY3Rpb24odixrKXtpZih2JiZfLmlzU3RyaW5nKHYpJiZrLmluZGV4T2YoJy13ZWJraXQnKT09PS0xJiYoIXN0eWxlW2tdfHxzdHlsZVtrXS5pbmRleE9mKCdpbXBvcnRhbnQnKT09PS0xfHx2LmluZGV4T2YoJ2ltcG9ydGFudCcpIT09LTEpKXtzdHlsZVtrXT12O319KTt9KTtfLmVhY2goc3R5bGUsZnVuY3Rpb24odixrKXtpZih2LmluZGV4T2YoJ2ltcG9ydGFudCcpIT09LTEpe3N0eWxlW2tdPXYuc2xpY2UoMCx2Lmxlbmd0aC0xMSk7fX0pO2lmKHN0eWxlLmRpc3BsYXk9PT0nYmxvY2snKXtkZWxldGUgc3R5bGUuZGlzcGxheTt9Cl8uZWFjaChbe3Byb3BlcnR5OidtYXJnaW4nfSx7cHJvcGVydHk6J3BhZGRpbmcnfSx7cHJvcGVydHk6J2JvcmRlcicscHJvcGVydHlFbmQ6Jy1zdHlsZScsZGVmYXVsdFZhbHVlOidub25lJ30sXSxmdW5jdGlvbihwcm9wZXJ0eUluZm8pe3ZhciBwPXByb3BlcnR5SW5mby5wcm9wZXJ0eTt2YXIgZT1wcm9wZXJ0eUluZm8ucHJvcGVydHlFbmR8fCcnO3ZhciBkZWZWYWw9cHJvcGVydHlJbmZvLmRlZmF1bHRWYWx1ZXx8MDtpZihzdHlsZVtwKyctdG9wJytlXXx8c3R5bGVbcCsnLXJpZ2h0JytlXXx8c3R5bGVbcCsnLWJvdHRvbScrZV18fHN0eWxlW3ArJy1sZWZ0JytlXSl7aWYoc3R5bGVbcCsnLXRvcCcrZV09PT1zdHlsZVtwKyctcmlnaHQnK2VdJiZzdHlsZVtwKyctdG9wJytlXT09PXN0eWxlW3ArJy1ib3R0b20nK2VdJiZzdHlsZVtwKyctdG9wJytlXT09PXN0eWxlW3ArJy1sZWZ0JytlXSl7c3R5bGVbcCtlXT1zdHlsZVtwKyctdG9wJytlXTt9CmVsc2V7c3R5bGVbcCtlXT0oc3R5bGVbcCsnLXRvcCcrZV18fGRlZlZhbCkrJyAnKyhzdHlsZVtwKyctcmlnaHQnK2VdfHxkZWZWYWwpKycgJysoc3R5bGVbcCsnLWJvdHRvbScrZV18fGRlZlZhbCkrJyAnKyhzdHlsZVtwKyctbGVmdCcrZV18fGRlZlZhbCk7aWYoc3R5bGVbcCtlXS5pbmRleE9mKCdpbmhlcml0JykhPT0tMXx8c3R5bGVbcCtlXS5pbmRleE9mKCdpbml0aWFsJykhPT0tMSl7ZGVsZXRlIHN0eWxlW3ArZV07cmV0dXJuO319CmRlbGV0ZSBzdHlsZVtwKyctdG9wJytlXTtkZWxldGUgc3R5bGVbcCsnLXJpZ2h0JytlXTtkZWxldGUgc3R5bGVbcCsnLWJvdHRvbScrZV07ZGVsZXRlIHN0eWxlW3ArJy1sZWZ0JytlXTt9fSk7aWYoc3R5bGVbJ2JvcmRlci1ib3R0b20tbGVmdC1yYWRpdXMnXSl7c3R5bGVbJ2JvcmRlci1yYWRpdXMnXT1zdHlsZVsnYm9yZGVyLWJvdHRvbS1sZWZ0LXJhZGl1cyddO2RlbGV0ZSBzdHlsZVsnYm9yZGVyLWJvdHRvbS1sZWZ0LXJhZGl1cyddO2RlbGV0ZSBzdHlsZVsnYm9yZGVyLWJvdHRvbS1yaWdodC1yYWRpdXMnXTtkZWxldGUgc3R5bGVbJ2JvcmRlci10b3AtbGVmdC1yYWRpdXMnXTtkZWxldGUgc3R5bGVbJ2JvcmRlci10b3AtcmlnaHQtcmFkaXVzJ107fQpfLmVhY2goXy5rZXlzKHN0eWxlKSxmdW5jdGlvbihrKXtpZihrLmluZGV4T2YoJ2JvcmRlcicpIT09LTEmJnN0eWxlW2tdPT09J2luaXRpYWwnKXtkZWxldGUgc3R5bGVba107fX0pO2lmKHN0eWxlWyd0ZXh0LWRlY29yYXRpb24tbGluZSddKXtzdHlsZVsndGV4dC1kZWNvcmF0aW9uJ109c3R5bGVbJ3RleHQtZGVjb3JhdGlvbi1saW5lJ107ZGVsZXRlIHN0eWxlWyd0ZXh0LWRlY29yYXRpb24tbGluZSddO2RlbGV0ZSBzdHlsZVsndGV4dC1kZWNvcmF0aW9uLWNvbG9yJ107ZGVsZXRlIHN0eWxlWyd0ZXh0LWRlY29yYXRpb24tc3R5bGUnXTt9CmlmKHN0eWxlWyd0ZXh0LWFsaWduJ109PT0naW5oZXJpdCcpe3ZhciAkZWw9JChhKS5wYXJlbnQoKTtkb3t2YXIgYWxpZ249JGVsLmNzcygndGV4dC1hbGlnbicpO2lmKF8uaW5kZXhPZihbJ2xlZnQnLCdyaWdodCcsJ2NlbnRlcicsJ2p1c3RpZnknXSxhbGlnbik+PTApe3N0eWxlWyd0ZXh0LWFsaWduJ109YWxpZ247YnJlYWs7fQokZWw9JGVsLnBhcmVudCgpO313aGlsZSgkZWwubGVuZ3RoJiYhJGVsLmlzKCdodG1sJykpO30KcmV0dXJuIHN0eWxlO30KZnVuY3Rpb24gZm9udFRvSW1nKCRlZGl0YWJsZSl7dmFyIGZvbnRzPW9kb28uX19ERUJVR19fLnNlcnZpY2VzWyJ3eXNpd3lnLmZvbnRzIl07JGVkaXRhYmxlLmZpbmQoJy5mYScpLmVhY2goZnVuY3Rpb24oKXt2YXIgJGZvbnQ9JCh0aGlzKTt2YXIgaWNvbixjb250ZW50O18uZmluZChmb250cy5mb250SWNvbnMsZnVuY3Rpb24oZm9udCl7cmV0dXJuIF8uZmluZChmb250cy5nZXRDc3NTZWxlY3RvcnMoZm9udC5wYXJzZXIpLGZ1bmN0aW9uKGRhdGEpe2lmKCRmb250LmlzKGRhdGEuc2VsZWN0b3IucmVwbGFjZSgvOjo/YmVmb3JlL2csJycpKSl7aWNvbj1kYXRhLm5hbWVzWzBdLnNwbGl0KCctJykuc2hpZnQoKTtjb250ZW50PWRhdGEuY3NzLm1hdGNoKC9jb250ZW50OlxzKlsnIl0/KC4pWyciXT8vKVsxXTtyZXR1cm4gdHJ1ZTt9fSk7fSk7aWYoY29udGVudCl7dmFyIGNvbG9yPSRmb250LmNzcygnY29sb3InKS5yZXBsYWNlKC9ccy9nLCcnKTskZm9udC5yZXBsYWNlV2l0aCgkKCc8aW1nLz4nLHtzcmM6Xy5zdHIuc3ByaW50ZignL3dlYl9lZGl0b3IvZm9udF90b19pbWcvJXMvJXMvJXMnLGNvbnRlbnQuY2hhckNvZGVBdCgwKSx3aW5kb3cuZW5jb2RlVVJJKGNvbG9yKSxNYXRoLm1heCgxLCRmb250LmhlaWdodCgpKSksJ2RhdGEtY2xhc3MnOiRmb250LmF0dHIoJ2NsYXNzJyksJ2RhdGEtc3R5bGUnOiRmb250LmF0dHIoJ3N0eWxlJyksY2xhc3M6JGZvbnQuYXR0cignY2xhc3MnKS5yZXBsYWNlKG5ldyBSZWdFeHAoJyhefFxccyspJytpY29uKycoLVteXFxzXSspPycsJ2dpJyksJycpLHN0eWxlOiRmb250LmF0dHIoJ3N0eWxlJyksfSkuY3NzKHtoZWlnaHQ6J2F1dG8nLHdpZHRoOidhdXRvJ30pKTt9ZWxzZXskZm9udC5yZW1vdmUoKTt9fSk7fQpmdW5jdGlvbiBpbWdUb0ZvbnQoJGVkaXRhYmxlKXskZWRpdGFibGUuZmluZCgnaW1nW3NyYyo9Ii93ZWJfZWRpdG9yL2ZvbnRfdG9faW1nLyJdJykuZWFjaChmdW5jdGlvbigpe3ZhciAkaW1nPSQodGhpcyk7JGltZy5yZXBsYWNlV2l0aCgkKCc8c3Bhbi8+Jyx7Y2xhc3M6JGltZy5kYXRhKCdjbGFzcycpLHN0eWxlOiRpbWcuZGF0YSgnc3R5bGUnKX0pKTt9KTt9CmZ1bmN0aW9uIGFwcGx5T3ZlckRlc2NlbmRhbnRzKG5vZGUsZnVuYyl7bm9kZT1ub2RlLmZpcnN0Q2hpbGQ7d2hpbGUobm9kZSl7aWYobm9kZS5ub2RlVHlwZT09PTEpe2Z1bmMobm9kZSk7YXBwbHlPdmVyRGVzY2VuZGFudHMobm9kZSxmdW5jKTt9CnZhciAkbm9kZT0kKG5vZGUpO2lmKG5vZGUubm9kZU5hbWU9PT0nQScmJiRub2RlLmhhc0NsYXNzKCdidG4nKSYmISRub2RlLmNoaWxkcmVuKCkubGVuZ3RoJiYkKG5vZGUpLnBhcmVudHMoJy5vX291dGxvb2tfaGFjaycpLmxlbmd0aCl7bm9kZT0kKG5vZGUpLnBhcmVudHMoJy5vX291dGxvb2tfaGFjaycpWzBdO30KZWxzZSBpZihub2RlLm5vZGVOYW1lPT09J0lNRycmJiRub2RlLnBhcmVudCgncCcpLmhhc0NsYXNzKCdvX291dGxvb2tfaGFjaycpKXtub2RlPSRub2RlLnBhcmVudCgpWzBdO30Kbm9kZT1ub2RlLm5leHRTaWJsaW5nO319CmZ1bmN0aW9uIGNsYXNzVG9TdHlsZSgkZWRpdGFibGUpe2FwcGx5T3ZlckRlc2NlbmRhbnRzKCRlZGl0YWJsZVswXSxmdW5jdGlvbihub2RlKXt2YXIgJHRhcmdldD0kKG5vZGUpO3ZhciBjc3M9Z2V0TWF0Y2hlZENTU1J1bGVzKG5vZGUpO3ZhciBzdHlsZT0kdGFyZ2V0LmF0dHIoJ3N0eWxlJyl8fCcnO18uZWFjaChjc3MsZnVuY3Rpb24odixrKXtpZighKG5ldyBSZWdFeHAoJyhefDspXHMqJytrKS50ZXN0KHN0eWxlKSkpe3N0eWxlPWsrJzonK3YrJzsnK3N0eWxlO319KTtpZihfLmlzRW1wdHkoc3R5bGUpKXskdGFyZ2V0LnJlbW92ZUF0dHIoJ3N0eWxlJyk7fWVsc2V7JHRhcmdldC5hdHRyKCdzdHlsZScsc3R5bGUpO30KaWYobm9kZS5ub2RlTmFtZT09PSdURCcmJiFub2RlLmNoaWxkTm9kZXMubGVuZ3RoKXtub2RlLmlubmVySFRNTD0nJm5ic3A7Jzt9CmlmKG5vZGUubm9kZU5hbWU9PT0nQScmJiR0YXJnZXQuaGFzQ2xhc3MoJ2J0bicpJiYhJHRhcmdldC5oYXNDbGFzcygnYnRuLWxpbmsnKSYmISR0YXJnZXQuY2hpbGRyZW4oKS5sZW5ndGgpe3ZhciAkaGFjaz0kKCc8dGFibGUgY2xhc3M9Im9fb3V0bG9va19oYWNrIiBzdHlsZT0iZGlzcGxheTogaW5saW5lLXRhYmxlO3ZlcnRpY2FsLWFsaWduOm1pZGRsZSI+PHRyPjx0ZD48L3RkPjwvdHI+PC90YWJsZT4nKTskaGFjay5maW5kKCd0ZCcpLmF0dHIoJ2hlaWdodCcsJHRhcmdldC5vdXRlckhlaWdodCgpKS5jc3Moeyd0ZXh0LWFsaWduJzokdGFyZ2V0LnBhcmVudCgpLmNzcygndGV4dC1hbGlnbicpLCdtYXJnaW4nOiR0YXJnZXQuY3NzKCdwYWRkaW5nJyksJ2JvcmRlci1yYWRpdXMnOiR0YXJnZXQuY3NzKCdib3JkZXItcmFkaXVzJyksJ2JhY2tncm91bmQtY29sb3InOiR0YXJnZXQuY3NzKCdiYWNrZ3JvdW5kLWNvbG9yJyksfSk7JHRhcmdldC5hZnRlcigkaGFjayk7JHRhcmdldC5hcHBlbmRUbygkaGFjay5maW5kKCd0ZCcpKTtub2RlPSRoYWNrWzBdLnByZXZpb3VzU2libGluZztpZihub2RlJiZub2RlLm5vZGVUeXBlPT09Tm9kZS5URVhUX05PREUmJiFub2RlLnRleHRDb250ZW50Lm1hdGNoKC9cUy8pKXskKG5vZGUpLnJlbW92ZSgpO30Kbm9kZT0kaGFja1swXS5uZXh0U2libGluZztpZihub2RlJiZub2RlLm5vZGVUeXBlPT09Tm9kZS5URVhUX05PREUmJiFub2RlLnRleHRDb250ZW50Lm1hdGNoKC9cUy8pKXskKG5vZGUpLnJlbW92ZSgpO319CmVsc2UgaWYobm9kZS5ub2RlTmFtZT09PSdJTUcnJiYkdGFyZ2V0LmlzKCcubXgtYXV0by5kLWJsb2NrJykpeyR0YXJnZXQud3JhcCgnPHAgY2xhc3M9Im9fb3V0bG9va19oYWNrIiBzdHlsZT0idGV4dC1hbGlnbjpjZW50ZXI7bWFyZ2luOjAiLz4nKTt9fSk7fQpmdW5jdGlvbiBzdHlsZVRvQ2xhc3MoJGVkaXRhYmxlKXskZWRpdGFibGUuZmluZCgnLm9fb3V0bG9va19oYWNrJykuZWFjaChmdW5jdGlvbigpeyQodGhpcykuYWZ0ZXIoJCgnYSxpbWcnLHRoaXMpKTt9KS5yZW1vdmUoKTt2YXIgJGM9JCgnPHNwYW4vPicpLmFwcGVuZFRvKCRlZGl0YWJsZVswXS5vd25lckRvY3VtZW50LmJvZHkpO2FwcGx5T3ZlckRlc2NlbmRhbnRzKCRlZGl0YWJsZVswXSxmdW5jdGlvbihub2RlKXt2YXIgJHRhcmdldD0kKG5vZGUpO3ZhciBjc3M9Z2V0TWF0Y2hlZENTU1J1bGVzKG5vZGUpO3ZhciBzdHlsZT0nJztfLmVhY2goY3NzLGZ1bmN0aW9uKHYsayl7aWYoIShuZXcgUmVnRXhwKCcoXnw7KVxzKicraykudGVzdChzdHlsZSkpKXtzdHlsZT1rKyc6Jyt2Kyc7JytzdHlsZTt9fSk7Y3NzPSgkYy5hdHRyKCdzdHlsZScsc3R5bGUpLmF0dHIoJ3N0eWxlJyl8fCcnKS5zcGxpdCgvXHMqO1xzKi8pO3N0eWxlPSgkdGFyZ2V0LmF0dHIoJ3N0eWxlJyl8fCcnKS5yZXBsYWNlKC9ccyo6XHMqLywnOicpLnJlcGxhY2UoL1xzKjtccyovLCc7Jyk7Xy5lYWNoKGNzcyxmdW5jdGlvbih2KXtzdHlsZT1zdHlsZS5yZXBsYWNlKHYsJycpO30pO3N0eWxlPXN0eWxlLnJlcGxhY2UoLzsrKFxzOykqL2csJzsnKS5yZXBsYWNlKC9eOy9nLCcnKTtpZihzdHlsZSE9PScnKXskdGFyZ2V0LmF0dHIoJ3N0eWxlJyxzdHlsZSk7fWVsc2V7JHRhcmdldC5yZW1vdmVBdHRyKCdzdHlsZScpO319KTskYy5yZW1vdmUoKTt9CmZ1bmN0aW9uIGF0dGFjaG1lbnRUaHVtYm5haWxUb0xpbmtJbWcoJGVkaXRhYmxlKXskZWRpdGFibGUuZmluZCgnYVtocmVmKj0iL3dlYi9jb250ZW50LyJdW2RhdGEtbWltZXR5cGVdJykuZmlsdGVyKCc6ZW1wdHksIDpjb250YWluc0V4YWN0KCApJykuZWFjaChmdW5jdGlvbigpe3ZhciAkbGluaz0kKHRoaXMpO3ZhciAkaW1nPSQoJzxpbWcvPicpLmF0dHIoJ3NyYycsJGxpbmsuY3NzKCdiYWNrZ3JvdW5kLWltYWdlJykucmVwbGFjZSgvKF51cmxcKFsnIl0pfChbJyJdXCkkKS9nLCcnKSkuY3NzKCdoZWlnaHQnLE1hdGgubWF4KDEsJGxpbmsuaGVpZ2h0KCkpKydweCcpLmNzcygnd2lkdGgnLE1hdGgubWF4KDEsJGxpbmsud2lkdGgoKSkrJ3B4Jyk7JGxpbmsucHJlcGVuZCgkaW1nKTt9KTt9CmZ1bmN0aW9uIGxpbmtJbWdUb0F0dGFjaG1lbnRUaHVtYm5haWwoJGVkaXRhYmxlKXskZWRpdGFibGUuZmluZCgnYVtocmVmKj0iL3dlYi9jb250ZW50LyJdW2RhdGEtbWltZXR5cGVdID4gaW1nJykucmVtb3ZlKCk7fQpGaWVsZEh0bWwuaW5jbHVkZSh7Y29tbWl0Q2hhbmdlczpmdW5jdGlvbigpe2lmKHRoaXMubm9kZU9wdGlvbnNbJ3N0eWxlLWlubGluZSddJiZ0aGlzLm1vZGU9PT0iZWRpdCIpe3RoaXMuX3RvSW5saW5lKCk7fQpyZXR1cm4gdGhpcy5fc3VwZXIoKTt9LF90b0lubGluZTpmdW5jdGlvbigpe3ZhciAkZWRpdGFibGU9dGhpcy53eXNpd3lnLmdldEVkaXRhYmxlKCk7dmFyIGh0bWw9dGhpcy53eXNpd3lnLmdldFZhbHVlKCk7JGVkaXRhYmxlLmh0bWwoaHRtbCk7YXR0YWNobWVudFRodW1ibmFpbFRvTGlua0ltZygkZWRpdGFibGUpO2ZvbnRUb0ltZygkZWRpdGFibGUpO2NsYXNzVG9TdHlsZSgkZWRpdGFibGUpO3RoaXMud3lzaXd5Zy5zZXRWYWx1ZSgkZWRpdGFibGUuaHRtbCgpLHtub3RpZnlDaGFuZ2U6ZmFsc2UsfSk7fSxfZnJvbUlubGluZTpmdW5jdGlvbigpe3ZhciAkZWRpdGFibGU9dGhpcy53eXNpd3lnLmdldEVkaXRhYmxlKCk7dmFyIGh0bWw9dGhpcy53eXNpd3lnLmdldFZhbHVlKCk7JGVkaXRhYmxlLmh0bWwoaHRtbCk7c3R5bGVUb0NsYXNzKCRlZGl0YWJsZSk7aW1nVG9Gb250KCRlZGl0YWJsZSk7bGlua0ltZ1RvQXR0YWNobWVudFRodW1ibmFpbCgkZWRpdGFibGUpO3RoaXMud3lzaXd5Zy5zZXRWYWx1ZSgkZWRpdGFibGUuaHRtbCgpLHtub3RpZnlDaGFuZ2U6ZmFsc2UsfSk7fSxfb25Mb2FkV3lzaXd5ZzpmdW5jdGlvbigpe2lmKHRoaXMubm9kZU9wdGlvbnNbJ3N0eWxlLWlubGluZSddJiZ0aGlzLm1vZGU9PT0iZWRpdCIpe3RoaXMuX2Zyb21JbmxpbmUoKTt9CnRoaXMuX3N1cGVyKCk7fSx9KTtyZXR1cm57Zm9udFRvSW1nOmZvbnRUb0ltZyxpbWdUb0ZvbnQ6aW1nVG9Gb250LGNsYXNzVG9TdHlsZTpjbGFzc1RvU3R5bGUsc3R5bGVUb0NsYXNzOnN0eWxlVG9DbGFzcyxhdHRhY2htZW50VGh1bWJuYWlsVG9MaW5rSW1nOmF0dGFjaG1lbnRUaHVtYm5haWxUb0xpbmtJbWcsbGlua0ltZ1RvQXR0YWNobWVudFRodW1ibmFpbDpsaW5rSW1nVG9BdHRhY2htZW50VGh1bWJuYWlsLH07fSk7OwoKLyogL3dlYl9rYW5iYW5fZ2F1Z2Uvc3RhdGljL3NyYy9qcy9rYW5iYW5fZ2F1Z2UuanMgZGVmaW5lZCBpbiBidW5kbGUgJ3dlYi5hc3NldHNfYmFja2VuZCcgKi8Kb2Rvby5kZWZpbmUoJ3dlYl9rYW5iYW5fZ2F1Z2Uud2lkZ2V0JyxmdW5jdGlvbihyZXF1aXJlKXsidXNlIHN0cmljdCI7dmFyIEFic3RyYWN0RmllbGQ9cmVxdWlyZSgnd2ViLkFic3RyYWN0RmllbGQnKTt2YXIgY29yZT1yZXF1aXJlKCd3ZWIuY29yZScpO3ZhciBmaWVsZF9yZWdpc3RyeT1yZXF1aXJlKCd3ZWIuZmllbGRfcmVnaXN0cnknKTt2YXIgdXRpbHM9cmVxdWlyZSgnd2ViLnV0aWxzJyk7dmFyIF90PWNvcmUuX3Q7dmFyIEdhdWdlV2lkZ2V0PUFic3RyYWN0RmllbGQuZXh0ZW5kKHtjbGFzc05hbWU6Im9lX2dhdWdlIixqc0xpYnM6Wycvd2ViL3N0YXRpYy9saWIvQ2hhcnQvQ2hhcnQuanMnLF0sX3JlbmRlcjpmdW5jdGlvbigpe3ZhciB2YWw9dGhpcy52YWx1ZTtpZihfLmlzQXJyYXkoSlNPTi5wYXJzZSh2YWwpKSl7dmFsPUpTT04ucGFyc2UodmFsKTt9CnZhciBnYXVnZV92YWx1ZT1fLmlzQXJyYXkodmFsKSYmdmFsLmxlbmd0aD92YWxbdmFsLmxlbmd0aC0xXS52YWx1ZTp2YWw7aWYodGhpcy5ub2RlT3B0aW9ucy5nYXVnZV92YWx1ZV9maWVsZCl7Z2F1Z2VfdmFsdWU9dGhpcy5yZWNvcmREYXRhW3RoaXMubm9kZU9wdGlvbnMuZ2F1Z2VfdmFsdWVfZmllbGRdO30KdmFyIG1heF92YWx1ZT10aGlzLm5vZGVPcHRpb25zLm1heF92YWx1ZXx8MTAwO2lmKHRoaXMubm9kZU9wdGlvbnMubWF4X2ZpZWxkKXttYXhfdmFsdWU9dGhpcy5yZWNvcmREYXRhW3RoaXMubm9kZU9wdGlvbnMubWF4X2ZpZWxkXTt9Cm1heF92YWx1ZT1NYXRoLm1heChnYXVnZV92YWx1ZSxtYXhfdmFsdWUpO3ZhciBsYWJlbD10aGlzLm5vZGVPcHRpb25zLmxhYmVsfHwiIjtpZih0aGlzLm5vZGVPcHRpb25zLmxhYmVsX2ZpZWxkKXtsYWJlbD10aGlzLnJlY29yZERhdGFbdGhpcy5ub2RlT3B0aW9ucy5sYWJlbF9maWVsZF07fQp2YXIgdGl0bGU9dGhpcy5ub2RlT3B0aW9ucy50aXRsZXx8dGhpcy5maWVsZC5zdHJpbmc7dmFyIG1heExhYmVsPW1heF92YWx1ZTtpZihnYXVnZV92YWx1ZT09PTAmJm1heF92YWx1ZT09PTApe21heF92YWx1ZT0xO21heExhYmVsPTA7fQp2YXIgY29uZmlnPXt0eXBlOidkb3VnaG51dCcsZGF0YTp7ZGF0YXNldHM6W3tkYXRhOltnYXVnZV92YWx1ZSxtYXhfdmFsdWUtZ2F1Z2VfdmFsdWVdLGJhY2tncm91bmRDb2xvcjpbIiMxZjc3YjQiLCIjZGRkZGRkIl0sbGFiZWw6dGl0bGV9XSx9LG9wdGlvbnM6e2NpcmN1bWZlcmVuY2U6TWF0aC5QSSxyb3RhdGlvbjotTWF0aC5QSSxyZXNwb25zaXZlOnRydWUsdG9vbHRpcHM6e2Rpc3BsYXlDb2xvcnM6ZmFsc2UsY2FsbGJhY2tzOntsYWJlbDpmdW5jdGlvbih0b29sdGlwSXRlbXMpe2lmKHRvb2x0aXBJdGVtcy5pbmRleD09PTApe3JldHVybiBfdCgnVmFsdWU6ICcpK2dhdWdlX3ZhbHVlO30KcmV0dXJuIF90KCdNYXg6ICcpK21heExhYmVsO30sfSx9LHRpdGxlOntkaXNwbGF5OnRydWUsdGV4dDp0aXRsZSxwYWRkaW5nOjQsfSxsYXlvdXQ6e3BhZGRpbmc6e2JvdHRvbTo1fX0sbWFpbnRhaW5Bc3BlY3RSYXRpbzpmYWxzZSxjdXRvdXRQZXJjZW50YWdlOjcwLH19O3RoaXMuJGNhbnZhcz0kKCc8Y2FudmFzLz4nKTt0aGlzLiRlbC5lbXB0eSgpO3RoaXMuJGVsLmFwcGVuZCh0aGlzLiRjYW52YXMpO3RoaXMuJGVsLmF0dHIoJ3N0eWxlJyx0aGlzLm5vZGVPcHRpb25zLnN0eWxlKTt0aGlzLiRlbC5jc3Moe3Bvc2l0aW9uOidyZWxhdGl2ZSd9KTt2YXIgY29udGV4dD10aGlzLiRjYW52YXNbMF0uZ2V0Q29udGV4dCgnMmQnKTt0aGlzLmNoYXJ0PW5ldyBDaGFydChjb250ZXh0LGNvbmZpZyk7dmFyIGh1bWFuVmFsdWU9dXRpbHMuaHVtYW5fbnVtYmVyKGdhdWdlX3ZhbHVlLDEpO3ZhciAkdmFsdWU9JCgnPHNwYW4gY2xhc3M9Im9fZ2F1Z2VfdmFsdWUiPicpLnRleHQoaHVtYW5WYWx1ZSk7JHZhbHVlLmNzcyh7J3RleHQtYWxpZ24nOidjZW50ZXInLHBvc2l0aW9uOidhYnNvbHV0ZScsbGVmdDowLHJpZ2h0OjAsYm90dG9tOic2cHgnLCdmb250LXdlaWdodCc6J2JvbGQnfSk7dGhpcy4kZWwuYXBwZW5kKCR2YWx1ZSk7fSx9KTtmaWVsZF9yZWdpc3RyeS5hZGQoImdhdWdlIixHYXVnZVdpZGdldCk7cmV0dXJuIEdhdWdlV2lkZ2V0O30pOzsKCi8qIC93ZWJfdG91ci9zdGF0aWMvc3JjL2pzL2RlYnVnX21hbmFnZXIuanMgZGVmaW5lZCBpbiBidW5kbGUgJ3dlYi5hc3NldHNfYmFja2VuZCcgKi8Kb2Rvby5kZWZpbmUoJ3dlYl90b3VyLkRlYnVnTWFuYWdlci5CYWNrZW5kJyxmdW5jdGlvbihyZXF1aXJlKXsidXNlIHN0cmljdCI7dmFyIGNvcmU9cmVxdWlyZSgid2ViLmNvcmUiKTt2YXIgRGVidWdNYW5hZ2VyPXJlcXVpcmUoJ3dlYi5EZWJ1Z01hbmFnZXIuQmFja2VuZCcpO3ZhciBEaWFsb2c9cmVxdWlyZSgid2ViLkRpYWxvZyIpO3ZhciB0b3VyPXJlcXVpcmUoJ3dlYl90b3VyLnRvdXInKTtmdW5jdGlvbiBnZXRfYWN0aXZlX3RvdXJzKCl7cmV0dXJuIF8uZGlmZmVyZW5jZShfLmtleXModG91ci50b3VycyksdG91ci5jb25zdW1lZF90b3Vycyk7fQpEZWJ1Z01hbmFnZXIuaW5jbHVkZSh7c3RhcnQ6ZnVuY3Rpb24oKXt0aGlzLmNvbnN1bWVfdG91cnNfZW5hYmxlZD1nZXRfYWN0aXZlX3RvdXJzKCkubGVuZ3RoPjA7cmV0dXJuIHRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9LGNvbnN1bWVfdG91cnM6ZnVuY3Rpb24oKXt2YXIgYWN0aXZlX3RvdXJzPWdldF9hY3RpdmVfdG91cnMoKTtpZihhY3RpdmVfdG91cnMubGVuZ3RoPjApe3RoaXMuX3JwYyh7bW9kZWw6J3dlYl90b3VyLnRvdXInLG1ldGhvZDonY29uc3VtZScsYXJnczpbYWN0aXZlX3RvdXJzXSx9KS50aGVuKGZ1bmN0aW9uKCl7d2luZG93LmxvY2F0aW9uLnJlbG9hZCgpO30pO319LHN0YXJ0X3RvdXI6ZnVuY3Rpb24oKXt2YXIgZGlhbG9nPW5ldyBEaWFsb2codGhpcyx7dGl0bGU6J1RvdXJzJywkY29udGVudDpjb3JlLnF3ZWIucmVuZGVyKCdXZWJDbGllbnQuRGVidWdNYW5hZ2VyLlRvdXJzRGlhbG9nJyx7dG91cnM6dG91ci50b3Vyc30pLH0pO2RpYWxvZy5vcGVuZWQoKS50aGVuKGZ1bmN0aW9uKCl7ZGlhbG9nLiQoJy5vX3N0YXJ0X3RvdXInKS5vbignY2xpY2snLGZ1bmN0aW9uKGUpe2UucHJldmVudERlZmF1bHQoKTt0b3VyLnJ1bigkKGUudGFyZ2V0KS5kYXRhKCduYW1lJykpO30pO30pO2RpYWxvZy5vcGVuKCk7fSx9KTt9KTs=</ActualData>
          </HTTPData>
        </HTTPDataSet>
        <IsExternalData>false</IsExternalData>
      </HTTPBody>
    </HTTPResponse>
  </HTTPTask>
</HTTPSnapshot>